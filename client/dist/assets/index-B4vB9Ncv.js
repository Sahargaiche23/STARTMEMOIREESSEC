var LC=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var yL=LC(($L,yC)=>{function OC(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function Lb(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ob={exports:{}},Wu={},Bb={exports:{}},qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gl=Symbol.for("react.element"),BC=Symbol.for("react.portal"),$C=Symbol.for("react.fragment"),zC=Symbol.for("react.strict_mode"),UC=Symbol.for("react.profiler"),WC=Symbol.for("react.provider"),VC=Symbol.for("react.context"),HC=Symbol.for("react.forward_ref"),qC=Symbol.for("react.suspense"),GC=Symbol.for("react.memo"),KC=Symbol.for("react.lazy"),P0=Symbol.iterator;function XC(e){return e===null||typeof e!="object"?null:(e=P0&&e[P0]||e["@@iterator"],typeof e=="function"?e:null)}var $b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},zb=Object.assign,Ub={};function to(e,t,n){this.props=e,this.context=t,this.refs=Ub,this.updater=n||$b}to.prototype.isReactComponent={};to.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};to.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Wb(){}Wb.prototype=to.prototype;function vf(e,t,n){this.props=e,this.context=t,this.refs=Ub,this.updater=n||$b}var yf=vf.prototype=new Wb;yf.constructor=vf;zb(yf,to.prototype);yf.isPureReactComponent=!0;var F0=Array.isArray,Vb=Object.prototype.hasOwnProperty,bf={current:null},Hb={key:!0,ref:!0,__self:!0,__source:!0};function qb(e,t,n){var r,s={},i=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)Vb.call(t,r)&&!Hb.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:gl,type:e,key:i,ref:o,props:s,_owner:bf.current}}function YC(e,t){return{$$typeof:gl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function wf(e){return typeof e=="object"&&e!==null&&e.$$typeof===gl}function QC(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var M0=/\/+/g;function Fd(e,t){return typeof e=="object"&&e!==null&&e.key!=null?QC(""+e.key):t.toString(36)}function wc(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case gl:case BC:o=!0}}if(o)return o=e,s=s(o),e=r===""?"."+Fd(o,0):r,F0(s)?(n="",e!=null&&(n=e.replace(M0,"$&/")+"/"),wc(s,t,n,"",function(u){return u})):s!=null&&(wf(s)&&(s=YC(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(M0,"$&/")+"/")+e)),t.push(s)),1;if(o=0,r=r===""?".":r+":",F0(e))for(var l=0;l<e.length;l++){i=e[l];var c=r+Fd(i,l);o+=wc(i,t,n,c,s)}else if(c=XC(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=r+Fd(i,l++),o+=wc(i,t,n,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function zl(e,t,n){if(e==null)return e;var r=[],s=0;return wc(e,r,"","",function(i){return t.call(n,i,s++)}),r}function JC(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var bn={current:null},Nc={transition:null},ZC={ReactCurrentDispatcher:bn,ReactCurrentBatchConfig:Nc,ReactCurrentOwner:bf};function Gb(){throw Error("act(...) is not supported in production builds of React.")}qe.Children={map:zl,forEach:function(e,t,n){zl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return zl(e,function(){t++}),t},toArray:function(e){return zl(e,function(t){return t})||[]},only:function(e){if(!wf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};qe.Component=to;qe.Fragment=$C;qe.Profiler=UC;qe.PureComponent=vf;qe.StrictMode=zC;qe.Suspense=qC;qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ZC;qe.act=Gb;qe.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=zb({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=bf.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Vb.call(t,c)&&!Hb.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:gl,type:e.type,key:s,ref:i,props:r,_owner:o}};qe.createContext=function(e){return e={$$typeof:VC,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:WC,_context:e},e.Consumer=e};qe.createElement=qb;qe.createFactory=function(e){var t=qb.bind(null,e);return t.type=e,t};qe.createRef=function(){return{current:null}};qe.forwardRef=function(e){return{$$typeof:HC,render:e}};qe.isValidElement=wf;qe.lazy=function(e){return{$$typeof:KC,_payload:{_status:-1,_result:e},_init:JC}};qe.memo=function(e,t){return{$$typeof:GC,type:e,compare:t===void 0?null:t}};qe.startTransition=function(e){var t=Nc.transition;Nc.transition={};try{e()}finally{Nc.transition=t}};qe.unstable_act=Gb;qe.useCallback=function(e,t){return bn.current.useCallback(e,t)};qe.useContext=function(e){return bn.current.useContext(e)};qe.useDebugValue=function(){};qe.useDeferredValue=function(e){return bn.current.useDeferredValue(e)};qe.useEffect=function(e,t){return bn.current.useEffect(e,t)};qe.useId=function(){return bn.current.useId()};qe.useImperativeHandle=function(e,t,n){return bn.current.useImperativeHandle(e,t,n)};qe.useInsertionEffect=function(e,t){return bn.current.useInsertionEffect(e,t)};qe.useLayoutEffect=function(e,t){return bn.current.useLayoutEffect(e,t)};qe.useMemo=function(e,t){return bn.current.useMemo(e,t)};qe.useReducer=function(e,t,n){return bn.current.useReducer(e,t,n)};qe.useRef=function(e){return bn.current.useRef(e)};qe.useState=function(e){return bn.current.useState(e)};qe.useSyncExternalStore=function(e,t,n){return bn.current.useSyncExternalStore(e,t,n)};qe.useTransition=function(){return bn.current.useTransition()};qe.version="18.3.1";Bb.exports=qe;var S=Bb.exports;const Vu=Lb(S),e4=OC({__proto__:null,default:Vu},[S]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t4=S,n4=Symbol.for("react.element"),r4=Symbol.for("react.fragment"),a4=Object.prototype.hasOwnProperty,s4=t4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i4={key:!0,ref:!0,__self:!0,__source:!0};function Kb(e,t,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)a4.call(t,r)&&!i4.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:n4,type:e,key:i,ref:o,props:s,_owner:s4.current}}Wu.Fragment=r4;Wu.jsx=Kb;Wu.jsxs=Kb;Ob.exports=Wu;var a=Ob.exports,$h={},Xb={exports:{}},Gn={},Yb={exports:{}},Qb={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(B,O){var H=B.length;B.push(O);e:for(;0<H;){var J=H-1>>>1,te=B[J];if(0<s(te,O))B[J]=O,B[H]=te,H=J;else break e}}function n(B){return B.length===0?null:B[0]}function r(B){if(B.length===0)return null;var O=B[0],H=B.pop();if(H!==O){B[0]=H;e:for(var J=0,te=B.length,ce=te>>>1;J<ce;){var se=2*(J+1)-1,le=B[se],he=se+1,ye=B[he];if(0>s(le,H))he<te&&0>s(ye,le)?(B[J]=ye,B[he]=H,J=he):(B[J]=le,B[se]=H,J=se);else if(he<te&&0>s(ye,H))B[J]=ye,B[he]=H,J=he;else break e}}return O}function s(B,O){var H=B.sortIndex-O.sortIndex;return H!==0?H:B.id-O.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,p=3,f=!1,x=!1,v=!1,y=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(B){for(var O=n(u);O!==null;){if(O.callback===null)r(u);else if(O.startTime<=B)r(u),O.sortIndex=O.expirationTime,t(c,O);else break;O=n(u)}}function w(B){if(v=!1,b(B),!x)if(n(c)!==null)x=!0,U(N);else{var O=n(u);O!==null&&_(w,O.startTime-B)}}function N(B,O){x=!1,v&&(v=!1,m(j),j=-1),f=!0;var H=p;try{for(b(O),h=n(c);h!==null&&(!(h.expirationTime>O)||B&&!E());){var J=h.callback;if(typeof J=="function"){h.callback=null,p=h.priorityLevel;var te=J(h.expirationTime<=O);O=e.unstable_now(),typeof te=="function"?h.callback=te:h===n(c)&&r(c),b(O)}else r(c);h=n(c)}if(h!==null)var ce=!0;else{var se=n(u);se!==null&&_(w,se.startTime-O),ce=!1}return ce}finally{h=null,p=H,f=!1}}var C=!1,D=null,j=-1,k=5,R=-1;function E(){return!(e.unstable_now()-R<k)}function P(){if(D!==null){var B=e.unstable_now();R=B;var O=!0;try{O=D(!0,B)}finally{O?F():(C=!1,D=null)}}else C=!1}var F;if(typeof g=="function")F=function(){g(P)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,L=W.port2;W.port1.onmessage=P,F=function(){L.postMessage(null)}}else F=function(){y(P,0)};function U(B){D=B,C||(C=!0,F())}function _(B,O){j=y(function(){B(e.unstable_now())},O)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(B){B.callback=null},e.unstable_continueExecution=function(){x||f||(x=!0,U(N))},e.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<B?Math.floor(1e3/B):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(B){switch(p){case 1:case 2:case 3:var O=3;break;default:O=p}var H=p;p=O;try{return B()}finally{p=H}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(B,O){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var H=p;p=B;try{return O()}finally{p=H}},e.unstable_scheduleCallback=function(B,O,H){var J=e.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?J+H:J):H=J,B){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=H+te,B={id:d++,callback:O,priorityLevel:B,startTime:H,expirationTime:te,sortIndex:-1},H>J?(B.sortIndex=H,t(u,B),n(c)===null&&B===n(u)&&(v?(m(j),j=-1):v=!0,_(w,H-J))):(B.sortIndex=te,t(c,B),x||f||(x=!0,U(N))),B},e.unstable_shouldYield=E,e.unstable_wrapCallback=function(B){var O=p;return function(){var H=p;p=O;try{return B.apply(this,arguments)}finally{p=H}}}})(Qb);Yb.exports=Qb;var o4=Yb.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l4=S,Hn=o4;function oe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Jb=new Set,Wo={};function Gs(e,t){Oi(e,t),Oi(e+"Capture",t)}function Oi(e,t){for(Wo[e]=t,e=0;e<t.length;e++)Jb.add(t[e])}var da=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zh=Object.prototype.hasOwnProperty,c4=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,L0={},O0={};function u4(e){return zh.call(O0,e)?!0:zh.call(L0,e)?!1:c4.test(e)?O0[e]=!0:(L0[e]=!0,!1)}function d4(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function h4(e,t,n,r){if(t===null||typeof t>"u"||d4(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function wn(e,t,n,r,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var nn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){nn[e]=new wn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];nn[t]=new wn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){nn[e]=new wn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){nn[e]=new wn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){nn[e]=new wn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){nn[e]=new wn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){nn[e]=new wn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){nn[e]=new wn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){nn[e]=new wn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Nf=/[\-:]([a-z])/g;function jf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Nf,jf);nn[t]=new wn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Nf,jf);nn[t]=new wn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Nf,jf);nn[t]=new wn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){nn[e]=new wn(e,1,!1,e.toLowerCase(),null,!1,!1)});nn.xlinkHref=new wn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){nn[e]=new wn(e,1,!1,e.toLowerCase(),null,!0,!0)});function Cf(e,t,n,r){var s=nn.hasOwnProperty(t)?nn[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(h4(t,n,s,r)&&(n=null),r||s===null?u4(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var ba=l4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ul=Symbol.for("react.element"),hi=Symbol.for("react.portal"),pi=Symbol.for("react.fragment"),kf=Symbol.for("react.strict_mode"),Uh=Symbol.for("react.profiler"),Zb=Symbol.for("react.provider"),e1=Symbol.for("react.context"),Sf=Symbol.for("react.forward_ref"),Wh=Symbol.for("react.suspense"),Vh=Symbol.for("react.suspense_list"),Ef=Symbol.for("react.memo"),Ia=Symbol.for("react.lazy"),t1=Symbol.for("react.offscreen"),B0=Symbol.iterator;function po(e){return e===null||typeof e!="object"?null:(e=B0&&e[B0]||e["@@iterator"],typeof e=="function"?e:null)}var yt=Object.assign,Md;function Eo(e){if(Md===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Md=t&&t[1]||""}return`
`+Md+e}var Ld=!1;function Od(e,t){if(!e||Ld)return"";Ld=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{Ld=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Eo(e):""}function p4(e){switch(e.tag){case 5:return Eo(e.type);case 16:return Eo("Lazy");case 13:return Eo("Suspense");case 19:return Eo("SuspenseList");case 0:case 2:case 15:return e=Od(e.type,!1),e;case 11:return e=Od(e.type.render,!1),e;case 1:return e=Od(e.type,!0),e;default:return""}}function Hh(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case pi:return"Fragment";case hi:return"Portal";case Uh:return"Profiler";case kf:return"StrictMode";case Wh:return"Suspense";case Vh:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case e1:return(e.displayName||"Context")+".Consumer";case Zb:return(e._context.displayName||"Context")+".Provider";case Sf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ef:return t=e.displayName||null,t!==null?t:Hh(e.type)||"Memo";case Ia:t=e._payload,e=e._init;try{return Hh(e(t))}catch{}}return null}function f4(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Hh(t);case 8:return t===kf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ns(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function n1(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function m4(e){var t=n1(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Wl(e){e._valueTracker||(e._valueTracker=m4(e))}function r1(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=n1(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Uc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function qh(e,t){var n=t.checked;return yt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function $0(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=ns(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function a1(e,t){t=t.checked,t!=null&&Cf(e,"checked",t,!1)}function Gh(e,t){a1(e,t);var n=ns(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Kh(e,t.type,n):t.hasOwnProperty("defaultValue")&&Kh(e,t.type,ns(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function z0(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Kh(e,t,n){(t!=="number"||Uc(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Do=Array.isArray;function Ci(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ns(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Xh(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(oe(91));return yt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function U0(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(oe(92));if(Do(n)){if(1<n.length)throw Error(oe(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:ns(n)}}function s1(e,t){var n=ns(t.value),r=ns(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function W0(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function i1(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Yh(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?i1(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Vl,o1=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Vl=Vl||document.createElement("div"),Vl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Vl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Vo(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var To={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},x4=["Webkit","ms","Moz","O"];Object.keys(To).forEach(function(e){x4.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),To[t]=To[e]})});function l1(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||To.hasOwnProperty(e)&&To[e]?(""+t).trim():t+"px"}function c1(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=l1(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var g4=yt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Qh(e,t){if(t){if(g4[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(oe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(oe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(oe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(oe(62))}}function Jh(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zh=null;function Df(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ep=null,ki=null,Si=null;function V0(e){if(e=bl(e)){if(typeof ep!="function")throw Error(oe(280));var t=e.stateNode;t&&(t=Xu(t),ep(e.stateNode,e.type,t))}}function u1(e){ki?Si?Si.push(e):Si=[e]:ki=e}function d1(){if(ki){var e=ki,t=Si;if(Si=ki=null,V0(e),t)for(e=0;e<t.length;e++)V0(t[e])}}function h1(e,t){return e(t)}function p1(){}var Bd=!1;function f1(e,t,n){if(Bd)return e(t,n);Bd=!0;try{return h1(e,t,n)}finally{Bd=!1,(ki!==null||Si!==null)&&(p1(),d1())}}function Ho(e,t){var n=e.stateNode;if(n===null)return null;var r=Xu(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(oe(231,t,typeof n));return n}var tp=!1;if(da)try{var fo={};Object.defineProperty(fo,"passive",{get:function(){tp=!0}}),window.addEventListener("test",fo,fo),window.removeEventListener("test",fo,fo)}catch{tp=!1}function v4(e,t,n,r,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(d){this.onError(d)}}var Ao=!1,Wc=null,Vc=!1,np=null,y4={onError:function(e){Ao=!0,Wc=e}};function b4(e,t,n,r,s,i,o,l,c){Ao=!1,Wc=null,v4.apply(y4,arguments)}function w4(e,t,n,r,s,i,o,l,c){if(b4.apply(this,arguments),Ao){if(Ao){var u=Wc;Ao=!1,Wc=null}else throw Error(oe(198));Vc||(Vc=!0,np=u)}}function Ks(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function m1(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function H0(e){if(Ks(e)!==e)throw Error(oe(188))}function N4(e){var t=e.alternate;if(!t){if(t=Ks(e),t===null)throw Error(oe(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return H0(s),e;if(i===r)return H0(s),t;i=i.sibling}throw Error(oe(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(oe(189))}}if(n.alternate!==r)throw Error(oe(190))}if(n.tag!==3)throw Error(oe(188));return n.stateNode.current===n?e:t}function x1(e){return e=N4(e),e!==null?g1(e):null}function g1(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=g1(e);if(t!==null)return t;e=e.sibling}return null}var v1=Hn.unstable_scheduleCallback,q0=Hn.unstable_cancelCallback,j4=Hn.unstable_shouldYield,C4=Hn.unstable_requestPaint,jt=Hn.unstable_now,k4=Hn.unstable_getCurrentPriorityLevel,Rf=Hn.unstable_ImmediatePriority,y1=Hn.unstable_UserBlockingPriority,Hc=Hn.unstable_NormalPriority,S4=Hn.unstable_LowPriority,b1=Hn.unstable_IdlePriority,Hu=null,$r=null;function E4(e){if($r&&typeof $r.onCommitFiberRoot=="function")try{$r.onCommitFiberRoot(Hu,e,void 0,(e.current.flags&128)===128)}catch{}}var vr=Math.clz32?Math.clz32:_4,D4=Math.log,R4=Math.LN2;function _4(e){return e>>>=0,e===0?32:31-(D4(e)/R4|0)|0}var Hl=64,ql=4194304;function Ro(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function qc(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=Ro(l):(i&=o,i!==0&&(r=Ro(i)))}else o=n&~s,o!==0?r=Ro(o):i!==0&&(r=Ro(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-vr(t),s=1<<n,r|=e[n],t&=~s;return r}function T4(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function A4(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-vr(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=T4(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function rp(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function w1(){var e=Hl;return Hl<<=1,!(Hl&4194240)&&(Hl=64),e}function $d(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vl(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-vr(t),e[t]=n}function I4(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-vr(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function _f(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-vr(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var et=0;function N1(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var j1,Tf,C1,k1,S1,ap=!1,Gl=[],Wa=null,Va=null,Ha=null,qo=new Map,Go=new Map,Fa=[],P4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function G0(e,t){switch(e){case"focusin":case"focusout":Wa=null;break;case"dragenter":case"dragleave":Va=null;break;case"mouseover":case"mouseout":Ha=null;break;case"pointerover":case"pointerout":qo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Go.delete(t.pointerId)}}function mo(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=bl(t),t!==null&&Tf(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function F4(e,t,n,r,s){switch(t){case"focusin":return Wa=mo(Wa,e,t,n,r,s),!0;case"dragenter":return Va=mo(Va,e,t,n,r,s),!0;case"mouseover":return Ha=mo(Ha,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return qo.set(i,mo(qo.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Go.set(i,mo(Go.get(i)||null,e,t,n,r,s)),!0}return!1}function E1(e){var t=Ss(e.target);if(t!==null){var n=Ks(t);if(n!==null){if(t=n.tag,t===13){if(t=m1(n),t!==null){e.blockedOn=t,S1(e.priority,function(){C1(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function jc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=sp(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Zh=r,n.target.dispatchEvent(r),Zh=null}else return t=bl(n),t!==null&&Tf(t),e.blockedOn=n,!1;t.shift()}return!0}function K0(e,t,n){jc(e)&&n.delete(t)}function M4(){ap=!1,Wa!==null&&jc(Wa)&&(Wa=null),Va!==null&&jc(Va)&&(Va=null),Ha!==null&&jc(Ha)&&(Ha=null),qo.forEach(K0),Go.forEach(K0)}function xo(e,t){e.blockedOn===t&&(e.blockedOn=null,ap||(ap=!0,Hn.unstable_scheduleCallback(Hn.unstable_NormalPriority,M4)))}function Ko(e){function t(s){return xo(s,e)}if(0<Gl.length){xo(Gl[0],e);for(var n=1;n<Gl.length;n++){var r=Gl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Wa!==null&&xo(Wa,e),Va!==null&&xo(Va,e),Ha!==null&&xo(Ha,e),qo.forEach(t),Go.forEach(t),n=0;n<Fa.length;n++)r=Fa[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Fa.length&&(n=Fa[0],n.blockedOn===null);)E1(n),n.blockedOn===null&&Fa.shift()}var Ei=ba.ReactCurrentBatchConfig,Gc=!0;function L4(e,t,n,r){var s=et,i=Ei.transition;Ei.transition=null;try{et=1,Af(e,t,n,r)}finally{et=s,Ei.transition=i}}function O4(e,t,n,r){var s=et,i=Ei.transition;Ei.transition=null;try{et=4,Af(e,t,n,r)}finally{et=s,Ei.transition=i}}function Af(e,t,n,r){if(Gc){var s=sp(e,t,n,r);if(s===null)Yd(e,t,r,Kc,n),G0(e,r);else if(F4(s,e,t,n,r))r.stopPropagation();else if(G0(e,r),t&4&&-1<P4.indexOf(e)){for(;s!==null;){var i=bl(s);if(i!==null&&j1(i),i=sp(e,t,n,r),i===null&&Yd(e,t,r,Kc,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Yd(e,t,r,null,n)}}var Kc=null;function sp(e,t,n,r){if(Kc=null,e=Df(r),e=Ss(e),e!==null)if(t=Ks(e),t===null)e=null;else if(n=t.tag,n===13){if(e=m1(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kc=e,null}function D1(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(k4()){case Rf:return 1;case y1:return 4;case Hc:case S4:return 16;case b1:return 536870912;default:return 16}default:return 16}}var Oa=null,If=null,Cc=null;function R1(){if(Cc)return Cc;var e,t=If,n=t.length,r,s="value"in Oa?Oa.value:Oa.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===s[i-r];r++);return Cc=s.slice(e,1<r?1-r:void 0)}function kc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Kl(){return!0}function X0(){return!1}function Kn(e){function t(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Kl:X0,this.isPropagationStopped=X0,this}return yt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Kl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Kl)},persist:function(){},isPersistent:Kl}),t}var no={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pf=Kn(no),yl=yt({},no,{view:0,detail:0}),B4=Kn(yl),zd,Ud,go,qu=yt({},yl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ff,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==go&&(go&&e.type==="mousemove"?(zd=e.screenX-go.screenX,Ud=e.screenY-go.screenY):Ud=zd=0,go=e),zd)},movementY:function(e){return"movementY"in e?e.movementY:Ud}}),Y0=Kn(qu),$4=yt({},qu,{dataTransfer:0}),z4=Kn($4),U4=yt({},yl,{relatedTarget:0}),Wd=Kn(U4),W4=yt({},no,{animationName:0,elapsedTime:0,pseudoElement:0}),V4=Kn(W4),H4=yt({},no,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),q4=Kn(H4),G4=yt({},no,{data:0}),Q0=Kn(G4),K4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},X4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Y4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Q4(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Y4[e])?!!t[e]:!1}function Ff(){return Q4}var J4=yt({},yl,{key:function(e){if(e.key){var t=K4[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=kc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?X4[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ff,charCode:function(e){return e.type==="keypress"?kc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?kc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Z4=Kn(J4),ek=yt({},qu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),J0=Kn(ek),tk=yt({},yl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ff}),nk=Kn(tk),rk=yt({},no,{propertyName:0,elapsedTime:0,pseudoElement:0}),ak=Kn(rk),sk=yt({},qu,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ik=Kn(sk),ok=[9,13,27,32],Mf=da&&"CompositionEvent"in window,Io=null;da&&"documentMode"in document&&(Io=document.documentMode);var lk=da&&"TextEvent"in window&&!Io,_1=da&&(!Mf||Io&&8<Io&&11>=Io),Z0=" ",ev=!1;function T1(e,t){switch(e){case"keyup":return ok.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function A1(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var fi=!1;function ck(e,t){switch(e){case"compositionend":return A1(t);case"keypress":return t.which!==32?null:(ev=!0,Z0);case"textInput":return e=t.data,e===Z0&&ev?null:e;default:return null}}function uk(e,t){if(fi)return e==="compositionend"||!Mf&&T1(e,t)?(e=R1(),Cc=If=Oa=null,fi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return _1&&t.locale!=="ko"?null:t.data;default:return null}}var dk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function tv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!dk[e.type]:t==="textarea"}function I1(e,t,n,r){u1(r),t=Xc(t,"onChange"),0<t.length&&(n=new Pf("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Po=null,Xo=null;function hk(e){V1(e,0)}function Gu(e){var t=gi(e);if(r1(t))return e}function pk(e,t){if(e==="change")return t}var P1=!1;if(da){var Vd;if(da){var Hd="oninput"in document;if(!Hd){var nv=document.createElement("div");nv.setAttribute("oninput","return;"),Hd=typeof nv.oninput=="function"}Vd=Hd}else Vd=!1;P1=Vd&&(!document.documentMode||9<document.documentMode)}function rv(){Po&&(Po.detachEvent("onpropertychange",F1),Xo=Po=null)}function F1(e){if(e.propertyName==="value"&&Gu(Xo)){var t=[];I1(t,Xo,e,Df(e)),f1(hk,t)}}function fk(e,t,n){e==="focusin"?(rv(),Po=t,Xo=n,Po.attachEvent("onpropertychange",F1)):e==="focusout"&&rv()}function mk(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Gu(Xo)}function xk(e,t){if(e==="click")return Gu(t)}function gk(e,t){if(e==="input"||e==="change")return Gu(t)}function vk(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var wr=typeof Object.is=="function"?Object.is:vk;function Yo(e,t){if(wr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!zh.call(t,s)||!wr(e[s],t[s]))return!1}return!0}function av(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function sv(e,t){var n=av(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=av(n)}}function M1(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?M1(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function L1(){for(var e=window,t=Uc();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Uc(e.document)}return t}function Lf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function yk(e){var t=L1(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&M1(n.ownerDocument.documentElement,n)){if(r!==null&&Lf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=sv(n,i);var o=sv(n,r);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var bk=da&&"documentMode"in document&&11>=document.documentMode,mi=null,ip=null,Fo=null,op=!1;function iv(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;op||mi==null||mi!==Uc(r)||(r=mi,"selectionStart"in r&&Lf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Fo&&Yo(Fo,r)||(Fo=r,r=Xc(ip,"onSelect"),0<r.length&&(t=new Pf("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mi)))}function Xl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var xi={animationend:Xl("Animation","AnimationEnd"),animationiteration:Xl("Animation","AnimationIteration"),animationstart:Xl("Animation","AnimationStart"),transitionend:Xl("Transition","TransitionEnd")},qd={},O1={};da&&(O1=document.createElement("div").style,"AnimationEvent"in window||(delete xi.animationend.animation,delete xi.animationiteration.animation,delete xi.animationstart.animation),"TransitionEvent"in window||delete xi.transitionend.transition);function Ku(e){if(qd[e])return qd[e];if(!xi[e])return e;var t=xi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in O1)return qd[e]=t[n];return e}var B1=Ku("animationend"),$1=Ku("animationiteration"),z1=Ku("animationstart"),U1=Ku("transitionend"),W1=new Map,ov="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function cs(e,t){W1.set(e,t),Gs(t,[e])}for(var Gd=0;Gd<ov.length;Gd++){var Kd=ov[Gd],wk=Kd.toLowerCase(),Nk=Kd[0].toUpperCase()+Kd.slice(1);cs(wk,"on"+Nk)}cs(B1,"onAnimationEnd");cs($1,"onAnimationIteration");cs(z1,"onAnimationStart");cs("dblclick","onDoubleClick");cs("focusin","onFocus");cs("focusout","onBlur");cs(U1,"onTransitionEnd");Oi("onMouseEnter",["mouseout","mouseover"]);Oi("onMouseLeave",["mouseout","mouseover"]);Oi("onPointerEnter",["pointerout","pointerover"]);Oi("onPointerLeave",["pointerout","pointerover"]);Gs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Gs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Gs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Gs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Gs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Gs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _o="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jk=new Set("cancel close invalid load scroll toggle".split(" ").concat(_o));function lv(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,w4(r,t,void 0,e),e.currentTarget=null}function V1(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;lv(s,l,u),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;lv(s,l,u),i=c}}}if(Vc)throw e=np,Vc=!1,np=null,e}function lt(e,t){var n=t[hp];n===void 0&&(n=t[hp]=new Set);var r=e+"__bubble";n.has(r)||(H1(t,e,2,!1),n.add(r))}function Xd(e,t,n){var r=0;t&&(r|=4),H1(n,e,r,t)}var Yl="_reactListening"+Math.random().toString(36).slice(2);function Qo(e){if(!e[Yl]){e[Yl]=!0,Jb.forEach(function(n){n!=="selectionchange"&&(jk.has(n)||Xd(n,!1,e),Xd(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Yl]||(t[Yl]=!0,Xd("selectionchange",!1,t))}}function H1(e,t,n,r){switch(D1(t)){case 1:var s=L4;break;case 4:s=O4;break;default:s=Af}n=s.bind(null,t,n,e),s=void 0,!tp||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Yd(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Ss(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}f1(function(){var u=i,d=Df(n),h=[];e:{var p=W1.get(e);if(p!==void 0){var f=Pf,x=e;switch(e){case"keypress":if(kc(n)===0)break e;case"keydown":case"keyup":f=Z4;break;case"focusin":x="focus",f=Wd;break;case"focusout":x="blur",f=Wd;break;case"beforeblur":case"afterblur":f=Wd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=Y0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=z4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=nk;break;case B1:case $1:case z1:f=V4;break;case U1:f=ak;break;case"scroll":f=B4;break;case"wheel":f=ik;break;case"copy":case"cut":case"paste":f=q4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=J0}var v=(t&4)!==0,y=!v&&e==="scroll",m=v?p!==null?p+"Capture":null:p;v=[];for(var g=u,b;g!==null;){b=g;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,m!==null&&(w=Ho(g,m),w!=null&&v.push(Jo(g,w,b)))),y)break;g=g.return}0<v.length&&(p=new f(p,x,null,n,d),h.push({event:p,listeners:v}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",p&&n!==Zh&&(x=n.relatedTarget||n.fromElement)&&(Ss(x)||x[ha]))break e;if((f||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,f?(x=n.relatedTarget||n.toElement,f=u,x=x?Ss(x):null,x!==null&&(y=Ks(x),x!==y||x.tag!==5&&x.tag!==6)&&(x=null)):(f=null,x=u),f!==x)){if(v=Y0,w="onMouseLeave",m="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(v=J0,w="onPointerLeave",m="onPointerEnter",g="pointer"),y=f==null?p:gi(f),b=x==null?p:gi(x),p=new v(w,g+"leave",f,n,d),p.target=y,p.relatedTarget=b,w=null,Ss(d)===u&&(v=new v(m,g+"enter",x,n,d),v.target=b,v.relatedTarget=y,w=v),y=w,f&&x)t:{for(v=f,m=x,g=0,b=v;b;b=ri(b))g++;for(b=0,w=m;w;w=ri(w))b++;for(;0<g-b;)v=ri(v),g--;for(;0<b-g;)m=ri(m),b--;for(;g--;){if(v===m||m!==null&&v===m.alternate)break t;v=ri(v),m=ri(m)}v=null}else v=null;f!==null&&cv(h,p,f,v,!1),x!==null&&y!==null&&cv(h,y,x,v,!0)}}e:{if(p=u?gi(u):window,f=p.nodeName&&p.nodeName.toLowerCase(),f==="select"||f==="input"&&p.type==="file")var N=pk;else if(tv(p))if(P1)N=gk;else{N=mk;var C=fk}else(f=p.nodeName)&&f.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(N=xk);if(N&&(N=N(e,u))){I1(h,N,n,d);break e}C&&C(e,p,u),e==="focusout"&&(C=p._wrapperState)&&C.controlled&&p.type==="number"&&Kh(p,"number",p.value)}switch(C=u?gi(u):window,e){case"focusin":(tv(C)||C.contentEditable==="true")&&(mi=C,ip=u,Fo=null);break;case"focusout":Fo=ip=mi=null;break;case"mousedown":op=!0;break;case"contextmenu":case"mouseup":case"dragend":op=!1,iv(h,n,d);break;case"selectionchange":if(bk)break;case"keydown":case"keyup":iv(h,n,d)}var D;if(Mf)e:{switch(e){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else fi?T1(e,n)&&(j="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(j="onCompositionStart");j&&(_1&&n.locale!=="ko"&&(fi||j!=="onCompositionStart"?j==="onCompositionEnd"&&fi&&(D=R1()):(Oa=d,If="value"in Oa?Oa.value:Oa.textContent,fi=!0)),C=Xc(u,j),0<C.length&&(j=new Q0(j,e,null,n,d),h.push({event:j,listeners:C}),D?j.data=D:(D=A1(n),D!==null&&(j.data=D)))),(D=lk?ck(e,n):uk(e,n))&&(u=Xc(u,"onBeforeInput"),0<u.length&&(d=new Q0("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=D))}V1(h,t)})}function Jo(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Xc(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Ho(e,n),i!=null&&r.unshift(Jo(e,i,s)),i=Ho(e,t),i!=null&&r.push(Jo(e,i,s))),e=e.return}return r}function ri(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function cv(e,t,n,r,s){for(var i=t._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=Ho(n,i),c!=null&&o.unshift(Jo(n,c,l))):s||(c=Ho(n,i),c!=null&&o.push(Jo(n,c,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var Ck=/\r\n?/g,kk=/\u0000|\uFFFD/g;function uv(e){return(typeof e=="string"?e:""+e).replace(Ck,`
`).replace(kk,"")}function Ql(e,t,n){if(t=uv(t),uv(e)!==t&&n)throw Error(oe(425))}function Yc(){}var lp=null,cp=null;function up(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var dp=typeof setTimeout=="function"?setTimeout:void 0,Sk=typeof clearTimeout=="function"?clearTimeout:void 0,dv=typeof Promise=="function"?Promise:void 0,Ek=typeof queueMicrotask=="function"?queueMicrotask:typeof dv<"u"?function(e){return dv.resolve(null).then(e).catch(Dk)}:dp;function Dk(e){setTimeout(function(){throw e})}function Qd(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),Ko(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Ko(t)}function qa(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function hv(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var ro=Math.random().toString(36).slice(2),Pr="__reactFiber$"+ro,Zo="__reactProps$"+ro,ha="__reactContainer$"+ro,hp="__reactEvents$"+ro,Rk="__reactListeners$"+ro,_k="__reactHandles$"+ro;function Ss(e){var t=e[Pr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ha]||n[Pr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=hv(e);e!==null;){if(n=e[Pr])return n;e=hv(e)}return t}e=n,n=e.parentNode}return null}function bl(e){return e=e[Pr]||e[ha],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function gi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(oe(33))}function Xu(e){return e[Zo]||null}var pp=[],vi=-1;function us(e){return{current:e}}function ut(e){0>vi||(e.current=pp[vi],pp[vi]=null,vi--)}function at(e,t){vi++,pp[vi]=e.current,e.current=t}var rs={},pn=us(rs),En=us(!1),Ls=rs;function Bi(e,t){var n=e.type.contextTypes;if(!n)return rs;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Dn(e){return e=e.childContextTypes,e!=null}function Qc(){ut(En),ut(pn)}function pv(e,t,n){if(pn.current!==rs)throw Error(oe(168));at(pn,t),at(En,n)}function q1(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(oe(108,f4(e)||"Unknown",s));return yt({},n,r)}function Jc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||rs,Ls=pn.current,at(pn,e),at(En,En.current),!0}function fv(e,t,n){var r=e.stateNode;if(!r)throw Error(oe(169));n?(e=q1(e,t,Ls),r.__reactInternalMemoizedMergedChildContext=e,ut(En),ut(pn),at(pn,e)):ut(En),at(En,n)}var aa=null,Yu=!1,Jd=!1;function G1(e){aa===null?aa=[e]:aa.push(e)}function Tk(e){Yu=!0,G1(e)}function ds(){if(!Jd&&aa!==null){Jd=!0;var e=0,t=et;try{var n=aa;for(et=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}aa=null,Yu=!1}catch(s){throw aa!==null&&(aa=aa.slice(e+1)),v1(Rf,ds),s}finally{et=t,Jd=!1}}return null}var yi=[],bi=0,Zc=null,eu=0,Yn=[],Qn=0,Os=null,ia=1,oa="";function bs(e,t){yi[bi++]=eu,yi[bi++]=Zc,Zc=e,eu=t}function K1(e,t,n){Yn[Qn++]=ia,Yn[Qn++]=oa,Yn[Qn++]=Os,Os=e;var r=ia;e=oa;var s=32-vr(r)-1;r&=~(1<<s),n+=1;var i=32-vr(t)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,ia=1<<32-vr(t)+s|n<<s|r,oa=i+e}else ia=1<<i|n<<s|r,oa=e}function Of(e){e.return!==null&&(bs(e,1),K1(e,1,0))}function Bf(e){for(;e===Zc;)Zc=yi[--bi],yi[bi]=null,eu=yi[--bi],yi[bi]=null;for(;e===Os;)Os=Yn[--Qn],Yn[Qn]=null,oa=Yn[--Qn],Yn[Qn]=null,ia=Yn[--Qn],Yn[Qn]=null}var Wn=null,On=null,ht=!1,fr=null;function X1(e,t){var n=er(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function mv(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Wn=e,On=qa(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Wn=e,On=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Os!==null?{id:ia,overflow:oa}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=er(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Wn=e,On=null,!0):!1;default:return!1}}function fp(e){return(e.mode&1)!==0&&(e.flags&128)===0}function mp(e){if(ht){var t=On;if(t){var n=t;if(!mv(e,t)){if(fp(e))throw Error(oe(418));t=qa(n.nextSibling);var r=Wn;t&&mv(e,t)?X1(r,n):(e.flags=e.flags&-4097|2,ht=!1,Wn=e)}}else{if(fp(e))throw Error(oe(418));e.flags=e.flags&-4097|2,ht=!1,Wn=e}}}function xv(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Wn=e}function Jl(e){if(e!==Wn)return!1;if(!ht)return xv(e),ht=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!up(e.type,e.memoizedProps)),t&&(t=On)){if(fp(e))throw Y1(),Error(oe(418));for(;t;)X1(e,t),t=qa(t.nextSibling)}if(xv(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(oe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){On=qa(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}On=null}}else On=Wn?qa(e.stateNode.nextSibling):null;return!0}function Y1(){for(var e=On;e;)e=qa(e.nextSibling)}function $i(){On=Wn=null,ht=!1}function $f(e){fr===null?fr=[e]:fr.push(e)}var Ak=ba.ReactCurrentBatchConfig;function vo(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(oe(309));var r=n.stateNode}if(!r)throw Error(oe(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(oe(284));if(!n._owner)throw Error(oe(290,e))}return e}function Zl(e,t){throw e=Object.prototype.toString.call(t),Error(oe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function gv(e){var t=e._init;return t(e._payload)}function Q1(e){function t(m,g){if(e){var b=m.deletions;b===null?(m.deletions=[g],m.flags|=16):b.push(g)}}function n(m,g){if(!e)return null;for(;g!==null;)t(m,g),g=g.sibling;return null}function r(m,g){for(m=new Map;g!==null;)g.key!==null?m.set(g.key,g):m.set(g.index,g),g=g.sibling;return m}function s(m,g){return m=Ya(m,g),m.index=0,m.sibling=null,m}function i(m,g,b){return m.index=b,e?(b=m.alternate,b!==null?(b=b.index,b<g?(m.flags|=2,g):b):(m.flags|=2,g)):(m.flags|=1048576,g)}function o(m){return e&&m.alternate===null&&(m.flags|=2),m}function l(m,g,b,w){return g===null||g.tag!==6?(g=sh(b,m.mode,w),g.return=m,g):(g=s(g,b),g.return=m,g)}function c(m,g,b,w){var N=b.type;return N===pi?d(m,g,b.props.children,w,b.key):g!==null&&(g.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Ia&&gv(N)===g.type)?(w=s(g,b.props),w.ref=vo(m,g,b),w.return=m,w):(w=Ac(b.type,b.key,b.props,null,m.mode,w),w.ref=vo(m,g,b),w.return=m,w)}function u(m,g,b,w){return g===null||g.tag!==4||g.stateNode.containerInfo!==b.containerInfo||g.stateNode.implementation!==b.implementation?(g=ih(b,m.mode,w),g.return=m,g):(g=s(g,b.children||[]),g.return=m,g)}function d(m,g,b,w,N){return g===null||g.tag!==7?(g=Is(b,m.mode,w,N),g.return=m,g):(g=s(g,b),g.return=m,g)}function h(m,g,b){if(typeof g=="string"&&g!==""||typeof g=="number")return g=sh(""+g,m.mode,b),g.return=m,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Ul:return b=Ac(g.type,g.key,g.props,null,m.mode,b),b.ref=vo(m,null,g),b.return=m,b;case hi:return g=ih(g,m.mode,b),g.return=m,g;case Ia:var w=g._init;return h(m,w(g._payload),b)}if(Do(g)||po(g))return g=Is(g,m.mode,b,null),g.return=m,g;Zl(m,g)}return null}function p(m,g,b,w){var N=g!==null?g.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return N!==null?null:l(m,g,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ul:return b.key===N?c(m,g,b,w):null;case hi:return b.key===N?u(m,g,b,w):null;case Ia:return N=b._init,p(m,g,N(b._payload),w)}if(Do(b)||po(b))return N!==null?null:d(m,g,b,w,null);Zl(m,b)}return null}function f(m,g,b,w,N){if(typeof w=="string"&&w!==""||typeof w=="number")return m=m.get(b)||null,l(g,m,""+w,N);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ul:return m=m.get(w.key===null?b:w.key)||null,c(g,m,w,N);case hi:return m=m.get(w.key===null?b:w.key)||null,u(g,m,w,N);case Ia:var C=w._init;return f(m,g,b,C(w._payload),N)}if(Do(w)||po(w))return m=m.get(b)||null,d(g,m,w,N,null);Zl(g,w)}return null}function x(m,g,b,w){for(var N=null,C=null,D=g,j=g=0,k=null;D!==null&&j<b.length;j++){D.index>j?(k=D,D=null):k=D.sibling;var R=p(m,D,b[j],w);if(R===null){D===null&&(D=k);break}e&&D&&R.alternate===null&&t(m,D),g=i(R,g,j),C===null?N=R:C.sibling=R,C=R,D=k}if(j===b.length)return n(m,D),ht&&bs(m,j),N;if(D===null){for(;j<b.length;j++)D=h(m,b[j],w),D!==null&&(g=i(D,g,j),C===null?N=D:C.sibling=D,C=D);return ht&&bs(m,j),N}for(D=r(m,D);j<b.length;j++)k=f(D,m,j,b[j],w),k!==null&&(e&&k.alternate!==null&&D.delete(k.key===null?j:k.key),g=i(k,g,j),C===null?N=k:C.sibling=k,C=k);return e&&D.forEach(function(E){return t(m,E)}),ht&&bs(m,j),N}function v(m,g,b,w){var N=po(b);if(typeof N!="function")throw Error(oe(150));if(b=N.call(b),b==null)throw Error(oe(151));for(var C=N=null,D=g,j=g=0,k=null,R=b.next();D!==null&&!R.done;j++,R=b.next()){D.index>j?(k=D,D=null):k=D.sibling;var E=p(m,D,R.value,w);if(E===null){D===null&&(D=k);break}e&&D&&E.alternate===null&&t(m,D),g=i(E,g,j),C===null?N=E:C.sibling=E,C=E,D=k}if(R.done)return n(m,D),ht&&bs(m,j),N;if(D===null){for(;!R.done;j++,R=b.next())R=h(m,R.value,w),R!==null&&(g=i(R,g,j),C===null?N=R:C.sibling=R,C=R);return ht&&bs(m,j),N}for(D=r(m,D);!R.done;j++,R=b.next())R=f(D,m,j,R.value,w),R!==null&&(e&&R.alternate!==null&&D.delete(R.key===null?j:R.key),g=i(R,g,j),C===null?N=R:C.sibling=R,C=R);return e&&D.forEach(function(P){return t(m,P)}),ht&&bs(m,j),N}function y(m,g,b,w){if(typeof b=="object"&&b!==null&&b.type===pi&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Ul:e:{for(var N=b.key,C=g;C!==null;){if(C.key===N){if(N=b.type,N===pi){if(C.tag===7){n(m,C.sibling),g=s(C,b.props.children),g.return=m,m=g;break e}}else if(C.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Ia&&gv(N)===C.type){n(m,C.sibling),g=s(C,b.props),g.ref=vo(m,C,b),g.return=m,m=g;break e}n(m,C);break}else t(m,C);C=C.sibling}b.type===pi?(g=Is(b.props.children,m.mode,w,b.key),g.return=m,m=g):(w=Ac(b.type,b.key,b.props,null,m.mode,w),w.ref=vo(m,g,b),w.return=m,m=w)}return o(m);case hi:e:{for(C=b.key;g!==null;){if(g.key===C)if(g.tag===4&&g.stateNode.containerInfo===b.containerInfo&&g.stateNode.implementation===b.implementation){n(m,g.sibling),g=s(g,b.children||[]),g.return=m,m=g;break e}else{n(m,g);break}else t(m,g);g=g.sibling}g=ih(b,m.mode,w),g.return=m,m=g}return o(m);case Ia:return C=b._init,y(m,g,C(b._payload),w)}if(Do(b))return x(m,g,b,w);if(po(b))return v(m,g,b,w);Zl(m,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,g!==null&&g.tag===6?(n(m,g.sibling),g=s(g,b),g.return=m,m=g):(n(m,g),g=sh(b,m.mode,w),g.return=m,m=g),o(m)):n(m,g)}return y}var zi=Q1(!0),J1=Q1(!1),tu=us(null),nu=null,wi=null,zf=null;function Uf(){zf=wi=nu=null}function Wf(e){var t=tu.current;ut(tu),e._currentValue=t}function xp(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Di(e,t){nu=e,zf=wi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Sn=!0),e.firstContext=null)}function ar(e){var t=e._currentValue;if(zf!==e)if(e={context:e,memoizedValue:t,next:null},wi===null){if(nu===null)throw Error(oe(308));wi=e,nu.dependencies={lanes:0,firstContext:e}}else wi=wi.next=e;return t}var Es=null;function Vf(e){Es===null?Es=[e]:Es.push(e)}function Z1(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,Vf(t)):(n.next=s.next,s.next=n),t.interleaved=n,pa(e,r)}function pa(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Pa=!1;function Hf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function e2(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function la(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ga(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Xe&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,pa(e,n)}return s=r.interleaved,s===null?(t.next=t,Vf(r)):(t.next=s.next,s.next=t),r.interleaved=t,pa(e,n)}function Sc(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,_f(e,n)}}function vv(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ru(e,t,n,r){var s=e.updateQueue;Pa=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;o=0,d=u=c=null,l=i;do{var p=l.lane,f=l.eventTime;if((r&p)===p){d!==null&&(d=d.next={eventTime:f,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,v=l;switch(p=t,f=n,v.tag){case 1:if(x=v.payload,typeof x=="function"){h=x.call(f,h,p);break e}h=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=v.payload,p=typeof x=="function"?x.call(f,h,p):x,p==null)break e;h=yt({},h,p);break e;case 2:Pa=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else f={eventTime:f,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=f,c=h):d=d.next=f,o|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(d===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);$s|=o,e.lanes=o,e.memoizedState=h}}function yv(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(oe(191,s));s.call(r)}}}var wl={},zr=us(wl),el=us(wl),tl=us(wl);function Ds(e){if(e===wl)throw Error(oe(174));return e}function qf(e,t){switch(at(tl,t),at(el,e),at(zr,wl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Yh(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Yh(t,e)}ut(zr),at(zr,t)}function Ui(){ut(zr),ut(el),ut(tl)}function t2(e){Ds(tl.current);var t=Ds(zr.current),n=Yh(t,e.type);t!==n&&(at(el,e),at(zr,n))}function Gf(e){el.current===e&&(ut(zr),ut(el))}var mt=us(0);function au(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Zd=[];function Kf(){for(var e=0;e<Zd.length;e++)Zd[e]._workInProgressVersionPrimary=null;Zd.length=0}var Ec=ba.ReactCurrentDispatcher,eh=ba.ReactCurrentBatchConfig,Bs=0,vt=null,Ft=null,Ht=null,su=!1,Mo=!1,nl=0,Ik=0;function rn(){throw Error(oe(321))}function Xf(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!wr(e[n],t[n]))return!1;return!0}function Yf(e,t,n,r,s,i){if(Bs=i,vt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ec.current=e===null||e.memoizedState===null?Lk:Ok,e=n(r,s),Mo){i=0;do{if(Mo=!1,nl=0,25<=i)throw Error(oe(301));i+=1,Ht=Ft=null,t.updateQueue=null,Ec.current=Bk,e=n(r,s)}while(Mo)}if(Ec.current=iu,t=Ft!==null&&Ft.next!==null,Bs=0,Ht=Ft=vt=null,su=!1,t)throw Error(oe(300));return e}function Qf(){var e=nl!==0;return nl=0,e}function Tr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ht===null?vt.memoizedState=Ht=e:Ht=Ht.next=e,Ht}function sr(){if(Ft===null){var e=vt.alternate;e=e!==null?e.memoizedState:null}else e=Ft.next;var t=Ht===null?vt.memoizedState:Ht.next;if(t!==null)Ht=t,Ft=e;else{if(e===null)throw Error(oe(310));Ft=e,e={memoizedState:Ft.memoizedState,baseState:Ft.baseState,baseQueue:Ft.baseQueue,queue:Ft.queue,next:null},Ht===null?vt.memoizedState=Ht=e:Ht=Ht.next=e}return Ht}function rl(e,t){return typeof t=="function"?t(e):t}function th(e){var t=sr(),n=t.queue;if(n===null)throw Error(oe(311));n.lastRenderedReducer=e;var r=Ft,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((Bs&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,o=r):c=c.next=h,vt.lanes|=d,$s|=d}u=u.next}while(u!==null&&u!==i);c===null?o=r:c.next=l,wr(r,t.memoizedState)||(Sn=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,vt.lanes|=i,$s|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function nh(e){var t=sr(),n=t.queue;if(n===null)throw Error(oe(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);wr(i,t.memoizedState)||(Sn=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function n2(){}function r2(e,t){var n=vt,r=sr(),s=t(),i=!wr(r.memoizedState,s);if(i&&(r.memoizedState=s,Sn=!0),r=r.queue,Jf(i2.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||Ht!==null&&Ht.memoizedState.tag&1){if(n.flags|=2048,al(9,s2.bind(null,n,r,s,t),void 0,null),Gt===null)throw Error(oe(349));Bs&30||a2(n,t,s)}return s}function a2(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=vt.updateQueue,t===null?(t={lastEffect:null,stores:null},vt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function s2(e,t,n,r){t.value=n,t.getSnapshot=r,o2(t)&&l2(e)}function i2(e,t,n){return n(function(){o2(t)&&l2(e)})}function o2(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!wr(e,n)}catch{return!0}}function l2(e){var t=pa(e,1);t!==null&&yr(t,e,1,-1)}function bv(e){var t=Tr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:rl,lastRenderedState:e},t.queue=e,e=e.dispatch=Mk.bind(null,vt,e),[t.memoizedState,e]}function al(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=vt.updateQueue,t===null?(t={lastEffect:null,stores:null},vt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function c2(){return sr().memoizedState}function Dc(e,t,n,r){var s=Tr();vt.flags|=e,s.memoizedState=al(1|t,n,void 0,r===void 0?null:r)}function Qu(e,t,n,r){var s=sr();r=r===void 0?null:r;var i=void 0;if(Ft!==null){var o=Ft.memoizedState;if(i=o.destroy,r!==null&&Xf(r,o.deps)){s.memoizedState=al(t,n,i,r);return}}vt.flags|=e,s.memoizedState=al(1|t,n,i,r)}function wv(e,t){return Dc(8390656,8,e,t)}function Jf(e,t){return Qu(2048,8,e,t)}function u2(e,t){return Qu(4,2,e,t)}function d2(e,t){return Qu(4,4,e,t)}function h2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function p2(e,t,n){return n=n!=null?n.concat([e]):null,Qu(4,4,h2.bind(null,t,e),n)}function Zf(){}function f2(e,t){var n=sr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Xf(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function m2(e,t){var n=sr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Xf(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function x2(e,t,n){return Bs&21?(wr(n,t)||(n=w1(),vt.lanes|=n,$s|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Sn=!0),e.memoizedState=n)}function Pk(e,t){var n=et;et=n!==0&&4>n?n:4,e(!0);var r=eh.transition;eh.transition={};try{e(!1),t()}finally{et=n,eh.transition=r}}function g2(){return sr().memoizedState}function Fk(e,t,n){var r=Xa(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},v2(e))y2(t,n);else if(n=Z1(e,t,n,r),n!==null){var s=gn();yr(n,e,r,s),b2(n,t,r)}}function Mk(e,t,n){var r=Xa(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(v2(e))y2(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,wr(l,o)){var c=t.interleaved;c===null?(s.next=s,Vf(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}n=Z1(e,t,s,r),n!==null&&(s=gn(),yr(n,e,r,s),b2(n,t,r))}}function v2(e){var t=e.alternate;return e===vt||t!==null&&t===vt}function y2(e,t){Mo=su=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function b2(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,_f(e,n)}}var iu={readContext:ar,useCallback:rn,useContext:rn,useEffect:rn,useImperativeHandle:rn,useInsertionEffect:rn,useLayoutEffect:rn,useMemo:rn,useReducer:rn,useRef:rn,useState:rn,useDebugValue:rn,useDeferredValue:rn,useTransition:rn,useMutableSource:rn,useSyncExternalStore:rn,useId:rn,unstable_isNewReconciler:!1},Lk={readContext:ar,useCallback:function(e,t){return Tr().memoizedState=[e,t===void 0?null:t],e},useContext:ar,useEffect:wv,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Dc(4194308,4,h2.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Dc(4194308,4,e,t)},useInsertionEffect:function(e,t){return Dc(4,2,e,t)},useMemo:function(e,t){var n=Tr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Tr();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Fk.bind(null,vt,e),[r.memoizedState,e]},useRef:function(e){var t=Tr();return e={current:e},t.memoizedState=e},useState:bv,useDebugValue:Zf,useDeferredValue:function(e){return Tr().memoizedState=e},useTransition:function(){var e=bv(!1),t=e[0];return e=Pk.bind(null,e[1]),Tr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=vt,s=Tr();if(ht){if(n===void 0)throw Error(oe(407));n=n()}else{if(n=t(),Gt===null)throw Error(oe(349));Bs&30||a2(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,wv(i2.bind(null,r,i,e),[e]),r.flags|=2048,al(9,s2.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Tr(),t=Gt.identifierPrefix;if(ht){var n=oa,r=ia;n=(r&~(1<<32-vr(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=nl++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Ik++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Ok={readContext:ar,useCallback:f2,useContext:ar,useEffect:Jf,useImperativeHandle:p2,useInsertionEffect:u2,useLayoutEffect:d2,useMemo:m2,useReducer:th,useRef:c2,useState:function(){return th(rl)},useDebugValue:Zf,useDeferredValue:function(e){var t=sr();return x2(t,Ft.memoizedState,e)},useTransition:function(){var e=th(rl)[0],t=sr().memoizedState;return[e,t]},useMutableSource:n2,useSyncExternalStore:r2,useId:g2,unstable_isNewReconciler:!1},Bk={readContext:ar,useCallback:f2,useContext:ar,useEffect:Jf,useImperativeHandle:p2,useInsertionEffect:u2,useLayoutEffect:d2,useMemo:m2,useReducer:nh,useRef:c2,useState:function(){return nh(rl)},useDebugValue:Zf,useDeferredValue:function(e){var t=sr();return Ft===null?t.memoizedState=e:x2(t,Ft.memoizedState,e)},useTransition:function(){var e=nh(rl)[0],t=sr().memoizedState;return[e,t]},useMutableSource:n2,useSyncExternalStore:r2,useId:g2,unstable_isNewReconciler:!1};function hr(e,t){if(e&&e.defaultProps){t=yt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function gp(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:yt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Ju={isMounted:function(e){return(e=e._reactInternals)?Ks(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=gn(),s=Xa(e),i=la(r,s);i.payload=t,n!=null&&(i.callback=n),t=Ga(e,i,s),t!==null&&(yr(t,e,s,r),Sc(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=gn(),s=Xa(e),i=la(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Ga(e,i,s),t!==null&&(yr(t,e,s,r),Sc(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=gn(),r=Xa(e),s=la(n,r);s.tag=2,t!=null&&(s.callback=t),t=Ga(e,s,r),t!==null&&(yr(t,e,r,n),Sc(t,e,r))}};function Nv(e,t,n,r,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,o):t.prototype&&t.prototype.isPureReactComponent?!Yo(n,r)||!Yo(s,i):!0}function w2(e,t,n){var r=!1,s=rs,i=t.contextType;return typeof i=="object"&&i!==null?i=ar(i):(s=Dn(t)?Ls:pn.current,r=t.contextTypes,i=(r=r!=null)?Bi(e,s):rs),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Ju,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function jv(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ju.enqueueReplaceState(t,t.state,null)}function vp(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Hf(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=ar(i):(i=Dn(t)?Ls:pn.current,s.context=Bi(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(gp(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Ju.enqueueReplaceState(s,s.state,null),ru(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Wi(e,t){try{var n="",r=t;do n+=p4(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function rh(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function yp(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var $k=typeof WeakMap=="function"?WeakMap:Map;function N2(e,t,n){n=la(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){lu||(lu=!0,Rp=r),yp(e,t)},n}function j2(e,t,n){n=la(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){yp(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){yp(e,t),typeof r!="function"&&(Ka===null?Ka=new Set([this]):Ka.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function Cv(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new $k;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=eS.bind(null,e,t,n),t.then(e,e))}function kv(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Sv(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=la(-1,1),t.tag=2,Ga(n,t,1))),n.lanes|=1),e)}var zk=ba.ReactCurrentOwner,Sn=!1;function xn(e,t,n,r){t.child=e===null?J1(t,null,n,r):zi(t,e.child,n,r)}function Ev(e,t,n,r,s){n=n.render;var i=t.ref;return Di(t,s),r=Yf(e,t,n,r,i,s),n=Qf(),e!==null&&!Sn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,fa(e,t,s)):(ht&&n&&Of(t),t.flags|=1,xn(e,t,r,s),t.child)}function Dv(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!om(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,C2(e,t,i,r,s)):(e=Ac(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Yo,n(o,r)&&e.ref===t.ref)return fa(e,t,s)}return t.flags|=1,e=Ya(i,r),e.ref=t.ref,e.return=t,t.child=e}function C2(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(Yo(i,r)&&e.ref===t.ref)if(Sn=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(Sn=!0);else return t.lanes=e.lanes,fa(e,t,s)}return bp(e,t,n,r,s)}function k2(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},at(ji,Fn),Fn|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,at(ji,Fn),Fn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,at(ji,Fn),Fn|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,at(ji,Fn),Fn|=r;return xn(e,t,s,n),t.child}function S2(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function bp(e,t,n,r,s){var i=Dn(n)?Ls:pn.current;return i=Bi(t,i),Di(t,s),n=Yf(e,t,n,r,i,s),r=Qf(),e!==null&&!Sn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,fa(e,t,s)):(ht&&r&&Of(t),t.flags|=1,xn(e,t,n,s),t.child)}function Rv(e,t,n,r,s){if(Dn(n)){var i=!0;Jc(t)}else i=!1;if(Di(t,s),t.stateNode===null)Rc(e,t),w2(t,n,r),vp(t,n,r,s),r=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=ar(u):(u=Dn(n)?Ls:pn.current,u=Bi(t,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&jv(t,o,r,u),Pa=!1;var p=t.memoizedState;o.state=p,ru(t,r,o,s),c=t.memoizedState,l!==r||p!==c||En.current||Pa?(typeof d=="function"&&(gp(t,n,d,r),c=t.memoizedState),(l=Pa||Nv(t,n,l,r,p,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,e2(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:hr(t.type,l),o.props=u,h=t.pendingProps,p=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=ar(c):(c=Dn(n)?Ls:pn.current,c=Bi(t,c));var f=n.getDerivedStateFromProps;(d=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||p!==c)&&jv(t,o,r,c),Pa=!1,p=t.memoizedState,o.state=p,ru(t,r,o,s);var x=t.memoizedState;l!==h||p!==x||En.current||Pa?(typeof f=="function"&&(gp(t,n,f,r),x=t.memoizedState),(u=Pa||Nv(t,n,u,r,p,x,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=x),o.props=r,o.state=x,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return wp(e,t,n,r,i,s)}function wp(e,t,n,r,s,i){S2(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return s&&fv(t,n,!1),fa(e,t,i);r=t.stateNode,zk.current=t;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=zi(t,e.child,null,i),t.child=zi(t,null,l,i)):xn(e,t,l,i),t.memoizedState=r.state,s&&fv(t,n,!0),t.child}function E2(e){var t=e.stateNode;t.pendingContext?pv(e,t.pendingContext,t.pendingContext!==t.context):t.context&&pv(e,t.context,!1),qf(e,t.containerInfo)}function _v(e,t,n,r,s){return $i(),$f(s),t.flags|=256,xn(e,t,n,r),t.child}var Np={dehydrated:null,treeContext:null,retryLane:0};function jp(e){return{baseLanes:e,cachePool:null,transitions:null}}function D2(e,t,n){var r=t.pendingProps,s=mt.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),at(mt,s&1),e===null)return mp(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,i?(r=t.mode,i=t.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=td(o,r,0,null),e=Is(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=jp(n),t.memoizedState=Np,e):em(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return Uk(e,t,o,r,l,s,n);if(i){i=r.fallback,o=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=Ya(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Ya(l,i):(i=Is(i,o,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,o=e.child.memoizedState,o=o===null?jp(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~n,t.memoizedState=Np,r}return i=e.child,e=i.sibling,r=Ya(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function em(e,t){return t=td({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ec(e,t,n,r){return r!==null&&$f(r),zi(t,e.child,null,n),e=em(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Uk(e,t,n,r,s,i,o){if(n)return t.flags&256?(t.flags&=-257,r=rh(Error(oe(422))),ec(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=td({mode:"visible",children:r.children},s,0,null),i=Is(i,s,o,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&zi(t,e.child,null,o),t.child.memoizedState=jp(o),t.memoizedState=Np,i);if(!(t.mode&1))return ec(e,t,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(oe(419)),r=rh(i,r,void 0),ec(e,t,o,r)}if(l=(o&e.childLanes)!==0,Sn||l){if(r=Gt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,pa(e,s),yr(r,e,s,-1))}return im(),r=rh(Error(oe(421))),ec(e,t,o,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=tS.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,On=qa(s.nextSibling),Wn=t,ht=!0,fr=null,e!==null&&(Yn[Qn++]=ia,Yn[Qn++]=oa,Yn[Qn++]=Os,ia=e.id,oa=e.overflow,Os=t),t=em(t,r.children),t.flags|=4096,t)}function Tv(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),xp(e.return,t,n)}function ah(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function R2(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(xn(e,t,r.children,n),r=mt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Tv(e,n,t);else if(e.tag===19)Tv(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(at(mt,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&au(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),ah(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&au(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}ah(t,!0,n,null,i);break;case"together":ah(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Rc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function fa(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),$s|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(oe(153));if(t.child!==null){for(e=t.child,n=Ya(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Ya(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Wk(e,t,n){switch(t.tag){case 3:E2(t),$i();break;case 5:t2(t);break;case 1:Dn(t.type)&&Jc(t);break;case 4:qf(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;at(tu,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(at(mt,mt.current&1),t.flags|=128,null):n&t.child.childLanes?D2(e,t,n):(at(mt,mt.current&1),e=fa(e,t,n),e!==null?e.sibling:null);at(mt,mt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return R2(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),at(mt,mt.current),r)break;return null;case 22:case 23:return t.lanes=0,k2(e,t,n)}return fa(e,t,n)}var _2,Cp,T2,A2;_2=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Cp=function(){};T2=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,Ds(zr.current);var i=null;switch(n){case"input":s=qh(e,s),r=qh(e,r),i=[];break;case"select":s=yt({},s,{value:void 0}),r=yt({},r,{value:void 0}),i=[];break;case"textarea":s=Xh(e,s),r=Xh(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Yc)}Qh(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Wo.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Wo.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&lt("scroll",e),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};A2=function(e,t,n,r){n!==r&&(t.flags|=4)};function yo(e,t){if(!ht)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function an(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Vk(e,t,n){var r=t.pendingProps;switch(Bf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return an(t),null;case 1:return Dn(t.type)&&Qc(),an(t),null;case 3:return r=t.stateNode,Ui(),ut(En),ut(pn),Kf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Jl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,fr!==null&&(Ap(fr),fr=null))),Cp(e,t),an(t),null;case 5:Gf(t);var s=Ds(tl.current);if(n=t.type,e!==null&&t.stateNode!=null)T2(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(oe(166));return an(t),null}if(e=Ds(zr.current),Jl(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Pr]=t,r[Zo]=i,e=(t.mode&1)!==0,n){case"dialog":lt("cancel",r),lt("close",r);break;case"iframe":case"object":case"embed":lt("load",r);break;case"video":case"audio":for(s=0;s<_o.length;s++)lt(_o[s],r);break;case"source":lt("error",r);break;case"img":case"image":case"link":lt("error",r),lt("load",r);break;case"details":lt("toggle",r);break;case"input":$0(r,i),lt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},lt("invalid",r);break;case"textarea":U0(r,i),lt("invalid",r)}Qh(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Ql(r.textContent,l,e),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Ql(r.textContent,l,e),s=["children",""+l]):Wo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&lt("scroll",r)}switch(n){case"input":Wl(r),z0(r,i,!0);break;case"textarea":Wl(r),W0(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Yc)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=i1(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[Pr]=t,e[Zo]=r,_2(e,t,!1,!1),t.stateNode=e;e:{switch(o=Jh(n,r),n){case"dialog":lt("cancel",e),lt("close",e),s=r;break;case"iframe":case"object":case"embed":lt("load",e),s=r;break;case"video":case"audio":for(s=0;s<_o.length;s++)lt(_o[s],e);s=r;break;case"source":lt("error",e),s=r;break;case"img":case"image":case"link":lt("error",e),lt("load",e),s=r;break;case"details":lt("toggle",e),s=r;break;case"input":$0(e,r),s=qh(e,r),lt("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=yt({},r,{value:void 0}),lt("invalid",e);break;case"textarea":U0(e,r),s=Xh(e,r),lt("invalid",e);break;default:s=r}Qh(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?c1(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&o1(e,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Vo(e,c):typeof c=="number"&&Vo(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Wo.hasOwnProperty(i)?c!=null&&i==="onScroll"&&lt("scroll",e):c!=null&&Cf(e,i,c,o))}switch(n){case"input":Wl(e),z0(e,r,!1);break;case"textarea":Wl(e),W0(e);break;case"option":r.value!=null&&e.setAttribute("value",""+ns(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Ci(e,!!r.multiple,i,!1):r.defaultValue!=null&&Ci(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Yc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return an(t),null;case 6:if(e&&t.stateNode!=null)A2(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(oe(166));if(n=Ds(tl.current),Ds(zr.current),Jl(t)){if(r=t.stateNode,n=t.memoizedProps,r[Pr]=t,(i=r.nodeValue!==n)&&(e=Wn,e!==null))switch(e.tag){case 3:Ql(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ql(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Pr]=t,t.stateNode=r}return an(t),null;case 13:if(ut(mt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ht&&On!==null&&t.mode&1&&!(t.flags&128))Y1(),$i(),t.flags|=98560,i=!1;else if(i=Jl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(oe(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(oe(317));i[Pr]=t}else $i(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;an(t),i=!1}else fr!==null&&(Ap(fr),fr=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||mt.current&1?Lt===0&&(Lt=3):im())),t.updateQueue!==null&&(t.flags|=4),an(t),null);case 4:return Ui(),Cp(e,t),e===null&&Qo(t.stateNode.containerInfo),an(t),null;case 10:return Wf(t.type._context),an(t),null;case 17:return Dn(t.type)&&Qc(),an(t),null;case 19:if(ut(mt),i=t.memoizedState,i===null)return an(t),null;if(r=(t.flags&128)!==0,o=i.rendering,o===null)if(r)yo(i,!1);else{if(Lt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=au(e),o!==null){for(t.flags|=128,yo(i,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return at(mt,mt.current&1|2),t.child}e=e.sibling}i.tail!==null&&jt()>Vi&&(t.flags|=128,r=!0,yo(i,!1),t.lanes=4194304)}else{if(!r)if(e=au(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),yo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ht)return an(t),null}else 2*jt()-i.renderingStartTime>Vi&&n!==1073741824&&(t.flags|=128,r=!0,yo(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(n=i.last,n!==null?n.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=jt(),t.sibling=null,n=mt.current,at(mt,r?n&1|2:n&1),t):(an(t),null);case 22:case 23:return sm(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Fn&1073741824&&(an(t),t.subtreeFlags&6&&(t.flags|=8192)):an(t),null;case 24:return null;case 25:return null}throw Error(oe(156,t.tag))}function Hk(e,t){switch(Bf(t),t.tag){case 1:return Dn(t.type)&&Qc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ui(),ut(En),ut(pn),Kf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Gf(t),null;case 13:if(ut(mt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(oe(340));$i()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ut(mt),null;case 4:return Ui(),null;case 10:return Wf(t.type._context),null;case 22:case 23:return sm(),null;case 24:return null;default:return null}}var tc=!1,on=!1,qk=typeof WeakSet=="function"?WeakSet:Set,ge=null;function Ni(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Nt(e,t,r)}else n.current=null}function kp(e,t,n){try{n()}catch(r){Nt(e,t,r)}}var Av=!1;function Gk(e,t){if(lp=Gc,e=L1(),Lf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||s!==0&&h.nodeType!==3||(l=o+s),h!==i||r!==0&&h.nodeType!==3||(c=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(f=h.firstChild)!==null;)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++u===s&&(l=o),p===i&&++d===r&&(c=o),(f=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=f}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(cp={focusedElem:e,selectionRange:n},Gc=!1,ge=t;ge!==null;)if(t=ge,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ge=e;else for(;ge!==null;){t=ge;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var v=x.memoizedProps,y=x.memoizedState,m=t.stateNode,g=m.getSnapshotBeforeUpdate(t.elementType===t.type?v:hr(t.type,v),y);m.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(oe(163))}}catch(w){Nt(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,ge=e;break}ge=t.return}return x=Av,Av=!1,x}function Lo(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&kp(t,n,i)}s=s.next}while(s!==r)}}function Zu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Sp(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function I2(e){var t=e.alternate;t!==null&&(e.alternate=null,I2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Pr],delete t[Zo],delete t[hp],delete t[Rk],delete t[_k])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function P2(e){return e.tag===5||e.tag===3||e.tag===4}function Iv(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||P2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ep(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Yc));else if(r!==4&&(e=e.child,e!==null))for(Ep(e,t,n),e=e.sibling;e!==null;)Ep(e,t,n),e=e.sibling}function Dp(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Dp(e,t,n),e=e.sibling;e!==null;)Dp(e,t,n),e=e.sibling}var Qt=null,pr=!1;function _a(e,t,n){for(n=n.child;n!==null;)F2(e,t,n),n=n.sibling}function F2(e,t,n){if($r&&typeof $r.onCommitFiberUnmount=="function")try{$r.onCommitFiberUnmount(Hu,n)}catch{}switch(n.tag){case 5:on||Ni(n,t);case 6:var r=Qt,s=pr;Qt=null,_a(e,t,n),Qt=r,pr=s,Qt!==null&&(pr?(e=Qt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Qt.removeChild(n.stateNode));break;case 18:Qt!==null&&(pr?(e=Qt,n=n.stateNode,e.nodeType===8?Qd(e.parentNode,n):e.nodeType===1&&Qd(e,n),Ko(e)):Qd(Qt,n.stateNode));break;case 4:r=Qt,s=pr,Qt=n.stateNode.containerInfo,pr=!0,_a(e,t,n),Qt=r,pr=s;break;case 0:case 11:case 14:case 15:if(!on&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&kp(n,t,o),s=s.next}while(s!==r)}_a(e,t,n);break;case 1:if(!on&&(Ni(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Nt(n,t,l)}_a(e,t,n);break;case 21:_a(e,t,n);break;case 22:n.mode&1?(on=(r=on)||n.memoizedState!==null,_a(e,t,n),on=r):_a(e,t,n);break;default:_a(e,t,n)}}function Pv(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new qk),t.forEach(function(r){var s=nS.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function dr(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:Qt=l.stateNode,pr=!1;break e;case 3:Qt=l.stateNode.containerInfo,pr=!0;break e;case 4:Qt=l.stateNode.containerInfo,pr=!0;break e}l=l.return}if(Qt===null)throw Error(oe(160));F2(i,o,s),Qt=null,pr=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Nt(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)M2(t,e),t=t.sibling}function M2(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(dr(t,e),Dr(e),r&4){try{Lo(3,e,e.return),Zu(3,e)}catch(v){Nt(e,e.return,v)}try{Lo(5,e,e.return)}catch(v){Nt(e,e.return,v)}}break;case 1:dr(t,e),Dr(e),r&512&&n!==null&&Ni(n,n.return);break;case 5:if(dr(t,e),Dr(e),r&512&&n!==null&&Ni(n,n.return),e.flags&32){var s=e.stateNode;try{Vo(s,"")}catch(v){Nt(e,e.return,v)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=n!==null?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&a1(s,i),Jh(l,o);var u=Jh(l,i);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?c1(s,h):d==="dangerouslySetInnerHTML"?o1(s,h):d==="children"?Vo(s,h):Cf(s,d,h,u)}switch(l){case"input":Gh(s,i);break;case"textarea":s1(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?Ci(s,!!i.multiple,f,!1):p!==!!i.multiple&&(i.defaultValue!=null?Ci(s,!!i.multiple,i.defaultValue,!0):Ci(s,!!i.multiple,i.multiple?[]:"",!1))}s[Zo]=i}catch(v){Nt(e,e.return,v)}}break;case 6:if(dr(t,e),Dr(e),r&4){if(e.stateNode===null)throw Error(oe(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(v){Nt(e,e.return,v)}}break;case 3:if(dr(t,e),Dr(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ko(t.containerInfo)}catch(v){Nt(e,e.return,v)}break;case 4:dr(t,e),Dr(e);break;case 13:dr(t,e),Dr(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(rm=jt())),r&4&&Pv(e);break;case 22:if(d=n!==null&&n.memoizedState!==null,e.mode&1?(on=(u=on)||d,dr(t,e),on=u):dr(t,e),Dr(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(ge=e,d=e.child;d!==null;){for(h=ge=d;ge!==null;){switch(p=ge,f=p.child,p.tag){case 0:case 11:case 14:case 15:Lo(4,p,p.return);break;case 1:Ni(p,p.return);var x=p.stateNode;if(typeof x.componentWillUnmount=="function"){r=p,n=p.return;try{t=r,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(v){Nt(r,n,v)}}break;case 5:Ni(p,p.return);break;case 22:if(p.memoizedState!==null){Mv(h);continue}}f!==null?(f.return=p,ge=f):Mv(h)}d=d.sibling}e:for(d=null,h=e;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=l1("display",o))}catch(v){Nt(e,e.return,v)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(v){Nt(e,e.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:dr(t,e),Dr(e),r&4&&Pv(e);break;case 21:break;default:dr(t,e),Dr(e)}}function Dr(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(P2(n)){var r=n;break e}n=n.return}throw Error(oe(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Vo(s,""),r.flags&=-33);var i=Iv(e);Dp(e,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Iv(e);Ep(e,l,o);break;default:throw Error(oe(161))}}catch(c){Nt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Kk(e,t,n){ge=e,L2(e)}function L2(e,t,n){for(var r=(e.mode&1)!==0;ge!==null;){var s=ge,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||tc;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||on;l=tc;var u=on;if(tc=o,(on=c)&&!u)for(ge=s;ge!==null;)o=ge,c=o.child,o.tag===22&&o.memoizedState!==null?Lv(s):c!==null?(c.return=o,ge=c):Lv(s);for(;i!==null;)ge=i,L2(i),i=i.sibling;ge=s,tc=l,on=u}Fv(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ge=i):Fv(e)}}function Fv(e){for(;ge!==null;){var t=ge;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:on||Zu(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!on)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:hr(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&yv(t,i,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}yv(t,o,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Ko(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(oe(163))}on||t.flags&512&&Sp(t)}catch(p){Nt(t,t.return,p)}}if(t===e){ge=null;break}if(n=t.sibling,n!==null){n.return=t.return,ge=n;break}ge=t.return}}function Mv(e){for(;ge!==null;){var t=ge;if(t===e){ge=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ge=n;break}ge=t.return}}function Lv(e){for(;ge!==null;){var t=ge;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Zu(4,t)}catch(c){Nt(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(c){Nt(t,s,c)}}var i=t.return;try{Sp(t)}catch(c){Nt(t,i,c)}break;case 5:var o=t.return;try{Sp(t)}catch(c){Nt(t,o,c)}}}catch(c){Nt(t,t.return,c)}if(t===e){ge=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ge=l;break}ge=t.return}}var Xk=Math.ceil,ou=ba.ReactCurrentDispatcher,tm=ba.ReactCurrentOwner,nr=ba.ReactCurrentBatchConfig,Xe=0,Gt=null,_t=null,tn=0,Fn=0,ji=us(0),Lt=0,sl=null,$s=0,ed=0,nm=0,Oo=null,Nn=null,rm=0,Vi=1/0,ra=null,lu=!1,Rp=null,Ka=null,nc=!1,Ba=null,cu=0,Bo=0,_p=null,_c=-1,Tc=0;function gn(){return Xe&6?jt():_c!==-1?_c:_c=jt()}function Xa(e){return e.mode&1?Xe&2&&tn!==0?tn&-tn:Ak.transition!==null?(Tc===0&&(Tc=w1()),Tc):(e=et,e!==0||(e=window.event,e=e===void 0?16:D1(e.type)),e):1}function yr(e,t,n,r){if(50<Bo)throw Bo=0,_p=null,Error(oe(185));vl(e,n,r),(!(Xe&2)||e!==Gt)&&(e===Gt&&(!(Xe&2)&&(ed|=n),Lt===4&&Ma(e,tn)),Rn(e,r),n===1&&Xe===0&&!(t.mode&1)&&(Vi=jt()+500,Yu&&ds()))}function Rn(e,t){var n=e.callbackNode;A4(e,t);var r=qc(e,e===Gt?tn:0);if(r===0)n!==null&&q0(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&q0(n),t===1)e.tag===0?Tk(Ov.bind(null,e)):G1(Ov.bind(null,e)),Ek(function(){!(Xe&6)&&ds()}),n=null;else{switch(N1(r)){case 1:n=Rf;break;case 4:n=y1;break;case 16:n=Hc;break;case 536870912:n=b1;break;default:n=Hc}n=H2(n,O2.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function O2(e,t){if(_c=-1,Tc=0,Xe&6)throw Error(oe(327));var n=e.callbackNode;if(Ri()&&e.callbackNode!==n)return null;var r=qc(e,e===Gt?tn:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=uu(e,r);else{t=r;var s=Xe;Xe|=2;var i=$2();(Gt!==e||tn!==t)&&(ra=null,Vi=jt()+500,As(e,t));do try{Jk();break}catch(l){B2(e,l)}while(!0);Uf(),ou.current=i,Xe=s,_t!==null?t=0:(Gt=null,tn=0,t=Lt)}if(t!==0){if(t===2&&(s=rp(e),s!==0&&(r=s,t=Tp(e,s))),t===1)throw n=sl,As(e,0),Ma(e,r),Rn(e,jt()),n;if(t===6)Ma(e,r);else{if(s=e.current.alternate,!(r&30)&&!Yk(s)&&(t=uu(e,r),t===2&&(i=rp(e),i!==0&&(r=i,t=Tp(e,i))),t===1))throw n=sl,As(e,0),Ma(e,r),Rn(e,jt()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(oe(345));case 2:ws(e,Nn,ra);break;case 3:if(Ma(e,r),(r&130023424)===r&&(t=rm+500-jt(),10<t)){if(qc(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){gn(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=dp(ws.bind(null,e,Nn,ra),t);break}ws(e,Nn,ra);break;case 4:if(Ma(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var o=31-vr(r);i=1<<o,o=t[o],o>s&&(s=o),r&=~i}if(r=s,r=jt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Xk(r/1960))-r,10<r){e.timeoutHandle=dp(ws.bind(null,e,Nn,ra),r);break}ws(e,Nn,ra);break;case 5:ws(e,Nn,ra);break;default:throw Error(oe(329))}}}return Rn(e,jt()),e.callbackNode===n?O2.bind(null,e):null}function Tp(e,t){var n=Oo;return e.current.memoizedState.isDehydrated&&(As(e,t).flags|=256),e=uu(e,t),e!==2&&(t=Nn,Nn=n,t!==null&&Ap(t)),e}function Ap(e){Nn===null?Nn=e:Nn.push.apply(Nn,e)}function Yk(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!wr(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ma(e,t){for(t&=~nm,t&=~ed,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-vr(t),r=1<<n;e[n]=-1,t&=~r}}function Ov(e){if(Xe&6)throw Error(oe(327));Ri();var t=qc(e,0);if(!(t&1))return Rn(e,jt()),null;var n=uu(e,t);if(e.tag!==0&&n===2){var r=rp(e);r!==0&&(t=r,n=Tp(e,r))}if(n===1)throw n=sl,As(e,0),Ma(e,t),Rn(e,jt()),n;if(n===6)throw Error(oe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ws(e,Nn,ra),Rn(e,jt()),null}function am(e,t){var n=Xe;Xe|=1;try{return e(t)}finally{Xe=n,Xe===0&&(Vi=jt()+500,Yu&&ds())}}function zs(e){Ba!==null&&Ba.tag===0&&!(Xe&6)&&Ri();var t=Xe;Xe|=1;var n=nr.transition,r=et;try{if(nr.transition=null,et=1,e)return e()}finally{et=r,nr.transition=n,Xe=t,!(Xe&6)&&ds()}}function sm(){Fn=ji.current,ut(ji)}function As(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Sk(n)),_t!==null)for(n=_t.return;n!==null;){var r=n;switch(Bf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Qc();break;case 3:Ui(),ut(En),ut(pn),Kf();break;case 5:Gf(r);break;case 4:Ui();break;case 13:ut(mt);break;case 19:ut(mt);break;case 10:Wf(r.type._context);break;case 22:case 23:sm()}n=n.return}if(Gt=e,_t=e=Ya(e.current,null),tn=Fn=t,Lt=0,sl=null,nm=ed=$s=0,Nn=Oo=null,Es!==null){for(t=0;t<Es.length;t++)if(n=Es[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Es=null}return e}function B2(e,t){do{var n=_t;try{if(Uf(),Ec.current=iu,su){for(var r=vt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}su=!1}if(Bs=0,Ht=Ft=vt=null,Mo=!1,nl=0,tm.current=null,n===null||n.return===null){Lt=1,sl=t,_t=null;break}e:{var i=e,o=n.return,l=n,c=t;if(t=tn,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=kv(o);if(f!==null){f.flags&=-257,Sv(f,o,l,i,t),f.mode&1&&Cv(i,u,t),t=f,c=u;var x=t.updateQueue;if(x===null){var v=new Set;v.add(c),t.updateQueue=v}else x.add(c);break e}else{if(!(t&1)){Cv(i,u,t),im();break e}c=Error(oe(426))}}else if(ht&&l.mode&1){var y=kv(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),Sv(y,o,l,i,t),$f(Wi(c,l));break e}}i=c=Wi(c,l),Lt!==4&&(Lt=2),Oo===null?Oo=[i]:Oo.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var m=N2(i,c,t);vv(i,m);break e;case 1:l=c;var g=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof g.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Ka===null||!Ka.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t;var w=j2(i,l,t);vv(i,w);break e}}i=i.return}while(i!==null)}U2(n)}catch(N){t=N,_t===n&&n!==null&&(_t=n=n.return);continue}break}while(!0)}function $2(){var e=ou.current;return ou.current=iu,e===null?iu:e}function im(){(Lt===0||Lt===3||Lt===2)&&(Lt=4),Gt===null||!($s&268435455)&&!(ed&268435455)||Ma(Gt,tn)}function uu(e,t){var n=Xe;Xe|=2;var r=$2();(Gt!==e||tn!==t)&&(ra=null,As(e,t));do try{Qk();break}catch(s){B2(e,s)}while(!0);if(Uf(),Xe=n,ou.current=r,_t!==null)throw Error(oe(261));return Gt=null,tn=0,Lt}function Qk(){for(;_t!==null;)z2(_t)}function Jk(){for(;_t!==null&&!j4();)z2(_t)}function z2(e){var t=V2(e.alternate,e,Fn);e.memoizedProps=e.pendingProps,t===null?U2(e):_t=t,tm.current=null}function U2(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Hk(n,t),n!==null){n.flags&=32767,_t=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Lt=6,_t=null;return}}else if(n=Vk(n,t,Fn),n!==null){_t=n;return}if(t=t.sibling,t!==null){_t=t;return}_t=t=e}while(t!==null);Lt===0&&(Lt=5)}function ws(e,t,n){var r=et,s=nr.transition;try{nr.transition=null,et=1,Zk(e,t,n,r)}finally{nr.transition=s,et=r}return null}function Zk(e,t,n,r){do Ri();while(Ba!==null);if(Xe&6)throw Error(oe(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(oe(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(I4(e,i),e===Gt&&(_t=Gt=null,tn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||nc||(nc=!0,H2(Hc,function(){return Ri(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=nr.transition,nr.transition=null;var o=et;et=1;var l=Xe;Xe|=4,tm.current=null,Gk(e,n),M2(n,e),yk(cp),Gc=!!lp,cp=lp=null,e.current=n,Kk(n),C4(),Xe=l,et=o,nr.transition=i}else e.current=n;if(nc&&(nc=!1,Ba=e,cu=s),i=e.pendingLanes,i===0&&(Ka=null),E4(n.stateNode),Rn(e,jt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(lu)throw lu=!1,e=Rp,Rp=null,e;return cu&1&&e.tag!==0&&Ri(),i=e.pendingLanes,i&1?e===_p?Bo++:(Bo=0,_p=e):Bo=0,ds(),null}function Ri(){if(Ba!==null){var e=N1(cu),t=nr.transition,n=et;try{if(nr.transition=null,et=16>e?16:e,Ba===null)var r=!1;else{if(e=Ba,Ba=null,cu=0,Xe&6)throw Error(oe(331));var s=Xe;for(Xe|=4,ge=e.current;ge!==null;){var i=ge,o=i.child;if(ge.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(ge=u;ge!==null;){var d=ge;switch(d.tag){case 0:case 11:case 15:Lo(8,d,i)}var h=d.child;if(h!==null)h.return=d,ge=h;else for(;ge!==null;){d=ge;var p=d.sibling,f=d.return;if(I2(d),d===u){ge=null;break}if(p!==null){p.return=f,ge=p;break}ge=f}}}var x=i.alternate;if(x!==null){var v=x.child;if(v!==null){x.child=null;do{var y=v.sibling;v.sibling=null,v=y}while(v!==null)}}ge=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ge=o;else e:for(;ge!==null;){if(i=ge,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Lo(9,i,i.return)}var m=i.sibling;if(m!==null){m.return=i.return,ge=m;break e}ge=i.return}}var g=e.current;for(ge=g;ge!==null;){o=ge;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,ge=b;else e:for(o=g;ge!==null;){if(l=ge,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Zu(9,l)}}catch(N){Nt(l,l.return,N)}if(l===o){ge=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,ge=w;break e}ge=l.return}}if(Xe=s,ds(),$r&&typeof $r.onPostCommitFiberRoot=="function")try{$r.onPostCommitFiberRoot(Hu,e)}catch{}r=!0}return r}finally{et=n,nr.transition=t}}return!1}function Bv(e,t,n){t=Wi(n,t),t=N2(e,t,1),e=Ga(e,t,1),t=gn(),e!==null&&(vl(e,1,t),Rn(e,t))}function Nt(e,t,n){if(e.tag===3)Bv(e,e,n);else for(;t!==null;){if(t.tag===3){Bv(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ka===null||!Ka.has(r))){e=Wi(n,e),e=j2(t,e,1),t=Ga(t,e,1),e=gn(),t!==null&&(vl(t,1,e),Rn(t,e));break}}t=t.return}}function eS(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=gn(),e.pingedLanes|=e.suspendedLanes&n,Gt===e&&(tn&n)===n&&(Lt===4||Lt===3&&(tn&130023424)===tn&&500>jt()-rm?As(e,0):nm|=n),Rn(e,t)}function W2(e,t){t===0&&(e.mode&1?(t=ql,ql<<=1,!(ql&130023424)&&(ql=4194304)):t=1);var n=gn();e=pa(e,t),e!==null&&(vl(e,t,n),Rn(e,n))}function tS(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),W2(e,n)}function nS(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(oe(314))}r!==null&&r.delete(t),W2(e,n)}var V2;V2=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||En.current)Sn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Sn=!1,Wk(e,t,n);Sn=!!(e.flags&131072)}else Sn=!1,ht&&t.flags&1048576&&K1(t,eu,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Rc(e,t),e=t.pendingProps;var s=Bi(t,pn.current);Di(t,n),s=Yf(null,t,r,e,s,n);var i=Qf();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Dn(r)?(i=!0,Jc(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Hf(t),s.updater=Ju,t.stateNode=s,s._reactInternals=t,vp(t,r,e,n),t=wp(null,t,r,!0,i,n)):(t.tag=0,ht&&i&&Of(t),xn(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Rc(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=aS(r),e=hr(r,e),s){case 0:t=bp(null,t,r,e,n);break e;case 1:t=Rv(null,t,r,e,n);break e;case 11:t=Ev(null,t,r,e,n);break e;case 14:t=Dv(null,t,r,hr(r.type,e),n);break e}throw Error(oe(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:hr(r,s),bp(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:hr(r,s),Rv(e,t,r,s,n);case 3:e:{if(E2(t),e===null)throw Error(oe(387));r=t.pendingProps,i=t.memoizedState,s=i.element,e2(e,t),ru(t,r,null,n);var o=t.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=Wi(Error(oe(423)),t),t=_v(e,t,r,n,s);break e}else if(r!==s){s=Wi(Error(oe(424)),t),t=_v(e,t,r,n,s);break e}else for(On=qa(t.stateNode.containerInfo.firstChild),Wn=t,ht=!0,fr=null,n=J1(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if($i(),r===s){t=fa(e,t,n);break e}xn(e,t,r,n)}t=t.child}return t;case 5:return t2(t),e===null&&mp(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,up(r,s)?o=null:i!==null&&up(r,i)&&(t.flags|=32),S2(e,t),xn(e,t,o,n),t.child;case 6:return e===null&&mp(t),null;case 13:return D2(e,t,n);case 4:return qf(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=zi(t,null,r,n):xn(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:hr(r,s),Ev(e,t,r,s,n);case 7:return xn(e,t,t.pendingProps,n),t.child;case 8:return xn(e,t,t.pendingProps.children,n),t.child;case 12:return xn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,at(tu,r._currentValue),r._currentValue=o,i!==null)if(wr(i.value,o)){if(i.children===s.children&&!En.current){t=fa(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=la(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),xp(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(oe(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),xp(o,n,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}xn(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Di(t,n),s=ar(s),r=r(s),t.flags|=1,xn(e,t,r,n),t.child;case 14:return r=t.type,s=hr(r,t.pendingProps),s=hr(r.type,s),Dv(e,t,r,s,n);case 15:return C2(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:hr(r,s),Rc(e,t),t.tag=1,Dn(r)?(e=!0,Jc(t)):e=!1,Di(t,n),w2(t,r,s),vp(t,r,s,n),wp(null,t,r,!0,e,n);case 19:return R2(e,t,n);case 22:return k2(e,t,n)}throw Error(oe(156,t.tag))};function H2(e,t){return v1(e,t)}function rS(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function er(e,t,n,r){return new rS(e,t,n,r)}function om(e){return e=e.prototype,!(!e||!e.isReactComponent)}function aS(e){if(typeof e=="function")return om(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Sf)return 11;if(e===Ef)return 14}return 2}function Ya(e,t){var n=e.alternate;return n===null?(n=er(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ac(e,t,n,r,s,i){var o=2;if(r=e,typeof e=="function")om(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case pi:return Is(n.children,s,i,t);case kf:o=8,s|=8;break;case Uh:return e=er(12,n,t,s|2),e.elementType=Uh,e.lanes=i,e;case Wh:return e=er(13,n,t,s),e.elementType=Wh,e.lanes=i,e;case Vh:return e=er(19,n,t,s),e.elementType=Vh,e.lanes=i,e;case t1:return td(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Zb:o=10;break e;case e1:o=9;break e;case Sf:o=11;break e;case Ef:o=14;break e;case Ia:o=16,r=null;break e}throw Error(oe(130,e==null?e:typeof e,""))}return t=er(o,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function Is(e,t,n,r){return e=er(7,e,r,t),e.lanes=n,e}function td(e,t,n,r){return e=er(22,e,r,t),e.elementType=t1,e.lanes=n,e.stateNode={isHidden:!1},e}function sh(e,t,n){return e=er(6,e,null,t),e.lanes=n,e}function ih(e,t,n){return t=er(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function sS(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$d(0),this.expirationTimes=$d(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$d(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function lm(e,t,n,r,s,i,o,l,c){return e=new sS(e,t,n,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=er(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hf(i),e}function iS(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:hi,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function q2(e){if(!e)return rs;e=e._reactInternals;e:{if(Ks(e)!==e||e.tag!==1)throw Error(oe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Dn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(oe(171))}if(e.tag===1){var n=e.type;if(Dn(n))return q1(e,n,t)}return t}function G2(e,t,n,r,s,i,o,l,c){return e=lm(n,r,!0,e,s,i,o,l,c),e.context=q2(null),n=e.current,r=gn(),s=Xa(n),i=la(r,s),i.callback=t??null,Ga(n,i,s),e.current.lanes=s,vl(e,s,r),Rn(e,r),e}function nd(e,t,n,r){var s=t.current,i=gn(),o=Xa(s);return n=q2(n),t.context===null?t.context=n:t.pendingContext=n,t=la(i,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Ga(s,t,o),e!==null&&(yr(e,s,o,i),Sc(e,s,o)),o}function du(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function $v(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function cm(e,t){$v(e,t),(e=e.alternate)&&$v(e,t)}function oS(){return null}var K2=typeof reportError=="function"?reportError:function(e){console.error(e)};function um(e){this._internalRoot=e}rd.prototype.render=um.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(oe(409));nd(e,t,null,null)};rd.prototype.unmount=um.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;zs(function(){nd(null,e,null,null)}),t[ha]=null}};function rd(e){this._internalRoot=e}rd.prototype.unstable_scheduleHydration=function(e){if(e){var t=k1();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Fa.length&&t!==0&&t<Fa[n].priority;n++);Fa.splice(n,0,e),n===0&&E1(e)}};function dm(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ad(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function zv(){}function lS(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=du(o);i.call(u)}}var o=G2(t,r,e,0,null,!1,!1,"",zv);return e._reactRootContainer=o,e[ha]=o.current,Qo(e.nodeType===8?e.parentNode:e),zs(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=du(c);l.call(u)}}var c=lm(e,0,!1,null,null,!1,!1,"",zv);return e._reactRootContainer=c,e[ha]=c.current,Qo(e.nodeType===8?e.parentNode:e),zs(function(){nd(t,c,n,r)}),c}function sd(e,t,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=du(o);l.call(c)}}nd(t,o,e,s)}else o=lS(n,t,e,s,r);return du(o)}j1=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Ro(t.pendingLanes);n!==0&&(_f(t,n|1),Rn(t,jt()),!(Xe&6)&&(Vi=jt()+500,ds()))}break;case 13:zs(function(){var r=pa(e,1);if(r!==null){var s=gn();yr(r,e,1,s)}}),cm(e,1)}};Tf=function(e){if(e.tag===13){var t=pa(e,134217728);if(t!==null){var n=gn();yr(t,e,134217728,n)}cm(e,134217728)}};C1=function(e){if(e.tag===13){var t=Xa(e),n=pa(e,t);if(n!==null){var r=gn();yr(n,e,t,r)}cm(e,t)}};k1=function(){return et};S1=function(e,t){var n=et;try{return et=e,t()}finally{et=n}};ep=function(e,t,n){switch(t){case"input":if(Gh(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=Xu(r);if(!s)throw Error(oe(90));r1(r),Gh(r,s)}}}break;case"textarea":s1(e,n);break;case"select":t=n.value,t!=null&&Ci(e,!!n.multiple,t,!1)}};h1=am;p1=zs;var cS={usingClientEntryPoint:!1,Events:[bl,gi,Xu,u1,d1,am]},bo={findFiberByHostInstance:Ss,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},uS={bundleType:bo.bundleType,version:bo.version,rendererPackageName:bo.rendererPackageName,rendererConfig:bo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ba.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=x1(e),e===null?null:e.stateNode},findFiberByHostInstance:bo.findFiberByHostInstance||oS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var rc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rc.isDisabled&&rc.supportsFiber)try{Hu=rc.inject(uS),$r=rc}catch{}}Gn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cS;Gn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!dm(t))throw Error(oe(200));return iS(e,t,null,n)};Gn.createRoot=function(e,t){if(!dm(e))throw Error(oe(299));var n=!1,r="",s=K2;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=lm(e,1,!1,null,null,n,!1,r,s),e[ha]=t.current,Qo(e.nodeType===8?e.parentNode:e),new um(t)};Gn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(oe(188)):(e=Object.keys(e).join(","),Error(oe(268,e)));return e=x1(t),e=e===null?null:e.stateNode,e};Gn.flushSync=function(e){return zs(e)};Gn.hydrate=function(e,t,n){if(!ad(t))throw Error(oe(200));return sd(null,e,t,!0,n)};Gn.hydrateRoot=function(e,t,n){if(!dm(e))throw Error(oe(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=K2;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=G2(t,null,e,1,n??null,s,!1,i,o),e[ha]=t.current,Qo(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new rd(t)};Gn.render=function(e,t,n){if(!ad(t))throw Error(oe(200));return sd(null,e,t,!1,n)};Gn.unmountComponentAtNode=function(e){if(!ad(e))throw Error(oe(40));return e._reactRootContainer?(zs(function(){sd(null,null,e,!1,function(){e._reactRootContainer=null,e[ha]=null})}),!0):!1};Gn.unstable_batchedUpdates=am;Gn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!ad(n))throw Error(oe(200));if(e==null||e._reactInternals===void 0)throw Error(oe(38));return sd(e,t,n,!1,r)};Gn.version="18.3.1-next-f1338f8080-20240426";function X2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(X2)}catch(e){console.error(e)}}X2(),Xb.exports=Gn;var dS=Xb.exports,Uv=dS;$h.createRoot=Uv.createRoot,$h.hydrateRoot=Uv.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function il(){return il=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},il.apply(this,arguments)}var $a;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})($a||($a={}));const Wv="popstate";function hS(e){e===void 0&&(e={});function t(r,s){let{pathname:i,search:o,hash:l}=r.location;return Ip("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:hu(s)}return fS(t,n,null,e)}function St(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function hm(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function pS(){return Math.random().toString(36).substr(2,8)}function Vv(e,t){return{usr:e.state,key:e.key,idx:t}}function Ip(e,t,n,r){return n===void 0&&(n=null),il({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?ao(t):t,{state:n,key:t&&t.key||r||pS()})}function hu(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function ao(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function fS(e,t,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l=$a.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(il({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function h(){l=$a.Pop;let y=d(),m=y==null?null:y-u;u=y,c&&c({action:l,location:v.location,delta:m})}function p(y,m){l=$a.Push;let g=Ip(v.location,y,m);u=d()+1;let b=Vv(g,u),w=v.createHref(g);try{o.pushState(b,"",w)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;s.location.assign(w)}i&&c&&c({action:l,location:v.location,delta:1})}function f(y,m){l=$a.Replace;let g=Ip(v.location,y,m);u=d();let b=Vv(g,u),w=v.createHref(g);o.replaceState(b,"",w),i&&c&&c({action:l,location:v.location,delta:0})}function x(y){let m=s.location.origin!=="null"?s.location.origin:s.location.href,g=typeof y=="string"?y:hu(y);return g=g.replace(/ $/,"%20"),St(m,"No window.location.(origin|href) available to create URL for href: "+g),new URL(g,m)}let v={get action(){return l},get location(){return e(s,o)},listen(y){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Wv,h),c=y,()=>{s.removeEventListener(Wv,h),c=null}},createHref(y){return t(s,y)},createURL:x,encodeLocation(y){let m=x(y);return{pathname:m.pathname,search:m.search,hash:m.hash}},push:p,replace:f,go(y){return o.go(y)}};return v}var Hv;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Hv||(Hv={}));function mS(e,t,n){return n===void 0&&(n="/"),xS(e,t,n)}function xS(e,t,n,r){let s=typeof t=="string"?ao(t):t,i=pm(s.pathname||"/",n);if(i==null)return null;let o=Y2(e);gS(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=RS(i);l=SS(o[c],u)}return l}function Y2(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(St(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=Qa([r,c.relativePath]),d=n.concat(c);i.children&&i.children.length>0&&(St(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Y2(i.children,t,d,u)),!(i.path==null&&!i.index)&&t.push({path:u,score:CS(u,i.index),routesMeta:d})};return e.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of Q2(i.path))s(i,o,c)}),t}function Q2(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=Q2(r.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function gS(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:kS(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const vS=/^:[\w-]+$/,yS=3,bS=2,wS=1,NS=10,jS=-2,qv=e=>e==="*";function CS(e,t){let n=e.split("/"),r=n.length;return n.some(qv)&&(r+=jS),t&&(r+=bS),n.filter(s=>!qv(s)).reduce((s,i)=>s+(vS.test(i)?yS:i===""?wS:NS),r)}function kS(e,t){return e.length===t.length&&e.slice(0,-1).every((r,s)=>r===t[s])?e[e.length-1]-t[t.length-1]:0}function SS(e,t,n){let{routesMeta:r}=e,s={},i="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],u=l===r.length-1,d=i==="/"?t:t.slice(i.length)||"/",h=ES({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),p=c.route;if(!h)return null;Object.assign(s,h.params),o.push({params:s,pathname:Qa([i,h.pathname]),pathnameBase:PS(Qa([i,h.pathnameBase])),route:p}),h.pathnameBase!=="/"&&(i=Qa([i,h.pathnameBase]))}return o}function ES(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=DS(e.path,e.caseSensitive,e.end),s=t.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,d,h)=>{let{paramName:p,isOptional:f}=d;if(p==="*"){let v=l[h]||"";o=i.slice(0,i.length-v.length).replace(/(.)\/+$/,"$1")}const x=l[h];return f&&!x?u[p]=void 0:u[p]=(x||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:e}}function DS(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),hm(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),r]}function RS(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return hm(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function pm(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}const _S=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,TS=e=>_S.test(e);function AS(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:s=""}=typeof e=="string"?ao(e):e,i;if(n)if(TS(n))i=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),hm(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+n))}n.startsWith("/")?i=Gv(n.substring(1),"/"):i=Gv(n,t)}else i=t;return{pathname:i,search:FS(r),hash:MS(s)}}function Gv(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function oh(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function IS(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function fm(e,t){let n=IS(e);return t?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function mm(e,t,n,r){r===void 0&&(r=!1);let s;typeof e=="string"?s=ao(e):(s=il({},e),St(!s.pathname||!s.pathname.includes("?"),oh("?","pathname","search",s)),St(!s.pathname||!s.pathname.includes("#"),oh("#","pathname","hash",s)),St(!s.search||!s.search.includes("#"),oh("#","search","hash",s)));let i=e===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=n;else{let h=t.length-1;if(!r&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),h-=1;s.pathname=p.join("/")}l=h>=0?t[h]:"/"}let c=AS(s,l),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Qa=e=>e.join("/").replace(/\/\/+/g,"/"),PS=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),FS=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,MS=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function LS(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const J2=["post","put","patch","delete"];new Set(J2);const OS=["get",...J2];new Set(OS);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ol(){return ol=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ol.apply(this,arguments)}const xm=S.createContext(null),BS=S.createContext(null),hs=S.createContext(null),id=S.createContext(null),wa=S.createContext({outlet:null,matches:[],isDataRoute:!1}),Z2=S.createContext(null);function $S(e,t){let{relative:n}=t===void 0?{}:t;so()||St(!1);let{basename:r,navigator:s}=S.useContext(hs),{hash:i,pathname:o,search:l}=tw(e,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:Qa([r,o])),s.createHref({pathname:c,search:l,hash:i})}function so(){return S.useContext(id)!=null}function ps(){return so()||St(!1),S.useContext(id).location}function ew(e){S.useContext(hs).static||S.useLayoutEffect(e)}function lr(){let{isDataRoute:e}=S.useContext(wa);return e?ZS():zS()}function zS(){so()||St(!1);let e=S.useContext(xm),{basename:t,future:n,navigator:r}=S.useContext(hs),{matches:s}=S.useContext(wa),{pathname:i}=ps(),o=JSON.stringify(fm(s,n.v7_relativeSplatPath)),l=S.useRef(!1);return ew(()=>{l.current=!0}),S.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){r.go(u);return}let h=mm(u,JSON.parse(o),i,d.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:Qa([t,h.pathname])),(d.replace?r.replace:r.push)(h,d.state,d)},[t,r,o,i,e])}function jr(){let{matches:e}=S.useContext(wa),t=e[e.length-1];return t?t.params:{}}function tw(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=S.useContext(hs),{matches:s}=S.useContext(wa),{pathname:i}=ps(),o=JSON.stringify(fm(s,r.v7_relativeSplatPath));return S.useMemo(()=>mm(e,JSON.parse(o),i,n==="path"),[e,o,i,n])}function US(e,t){return WS(e,t)}function WS(e,t,n,r){so()||St(!1);let{navigator:s}=S.useContext(hs),{matches:i}=S.useContext(wa),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=ps(),d;if(t){var h;let y=typeof t=="string"?ao(t):t;c==="/"||(h=y.pathname)!=null&&h.startsWith(c)||St(!1),d=y}else d=u;let p=d.pathname||"/",f=p;if(c!=="/"){let y=c.replace(/^\//,"").split("/");f="/"+p.replace(/^\//,"").split("/").slice(y.length).join("/")}let x=mS(e,{pathname:f}),v=KS(x&&x.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:Qa([c,s.encodeLocation?s.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:Qa([c,s.encodeLocation?s.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,n,r);return t&&v?S.createElement(id.Provider,{value:{location:ol({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:$a.Pop}},v):v}function VS(){let e=JS(),t=LS(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},t),n?S.createElement("pre",{style:s},n):null,null)}const HS=S.createElement(VS,null);class qS extends S.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?S.createElement(wa.Provider,{value:this.props.routeContext},S.createElement(Z2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function GS(e){let{routeContext:t,match:n,children:r}=e,s=S.useContext(xm);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),S.createElement(wa.Provider,{value:t},r)}function KS(e,t,n,r){var s;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var i;if(!n)return null;if(n.errors)e=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let o=e,l=(s=n)==null?void 0:s.errors;if(l!=null){let d=o.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);d>=0||St(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<o.length;d++){let h=o[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:p,errors:f}=n,x=h.route.loader&&p[h.route.id]===void 0&&(!f||f[h.route.id]===void 0);if(h.route.lazy||x){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,h,p)=>{let f,x=!1,v=null,y=null;n&&(f=l&&h.route.id?l[h.route.id]:void 0,v=h.route.errorElement||HS,c&&(u<0&&p===0?(e3("route-fallback"),x=!0,y=null):u===p&&(x=!0,y=h.route.hydrateFallbackElement||null)));let m=t.concat(o.slice(0,p+1)),g=()=>{let b;return f?b=v:x?b=y:h.route.Component?b=S.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=d,S.createElement(GS,{match:h,routeContext:{outlet:d,matches:m,isDataRoute:n!=null},children:b})};return n&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?S.createElement(qS,{location:n.location,revalidation:n.revalidation,component:v,error:f,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()},null)}var nw=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(nw||{}),rw=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(rw||{});function XS(e){let t=S.useContext(xm);return t||St(!1),t}function YS(e){let t=S.useContext(BS);return t||St(!1),t}function QS(e){let t=S.useContext(wa);return t||St(!1),t}function aw(e){let t=QS(),n=t.matches[t.matches.length-1];return n.route.id||St(!1),n.route.id}function JS(){var e;let t=S.useContext(Z2),n=YS(),r=aw();return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function ZS(){let{router:e}=XS(nw.UseNavigateStable),t=aw(rw.UseNavigateStable),n=S.useRef(!1);return ew(()=>{n.current=!0}),S.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,ol({fromRouteId:t},i)))},[e,t])}const Kv={};function e3(e,t,n){Kv[e]||(Kv[e]=!0)}function t3(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function sw(e){let{to:t,replace:n,state:r,relative:s}=e;so()||St(!1);let{future:i,static:o}=S.useContext(hs),{matches:l}=S.useContext(wa),{pathname:c}=ps(),u=lr(),d=mm(t,fm(l,i.v7_relativeSplatPath),c,s==="path"),h=JSON.stringify(d);return S.useEffect(()=>u(JSON.parse(h),{replace:n,state:r,relative:s}),[u,h,s,n,r]),null}function We(e){St(!1)}function n3(e){let{basename:t="/",children:n=null,location:r,navigationType:s=$a.Pop,navigator:i,static:o=!1,future:l}=e;so()&&St(!1);let c=t.replace(/^\/*/,"/"),u=S.useMemo(()=>({basename:c,navigator:i,static:o,future:ol({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof r=="string"&&(r=ao(r));let{pathname:d="/",search:h="",hash:p="",state:f=null,key:x="default"}=r,v=S.useMemo(()=>{let y=pm(d,c);return y==null?null:{location:{pathname:y,search:h,hash:p,state:f,key:x},navigationType:s}},[c,d,h,p,f,x,s]);return v==null?null:S.createElement(hs.Provider,{value:u},S.createElement(id.Provider,{children:n,value:v}))}function r3(e){let{children:t,location:n}=e;return US(Pp(t),n)}new Promise(()=>{});function Pp(e,t){t===void 0&&(t=[]);let n=[];return S.Children.forEach(e,(r,s)=>{if(!S.isValidElement(r))return;let i=[...t,s];if(r.type===S.Fragment){n.push.apply(n,Pp(r.props.children,i));return}r.type!==We&&St(!1),!r.props.index||!r.props.children||St(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Pp(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fp(){return Fp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Fp.apply(this,arguments)}function a3(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,i;for(i=0;i<r.length;i++)s=r[i],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function s3(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function i3(e,t){return e.button===0&&(!t||t==="_self")&&!s3(e)}function Mp(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function o3(e,t){let n=Mp(e);return t&&t.forEach((r,s)=>{n.has(s)||t.getAll(s).forEach(i=>{n.append(s,i)})}),n}const l3=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],c3="6";try{window.__reactRouterVersion=c3}catch{}const u3="startTransition",Xv=e4[u3];function d3(e){let{basename:t,children:n,future:r,window:s}=e,i=S.useRef();i.current==null&&(i.current=hS({window:s,v5Compat:!0}));let o=i.current,[l,c]=S.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},d=S.useCallback(h=>{u&&Xv?Xv(()=>c(h)):c(h)},[c,u]);return S.useLayoutEffect(()=>o.listen(d),[o,d]),S.useEffect(()=>t3(r),[r]),S.createElement(n3,{basename:t,children:n,location:l.location,navigationType:l.action,navigator:o,future:r})}const h3=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",p3=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ve=S.forwardRef(function(t,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:h}=t,p=a3(t,l3),{basename:f}=S.useContext(hs),x,v=!1;if(typeof u=="string"&&p3.test(u)&&(x=u,h3))try{let b=new URL(window.location.href),w=u.startsWith("//")?new URL(b.protocol+u):new URL(u),N=pm(w.pathname,f);w.origin===b.origin&&N!=null?u=N+w.search+w.hash:v=!0}catch{}let y=$S(u,{relative:s}),m=f3(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:s,viewTransition:h});function g(b){r&&r(b),b.defaultPrevented||m(b)}return S.createElement("a",Fp({},p,{href:x||y,onClick:v||i?r:g,ref:n,target:c}))});var Yv;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Yv||(Yv={}));var Qv;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Qv||(Qv={}));function f3(e,t){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:l}=t===void 0?{}:t,c=lr(),u=ps(),d=tw(e,{relative:o});return S.useCallback(h=>{if(i3(h,n)){h.preventDefault();let p=r!==void 0?r:hu(u)===hu(d);c(e,{replace:p,state:s,preventScrollReset:i,relative:o,viewTransition:l})}},[u,c,d,r,s,n,e,i,o,l])}function m3(e){let t=S.useRef(Mp(e)),n=S.useRef(!1),r=ps(),s=S.useMemo(()=>o3(r.search,n.current?null:t.current),[r.search]),i=lr(),o=S.useCallback((l,c)=>{const u=Mp(typeof l=="function"?l(s):l);n.current=!0,i("?"+u,c)},[i,s]);return[s,o]}let x3={data:""},g3=e=>{if(typeof window=="object"){let t=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return t.nonce=window.__nonce__,t.parentNode||(e||document.head).appendChild(t),t.firstChild}return e||x3},v3=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,y3=/\/\*[^]*?\*\/|  +/g,Jv=/\n+/g,La=(e,t)=>{let n="",r="",s="";for(let i in e){let o=e[i];i[0]=="@"?i[1]=="i"?n=i+" "+o+";":r+=i[1]=="f"?La(o,i):i+"{"+La(o,i[1]=="k"?"":t)+"}":typeof o=="object"?r+=La(o,t?t.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,l):l?l+" "+c:c)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=La.p?La.p(i,o):i+":"+o+";")}return n+(t&&s?t+"{"+s+"}":s)+r},ea={},iw=e=>{if(typeof e=="object"){let t="";for(let n in e)t+=n+iw(e[n]);return t}return e},b3=(e,t,n,r,s)=>{let i=iw(e),o=ea[i]||(ea[i]=(c=>{let u=0,d=11;for(;u<c.length;)d=101*d+c.charCodeAt(u++)>>>0;return"go"+d})(i));if(!ea[o]){let c=i!==e?e:(u=>{let d,h,p=[{}];for(;d=v3.exec(u.replace(y3,""));)d[4]?p.shift():d[3]?(h=d[3].replace(Jv," ").trim(),p.unshift(p[0][h]=p[0][h]||{})):p[0][d[1]]=d[2].replace(Jv," ").trim();return p[0]})(e);ea[o]=La(s?{["@keyframes "+o]:c}:c,n?"":"."+o)}let l=n&&ea.g?ea.g:null;return n&&(ea.g=ea[o]),((c,u,d,h)=>{h?u.data=u.data.replace(h,c):u.data.indexOf(c)===-1&&(u.data=d?c+u.data:u.data+c)})(ea[o],t,r,l),o},w3=(e,t,n)=>e.reduce((r,s,i)=>{let o=t[i];if(o&&o.call){let l=o(n),c=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=c?"."+c:l&&typeof l=="object"?l.props?"":La(l,""):l===!1?"":l}return r+s+(o??"")},"");function od(e){let t=this||{},n=e.call?e(t.p):e;return b3(n.unshift?n.raw?w3(n,[].slice.call(arguments,1),t.p):n.reduce((r,s)=>Object.assign(r,s&&s.call?s(t.p):s),{}):n,g3(t.target),t.g,t.o,t.k)}let ow,Lp,Op;od.bind({g:1});let ma=od.bind({k:1});function N3(e,t,n,r){La.p=t,ow=e,Lp=n,Op=r}function fs(e,t){let n=this||{};return function(){let r=arguments;function s(i,o){let l=Object.assign({},i),c=l.className||s.className;n.p=Object.assign({theme:Lp&&Lp()},l),n.o=/ *go\d+/.test(c),l.className=od.apply(n,r)+(c?" "+c:"");let u=e;return e[0]&&(u=l.as||e,delete l.as),Op&&u[0]&&Op(l),ow(u,l)}return s}}var j3=e=>typeof e=="function",pu=(e,t)=>j3(e)?e(t):e,C3=(()=>{let e=0;return()=>(++e).toString()})(),lw=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),k3=20,gm="default",cw=(e,t)=>{let{toastLimit:n}=e.settings;switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,n)};case 1:return{...e,toasts:e.toasts.map(o=>o.id===t.toast.id?{...o,...t.toast}:o)};case 2:let{toast:r}=t;return cw(e,{type:e.toasts.find(o=>o.id===r.id)?1:0,toast:r});case 3:let{toastId:s}=t;return{...e,toasts:e.toasts.map(o=>o.id===s||s===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(o=>o.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let i=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},Ic=[],uw={toasts:[],pausedAt:void 0,settings:{toastLimit:k3}},Lr={},dw=(e,t=gm)=>{Lr[t]=cw(Lr[t]||uw,e),Ic.forEach(([n,r])=>{n===t&&r(Lr[t])})},hw=e=>Object.keys(Lr).forEach(t=>dw(e,t)),S3=e=>Object.keys(Lr).find(t=>Lr[t].toasts.some(n=>n.id===e)),ld=(e=gm)=>t=>{dw(t,e)},E3={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},D3=(e={},t=gm)=>{let[n,r]=S.useState(Lr[t]||uw),s=S.useRef(Lr[t]);S.useEffect(()=>(s.current!==Lr[t]&&r(Lr[t]),Ic.push([t,r]),()=>{let o=Ic.findIndex(([l])=>l===t);o>-1&&Ic.splice(o,1)}),[t]);let i=n.toasts.map(o=>{var l,c,u;return{...e,...e[o.type],...o,removeDelay:o.removeDelay||((l=e[o.type])==null?void 0:l.removeDelay)||(e==null?void 0:e.removeDelay),duration:o.duration||((c=e[o.type])==null?void 0:c.duration)||(e==null?void 0:e.duration)||E3[o.type],style:{...e.style,...(u=e[o.type])==null?void 0:u.style,...o.style}}});return{...n,toasts:i}},R3=(e,t="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...n,id:(n==null?void 0:n.id)||C3()}),Nl=e=>(t,n)=>{let r=R3(t,e,n);return ld(r.toasterId||S3(r.id))({type:2,toast:r}),r.id},Mt=(e,t)=>Nl("blank")(e,t);Mt.error=Nl("error");Mt.success=Nl("success");Mt.loading=Nl("loading");Mt.custom=Nl("custom");Mt.dismiss=(e,t)=>{let n={type:3,toastId:e};t?ld(t)(n):hw(n)};Mt.dismissAll=e=>Mt.dismiss(void 0,e);Mt.remove=(e,t)=>{let n={type:4,toastId:e};t?ld(t)(n):hw(n)};Mt.removeAll=e=>Mt.remove(void 0,e);Mt.promise=(e,t,n)=>{let r=Mt.loading(t.loading,{...n,...n==null?void 0:n.loading});return typeof e=="function"&&(e=e()),e.then(s=>{let i=t.success?pu(t.success,s):void 0;return i?Mt.success(i,{id:r,...n,...n==null?void 0:n.success}):Mt.dismiss(r),s}).catch(s=>{let i=t.error?pu(t.error,s):void 0;i?Mt.error(i,{id:r,...n,...n==null?void 0:n.error}):Mt.dismiss(r)}),e};var _3=1e3,T3=(e,t="default")=>{let{toasts:n,pausedAt:r}=D3(e,t),s=S.useRef(new Map).current,i=S.useCallback((h,p=_3)=>{if(s.has(h))return;let f=setTimeout(()=>{s.delete(h),o({type:4,toastId:h})},p);s.set(h,f)},[]);S.useEffect(()=>{if(r)return;let h=Date.now(),p=n.map(f=>{if(f.duration===1/0)return;let x=(f.duration||0)+f.pauseDuration-(h-f.createdAt);if(x<0){f.visible&&Mt.dismiss(f.id);return}return setTimeout(()=>Mt.dismiss(f.id,t),x)});return()=>{p.forEach(f=>f&&clearTimeout(f))}},[n,r,t]);let o=S.useCallback(ld(t),[t]),l=S.useCallback(()=>{o({type:5,time:Date.now()})},[o]),c=S.useCallback((h,p)=>{o({type:1,toast:{id:h,height:p}})},[o]),u=S.useCallback(()=>{r&&o({type:6,time:Date.now()})},[r,o]),d=S.useCallback((h,p)=>{let{reverseOrder:f=!1,gutter:x=8,defaultPosition:v}=p||{},y=n.filter(b=>(b.position||v)===(h.position||v)&&b.height),m=y.findIndex(b=>b.id===h.id),g=y.filter((b,w)=>w<m&&b.visible).length;return y.filter(b=>b.visible).slice(...f?[g+1]:[0,g]).reduce((b,w)=>b+(w.height||0)+x,0)},[n]);return S.useEffect(()=>{n.forEach(h=>{if(h.dismissed)i(h.id,h.removeDelay);else{let p=s.get(h.id);p&&(clearTimeout(p),s.delete(h.id))}})},[n,i]),{toasts:n,handlers:{updateHeight:c,startPause:l,endPause:u,calculateOffset:d}}},A3=ma`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,I3=ma`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,P3=ma`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,F3=fs("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${A3} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${I3} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${P3} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,M3=ma`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,L3=fs("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${M3} 1s linear infinite;
`,O3=ma`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,B3=ma`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,$3=fs("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${O3} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${B3} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,z3=fs("div")`
  position: absolute;
`,U3=fs("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,W3=ma`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,V3=fs("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${W3} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,H3=({toast:e})=>{let{icon:t,type:n,iconTheme:r}=e;return t!==void 0?typeof t=="string"?S.createElement(V3,null,t):t:n==="blank"?null:S.createElement(U3,null,S.createElement(L3,{...r}),n!=="loading"&&S.createElement(z3,null,n==="error"?S.createElement(F3,{...r}):S.createElement($3,{...r})))},q3=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,G3=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,K3="0%{opacity:0;} 100%{opacity:1;}",X3="0%{opacity:1;} 100%{opacity:0;}",Y3=fs("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Q3=fs("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,J3=(e,t)=>{let n=e.includes("top")?1:-1,[r,s]=lw()?[K3,X3]:[q3(n),G3(n)];return{animation:t?`${ma(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${ma(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Z3=S.memo(({toast:e,position:t,style:n,children:r})=>{let s=e.height?J3(e.position||t||"top-center",e.visible):{opacity:0},i=S.createElement(H3,{toast:e}),o=S.createElement(Q3,{...e.ariaProps},pu(e.message,e));return S.createElement(Y3,{className:e.className,style:{...s,...n,...e.style}},typeof r=="function"?r({icon:i,message:o}):S.createElement(S.Fragment,null,i,o))});N3(S.createElement);var eE=({id:e,className:t,style:n,onHeightUpdate:r,children:s})=>{let i=S.useCallback(o=>{if(o){let l=()=>{let c=o.getBoundingClientRect().height;r(e,c)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[e,r]);return S.createElement("div",{ref:i,className:t,style:n},s)},tE=(e,t)=>{let n=e.includes("top"),r=n?{top:0}:{bottom:0},s=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:lw()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(n?1:-1)}px)`,...r,...s}},nE=od`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,ac=16,rE=({reverseOrder:e,position:t="top-center",toastOptions:n,gutter:r,children:s,toasterId:i,containerStyle:o,containerClassName:l})=>{let{toasts:c,handlers:u}=T3(n,i);return S.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:ac,left:ac,right:ac,bottom:ac,pointerEvents:"none",...o},className:l,onMouseEnter:u.startPause,onMouseLeave:u.endPause},c.map(d=>{let h=d.position||t,p=u.calculateOffset(d,{reverseOrder:e,gutter:r,defaultPosition:t}),f=tE(h,p);return S.createElement(eE,{id:d.id,key:d.id,onHeightUpdate:u.updateHeight,className:d.visible?nE:"",style:f},d.type==="custom"?pu(d.message,d):s?s(d):S.createElement(Z3,{toast:d,position:h}))}))},$=Mt;const aE={},Zv=e=>{let t;const n=new Set,r=(d,h)=>{const p=typeof d=="function"?d(t):d;if(!Object.is(p,t)){const f=t;t=h??(typeof p!="object"||p===null)?p:Object.assign({},t,p),n.forEach(x=>x(t,f))}},s=()=>t,c={setState:r,getState:s,getInitialState:()=>u,subscribe:d=>(n.add(d),()=>n.delete(d)),destroy:()=>{(aE?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=t=e(r,s,c);return c},sE=e=>e?Zv(e):Zv;var pw={exports:{}},fw={},mw={exports:{}},xw={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hi=S;function iE(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var oE=typeof Object.is=="function"?Object.is:iE,lE=Hi.useState,cE=Hi.useEffect,uE=Hi.useLayoutEffect,dE=Hi.useDebugValue;function hE(e,t){var n=t(),r=lE({inst:{value:n,getSnapshot:t}}),s=r[0].inst,i=r[1];return uE(function(){s.value=n,s.getSnapshot=t,lh(s)&&i({inst:s})},[e,n,t]),cE(function(){return lh(s)&&i({inst:s}),e(function(){lh(s)&&i({inst:s})})},[e]),dE(n),n}function lh(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!oE(e,n)}catch{return!0}}function pE(e,t){return t()}var fE=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?pE:hE;xw.useSyncExternalStore=Hi.useSyncExternalStore!==void 0?Hi.useSyncExternalStore:fE;mw.exports=xw;var mE=mw.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cd=S,xE=mE;function gE(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var vE=typeof Object.is=="function"?Object.is:gE,yE=xE.useSyncExternalStore,bE=cd.useRef,wE=cd.useEffect,NE=cd.useMemo,jE=cd.useDebugValue;fw.useSyncExternalStoreWithSelector=function(e,t,n,r,s){var i=bE(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=NE(function(){function c(f){if(!u){if(u=!0,d=f,f=r(f),s!==void 0&&o.hasValue){var x=o.value;if(s(x,f))return h=x}return h=f}if(x=h,vE(d,f))return x;var v=r(f);return s!==void 0&&s(x,v)?(d=f,x):(d=f,h=v)}var u=!1,d,h,p=n===void 0?null:n;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,n,r,s]);var l=yE(e,i[0],i[1]);return wE(function(){o.hasValue=!0,o.value=l},[l]),jE(l),l};pw.exports=fw;var CE=pw.exports;const kE=Lb(CE),gw={},{useDebugValue:SE}=Vu,{useSyncExternalStoreWithSelector:EE}=kE;let ey=!1;const DE=e=>e;function RE(e,t=DE,n){(gw?"production":void 0)!=="production"&&n&&!ey&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),ey=!0);const r=EE(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return SE(r),r}const ty=e=>{(gw?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?sE(e):e,n=(r,s)=>RE(t,r,s);return Object.assign(n,t),n},_E=e=>e?ty(e):ty,TE={};function AE(e,t){let n;try{n=e()}catch{return}return{getItem:s=>{var i;const o=c=>c===null?null:JSON.parse(c,void 0),l=(i=n.getItem(s))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(s,i)=>n.setItem(s,JSON.stringify(i,void 0)),removeItem:s=>n.removeItem(s)}}const ll=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then(r){return ll(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return ll(r)(n)}}}},IE=(e,t)=>(n,r,s)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:y=>y,version:0,merge:(y,m)=>({...m,...y}),...t},o=!1;const l=new Set,c=new Set;let u;try{u=i.getStorage()}catch{}if(!u)return e((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...y)},r,s);const d=ll(i.serialize),h=()=>{const y=i.partialize({...r()});let m;const g=d({state:y,version:i.version}).then(b=>u.setItem(i.name,b)).catch(b=>{m=b});if(m)throw m;return g},p=s.setState;s.setState=(y,m)=>{p(y,m),h()};const f=e((...y)=>{n(...y),h()},r,s);let x;const v=()=>{var y;if(!u)return;o=!1,l.forEach(g=>g(r()));const m=((y=i.onRehydrateStorage)==null?void 0:y.call(i,r()))||void 0;return ll(u.getItem.bind(u))(i.name).then(g=>{if(g)return i.deserialize(g)}).then(g=>{if(g)if(typeof g.version=="number"&&g.version!==i.version){if(i.migrate)return i.migrate(g.state,g.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return g.state}).then(g=>{var b;return x=i.merge(g,(b=r())!=null?b:f),n(x,!0),h()}).then(()=>{m==null||m(x,void 0),o=!0,c.forEach(g=>g(x))}).catch(g=>{m==null||m(void 0,g)})};return s.persist={setOptions:y=>{i={...i,...y},y.getStorage&&(u=y.getStorage())},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>v(),hasHydrated:()=>o,onHydrate:y=>(l.add(y),()=>{l.delete(y)}),onFinishHydration:y=>(c.add(y),()=>{c.delete(y)})},v(),x||f},PE=(e,t)=>(n,r,s)=>{let i={storage:AE(()=>localStorage),partialize:v=>v,version:0,merge:(v,y)=>({...y,...v}),...t},o=!1;const l=new Set,c=new Set;let u=i.storage;if(!u)return e((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...v)},r,s);const d=()=>{const v=i.partialize({...r()});return u.setItem(i.name,{state:v,version:i.version})},h=s.setState;s.setState=(v,y)=>{h(v,y),d()};const p=e((...v)=>{n(...v),d()},r,s);s.getInitialState=()=>p;let f;const x=()=>{var v,y;if(!u)return;o=!1,l.forEach(g=>{var b;return g((b=r())!=null?b:p)});const m=((y=i.onRehydrateStorage)==null?void 0:y.call(i,(v=r())!=null?v:p))||void 0;return ll(u.getItem.bind(u))(i.name).then(g=>{if(g)if(typeof g.version=="number"&&g.version!==i.version){if(i.migrate)return[!0,i.migrate(g.state,g.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,g.state];return[!1,void 0]}).then(g=>{var b;const[w,N]=g;if(f=i.merge(N,(b=r())!=null?b:p),n(f,!0),w)return d()}).then(()=>{m==null||m(f,void 0),f=r(),o=!0,c.forEach(g=>g(f))}).catch(g=>{m==null||m(void 0,g)})};return s.persist={setOptions:v=>{i={...i,...v},v.storage&&(u=v.storage)},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>x(),hasHydrated:()=>o,onHydrate:v=>(l.add(v),()=>{l.delete(v)}),onFinishHydration:v=>(c.add(v),()=>{c.delete(v)})},i.skipHydration||x(),f||p},FE=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((TE?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),IE(e,t)):PE(e,t),ME=FE;function vw(e,t){return function(){return e.apply(t,arguments)}}const{toString:LE}=Object.prototype,{getPrototypeOf:vm}=Object,{iterator:ud,toStringTag:yw}=Symbol,dd=(e=>t=>{const n=LE.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Cr=e=>(e=e.toLowerCase(),t=>dd(t)===e),hd=e=>t=>typeof t===e,{isArray:io}=Array,qi=hd("undefined");function jl(e){return e!==null&&!qi(e)&&e.constructor!==null&&!qi(e.constructor)&&_n(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const bw=Cr("ArrayBuffer");function OE(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&bw(e.buffer),t}const BE=hd("string"),_n=hd("function"),ww=hd("number"),Cl=e=>e!==null&&typeof e=="object",$E=e=>e===!0||e===!1,Pc=e=>{if(dd(e)!=="object")return!1;const t=vm(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(yw in e)&&!(ud in e)},zE=e=>{if(!Cl(e)||jl(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},UE=Cr("Date"),WE=Cr("File"),VE=Cr("Blob"),HE=Cr("FileList"),qE=e=>Cl(e)&&_n(e.pipe),GE=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||_n(e.append)&&((t=dd(e))==="formdata"||t==="object"&&_n(e.toString)&&e.toString()==="[object FormData]"))},KE=Cr("URLSearchParams"),[XE,YE,QE,JE]=["ReadableStream","Request","Response","Headers"].map(Cr),ZE=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function kl(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,s;if(typeof e!="object"&&(e=[e]),io(e))for(r=0,s=e.length;r<s;r++)t.call(null,e[r],r,e);else{if(jl(e))return;const i=n?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let l;for(r=0;r<o;r++)l=i[r],t.call(null,e[l],l,e)}}function Nw(e,t){if(jl(e))return null;t=t.toLowerCase();const n=Object.keys(e);let r=n.length,s;for(;r-- >0;)if(s=n[r],t===s.toLowerCase())return s;return null}const Rs=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,jw=e=>!qi(e)&&e!==Rs;function Bp(){const{caseless:e,skipUndefined:t}=jw(this)&&this||{},n={},r=(s,i)=>{const o=e&&Nw(n,i)||i;Pc(n[o])&&Pc(s)?n[o]=Bp(n[o],s):Pc(s)?n[o]=Bp({},s):io(s)?n[o]=s.slice():(!t||!qi(s))&&(n[o]=s)};for(let s=0,i=arguments.length;s<i;s++)arguments[s]&&kl(arguments[s],r);return n}const e5=(e,t,n,{allOwnKeys:r}={})=>(kl(t,(s,i)=>{n&&_n(s)?Object.defineProperty(e,i,{value:vw(s,n),writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(e,i,{value:s,writable:!0,enumerable:!0,configurable:!0})},{allOwnKeys:r}),e),t5=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),n5=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},r5=(e,t,n,r)=>{let s,i,o;const l={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),i=s.length;i-- >0;)o=s[i],(!r||r(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=n!==!1&&vm(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},a5=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},s5=e=>{if(!e)return null;if(io(e))return e;let t=e.length;if(!ww(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},i5=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&vm(Uint8Array)),o5=(e,t)=>{const r=(e&&e[ud]).call(e);let s;for(;(s=r.next())&&!s.done;){const i=s.value;t.call(e,i[0],i[1])}},l5=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},c5=Cr("HTMLFormElement"),u5=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,s){return r.toUpperCase()+s}),ny=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),d5=Cr("RegExp"),Cw=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};kl(n,(s,i)=>{let o;(o=t(s,i,e))!==!1&&(r[i]=o||s)}),Object.defineProperties(e,r)},h5=e=>{Cw(e,(t,n)=>{if(_n(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(_n(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},p5=(e,t)=>{const n={},r=s=>{s.forEach(i=>{n[i]=!0})};return io(e)?r(e):r(String(e).split(t)),n},f5=()=>{},m5=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function x5(e){return!!(e&&_n(e.append)&&e[yw]==="FormData"&&e[ud])}const g5=e=>{const t=new Array(10),n=(r,s)=>{if(Cl(r)){if(t.indexOf(r)>=0)return;if(jl(r))return r;if(!("toJSON"in r)){t[s]=r;const i=io(r)?[]:{};return kl(r,(o,l)=>{const c=n(o,s+1);!qi(c)&&(i[l]=c)}),t[s]=void 0,i}}return r};return n(e,0)},v5=Cr("AsyncFunction"),y5=e=>e&&(Cl(e)||_n(e))&&_n(e.then)&&_n(e.catch),kw=((e,t)=>e?setImmediate:t?((n,r)=>(Rs.addEventListener("message",({source:s,data:i})=>{s===Rs&&i===n&&r.length&&r.shift()()},!1),s=>{r.push(s),Rs.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",_n(Rs.postMessage)),b5=typeof queueMicrotask<"u"?queueMicrotask.bind(Rs):typeof process<"u"&&process.nextTick||kw,w5=e=>e!=null&&_n(e[ud]),X={isArray:io,isArrayBuffer:bw,isBuffer:jl,isFormData:GE,isArrayBufferView:OE,isString:BE,isNumber:ww,isBoolean:$E,isObject:Cl,isPlainObject:Pc,isEmptyObject:zE,isReadableStream:XE,isRequest:YE,isResponse:QE,isHeaders:JE,isUndefined:qi,isDate:UE,isFile:WE,isBlob:VE,isRegExp:d5,isFunction:_n,isStream:qE,isURLSearchParams:KE,isTypedArray:i5,isFileList:HE,forEach:kl,merge:Bp,extend:e5,trim:ZE,stripBOM:t5,inherits:n5,toFlatObject:r5,kindOf:dd,kindOfTest:Cr,endsWith:a5,toArray:s5,forEachEntry:o5,matchAll:l5,isHTMLForm:c5,hasOwnProperty:ny,hasOwnProp:ny,reduceDescriptors:Cw,freezeMethods:h5,toObjectSet:p5,toCamelCase:u5,noop:f5,toFiniteNumber:m5,findKey:Nw,global:Rs,isContextDefined:jw,isSpecCompliantForm:x5,toJSONObject:g5,isAsyncFn:v5,isThenable:y5,setImmediate:kw,asap:b5,isIterable:w5};let Ie=class Sw extends Error{static from(t,n,r,s,i,o){const l=new Sw(t.message,n||t.code,r,s,i);return l.cause=t,l.name=t.name,o&&Object.assign(l,o),l}constructor(t,n,r,s,i){super(t),this.name="AxiosError",this.isAxiosError=!0,n&&(this.code=n),r&&(this.config=r),s&&(this.request=s),i&&(this.response=i,this.status=i.status)}toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:X.toJSONObject(this.config),code:this.code,status:this.status}}};Ie.ERR_BAD_OPTION_VALUE="ERR_BAD_OPTION_VALUE";Ie.ERR_BAD_OPTION="ERR_BAD_OPTION";Ie.ECONNABORTED="ECONNABORTED";Ie.ETIMEDOUT="ETIMEDOUT";Ie.ERR_NETWORK="ERR_NETWORK";Ie.ERR_FR_TOO_MANY_REDIRECTS="ERR_FR_TOO_MANY_REDIRECTS";Ie.ERR_DEPRECATED="ERR_DEPRECATED";Ie.ERR_BAD_RESPONSE="ERR_BAD_RESPONSE";Ie.ERR_BAD_REQUEST="ERR_BAD_REQUEST";Ie.ERR_CANCELED="ERR_CANCELED";Ie.ERR_NOT_SUPPORT="ERR_NOT_SUPPORT";Ie.ERR_INVALID_URL="ERR_INVALID_URL";const N5=null;function $p(e){return X.isPlainObject(e)||X.isArray(e)}function Ew(e){return X.endsWith(e,"[]")?e.slice(0,-2):e}function ry(e,t,n){return e?e.concat(t).map(function(s,i){return s=Ew(s),!n&&i?"["+s+"]":s}).join(n?".":""):t}function j5(e){return X.isArray(e)&&!e.some($p)}const C5=X.toFlatObject(X,{},null,function(t){return/^is[A-Z]/.test(t)});function pd(e,t,n){if(!X.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=X.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(v,y){return!X.isUndefined(y[v])});const r=n.metaTokens,s=n.visitor||d,i=n.dots,o=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&X.isSpecCompliantForm(t);if(!X.isFunction(s))throw new TypeError("visitor must be a function");function u(x){if(x===null)return"";if(X.isDate(x))return x.toISOString();if(X.isBoolean(x))return x.toString();if(!c&&X.isBlob(x))throw new Ie("Blob is not supported. Use a Buffer instead.");return X.isArrayBuffer(x)||X.isTypedArray(x)?c&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function d(x,v,y){let m=x;if(x&&!y&&typeof x=="object"){if(X.endsWith(v,"{}"))v=r?v:v.slice(0,-2),x=JSON.stringify(x);else if(X.isArray(x)&&j5(x)||(X.isFileList(x)||X.endsWith(v,"[]"))&&(m=X.toArray(x)))return v=Ew(v),m.forEach(function(b,w){!(X.isUndefined(b)||b===null)&&t.append(o===!0?ry([v],w,i):o===null?v:v+"[]",u(b))}),!1}return $p(x)?!0:(t.append(ry(y,v,i),u(x)),!1)}const h=[],p=Object.assign(C5,{defaultVisitor:d,convertValue:u,isVisitable:$p});function f(x,v){if(!X.isUndefined(x)){if(h.indexOf(x)!==-1)throw Error("Circular reference detected in "+v.join("."));h.push(x),X.forEach(x,function(m,g){(!(X.isUndefined(m)||m===null)&&s.call(t,m,X.isString(g)?g.trim():g,v,p))===!0&&f(m,v?v.concat(g):[g])}),h.pop()}}if(!X.isObject(e))throw new TypeError("data must be an object");return f(e),t}function ay(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function ym(e,t){this._pairs=[],e&&pd(e,this,t)}const Dw=ym.prototype;Dw.append=function(t,n){this._pairs.push([t,n])};Dw.toString=function(t){const n=t?function(r){return t.call(this,r,ay)}:ay;return this._pairs.map(function(s){return n(s[0])+"="+n(s[1])},"").join("&")};function k5(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Rw(e,t,n){if(!t)return e;const r=n&&n.encode||k5,s=X.isFunction(n)?{serialize:n}:n,i=s&&s.serialize;let o;if(i?o=i(t,s):o=X.isURLSearchParams(t)?t.toString():new ym(t,s).toString(r),o){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+o}return e}class sy{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){X.forEach(this.handlers,function(r){r!==null&&t(r)})}}const _w={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},S5=typeof URLSearchParams<"u"?URLSearchParams:ym,E5=typeof FormData<"u"?FormData:null,D5=typeof Blob<"u"?Blob:null,R5={isBrowser:!0,classes:{URLSearchParams:S5,FormData:E5,Blob:D5},protocols:["http","https","file","blob","url","data"]},bm=typeof window<"u"&&typeof document<"u",zp=typeof navigator=="object"&&navigator||void 0,_5=bm&&(!zp||["ReactNative","NativeScript","NS"].indexOf(zp.product)<0),T5=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",A5=bm&&window.location.href||"http://localhost",I5=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:bm,hasStandardBrowserEnv:_5,hasStandardBrowserWebWorkerEnv:T5,navigator:zp,origin:A5},Symbol.toStringTag,{value:"Module"})),cn={...I5,...R5};function P5(e,t){return pd(e,new cn.classes.URLSearchParams,{visitor:function(n,r,s,i){return cn.isNode&&X.isBuffer(n)?(this.append(r,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function F5(e){return X.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function M5(e){const t={},n=Object.keys(e);let r;const s=n.length;let i;for(r=0;r<s;r++)i=n[r],t[i]=e[i];return t}function Tw(e){function t(n,r,s,i){let o=n[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=i>=n.length;return o=!o&&X.isArray(s)?s.length:o,c?(X.hasOwnProp(s,o)?s[o]=[s[o],r]:s[o]=r,!l):((!s[o]||!X.isObject(s[o]))&&(s[o]=[]),t(n,r,s[o],i)&&X.isArray(s[o])&&(s[o]=M5(s[o])),!l)}if(X.isFormData(e)&&X.isFunction(e.entries)){const n={};return X.forEachEntry(e,(r,s)=>{t(F5(r),s,n,0)}),n}return null}function L5(e,t,n){if(X.isString(e))try{return(t||JSON.parse)(e),X.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const Sl={transitional:_w,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",s=r.indexOf("application/json")>-1,i=X.isObject(t);if(i&&X.isHTMLForm(t)&&(t=new FormData(t)),X.isFormData(t))return s?JSON.stringify(Tw(t)):t;if(X.isArrayBuffer(t)||X.isBuffer(t)||X.isStream(t)||X.isFile(t)||X.isBlob(t)||X.isReadableStream(t))return t;if(X.isArrayBufferView(t))return t.buffer;if(X.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return P5(t,this.formSerializer).toString();if((l=X.isFileList(t))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return pd(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||s?(n.setContentType("application/json",!1),L5(t)):t}],transformResponse:[function(t){const n=this.transitional||Sl.transitional,r=n&&n.forcedJSONParsing,s=this.responseType==="json";if(X.isResponse(t)||X.isReadableStream(t))return t;if(t&&X.isString(t)&&(r&&!this.responseType||s)){const o=!(n&&n.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?Ie.from(l,Ie.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:cn.classes.FormData,Blob:cn.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};X.forEach(["delete","get","head","post","put","patch"],e=>{Sl.headers[e]={}});const O5=X.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),B5=e=>{const t={};let n,r,s;return e&&e.split(`
`).forEach(function(o){s=o.indexOf(":"),n=o.substring(0,s).trim().toLowerCase(),r=o.substring(s+1).trim(),!(!n||t[n]&&O5[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},iy=Symbol("internals");function wo(e){return e&&String(e).trim().toLowerCase()}function Fc(e){return e===!1||e==null?e:X.isArray(e)?e.map(Fc):String(e)}function $5(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const z5=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function ch(e,t,n,r,s){if(X.isFunction(r))return r.call(this,t,n);if(s&&(t=n),!!X.isString(t)){if(X.isString(r))return t.indexOf(r)!==-1;if(X.isRegExp(r))return r.test(t)}}function U5(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function W5(e,t){const n=X.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(s,i,o){return this[r].call(this,t,s,i,o)},configurable:!0})})}let Tn=class{constructor(t){t&&this.set(t)}set(t,n,r){const s=this;function i(l,c,u){const d=wo(c);if(!d)throw new Error("header name must be a non-empty string");const h=X.findKey(s,d);(!h||s[h]===void 0||u===!0||u===void 0&&s[h]!==!1)&&(s[h||c]=Fc(l))}const o=(l,c)=>X.forEach(l,(u,d)=>i(u,d,c));if(X.isPlainObject(t)||t instanceof this.constructor)o(t,n);else if(X.isString(t)&&(t=t.trim())&&!z5(t))o(B5(t),n);else if(X.isObject(t)&&X.isIterable(t)){let l={},c,u;for(const d of t){if(!X.isArray(d))throw TypeError("Object iterator must return a key-value pair");l[u=d[0]]=(c=l[u])?X.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}o(l,n)}else t!=null&&i(n,t,r);return this}get(t,n){if(t=wo(t),t){const r=X.findKey(this,t);if(r){const s=this[r];if(!n)return s;if(n===!0)return $5(s);if(X.isFunction(n))return n.call(this,s,r);if(X.isRegExp(n))return n.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=wo(t),t){const r=X.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||ch(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let s=!1;function i(o){if(o=wo(o),o){const l=X.findKey(r,o);l&&(!n||ch(r,r[l],l,n))&&(delete r[l],s=!0)}}return X.isArray(t)?t.forEach(i):i(t),s}clear(t){const n=Object.keys(this);let r=n.length,s=!1;for(;r--;){const i=n[r];(!t||ch(this,this[i],i,t,!0))&&(delete this[i],s=!0)}return s}normalize(t){const n=this,r={};return X.forEach(this,(s,i)=>{const o=X.findKey(r,i);if(o){n[o]=Fc(s),delete n[i];return}const l=t?U5(i):String(i).trim();l!==i&&delete n[i],n[l]=Fc(s),r[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return X.forEach(this,(r,s)=>{r!=null&&r!==!1&&(n[s]=t&&X.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(s=>r.set(s)),r}static accessor(t){const r=(this[iy]=this[iy]={accessors:{}}).accessors,s=this.prototype;function i(o){const l=wo(o);r[l]||(W5(s,o),r[l]=!0)}return X.isArray(t)?t.forEach(i):i(t),this}};Tn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);X.reduceDescriptors(Tn.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});X.freezeMethods(Tn);function uh(e,t){const n=this||Sl,r=t||n,s=Tn.from(r.headers);let i=r.data;return X.forEach(e,function(l){i=l.call(n,i,s.normalize(),t?t.status:void 0)}),s.normalize(),i}function Aw(e){return!!(e&&e.__CANCEL__)}let El=class extends Ie{constructor(t,n,r){super(t??"canceled",Ie.ERR_CANCELED,n,r),this.name="CanceledError",this.__CANCEL__=!0}};function Iw(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new Ie("Request failed with status code "+n.status,[Ie.ERR_BAD_REQUEST,Ie.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function V5(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function H5(e,t){e=e||10;const n=new Array(e),r=new Array(e);let s=0,i=0,o;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=r[i];o||(o=u),n[s]=c,r[s]=u;let h=i,p=0;for(;h!==s;)p+=n[h++],h=h%e;if(s=(s+1)%e,s===i&&(i=(i+1)%e),u-o<t)return;const f=d&&u-d;return f?Math.round(p*1e3/f):void 0}}function q5(e,t){let n=0,r=1e3/t,s,i;const o=(u,d=Date.now())=>{n=d,s=null,i&&(clearTimeout(i),i=null),e(...u)};return[(...u)=>{const d=Date.now(),h=d-n;h>=r?o(u,d):(s=u,i||(i=setTimeout(()=>{i=null,o(s)},r-h)))},()=>s&&o(s)]}const fu=(e,t,n=3)=>{let r=0;const s=H5(50,250);return q5(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,c=o-r,u=s(c),d=o<=l;r=o;const h={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-o)/u:void 0,event:i,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(h)},n)},oy=(e,t)=>{const n=e!=null;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},ly=e=>(...t)=>X.asap(()=>e(...t)),G5=cn.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,cn.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(cn.origin),cn.navigator&&/(msie|trident)/i.test(cn.navigator.userAgent)):()=>!0,K5=cn.hasStandardBrowserEnv?{write(e,t,n,r,s,i,o){if(typeof document>"u")return;const l=[`${e}=${encodeURIComponent(t)}`];X.isNumber(n)&&l.push(`expires=${new Date(n).toUTCString()}`),X.isString(r)&&l.push(`path=${r}`),X.isString(s)&&l.push(`domain=${s}`),i===!0&&l.push("secure"),X.isString(o)&&l.push(`SameSite=${o}`),document.cookie=l.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function X5(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Y5(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Pw(e,t,n){let r=!X5(t);return e&&(r||n==!1)?Y5(e,t):t}const cy=e=>e instanceof Tn?{...e}:e;function Us(e,t){t=t||{};const n={};function r(u,d,h,p){return X.isPlainObject(u)&&X.isPlainObject(d)?X.merge.call({caseless:p},u,d):X.isPlainObject(d)?X.merge({},d):X.isArray(d)?d.slice():d}function s(u,d,h,p){if(X.isUndefined(d)){if(!X.isUndefined(u))return r(void 0,u,h,p)}else return r(u,d,h,p)}function i(u,d){if(!X.isUndefined(d))return r(void 0,d)}function o(u,d){if(X.isUndefined(d)){if(!X.isUndefined(u))return r(void 0,u)}else return r(void 0,d)}function l(u,d,h){if(h in t)return r(u,d);if(h in e)return r(void 0,u)}const c={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,d,h)=>s(cy(u),cy(d),h,!0)};return X.forEach(Object.keys({...e,...t}),function(d){const h=c[d]||s,p=h(e[d],t[d],d);X.isUndefined(p)&&h!==l||(n[d]=p)}),n}const Fw=e=>{const t=Us({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:i,headers:o,auth:l}=t;if(t.headers=o=Tn.from(o),t.url=Rw(Pw(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),X.isFormData(n)){if(cn.hasStandardBrowserEnv||cn.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(X.isFunction(n.getHeaders)){const c=n.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([d,h])=>{u.includes(d.toLowerCase())&&o.set(d,h)})}}if(cn.hasStandardBrowserEnv&&(r&&X.isFunction(r)&&(r=r(t)),r||r!==!1&&G5(t.url))){const c=s&&i&&K5.read(i);c&&o.set(s,c)}return t},Q5=typeof XMLHttpRequest<"u",J5=Q5&&function(e){return new Promise(function(n,r){const s=Fw(e);let i=s.data;const o=Tn.from(s.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=s,d,h,p,f,x;function v(){f&&f(),x&&x(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let y=new XMLHttpRequest;y.open(s.method.toUpperCase(),s.url,!0),y.timeout=s.timeout;function m(){if(!y)return;const b=Tn.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),N={data:!l||l==="text"||l==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:b,config:e,request:y};Iw(function(D){n(D),v()},function(D){r(D),v()},N),y=null}"onloadend"in y?y.onloadend=m:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(m)},y.onabort=function(){y&&(r(new Ie("Request aborted",Ie.ECONNABORTED,e,y)),y=null)},y.onerror=function(w){const N=w&&w.message?w.message:"Network Error",C=new Ie(N,Ie.ERR_NETWORK,e,y);C.event=w||null,r(C),y=null},y.ontimeout=function(){let w=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const N=s.transitional||_w;s.timeoutErrorMessage&&(w=s.timeoutErrorMessage),r(new Ie(w,N.clarifyTimeoutError?Ie.ETIMEDOUT:Ie.ECONNABORTED,e,y)),y=null},i===void 0&&o.setContentType(null),"setRequestHeader"in y&&X.forEach(o.toJSON(),function(w,N){y.setRequestHeader(N,w)}),X.isUndefined(s.withCredentials)||(y.withCredentials=!!s.withCredentials),l&&l!=="json"&&(y.responseType=s.responseType),u&&([p,x]=fu(u,!0),y.addEventListener("progress",p)),c&&y.upload&&([h,f]=fu(c),y.upload.addEventListener("progress",h),y.upload.addEventListener("loadend",f)),(s.cancelToken||s.signal)&&(d=b=>{y&&(r(!b||b.type?new El(null,e,y):b),y.abort(),y=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const g=V5(s.url);if(g&&cn.protocols.indexOf(g)===-1){r(new Ie("Unsupported protocol "+g+":",Ie.ERR_BAD_REQUEST,e));return}y.send(i||null)})},Z5=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let r=new AbortController,s;const i=function(u){if(!s){s=!0,l();const d=u instanceof Error?u:this.reason;r.abort(d instanceof Ie?d:new El(d instanceof Error?d.message:d))}};let o=t&&setTimeout(()=>{o=null,i(new Ie(`timeout of ${t}ms exceeded`,Ie.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),e=null)};e.forEach(u=>u.addEventListener("abort",i));const{signal:c}=r;return c.unsubscribe=()=>X.asap(l),c}},eD=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let r=0,s;for(;r<n;)s=r+t,yield e.slice(r,s),r=s},tD=async function*(e,t){for await(const n of nD(e))yield*eD(n,t)},nD=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:r}=await t.read();if(n)break;yield r}}finally{await t.cancel()}},uy=(e,t,n,r)=>{const s=tD(e,t);let i=0,o,l=c=>{o||(o=!0,r&&r(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await s.next();if(u){l(),c.close();return}let h=d.byteLength;if(n){let p=i+=h;n(p)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),s.return()}},{highWaterMark:2})},dy=64*1024,{isFunction:sc}=X,rD=(({Request:e,Response:t})=>({Request:e,Response:t}))(X.global),{ReadableStream:hy,TextEncoder:py}=X.global,fy=(e,...t)=>{try{return!!e(...t)}catch{return!1}},aD=e=>{e=X.merge.call({skipUndefined:!0},rD,e);const{fetch:t,Request:n,Response:r}=e,s=t?sc(t):typeof fetch=="function",i=sc(n),o=sc(r);if(!s)return!1;const l=s&&sc(hy),c=s&&(typeof py=="function"?(x=>v=>x.encode(v))(new py):async x=>new Uint8Array(await new n(x).arrayBuffer())),u=i&&l&&fy(()=>{let x=!1;const v=new n(cn.origin,{body:new hy,method:"POST",get duplex(){return x=!0,"half"}}).headers.has("Content-Type");return x&&!v}),d=o&&l&&fy(()=>X.isReadableStream(new r("").body)),h={stream:d&&(x=>x.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(x=>{!h[x]&&(h[x]=(v,y)=>{let m=v&&v[x];if(m)return m.call(v);throw new Ie(`Response type '${x}' is not supported`,Ie.ERR_NOT_SUPPORT,y)})});const p=async x=>{if(x==null)return 0;if(X.isBlob(x))return x.size;if(X.isSpecCompliantForm(x))return(await new n(cn.origin,{method:"POST",body:x}).arrayBuffer()).byteLength;if(X.isArrayBufferView(x)||X.isArrayBuffer(x))return x.byteLength;if(X.isURLSearchParams(x)&&(x=x+""),X.isString(x))return(await c(x)).byteLength},f=async(x,v)=>{const y=X.toFiniteNumber(x.getContentLength());return y??p(v)};return async x=>{let{url:v,method:y,data:m,signal:g,cancelToken:b,timeout:w,onDownloadProgress:N,onUploadProgress:C,responseType:D,headers:j,withCredentials:k="same-origin",fetchOptions:R}=Fw(x),E=t||fetch;D=D?(D+"").toLowerCase():"text";let P=Z5([g,b&&b.toAbortSignal()],w),F=null;const W=P&&P.unsubscribe&&(()=>{P.unsubscribe()});let L;try{if(C&&u&&y!=="get"&&y!=="head"&&(L=await f(j,m))!==0){let J=new n(v,{method:"POST",body:m,duplex:"half"}),te;if(X.isFormData(m)&&(te=J.headers.get("content-type"))&&j.setContentType(te),J.body){const[ce,se]=oy(L,fu(ly(C)));m=uy(J.body,dy,ce,se)}}X.isString(k)||(k=k?"include":"omit");const U=i&&"credentials"in n.prototype,_={...R,signal:P,method:y.toUpperCase(),headers:j.normalize().toJSON(),body:m,duplex:"half",credentials:U?k:void 0};F=i&&new n(v,_);let B=await(i?E(F,R):E(v,_));const O=d&&(D==="stream"||D==="response");if(d&&(N||O&&W)){const J={};["status","statusText","headers"].forEach(le=>{J[le]=B[le]});const te=X.toFiniteNumber(B.headers.get("content-length")),[ce,se]=N&&oy(te,fu(ly(N),!0))||[];B=new r(uy(B.body,dy,ce,()=>{se&&se(),W&&W()}),J)}D=D||"text";let H=await h[X.findKey(h,D)||"text"](B,x);return!O&&W&&W(),await new Promise((J,te)=>{Iw(J,te,{data:H,headers:Tn.from(B.headers),status:B.status,statusText:B.statusText,config:x,request:F})})}catch(U){throw W&&W(),U&&U.name==="TypeError"&&/Load failed|fetch/i.test(U.message)?Object.assign(new Ie("Network Error",Ie.ERR_NETWORK,x,F),{cause:U.cause||U}):Ie.from(U,U&&U.code,x,F)}}},sD=new Map,Mw=e=>{let t=e&&e.env||{};const{fetch:n,Request:r,Response:s}=t,i=[r,s,n];let o=i.length,l=o,c,u,d=sD;for(;l--;)c=i[l],u=d.get(c),u===void 0&&d.set(c,u=l?new Map:aD(t)),d=u;return u};Mw();const wm={http:N5,xhr:J5,fetch:{get:Mw}};X.forEach(wm,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const my=e=>`- ${e}`,iD=e=>X.isFunction(e)||e===null||e===!1;function oD(e,t){e=X.isArray(e)?e:[e];const{length:n}=e;let r,s;const i={};for(let o=0;o<n;o++){r=e[o];let l;if(s=r,!iD(r)&&(s=wm[(l=String(r)).toLowerCase()],s===void 0))throw new Ie(`Unknown adapter '${l}'`);if(s&&(X.isFunction(s)||(s=s.get(t))))break;i[l||"#"+o]=s}if(!s){const o=Object.entries(i).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let l=n?o.length>1?`since :
`+o.map(my).join(`
`):" "+my(o[0]):"as no adapter specified";throw new Ie("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return s}const Lw={getAdapter:oD,adapters:wm};function dh(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new El(null,e)}function xy(e){return dh(e),e.headers=Tn.from(e.headers),e.data=uh.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Lw.getAdapter(e.adapter||Sl.adapter,e)(e).then(function(r){return dh(e),r.data=uh.call(e,e.transformResponse,r),r.headers=Tn.from(r.headers),r},function(r){return Aw(r)||(dh(e),r&&r.response&&(r.response.data=uh.call(e,e.transformResponse,r.response),r.response.headers=Tn.from(r.response.headers))),Promise.reject(r)})}const Ow="1.13.4",fd={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{fd[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const gy={};fd.transitional=function(t,n,r){function s(i,o){return"[Axios v"+Ow+"] Transitional option '"+i+"'"+o+(r?". "+r:"")}return(i,o,l)=>{if(t===!1)throw new Ie(s(o," has been removed"+(n?" in "+n:"")),Ie.ERR_DEPRECATED);return n&&!gy[o]&&(gy[o]=!0,console.warn(s(o," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(i,o,l):!0}};fd.spelling=function(t){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function lD(e,t,n){if(typeof e!="object")throw new Ie("options must be an object",Ie.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let s=r.length;for(;s-- >0;){const i=r[s],o=t[i];if(o){const l=e[i],c=l===void 0||o(l,i,e);if(c!==!0)throw new Ie("option "+i+" must be "+c,Ie.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Ie("Unknown option "+i,Ie.ERR_BAD_OPTION)}}const Mc={assertOptions:lD,validators:fd},Rr=Mc.validators;let Ps=class{constructor(t){this.defaults=t||{},this.interceptors={request:new sy,response:new sy}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=Us(this.defaults,n);const{transitional:r,paramsSerializer:s,headers:i}=n;r!==void 0&&Mc.assertOptions(r,{silentJSONParsing:Rr.transitional(Rr.boolean),forcedJSONParsing:Rr.transitional(Rr.boolean),clarifyTimeoutError:Rr.transitional(Rr.boolean)},!1),s!=null&&(X.isFunction(s)?n.paramsSerializer={serialize:s}:Mc.assertOptions(s,{encode:Rr.function,serialize:Rr.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Mc.assertOptions(n,{baseUrl:Rr.spelling("baseURL"),withXsrfToken:Rr.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=i&&X.merge(i.common,i[n.method]);i&&X.forEach(["delete","get","head","post","put","patch","common"],x=>{delete i[x]}),n.headers=Tn.concat(o,i);const l=[];let c=!0;this.interceptors.request.forEach(function(v){typeof v.runWhen=="function"&&v.runWhen(n)===!1||(c=c&&v.synchronous,l.unshift(v.fulfilled,v.rejected))});const u=[];this.interceptors.response.forEach(function(v){u.push(v.fulfilled,v.rejected)});let d,h=0,p;if(!c){const x=[xy.bind(this),void 0];for(x.unshift(...l),x.push(...u),p=x.length,d=Promise.resolve(n);h<p;)d=d.then(x[h++],x[h++]);return d}p=l.length;let f=n;for(;h<p;){const x=l[h++],v=l[h++];try{f=x(f)}catch(y){v.call(this,y);break}}try{d=xy.call(this,f)}catch(x){return Promise.reject(x)}for(h=0,p=u.length;h<p;)d=d.then(u[h++],u[h++]);return d}getUri(t){t=Us(this.defaults,t);const n=Pw(t.baseURL,t.url,t.allowAbsoluteUrls);return Rw(n,t.params,t.paramsSerializer)}};X.forEach(["delete","get","head","options"],function(t){Ps.prototype[t]=function(n,r){return this.request(Us(r||{},{method:t,url:n,data:(r||{}).data}))}});X.forEach(["post","put","patch"],function(t){function n(r){return function(i,o,l){return this.request(Us(l||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}Ps.prototype[t]=n(),Ps.prototype[t+"Form"]=n(!0)});let cD=class Bw{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const r=this;this.promise.then(s=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](s);r._listeners=null}),this.promise.then=s=>{let i;const o=new Promise(l=>{r.subscribe(l),i=l}).then(s);return o.cancel=function(){r.unsubscribe(i)},o},t(function(i,o,l){r.reason||(r.reason=new El(i,o,l),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=r=>{t.abort(r)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new Bw(function(s){t=s}),cancel:t}}};function uD(e){return function(n){return e.apply(null,n)}}function dD(e){return X.isObject(e)&&e.isAxiosError===!0}const Up={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Up).forEach(([e,t])=>{Up[t]=e});function $w(e){const t=new Ps(e),n=vw(Ps.prototype.request,t);return X.extend(n,Ps.prototype,t,{allOwnKeys:!0}),X.extend(n,t,null,{allOwnKeys:!0}),n.create=function(s){return $w(Us(e,s))},n}const pt=$w(Sl);pt.Axios=Ps;pt.CanceledError=El;pt.CancelToken=cD;pt.isCancel=Aw;pt.VERSION=Ow;pt.toFormData=pd;pt.AxiosError=Ie;pt.Cancel=pt.CanceledError;pt.all=function(t){return Promise.all(t)};pt.spread=uD;pt.isAxiosError=dD;pt.mergeConfig=Us;pt.AxiosHeaders=Tn;pt.formToJSON=e=>Tw(X.isHTMLForm(e)?new FormData(e):e);pt.getAdapter=Lw.getAdapter;pt.HttpStatusCode=Up;pt.default=pt;const{Axios:CL,AxiosError:kL,CanceledError:SL,isCancel:EL,CancelToken:DL,VERSION:RL,all:_L,Cancel:TL,isAxiosError:AL,spread:IL,toFormData:PL,AxiosHeaders:FL,HttpStatusCode:ML,formToJSON:LL,getAdapter:OL,mergeConfig:BL}=pt,K=pt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});K.interceptors.request.use(e=>{const t=sessionStorage.getItem("admin-token");if(t)return e.headers.Authorization=`Bearer ${t}`,e;const n=localStorage.getItem("auth-storage");if(n){const{state:r}=JSON.parse(n);r!=null&&r.token&&(e.headers.Authorization=`Bearer ${r.token}`)}return e},e=>Promise.reject(e));K.interceptors.response.use(e=>e,e=>{var t;return((t=e.response)==null?void 0:t.status)===401&&(localStorage.removeItem("auth-storage"),window.location.href="/login"),Promise.reject(e)});const cr=_E(ME((e,t)=>({user:null,token:null,isAuthenticated:!1,isLoading:!1,login:async(n,r)=>{var s,i;e({isLoading:!0});try{const o=await K.post("/auth/login",{email:n,password:r}),{token:l,user:c}=o.data;return e({user:c,token:l,isAuthenticated:!0,isLoading:!1}),{success:!0}}catch(o){return e({isLoading:!1}),{success:!1,error:((i=(s=o.response)==null?void 0:s.data)==null?void 0:i.message)||"Erreur de connexion"}}},register:async n=>{var r,s;e({isLoading:!0});try{const i=await K.post("/auth/register",n),{token:o,user:l}=i.data;return e({user:l,token:o,isAuthenticated:!0,isLoading:!1}),{success:!0}}catch(i){return e({isLoading:!1}),{success:!1,error:((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Erreur d'inscription"}}},setAuth:(n,r)=>{e({token:n,user:r,isAuthenticated:!0})},logout:()=>{e({user:null,token:null,isAuthenticated:!1})},updateUser:n=>{e({user:{...t().user,...n}})},fetchUser:async()=>{var n;try{const r=await K.get("/auth/me");e({user:r.data.user})}catch(r){((n=r.response)==null?void 0:n.status)===401&&t().logout()}}}),{name:"auth-storage",partialize:e=>({token:e.token,user:e.user,isAuthenticated:e.isAuthenticated})}));/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var hD={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pD=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Q=(e,t)=>{const n=S.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:c,...u},d)=>S.createElement("svg",{ref:d,...hD,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:["lucide",`lucide-${pD(e)}`,l].join(" "),...u},[...t.map(([h,p])=>S.createElement(h,p)),...Array.isArray(c)?c:[c]]));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zw=Q("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fD=Q("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cl=Q("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vy=Q("AlignCenter",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"17",x2:"7",y1:"12",y2:"12",key:"rsh8ii"}],["line",{x1:"19",x2:"5",y1:"18",y2:"18",key:"1t0tuv"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yy=Q("AlignLeft",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}],["line",{x1:"17",x2:"3",y1:"18",y2:"18",key:"1awlsn"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const by=Q("AlignRight",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}],["line",{x1:"21",x2:"7",y1:"18",y2:"18",key:"1g9eri"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mD=Q("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xD=Q("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yn=Q("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=Q("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gD=Q("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vD=Q("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uw=Q("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yD=Q("Baby",[["path",{d:"M9 12h.01",key:"157uk2"}],["path",{d:"M15 12h.01",key:"1k8ypt"}],["path",{d:"M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5",key:"1u7htd"}],["path",{d:"M19 6.3a9 9 0 0 1 1.8 3.9 2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1",key:"5yv0yz"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bD=Q("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nm=Q("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wp=Q("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wy=Q("Bold",[["path",{d:"M14 12a4 4 0 0 0 0-8H6v8",key:"v2sylx"}],["path",{d:"M15 20a4 4 0 0 0 0-8H6v8Z",key:"1ef5ya"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wD=Q("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ND=Q("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ww=Q("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vp=Q("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=Q("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const md=Q("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bn=Q("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=Q("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mu=Q("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jD=Q("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=Q("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=Q("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ny=Q("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gi=Q("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=Q("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CD=Q("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=Q("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kD=Q("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SD=Q("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ED=Q("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jy=Q("Cpu",[["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"9",y:"9",width:"6",height:"6",key:"o3kz5p"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=Q("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hp=Q("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DD=Q("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RD=Q("Diamond",[["path",{d:"M2.7 10.3a2.41 2.41 0 0 0 0 3.41l7.59 7.59a2.41 2.41 0 0 0 3.41 0l7.59-7.59a2.41 2.41 0 0 0 0-3.41l-7.59-7.59a2.41 2.41 0 0 0-3.41 0Z",key:"1f1r0c"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=Q("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=Q("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jm=Q("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=Q("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cm=Q("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=Q("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vw=Q("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hw=Q("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ki=Q("FolderKanban",[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M12 10v2",key:"hh53o1"}],["path",{d:"M16 10v6",key:"1d6xys"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=Q("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _D=Q("Gem",[["path",{d:"M6 3h12l4 6-10 13L2 9Z",key:"1pcd5k"}],["path",{d:"M11 3 8 9l4 13 4-13-3-6",key:"1fcu3u"}],["path",{d:"M2 9h20",key:"16fsjt"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TD=Q("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AD=Q("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qw=Q("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ID=Q("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PD=Q("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FD=Q("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xi=Q("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MD=Q("Hexagon",[["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lc=Q("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gw=Q("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LD=Q("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cy=Q("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OD=Q("Laptop",[["path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16",key:"tarvll"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ic=Q("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kw=Q("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=Q("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BD=Q("LineChart",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $D=Q("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zD=Q("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UD=Q("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ja=Q("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=Q("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xw=Q("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rr=Q("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WD=Q("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ky=Q("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VD=Q("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HD=Q("Octagon",[["polygon",{points:"7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2",key:"h1p8hx"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yi=Q("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xu=Q("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qD=Q("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oc=Q("PenTool",[["path",{d:"m12 19 7-7 3 3-7 7-3-3z",key:"rklqx2"}],["path",{d:"m18 13-1.5-7.5L2 2l3.5 14.5L13 18l5-5z",key:"1et58u"}],["path",{d:"m2 2 7.586 7.586",key:"etlp93"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yw=Q("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const km=Q("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sm=Q("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qw=Q("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=Q("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gu=Q("Presentation",[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GD=Q("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bc=Q("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KD=Q("Redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=Q("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=Q("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=Q("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hh=Q("Scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=Q("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Em=Q("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XD=Q("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YD=Q("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=Q("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QD=Q("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JD=Q("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=Q("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dm=Q("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sy=Q("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZD=Q("StarOff",[["path",{d:"M8.34 8.34 2 9.27l5 4.87L5.82 21 12 17.77 18.18 21l-.59-3.43",key:"16m0ql"}],["path",{d:"M18.42 12.76 22 9.27l-6.91-1L12 2l-1.44 2.91",key:"1vt8nq"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=Q("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rm=Q("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eR=Q("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22h0a3.13 3.13 0 0 1-3-3.88Z",key:"s6e0r"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ey=Q("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dy=Q("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const or=Q("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ya=Q("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=Q("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tR=Q("Triangle",[["path",{d:"M13.73 4a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"14u9p9"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nR=Q("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rR=Q("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jw=Q("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=Q("Umbrella",[["path",{d:"M22 12a10.06 10.06 1 0 0-20 0Z",key:"1teyop"}],["path",{d:"M12 12v8a2 2 0 0 0 4 0",key:"ulpmoc"}],["path",{d:"M12 2v1",key:"11qlp1"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ry=Q("Underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aR=Q("Undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qp=Q("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zw=Q("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _m=Q("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qn=Q("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=Q("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $c=Q("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _y=Q("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sR=Q("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vu=Q("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=Q("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eN=Q("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),iR=()=>{const e=[{icon:ca,title:"Gnrateur d'ides",description:"Trouvez l'ide de startup parfaite grce  notre gnrateur intelligent bas sur vos intrts et le march tunisien."},{icon:Kw,title:"Business Model Canvas",description:"Crez votre modle conomique avec des templates prts  l'emploi et personnalisables."},{icon:xu,title:"Branding Complet",description:"Gnrez le nom, le slogan et l'identit visuelle de votre startup en quelques clics."},{icon:Ge,title:"Business Plan PDF",description:"Crez un business plan professionnel et exportez-le en PDF pour vos investisseurs."},{icon:gu,title:"Pitch Deck",description:"Construisez un pitch deck impactant avec nos templates optimiss pour les leves de fonds."},{icon:st,title:"Gestion de Projet",description:"Grez vos tches et votre quipe avec un tableau Kanban intgr."}],t=[{name:"Ahmed Ben Ali",role:"Fondateur, TechStartup",content:"StartUpLab m'a permis de structurer mon ide et de crer un business plan en quelques heures seulement.",rating:5},{name:"Sarah Trabelsi",role:"CEO, EcoSolutions",content:"Un outil indispensable pour tout entrepreneur tunisien. Le gnrateur d'ides est incroyable !",rating:5},{name:"Mohamed Karim",role:"Co-fondateur, FinApp",content:"Grce au pitch deck gnr, j'ai pu lever 100K TND auprs d'investisseurs locaux.",rating:5}];return a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsx("nav",{className:"fixed top-0 w-full bg-white/80 backdrop-blur-md z-50 border-b border-gray-100",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex justify-between items-center h-16",children:[a.jsxs(ve,{to:"/",className:"flex items-center gap-2",children:[a.jsx(qr,{className:"w-8 h-8 text-primary-600"}),a.jsx("span",{className:"text-xl font-bold gradient-text",children:"StartUpLab"})]}),a.jsxs("div",{className:"hidden md:flex items-center gap-8",children:[a.jsx("a",{href:"#features",className:"text-gray-600 hover:text-gray-900",children:"Fonctionnalits"}),a.jsx("a",{href:"#testimonials",className:"text-gray-600 hover:text-gray-900",children:"Tmoignages"}),a.jsx(ve,{to:"/pricing",className:"text-gray-600 hover:text-gray-900",children:"Tarifs"})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(ve,{to:"/login",className:"text-gray-700 hover:text-gray-900 font-medium",children:"Connexion"}),a.jsx(ve,{to:"/register",className:"btn-primary",children:"Commencer gratuitement"})]})]})})}),a.jsx("section",{className:"pt-32 pb-20 px-4",children:a.jsxs("div",{className:"max-w-7xl mx-auto text-center",children:[a.jsxs("div",{className:"inline-flex items-center gap-2 bg-primary-50 text-primary-700 px-4 py-2 rounded-full text-sm font-medium mb-6",children:[a.jsx(Or,{className:"w-4 h-4"}),"La plateforme #1 pour les startups en Tunisie"]}),a.jsxs("h1",{className:"text-4xl md:text-6xl font-bold text-gray-900 mb-6 leading-tight",children:["Crez votre ",a.jsx("span",{className:"gradient-text",children:"startup"}),a.jsx("br",{}),"de l'ide au lancement"]}),a.jsx("p",{className:"text-xl text-gray-600 mb-10 max-w-2xl mx-auto",children:"Tous les outils dont vous avez besoin pour transformer votre ide en une startup russie. Gnrateur d'ides, business model, branding, business plan et plus encore."}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[a.jsxs(ve,{to:"/register",className:"btn-primary text-lg px-8 py-3 flex items-center justify-center gap-2",children:["Dmarrer gratuitement",a.jsx(xa,{className:"w-5 h-5"})]}),a.jsx("a",{href:"#features",className:"btn-secondary text-lg px-8 py-3",children:"Dcouvrir les fonctionnalits"})]}),a.jsxs("div",{className:"mt-12 flex items-center justify-center gap-8 text-sm text-gray-500",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(tt,{className:"w-5 h-5 text-green-500"}),a.jsx("span",{children:"Gratuit pour commencer"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(tt,{className:"w-5 h-5 text-green-500"}),a.jsx("span",{children:"Pas de carte bancaire"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(tt,{className:"w-5 h-5 text-green-500"}),a.jsx("span",{children:"Support en franais"})]})]})]})}),a.jsx("section",{id:"features",className:"py-20 bg-gray-50",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[a.jsxs("div",{className:"text-center mb-16",children:[a.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"Tout ce qu'il faut pour lancer votre startup"}),a.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Des outils puissants et intuitifs pour chaque tape de la cration de votre entreprise."})]}),a.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:e.map((n,r)=>a.jsxs("div",{className:"card-hover",children:[a.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-lg flex items-center justify-center mb-4",children:a.jsx(n.icon,{className:"w-6 h-6 text-primary-600"})}),a.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:n.title}),a.jsx("p",{className:"text-gray-600",children:n.description})]},r))})]})}),a.jsx("section",{id:"testimonials",className:"py-20",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[a.jsxs("div",{className:"text-center mb-16",children:[a.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"Ils ont lanc leur startup avec nous"}),a.jsx("p",{className:"text-lg text-gray-600",children:"Dcouvrez les tmoignages de nos utilisateurs satisfaits."})]}),a.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:t.map((n,r)=>a.jsxs("div",{className:"card",children:[a.jsx("div",{className:"flex gap-1 mb-4",children:[...Array(n.rating)].map((s,i)=>a.jsx(Or,{className:"w-5 h-5 text-yellow-400 fill-yellow-400"},i))}),a.jsxs("p",{className:"text-gray-700 mb-6",children:['"',n.content,'"']}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-primary-100 flex items-center justify-center",children:a.jsx("span",{className:"text-primary-700 font-semibold",children:n.name.split(" ").map(s=>s[0]).join("")})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:n.name}),a.jsx("p",{className:"text-sm text-gray-500",children:n.role})]})]})]},r))})]})}),a.jsx("section",{className:"py-20 gradient-bg",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4 text-center",children:[a.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-white mb-6",children:"Prt  lancer votre startup ?"}),a.jsx("p",{className:"text-xl text-white/90 mb-10",children:"Rejoignez des centaines d'entrepreneurs tunisiens qui utilisent StartUpLab pour concrtiser leurs ides."}),a.jsxs(ve,{to:"/register",className:"inline-flex items-center gap-2 bg-white text-primary-600 font-semibold px-8 py-4 rounded-lg hover:bg-gray-100 transition-colors",children:["Crer mon compte gratuitement",a.jsx(xa,{className:"w-5 h-5"})]})]})}),a.jsx("footer",{className:"bg-gray-900 text-gray-400 py-12",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[a.jsxs("div",{className:"grid md:grid-cols-4 gap-8",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(qr,{className:"w-8 h-8 text-primary-400"}),a.jsx("span",{className:"text-xl font-bold text-white",children:"StartUpLab"})]}),a.jsx("p",{className:"text-sm",children:"La plateforme tout-en-un pour crer votre startup en Tunisie."})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-white mb-4",children:"Produit"}),a.jsxs("ul",{className:"space-y-2 text-sm",children:[a.jsx("li",{children:a.jsx("a",{href:"#features",className:"hover:text-white",children:"Fonctionnalits"})}),a.jsx("li",{children:a.jsx(ve,{to:"/pricing",className:"hover:text-white",children:"Tarifs"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-white mb-4",children:"Support"}),a.jsxs("ul",{className:"space-y-2 text-sm",children:[a.jsx("li",{children:a.jsx("a",{href:"#",className:"hover:text-white",children:"Centre d'aide"})}),a.jsx("li",{children:a.jsx("a",{href:"#",className:"hover:text-white",children:"Contact"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-white mb-4",children:"Lgal"}),a.jsxs("ul",{className:"space-y-2 text-sm",children:[a.jsx("li",{children:a.jsx("a",{href:"#",className:"hover:text-white",children:"Conditions d'utilisation"})}),a.jsx("li",{children:a.jsx("a",{href:"#",className:"hover:text-white",children:"Politique de confidentialit"})})]})]})]}),a.jsx("div",{className:"border-t border-gray-800 mt-12 pt-8 text-sm text-center",children:a.jsxs("p",{children:[" ",new Date().getFullYear()," StartUpLab. Tous droits rservs."]})})]})})]})};function oR(e={}){const{nonce:t,locale:n,onScriptLoadSuccess:r,onScriptLoadError:s}=e,[i,o]=S.useState(!1),l=S.useRef(r);l.current=r;const c=S.useRef(s);return c.current=s,S.useEffect(()=>{const u=document.createElement("script");return u.src="https://accounts.google.com/gsi/client",n&&(u.src+=`?hl=${n}`),u.async=!0,u.defer=!0,u.nonce=t,u.onload=()=>{var d;o(!0),(d=l.current)===null||d===void 0||d.call(l)},u.onerror=()=>{var d;o(!1),(d=c.current)===null||d===void 0||d.call(c)},document.body.appendChild(u),()=>{document.body.removeChild(u)}},[t]),i}const lR=S.createContext(null);function tN({clientId:e,nonce:t,locale:n,onScriptLoadSuccess:r,onScriptLoadError:s,children:i}){const o=oR({nonce:t,onScriptLoadSuccess:r,onScriptLoadError:s,locale:n}),l=S.useMemo(()=>({locale:n,clientId:e,scriptLoadedSuccessfully:o}),[e,o]);return Vu.createElement(lR.Provider,{value:l},i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var nN=function(e,t){return(nN=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])})(e,t)};function kr(e,t){function n(){this.constructor=e}nN(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function we(e,t,n,r){return new(n||(n=Promise))(function(s,i){function o(u){try{c(r.next(u))}catch(d){i(d)}}function l(u){try{c(r.throw(u))}catch(d){i(d)}}function c(u){u.done?s(u.value):new n(function(d){d(u.value)}).then(o,l)}c((r=r.apply(e,[])).next())})}function Ne(e,t){var n,r,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(c){return function(u){return function(d){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(s=2&d[0]?r.return:d[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,d[1])).done)return s;switch(r=0,s&&(d=[2&d[0],s.value]),d[0]){case 0:case 1:s=d;break;case 4:return o.label++,{value:d[1],done:!1};case 5:o.label++,r=d[1],d=[0];continue;case 7:d=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(d[0]===6||d[0]===2)){o=0;continue}if(d[0]===3&&(!s||d[1]>s[0]&&d[1]<s[3])){o.label=d[1];break}if(d[0]===6&&o.label<s[1]){o.label=s[1],s=d;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(d);break}s[2]&&o.ops.pop(),o.trys.pop();continue}d=t.call(e,o)}catch(h){d=[6,h],r=0}finally{n=s=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}([c,u])}}}var cR=function(){function e(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(t,n){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+n+"."),this.platformName=t,this.platform=n},e.prototype.registerFlag=function(t,n,r){if(this.flagRegistry[t]={evaluationFn:n,setHook:r},this.urlFlags[t]!=null){var s=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+s+"."),this.set(t,s)}},e.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},e.prototype.getNumber=function(t){return this.get(t)},e.prototype.getBool=function(t){return this.get(t)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(t,n){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)},e.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},e.prototype.setFlags=function(t){this.flags=Object.assign({},t)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var n,r,s=(n=this.global.location.search,r={},n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(i){for(var o=[],l=1;l<arguments.length;l++)o[l-1]=arguments[l];return uR(r,o[0],o[1]),o.join("=")}),r);"tfjsflags"in s&&s.tfjsflags.split(",").forEach(function(i){var o=i.split(":"),l=o[0],c=o[1];t.urlFlags[l]=function(u,d){if((d=d.toLowerCase())==="true"||d==="false")return d==="true";if(""+ +d===d)return+d;throw new Error("Could not parse value flag value "+d+" for flag "+u+".")}(l,c)})}},e}();function uR(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function ee(){return rN}var rN=null,yu=new Map,Gp=new Map;function aN(e,t){var n=iN(e,t);return yu.get(n)}function dR(e){return Gp.get(e)}function Ty(e){for(var t=yu.entries(),n=[];;){var r=t.next(),s=r.done,i=r.value;if(s)break;var o=i[0],l=i[1];o.split("_")[0]===e&&n.push(l)}return n}function sN(e){var t=e.kernelName,n=e.backendName,r=iN(t,n);if(yu.has(r))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");yu.set(r,e)}function hR(e){var t=e.kernelName;Gp.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),Gp.set(t,e)}function iN(e,t){return t+"_"+e}function Kp(e,t,n){return Math.max(e,Math.min(t,n))}function oN(e){return e%2==0?e:e+1}function pR(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function M(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function Ze(e,t,n){n===void 0&&(n=""),M(Xt(e,t),function(){return n+" Shapes "+e+" and "+t+" must match"})}function oo(e){M(e!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function Qi(e,t,n){if(t===void 0&&(t=[]),n===void 0&&(n=!1),t==null&&(t=[]),Array.isArray(e)||Ur(e)&&!n)for(var r=0;r<e.length;++r)Qi(e[r],t,n);else t.push(e);return t}function je(e){if(e.length===0)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function Xt(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Dt(e){return e%1==0}function fR(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function Xp(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function _i(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function Ay(e,t,n){return t===void 0&&(t=function(r){return 0}),new Promise(function(r,s){var i=0,o=function(){if(e())r();else{i++;var l=t(i);n!=null&&i>=n?s():setTimeout(o,l)}};o()})}function mR(e,t){for(var n=1,r=-1,s=0;s<e.length;++s)if(e[s]>=0)n*=e[s];else if(e[s]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+s);r=s}else if(e[s]<0)throw Error("Shapes can not be < 0. Found "+e[s]+" at dim "+s);if(r===-1){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(n===0)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var i=e.slice();return i[r]=t/n,i}function Ut(e,t){var n=t.length;return M((e=e==null?t.map(function(r,s){return s}):[].concat(e)).every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e}),M(e.every(function(r){return Dt(r)}),function(){return"All values in axis param must be integers but got axis "+e}),e.map(function(r){return r<0?n+r:r})}function ks(e,t){for(var n=[],r=[],s=t!=null&&Array.isArray(t)&&t.length===0,i=t==null||s?null:Ut(t,e).sort(),o=0,l=0;l<e.length;++l){if(i!=null){if(i[o]===l&&e[l]!==1)throw new Error("Can't squeeze axis "+l+" since its dim '"+e[l]+"' is not 1");(i[o]==null||i[o]>l)&&e[l]===1&&(n.push(e[l]),r.push(l)),i[o]<=l&&o++}e[l]!==1&&(n.push(e[l]),r.push(l))}return{newShape:n,keptDims:r}}function ul(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else{if(e!=="bool")throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function bu(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else{if(e!=="string")throw new Error("Unknown data type "+e);n=new Array(t)}return n}function xR(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function gR(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function vR(e,t){return t!=="complex64"&&(t!=="float32"||e==="complex64")&&(t!=="int32"||e==="float32"||e==="complex64")&&(t!=="bool"||e!=="bool")}function Ur(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function lN(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype "+e)}function yR(e){if(e==null)return 0;var t=0;return e.forEach(function(n){return t+=n.length}),t}function Tm(e){return typeof e=="string"||e instanceof String}function bR(e){return typeof e=="boolean"}function wR(e){return typeof e=="number"}function Dl(e){return Array.isArray(e)?Dl(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":wR(e)?"float32":Tm(e)?"string":bR(e)?"bool":"float32"}function Yp(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Qp(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function Wr(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function cN(e,t,n){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Qi(e)),n&&xR(e,t),function(i,o){return i instanceof Float32Array&&o==="float32"||i instanceof Int32Array&&o==="int32"||i instanceof Uint8Array&&o==="bool"}(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){for(var r=new Uint8Array(e.length),s=0;s<r.length;++s)Math.round(e[s])!==0&&(r[s]=1);return r}throw new Error("Unknown data type "+t)}function Iy(e,t){if(e.length===0)return t[0];var n=e.reduce(function(r,s){return r*s});if(n===0)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function r(s,i,o){var l=new Array;if(i.length===1)for(var c=i[0],u=0;u<c;u++)l[u]=o[s+u];else{c=i[0];var d=i.slice(1),h=d.reduce(function(p,f){return p*f});for(u=0;u<c;u++)l[u]=r(s+u*h,d,o)}return l}(0,e,t)}function uN(e,t){for(var n=Rl(e,t),r=0;r<n.length;r++)n[r]=1;return n}function Rl(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type "+t)}function Ir(){return ee().platform.now()}function dN(e){e.forEach(function(t){M(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."})})}function NR(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",ee().platform.encode(e,t)}function wu(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",ee().platform.decode(e,t)}function Py(e,t,n){if(t===0)return 0;if(t===1)return e[0];for(var r=e[e.length-1],s=0;s<e.length-1;++s)r+=n[s]*e[s];return r}function jR(e,t,n){if(t===0)return[];if(t===1)return[e];for(var r=new Array(t),s=0;s<r.length-1;++s)r[s]=Math.floor(e/n[s]),e-=r[s]*n[s];return r[r.length-1]=e,r}var CR=function(){function e(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new kR)}return e.prototype.profileKernel=function(t,n,r){var s,i=this,o=this.backendTimer.time(function(){s=r()});return s.forEach(function(l){l.data().then(function(c){(function(u,d,h){if(d!=="float32")return!1;for(var p=0;p<u.length;p++){var f=u[p];if(isNaN(f)||!isFinite(f))return console.warn("Found "+f+" in the result of '"+h+"'"),!0}})(c,l.dtype,t),o.then(function(u){var d="";u.getExtraProfileInfo!=null&&(d=u.getExtraProfileInfo()),i.logger.logKernelProfile(t,l,c,u.kernelMs,n,d)})})}),s},e}(),kR=function(){function e(){}return e.prototype.logKernelProfile=function(t,n,r,s,i,o){var l=typeof s=="number"?_i(s+"ms",9):s.error,c=_i(t,25),u=n.rank,d=n.size,h=_i(n.shape.toString(),14),p="";for(var f in i){var x=i[f].shape||n.shape,v=x.length;p+=f+": "+v+"D "+(v>0?x:"")+" "}console.log("%c"+c+"	%c"+l+"	%c"+u+"D "+h+"	%c"+d+"	%c"+p+"	%c"+o,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}(),Fy=20,No=3,ph=7;function SR(e,t,n,r){var s=Wr(t),i=function(u,d,h,p){var f=je(d),x=p[p.length-1],v=new Array(x).fill(0),y=d.length,m=h==="complex64"?Co(u):u;if(y>1)for(var g=0;g<f/x;g++)for(var b=g*x,w=0;w<x;w++)v[w]=Math.max(v[w],jo(m[b+w],0,h).length);return v}(e,t,n,s),o=t.length,l=function u(d,h,p,f,x,v){v===void 0&&(v=!0);var y=p==="complex64"?2:1,m=h[0],g=h.length;if(g===0)return p==="complex64"?[jo(Co(d)[0],0,p)]:p==="bool"?[hN(d[0])]:[d[0].toString()];if(g===1){if(m>Fy){var b=No*y,w=Array.from(d.slice(0,b)),N=Array.from(d.slice((m-No)*y,m*y));return p==="complex64"&&(w=Co(w),N=Co(N)),["["+w.map(function(L,U){return jo(L,x[U],p)}).join(", ")+", ..., "+N.map(function(L,U){return jo(L,x[m-No+U],p)}).join(", ")+"]"]}return["["+(p==="complex64"?Co(d):Array.from(d)).map(function(L,U){return jo(L,x[U],p)}).join(", ")+"]"]}var C=h.slice(1),D=f.slice(1),j=f[0]*y,k=[];if(m>Fy){for(var R=0;R<No;R++){var E=(P=R*j)+j;k.push.apply(k,u(d.slice(P,E),C,p,D,x,!1))}for(k.push("..."),R=m-No;R<m;R++)E=(P=R*j)+j,k.push.apply(k,u(d.slice(P,E),C,p,D,x,R===m-1))}else for(R=0;R<m;R++){var P;E=(P=R*j)+j,k.push.apply(k,u(d.slice(P,E),C,p,D,x,R===m-1))}var F=g===2?",":"";for(k[0]="["+k[0]+F,R=1;R<k.length-1;R++)k[R]=" "+k[R]+F;var W=`,
`;for(R=2;R<g;R++)W+=`
`;return k[k.length-1]=" "+k[k.length-1]+"]"+(v?"":W),k}(e,t,n,s,i),c=["Tensor"];return r&&(c.push("  dtype: "+n),c.push("  rank: "+o),c.push("  shape: ["+t+"]"),c.push("  values:")),c.push(l.map(function(u){return"    "+u}).join(`
`)),c.join(`
`)}function jo(e,t,n){return _i(Array.isArray(e)?parseFloat(e[0].toFixed(ph))+" + "+parseFloat(e[1].toFixed(ph))+"j":Tm(e)?"'"+e+"'":n==="bool"?hN(e):parseFloat(e.toFixed(ph)).toString(),t)}function hN(e){return e===0?"false":"true"}function Co(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var dl=function(){function e(t,n,r){var s=this;if(this.dtype=n,this.shape=t.slice(),this.size=je(t),r!=null){var i=r.length;M(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+s.size+"'."})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||bu(n,this.size),this.strides=Wr(t)}return e.prototype.set=function(t){for(var n=this,r=[],s=1;s<arguments.length;s++)r[s-1]=arguments[s];r.length===0&&(r=[0]),M(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+n.rank+")"});var i=this.locToIndex(r);this.values[i]=t},e.prototype.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.length===0&&(t=[0]);for(var r=0,s=0,i=t;s<i.length;s++){var o=i[s];if(o<0||o>=this.shape[r]){var l="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(l)}r++}for(var c=t[t.length-1],u=0;u<t.length-1;++u)c+=this.strides[u]*t[u];return this.values[c]},e.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var n=t[t.length-1],r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n},e.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return Fr().makeTensor(this.values,this.shape,this.dtype)},e}(),Fr=null,Y=null,pN=null,xt=function(){function e(t,n,r,s){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=je(t),this.strides=Wr(t),this.dataId=r,this.id=s,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),M(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,n){return this.throwIfDisposed(),this.reshape([t,n])},e.prototype.as3D=function(t,n,r){return this.throwIfDisposed(),this.reshape([t,n,r])},e.prototype.as4D=function(t,n,r,s){return this.throwIfDisposed(),this.reshape([t,n,r,s])},e.prototype.as5D=function(t,n,r,s,i){return this.throwIfDisposed(),this.reshape([t,n,r,s,i])},e.prototype.asType=function(t){return this.throwIfDisposed(),Y.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return we(this,void 0,void 0,function(){var t;return Ne(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,Y.buffer(this.shape,this.dtype,t)]}})})},e.prototype.bufferSync=function(){return Y.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return we(this,void 0,void 0,function(){var t;return Ne(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,Iy(this.shape,t)]}})})},e.prototype.arraySync=function(){return Iy(this.shape,this.dataSync())},e.prototype.data=function(){return we(this,void 0,void 0,function(){var t,n;return Ne(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=Fr().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:n=r.sent();try{return[2,n.map(function(s){return wu(s)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var t=Fr().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(n){return wu(n)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},e.prototype.bytes=function(){return we(this,void 0,void 0,function(){var t;return Ne(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,Fr().read(this.dataId)];case 1:return t=n.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(Fr().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return t===void 0&&(t=!1),Y.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),Y.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return t===void 0&&(t=0),Y.expandDims(this,t)},e.prototype.cumsum=function(t,n,r){return t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1),Y.cumsum(this,t,n,r)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),Y.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),Y.clone(this)},e.prototype.oneHot=function(t,n,r){return this.throwIfDisposed(),Y.oneHot(this,t,n,r)},e.prototype.toString=function(t){return t===void 0&&(t=!1),SR(this.dataSync(),this.shape,this.dtype,t)},e.prototype.tile=function(t){return this.throwIfDisposed(),Y.tile(this,t)},e.prototype.gather=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),Y.gather(this,t,n)},e.prototype.matMul=function(t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),Y.matMul(this,t,n,r)},e.prototype.dot=function(t){return this.throwIfDisposed(),Y.dot(this,t)},e.prototype.norm=function(t,n,r){return t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),Y.norm(this,t,n,r)},e.prototype.slice=function(t,n){return this.throwIfDisposed(),Y.slice(this,t,n)},e.prototype.reverse=function(t){return this.throwIfDisposed(),Y.reverse(this,t)},e.prototype.concat=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),Y.concat([this].concat(t),n)},e.prototype.split=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),Y.split(this,t,n)},e.prototype.stack=function(t,n){return n===void 0&&(n=0),Y.stack([this,t],n)},e.prototype.unstack=function(t){return t===void 0&&(t=0),Y.unstack(this,t)},e.prototype.pad=function(t,n){return n===void 0&&(n=0),Y.pad(this,t,n)},e.prototype.batchNormalization=function(t,n,r,s,i){return r===void 0&&(r=.001),pN("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,n,i,s,r)},e.prototype.batchNorm=function(t,n,r,s,i){return i===void 0&&(i=.001),this.throwIfDisposed(),Y.batchNorm(this,t,n,r,s,i)},e.prototype.all=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Y.all(this,t,n)},e.prototype.any=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Y.any(this,t,n)},e.prototype.logSumExp=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Y.logSumExp(this,t,n)},e.prototype.sum=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Y.sum(this,t,n)},e.prototype.prod=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Y.prod(this,t,n)},e.prototype.mean=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Y.mean(this,t,n)},e.prototype.min=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Y.min(this,t,n)},e.prototype.max=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Y.max(this,t,n)},e.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),Y.argMin(this,t)},e.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),Y.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),Y.cast(this,t)},e.prototype.add=function(t){return this.throwIfDisposed(),Y.add(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),Y.addStrict(this,t)},e.prototype.atan2=function(t){return this.throwIfDisposed(),Y.atan2(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),Y.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),Y.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),Y.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),Y.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),Y.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),Y.mulStrict(this,t)},e.prototype.div=function(t){return this.throwIfDisposed(),Y.div(this,t)},e.prototype.divNoNan=function(t){return this.throwIfDisposed(),Y.divNoNan(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),Y.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),Y.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),Y.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),Y.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),Y.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),Y.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),Y.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),Y.modStrict(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),Y.squaredDifferenceStrict(this,t)},e.prototype.transpose=function(t){return this.throwIfDisposed(),Y.transpose(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),Y.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),Y.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),Y.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),Y.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),Y.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),Y.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),Y.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),Y.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),Y.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),Y.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),Y.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),Y.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),Y.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),Y.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),Y.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),Y.logicalXor(this,t)},e.prototype.where=function(t,n){return this.throwIfDisposed(),Y.where(t,this,n)},e.prototype.neg=function(){return this.throwIfDisposed(),Y.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),Y.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),Y.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),Y.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),Y.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),Y.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),Y.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),Y.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),Y.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),Y.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),Y.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),Y.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),Y.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),Y.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),Y.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),Y.abs(this)},e.prototype.clipByValue=function(t,n){return this.throwIfDisposed(),Y.clipByValue(this,t,n)},e.prototype.relu=function(){return this.throwIfDisposed(),Y.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),Y.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),Y.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),Y.selu(this)},e.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),Y.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),Y.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),Y.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),Y.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),Y.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),Y.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),Y.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),Y.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),Y.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),Y.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),Y.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),Y.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),Y.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),Y.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),Y.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),Y.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),Y.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),Y.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),Y.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),Y.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),Y.round(this)},e.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),Y.step(this,t)},e.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),Y.softmax(this,t)},e.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),Y.logSoftmax(this,t)},e.prototype.resizeBilinear=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),Y.image.resizeBilinear(this,t,n)},e.prototype.resizeNearestNeighbor=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),Y.image.resizeNearestNeighbor(this,t,n)},e.prototype.conv1d=function(t,n,r,s,i,o){return s===void 0&&(s="NWC"),i===void 0&&(i=1),this.throwIfDisposed(),Y.conv1d(this,t,n,r,s,i,o)},e.prototype.conv2d=function(t,n,r,s,i,o){return s===void 0&&(s="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),Y.conv2d(this,t,n,r,s,i,o)},e.prototype.conv2dTranspose=function(t,n,r,s,i){return this.throwIfDisposed(),Y.conv2dTranspose(this,t,n,r,s,i)},e.prototype.depthwiseConv2D=function(t,n,r,s,i,o){return s===void 0&&(s="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),Y.depthwiseConv2d(this,t,n,r,s,i,o)},e.prototype.separableConv2d=function(t,n,r,s,i,o){return i===void 0&&(i=[1,1]),o===void 0&&(o="NHWC"),this.throwIfDisposed(),Y.separableConv2d(this,t,n,r,s,i,o)},e.prototype.avgPool=function(t,n,r,s){return this.throwIfDisposed(),Y.avgPool(this,t,n,r,s)},e.prototype.maxPool=function(t,n,r,s){return this.throwIfDisposed(),Y.maxPool(this,t,n,r,s)},e.prototype.localResponseNormalization=function(t,n,r,s){return t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),s===void 0&&(s=.5),Y.localResponseNormalization(this,t,n,r,s)},e.prototype.pool=function(t,n,r,s,i){return this.throwIfDisposed(),Y.pool(this,t,n,r,s,i)},e.prototype.variable=function(t,n,r){return t===void 0&&(t=!0),this.throwIfDisposed(),Fr().makeVariable(this,t,n,r)},e.prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),Y.unsortedSegmentSum(this,t,n)},e.prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),Y.batchToSpaceND(this,t,n)},e.prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),Y.spaceToBatchND(this,t,n)},e.prototype.topk=function(t,n){return t===void 0&&(t=1),n===void 0&&(n=!0),this.throwIfDisposed(),Y.topk(this,t,n)},e.prototype.stridedSlice=function(t,n,r,s,i,o,l,c){return s===void 0&&(s=0),i===void 0&&(i=0),o===void 0&&(o=0),l===void 0&&(l=0),c===void 0&&(c=0),this.throwIfDisposed(),Y.stridedSlice(this,t,n,r,s,i,o,l,c)},e.prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),Y.depthToSpace(this,t,n)},e.prototype.fft=function(){return this.throwIfDisposed(),Y.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),Y.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),Y.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),Y.spectral.irfft(this)},e}();Object.defineProperty(xt,Symbol.hasInstance,{value:function(e){return!!e&&e.dataId!=null&&e.shape!=null&&e.dtype!=null}});var My,Jp,Zp,ef,tf,Ji=function(e){function t(n,r,s,i){var o=e.call(this,n.shape,n.dtype,n.dataId,i)||this;return o.trainable=r,o.name=s,o}return kr(t,e),t.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and previous value ("+this.dtype+") must match");if(!Xt(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and previous value ("+this.shape+") must match");Fr().disposeTensor(this),this.dataId=n.dataId,Fr().incRef(this,null)},t.prototype.dispose=function(){Fr().disposeVariable(this),this.isDisposedInternal=!0},t}(xt);Object.defineProperty(Ji,Symbol.hasInstance,{value:function(e){return e instanceof xt&&e.assign!=null&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(My||(My={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(Jp||(Jp={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(Zp||(Zp={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(ef||(ef={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(tf||(tf={}));var ER={float32:ef,int32:Jp,bool:Zp,complex64:tf};function Zt(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error("Can not upcast "+e+" with "+t)}return ER[e][t]}function fh(e){return Zt(e,"int32")}function bt(e,t){if(e.dtype===t.dtype)return[e,t];var n=Zt(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function DR(e,t){M(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"})}function fN(e){var t=[];return function n(r,s,i){if(r!=null){if(r instanceof xt)return void s.push(r);if(o=r,!(!Array.isArray(o)&&typeof o!="object")){var o,l=r;for(var c in l){var u=l[c];i.has(u)||(i.add(u),n(u,s,i))}}}}(e,t,new Set),t}var mh,Ly=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},e}(),RR=function(){function e(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Ly}return e.prototype.ready=function(){return we(this,void 0,void 0,function(){var t,n,r;return Ne(this,function(s){switch(s.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),n=0,s.label=1;case 1:return n<t.length?(r=t[n],[4,this.initializeBackend(r).success]):[3,5];case 2:return s.sent()?[4,this.setBackend(r)]:[3,4];case 3:return s.sent(),[2];case 4:return n++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(e.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),n=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+n+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(n)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},e.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},e.prototype.registerBackend=function(t,n,r){return r===void 0&&(r=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:n,priority:r},!0)},e.prototype.setBackend=function(t){return we(this,void 0,void 0,function(){var n,r,s;return Ne(this,function(i){switch(i.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,n.asyncInit?[4,r]:[3,2]);case 1:return s=i.sent(),[3,3];case 2:s=r,i.label=3;case 3:if(!s)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new CR(this.backendInstance),[2,!0]}})})},e.prototype.setupRegisteredKernels=function(){var t=this;Ty(this.backendName).forEach(function(n){n.setupFunc!=null&&n.setupFunc(t.backendInstance)})},e.prototype.disposeRegisteredKernels=function(t){var n=this;Ty(t).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(n.registry[t])})},e.prototype.initializeBackend=function(t){var n=this,r=this.registryFactory[t];if(r==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var s=r.factory();if(Promise.resolve(s)===s){var i=++this.pendingBackendInitId,o=s.then(function(l){return!(i<n.pendingBackendInitId)&&(n.registry[t]=l,n.pendingBackendInit=null,!0)}).catch(function(l){return!(i<n.pendingBackendInitId)&&(n.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(l.stack||l.message),!1)});return this.pendingBackendInit=o,{success:o,asyncInit:!0}}return this.registry[t]=s,{success:!0,asyncInit:!1}}catch(l){return console.warn("Initialization of backend "+t+" failed"),console.warn(l.stack||l.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(n,r){return t.registryFactory[r].priority-t.registryFactory[n].priority})},e.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),n=0;n<t.length;n++){var r=t[n],s=this.initializeBackend(r),i=s.success,o=s.asyncInit;if(o||i)return{name:r,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(t,n){var r=this.state.tensorInfo.get(n),s=r.backend,i=this.readSync(n);s.disposeData(n),r.backend=t,t.move(n,i,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(t,n){var r,s=this,i=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun(function(){return s.startScope(i)},function(){return s.endScope(r)},function(){return(r=n())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},e.prototype.scopedRun=function(t,n,r){t();try{var s=r();return n(),s}catch(i){throw n(),i}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(t){var n=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),r={x:t};return this.addTapeNode(this.state.activeScope.name,r,[n],function(s){return{x:function(){return s.toFloat()}}},[]),n},e.prototype.runKernel=function(t,n,r,s,i){return this.runKernelFunc(null,n,null,t,r,s,i)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(t,n,r){var s=this.backend.numDataIds(),i=0;r.forEach(function(c){i+=c.dtype==="complex64"?3:1});var o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],l=s-n-i-o;if(l>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+l+" data ids) after running '"+t+"'")},e.prototype.runKernelFunc=function(t,n,r,s,i,o,l){var c,u=this;o===void 0&&(o=[]),l===void 0&&(l=[]);var d=[],h=this.isTapeOn();s==null&&(s=this.state.activeScope!=null?this.state.activeScope.name:"");var p,f=function(g){h&&(d=g.map(function(b){return u.keep(u.clone(b))}))},x=this.state.numBytes,v=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var y,m=aN(s,this.backendName);return p=m!=null?function(){var g=u.backend.numDataIds();y=m.kernelFunc({inputs:n,attrs:i,backend:u.backend});var b=Array.isArray(y)?y:[y];u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(s,g,b);var w=b.map(function(C){var D=C.dataId,j=C.shape,k=C.dtype;return u.makeTensorFromDataId(D,j,k)}),N=w.filter(function(C,D){return l[D]});return f((o||[]).slice().concat(N)),w}:function(){var g=u.backend.numDataIds();y=u.tidy(function(){return t(u.backend,f)});var b=Array.isArray(y)?y:[y];return u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(s,g,b),b},this.scopedRun(function(){return u.state.kernelDepth++},function(){return u.state.kernelDepth--},function(){c=u.ENV.getBool("DEBUG")?u.profiler.profileKernel(s,n,function(){return p()}):p()}),h&&this.addTapeNode(s,n,c,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:s,bytesAdded:this.state.numBytes-x,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-v,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(function(g){return n[g].shape}),outputShapes:c.map(function(g){return g.shape})}),Array.isArray(y)?c:c[0]},e.prototype.makeTensor=function(t,n,r,s){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",s=s||this.backend;var i=t;r==="string"&&Tm(t[0])&&(i=t.map(function(d){return NR(d)}));var o=s.write(i,n,r),l=new xt(n,r,o,this.nextTensorId());if(this.incRef(l,s),r==="string"){var c=this.state.tensorInfo.get(o),u=yR(i);this.state.numBytes+=u-c.bytes,c.bytes=u}return l},e.prototype.makeTensorFromDataId=function(t,n,r,s){var i=new xt(n,r=r||"float32",t,this.nextTensorId());return this.incRef(i,s),i},e.prototype.makeVariable=function(t,n,r,s){n===void 0&&(n=!0),r=r||this.nextVariableId().toString(),s!=null&&s!==t.dtype&&(t=t.asType(s));var i=new Ji(t,n,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},e.prototype.incRef=function(t,n){var r=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var s=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(s=t.size*lN(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:s,refCount:0}),this.state.numBytes+=s}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Ji||this.track(t)},e.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var n=this.state.tensorInfo.get(t.dataId);n.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var n=this.state.registeredVariables[t];this.disposeVariable(n)}},e.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},e.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},e.prototype.profile=function(t){return we(this,void 0,void 0,function(){var n,r;return Ne(this,function(s){return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(i){return i.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},e.prototype.addTapeNode=function(t,n,r,s,i){var o=this,l={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:r,saved:i},c=dR(t);c!=null&&(s=c.gradFunc),s!=null&&(l.gradient=function(u){return u=u.map(function(d,h){if(d==null){var p=r[h],f=Rl(p.size,p.dtype);return o.makeTensor(f,p.shape,p.dtype)}return d}),s(u.length>1?u:u[0],i)}),this.state.activeTape.push(l)},e.prototype.keep=function(t){return t.kept=!0,t},e.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(t){var n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n},e.prototype.endScope=function(t){for(var n=this,r=fN(t),s=new Set(r.map(function(c){return c.id})),i=0;i<this.state.activeScope.track.length;i++){var o=this.state.activeScope.track[i];o.kept||s.has(o.id)||o.dispose()}var l=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(c){c.kept||c.scopeId!==l.id||n.track(c)})},e.prototype.gradients=function(t,n,r,s){var i=this;if(s===void 0&&(s=!1),M(n.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var o=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",t)});M(o instanceof xt,function(){return"The result y returned by f() must be a tensor."});var l=function(c,u,d){for(var h={},p={},f=0;f<u.length;f++)h[u[f].id]=!0;for(f=0;f<c.length;f++){var x=(C=c[f]).inputs;for(var v in x){for(var y=x[v],m=!1,g=0;g<u.length;g++)if(h[y.id]){C.outputs.forEach(function(R){return h[R.id]=!0}),m=!0,p[C.id]=!0;break}if(m)break}}var b={};b[d.id]=!0;var w={};for(f=c.length-1;f>=0;f--)for(x=(C=c[f]).inputs,g=0;g<C.outputs.length;g++)if(b[C.outputs[g].id]){for(var v in x)b[x[v].id]=!0,w[C.id]=!0;break}var N=[];for(f=0;f<c.length;f++){var C;if(p[(C=c[f]).id]&&w[C.id]){var D={};for(var v in C.inputs){var j=C.inputs[v];h[j.id]&&(D[v]=j)}var k=Object.assign({},C);k.inputs=D,k.outputs=C.outputs,N.push(k)}}return N}(this.state.activeTape,n,o);if(!s&&l.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var c,u,d={};d[o.id]=r??(c=o.shape,u=uN(je(c),"float32"),V.makeTensor(u,c,"float32")),function(p,f,x){for(var v=function(m){var g=f[m],b=[];if(g.outputs.forEach(function(D){var j=p[D.id];j!=null?b.push(j):b.push(null)}),g.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+g.kernelName+".");var w=g.gradient(b),N=function(D){if(!(D in w))throw new Error("Cannot backprop through input "+D+". Available gradients found: "+Object.keys(w)+".");var j=x(function(){return w[D]()});if(j.dtype!=="float32")throw new Error("Error in gradient for op "+g.kernelName+". The gradient of input "+D+" must have 'float32' dtype, but has '"+j.dtype+"'");var k=g.inputs[D];if(!Xt(j.shape,k.shape))throw new Error("Error in gradient for op "+g.kernelName+". The gradient of input '"+D+"' has shape '"+j.shape+"', which does not match the shape of the input '"+k.shape+"'");if(p[k.id]==null)p[k.id]=j;else{var R=p[k.id];p[k.id]=R.add(j),R.dispose()}};for(var C in g.inputs)N(C)},y=f.length-1;y>=0;y--)v(y)}(d,l,function(p){return i.tidy(p)});var h=n.map(function(p){return d[p.id]});return i.state.gradientDepth===0&&(i.state.activeTape.forEach(function(p){for(var f=0,x=p.saved;f<x.length;f++)x[f].dispose()}),i.state.activeTape=null),{value:o,grads:h}})},e.prototype.customGrad=function(t){var n=this;return M(Yp(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,s=[],i=0;i<arguments.length;i++)s[i]=arguments[i];M(s.every(function(l){return l instanceof xt}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var o={};return s.forEach(function(l,c){o[c]=l}),n.runKernelFunc(function(l,c){return M((r=t.apply(void 0,s.concat([c]))).value instanceof xt,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),M(Yp(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},o,function(l,c){var u=r.gradFunc(l,c),d=Array.isArray(u)?u:[u];M(d.length===s.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),M(d.every(function(p){return p instanceof xt}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var h={};return d.forEach(function(p,f){h[f]=function(){return p}}),h})}},e.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},e.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},e.prototype.time=function(t){return we(this,void 0,void 0,function(){var n,r;return Ne(this,function(s){switch(s.label){case 0:return n=Ir(),[4,this.backend.time(t)];case 1:return(r=s.sent()).wallMs=Ir()-n,[2,r]}})})},e.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Ly,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),V=function(){var e=function(){if(mh==null){var n=void 0;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else{if(typeof self>"u")throw new Error("Could not find a global object");n=self}mh=n}return mh}();if(e._tfengine==null){var t=new cR(e);e._tfengine=new RR(t)}return function(n){rN=n}(e._tfengine.ENV),Fr=function(){return e._tfengine},e._tfengine}();function mN(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var ta=ee();ta.registerFlag("DEBUG",function(){return!1},function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),ta.registerFlag("IS_BROWSER",function(){return mN()}),ta.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),ta.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),ta.registerFlag("PROD",function(){return!1}),ta.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return ta.getBool("DEBUG")}),ta.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),ta.registerFlag("IS_TEST",function(){return!1});var hl,$n,Ln,Ns={},xh={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function _R(e,t){Ns[e]=t}function Kr(e){e in Ns||(Ns[e]=function(n){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(s){if(typeof OffscreenCanvas<"u"&&s===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n);return r.addEventListener("webglcontextlost",function(s){s.preventDefault(),delete Ns[n]},!1),n===1?r.getContext("webgl",xh)||r.getContext("experimental-webgl",xh):r.getContext("webgl2",xh)}(e));var t=Ns[e];return t.isContextLost()?(delete Ns[e],Kr(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Ns[e])}function xd(e,t){return[t,e]}function $o(e){var t=je(e);return Xp(Math.ceil(t/4))}function _l(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function Am(e,t){var n,r,s,i,o,l,c,u,d,h=e;return ee().getNumber("WEBGL_VERSION")===2?(n=h.R32F,r=h.R16F,s=h.RGBA16F,i=h.RGBA32F,o=h.RED,l=4,c=1,u=h.HALF_FLOAT,d=h.FLOAT):(n=e.RGBA,r=e.RGBA,s=e.RGBA,i=h.RGBA,o=e.RGBA,l=4,c=4,u=t!=null?t.HALF_FLOAT_OES:null,d=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:s,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:l,defaultNumChannels:c,textureTypeHalfFloat:u,textureTypeFloat:d}}function ke(e,t,n){var r=n();return t&&function(s){var i=s.getError();if(i!==s.NO_ERROR)throw new Error("WebGL Error: "+PR(s,i))}(e),r}(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(hl||(hl={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}($n||($n={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Ln||(Ln={}));var TR=596e-10,AR=65504;function IR(e){return!!(ee().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||TR<Math.abs(e)&&Math.abs(e)<AR)}function PR(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function oc(e,t,n){return Na(e,t,function(){return e.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function FR(e,t,n){var r=Na(e,t,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(ke(e,t,function(){return e.shaderSource(r,n)}),ke(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function MR(e,t,n){var r=Na(e,t,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(ke(e,t,function(){return e.shaderSource(r,n)}),ke(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw function(s,i){var o=LR.exec(i);if(o==null)return console.log("Couldn't parse line number in error: "+i),void console.log(s);for(var l=+o[1],c=s.split(`
`),u=c.length.toString().length+2,d=c.map(function(y,m){return _i((m+1).toString(),u)+y}),h=0,p=0;p<d.length;p++)h=Math.max(d[p].length,h);var f=d.slice(0,l-1),x=d.slice(l-1,l),v=d.slice(l);console.log(f.join(`
`)),console.log(i.split(`
`)[0]),console.log("%c "+_i(x[0],h),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(v.join(`
`))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var gh,vh,LR=/ERROR: [0-9]+:([0-9]+):/g;function OR(e,t){return Na(e,t,function(){return e.createProgram()},"Unable to create WebGLProgram.")}function BR(e,t,n){if(ke(e,t,function(){return e.linkProgram(n)}),e.getProgramParameter(n,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function yh(e,t,n){if(ke(e,t,function(){return e.validateProgram(n)}),e.getProgramParameter(n,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function $R(e,t,n){var r=Na(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return ke(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),ke(e,t,function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function zR(e,t,n){var r=Na(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return ke(e,t,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)}),ke(e,t,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function UR(e,t){return Na(e,t,function(){return e.createTexture()},"Unable to create WebGLTexture.")}function WR(e,t){var n=ee().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+n+"x"+n+"]")+".")}function VR(e,t){return Na(e,t,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function Oy(e,t,n,r,s,i,o,l){var c=e.getAttribLocation(n,r);return c!==-1&&(ke(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,s)}),ke(e,t,function(){return e.vertexAttribPointer(c,i,e.FLOAT,!1,o,l)}),ke(e,t,function(){return e.enableVertexAttribArray(c)}),!0)}function HR(e,t,n,r){YR(e,r),ke(e,t,function(){return e.activeTexture(e.TEXTURE0+r)}),ke(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)})}function qR(e,t,n,r){return Na(e,t,function(){return e.getUniformLocation(n,r)},'uniform "'+r+'" not present in program.')}function GR(e,t,n){return e.getUniformLocation(t,n)}function KR(e,t,n,r,s,i){ke(e,t,function(){return HR(e,t,r,i)}),ke(e,t,function(){return e.uniform1i(s,i)})}function bh(e,t,n,r){ke(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)}),ke(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)})}function By(e,t,n){ke(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),ke(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})}function lc(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+XR(e,t))}function XR(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function Na(e,t,n,r){var s=ke(e,t,function(){return n()});if(s==null)throw new Error(r);return s}function YR(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+n+"]")+".")}function Nu(e,t){return t===void 0&&(t=2),je(e.slice(0,e.length-t))}function ju(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function wh(e){var t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[Nu(e)].concat(ju(e))),t}function QR(e,t){var n;t===void 0&&(t=!1);var r=ee().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,(e=e.map(function(u,d){return d>=e.length-2?oN(e[d]):e[d]})).length===1&&(e=[2,e[0]])),e.length!==2){var s=ks(e);e=s.newShape}var i=je(e);if(e.length<=1&&i<=r)return[1,i];if(e.length===2&&e[0]<=r&&e[1]<=r)return e;if(e.length===3&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(e.length===3&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(e.length===4&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(e.length===4&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var o=Nu(e),l=2,c=2;return e.length&&(l=(n=ju(e))[0],c=n[1]),Xp(i=o*(l/2)*(c/2)).map(function(u){return 2*u})}return Xp(i)}function cc(e){return e%2==0}function uc(e,t){if(Xt(e=e.slice(-2),t=t.slice(-2))||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r||cc(n)&&cc(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&cc(e[0])&&cc(t[0])}function JR(e){if(gh==null){var t=Kr(e);gh=t.getParameter(t.MAX_TEXTURE_SIZE)}return gh}function ZR(e){if(vh==null){var t=Kr(e);vh=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,vh)}function e_(e){if(e===0)return 0;var t=Kr(e);return tr(t,"EXT_disjoint_timer_query_webgl2")&&e===2?2:tr(t,"EXT_disjoint_timer_query")?1:0}function tr(e,t){return e.getExtension(t)!=null}function $y(e){try{if(Kr(e)!=null)return!0}catch{return!1}return!1}function t_(e){if(e===0)return!1;var t=Kr(e);if(e===1){if(!tr(t,"OES_texture_float"))return!1}else if(!tr(t,"EXT_color_buffer_float"))return!1;return nf(t)}function n_(e){if(e===0)return!1;var t=Kr(e);if(e!==1){if(tr(t,"EXT_color_buffer_float"))return nf(t);if(tr(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(r,s){var i=Am(r,s),o=r.createTexture();r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var l=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,l),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,o,0);var c=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(o),r.deleteFramebuffer(l),c}(t,n)}return!1}return!!tr(t,"OES_texture_float")&&!!tr(t,"WEBGL_color_buffer_float")&&nf(t)}function nf(e){var t=Am(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),s}function r_(e){return e===2&&Kr(e).fenceSync!=null}var Pe=ee();function xN(e){ee().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function me(e,t){return V.tidy(e,t)}function An(e){fN(e).forEach(function(t){return t.dispose()})}function a_(e){return V.keep(e)}function Cu(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];ee().getBool("IS_TEST")||console.warn.apply(console,e)}function ms(e,t){var n=e;if(Ur(e))return t==="string"?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||Ur(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&ee().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function s(i,o,l){if(l=l||[],!Array.isArray(i)&&!Ur(i))return void M(o.length===0,function(){return"Element arr["+l.join("][")+"] is a primitive, but should be an array/TypedArray of "+o[0]+" elements"});M(o.length>0,function(){return"Element arr["+l.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"}),M(i.length===o[0],function(){return"Element arr["+l.join("][")+"] should have "+o[0]+" elements, but has "+i.length+" elements"});for(var c=o.slice(1),u=0;u<i.length;++u)s(i[u],c,l.concat(u))}(e,r,[]),r}function zy(e,t,n,r){if(e!=null&&(e!=="numeric"&&e!==t||e==="numeric"&&t==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function T(e,t,n,r){if(r===void 0&&(r="numeric"),e instanceof xt)return zy(r,e.dtype,t,n),e;var s=Dl(e);if(s!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(s=r),zy(r,s,t,n),e==null||!Ur(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){var i=e==null?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+i+"'")}var o=ms(e,s);Ur(e)||Array.isArray(e)||(e=[e]);var l=s!=="string"?cN(e,s,ee().getBool("DEBUG")):Qi(e,[],!0);return V.makeTensor(l,o,s)}function ku(e,t,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map(function(s,i){return T(s,t+"["+i+"]",n)},r)}function gN(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function s_(e,t,n){for(var r=e.length+t.length,s=[],i=0,o=0,l=0;l<r;l++)n.indexOf(l)===-1?s.push(e[i++]):s.push(t[o++]);return s}function sn(e,t){for(var n=[],r=e.length,s=0;s<r;s++)t.indexOf(s)===-1&&n.push(e[s]);return[n,t.map(function(i){return e[i]})]}function In(e,t){return s_(e,t.map(function(n){return 1}),t)}function Mn(e,t,n){M(gN(t,n),function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."})}function Xr(e,t){if(gN(e,t))return null;for(var n=[],r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(function(s){return n.push(s)}),n}function Im(e){return e.map(function(t,n){return[n,t]}).sort(function(t,n){return t[1]-n[1]}).map(function(t){return t[0]})}function Yr(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function i_(e,t){var n=e[0].length;e.forEach(function(s,i){M(s.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+n+")"})}),M(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=e[0];e.forEach(function(s,i){for(var o=0;o<n;o++)M(o===t||s[o]===r[o],function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+s+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."})})}function Zi(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function z(e){var t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var s=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];V.startScope(n);try{var l=r.apply(void 0,i);return l instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),V.endScope(l),l}catch(c){throw V.endScope(null),c}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}Pe.registerFlag("HAS_WEBGL",function(){return Pe.getNumber("WEBGL_VERSION")>0}),Pe.registerFlag("WEBGL_VERSION",function(){return $y(2)?2:$y(1)?1:0}),Pe.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return Pe.get("WEBGL_VERSION")===2}),Pe.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),Pe.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),Pe.registerFlag("WEBGL_PACK",function(){return Pe.getBool("HAS_WEBGL")}),Pe.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return Pe.getBool("WEBGL_PACK")}),Pe.registerFlag("WEBGL_PACK_CLIP",function(){return Pe.getBool("WEBGL_PACK")}),Pe.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),Pe.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return Pe.getBool("WEBGL_PACK")}),Pe.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return Pe.getBool("WEBGL_PACK")}),Pe.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return Pe.getBool("WEBGL_PACK")}),Pe.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return Pe.getBool("WEBGL_PACK")}),Pe.registerFlag("WEBGL_PACK_REDUCE",function(){return Pe.getBool("WEBGL_PACK")}),Pe.registerFlag("WEBGL_LAZILY_UNPACK",function(){return Pe.getBool("WEBGL_PACK")}),Pe.registerFlag("WEBGL_CONV_IM2COL",function(){return Pe.getBool("WEBGL_PACK")}),Pe.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return JR(Pe.getNumber("WEBGL_VERSION"))}),Pe.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return ZR(Pe.getNumber("WEBGL_VERSION"))}),Pe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var e=Pe.getNumber("WEBGL_VERSION");return e===0?0:e_(e)}),Pe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return Pe.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e}),Pe.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return t_(Pe.getNumber("WEBGL_VERSION"))}),Pe.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!Pe.getBool("WEBGL_FORCE_F16_TEXTURES")&&Pe.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),Pe.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return n_(Pe.getNumber("WEBGL_VERSION"))}),Pe.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return r_(Pe.getNumber("WEBGL_VERSION"))}),Pe.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return Pe.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),pN=xN;var Jt=z({complex_:function(e,t){var n=T(e,"real","complex"),r=T(t,"imag","complex");return Ze(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),V.runKernelFunc(function(s){return s.complex(n,r)},{$real:n,$imag:r})}}),Zn=z({real_:function(e){var t=T(e,"input","real");return V.runKernelFunc(function(n){return n.real(t)},{$input:t})}}),Mr=z({imag_:function(e){var t=T(e,"input","imag");return V.runKernelFunc(function(n){return n.imag(t)},{$input:t})}});function en(e,t,n){return xs(e,t,ms(e,n),n)}function xs(e,t,n,r){if(r==null&&(r=Dl(e)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Ur(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){dN(t);var s=je(t),i=je(n);M(s===i,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+s+" values but has "+i});for(var o=0;o<n.length;++o){var l=n[o],c=o!==n.length-1||l!==je(t.slice(o));M(n[o]===t[o]||!c,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "})}}return Ur(e)||Array.isArray(e)||(e=[e]),t=t||n,e=r!=="string"?cN(e,r,ee().getBool("DEBUG")):Qi(e,[],!0),V.makeTensor(e,t,r)}function fe(e,t){if((Ur(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Ur(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return xs(e,[],[],t)}function Tt(e,t){oo(e);var n=ms(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return xs(e,null,n,t)}function Za(e,t,n){if(oo(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=ms(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return xs(e,t,r,n)}function Pm(e,t,n){if(oo(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=ms(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return xs(e,t,r,n)}function jn(e,t,n){if(oo(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=ms(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return xs(e,t,r,n)}function o_(e,t,n){if(oo(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=ms(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return xs(e,t,r,n)}function l_(e,t,n){if(oo(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=ms(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return xs(e,t=t||r,r,n)}function c_(e,t,n,r){return t===void 0&&(t=!0),V.makeVariable(e,t,n,r)}function lo(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=lo(e,"float32"),r=ct(e,"float32");return Jt(n,r)}var s=uN(je(e),t);return V.makeTensor(s,e,t)}function ct(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=ct(e,"float32"),r=ct(e,"float32");return Jt(n,r)}var s=Rl(je(e),t);return V.makeTensor(s,e,t)}function Vr(e,t,n){return V.runKernelFunc(function(r){return r.fill(e,t,n)},{})}function u_(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return V.runKernelFunc(function(r){return r.linspace(e,t,n)},{})}function Su(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n===0)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return ct([0],r);var s=Rl(Math.abs(Math.ceil((t-e)/n)),r);t<e&&n===1&&(n=-1),s[0]=e;for(var i=1;i<s.length;i++)s[i]=s[i-1]+n;return Tt(s,r)}var vN=z({onesLike_:function(e){var t=T(e,"x","onesLike");if(t.dtype==="complex64"){var n=vN(Zn(t)),r=Ke(Mr(t));return Jt(n,r)}return V.runKernelFunc(function(s){return s.onesLike(t)},{$x:t},function(s,i){return{$x:function(){return Ke(s)}}})}}),Ke=z({zerosLike_:function(e){var t=T(e,"x","zerosLike");return V.runKernelFunc(function(n){return n.zerosLike(t)},{$x:t},function(n,r){return{$x:function(){return Ke(n)}}})}}),Ot=z({concat_:function(e,t){t===void 0&&(t=0),M(e.length>=1,function(){return"Pass at least one tensor to concat"});var n=ku(e,"tensors","concat");n[0].dtype==="complex64"&&n.forEach(function(l){if(l.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+l.dtype+". ")}),t=Ut(t,n[0].shape)[0];var r=Zi(n.map(function(l){return l.shape}),t);if(je(r)===0)return en([],r);if((n=n.filter(function(l){return l.size>0})).length===1)return n[0];var s=n.map(function(l){return l.shape});i_(s,t);var i=n,o={axis:t};return V.runKernelFunc(function(l){return l.concat(n,t)},i,function(l){var c=s.map(function(u){return u[t]});return Fm(l,c,t).map(function(u){return function(){return u}})},"Concat",o)}}),d_=z({concat1d_:function(e){return Ot(e,0)}}),h_=z({concat2d_:function(e,t){return Ot(e,t)}}),p_=z({concat3d_:function(e,t){return Ot(e,t)}}),f_=z({concat4d_:function(e,t){return Ot(e,t)}}),Fm=z({split_:function(e,t,n){n===void 0&&(n=0);var r,s=T(e,"x","split");return n=Ut(n,s.shape)[0],typeof t=="number"?(M(s.shape[n]%t==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(t).fill(s.shape[n]/t)):(M(s.shape[n]===t.reduce(function(i,o){return i+o}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=t),V.runKernelFunc(function(i){return i.split(s,r,n)},{$x:s},function(i){return{$x:function(){return Ot(i,n)}}})}});function Ys(e,t){return e(t={exports:{}},t.exports),t.exports}var m_=Ys(function(e){(function(t,n,r){function s(l){var c,u=this,d=(c=4022871197,function(h){h=h.toString();for(var p=0;p<h.length;p++){var f=.02519603282416938*(c+=h.charCodeAt(p));f-=c=f>>>0,c=(f*=c)>>>0,c+=4294967296*(f-=c)}return 23283064365386963e-26*(c>>>0)});u.next=function(){var h=2091639*u.s0+23283064365386963e-26*u.c;return u.s0=u.s1,u.s1=u.s2,u.s2=h-(u.c=0|h)},u.c=1,u.s0=d(" "),u.s1=d(" "),u.s2=d(" "),u.s0-=d(l),u.s0<0&&(u.s0+=1),u.s1-=d(l),u.s1<0&&(u.s1+=1),u.s2-=d(l),u.s2<0&&(u.s2+=1),d=null}function i(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function o(l,c){var u=new s(l),d=c&&c.state,h=u.next;return h.int32=function(){return 4294967296*u.next()|0},h.double=function(){return h()+11102230246251565e-32*(2097152*h()|0)},h.quick=h,d&&(typeof d=="object"&&i(d,u),h.state=function(){return i(u,{})}),h}n&&n.exports?n.exports=o:this.alea=o})(0,e)}),x_=Ys(function(e){(function(t,n,r){function s(l){var c=this,u="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var h=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^h^h>>>8},l===(0|l)?c.x=l:u+=l;for(var d=0;d<u.length+64;d++)c.x^=0|u.charCodeAt(d),c.next()}function i(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c}function o(l,c){var u=new s(l),d=c&&c.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var p=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(p===0);return p},h.int32=u.next,h.quick=h,d&&(typeof d=="object"&&i(d,u),h.state=function(){return i(u,{})}),h}n&&n.exports?n.exports=o:this.xor128=o})(0,e)}),g_=Ys(function(e){(function(t,n,r){function s(l){var c=this,u="";c.next=function(){var h=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^h^h<<1)|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,l===(0|l)?c.x=l:u+=l;for(var d=0;d<u.length+64;d++)c.x^=0|u.charCodeAt(d),d==u.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function i(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c.v=l.v,c.d=l.d,c}function o(l,c){var u=new s(l),d=c&&c.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var p=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(p===0);return p},h.int32=u.next,h.quick=h,d&&(typeof d=="object"&&i(d,u),h.state=function(){return i(u,{})}),h}n&&n.exports?n.exports=o:this.xorwow=o})(0,e)}),v_=Ys(function(e){(function(t,n,r){function s(l){var c=this;c.next=function(){var u,d,h=c.x,p=c.i;return u=h[p],d=(u^=u>>>7)^u<<24,d^=(u=h[p+1&7])^u>>>10,d^=(u=h[p+3&7])^u>>>3,d^=(u=h[p+4&7])^u<<7,u=h[p+7&7],d^=(u^=u<<13)^u<<9,h[p]=d,c.i=p+1&7,d},function(u,d){var h,p=[];if(d===(0|d))p[0]=d;else for(d=""+d,h=0;h<d.length;++h)p[7&h]=p[7&h]<<15^d.charCodeAt(h)+p[h+1&7]<<13;for(;p.length<8;)p.push(0);for(h=0;h<8&&p[h]===0;++h);for(h==8?p[7]=-1:p[h],u.x=p,u.i=0,h=256;h>0;--h)u.next()}(c,l)}function i(l,c){return c.x=l.x.slice(),c.i=l.i,c}function o(l,c){l==null&&(l=+new Date);var u=new s(l),d=c&&c.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var p=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(p===0);return p},h.int32=u.next,h.quick=h,d&&(d.x&&i(d,u),h.state=function(){return i(u,{})}),h}n&&n.exports?n.exports=o:this.xorshift7=o})(0,e)}),y_=Ys(function(e){(function(t,n,r){function s(l){var c=this;c.next=function(){var u,d,h=c.w,p=c.X,f=c.i;return c.w=h=h+1640531527|0,d=p[f+34&127],u=p[f=f+1&127],d^=d<<13,u^=u<<17,d^=d>>>15,u^=u>>>12,d=p[f]=d^u,c.i=f,d+(h^h>>>16)|0},function(u,d){var h,p,f,x,v,y=[],m=128;for(d===(0|d)?(p=d,d=null):(d+="\0",p=0,m=Math.max(m,d.length)),f=0,x=-32;x<m;++x)d&&(p^=d.charCodeAt((x+32)%d.length)),x===0&&(v=p),p^=p<<10,p^=p>>>15,p^=p<<4,p^=p>>>13,x>=0&&(v=v+1640531527|0,f=(h=y[127&x]^=p+v)==0?f+1:0);for(f>=128&&(y[127&(d&&d.length||0)]=-1),f=127,x=512;x>0;--x)p=y[f+34&127],h=y[f=f+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,y[f]=p^h;u.w=v,u.X=y,u.i=f}(c,l)}function i(l,c){return c.i=l.i,c.w=l.w,c.X=l.X.slice(),c}function o(l,c){l==null&&(l=+new Date);var u=new s(l),d=c&&c.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var p=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(p===0);return p},h.int32=u.next,h.quick=h,d&&(d.X&&i(d,u),h.state=function(){return i(u,{})}),h}n&&n.exports?n.exports=o:this.xor4096=o})(0,e)}),b_=Ys(function(e){(function(t,n,r){function s(l){var c=this,u="";c.next=function(){var h=c.b,p=c.c,f=c.d,x=c.a;return h=h<<25^h>>>7^p,p=p-f|0,f=f<<24^f>>>8^x,x=x-h|0,c.b=h=h<<20^h>>>12^p,c.c=p=p-f|0,c.d=f<<16^p>>>16^x,c.a=x-h|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,l===Math.floor(l)?(c.a=l/4294967296|0,c.b=0|l):u+=l;for(var d=0;d<u.length+20;d++)c.b^=0|u.charCodeAt(d),c.next()}function i(l,c){return c.a=l.a,c.b=l.b,c.c=l.c,c.d=l.d,c}function o(l,c){var u=new s(l),d=c&&c.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var p=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(p===0);return p},h.int32=u.next,h.quick=h,d&&(typeof d=="object"&&i(d,u),h.state=function(){return i(u,{})}),h}n&&n.exports?n.exports=o:this.tychei=o})(0,e)}),js=Ys(function(e){(function(t,n){var r,s=this,i=256,o=6,l="random",c=n.pow(i,o),u=n.pow(2,52),d=2*u,h=i-1;function p(m,g,b){var w=[],N=v(function j(k,R){var E,P=[],F=typeof k;if(R&&F=="object")for(E in k)try{P.push(j(k[E],R-1))}catch{}return P.length?P:F=="string"?k:k+"\0"}((g=g==1?{entropy:!0}:g||{}).entropy?[m,y(t)]:m??function(){try{var j;return r&&(j=r.randomBytes)?j=j(i):(j=new Uint8Array(i),(s.crypto||s.msCrypto).getRandomValues(j)),y(j)}catch{var k=s.navigator,R=k&&k.plugins;return[+new Date,s,R,s.screen,y(t)]}}(),3),w),C=new f(w),D=function(){for(var j=C.g(o),k=c,R=0;j<u;)j=(j+R)*i,k*=i,R=C.g(1);for(;j>=d;)j/=2,k/=2,R>>>=1;return(j+R)/k};return D.int32=function(){return 0|C.g(4)},D.quick=function(){return C.g(4)/4294967296},D.double=D,v(y(C.S),t),(g.pass||b||function(j,k,R,E){return E&&(E.S&&x(E,C),j.state=function(){return x(C,{})}),R?(n[l]=j,k):j})(D,N,"global"in g?g.global:this==n,g.state)}function f(m){var g,b=m.length,w=this,N=0,C=w.i=w.j=0,D=w.S=[];for(b||(m=[b++]);N<i;)D[N]=N++;for(N=0;N<i;N++)D[N]=D[C=h&C+m[N%b]+(g=D[N])],D[C]=g;(w.g=function(j){for(var k,R=0,E=w.i,P=w.j,F=w.S;j--;)k=F[E=h&E+1],R=R*i+F[h&(F[E]=F[P=h&P+k])+(F[P]=k)];return w.i=E,w.j=P,R})(i)}function x(m,g){return g.i=m.i,g.j=m.j,g.S=m.S.slice(),g}function v(m,g){for(var b,w=m+"",N=0;N<w.length;)g[h&N]=h&(b^=19*g[h&N])+w.charCodeAt(N++);return y(g)}function y(m){return String.fromCharCode.apply(0,m)}if(n["seed"+l]=p,v(n.random(),t),e.exports){e.exports=p;try{r=require("crypto")}catch{}}})([],Math)});js.alea=m_,js.xor128=x_,js.xorwow=g_,js.xorshift7=v_,js.xor4096=y_,js.tychei=b_;var gd=js.alea,Mm=function(){function e(t,n,r,s,i){this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=s,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=i||Math.random();this.random=gd(o.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var n,r,s=!1;!s;){var i=void 0,o=void 0,l=void 0;do l=(i=2*this.random()-1)*i+(o=2*this.random()-1)*o;while(l>=1||l===0);var c=Math.sqrt(-2*Math.log(l)/l);n=this.mean+this.stdDev*i*c,r=this.mean+this.stdDev*o*c,this.truncated&&!this.isValidTruncated(n)||(s=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(n)},e.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},e.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},e}(),w_=function(){function e(t,n,r,s){this.alpha=t,this.beta=1/n,this.dtype=r;var i=s||Math.random();this.randu=gd(i.toString()),this.randn=new Mm(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var t,n,r,s,i,o;;){do s=this.randn.nextValue(),o=1+this.c*s;while(o<=0);if(o*=o*o,n=1-.331*(t=s*s)*t,r=.5*t+this.d*(1-o+Math.log(o)),(i=this.randu())<n||Math.log(i)<r)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)},e.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},e}(),N_=function(){function e(t,n,r,s){var i=this;if(t===void 0&&(t=0),n===void 0&&(n=1),this.canReturnFloat=function(){return i.dtype==null||i.dtype==="float32"},this.min=t,this.range=n-t,this.dtype=r,s==null&&(s=Math.random()),typeof s=="number"&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+n+" <= 1 and dtype is not float");this.random=gd(s)}return e.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}();function Le(e,t,n){return t===void 0&&(t="float32"),t=t||"float32",dN(e),new dl(e,t,n)}function j_(e,t){t===void 0&&(t=!1),console.log(e.toString(t))}var yN=z({batchToSpaceND_:function(e,t,n){var r=T(e,"x","batchToSpaceND"),s=t.reduce(function(i,o){return i*o});return M(r.rank>=1+t.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length}),M(n.length===t.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length}),M(r.shape[0]%s==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+s}),V.runKernelFunc(function(i){return i.batchToSpaceND(r,t,n)},{$x:r},function(i){return{$x:function(){return i.spaceToBatchND(t,n)}}})}}),C_=z({broadcastTo_:function(e,t){var n=T(e,"broadcastTo","x"),r=n.shape;if(t.some(function(c){return!(c>0)||c%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var s=n.shape.slice();s.length<t.length;)s.unshift(1);n=n.reshape(s)}for(var i=Array.from(t),o=t.length-1;o>=0;o--)if(n.shape[o]===t[o])i[o]=1;else if(n.shape[o]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var l=i.map(function(c,u){return c>1?u:-1}).filter(function(c){return c>=0});return l.length===0?n.clone():V.runKernelFunc(function(c){return c.tile(n,i)},{input:n},function(c){return{input:function(){return c.sum(l,!0)}}})}}),k_=z({cast_:function(e,t){var n=T(e,"x","cast");if(!gR(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:t};return V.runKernelFunc(function(s){return s.cast(n,t)},{x:n},function(s){return{x:function(){return s.clone()}}},"Cast",r)}}),S_=z({clone_:function(e){var t=T(e,"x","clone",null);return V.runKernelFunc(function(){return V.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(n){return{$x:function(){return n.toFloat()}}})}}),E_=z({cumsum_:function(e,t,n,r){t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1);var s=T(e,"x","cumsum"),i=Xr([t|=0],s.rank),o=s;i!=null&&(o=s.transpose(i));var l=Yr(1,s.rank)[0],c=V.runKernelFunc(function(u){return u.cumsum(o,l,n,r)},{permutedX:o},function(u){return{permutedX:function(){return u.cumsum(t,n,!r)}}});return i!=null&&(c=c.transpose(i)),c}}),D_=z({depthToSpace_:function(e,t,n){n===void 0&&(n="NHWC");var r=T(e,"x","depthToSpace"),s=n==="NHWC"?r.shape[1]:r.shape[2],i=n==="NHWC"?r.shape[2]:r.shape[3],o=n==="NHWC"?r.shape[3]:r.shape[1];return M(s*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+s+" and "+t+`  for depthToSpace with input shape
      `+r.shape}),M(i*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+t+` for depthToSpace with input shape
          `+r.shape}),M(o%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+o+" for depthToSpace with input shape "+r.shape}),V.runKernelFunc(function(l){return l.depthToSpace(r,t,n)},{$x:r})}}),Jn=z({expandDims_:function(e,t){t===void 0&&(t=0);var n=T(e,"x","expandDims",null);M(t<=n.rank,function(){return"Axis must be <= rank of the tensor"});var r=n.shape.slice();return t<0&&(M(-(n.rank+1)<=t,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),t=n.rank+t+1),r.splice(t,0,1),gr(n,r)}}),bN=z({eye_:function(e,t,n,r){r===void 0&&(r="float32"),t==null&&(t=e);for(var s=Le([e,t],r),i=e<=t?e:t,o=0;o<i;++o)s.set(1,o,o);var l=s.toTensor().as2D(e,t);if(n==null)return l;if(n.length===1)return Ti(Jn(l,0),[n[0],1,1]);if(n.length===2)return Ti(Jn(Jn(l,0),0),[n[0],n[1],1,1]);if(n.length===3)return Ti(Jn(Jn(Jn(l,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),R_=z({multinomial_:function(e,t,n,r){r===void 0&&(r=!1);var s=T(e,"logits","multinomial"),i=s.size,o=s.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+o);n=n||Math.random();var l=o===1?s.as2D(1,-1):s,c=V.runKernelFunc(function(u){return u.multinomial(l,r,t,n)},{logits2D:l});return o===1?c.as1D():c}}),rf=z({oneHot_:function(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var s=T(e,"indices","oneHot","int32"),i=s.shape.concat([t]);return s=s.flatten(),V.runKernelFunc(function(o){return o.oneHot(s,t,n,r)},{$indices:s},function(o){return{$indices:function(){return ct(s.shape,"float32")}}}).reshape(i)}}),Qs=z({pad_:function(e,t,n){n===void 0&&(n=0);var r=T(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var s={paddings:t,constantValue:n};return V.runKernelFunc(function(i){return i.pad(r,t,n)},{x:r},function(i){var o=t.map(function(l){return l[0]});return{x:function(){return i.slice(o,r.shape)}}},"PadV2",s)}}),__=z({pad1d_:function(e,t,n){return n===void 0&&(n=0),M(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),Qs(e,[t],n)}}),T_=z({pad2d_:function(e,t,n){return n===void 0&&(n=0),M(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Qs(e,t,n)}}),A_=z({pad3d_:function(e,t,n){return n===void 0&&(n=0),M(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Qs(e,t,n)}}),I_=z({pad4d_:function(e,t,n){return n===void 0&&(n=0),M(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Qs(e,t,n)}}),P_=z({rand_:function(e,t,n){var r=je(e),s=null;if(n==null||n==="float32")s=new Float32Array(r);else if(n==="int32")s=new Int32Array(r);else{if(n!=="bool")throw new Error("Unknown data type "+n);s=new Uint8Array(r)}for(var i=0;i<r;i++)s[i]=t();return V.makeTensor(s,e,n)}}),F_=z({randomNormal_:function(e,t,n,r,s){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new Mm(t,n,r,!1,s),o=Le(e,r),l=0;l<o.values.length;l++)o.values[l]=i.nextValue();return o.toTensor()}}),M_=z({randomGamma_:function(e,t,n,r,s){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var i=new w_(t,n,r,s),o=Le(e,r),l=0;l<o.values.length;l++)o.values[l]=i.nextValue();return o.toTensor()}}),wN=z({randomUniform_:function(e,t,n,r,s){t===void 0&&(t=0),n===void 0&&(n=1),r===void 0&&(r="float32");for(var i=Le(e,r),o=new N_(t,n,null,s),l=0;l<i.values.length;l++)i.values[l]=o.nextValue();return i.toTensor()}}),gr=z({reshape_:function(e,t){var n=T(e,"x","reshape",null);t=mR(t,n.size),M(n.size===je(t),function(){return"new shape and old shape must have the same number of elements."});var r={shape:t};return V.runKernelFunc(function(s){return s.reshape(n,t)},{x:n},function(s){return{x:function(){return s.reshape(n.shape)}}},"Reshape",r)}}),NN=z({spaceToBatchND_:function(e,t,n){var r=T(e,"x","spaceToBatchND");return M(r.rank>=1+t.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length}),M(n.length===t.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length}),M(r.shape.reduce(function(s,i,o){return o>0&&o<=t.length?s&&(i+n[o-1][0]+n[o-1][1])%t[o-1]==0:s},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()}),V.runKernelFunc(function(s){return s.spaceToBatchND(r,t,n)},{$x:r},function(s){return{$x:function(){return s.batchToSpaceND(t,n)}}})}}),jN=z({squeeze_:function(e,t){var n=T(e,"x","squeeze");return gr(n,ks(n.shape,t).newShape)}}),Vn=z({stack_:function(e,t){t===void 0&&(t=0);var n=ku(e,"tensors","stack");if(M(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),n.length===1)return n[0].expandDims(t);var r=n[0].rank,s=n[0].shape,i=n[0].dtype;M(t<=r,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(l){Ze(s,l.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(l){M(i===l.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var o=n.map(function(l){return l.expandDims(t)});return Ot(o,t)}}),Ti=z({tile_:function(e,t){var n=T(e,"x","tile",null);M(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."});var r=[n],s={reps:t};return V.runKernelFunc(function(i,o){var l=i.tile(n,t);return o([n]),l},{x:n},function(i,o){var l=o[0];return{x:function(){var c=Ke(l);if(l.rank===1)for(var u=0;u<t[0];++u)c=c.add(i.slice([u*l.shape[0]],[l.shape[0]]));else if(l.rank===2)for(u=0;u<t[0];++u)for(var d=0;d<t[1];++d)c=c.add(i.slice([u*l.shape[0],d*l.shape[1]],[l.shape[0],l.shape[1]]));else if(l.rank===3)for(u=0;u<t[0];++u)for(d=0;d<t[1];++d)for(var h=0;h<t[2];++h)c=c.add(i.slice([u*l.shape[0],d*l.shape[1],h*l.shape[2]],[l.shape[0],l.shape[1],l.shape[2]]));else{if(l.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+l.rank+" tensors yet.");for(u=0;u<t[0];++u)for(d=0;d<t[1];++d)for(h=0;h<t[2];++h)for(var p=0;p<t[3];++p)c=c.add(i.slice([u*l.shape[0],d*l.shape[1],h*l.shape[2],p*l.shape[3]],[l.shape[0],l.shape[1],l.shape[2],l.shape[3]]))}return c}}},"Tile",s,r)}}),L_=z({truncatedNormal_:function(e,t,n,r,s){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new Mm(t,n,r,!0,s),o=Le(e,r),l=0;l<o.values.length;l++)o.values[l]=i.nextValue();return o.toTensor()}}),Bt=z({unstack_:function(e,t){t===void 0&&(t=0),t=t||0;var n=T(e,"x","unstack");M(t>=-n.shape.length&&t<n.shape.length,function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),t<0&&(t+=n.shape.length);var r={axis:t};return V.runKernelFunc(function(s){return s.unstack(n,t)},{x:n},function(s){return{x:function(){return Vn(s,t)}}},"Unpack",r)}}),O_=function(e,t){return we(this,void 0,void 0,function(){var n,r,s,i,o,l,c,u,d,h;return Ne(this,function(p){switch(p.label){case 0:return n=T(e,"x","setdiff1d"),r=T(t,"y","setdiff1d"),M(n.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."}),M(n.rank===1,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),M(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,n.data()];case 1:return s=p.sent(),[4,r.data()];case 2:for(i=p.sent(),o=new Set(i),l=0,d=0;d<s.length;d++)o.has(s[d])||l++;for(c=new dl([l],n.dtype),u=new dl([l],"int32"),d=0,h=0;d<s.length;d++)o.has(s[d])||(c.values[h]=s[d],u.values[h]=d,h++);return[2,[c.toTensor(),u.toTensor()]]}})})};function Eu(e,t,n,r){r===void 0&&(r=!0);var s=[];if(r)(s=s.concat(t.slice(0))).push(e[0]/n),s=s.concat(e.slice(1));else{s=s.concat(e[0]);for(var i=t.length,o=0;o<i;++o)s=s.concat([e[o+1]/t[o],t[o]]);s=s.concat(e.slice(i+1))}return s}function Du(e,t,n){n===void 0&&(n=!0);var r=[];if(n){r.push(t);for(var s=t+1;s<e;++s)s<=2*t?(r.push(s),r.push(s-(t+1))):r.push(s)}else{var i=[],o=[];for(s=1;s<e;++s)s>=2*t+1||s%2==1?o.push(s):i.push(s);r.push.apply(r,i),r.push(0),r.push.apply(r,o)}return r}function Ru(e,t,n,r){r===void 0&&(r=!0);var s=[];r?s.push(e[0]/n):s.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?s.push(t[i-1]*e[i]):s.push(e[i]/t[i-1]):s.push(e[i]);return s}function CN(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function kN(e,t,n){for(var r=e.slice(0,1),s=0;s<n;++s)r.push(e[s+1]-t[s][0]-t[s][1]);return r}function SN(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(e.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],s=1,i=0;i<n.length-1;++i)s*=n[i];var o=e.shape,l=n.slice();l.pop();var c=1;for(i=r;i<e.rank;++i)c*=o[i],l.push(o[i]);var u=Wr(e.shape).map(function(d){return d/c}).concat([1]).slice(0,r);return[l,s,c,u]}var EN=30;function Nh(e){return e<=EN?e:Qp(e,Math.floor(Math.sqrt(e)))}function B_(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,s=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+s+".";if(n.rank<s)throw new Error(i+" update.rank < "+s+". ");if(e.length<r+(n.rank-s))throw new Error(i+" Output shape length < "+(r+(n.rank-s)));if(n.rank!==s+e.length-r)throw new Error(i+" update.rank != "+(s+e.length-r));for(var o=0;o<s;++o)if(n.shape[o]!==t.shape[o])throw new Error(i+" updates.shape["+o+"] ("+n.shape[o]+") != indices.shape["+o+"] ("+t.shape[o]+").");for(o=0;o<n.rank-s;++o)if(n.shape[o+s]!==e[o+r])throw new Error(i+" updates.shape["+(o+s)+"] ("+n.shape[o+s]+") != shape["+(o+s)+"] ("+e[o+s]+")")}function $_(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(n.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(e.size===0)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}B_(n,t,e)}function _u(e,t,n){for(var r=t.shape.length,s=r>1?t.shape[r-1]:1,i=n.length,o=1,l=s;l<i;++l)o*=n[l];var c=s<1?1:s;return{sliceRank:s,numUpdates:je(t.shape)/c,sliceSize:o,strides:Wr(n.slice(0,s)).concat([1]),outputSize:je(n)}}function z_(e,t,n){M(e.rank===t.length,function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."}),M(e.rank===n.length,function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."});for(var r=function(i){M(t[i]+n[i]<=e.shape[i],function(){return"Error in slice"+e.rank+"D: begin["+i+"] + size["+i+"] ("+(t[i]+n[i])+") would overflow input.shape["+i+"] ("+e.shape[i]+")"})},s=0;s<e.rank;++s)r(s)}function Uy(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function Lm(e,t,n){for(var r=[],s=0;s<e.length;s++)r[s]=Math.ceil((t[s]-e[s])/n[s]);return r}function U_(e,t,n,r,s){var i=t[s],o=n[s]||1;(e&1<<s||i==null)&&(i=o>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var l=r[s];return i<0&&(i+=l),i=Kp(0,i,l-1)}function W_(e,t,n,r,s){var i=t[s],o=n[s]||1;(e&1<<s||i==null)&&(i=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var l=r[s];return i<0&&(i+=l),i=o>0?Kp(0,i,l):Kp(-1,i,l-1)}function DN(e,t,n){for(var r=n.length,s=0;s<n.length;s++)if(n[s]>1){r=s;break}for(s=r+1;s<n.length;s++)if(t[s]>0||n[s]!==e[s])return!1;return!0}function RN(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function V_(e,t){M(Yp(e),function(){return"The f passed in variableGrads(f) must be a function"}),M(t==null||Array.isArray(t)&&t.every(function(d){return d instanceof Ji}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=t!=null;if(!n)for(var r in t=[],V.registeredVariables)t.push(V.registeredVariables[r]);var s=n?t.filter(function(d){return!d.trainable}):null,i=t.length;M((t=t.filter(function(d){return d.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var o=V.gradients(e,t,null,!0),l=o.value,c=o.grads;M(c.some(function(d){return d!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),M(l.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+l.rank+" tensor"});var u={};return t.forEach(function(d,h){c[h]!=null&&(u[d.name]=c[h])}),s!=null&&s.forEach(function(d){return u[d.name]=null}),{value:l,grads:u}}function vd(e){return V.customGrad(e)}var ja=z({softmax_:function(e,t){t===void 0&&(t=-1);var n=T(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return V.runKernelFunc(function(r,s){var i=r.softmax(n,t);return s([i]),i},{logits:n},function(r,s){var i=s[0],o=r.mul(i);return{logits:function(){return o.sub(o.sum([t],!0).mul(i))}}},"Softmax",{dim:t},[],[!0])}}),H_=z({logSoftmax_:function(e,t){t===void 0&&(t=-1);var n=T(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return vd(function(r,s){var i=r.max(t,!0),o=r.sub(i),l=o.toFloat().sub(o.exp().sum(t,!0).log());return s([l]),{value:l,gradFunc:function(c,u){var d=u[0].exp();return c.sub(c.sum(t,!0).mul(d))}}})(n)}}),_N=function(){function e(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},e.prototype.set=function(t,n){this.dataIdsCount++,this.data.set(t,n)},e.prototype.has=function(t){return this.data.has(t)},e.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),TN=function(){function e(){}return e.prototype.time=function(t){return G("time")},e.prototype.read=function(t){return G("read")},e.prototype.readSync=function(t){return G("readSync")},e.prototype.numDataIds=function(){return G("numDataIds")},e.prototype.disposeData=function(t){return G("disposeData")},e.prototype.write=function(t,n,r){return G("write")},e.prototype.move=function(t,n,r,s){return G("move")},e.prototype.memory=function(){return G("memory")},e.prototype.floatPrecision=function(){return G("floatPrecision")},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.batchMatMul=function(t,n,r,s){return G("batchMatMul")},e.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,G("fusedBatchMatMul")},e.prototype.slice=function(t,n,r){return G("slice")},e.prototype.stridedSlice=function(t,n,r,s){return G("stridedSlice")},e.prototype.unstack=function(t,n){return G("unstack")},e.prototype.reverse=function(t,n){return G("reverse")},e.prototype.concat=function(t,n){return G("concat")},e.prototype.neg=function(t){return G("neg")},e.prototype.add=function(t,n){return G("add")},e.prototype.addN=function(t){return G("addN")},e.prototype.subtract=function(t,n){return G("subtract")},e.prototype.multiply=function(t,n){return G("multiply")},e.prototype.realDivide=function(t,n){return G("realDivide")},e.prototype.floorDiv=function(t,n){return G("floorDiv")},e.prototype.sum=function(t,n){return G("sum")},e.prototype.prod=function(t,n){return G("prod")},e.prototype.unsortedSegmentSum=function(t,n,r){return G("unsortedSegmentSum")},e.prototype.argMin=function(t,n){return G("argMin")},e.prototype.argMax=function(t,n){return G("argMax")},e.prototype.equal=function(t,n){return G("equal")},e.prototype.notEqual=function(t,n){return G("notEqual")},e.prototype.less=function(t,n){return G("less")},e.prototype.lessEqual=function(t,n){return G("lessEqual")},e.prototype.greater=function(t,n){return G("greater")},e.prototype.greaterEqual=function(t,n){return G("greaterEqual")},e.prototype.logicalNot=function(t){return G("logicalNot")},e.prototype.logicalAnd=function(t,n){return G("logicalAnd")},e.prototype.logicalOr=function(t,n){return G("logicalOr")},e.prototype.where=function(t){return G("where")},e.prototype.select=function(t,n,r){return G("select")},e.prototype.topk=function(t,n,r){return G("topk")},e.prototype.min=function(t,n){return G("min")},e.prototype.minimum=function(t,n){return G("minimum")},e.prototype.mod=function(t,n){return G("mod")},e.prototype.max=function(t,n){return G("max")},e.prototype.maximum=function(t,n){return G("maximum")},e.prototype.all=function(t,n){return G("all")},e.prototype.any=function(t,n){return G("any")},e.prototype.squaredDifference=function(t,n){return G("squaredDifference")},e.prototype.ceil=function(t){return G("ceil")},e.prototype.floor=function(t){return G("floor")},e.prototype.round=function(t){return G("round")},e.prototype.sign=function(t){return G("sign")},e.prototype.isNaN=function(t){return G("isNaN")},e.prototype.isInf=function(t){return G("isInf")},e.prototype.isFinite=function(t){return G("isFinite")},e.prototype.pow=function(t,n){return G("pow")},e.prototype.exp=function(t){return G("exp")},e.prototype.expm1=function(t){return G("expm1")},e.prototype.softmax=function(t,n){return G("softmax")},e.prototype.log=function(t){return G("log")},e.prototype.log1p=function(t){return G("log1p")},e.prototype.sqrt=function(t){return G("sqrt")},e.prototype.rsqrt=function(t){return G("rsqrt")},e.prototype.square=function(t){return G("square")},e.prototype.reciprocal=function(t){return G("reciprocal")},e.prototype.relu=function(t){return G("relu")},e.prototype.relu6=function(t){return G("relu6")},e.prototype.prelu=function(t,n){return G("prelu")},e.prototype.elu=function(t){return G("elu")},e.prototype.eluDer=function(t,n){return G("eluDer")},e.prototype.selu=function(t){return G("selu")},e.prototype.int=function(t){return G("int")},e.prototype.clip=function(t,n,r){return G("clip")},e.prototype.abs=function(t){return G("abs")},e.prototype.complexAbs=function(t){return G("complexAbs")},e.prototype.sigmoid=function(t){return G("sigmoid")},e.prototype.softplus=function(t){return G("softplus")},e.prototype.sin=function(t){return G("sin")},e.prototype.cos=function(t){return G("cos")},e.prototype.tan=function(t){return G("tan")},e.prototype.asin=function(t){return G("asin")},e.prototype.acos=function(t){return G("acos")},e.prototype.atan=function(t){return G("atan")},e.prototype.atan2=function(t,n){return G("atan2")},e.prototype.sinh=function(t){return G("sinh")},e.prototype.cosh=function(t){return G("cosh")},e.prototype.tanh=function(t){return G("tanh")},e.prototype.asinh=function(t){return G("asinh")},e.prototype.acosh=function(t){return G("acosh")},e.prototype.atanh=function(t){return G("atanh")},e.prototype.erf=function(t){return G("erf")},e.prototype.step=function(t,n){return G("step")},e.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,G("fusedConv2d")},e.prototype.conv2d=function(t,n,r){return G("conv2d")},e.prototype.conv2dDerInput=function(t,n,r){return G("conv2dDerInput")},e.prototype.conv2dDerFilter=function(t,n,r){return G("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,G("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(t,n,r){return G("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(t,n,r){return G("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(t,n,r){return G("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(t,n,r){return G("conv3d")},e.prototype.conv3dDerInput=function(t,n,r){return G("conv3dDerInput")},e.prototype.conv3dDerFilter=function(t,n,r){return G("conv3dDerFilter")},e.prototype.maxPool=function(t,n){return G("maxPool")},e.prototype.maxPoolBackprop=function(t,n,r,s){return G("maxPoolBackprop")},e.prototype.avgPool=function(t,n){return G("avgPool")},e.prototype.avgPoolBackprop=function(t,n,r){return G("avgPoolBackprop")},e.prototype.avgPool3d=function(t,n){return G("avgPool3d")},e.prototype.avgPool3dBackprop=function(t,n,r){return G("avgPool3dBackprop")},e.prototype.maxPool3d=function(t,n){return G("maxPool3d")},e.prototype.maxPool3dBackprop=function(t,n,r,s){return G("maxPool3dBackprop")},e.prototype.reshape=function(t,n){return G("reshape")},e.prototype.cast=function(t,n){return G("cast")},e.prototype.tile=function(t,n){return G("tile")},e.prototype.pad=function(t,n,r){return G("pad")},e.prototype.transpose=function(t,n){return G("transpose")},e.prototype.gather=function(t,n,r){return G("gather")},e.prototype.gatherND=function(t,n){return G("gatherND")},e.prototype.scatterND=function(t,n,r){return G("scatterND")},e.prototype.batchToSpaceND=function(t,n,r){return G("batchToSpaceND")},e.prototype.spaceToBatchND=function(t,n,r){return G("spaceToBatchND")},e.prototype.resizeBilinear=function(t,n,r,s){return G("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(t,n,r){return G("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(t,n,r,s){return G("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(t,n,r){return G("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(t,n,r,s,i,o){return G("batchNormalization")},e.prototype.localResponseNormalization4D=function(t,n,r,s,i){return G("localResponseNormalization4D")},e.prototype.LRNGrad=function(t,n,r,s,i,o,l){return G("LRNGrad")},e.prototype.multinomial=function(t,n,r,s){return G("multinomial")},e.prototype.oneHot=function(t,n,r,s){return G("oneHot")},e.prototype.cumsum=function(t,n,r,s){return G("cumsum")},e.prototype.nonMaxSuppression=function(t,n,r,s,i){return G("nonMaxSuppression")},e.prototype.fft=function(t){return G("fft")},e.prototype.ifft=function(t){return G("ifft")},e.prototype.complex=function(t,n){return G("complex")},e.prototype.real=function(t){return G("real")},e.prototype.imag=function(t){return G("imag")},e.prototype.cropAndResize=function(t,n,r,s,i,o){return G("cropAndResize")},e.prototype.depthToSpace=function(t,n,r){return G("depthToSpace")},e.prototype.split=function(t,n,r){return G("split")},e.prototype.sparseToDense=function(t,n,r,s){return G("sparseToDense")},e.prototype.diag=function(t){return G("diag")},e.prototype.fill=function(t,n,r){return G("fill")},e.prototype.onesLike=function(t){return G("onesLike")},e.prototype.zerosLike=function(t){return G("zerosLike")},e.prototype.linspace=function(t,n,r){return G("linspace")},e.prototype.dispose=function(){return G("dispose")},e}();function G(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function za(e,t){for(var n=e.length,r=[],s=0;s<n;s++){var i=n-1-s,o=e[i]||1;(t[t.length-1-s]||1)>1&&o===1&&r.unshift(i)}return r}function $t(e,t){for(var n=[],r=0;r<t.length;r++){var s=e[e.length-r-1],i=t.length-r-1,o=t[i];(s==null||s===1&&o>1)&&n.unshift(i)}return n}function He(e,t){for(var n=[],r=Math.max(e.length,t.length),s=0;s<r;s++){var i=e[e.length-s-1];i==null&&(i=1);var o=t[t.length-s-1];if(o==null&&(o=1),i===1)n.unshift(o);else if(o===1)n.unshift(i);else{if(i!==o)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(i)}}return n}function pl(e,t,n,r,s,i,o){o===void 0&&(o="channelsLast");var l,c=Iu(t),u=c[0],d=c[1];if(o==="channelsLast")l=[u,d,e[3],e[3]];else{if(o!=="channelsFirst")throw new Error("Unknown dataFormat "+o);l=[u,d,e[1],e[1]]}return Js(e,l,n,r,s,i,!1,o)}function Tu(e,t,n,r,s,i,o){o===void 0&&(o="NDHWC");var l,c,u=af(t),d=u[0],h=u[1],p=u[2];if(o==="NDHWC")c="channelsLast",l=[d,h,p,e[4],e[4]];else{if(o!=="NCDHW")throw new Error("Unknown dataFormat "+o);c="channelsFirst",l=[d,h,p,e[1],e[1]]}return Au(e,l,n,r,s,!1,c,i)}function Js(e,t,n,r,s,i,o,l){o===void 0&&(o=!1),l===void 0&&(l="channelsLast");var c=[-1,-1,-1,-1],u=c[0],d=c[1],h=c[2],p=c[3];if(l==="channelsLast")u=e[0],d=e[1],h=e[2],p=e[3];else{if(l!=="channelsFirst")throw new Error("Unknown dataFormat "+l);u=e[0],p=e[1],d=e[2],h=e[3]}var f,x=t[0],v=t[1],y=t[3],m=Iu(n),g=m[0],b=m[1],w=Iu(r),N=w[0],C=w[1],D=Ai(x,N),j=Ai(v,C),k=function(W,L,U,_,B,O,H,J){var te,ce,se;if(typeof W=="number"){te={top:W,bottom:W,left:W,right:W,type:W===0?"VALID":"NUMBER"};var le=function(_e,Re,A,Z,de){Z==null&&(Z=AN(_e,Re,A));var be=_e[0],ze=_e[1],Me=zo((be-Re+2*Z)/A+1,de);M(Dt(Me),function(){return"The output # of rows ("+Me+") must be an integer. Change the stride and/or zero pad parameters"});var Ae=zo((ze-Re+2*Z)/A+1,de);return M(Dt(Ae),function(){return"The output # of columns ("+Ae+") must be an integer. Change the stride and/or zero pad parameters"}),[Me,Ae]}([L,U],O,_,W,J);ce=le[0],se=le[1]}else if(W==="same"){ce=Math.ceil(L/_),se=Math.ceil(U/B);var he=Math.max(0,(ce-1)*_+O-L),ye=Math.max(0,(se-1)*B+H-U),Ce=Math.floor(he/2),xe=he-Ce,$e=Math.floor(ye/2);te={top:Ce,bottom:xe,left:$e,right:ye-$e,type:"SAME"}}else{if(W!=="valid")throw Error("Unknown padding parameter: "+W);te={top:0,bottom:0,left:0,right:0,type:"VALID"},ce=Math.ceil((L-O+1)/_),se=Math.ceil((U-H+1)/B)}return{padInfo:te,outHeight:ce,outWidth:se}}(s,d,h,g,b,D,j,i),R=k.padInfo,E=k.outHeight,P=k.outWidth,F=o?y*p:y;return l==="channelsFirst"?f=[u,F,E,P]:l==="channelsLast"&&(f=[u,E,P,F]),{batchSize:u,dataFormat:l,inHeight:d,inWidth:h,inChannels:p,outHeight:E,outWidth:P,outChannels:F,padInfo:R,strideHeight:g,strideWidth:b,filterHeight:x,filterWidth:v,effectiveFilterHeight:D,effectiveFilterWidth:j,dilationHeight:N,dilationWidth:C,inShape:e,outShape:f,filterShape:t}}function Au(e,t,n,r,s,i,o,l){i===void 0&&(i=!1),o===void 0&&(o="channelsLast");var c=[-1,-1,-1,-1,-1],u=c[0],d=c[1],h=c[2],p=c[3],f=c[4];if(o==="channelsLast")u=e[0],d=e[1],h=e[2],p=e[3],f=e[4];else{if(o!=="channelsFirst")throw new Error("Unknown dataFormat "+o);u=e[0],f=e[1],d=e[2],h=e[3],p=e[4]}var x,v=t[0],y=t[1],m=t[2],g=t[4],b=af(n),w=b[0],N=b[1],C=b[2],D=af(r),j=D[0],k=D[1],R=D[2],E=Ai(v,j),P=Ai(y,k),F=Ai(m,R),W=function(H,J,te,ce,se,le,he,ye,Ce,xe,$e){var _e,Re,A,Z;if(typeof H=="number"){_e={top:H,bottom:H,left:H,right:H,front:H,back:H,type:H===0?"VALID":"NUMBER"};var de=function(Te,Ue,Rt,Wt,At,Xn){At==null&&(At=AN(Te,Ue,Wt));var mn=Te[0],Da=Te[1],co=Te[2],Ra=zo((mn-Ue+2*At)/Wt+1,Xn);M(Dt(Ra),function(){return"The output # of depths ("+Ra+") must be an integer. Change the stride and/or zero pad parameters"});var uo=zo((Da-Ue+2*At)/Wt+1,Xn);M(Dt(uo),function(){return"The output # of rows ("+uo+") must be an integer. Change the stride and/or zero pad parameters"});var ti=zo((co-Ue+2*At)/Wt+1,Xn);return M(Dt(ti),function(){return"The output # of columns ("+ti+") must be an integer. Change the stride and/or zero pad parameters"}),[Ra,uo,ti,Rt]}([J,te,ce,1],ye,1,se,H,$e);Re=de[0],A=de[1],Z=de[2]}else if(H==="same"){Re=Math.ceil(J/se),A=Math.ceil(te/le),Z=Math.ceil(ce/he);var be=(Re-1)*se+ye-J,ze=(A-1)*le+Ce-te,Me=(Z-1)*he+xe-ce,Ae=Math.floor(be/2),Ye=be-Ae,nt=Math.floor(ze/2),ne=ze-nt,ie=Math.floor(Me/2);_e={top:nt,bottom:ne,left:ie,right:Me-ie,front:Ae,back:Ye,type:"SAME"}}else{if(H!=="valid")throw Error("Unknown padding parameter: "+H);_e={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},Re=Math.ceil((J-ye+1)/se),A=Math.ceil((te-Ce+1)/le),Z=Math.ceil((ce-xe+1)/he)}return{padInfo:_e,outDepth:Re,outHeight:A,outWidth:Z}}(s,d,h,p,w,N,C,E,P,F,l),L=W.padInfo,U=W.outDepth,_=W.outHeight,B=W.outWidth,O=i?g*f:g;return o==="channelsFirst"?x=[u,O,U,_,B]:o==="channelsLast"&&(x=[u,U,_,B,O]),{batchSize:u,dataFormat:o,inDepth:d,inHeight:h,inWidth:p,inChannels:f,outDepth:U,outHeight:_,outWidth:B,outChannels:O,padInfo:L,strideDepth:w,strideHeight:N,strideWidth:C,filterDepth:v,filterHeight:y,filterWidth:m,effectiveFilterDepth:E,effectiveFilterHeight:P,effectiveFilterWidth:F,dilationDepth:j,dilationHeight:k,dilationWidth:R,inShape:e,outShape:x,filterShape:t}}function AN(e,t,n,r){r===void 0&&(r=1);var s=Ai(t,r);return Math.floor((e[0]*(n-1)-n+s)/2)}function Iu(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function af(e){return typeof e=="number"?[e,e,e]:e}function Ai(e,t){return t<=1?e:e+(e-1)*(t-1)}function zo(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function eo(e){var t=Iu(e),n=t[0],r=t[1],s=t[2];return n===1&&r===1&&s===1}function Pn(e,t){return eo(e)||eo(t)}function Om(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function IN(e,t,n){if(t==="complex64"){if(e.dtype==="complex64")return e.clone();var r=ct(e.shape),s=e.toFloat(),i=n.complex(s,r);return r.dispose(),s.dispose(),i}if(!vR(e.dtype,t))return V.makeTensorFromDataId(e.dataId,e.shape,t);if(e.dtype==="complex64"){var o=n.real(e);return i=o.cast(t),o.dispose(),i}if(t==="int32")return n.int(e);if(t==="bool"){var l=fe(0,e.dtype);return i=n.notEqual(e,l),l.dispose(),i}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function sf(e,t){return V.makeTensorFromDataId(e.dataId,t,e.dtype)}function PN(e,t,n){var r=(t-e)/(n-1),s=Rl(n,"float32");s[0]=e;for(var i=1;i<s.length;i++)s[i]=s[i-1]+r;return Tt(s,"float32")}function of(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function Wy(e,t){return{real:e[2*t],imag:e[2*t+1]}}function q_(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function G_(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function K_(e,t,n){var r=function(i,o,l){return function(c,u,d){for(var h=0,p=c.length,f=0,x=!1;h<p;){var v=d(u,c[f=h+(p-h>>>1)]);v>0?h=f+1:(p=f,x=!v)}return x?h:-h-1}(i,o,l||X_)}(e,t,n),s=r<0?-(r+1):r;e.splice(s,0,t)}function X_(e,t){return e>t?1:e<t?-1:0}function Bm(e,t,n,r,s){return FN(e,t,n,r,s,0).selectedIndices}function $m(e,t,n,r,s,i){var o=FN(e,t,n,r,s,i);return o.numValidOutputs.dispose(),{selectedIndices:o.selectedIndices,selectedScores:o.selectedScores}}function FN(e,t,n,r,s,i,o,l){l===void 0&&(l=!1);for(var c=Array.from(t).map(function(w,N){return{score:w,boxIndex:N,suppressBeginIndex:0}}).filter(function(w){return w.score>s}).sort(Vy),u=i>0?-.5/i:0,d=[],h=[];d.length<n&&c.length>0;){var p=c.pop(),f=p.score,x=p.boxIndex,v=p.suppressBeginIndex;if(f<s)break;for(var y=!1,m=d.length-1;m>=v;--m){var g=Y_(e,x,d[m]);if(g>=r){y=!0;break}if(p.score=p.score*Q_(r,u,g),p.score<=s)break}p.suppressBeginIndex=d.length,y||(p.score===f?(d.push(x),h.push(p.score)):p.score>s&&K_(c,p,Vy))}var b=d.length;return l&&(d.fill(0,b),h.fill(0,b)),{selectedIndices:Tt(d,"int32"),selectedScores:Tt(h,"float32"),numValidOutputs:fe(b,"int32")}}function Y_(e,t,n){var r=e.subarray(4*t,4*t+4),s=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),l=Math.max(r[0],r[2]),c=Math.max(r[1],r[3]),u=Math.min(s[0],s[2]),d=Math.min(s[1],s[3]),h=Math.max(s[0],s[2]),p=Math.max(s[1],s[3]),f=(l-i)*(c-o),x=(h-u)*(p-d);if(f<=0||x<=0)return 0;var v=Math.max(i,u),y=Math.max(o,d),m=Math.min(l,h),g=Math.min(c,p),b=Math.max(m-v,0)*Math.max(g-y,0);return b/(f+x-b)}function Q_(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function Vy(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function MN(e,t,n){var r=new Array(e.rank).fill(0),s=e.shape.slice();return t.map(function(i){s[n]=i;var o=e.slice(r,s);return r[n]+=i,o})}function LN(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var s=Le(n,e.dtype);for(r=0;r<s.values.length;++r){for(var i=s.indexToLoc(r),o=new Array(e.rank),l=0;l<o.length;l++)o[l]=i[l]%e.shape[l];var c=e.locToIndex(o);s.values[r]=e.values[c]}return s.toTensor()}function ON(e,t,n,r,s){for(var i=t[t.length-1],o=[e.length/i,i],l=o[0],c=o[1],u=ul(n,l*r),d=ul("int32",l*r),h=0;h<l;h++){for(var p=h*c,f=e.subarray(p,p+c),x=[],v=0;v<f.length;v++)x.push({value:f[v],index:v});x.sort(function(w,N){return N.value-w.value});var y=h*r,m=u.subarray(y,y+r),g=d.subarray(y,y+r);for(v=0;v<r;v++)m[v]=x[v].value,g[v]=x[v].index}var b=t.slice();return b[b.length-1]=r,[en(u,b,n),en(d,b,"int32")]}function zm(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var s=Le(e,"int32"),i=Le([n.length,e.length],"int32");for(r=0;r<n.length;r++){var o=s.indexToLoc(n[r]),l=r*e.length;i.values.set(o,l)}return i.toTensor()}var J_=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(function(s,i){return"T"+i});var n=[];this.variableNames.forEach(function(s){n.push("float v"+s+" = get"+s+"AtOutCoords();")});var r=this.variableNames.map(function(s){return"v"+s}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},Z_=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(function(s,i){return"T"+i});var n=[];this.variableNames.forEach(function(s){n.push("vec4 v"+s+" = get"+s+"AtOutCoords();")});var r=this.variableNames.map(function(s){return"v"+s}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},eT=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,s=e.batchSize,i=e.inSize,o=Math.ceil(i/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[s,o];var l=t==="max"?">":"<",c=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+c+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+l+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function BN(e,t){return["x","y","z","w","u","v"].slice(0,t).map(function(n){return e+"."+n})}function Cn(e,t){return t===1?[e]:BN(e,t)}function un(){var e,t,n,r,s,i,o,l,c,u;return ee().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",s="texture",i="outputColor",o="out vec4 outputColor;",l=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,c="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",s="texture2D",i="gl_FragColor",o="",l=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,c=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:s,output:i,defineOutput:o,defineSpecialNaN:l,defineSpecialInf:c,defineRound:u}}function _s(e,t,n){n===void 0&&(n="index");var r=Wr(t);return r.map(function(s,i){return"int "+e[i]+" = "+n+" / "+s+"; "+(i===r.length-1?"int "+e[i+1]+" = "+n+" - "+e[i]+" * "+s:"index -= "+e[i]+" * "+s)+";"}).join("")}function Um(e){var t=Wr(e).map(function(n){return n.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var $N=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function tT(e,t,n,r){var s=[];e.forEach(function(f){var x=je(f.shapeInfo.logicalShape);f.shapeInfo.isUniform?s.push("uniform float "+f.name+(x>1?"["+x+"]":"")+";"):(s.push("uniform sampler2D "+f.name+";"),s.push("uniform int offset"+f.name+";"))});var i,o,l=s.join(`
`),c=e.map(function(f){return function(x,v,y){y===void 0&&(y=!1);var m="";m+=y?zN(x):li(x);var g=x.shapeInfo.logicalShape,b=v.logicalShape;return g.length<=b.length&&(m+=y?function(w,N){var C,D=w.name,j=D.charAt(0).toUpperCase()+D.slice(1),k="get"+j+"AtOutCoords",R=w.shapeInfo.logicalShape.length,E=N.logicalShape.length,P=za(w.shapeInfo.logicalShape,N.logicalShape),F=it(E),W=E-R,L=["x","y","z","w","u","v"];C=R===0?"":E<2&&P.length>=1?"coords = 0;":P.map(function(te){return"coords."+L[te+W]+" = 0;"}).join(`
`);var U="";U=E<2&&R>0?"coords":w.shapeInfo.logicalShape.map(function(te,ce){return"coords."+L[ce+W]}).join(", ");var _="return outputValue;",B=je(w.shapeInfo.logicalShape)===1,O=je(N.logicalShape)===1;if(R!==1||B||O){if(B&&!O)_=E===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(P.length){var H=R-2,J=R-1;P.indexOf(H)>-1&&P.indexOf(J)>-1?_="return vec4(outputValue.x);":P.indexOf(H)>-1?_="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":P.indexOf(J)>-1&&(_="return vec4(outputValue.xx, outputValue.zz);")}}else _=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+k+`() {
      `+F+` coords = getOutputCoords();
      `+C+`
      vec4 outputValue = get`+j+"("+U+`);
      `+_+`
    }
  `}(x,v):function(w,N){var C=w.name,D=C.charAt(0).toUpperCase()+C.slice(1),j="get"+D+"AtOutCoords",k=N.texShape,R=w.shapeInfo.texShape,E=w.shapeInfo.logicalShape.length,P=N.logicalShape.length;if(!w.shapeInfo.isUniform&&E===P&&w.shapeInfo.flatOffset==null&&Xt(R,k))return`
      float `+j+`() {
        return sampleTexture(`+C+`, resultUV);
      }
    `;var F,W=it(P),L=za(w.shapeInfo.logicalShape,N.logicalShape),U=P-E,_=["x","y","z","w","u","v"];F=E===0?"":P<2&&L.length>=1?"coords = 0;":L.map(function(O){return"coords."+_[O+U]+" = 0;"}).join(`
`);var B="";return B=P<2&&E>0?"coords":w.shapeInfo.logicalShape.map(function(O,H){return"coords."+_[H+U]}).join(", "),`
    float `+j+`() {
      `+W+` coords = getOutputCoords();
      `+F+`
      return get`+D+"("+B+`);
    }
  `}(x,v)),m}(f,t,r)}).join(`
`),u=t.texShape,d=un(),h=function(f){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+f.texture2D+`(textureSampler, uv).r;
    }
  `}(d),p=function(f){return f.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+f.varyingFs+` vec2 resultUV;
    `+f.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+f.defineSpecialNaN+`
    `+f.defineSpecialInf+`
    `+f.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+nT+`
    `+rT+`
    `+aT+`
  `}(d);return t.isPacked?(i=function(f,x){switch(f.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(w,N){var C=[Math.ceil(N[0]/2),Math.ceil(N[1]/2)];return C[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+C[1]+`.0);
      }
    `:C[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+C[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+C[0]+", "+C[1]+`));
      return 2 * (resTexRC.x * `+C[1]+` + resTexRC.y);
    }
  `}(0,x);case 2:return function(w,N){var C=[Math.ceil(N[0]/2),Math.ceil(N[1]/2)];if(Xt(w,N))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+C[0]+", "+C[1]+`));
      }
    `;var D=Math.ceil(w[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+C[0]+", "+C[1]+`));

      int index = resTexRC.x * `+C[1]+` + resTexRC.y;
      int r = 2 * (index / `+D+`);
      int c = imod(index, `+D+`) * 2;

      return ivec2(r, c);
    }
  `}(f,x);case 3:return v=f,y=x,m=[Math.ceil(y[0]/2),Math.ceil(y[1]/2)],g=Math.ceil(v[2]/2),b=g*Math.ceil(v[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+m[0]+", "+m[1]+`));
      int index = resTexRC.x * `+m[1]+` + resTexRC.y;

      int b = index / `+b+`;
      index -= b * `+b+`;

      int r = 2 * (index / `+g+`);
      int c = imod(index, `+g+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(w,N){for(var C=[Math.ceil(N[0]/2),Math.ceil(N[1]/2)],D=Math.ceil(w[w.length-1]/2),j=D*Math.ceil(w[w.length-2]/2),k=j,R="",E="b, r, c",P=2;P<w.length-1;P++)k*=w[w.length-P-1],R=`
      int b`+P+" = index / "+k+`;
      index -= b`+P+" * "+k+`;
    `+R,E="b"+P+", "+E;return`
    ivec`+w.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+C[0]+", "+C[1]+`));
      int index = resTexRC.x * `+C[1]+` + resTexRC.y;

      `+R+`

      int b = index / `+j+`;
      index -= b * `+j+`;

      int r = 2 * (index / `+D+`);
      int c = imod(index, `+D+`) * 2;

      return ivec`+w.length+"("+E+`);
    }
  `}(f,x)}var v,y,m,g,b}(t.logicalShape,u),o=function(f){return`
    void setOutput(vec4 val) {
      `+f.output+` = val;
    }
  `}(d)):(i=function(f,x){switch(f.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(m,g){return g[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+g[1]+`.0);
      }
    `:g[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+g[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+g[0]+", "+g[1]+`));
      return resTexRC.x * `+g[1]+` + resTexRC.y;
    }
  `}(0,x);case 2:return function(m,g){return Xt(m,g)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+g[0]+", "+g[1]+`));
      }
    `:m[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+g[0]+", "+g[1]+`));
        int index = resTexRC.x * `+g[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:m[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+g[0]+", "+g[1]+`));
        int index = resTexRC.x * `+g[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+g[0]+", "+g[1]+`));
      int index = resTexRC.x * `+g[1]+` + resTexRC.y;
      int r = index / `+m[1]+`;
      int c = index - r * `+m[1]+`;
      return ivec2(r, c);
    }
  `}(f,x);case 3:return v=x,y=_s(["r","c","d"],f),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+v[0]+", "+v[1]+`));
      int index = resTexRC.x * `+v[1]+` + resTexRC.y;
      `+y+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(m,g){var b=_s(["r","c","d","d2"],m);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+g[0]+", "+g[1]+`));
      int index = resTexRC.x * `+g[1]+` + resTexRC.y;
      `+b+`
      return ivec4(r, c, d, d2);
    }
  `}(f,x);case 5:return function(m,g){var b=_s(["r","c","d","d2","d3"],m);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+g[0]+`,
                             `+g[1]+`));

      int index = resTexRC.x * `+g[1]+` + resTexRC.y;

      `+b+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(f,x);case 6:return function(m,g){var b=_s(["r","c","d","d2","d3","d4"],m);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+g[0]+", "+g[1]+`));
      int index = resTexRC.x * `+g[1]+` + resTexRC.y;

      `+b+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(f,x);default:throw new Error(f.length+"-D output sampling is not yet supported")}var v,y}(t.logicalShape,u),o=function(f){return`
    void setOutput(float val) {
      `+f.output+` = vec4(val, 0, 0, 0);
    }
  `}(d)),r&&(p+=sT),[p,h,o,l,i,c,n].join(`
`)}function li(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(n){var r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return"float "+s+"() {return "+r+";}";var i=n.shapeInfo.texShape,o=i[0],l=i[1];if(o===1&&l===1)return`
      float `+s+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var c=n.shapeInfo.texShape,u=c[0],d=c[1],h=ys(r);return`
    float `+s+`() {
      vec2 uv = uvFromFlat(`+u+", "+d+", "+h+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 1:return function(n){var r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return`
      float `+s+`(int index) {
        `+ai(n)+`
      }
    `;var i=n.shapeInfo.texShape,o=i[0],l=i[1];if(l===1&&o===1)return`
      float `+s+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var c=ys(r);return l===1?`
      float `+s+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+c+") + 0.5) / "+o+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:o===1?`
      float `+s+`(int index) {
        vec2 uv = vec2((float(index + `+c+") + 0.5) / "+l+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+s+`(int index) {
      vec2 uv = uvFromFlat(`+o+", "+l+", index + "+c+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 2:return function(n){var r=n.shapeInfo.logicalShape,s=n.name,i="get"+s.charAt(0).toUpperCase()+s.slice(1),o=n.shapeInfo.texShape;if(o!=null&&Xt(r,o)){var l=o[0],c=o[1];return`
    float `+i+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+l+`.0);
      return sampleTexture(`+s+`, uv);
    }
  `}var u=ks(r),d=u.newShape,h=u.keptDims,p=d;if(p.length<r.length){var f=ci(n,p);return`
      `+li(f)+`
      float `+i+`(int row, int col) {
        return `+i+"("+ui(["row","col"],h)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+ai(n)+`
      }
    `;var x=o[0],v=o[1],y=ys(s);return v===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+y+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+x+`.0);
      return sampleTexture(`+s+`, uv);
    }
  `:x===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+y+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+v+`.0, 0.5);
      return sampleTexture(`+s+`, uv);
    }
  `:`
  float `+i+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+y+`;
    vec2 uv = uvFromFlat(`+x+", "+v+`, index);
    return sampleTexture(`+s+`, uv);
  }
`}(e);case 3:return function(n){var r=n.shapeInfo.logicalShape,s=n.name,i="get"+s.charAt(0).toUpperCase()+s.slice(1),o=r[1]*r[2],l=r[2],c=ks(r),u=c.newShape,d=c.keptDims,h=u;if(h.length<r.length){var p=ci(n,h);return`
        `+li(p)+`
        float `+i+`(int row, int col, int depth) {
          return `+i+"("+ui(["row","col","depth"],d)+`);
        }
      `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+o+", "+l+`, 1)));
        `+ai(n)+`
      }
    `;var f=n.shapeInfo.texShape,x=f[0],v=f[1],y=n.shapeInfo.flatOffset;if(v===o&&y==null)return`
        float `+i+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+l+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+v+".0, "+x+`.0);
          return sampleTexture(`+s+`, uv);
        }
      `;if(v===l&&y==null)return`
    float `+i+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+v+".0, "+x+`.0);
      return sampleTexture(`+s+`, uv);
    }
  `;var m=ys(s);return`
      float `+i+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+o+" + col * "+l+" + depth + "+m+`;
        vec2 uv = uvFromFlat(`+x+", "+v+`, index);
        return sampleTexture(`+s+`, uv);
      }
  `}(e);case 4:return function(n){var r=n.shapeInfo.logicalShape,s=n.name,i="get"+s.charAt(0).toUpperCase()+s.slice(1),o=r[3],l=r[2]*o,c=r[1]*l,u=ks(r),d=u.newShape,h=u.keptDims;if(d.length<r.length){var p=ci(n,d);return`
      `+li(p)+`
      float `+i+`(int row, int col, int depth, int depth2) {
        return `+i+"("+ui(["row","col","depth","depth2"],h)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+c+", "+l+", "+o+`, 1)));
        `+ai(n)+`
      }
    `;var f=n.shapeInfo.flatOffset,x=n.shapeInfo.texShape,v=x[0],y=x[1];if(y===c&&f==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+l+", "+o+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+s+`, uv);
      }
    `;if(y===o&&f==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+s+`, uv);
      }
    `;var m=ys(s);return`
    float `+i+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+c+" + col * "+l+` +
          depth * `+o+` + depth2;
      vec2 uv = uvFromFlat(`+v+", "+y+", index + "+m+`);
      return sampleTexture(`+s+`, uv);
    }
  `}(e);case 5:return function(n){var r=n.shapeInfo.logicalShape,s=n.name,i="get"+s.charAt(0).toUpperCase()+s.slice(1),o=r[4],l=r[3]*o,c=r[2]*l,u=r[1]*c,d=ks(r),h=d.newShape,p=d.keptDims;if(h.length<r.length){var f=ci(n,h);return`
      `+li(f)+`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        return `+i+"("+ui(["row","col","depth","depth2","depth3"],p)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+u+", "+c+", "+l+", "+o+`)) +
          depth3;
        `+ai(n)+`
      }
    `;var x=n.shapeInfo.flatOffset,v=n.shapeInfo.texShape,y=v[0],m=v[1];if(m===u&&x==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+c+", "+l+", "+o+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+m+".0, "+y+`.0);
        return sampleTexture(`+s+`, uv);
      }
    `;if(m===o&&x==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+m+".0, "+y+`.0);
        return sampleTexture(`+s+`, uv);
      }
    `;var g=ys(s);return`
    float `+i+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+c+" + depth * "+l+` +
          depth2 * `+o+" + depth3 + "+g+`;
      vec2 uv = uvFromFlat(`+y+", "+m+`, index);
      return sampleTexture(`+s+`, uv);
    }
  `}(e);case 6:return function(n){var r=n.shapeInfo.logicalShape,s=n.name,i="get"+s.charAt(0).toUpperCase()+s.slice(1),o=ks(r),l=o.newShape,c=o.keptDims;if(l.length<r.length){var u=ci(n,l);return`
      `+li(u)+`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+i+"("+ui(["row","col","depth","depth2","depth3","depth4"],c)+`);
      }
    `}var d=r[5],h=r[4]*d,p=r[3]*h,f=r[2]*p,x=r[1]*f;if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+x+", "+f+", "+p+", "+h+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+d+`, 1)));
        `+ai(n)+`
      }
    `;var v=n.shapeInfo.flatOffset,y=n.shapeInfo.texShape,m=y[0],g=y[1];if(g===x&&v==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+f+", "+p+", "+h+", "+d+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+g+".0, "+m+`.0);
        return sampleTexture(`+s+`, uv);
      }
    `;if(g===d&&v==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+g+".0, "+m+`.0);
        return sampleTexture(`+s+`, uv);
      }
    `;var b=ys(s);return`
    float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+x+" + col * "+f+" + depth * "+p+` +
          depth2 * `+h+" + depth3 * "+d+" + depth4 + "+b+`;
      vec2 uv = uvFromFlat(`+m+", "+g+`, index);
      return sampleTexture(`+s+`, uv);
    }
  `}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function zN(e){var t,n,r;switch(e.shapeInfo.logicalShape.length){case 0:return t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=un(),`
    vec4 `+n+`() {
      return `+r.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(s){var i=s.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),l=s.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],u=un();return`
    vec4 `+o+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+c[0]+", "+c[1]+`, index);
      return `+u.texture2D+"("+i+`, uv);
    }
  `}(e);case 2:return function(s){var i=s.shapeInfo.logicalShape,o=s.name,l="get"+o.charAt(0).toUpperCase()+o.slice(1),c=s.shapeInfo.texShape,u=c[0],d=c[1],h=un();if(c!=null&&Xt(i,c))return`
      vec4 `+l+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+d+".0, "+u+`.0);

        return `+h.texture2D+"("+o+`, uv);
      }
    `;var p=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)],f=Math.ceil(i[1]/2);return`
    vec4 `+l+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+f+", "+p[0]+", "+p[1]+`, row, col);
      return `+h.texture2D+"("+o+`, uv);
    }
  `}(e);case 3:return function(s){var i=s.shapeInfo.logicalShape,o=s.name,l="get"+o.charAt(0).toUpperCase()+o.slice(1),c=s.shapeInfo.texShape,u=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)];if(i[0]===1){var d=i.slice(1),h=ci(s,d);return`
        `+zN(h)+`
        vec4 `+l+`(int b, int row, int col) {
          return `+l+"("+ui(["b","row","col"],[1,2])+`);
        }
      `}var p=u[0],f=u[1],x=Math.ceil(i[2]/2),v=x*Math.ceil(i[1]/2),y=un();return`
    vec4 `+l+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+p+", "+f+", "+v+", "+x+`, b, row, col);
      return `+y.texture2D+"("+o+`, uv);
    }
  `}(e);default:return function(s){for(var i=s.shapeInfo.logicalShape,o=i.length,l=s.name,c="get"+l.charAt(0).toUpperCase()+l.slice(1),u=s.shapeInfo.texShape,d=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],h=d[0],p=d[1],f=Math.ceil(i[o-1]/2),x=f*Math.ceil(i[o-2]/2),v="int b, int row, int col",y="b * "+x+" + (row / 2) * "+f+" + (col / 2)",m=2;m<o-1;m++)v="int b"+m+", "+v,x*=i[o-m-1],y="b"+m+" * "+x+" + "+y;var g=un();return`
    vec4 `+c+"("+v+`) {
      int index = `+y+`;
      int texR = index / `+p+`;
      int texC = index - texR * `+p+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+p+", "+h+`);
      return `+g.texture2D+"("+l+`, uv);
    }
  `}(e)}}var nT=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,rT=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,aT=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,sT=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function ys(e){return"offset"+e}function ai(e){var t=e.name,n=je(e.shapeInfo.logicalShape);return n<2?"return "+t+";":`
    for (int i = 0; i < `+n+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function it(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function ci(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function ui(e,t){return t.map(function(n){return e[n]}).join(", ")}var iT=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,M(e.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var s=e[e.length-1],i=Math.ceil(s/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var o,l,c=this.outputShape,u=c.length,d=it(u),h=Cn("coords",u);if(i===1){var p=it(l=u+1);o=`
        `+p+" sourceLocR = "+p+"("+h.join()+`, 0);
        ++`+h[u-1]+`;
        `+p+" sourceLocG = "+p+"("+h.join()+`, 0);
        ++`+h[u-2]+`;
        `+p+" sourceLocA = "+p+"("+h.join()+`, 0);
        --`+h[u-1]+`;
        `+p+" sourceLocB = "+p+"("+h.join()+`, 0);
        --`+h[u-2]+";"}else l=u,o=`
        `+d+` sourceLocR = coords;
        ++`+h[u-1]+`;
        `+d+` sourceLocG = coords;
        ++`+h[u-2]+`;
        `+d+` sourceLocA = coords;
        --`+h[u-1]+`;
        `+d+` sourceLocB = coords;
        --`+h[u-2]+";";var f=["x","y","z","w","u","v"].slice(0,l),x="."+f[l-1],v=f.map(function(j){return"int "+j}),y=Cn("sourceLocR",l-1).concat("inIdx.r"),m=Cn("sourceLocG",l-1).concat("inIdx.g"),g=Cn("sourceLocB",l-1).concat("inIdx.b"),b=Cn("sourceLocA",l-1).concat("inIdx.a"),w=n==="max"?"greaterThan":"lessThan",N=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+y.join()+`),
                             getBestIndicesAChannel(`+m.join()+`),
                             getBestIndicesAChannel(`+g.join()+`),
                             getBestIndicesAChannel(`+b.join()+")));",C=`vec4(
            getAChannel(`+y.join()+`),
            hasNextCol ? getAChannel(`+m.join()+`) : 0.,
            hasNextRow ? getAChannel(`+g.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+b.join()+") : 0.)",D=r?"":`
      float getBestIndicesAChannel(`+v.join()+`) {
        return getChannel(getBestIndicesA(`+f.join()+`),
                                          vec2(`+f.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+v.join()+`) {
        return getChannel(getA(`+f.join()+`),
                               vec2(`+f.slice(-2).join()+`));
      }
      `+D+`
      void main() {
        `+d+` coords = getOutputCoords();
        bool hasNextCol = `+h[u-1]+" < "+(c[u-1]-1)+`;
        bool hasNextRow = `+h[u-2]+" < "+(c[u-2]-1)+`;
        `+o+`
        ivec4 srcIdx = ivec4(sourceLocR`+x+", sourceLocG"+x+`,
          sourceLocB`+x+", sourceLocA"+x+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+C+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+N+`
          vec4 candidate = `+C+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+w+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},oT=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,s=e.strideWidth,i=e.dilationHeight,o=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=l-1-e.padInfo.top,d=c-1-e.padInfo.left,h=1/(t*n);this.userCode=`
      const ivec2 pads = ivec2(`+u+", "+d+`);
      const float avgMultiplier = float(`+h+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+l+`;
            wR += `+i+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+c+`;
            wC+= `+o+`) {
            float dyC = float(dyCCorner + wC) / `+s+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},lT=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,s=e.strideDepth,i=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=d-1-e.padInfo.front,x=h-1-e.padInfo.top,v=p-1-e.padInfo.left,y=1/(t*n*r);this.userCode=`
      const ivec3 pads = ivec3(`+f+", "+x+", "+v+`);
      const float avgMultiplier = float(`+y+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+l+`) {
          float dyD = float(dyDCorner + wD) / `+s+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+h+`;
              wR += `+c+`) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+p+`;
                wC += `+u+`) {
              float dyC = float(dyCCorner + wC) / `+o+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},cT=function(e,t,n,r,s,i){this.outputShape=[],this.variableNames=["x","mean","variance"],He(e,t),He(e,n);var o="0.0";r!=null&&(He(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var l="1.0";s!=null&&(He(e,s),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+o+`;
        float scale = `+l+`;
        float inv = scale * inversesqrt(variance + float(`+i+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},uT=function(e,t,n,r,s,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],He(e,t),He(e,n);var o="vec4(0.0)";r!=null&&(He(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var l="vec4(1.0)";s!=null&&(He(e,s),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = `+o+`;
        vec4 scale = `+l+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+i+`));

        setOutput((x - mean) * inv + offset);
      }
    `},dT="return areal * breal - aimag * bimag;",hT="return areal * bimag + aimag * breal;",Hy=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=He(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+e+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},jh="return a + b;",Ch="return a - b;",qy="return a * b;",UN="return (a < 0.) ? b * a : a;",wt=function(e,t,n){this.variableNames=["A","B"],this.outputShape=He(t,n),this.userCode=`
      float binaryOperation(float a, float b) {
        `+e+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},WN=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,na=function(e,t,n,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=He(t,n);var s=this.outputShape.length,i="";if(r)if(s===0||je(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          `+it(s)+` coords = getOutputCoords();
        `,s===1)i+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var o=Cn("coords",s);i+=`
            bool nextRowOutOfBounds =
              (`+o[s-2]+" + 1) >= "+this.outputShape[s-2]+`;
            bool nextColOutOfBounds =
              (`+o[s-1]+" + 1) >= "+this.outputShape[s-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+e+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+i+`

        setOutput(result);
      }
    `},pT=function(){function e(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(s,i){r.minLoc==null&&(r.minLoc=s.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=s.getUniformLocationNoThrow(i,"maxVal")),s.gl.uniform1f(r.minLoc,t),s.gl.uniform1f(r.maxLoc,n)}},e}(),fT=function(){function e(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(s,i){r.minLoc==null&&(r.minLoc=s.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=s.getUniformLocationNoThrow(i,"maxVal")),s.gl.uniform1f(r.minLoc,t),s.gl.uniform1f(r.maxLoc,n)}},e}(),mT=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},xT=function(e){this.outputShape=[],this.outputShape=Zi(e,1),this.variableNames=e.map(function(l,c){return"T"+c});var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var s=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+s+"));")}var i=t.length,o=t[t.length-1];r.push("else setOutput(getT"+i+"(yR, yC-"+o+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},gT=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Zi(e,t);var n=this.outputShape,r=n.length,s=it(r),i=Cn("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(function(y,m){return"T"+m});var l=new Array(e.length-1);l[0]=e[0][t];for(var c=1;c<l.length;c++)l[c]=l[c-1]+e[c][t];var u=o[t],d=o.slice(-2),h=o.join(),p="if ("+u+" < "+l[0]+`) {
        return getChannel(
            getT0(`+h+"), vec2("+d.join()+`));
        }`;for(c=1;c<l.length;c++){var f=l[c-1];p+=`
        if (`+u+" < "+l[c]+"  && "+u+" >= "+l[c-1]+`) {
          return getChannel(
            getT`+c+"("+dc(o,u,f)+`),
            vec2(`+dc(d,u,f)+`));
        }`}var x=l.length,v=l[l.length-1];p+=`
        return getChannel(
          getT`+x+"("+dc(o,u,v)+`),
          vec2(`+dc(d,u,v)+"));",this.userCode=`
      float getValue(`+o.map(function(y){return"int "+y})+`) {
        `+p+`
      }

      void main() {
        `+s+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+i+`), 0., 0., 0.);

        `+i[r-1]+" = "+i[r-1]+` + 1;
        if (`+i[r-1]+" < "+n[r-1]+`) {
          result.g = getValue(`+i+`);
        }

        `+i[r-2]+" = "+i[r-2]+` + 1;
        if (`+i[r-2]+" < "+n[r-2]+`) {
          result.a = getValue(`+i+`);
        }

        `+i[r-1]+" = "+i[r-1]+` - 1;
        if (`+i[r-2]+" < "+n[r-2]+` &&
            `+i[r-1]+" < "+n[r-1]+`) {
          result.b = getValue(`+i+`);
        }
        setOutput(result);
      }
    `};function dc(e,t,n){var r=e.indexOf(t);return e.map(function(s,i){return i===r?s+" - "+n:s}).join()}var vT=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,s=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+s+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              if (`+i+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},yT=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,s=e.strideWidth,i=e.dataFormat==="channelsLast",o=t-1-e.padInfo.top,l=n-1-e.padInfo.left,c=i?1:2,u=i?2:3,d=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+d+`];

        ivec2 dyCorner = ivec2(coords[`+c+"], coords["+u+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+s+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {

              if (`+i+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},bT=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,s=e.padInfo.front,i=e.padInfo.top,o=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yF = 0; yF < `+e.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+s+`;

            if (xF < 0 || xF >= `+e.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+e.outHeight+`; yR++) {
              int xR = wR + yR * `+n+" - "+i+`;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+e.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+o+`;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},wT=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,s=e.strideDepth,i=e.strideHeight,o=e.strideWidth,l=t-1-e.padInfo.front,c=n-1-e.padInfo.top,u=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+l+", "+c+", "+u+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+s+`.0;

          if (dyF < 0.0 || dyF >= `+e.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+n+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+n+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+o+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},NT=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,s=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+i+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+s+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},jT=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,s=e.strideWidth,i=t-1-e.padInfo.top,o=n-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+s+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+l+`; dm++) {
              int d2 = d1 * `+l+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Gy=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var s=e.padInfo.top,i=e.padInfo.left,o=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,p=4*Math.floor(e.inChannels/4),f=e.inChannels%4,x=e.dataFormat==="channelsLast",v=x?1:2,y=x?2:3,m=x?3:1,g="",b="";n&&(g=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,b="result = activation(result);");var w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+g+`

      const ivec2 strides = ivec2(`+o+", "+l+`);
      const ivec2 pads = ivec2(`+s+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+m+`];

        ivec2 xRCCorner =
            ivec2(coords[`+v+"], coords["+y+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+d+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+h+`; wC++) {
            int xC = xCCorner + wC * `+u+`;

            if (xC < 0 || xC >= `+e.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+p+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+x+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(f===1)+`) {

              if (`+x+`) {
                dotProd +=
                    getX(batch, xR, xC, `+p+`) *
                    getW(wR, wC, `+p+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+p+`, xR, xC) *
                    getW(wR, wC, `+p+`, d2);
              }

            } else if (`+(f===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+p+`, d2),
                getW(wR, wC, `+p+` + 1, d2)
              );

              if (`+x+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+p+`),
                  getX(batch, xR, xC, `+p+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+p+`, xR, xC),
                  getX(batch, `+p+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(f===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+p+`, d2),
                getW(wR, wC, `+p+` + 1, d2),
                getW(wR, wC, `+p+` + 2, d2)
              );

              if (`+x+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+p+`),
                  getX(batch, xR, xC, `+p+` + 1),
                  getX(batch, xR, xC, `+p+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+p+`, xR, xC),
                  getX(batch, `+p+` + 1, xR, xC),
                  getX(batch, `+p+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+w+`
        `+b+`
        setOutput(result);
      }
    `},CT=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,s=e.strideDepth,i=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.filterDepth,h=e.filterHeight,p=e.filterWidth,f=4*Math.floor(e.inChannels/4),x=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+s+", "+i+", "+o+`);
      const ivec3 pads = ivec3(`+t+", "+n+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+d+`; wF++) {
          int xF = xFCorner + wF * `+l+`;

          if (xF < 0 || xF >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+h+`; wR++) {
            int xR = xRCorner + wR * `+c+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+p+`; wC++) {
              int xC = xCCorner + wC * `+u+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+f+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(x===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+f+`) *
                  getW(wF, wR, wC, `+f+`, d2);
              } else if (`+(x===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+f+`),
                  getX(batch, xF, xR, xC, `+f+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+f+`, d2),
                  getW(wF, wR, wC, `+f+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(x===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+f+`),
                  getX(batch, xF, xR, xC, `+f+` + 1),
                  getX(batch, xF, xR, xC, `+f+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+f+`, d2),
                  getW(wF, wR, wC, `+f+` + 1, d2),
                  getW(wF, wR, wC, `+f+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},Ky=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var s=e.inHeight,i=e.inWidth,o=e.padInfo.top,l=e.padInfo.left,c=e.strideHeight,u=e.strideWidth,d=e.dilationHeight,h=e.dilationWidth,p=e.filterHeight,f=e.filterWidth,x=e.outChannels/e.inChannels,v="",y="";n&&(v=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,y="result = activation(result);");var m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+v+`

      const ivec2 strides = ivec2(`+c+", "+u+`);
      const ivec2 pads = ivec2(`+o+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+x+`;
        int q = d2 - d1 * `+x+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+p+`; wR++) {
          int xR = xRCorner + wR * `+d+`;

          if (xR < 0 || xR >= `+s+`) {
            continue;
          }

          for (int wC = 0; wC < `+f+`; wC++) {
            int xC = xCCorner + wC * `+h+`;

            if (xC < 0 || xC >= `+i+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+m+`
        `+y+`
        setOutput(result);
      }
    `},Xy=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var s=e.inHeight,i=e.inWidth,o=e.padInfo.top,l=e.padInfo.left,c=e.strideHeight,u=e.strideWidth,d=e.dilationHeight,h=e.dilationWidth,p=e.filterHeight,f=e.filterWidth,x=f,v="int xR; int xC; int xCOffset;",y=0;y<p;y++)for(var m=0;m<f;m++)v+=`
          vec4 xTexelR`+y+"C"+2*m+` = vec4(0.);
          vec4 wR`+y+"C"+m+` = vec4(0.);
          vec4 xR`+y+"C"+m+" = vec4(0.);";for(y=0;y<p;y++)for(var g=0;g<x;g++){if(v+=`
          xR = xRCorner + `+y*d+`;
          xC = xCCorner + `+(m=2*g)*h+`;
        `,u===1){if(m<f&&(v+=l%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+s+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  xTexelR`+y+"C"+m+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    xTexelR`+y+"C"+m+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+y+"C"+m+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+s+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+y+"C"+m+" = vec4(previous.zw, xTexelR"+y+"C"+m+`.xy);
                } else {
                  xR`+y+"C"+m+" = vec4(0, 0, xTexelR"+y+"C"+m+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+s+" && xC >= 0 && xC < "+i+`) {
                  xTexelR`+y+"C"+m+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+y+"C"+m+` = vec4(0.);
                }

                xR`+y+"C"+m+" = xTexelR"+y+"C"+m+`;
              `,m+1<f)){var b=l%2==0?oN(h):h;h%2==0&&l%2==1||h%2!=0&&l%2!=1?(v+=`
                  xCOffset = xC + `+l%2+" + "+b+`;

                  if(xR >= 0 && xR < `+s+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+y+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,h>1&&(v+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+s+` &&
                      xCOffset >= 0 && xCOffset < `+i+`) {
                      xTexelR`+y+"C"+m+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+y+"C"+m+` = vec4(0.);
                    }
                  `),v+=`
                  xR`+y+"C"+(m+1)+` = vec4(
                    xTexelR`+y+"C"+m+".zw, xTexelR"+y+"C"+(m+2)+`.xy);
                `):v+=`
                  xCOffset = xC + `+b+`;

                  if(xR >= 0 && xR < `+s+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+y+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+y+"C"+(m+1)+" = xTexelR"+y+"C"+(m+2)+`;
                `}}else m<f&&(v+=`
              if(xR >= 0 && xR < `+s+`) {
            `,l%2==1?(v+=`
                xCOffset = xC + 1 - `+u+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+y+"C"+m+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+y+"C"+m+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+i+`) {
                  xTexelR`+y+"C"+(m+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+y+"C"+(m+2)+` = vec4(0.);
                }

                xR`+y+"C"+m+` = vec4(
                  xTexelR`+y+"C"+m+".zw, xTexelR"+y+"C"+(m+2)+`.zw);
              `,m+1<f&&(v+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+u+`;
                  if(xCOffset >= 0 && xCOffset < `+i+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+y+"C"+(m+1)+" = vec4(xTexelR"+y+"C"+(m+2)+`.xy, final.xy);
                `)):(v+=`
                if(xC >= 0 && xC < `+i+`) {
                  xTexelR`+y+"C"+m+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+y+"C"+m+` = vec4(0.);
                }

                xCOffset = xC + `+u+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+y+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+y+"C"+(m+2)+` = vec4(0.);
                }

                xR`+y+"C"+m+` = vec4(
                  xTexelR`+y+"C"+m+".xy, xTexelR"+y+"C"+(m+2)+`.xy);
              `,m+1<f&&(v+=`
                  xR`+y+"C"+(m+1)+` = vec4(
                    xTexelR`+y+"C"+m+".zw, xTexelR"+y+"C"+(m+2)+`.zw);
                `)),v+="}");m<f&&(v+=`
            vec4 wTexelR`+y+"C"+m+" = getW("+y+", "+m+`, d1, q);
            wR`+y+"C"+m+" = vec4(wTexelR"+y+"C"+m+".xz, wTexelR"+y+"C"+m+`.xz);
          `,m+1<f&&(v+=`
              vec4 wTexelR`+y+"C"+(m+1)+" = getW("+y+", "+(m+1)+`, d1, q);
              wR`+y+"C"+(m+1)+` =
                vec4(wTexelR`+y+"C"+(m+1)+".xz, wTexelR"+y+"C"+(m+1)+".xz);"))}for(y=0;y<p;y++)for(m=0;m<f;m++)v+="dotProd += xR"+y+"C"+m+" * wR"+y+"C"+m+";";var w="",N="";n&&(w=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`vec4 activation(vec4 x) {
          `+n+`
        }`,N="result = activation(result);");var C=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+w+`

      const ivec2 strides = ivec2(`+c+", "+u+`);
      const ivec2 pads = ivec2(`+o+", "+l+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+v+`

        vec4 result = dotProd;
        `+C+`
        `+N+`
        setOutput(result);
      }
    `},kT=function(e,t,n,r,s){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=e[0],o=e[1],l=e[2],c=e[3],u=t[0],d=n[0],h=n[1];this.outputShape=[u,d,h,c];var p=r==="bilinear"?1:0,f=[o-1+".0",l-1+".0"],x=f[0],v=f[1],y=d>1?[""+(o-1)/(d-1),"(y2-y1) * height_ratio","y1*"+x+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+x],m=y[0],g=y[1],b=y[2],w=h>1?[""+(l-1)/(h-1),"(x2-x1) * width_ratio","x1*"+v+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+v],N=w[0],C=w[1],D=w[2];this.userCode=`
      const float height_ratio = float(`+m+`);
      const float width_ratio = float(`+N+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+i+`) {
          return;
        }

        float height_scale = `+g+`;
        float width_scale = `+C+`;

        float in_y = `+b+`;
        if( in_y < 0.0 || in_y > `+x+` ) {
          setOutput(float(`+s+`));
          return;
        }
        float in_x = `+D+`;
        if( in_x < 0.0 || in_x > `+v+` ) {
          setOutput(float(`+s+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+p+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},ST=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,s=e[e.length-1],i=n?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(n?"return "+s+" -i - 1;":"return i;")+`
      }

      void main() {
        `+it(r)+` coords = getOutputCoords();
        int end = `+Yy(r,"coords")+`;
        float val = 0.0;
        for (int i = `+s+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+i+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+Yy(r,"coords")+` = idx;
          val += getX(`+function(o,l){if(o===1)return""+l;if(o===2)return l+".x, "+l+".y";if(o===3)return l+".x, "+l+".y, "+l+".z";if(o===4)return l+".x, "+l+".y, "+l+".z, "+l+".w";throw Error("Cumulative sum for rank "+o+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function Yy(e,t){if(e===1)return""+t;if(e===2)return t+".y";if(e===3)return t+".z";if(e===4)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var ET=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=hl.DENSE;var t=$o(e),n=un();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+_s(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+n.output+` = result;
      }
    `},DT=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=hl.DENSE;var t=$o(e),n=un();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+_s(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+n.output+` = result;
      }
    `},RT=function(){function e(t,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+n+`;
      int offset_h = imod(h, `+n+`);
      int in_w = w / `+n+`;
      int offset_w = imod(w, `+n+`);
      int offset_d = (offset_h * `+n+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return e.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),_T=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},TT=function(e){this.variableNames=["A"],this.outTexUsage=$n.DOWNLOAD;var t=un();this.outputShape=e,this.userCode=`
      `+$N+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},AT=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=$n.DOWNLOAD;var t=un();this.outputShape=e,this.userCode=`
      `+$N+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},IT=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"];var r=un(),s=t[0],i=t[1];this.outputShape=e;var o="result";n&&(o="floor(result * 255. + 0.5)"),this.userCode=`
      `+Um(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+i+`;
        int c = imod(flatIndex, `+i+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+s+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+o+`, 0., 0., 0.);
      }
    `},PT=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=un(),s=t[0],i=t[1];this.outputShape=e;var o="",l="result";n&&(l="floor(result * 255. + 0.5)");for(var c=0;c<=1;c++)for(var u=0;u<=1;u++){var d=2*c+u;o+=`
          localCoords = coords;
          if(localCoords[2] + `+u+" < "+e[2]+`) {
            localCoords[2] += `+u+`;
            if(localCoords[1] + `+c+" < "+e[1]+`) {
              localCoords[1] += `+c+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+i+`;
              c = imod(flatIndex, `+i+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+s+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+d+`] = values[0];
              } else if(offset == 1) {
                result[`+d+`] = values[1];
              } else if(offset == 2) {
                result[`+d+`] = values[2];
              } else {
                result[`+d+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+Um(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+o+`

        `+r.output+" = "+l+`;
      }
    `},FT="return real * expR - imag * expI;",MT="return real * expI + imag * expR;",Qy=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var s=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+s+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+e+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+i+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},LT=function(){function e(t,n){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,s){n.valueLoc==null&&(n.valueLoc=r.getUniformLocationNoThrow(s,"value")),r.gl.uniform1f(n.valueLoc,t)}},e}(),OT=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var s=it(this.rank),i=function(o,l){var c=o.length;if(c>4)throw Error("Gather for rank "+c+" is not yet supported");if(c===1)return"int(getIndices(resRC))";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w"],d=[],h=0;h<o.length;h++)h===l?d.push("int(getIndices("+u[h]+"))"):d.push(""+u[h]);return d.join()}(e,n);this.userCode=`
      void main() {
        `+s+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},BT=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=it(t.length),s=it(n.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+s+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+i+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function $T(e,t){var n=un();return FR(e,t,n.version+`
    precision highp float;
    `+n.attribute+` vec3 clipSpacePos;
    `+n.attribute+` vec2 uv;
    `+n.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function zT(e,t){return $R(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function UT(e,t){return zR(e,t,new Uint16Array([0,1,2,2,1,3]))}function Tl(e,t,n,r,s,i,o){WR(n,r);var l=UR(e,t),c=e.TEXTURE_2D;return ke(e,t,function(){return e.bindTexture(c,l)}),ke(e,t,function(){return e.texParameteri(c,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),ke(e,t,function(){return e.texParameteri(c,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),ke(e,t,function(){return e.texParameteri(c,e.TEXTURE_MIN_FILTER,e.NEAREST)}),ke(e,t,function(){return e.texParameteri(c,e.TEXTURE_MAG_FILTER,e.NEAREST)}),ke(e,t,function(){return e.texImage2D(c,0,s,n,r,0,i,o,null)}),ke(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)}),l}function WT(e,t,n,r,s){var i=xd(n,r);return Tl(e,t,i[0],i[1],s.internalFormatFloat,s.textureFormatFloat,e.FLOAT)}function VT(e,t,n,r,s){var i=xd(n,r);return Tl(e,t,i[0],i[1],s.internalFormatHalfFloat,s.textureFormatFloat,s.textureTypeHalfFloat)}function HT(e,t,n,r,s){var i=xd(n,r);return Tl(e,t,i[0],i[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function qT(e,t,n,r,s){var i=_l(n,r);return Tl(e,t,i[0],i[1],s.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function GT(e,t,n,r,s){var i=_l(n,r);return Tl(e,t,i[0],i[1],s.internalFormatPackedHalfFloat,e.RGBA,s.textureTypeHalfFloat)}function KT(e,t,n,r){return ke(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),Oy(e,t,n,"clipSpacePos",r,3,20,0)&&Oy(e,t,n,"uv",r,2,20,12)}function XT(e,t,n,r,s,i,o){var l,c,u;ke(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),i instanceof Uint8Array?(l=new Uint8Array(r*s*4),c=e.UNSIGNED_BYTE,u=e.RGBA):(l=new Float32Array(r*s*4),c=e.FLOAT,u=o.internalFormatPackedFloat),l.set(i),ke(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,u,r,s,0,e.RGBA,c,l)}),ke(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function YT(e,t,n,r){ke(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),r.data instanceof Uint8Array?ke(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)}):ke(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}),ke(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function QT(e,t,n,r,s){var i=e.createBuffer();ke(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,i)});var o=16*n*r;return ke(e,t,function(){return e.bufferData(e.PIXEL_PACK_BUFFER,o,e.STREAM_READ)}),ke(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)}),ke(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}),i}function JT(e,t,n){var r=e,s=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,s),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),s}function ZT(e,t,n,r,s){var i=xd(n,r),o=i[0],l=i[1],c=new Uint8Array(n*r*4);return ke(e,t,function(){return e.readPixels(0,0,o,l,s.downloadTextureFormat,e.UNSIGNED_BYTE,c)}),new Float32Array(c.buffer)}function eA(e,t,n,r,s,i,o,l){var c=e,u=new Float32Array(function(d,h){var p=_l(d,h);return p[0]*p[1]*4}(i,o));return c.bindBuffer(c.PIXEL_PACK_BUFFER,t),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,u),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),u}function tA(e,t,n,r){var s=new Float32Array(n*r*4);return ke(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,s)}),s}var nA=function(){function e(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=ee().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,_R(n,t)):this.gl=Kr(n);var r="WEBGL_color_buffer_float";if(ee().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=oc(this.gl,this.debug,"OES_texture_float"),tr(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=oc(this.gl,this.debug,"OES_texture_half_float");else if(ee().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),tr(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=oc(this.gl,this.debug,"EXT_color_buffer_half_float");else if(ee().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",tr(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!tr(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=zT(this.gl,this.debug),this.indexBuffer=UT(this.gl,this.debug),this.framebuffer=VR(this.gl,this.debug),this.textureConfig=Am(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return ee().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var n=this.gl;ke(n,this.debug,function(){return n.finish()}),ke(n,this.debug,function(){return n.bindFramebuffer(n.FRAMEBUFFER,null)}),ke(n,this.debug,function(){return n.deleteFramebuffer(t.framebuffer)}),ke(n,this.debug,function(){return n.bindBuffer(n.ARRAY_BUFFER,null)}),ke(n,this.debug,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}),ke(n,this.debug,function(){return n.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(t,n){return this.throwIfDisposed(),WT(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(t,n){return this.throwIfDisposed(),VT(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(t,n){return this.throwIfDisposed(),HT(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(t,n){this.throwIfDisposed(),YT(this.gl,this.debug,t,n)},e.prototype.uploadDenseMatrixToTexture=function(t,n,r,s){this.throwIfDisposed(),XT(this.gl,this.debug,t,n,r,s,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(t,n){return this.throwIfDisposed(),GT(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(t,n){return this.throwIfDisposed(),qT(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.deleteMatrixTexture=function(t){var n=this;this.throwIfDisposed(),this.outputTexture===t&&(By(this.gl,this.debug,this.framebuffer),this.outputTexture=null),ke(this.gl,this.debug,function(){return n.gl.deleteTexture(t)})},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,n,r){var s=this;return this.downloadMatrixDriver(t,function(){return ZT(s.gl,s.debug,n,r,s.textureConfig)})},e.prototype.downloadPackedMatrixFromBuffer=function(t,n,r,s,i,o){return eA(this.gl,t,0,0,0,i,o,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(t,n){return JT(this.gl,t,n)},e.prototype.createBufferFromTexture=function(t,n,r){this.bindTextureToFrameBuffer(t);var s=QT(this.gl,this.debug,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),s},e.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},e.prototype.createFence=function(t){var n,r,s=this;if(ee().getBool("WEBGL_FENCE_API_ENABLED")){var i=t,o=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=function(){var l=i.clientWaitSync(o,0,0);return l===i.ALREADY_SIGNALED||l===i.CONDITION_SATISFIED},n=o}else ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=function(){return s.isQueryAvailable(n,ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:n,isFencePassed:r}},e.prototype.downloadMatrixFromPackedTexture=function(t,n,r){var s=this;return this.downloadMatrixDriver(t,function(){return tA(s.gl,s.debug,n,r)})},e.prototype.createProgram=function(t){this.throwIfDisposed();var n=this.gl,r=MR(n,this.debug,t),s=$T(n,this.debug),i=OR(n,this.debug);return ke(n,this.debug,function(){return n.attachShader(i,s)}),ke(n,this.debug,function(){return n.attachShader(i,r)}),BR(n,this.debug,i),this.debug&&yh(n,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=KT(n,this.debug,this.program,this.vertexBuffer)),i},e.prototype.deleteProgram=function(t){var n=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&ke(this.gl,this.debug,function(){return n.gl.deleteProgram(t)})},e.prototype.setProgram=function(t){var n=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&yh(this.gl,this.debug,this.program),ke(this.gl,this.debug,function(){return n.gl.useProgram(t)})},e.prototype.getUniformLocation=function(t,n,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?qR(this.gl,this.debug,t,n):GR(this.gl,t,n)},e.prototype.getAttributeLocation=function(t,n){var r=this;return this.throwIfDisposed(),ke(this.gl,this.debug,function(){return r.gl.getAttribLocation(t,n)})},e.prototype.getUniformLocationNoThrow=function(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)},e.prototype.setInputMatrixTexture=function(t,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),KR(this.gl,this.debug,this.program,t,n,r)},e.prototype.setOutputMatrixTexture=function(t,n,r){this.setOutputMatrixTextureDriver(t,r,n)},e.prototype.setOutputPackedMatrixTexture=function(t,n,r){this.throwIfDisposed();var s=_l(n,r),i=s[0],o=s[1];this.setOutputMatrixTextureDriver(t,i,o)},e.prototype.setOutputMatrixWriteRegion=function(t,n,r,s){this.setOutputMatrixWriteRegionDriver(r,t,s,n)},e.prototype.setOutputPackedMatrixWriteRegion=function(t,n,r,s){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){this.program!=null&&yh(this.gl,this.debug,this.program),lc(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),ke(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),ke(this.gl,this.debug,function(){return t.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=oc(this.gl,this.debug,ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.createQuery();return t.beginQuery(n.TIME_ELAPSED_EXT,r),r}var s=this.getQueryTimerExtensionWebGL1(),i=s.createQueryEXT();return s.beginQueryEXT(s.TIME_ELAPSED_EXT,i),i},e.prototype.endQuery=function(){if(ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(t){return we(this,void 0,void 0,function(){var n=this;return Ne(this,function(r){switch(r.label){case 0:return[4,Ay(function(){return n.disposed||n.isQueryAvailable(t,ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(t,ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},e.prototype.getQueryTime=function(t,n){if(n===0)return null;if(n===2){var r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}var s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(t,s.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(t,n){if(n===0)return!0;if(n===2){var r=this.gl,s=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(s=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,s.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),i&&!this.disjoint},e.prototype.pollFence=function(t){var n=this;return new Promise(function(r){n.addItemToPoll(function(){return t.isFencePassed()},function(){return r()})})},e.prototype.pollItems=function(){for(var t=function(r){for(var s=0;s<r.length&&r[s]();++s);return s-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),n=0;n<=t;++n)(0,this.itemsToPoll[n].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},e.prototype.addItemToPoll=function(t,n){var r=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1||Ay(function(){return r.pollItems(),r.itemsToPoll.length===0})},e.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),bh(this.gl,this.debug,t,this.framebuffer),this.debug&&lc(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(bh(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&lc(this.gl)):By(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(t,n){this.bindTextureToFrameBuffer(t);var r=n();return this.unbindTextureToFrameBuffer(),r},e.prototype.setOutputMatrixTextureDriver=function(t,n,r){this.throwIfDisposed();var s=this.gl;bh(s,this.debug,t,this.framebuffer),this.debug&&lc(s),this.outputTexture=t,ke(s,this.debug,function(){return s.viewport(0,0,n,r)}),ke(s,this.debug,function(){return s.scissor(0,0,n,r)})},e.prototype.setOutputMatrixWriteRegionDriver=function(t,n,r,s){var i=this;this.throwIfDisposed(),ke(this.gl,this.debug,function(){return i.gl.scissor(t,n,r,s)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},e}();function Jy(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach(function(n,r){var s=n.logicalShape,i=t[r],o=i.shape;if(!Xt(s,o))throw Error("Binary was compiled with different shapes than the current args. Shapes "+s+" and "+o+" must match");if(!n.isUniform||!i.isUniform){var l=n.texShape,c=i.isUniform?null:i.texData.texShape;if(!Xt(l,c))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+l+" and "+c+" must match")}})}var rA=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r=n.filterWidth,s=n.inChannels,i=n.strideWidth,o=n.strideHeight,l=n.padInfo,c=n.outWidth,u=n.dilationWidth,d=n.dilationHeight,h=n.dataFormat,p=l.left,f=l.top,x=s*r,v=un(),y=h==="channelsLast",m=y?0:1,g=y?1:2,b="",w=0;w<=1;w++)for(var N=0;N<=1;N++)b+=`
          blockIndex = rc.y + `+N+`;
          pos = rc.x + `+w+`;

          if(blockIndex < `+e[1]+" && pos < "+e[0]+`) {
            offsetY = int(blockIndex / (`+c+")) * "+o+" - "+f+`;
            d0 = offsetY + `+d+" * (pos / "+x+`);

            if(d0 < `+t[m]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+c+".) * "+i+". - "+p+`.);
              d1 = offsetX + `+u+" * (int(mod(float(pos), "+x+".) / "+s+`.));

              if(d1 < `+t[g]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+s+`.));

                if (`+y+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*w+N)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*w+N)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+b+`

        `+v.output+` = result;
      }
    `},aA=function(e,t,n,r,s){this.variableNames=["x"],this.outputShape=[];var i,o=t,l=e[3]-1;this.outputShape=e;var c="float("+n+") + float("+r+") * sum";i=s===.5?"inversesqrt("+c+")":s===1?"1.0/("+c+")":"exp(log("+c+") * float(-"+s+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+o+"; j <= "+o+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+l+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+i+`;
        setOutput(val);
      }
    `},sA=function(e,t,n,r,s){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=s,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+n+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+s+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+s+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},iA=function(e,t,n,r,s){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,o=t,l=e[3]-1;this.outputShape=e;var c="float("+n+") + float("+r+") * sum";i=s===.5?"inversesqrt("+c+")":s===1?"1.0/("+c+")":"exp(log("+c+") * float(-"+s+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+o+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+o+"; j <= "+o+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+l+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+i+`;
        setOutput(result);
      }
    `},oA=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,s=e.effectiveFilterHeight,i=e.effectiveFilterWidth,o=s-1-e.padInfo.top,l=i-1-e.padInfo.left,c=s*i-1;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+s+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+i+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+n+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+c+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+i+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},lA=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,s=e.dilationDepth,i=e.dilationHeight,o=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,u=e.effectiveFilterWidth,d=l-1-e.padInfo.front,h=c-1-e.padInfo.top,p=u-1-e.padInfo.left,f=l*c*u-1;this.userCode=`
      const ivec3 pads = ivec3(`+d+", "+h+", "+p+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+l+`;
           wD += `+s+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+c+`;
              wR += `+i+`) {
            float dyR = float(dyRCorner + wR) / `+n+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+u+`;
                wC += `+o+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+f+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+c+" * "+u+` +
                  wR * `+u+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},kh=function(e,t,n,r,s,i,o){n===void 0&&(n=!1),r===void 0&&(r=!1),s===void 0&&(s=!1),i===void 0&&(i=null),o===void 0&&(o=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var l=n?e[1]:e[2],c=Math.ceil(l/2),u=n?"i * 2, rc.y":"rc.y, i * 2",d=r?"rc.z, i * 2":"i * 2, rc.z",h=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],p=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],f="",x="";i&&(f=o?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+i+`
        }`:`vec4 activation(vec4 x) {
          `+i+`
        }`,x="result = activation(result);");var v=s?"result += getBiasAtOutCoords();":"";s&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+f+`

      const float sharedDimension = `+c+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+c+`; i++) {
          vec4 a = getMatrixA(rc.x, `+u+`);
          vec4 b = getMatrixB(rc.x, `+d+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+h[0]+" * "+p[0]+`);
          result += (`+h[1]+" * "+p[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+v+`

        `+x+`

        setOutput(result);
      }
    `},cA=function(){function e(t,n,r){this.variableNames=["probs"],this.outputShape=[t,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(n-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(n-1)+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,s){n.seedLoc==null&&(n.seedLoc=r.getUniformLocation(s,"seed")),r.gl.uniform1f(n.seedLoc,t)}},e}(),uA=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+n+`),
                      float(index == coords.y)));
      }
    `},dA=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var n=Cn("rc",t),r=it(t),s=function(l,c,u){if(l===1)return"rc > "+c[0];for(var d="",h=l-2;h<l;h++)d+=u[h]+" >= "+c[h],h<l-1&&(d+="||");return d}(t,e,n),i=function(l,c,u,d){if(l===1)return"";var h=d.slice(-2);return`
    int r = `+h[0]+`;
    int c = `+h[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+c+`;
    bool rEdge = rp1 >= `+u+`;
  `}(t,e[e.length-1],e[e.length-2],n),o=function(l,c){var u=l.length,d=function(h,p){for(var f=[],x=0;x<=1;x++)for(var v=0;v<=1;v++){for(var y=(x===0?"r":"rp1")+", "+(v===0?"c":"cp1"),m=2;m<h;m++)y=p[p.length-1-m]+","+y;f.push(y)}return f}(u,c);return u===1?`getA(rc),
            rc + 1 >= `+l[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+d[0]+`),
          cEdge ? 0. : getA(`+d[1]+`),
          rEdge ? 0. : getA(`+d[2]+`),
          rEdge || cEdge ? 0. : getA(`+d[3]+")"}(e,n);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+s+`) {
            setOutput(vec4(0));
          } else {
            `+i+`

            setOutput(vec4(`+o+`));
          }
        }
      `}},hA=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map(function(c,u){return c[0]+e[u]+c[1]});var r=e.length,s=it(r),i=t.map(function(c){return c[0]}).join(","),o=t.map(function(c,u){return c[0]+e[u]}).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+s+" start = "+s+"("+i+`);
      `+s+" end = "+s+"("+o+`);

      void main() {
        `+s+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+n+`));
        } else {
          `+s+` coords = outC - start;
          setOutput(getX(`+l+`));
        }
      }
    `:`
        int start = `+i+`;
        int end = `+o+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+n+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},pA=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(y,m){return y[0]+e[m]+y[1]});for(var r=e.length,s=it(r),i=t.map(function(y){return y[0]}).join(","),o=t.map(function(y,m){return y[0]+e[m]}).join(","),l=Cn("rc",r),c=Cn("source",r),u=l[r-1]+" < "+this.outputShape[r-1],d=r===1?"source":"vec2("+c.slice(-2).join()+")",h=[s+" rc = outputLoc;",l[r-1]+` += 1;
       if(`+u+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+l[r-2]+` += 1;
       if(`+l[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+l[r-1]+` += 1;
         if(`+u+") {"],p=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",f="",x=0,v=r===1?2:4;x<v;x++)f+=`
        `+h[x]+`
        if (`+p+`) {
          result[`+x+"] = float("+n+`);
        } else {
          `+s+` source = rc - start;
          result[`+x+"] = getChannel(getX("+c.join()+"), "+d+`);
        }
      `;f+=r===1?"} ":"}}",this.userCode=`
      const `+s+" start = "+s+"("+i+`);
      const `+s+" end = "+s+"("+o+`);

      void main() {
        `+s+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+f+`
        setOutput(result);
      }
    `},Sh=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterHeight,u=e.effectiveFilterWidth,d=e.padInfo.top,h=e.padInfo.left;this.outputShape=e.outShape;var p=t==="avg",f="0.0";if(p||(f="-1.0 / 1e-20"),n)this.userCode=`
        const ivec2 strides = ivec2(`+s+", "+i+`);
        const ivec2 pads = ivec2(`+d+", "+h+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+c+`;
              wR += `+o+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+u+`;
                wC += `+l+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+u+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var x=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(x="avgValue / count");var v=4*Math.floor(r/4),y=r%4,m=`
      if (`+p+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+s+", "+i+`);
      const ivec2 pads = ivec2(`+d+", "+h+`);
      const float initializationValue = `+f+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+f+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+c+`;
            wR += `+o+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+v+`; wC += 4) {
            int xC = xCCorner + wC * `+l+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              getValue(batch, xR, xC + 3 * `+l+`, d)
            );

            `+m+`
          }

          int xC = xCCorner + `+v+`;
          if (`+(y===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+m+`
          } else if (`+(y===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              initializationValue,
              initializationValue
            );

            `+m+`
          } else if (`+(y===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              initializationValue
            );

            `+m+`
          }
        }
        setOutput(`+x+`);
      }
    `}},Eh=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,s=e.strideDepth,i=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=e.padInfo.front,x=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;var y=t==="avg",m="0.0";if(y||(m="-1.0 / 1e-20"),n)this.userCode=`
        const ivec3 strides =
            ivec3(`+s+", "+i+", "+o+`);
        const ivec3 pads = ivec3(`+f+", "+x+", "+v+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+d+`;
              wD += `+l+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+e.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+h+`;
                wR += `+c+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+p+`;
                  wC += `+u+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+h+" * "+p+` +
                      wR * `+p+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var g=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(g="avgValue / count");var b=4*Math.floor(r/4),w=r%4,N=`
      if (`+y+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+s+", "+i+", "+o+`);
      const ivec3 pads = ivec3(`+f+", "+x+", "+v+`);
      const float initializationValue = `+m+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+m+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+l+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+h+`;
            wR += `+c+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+b+`; wC += 4) {
              int xC = xCCorner + wC * `+u+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+u+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+u+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+u+`, ch)
              );

              `+N+`
            }

            int xC = xCCorner + `+b+`;
            if (`+(w===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+N+`
            } else if (`+(w===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+u+`, ch),
                initializationValue,
                initializationValue
              );

              `+N+`
            } else if (`+(w===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+u+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+u+`, ch),
                initializationValue
              );

              `+N+`
            }
          }
          setOutput(`+g+`);
        }
      }
    `}},fA=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,s=e.inSize,i=Math.ceil(s/n);this.outputShape=[r,i];var o="0.0",l="";t==="prod"?o="1.0":t==="min"?(o="1.0 / 1e-20",l="min"):t==="max"&&(o="-1.0 / 1e-20",l="max");var c=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?c="sumValue":t==="prod"?c="prodValue":t==="all"?c="allValue":t==="any"&&(c="anyValue");var u=4*Math.floor(n/4),d=n%4,h=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+l+`(values, minMaxValue);
      }
    `,p="vec4";t==="all"?(o="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,p="bvec4"):t==="any"&&(o="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,p="bvec4");var f="";s%n>0&&(f=`
        if (inIdx < 0 || inIdx >= `+s+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+o+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+f+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        vec4 minMaxValue = vec4(`+o+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+u+`; i += 4) {
          int inIdx = inOffset + i;
          `+p+" values = "+p+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+h+`
        }

        int inIdx = inOffset + `+u+`;
        if (`+(d===1)+`) {
          `+p+" values = "+p+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+h+`
        } else if (`+(d===2)+`) {
          `+p+" values = "+p+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+h+`
        } else if (`+(d===3)+`) {
          `+p+" values = "+p+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+h+`
        }
        setOutput(`+c+`);
      }
    `},mA=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var s="thisRC = rc;";r%2==1&&(s+="thisRC.z += 1;"),r>1&&(s+="thisRC.y += 1;"),n+=`
        `+s+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+_s(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+Um(e)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+e[1]+`;
        int cols = `+e[2]+`;

        `+n+`

        setOutput(result);
      }
    `},xA=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,s=r[1],i=r[2],o=e.shape,l=o[1],c=o[2],u=[n&&l>1?s-1:s,n&&c>1?i-1:i],d=[n&&l>1?l-1:l,n&&c>1?c-1:c],h=u[0]/d[0],p=u[1]/d[1],f=1/h,x=1/p,v=2*Math.ceil(f)+2,y=2*Math.ceil(x)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+h+`);
        const float widthScale = float(`+p+`);

        const float invHeightScale = float(`+f+`);
        const float invWidthScale = float(`+x+`);

        const int winHeight = int(`+v+`);
        const int winWidth = int(`+y+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+l+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+c+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(s-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(i-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},gA=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var s=e[0],i=e[1],o=e[2],l=e[3];this.outputShape=[s,t,n,l];var c=[r&&t>1?i-1:i,r&&n>1?o-1:o],u=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+c[0]/u[0]+`,
          `+c[1]/u[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+o+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},vA=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var s=e[0],i=e[1],o=e[2],l=e[3];this.outputShape=[s,t,n,l];var c=[r&&t>1?i-1:i,r&&n>1?o-1:o],u=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+c[0]/u[0]+`,
          `+c[1]/u[1]+`,
          `+c[1]/u[1]+`);
      const vec3 inputShapeRC = vec3(`+i+".0, "+o+`.0,
                                     `+o+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(l-1)+`;
        bool hasNextRow = coords.z < `+(n-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},yA=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,s=r[1],i=r[2],o=e.shape,l=o[1],c=o[2],u=[n&&l>1?s-1:s,n&&c>1?i-1:i],d=[n&&l>1?l-1:l,n&&c>1?c-1:c],h=u[0]/d[0],p=u[1]/d[1],f=1/h,x=1/p,v=2*Math.ceil(f)+2,y=2*Math.ceil(x)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+h+`);
        const float widthScale = float(`+p+`);

        const float invHeightScale = float(`+f+`);
        const float invWidthScale = float(`+x+`);

        const int winHeight = int(`+v+`);
        const int winWidth = int(`+y+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+l+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+c+`) {
              continue;
            }

            float sourceFracRow =
              float(`+u[0]+`) *
                (float(dyR) / float(`+d[0]+`));

            float sourceFracCol =
                float(`+u[1]+`) *
                  (float(dyC) / float(`+d[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+s+`) - 1),
                `+n+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+i+`) - 1),
                `+n+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},bA=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var s=e[0],i=e[1],o=e[2],l=e[3];this.outputShape=[s,t,n,l];var c=[r&&t>1?i-1:i,r&&n>1?o-1:o],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],d=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+c[0]/u[0]+`,
          `+c[1]/u[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+o+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+d+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},wA=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,n!==1){var r=e.map(function(i,o){return function(l){return t.indexOf(l)!==-1&&e[l]!==1?e[l]+" - coords["+l+"] - 1":"coords["+l+"]"}(o)}).join(","),s=it(n);this.userCode=`
      void main() {
        `+s+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+e[0]+` - coord - 1));
        }
      `},NA=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=Cn("rc",n),s=r[n-1]+" + 1 < "+this.outputShape[n-1],i=r[n-2]+" + 1 < "+this.outputShape[n-2],o=it(n);function l(c){var u=e.map(function(d,h){return function(p,f){return t.indexOf(p)!==-1&&e[p]!==1?e[p]+" - "+f[p]+" - 1":""+f[p]}(h,c)});return"getChannel(getX("+u.join(",")+"), vec2("+u.slice(-2).join(",")+"))"}this.userCode=n===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+e[0]+` - rc - 1),
            `+e[0]+` - rc - 1);
          if(`+s+`){
              result.g = getChannel(getX(`+e[0]+` - (rc  + 1) - 1),
                `+e[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+o+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(c){return l(c)}(r.slice())+`;
          if(`+s+`){
            result.g = `+function(c){return c[n-1]="("+c[n-1]+" + 1)",l(c)}(r.slice())+`;
          }
          if(`+i+`) {
            result.b = `+function(c){return c[n-2]="("+c[n-2]+" + 1)",l(c)}(r.slice())+`;
            if(`+s+`) {
              result.a = `+function(c){return c[n-1]="("+c[n-1]+" + 1)",c[n-2]="("+c[n-2]+" + 1)",l(c)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},Zy=function(e,t,n,r,s,i,o){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var l=it(s.length),c=it(i.length),u="";n===1?u="i":n===2&&(u="i, j");var d="getIndices("+u+")",h="";r===1?h="i":r===2&&(h="i, coords[1]");var p="getUpdates("+h+")",f=t>1?"strides[j]":"strides";this.userCode=`
        `+l+" strides = "+l+"("+s+`);

        void main() {
          `+c+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+e+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+d+`);
              flattenedIndex += index * `+f+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+p+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},jA=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,s=e.inSize,i=e.numSegments,o=i*Math.ceil(s/n);this.outputShape=[r,o];var l=4*Math.floor(n/4),c=n%4,u=`
        sumValue += dot(values, segFilter);
    `,d="";s%n>0&&(d=`
        if (inIdx < 0 || inIdx >= `+s+`) {
          return initializationValue;
        }
      `);var h="";s%n>0&&(h=`
        if (inIdx < 0 || inIdx >= `+s+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+d+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+h+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+i+")) * float("+n+`));
        int currentSeg = int(mod(float(outIdx), float(`+i+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+u+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(c===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+u+`
        } else if (`+(c===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+u+`
        } else if (`+(c===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+u+`
        }
        setOutput(sumValue);
      }
    `},CA=function(e,t,n){var r,s;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(n===1)s="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],l=[],c=0;c<t.length;c++)l.push(""+i[c]),c<e&&o.push(""+i[c]);r=o.join(),s=l.join()}var u=it(n);this.userCode=`
      void main() {
        `+u+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+s+`));
        } else {
          setOutput(getB(`+s+`));
        }
      }
    `},kA=function(){function e(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=it(this.rank),s="uniform int start["+this.rank+"];",i=function(o){if(o===1)return"sourceLoc";if(o<=6)return Dh.slice(0,o).map(function(l){return"sourceLoc."+l}).join(",");throw Error("Slicing for rank "+o+" is not yet supported")}(this.rank);n=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+t.map(function(o,l){return"sourceLoc."+Dh[l]+" = start["+l+"] + coords."+Dh[l]+";"}).join(`
`)+`
      `,this.userCode=`
      `+s+`
      void main() {
        `+n+`
        setOutput(getSource(`+i+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,s){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(s,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),Dh=["x","y","z","w","u","v"],SA=function(){function e(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=it(this.rank),r=Cn("coords",this.rank),s=Cn("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":"vec2("+s.slice(-2).join()+")",o="getChannel(getSource("+s.join()+"), "+i+")",l=`
      result.x = `+o+`;
      if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+s[this.rank-1]+`;
        result.y = `+o+`;
        --`+s[this.rank-1]+`;
      }
    `,c=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+s[this.rank-2]+`;
        result.z = `+o+`;
        if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+s[this.rank-1]+`;
          result.w = `+o+`;
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            `+n+"("+t.map(function(d,h){return"start["+h+"]"}).join()+");":t.map(function(d,h){return s[h]+" = "+r[h]+" + start["+h+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+n+` coords = getOutputCoords();
        `+n+` sourceLoc;
        `+u+`
        vec4 result = vec4(0.);
        `+l+`
        `+c+`
        setOutput(result);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,s){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(s,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),EA=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,s=it(n.length),i=it(n.length),o="";if(r===1)o="coords * strides + begin";else{var l=0;o=n.map(function(c,u){return l++,n.length===1?"coords * strides["+u+"] + begin["+u+"]":"coords["+(l-1)+"] * strides["+u+"] + begin["+u+"]"}).join(",")}this.userCode=`
      `+s+" begin = "+s+"("+e+`);
      `+s+" strides = "+s+"("+t+`);

      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+o+`));
      }
    `},DA=function(){function e(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(t,n,r){var s,i=eb(n,r),o=tb(t,i,r);if(o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]),this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var l=this.freeTextures[o].shift();return this.usedTextures[o].push(l),l}return this.numUsedTextures++,this.log(),i===Ln.PACKED_2X2_FLOAT32?s=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===Ln.PACKED_2X2_FLOAT16?s=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===Ln.UNPACKED_FLOAT32?s=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===Ln.UNPACKED_FLOAT16?s=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===Ln.PACKED_4X1_UNSIGNED_BYTE&&(s=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[o].push(s),s},e.prototype.releaseTexture=function(t,n,r,s){if(this.freeTextures!=null){var i=tb(n,eb(r,s),s);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var o=this.usedTextures[i],l=o.indexOf(t);if(l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");o.splice(l,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var n in this.freeTextures)this.freeTextures[n].forEach(function(r){t.gpgpu.deleteMatrixTexture(r)});for(var n in this.usedTextures)this.usedTextures[n].forEach(function(s){t.gpgpu.deleteMatrixTexture(s)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function eb(e,t){if(e===$n.UPLOAD)return Ln.PACKED_2X2_FLOAT32;if(e===$n.RENDER||e==null)return function(n){return ee().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?Ln.PACKED_2X2_FLOAT32:Ln.UNPACKED_FLOAT32:n?Ln.PACKED_2X2_FLOAT16:Ln.UNPACKED_FLOAT16}(t);if(e===$n.DOWNLOAD||e===$n.PIXELS)return Ln.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function tb(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var RA=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var s=it(this.rank),i=function(o){var l=o.length;if(l>5)throw Error("Tile for rank "+l+" is not yet supported");if(l===1)return"imod(resRC, "+o[0]+")";for(var c=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],u=[],d=0;d<o.length;d++)u.push("imod("+c[d]+", "+o[d]+")");return u.join()}(e);this.userCode=`
      void main() {
        `+s+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},_A=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var s=it(this.rank),i=function(o){var l=o.length;if(l>6)throw Error("Transpose for rank "+l+" is not yet supported");for(var c=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],u=new Array(l),d=0;d<o.length;d++)u[o[d]]=c[d];return u.join()}(t);this.userCode=`
    void main() {
      `+s+` resRC = getOutputCoords();
      setOutput(getA(`+i+`));
    }
    `},TA=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var s=it(this.rank),i=BN("rc",this.rank),o=new Array(this.rank);for(r=0;r<t.length;r++)o[t[r]]=i[r];var l="vec2("+o.slice(-2).join()+")",c="++"+i[this.rank-1]+" < "+n[this.rank-1],u="getChannel(getA("+o.join()+"), "+l+")";this.userCode=`
    void main() {
      `+s+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+u+`;
      if(`+c+`) {
        result[1] = `+u+`;
      }
      --`+i[this.rank-1]+`;
      if(++`+i[this.rank-2]+" < "+n[this.rank-2]+`) {
        result[2] = `+u+`;
        if(`+c+`) {
          result[3] = `+u+`;
        }
      }
      setOutput(result);
    }
    `},Wm=1.7580993408473768,Vm=1.0507009873554805,Be=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},Sr="if (isnan(x)) return x;",AA="return x;",nb="return abs(x);",VN=Sr+`
  return (x < 0.0) ? 0.0 : x;
`,HN=Sr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,qN="return (x >= 0.0) ? x : (exp(x) - 1.0);",IA=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+Wm+`;
  float scale = `+Vm+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,rb="return -x;",ab="return ceil(x);",sb="return floor(x);",ib="return exp(x);",ob="return exp(x) - 1.0;",PA=Sr+`
  return sin(x);
`,FA=Sr+`
  return cos(x);
`,MA=Sr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,LA=Sr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,OA=Sr+`
  return atan(x);
`,BA=Sr+"return log(x + sqrt(x * x + 1.0));",$A=Sr+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,zA=Sr+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,hc="return x;",UA="return x;",GN=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,KN=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,XN=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,ko=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},WA=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=Cn("rc",t),r=it(t),s=function(l,c){if(l===1)return"rc";for(var u="",d=0;d<l;d++)u+=c[d],d<l-1&&(u+=",");return u}(t,n),i=n.slice(-2),o=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+s+`);

        setOutput(getChannel(packedInput, `+o+`));
      }
    `},pc={};function fc(e,t){if(t===void 0&&(t=!1),e==="linear")return t?UA:AA;if(e==="relu")return t?GN:VN;if(e==="elu")return t?XN:qN;if(e==="relu6")return t?KN:HN;if(e==="prelu")return t?WN:UN;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var VA=600,HA=function(e){function t(n){var r,s=e.call(this)||this;if(s.pendingRead=new WeakMap,s.pendingDisposal=new WeakSet,s.dataRefCount=new WeakMap,s.numBytesInGPU=0,s.uploadWaitMs=0,s.downloadWaitMs=0,s.warnedAboutMemory=!1,s.pendingDeletes=0,s.disposed=!1,!ee().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(n==null){var i=Kr(ee().getNumber("WEBGL_VERSION"));s.binaryCache=((r=ee().getNumber("WEBGL_VERSION"))in pc||(pc[r]={}),pc[r]),s.gpgpu=new nA(i),s.canvas=i.canvas,s.gpgpuCreatedLocally=!0}else s.gpgpu=n,s.binaryCache={},s.gpgpuCreatedLocally=!1,s.canvas=n.gl.canvas;return s.textureManager=new DA(s.gpgpu),s.numMBBeforeWarning=ee().global.screen==null?1024:ee().global.screen.height*ee().global.screen.width*window.devicePixelRatio*VA/1024/1024,s.texData=new _N(s,V),s}return kr(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(n,r,s){if(ee().getBool("DEBUG")&&this.checkNumericalProblems(n),s==="complex64"&&n!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:r,dtype:s,values:n,usage:$n.UPLOAD}),i},t.prototype.move=function(n,r,s,i){if(ee().getBool("DEBUG")&&this.checkNumericalProblems(r),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(n,{shape:s,dtype:i,values:r,usage:$n.UPLOAD})},t.prototype.readSync=function(n){var r=this.texData.get(n),s=r.values,i=r.dtype,o=r.complexTensors,l=r.slice,c=r.shape,u=r.isPacked;if(l!=null){var d=void 0;d=u?new ko(c,hc):new Be(c,hc);var h=this.runWebGLProgram(d,[{dataId:n,shape:c,dtype:i}],i),p=this.readSync(h.dataId);return this.disposeData(h.dataId),p}if(s!=null)return this.convertAndCacheOnCPU(n);if(i==="string")return s;var f,x,v=this.activeTimers!=null;return v&&(f=Ir()),i==="complex64"?x=of(o.real.dataSync(),o.imag.dataSync()):x=this.getValuesFromTexture(n),v&&(this.downloadWaitMs+=Ir()-f),this.convertAndCacheOnCPU(n,x)},t.prototype.read=function(n){return we(this,void 0,void 0,function(){var r,s,i,o,l,c,u,d,h,p,f,x,v,y,m,g,b,w,N,C,D,j;return Ne(this,function(k){switch(k.label){case 0:if(this.pendingRead.has(n))return r=this.pendingRead.get(n),[2,new Promise(function(R){return r.push(R)})];if(s=this.texData.get(n),i=s.values,o=s.shape,l=s.slice,c=s.dtype,u=s.complexTensors,d=s.isPacked,l!=null)return h=void 0,h=d?new ko(o,hc):new Be(o,hc),p=this.runWebGLProgram(h,[{dataId:n,shape:o,dtype:c}],c),f=this.read(p.dataId),this.disposeData(p.dataId),[2,f];if(i!=null)return[2,this.convertAndCacheOnCPU(n)];if(!ee().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ee().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return x=null,c!=="complex64"&&ee().get("WEBGL_BUFFER_SUPPORTED")&&(v=this.decode(n),y=this.texData.get(v.dataId),x=(j=this.gpgpu).createBufferFromTexture.apply(j,[y.texture].concat($o(o)))),this.pendingRead.set(n,[]),c==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:k.sent(),k.label=2;case 2:return c!=="complex64"?[3,4]:[4,Promise.all([u.real.data(),u.imag.data()])];case 3:return g=k.sent(),b=g[0],w=g[1],m=of(b,w),[3,5];case 4:x==null?m=this.getValuesFromTexture(n):(N=je(o),m=this.gpgpu.downloadFloat32MatrixFromBuffer(x,N)),k.label=5;case 5:return v!=null&&this.disposeData(v.dataId),C=this.convertAndCacheOnCPU(n,m),D=this.pendingRead.get(n),this.pendingRead.delete(n),D.forEach(function(R){return R(C)}),this.pendingDisposal.has(n)&&(this.pendingDisposal.delete(n),this.disposeData(n),this.pendingDeletes--),[2,C]}})})},t.prototype.checkNumericalProblems=function(n){if(n!=null)for(var r=0;r<n.length;r++){var s=n[r];if(!IR(s))throw ee().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+s+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+s+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(n){var r,s=this.texData.get(n),i=s.shape,o=s.dtype,l=s.isPacked,c=je(i);if(ee().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var u=this.decode(n),d=this.texData.get(u.dataId),h=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[d.texture].concat($o(i))).subarray(0,c);return this.disposeData(u.dataId),h}var p=ee().getBool("WEBGL_PACK")&&l===!0,f=p?wh(i):i,x=p?new AT(f):new TT(f),v=this.runWebGLProgram(x,[{shape:f,dtype:o,dataId:n}],"float32"),y=this.texData.get(v.dataId),m=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(y.texture,y.texShape[0],y.texShape[1]).subarray(0,c);return this.disposeData(v.dataId),m},t.prototype.time=function(n){return we(this,void 0,void 0,function(){var r,s,i,o,l,c,u;return Ne(this,function(d){switch(d.label){case 0:return r=this.activeTimers,s=[],i=!1,this.programTimersStack==null?(this.programTimersStack=s,i=!0):this.activeTimers.push(s),this.activeTimers=s,n(),o=Qi(this.activeTimers.map(function(h){return h.query})).filter(function(h){return h!=null}),l=Qi(this.activeTimers.map(function(h){return h.name})).filter(function(h){return h!=null}),this.activeTimers=r,i&&(this.programTimersStack=null),c={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(o)]:[3,2];case 1:return u=d.sent(),c.kernelMs=pR(u),c.getExtraProfileInfo=function(){return u.map(function(h,p){return{name:l[p],ms:h}}).map(function(h){return h.name+": "+h.ms}).join(", ")},[3,3];case 2:c.kernelMs={error:"WebGL query timers are not supported in this environment."},d.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,c]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Ir(),endMs:null}},t.prototype.endTimer=function(n){return ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),n):(n.endMs=Ir(),n)},t.prototype.getQueryTime=function(n){return we(this,void 0,void 0,function(){var r;return Ne(this,function(s){return ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(n)]:[2,(r=n).endMs-r.startMs]})})},t.prototype.disposeData=function(n){if(!this.pendingDisposal.has(n)){if(this.pendingRead.has(n))return this.pendingDisposal.add(n),void this.pendingDeletes++;if(this.texData.has(n)){this.releaseGPUData(n);var r=this.texData.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(n)}}},t.prototype.releaseGPUData=function(n){var r=this.texData.get(n),s=r.texture,i=r.dtype,o=r.texShape,l=r.usage,c=r.isPacked,u=r.slice,d=u&&u.origDataId||n,h=this.dataRefCount.get(d);h>1?this.dataRefCount.set(d,h-1):(this.dataRefCount.delete(d),s!=null&&(this.numBytesInGPU-=this.computeBytes(o,i),this.textureManager.releaseTexture(s,o,l,c)));var p=this.texData.get(n);p.texture=null,p.texShape=null,p.isPacked=!1,p.slice=null},t.prototype.getTexture=function(n){return this.uploadToGPU(n),this.texData.get(n).texture},t.prototype.getDataInfo=function(n){return this.texData.get(n)},t.prototype.getCPUBackend=function(){return ee().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=V.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(n,r){var s=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&n.every(function(i){return s.texData.get(i.dataId).texture==null&&i.size<r})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(n,r){var s=this.makeOutput(n.shape,"complex64");return this.texData.get(s.dataId).complexTensors={real:V.keep(n.clone()),imag:V.keep(r.clone())},s},t.prototype.real=function(n){return this.texData.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.texData.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,s){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.slice(n,r,s);if(je(s)===0)return en([],s,n.dtype);var i=this.texData.get(n.dataId).isPacked,o=DN(n.shape,r,s);if(i||!o){var l=ee().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new SA(s):new kA(s),c=l.getCustomSetupFunc(r);return this.compileAndRun(l,[n],null,c)}return this.uploadToGPU(n.dataId),this.shallowSlice(n,r,s)},t.prototype.shallowSlice=function(n,r,s){var i=this.texData.get(n.dataId),o=this.makeOutput(s,n.dtype),l=this.texData.get(o.dataId);Object.assign(l,i),l.shape=s,l.dtype=n.dtype;var c=RN(r,n.strides);i.slice&&(c+=i.slice.flatOffset),l.slice={flatOffset:c,origDataId:i.slice&&i.slice.origDataId||n.dataId};var u=this.dataRefCount.get(l.slice.origDataId)||1;return this.dataRefCount.set(l.slice.origDataId,u+1),o},t.prototype.stridedSlice=function(n,r,s,i){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.stridedSlice(n,r,s,i);var o=Lm(r,s,i);if(o.some(function(c){return c===0}))return en([],o);var l=new EA(r,i,o);return this.compileAndRun(l,[n])},t.prototype.reverse=function(n,r){var s=ee().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new NA(n.shape,r):new wA(n.shape,r);return this.compileAndRun(s,[n])},t.prototype.concat=function(n,r){if(n[0].dtype==="complex64"){var s=n.map(function(f){return Zn(f)}),i=n.map(function(f){return Mr(f)});return Jt(this.concat(s,r),this.concat(i,r))}if(this.shouldExecuteOnCPU(n))return this.cpuBackend.concat(n,r);if(n.length===1)return n[0];if(n.length>ee().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var o=Math.floor(n.length/2),l=this.concat(n.slice(0,o),r),c=this.concat(n.slice(o),r);return this.concat([l,c],r)}if(ee().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].rank>1){var u=new gT(n.map(function(f){return f.shape}),r);return this.compileAndRun(u,n)}var d=Zi(n.map(function(f){return f.shape}),r),h=n.map(function(f){return f.as2D(-1,je(f.shape.slice(r)))}),p=new xT(h.map(function(f){return f.shape}));return this.compileAndRun(p,h).reshape(d)},t.prototype.neg=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.neg(n);if(ee().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,rb,n.dtype);var r=new Be(n.shape,rb);return this.compileAndRun(r,[n])},t.prototype.batchMatMul=function(n,r,s,i){var o=s?n.shape[2]:n.shape[1],l=i?r.shape[1]:r.shape[2],c=s?n.shape[1]:n.shape[2],u=n.shape[0];if((o===1||l===1)&&c>1e3){s&&(n=n.transpose([0,2,1])),i&&(r=r.transpose([0,2,1]));var d=l===1?n:n.as3D(u,c,1),h=l===1?2:1,p=l===1?r.as3D(u,1,c):r;return this.multiply(d,p).sum(h,!0)}var f=Zt(n.dtype,r.dtype),x=new kh(n.shape,[u,o,l],s,i);return this.compileAndRun(x,[n,r],f)},t.prototype.fusedBatchMatMul=function(n){var r=n.a,s=n.b,i=n.transposeA,o=n.transposeB,l=n.bias,c=n.activation,u=n.preluActivationWeights,d=i?r.shape[2]:r.shape[1],h=o?s.shape[1]:s.shape[2],p=r.shape[0],f=Zt(r.dtype,s.dtype),x=l!=null,v=u!=null,y=c?fc(c,!0):null,m=new kh(r.shape,[p,d,h],i,o,x,y,v),g=[r,s];return l&&g.push(l),u&&g.push(u),this.compileAndRun(m,g,f)},t.prototype.multiply=function(n,r){if(n.dtype==="complex64"){var s=this.texData.get(n.dataId),i=this.texData.get(r.dataId),o=new Hy(dT,n.shape,r.shape),l=new Hy(hT,n.shape,r.shape),c=[this.makeComplexComponentTensorInfo(n,s.complexTensors.real),this.makeComplexComponentTensorInfo(n,s.complexTensors.imag),this.makeComplexComponentTensorInfo(r,i.complexTensors.real),this.makeComplexComponentTensorInfo(r,i.complexTensors.imag)],u=this.compileAndRun(o,c),d=this.compileAndRun(l,c),h=this.complex(u,d);return u.dispose(),d.dispose(),h}if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.multiply(n,r);if(ee().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,qy,n.dtype);var p=new wt(qy,n.shape,r.shape);return this.compileAndRun(p,[n,r],n.dtype)},t.prototype.batchNormalization=function(n,r,s,i,o,l){var c=[n,r,s],u=null;l!=null&&(u=l.shape,c.push(l));var d=null;if(o!=null&&(d=o.shape,c.push(o)),ee().getBool("WEBGL_PACK_NORMALIZATION")){var h=new uT(n.shape,r.shape,s.shape,u,d,i);return this.compileAndRun(h,c)}var p=new cT(n.shape,r.shape,s.shape,u,d,i);return this.compileAndRun(p,c)},t.prototype.localResponseNormalization4D=function(n,r,s,i,o){var l=ee().getBool("WEBGL_PACK_NORMALIZATION")?new iA(n.shape,r,s,i,o):new aA(n.shape,r,s,i,o);return this.compileAndRun(l,[n])},t.prototype.LRNGrad=function(n,r,s,i,o,l,c){var u=new sA(r.shape,i,o,l,c);return this.compileAndRun(u,[r,s,n])},t.prototype.tile=function(n,r){if(n.dtype==="string"){var s=this.readSync(n.dataId).map(function(o){return wu(o)});return LN(Le(n.shape,n.dtype,s),r)}var i=new RA(n.shape,r);return this.compileAndRun(i,[n])},t.prototype.pad=function(n,r,s){var i=ee().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new pA(n.shape,r,s):new hA(n.shape,r,s);return this.compileAndRun(i,[n])},t.prototype.transpose=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.transpose(n,r);var s=ee().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new TA(n.shape,r):new _A(n.shape,r);return this.compileAndRun(s,[n])},t.prototype.gather=function(n,r,s){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.gather(n,r,s);var i=new OT(n.shape,r.size,s);return this.compileAndRun(i,[n,r])},t.prototype.batchToSpaceND=function(n,r,s){M(n.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(h,p){return h*p}),o=Eu(n.shape,r,i),l=Du(o.length,r.length),c=Ru(n.shape,r,i),u=CN(s,r.length),d=kN(c,s,r.length);return n.reshape(o).transpose(l).reshape(c).slice(u,d)},t.prototype.spaceToBatchND=function(n,r,s){M(n.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(p,f){return p*f}),o=[[0,0]];o.push.apply(o,s);for(var l=1+r.length;l<n.shape.length;++l)o.push([0,0]);var c=n.pad(o),u=Eu(c.shape,r,i,!1),d=Du(u.length,r.length,!1),h=Ru(c.shape,r,i,!1);return c.reshape(u).transpose(d).reshape(h)},t.prototype.reduce=function(n,r,s){var i=n.shape[0],o=n.shape[1],l=Nh(o),c=new fA({windowSize:l,inSize:o,batchSize:i},r),u=this.compileAndRun(c,[n],s);return u.shape[1]===1?u:this.reduce(u,r,s)},t.prototype.argReduce=function(n,r,s){s===void 0&&(s=null);var i=n.shape[0],o=n.shape[1];s!=null&&(i=s.shape[0],o=s.shape[1]);var l=Nh(o),c=new eT({windowSize:l,inSize:o,batchSize:i},r,s==null),u=[n];s!=null&&u.push(s);var d=this.compileAndRun(c,u,"int32");return d.shape[1]===1?d:this.argReduce(n,r,d)},t.prototype.argReducePacked=function(n,r,s){s===void 0&&(s=null);var i=s!=null?s.shape:n.shape,o=Nh(i[i.length-1]),l=new iT(i,o,r,s==null),c=s==null?[n]:[n,s],u=this.compileAndRun(l,c,"int32");return u.rank===n.rank?this.argReducePacked(n,r,u):u},t.prototype.sum=function(n,r){Mn("sum",r,n.rank);var s=sn(n.shape,r),i=s[0],o=je(s[1]),l=n.as2D(-1,o),c=fh(n.dtype);return this.reduce(l,"sum",c).reshape(i)},t.prototype.prod=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.prod(n,r);var s=sn(n.shape,r),i=s[0],o=je(s[1]),l=n.as2D(-1,o),c=fh(n.dtype);return this.reduce(l,"prod",c).reshape(i)},t.prototype.unsortedSegmentSum=function(n,r,s){var i=0,o=Xr([i],n.rank),l=n;o!=null&&(l=n.transpose(o),i=Yr(1,n.rank)[0]);var c=function(f,x,v){for(var y=[],m=f.length,g=0;g<m;g++)g!==x?y.push(f[g]):y.push(v);return y}(l.shape,i,s),u=je([l.shape[i]]),d=l.as2D(-1,u),h=fh(n.dtype),p=this.segOpCompute(d,"unsortedSegmentSum",r,h,s).reshape(c);return o!=null&&(p=p.transpose(Im(o))),p},t.prototype.segOpCompute=function(n,r,s,i,o){var l=n.shape[0],c=n.shape[1],u=function(p,f){var x,v=!1;for(p<=EN?(x=p,v=!0):x=Qp(p,Math.floor(Math.sqrt(p)));!v;)x>f||x===p?v=!0:x=Qp(p,x+1);return x}(c,o),d=new jA({windowSize:u,inSize:c,batchSize:l,numSegments:o}),h=this.compileAndRun(d,[n,s],i);return h.shape[1]===o?h:(s=Su(0,o).tile([c/u]),this.segOpCompute(h,r,s,i,o))},t.prototype.argMinMaxReduce=function(n,r,s){var i=[r];if(Mn("arg"+s.charAt(0).toUpperCase()+s.slice(1),i,n.rank),!ee().getBool("WEBGL_PACK_REDUCE")||n.rank<=2){var o=sn(n.shape,i),l=o[0],c=je(o[1]),u=n.as2D(-1,c);return this.argReduce(u,s).reshape(l)}return this.argReducePacked(n,s)},t.prototype.argMin=function(n,r){return this.argMinMaxReduce(n,r,"min")},t.prototype.argMax=function(n,r){return this.argMinMaxReduce(n,r,"max")},t.prototype.cumsum=function(n,r,s,i){if(r!==n.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(n.rank-1)+" but got axis="+r);var o=new ST(n.shape,s,i);return this.compileAndRun(o,[n])},t.prototype.equal=function(n,r){if(ee().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(equal(a, b));
`,"bool");var s=new wt("return float(a == b);",n.shape,r.shape);return this.compileAndRun(s,[n,r],"bool")},t.prototype.notEqual=function(n,r){if(ee().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(notEqual(a, b));
`,"bool");var s=new wt("return float(a != b);",n.shape,r.shape);return this.compileAndRun(s,[n,r],"bool")},t.prototype.less=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.less(n,r);if(ee().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThan(a, b));
`,"bool");var s=new wt("return float(a < b);",n.shape,r.shape);return this.compileAndRun(s,[n,r],"bool")},t.prototype.lessEqual=function(n,r){if(ee().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var s=new wt("return float(a <= b);",n.shape,r.shape);return this.compileAndRun(s,[n,r],"bool")},t.prototype.greater=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.greater(n,r);if(ee().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThan(a, b));
`,"bool");var s=new wt("return float(a > b);",n.shape,r.shape);return this.compileAndRun(s,[n,r],"bool")},t.prototype.greaterEqual=function(n,r){if(ee().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var s=new wt("return float(a >= b);",n.shape,r.shape);return this.compileAndRun(s,[n,r],"bool")},t.prototype.logicalNot=function(n){var r=new Be(n.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[n])},t.prototype.logicalAnd=function(n,r){if(ee().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var s=new wt("return float(a >= 1.0 && b >= 1.0);",n.shape,r.shape);return this.compileAndRun(s,[n,r],"bool")},t.prototype.logicalOr=function(n,r){if(ee().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var s=new wt("return float(a >= 1.0 || b >= 1.0);",n.shape,r.shape);return this.compileAndRun(s,[n,r],"bool")},t.prototype.select=function(n,r,s){var i=new CA(n.rank,r.shape,r.rank);return this.compileAndRun(i,[n,r,s],Zt(r.dtype,s.dtype))},t.prototype.where=function(n){Cu("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=n.dataSync();return zm(n.shape,r)},t.prototype.topk=function(n,r,s){return ON(n.dataSync(),n.shape,n.dtype,r)},t.prototype.min=function(n,r){Mn("min",r,n.rank);var s=sn(n.shape,r),i=s[0],o=je(s[1]),l=n.as2D(-1,o);return this.reduce(l,"min",l.dtype).reshape(i)},t.prototype.minimum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.minimum(n,r);var s=ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new na(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new wt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,n.shape,r.shape);return this.compileAndRun(s,[n,r])},t.prototype.mod=function(n,r){var s=ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new na(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new wt(`if (b == 0.0) return NAN;
  return mod(a, b);`,n.shape,r.shape);return this.compileAndRun(s,[n,r])},t.prototype.max=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.max(n,r);Mn("max",r,n.rank);var s=sn(n.shape,r),i=s[0],o=je(s[1]),l=n.as2D(-1,o);return this.reduce(l,"max",l.dtype).reshape(i)},t.prototype.maximum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.maximum(n,r);var s=ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new na(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new wt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,n.shape,r.shape);return this.compileAndRun(s,[n,r])},t.prototype.all=function(n,r){Mn("all",r,n.rank);var s=sn(n.shape,r),i=s[0],o=je(s[1]),l=n.as2D(-1,o);return this.reduce(l,"all",l.dtype).reshape(i)},t.prototype.any=function(n,r){Mn("any",r,n.rank);var s=sn(n.shape,r),i=s[0],o=je(s[1]),l=n.as2D(-1,o);return this.reduce(l,"any",l.dtype).reshape(i)},t.prototype.realDivide=function(n,r){if(ee().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var s=new wt(`
if (a == b) {
  return 1.0;
};
return a / b;`,n.shape,r.shape);return this.compileAndRun(s,[n,r],"float32")},t.prototype.floorDiv=function(n,r){if(ee().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var s=new wt(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,n.shape,r.shape);return this.compileAndRun(s,[n,r],"int32")},t.prototype.add=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,jh);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.add(n,r);var s=Zt(n.dtype,r.dtype);if(ee().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,jh,s);var i=new wt(jh,n.shape,r.shape);return this.compileAndRun(i,[n,r],s)},t.prototype.packedUnaryOp=function(n,r,s){var i=new ko(n.shape,r);return this.compileAndRun(i,[n],s)},t.prototype.packedBinaryOp=function(n,r,s,i,o){o===void 0&&(o=!1);var l=new na(s,n.shape,r.shape,o);return this.compileAndRun(l,[n,r],i)},t.prototype.complexSeparableBinaryOp=function(n,r,s){var i=this,o=this.texData.get(n.dataId),l=this.texData.get(r.dataId),c=[[o.complexTensors.real,l.complexTensors.real],[o.complexTensors.imag,l.complexTensors.imag]].map(function(p){var f=p[0],x=p[1],v=i.makeComplexComponentTensorInfo(n,f),y=i.makeComplexComponentTensorInfo(r,x),m=new wt(s,n.shape,r.shape);return i.compileAndRun(m,[v,y],Zt(f.dtype,x.dtype))}),u=c[0],d=c[1],h=this.complex(u,d);return u.dispose(),d.dispose(),h},t.prototype.makeComplexComponentTensorInfo=function(n,r){return{dataId:r.dataId,dtype:r.dtype,shape:n.shape}},t.prototype.addN=function(n){if(n.length===1)return n[0];if(n.length>ee().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(n.length/2),s=this.addN(n.slice(0,r)),i=this.addN(n.slice(r));return this.addN([s,i])}var o=n.map(function(u){return u.dtype}).reduce(function(u,d){return Zt(u,d)}),l=n.map(function(u){return u.shape}),c=ee().getBool("WEBGL_PACK")?new Z_(n[0].shape,l):new J_(n[0].shape,l);return this.compileAndRun(c,n,o)},t.prototype.subtract=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,Ch);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.subtract(n,r);var s=Zt(n.dtype,r.dtype);if(ee().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,Ch,n.dtype);var i=new wt(Ch,n.shape,r.shape);return this.compileAndRun(i,[n,r],s)},t.prototype.pow=function(n,r){var s=ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new na(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new wt(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,n.shape,r.shape),i=Zt(n.dtype,r.dtype);return this.compileAndRun(s,[n,r],i)},t.prototype.ceil=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.ceil(n);if(ee().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,ab,n.dtype);var r=new Be(n.shape,ab);return this.compileAndRun(r,[n])},t.prototype.floor=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.floor(n);if(ee().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,sb,n.dtype);var r=new Be(n.shape,sb);return this.compileAndRun(r,[n])},t.prototype.sign=function(n){var r=new Be(n.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[n])},t.prototype.isNaN=function(n){var r=new Be(n.shape,"return float(isnan(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isInf=function(n){var r=new Be(n.shape,"return float(isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isFinite=function(n){var r=new Be(n.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.round=function(n){var r=new Be(n.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[n])},t.prototype.exp=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.exp(n);if(ee().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,ib,n.dtype);var r=new Be(n.shape,ib);return this.compileAndRun(r,[n])},t.prototype.expm1=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.expm1(n);if(ee().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,ob,n.dtype);var r=new Be(n.shape,ob);return this.compileAndRun(r,[n])},t.prototype.softmax=function(n,r){var s=Ut([r],n.shape),i=this.max(n,s),o=In(i.shape,s),l=this.subtract(n,i.reshape(o)),c=this.exp(l),u=this.sum(c,s).reshape(o);return this.realDivide(c,u)},t.prototype.log=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.log(n);if(ee().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,n.dtype);var r=new Be(n.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[n])},t.prototype.log1p=function(n){var r=new Be(n.shape,"return log(1.0 + x);");return this.compileAndRun(r,[n])},t.prototype.sqrt=function(n){var r=new Be(n.shape,"return sqrt(x);");return this.compileAndRun(r,[n])},t.prototype.rsqrt=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.rsqrt(n);var r=new Be(n.shape,"return inversesqrt(x);");return this.compileAndRun(r,[n])},t.prototype.reciprocal=function(n){var r=new Be(n.shape,"return 1.0 / x;");return this.compileAndRun(r,[n])},t.prototype.relu=function(n){var r;return r=ee().getBool("WEBGL_PACK")?new ko(n.shape,GN):new Be(n.shape,VN),this.compileAndRun(r,[n])},t.prototype.relu6=function(n){var r;return r=ee().getBool("WEBGL_PACK")?new ko(n.shape,KN):new Be(n.shape,HN),this.compileAndRun(r,[n])},t.prototype.prelu=function(n,r){var s=ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new na(WN,n.shape,r.shape):new wt(UN,n.shape,r.shape);return this.compileAndRun(s,[n,r])},t.prototype.elu=function(n){if(ee().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,XN,n.dtype);var r=new Be(n.shape,qN);return this.compileAndRun(r,[n])},t.prototype.eluDer=function(n,r){var s=ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new na(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,n.shape,r.shape):new wt("return (b >= 1.0) ? a : a * (b + 1.0);",n.shape,r.shape);return this.compileAndRun(s,[n,r])},t.prototype.selu=function(n){var r=new Be(n.shape,IA);return this.compileAndRun(r,[n])},t.prototype.int=function(n){var r=new Be(n.shape,"return float(int(x));");return this.compileAndRun(r,[n],"int32")},t.prototype.clip=function(n,r,s){var i,o=(i=ee().getBool("WEBGL_PACK_CLIP")?new fT(n.shape):new pT(n.shape)).getCustomSetupFunc(r,s);return this.compileAndRun(i,[n],null,o)},t.prototype.abs=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.abs(n);if(ee().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,nb,n.dtype);var r=new Be(n.shape,nb);return this.compileAndRun(r,[n])},t.prototype.complexAbs=function(n){var r=this.texData.get(n.dataId),s=new mT(n.shape),i=[this.makeComplexComponentTensorInfo(n,r.complexTensors.real),this.makeComplexComponentTensorInfo(n,r.complexTensors.imag)];return this.compileAndRun(s,i)},t.prototype.sigmoid=function(n){var r=new Be(n.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[n])},t.prototype.softplus=function(n){var r=new Be(n.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[n])},t.prototype.sin=function(n){var r=new Be(n.shape,PA);return this.compileAndRun(r,[n])},t.prototype.cos=function(n){var r=new Be(n.shape,FA);return this.compileAndRun(r,[n])},t.prototype.tan=function(n){var r=new Be(n.shape,"return tan(x);");return this.compileAndRun(r,[n])},t.prototype.asin=function(n){var r=new Be(n.shape,MA);return this.compileAndRun(r,[n])},t.prototype.acos=function(n){var r=new Be(n.shape,LA);return this.compileAndRun(r,[n])},t.prototype.atan=function(n){var r=new Be(n.shape,OA);return this.compileAndRun(r,[n])},t.prototype.atan2=function(n,r){var s=ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new na(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new wt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,n.shape,r.shape);return this.compileAndRun(s,[n,r])},t.prototype.sinh=function(n){var r=new Be(n.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.cosh=function(n){var r=new Be(n.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.tanh=function(n){var r=new Be(n.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[n])},t.prototype.asinh=function(n){var r=new Be(n.shape,BA);return this.compileAndRun(r,[n])},t.prototype.acosh=function(n){var r=new Be(n.shape,$A);return this.compileAndRun(r,[n])},t.prototype.atanh=function(n){var r=new Be(n.shape,zA);return this.compileAndRun(r,[n])},t.prototype.erf=function(n){var r=new Be(n.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[n])},t.prototype.step=function(n,r){var s=new Be(n.shape,function(i){return i===void 0&&(i=0),Sr+`
    return x > 0.0 ? 1.0 : float(`+i+`);
  `}(r));return this.compileAndRun(s,[n])},t.prototype.conv2dByMatMul=function(n,r,s,i,o,l){var c=n.shape,u=this.texData.get(n.dataId),d=s.inChannels,h=c[0]*c[1]*c[2],p=s.outChannels,f=s.dataFormat==="channelsLast",x=(h===1||p===1)&&d>1e3,v=c[2]%2!=0&&!!u.isPacked;if(x||!ee().getBool("WEBGL_LAZILY_UNPACK")||!ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!v){var y=f?c[0]*c[1]*c[2]:c[0]*c[2]*c[3],m=this.reshape(n,[1,y,s.inChannels]),g=this.reshape(r,[1,s.inChannels,s.outChannels]);return this.reshape(this.fusedBatchMatMul({a:m,b:g,transposeA:!1,transposeB:!1,bias:i,activation:o,preluActivationWeights:l}),s.outShape)}var b=f?c[0]*c[1]*(c[2]+1):c[0]*c[2]*(c[3]+1),w={dataId:n.dataId,shape:[1,b,s.inChannels],dtype:n.dtype},N=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,M(uc(u.shape,w.shape),function(){return"packed reshape "+u.shape+" to "+w.shape+" isn't free"});var C=this.reshape(r,[1,s.inChannels,s.outChannels]),D=this.fusedBatchMatMul({a:w,b:C,transposeA:!1,transposeB:!1,bias:i,activation:o,preluActivationWeights:l}),j=this.texData.get(D.dataId);return M(j.isPacked,function(){return"batchMatMul result is expected to be packed"}),u.shape=N,j.shape=s.outShape,V.makeTensorFromDataId(D.dataId,s.outShape,D.dtype)},t.prototype.conv2dWithIm2Row=function(n,r,s,i,o,l){var c=s.filterWidth,u=s.filterHeight,d=s.inChannels,h=s.outWidth,p=s.outHeight,f=s.dataFormat==="channelsLast",x=c*u*d,v=p*h,y=[x,v],m=n.squeeze([0]),g=r.reshape([1,x,-1]),b=new rA(y,m.shape,s),w=this.compileAndRun(b,[m]).reshape([1,y[0],y[1]]),N=i!=null,C=l!=null,D=o?fc(o,!0):null,j=new kh(w.shape,[1,v,s.outChannels],!0,!1,N,D,C),k=[w,g];i&&k.push(i),C&&k.push(l);var R=this.compileAndRun(j,k);return f?R.reshape([1,p,h,s.outChannels]):R.reshape([1,s.outChannels,p,h])},t.prototype.fusedConv2d=function(n){var r=n.input,s=n.filter,i=n.convInfo,o=n.bias,l=n.activation,c=n.preluActivationWeights;if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(r,s,i,o,l,c);if(ee().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,s,i,o,l,c);var u=o!=null,d=c!=null,h=l?fc(l,!1):null,p=new Gy(i,u,h,d),f=[r,s];return o&&f.push(o),c&&f.push(c),this.compileAndRun(p,f)},t.prototype.conv2d=function(n,r,s){if(s.filterHeight===1&&s.filterWidth===1&&s.dilationHeight===1&&s.dilationWidth===1&&s.strideHeight===1&&s.strideWidth===1&&(s.padInfo.type==="SAME"||s.padInfo.type==="VALID"))return this.conv2dByMatMul(n,r,s);if(ee().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,r,s);var i=new Gy(s);return this.compileAndRun(i,[n,r])},t.prototype.conv2dDerInput=function(n,r,s){var i=new yT(s);return this.compileAndRun(i,[n,r])},t.prototype.conv2dDerFilter=function(n,r,s){var i=new vT(s);return this.compileAndRun(i,[n,r])},t.prototype.fusedDepthwiseConv2D=function(n){var r,s=n.input,i=n.filter,o=n.convInfo,l=n.bias,c=n.activation,u=n.preluActivationWeights,d=ee().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1,h=c?fc(c,d):null,p=[s,i],f=l!=null,x=u!=null;return f&&p.push(l),x&&p.push(u),d?(r=new Xy(o,f,h,x),this.compileAndRun(r,p)):(r=new Ky(o,f,h,x),this.compileAndRun(r,p))},t.prototype.depthwiseConv2D=function(n,r,s){var i;return ee().getBool("WEBGL_PACK_DEPTHWISECONV")&&s.strideWidth<=2&&s.outChannels/s.inChannels==1?(i=new Xy(s),this.compileAndRun(i,[n,r])):(i=new Ky(s),this.compileAndRun(i,[n,r]))},t.prototype.depthwiseConv2DDerInput=function(n,r,s){var i=new jT(s);return this.compileAndRun(i,[n,r])},t.prototype.depthwiseConv2DDerFilter=function(n,r,s){var i=new NT(s);return this.compileAndRun(i,[n,r])},t.prototype.conv3d=function(n,r,s){var i=new CT(s);return this.compileAndRun(i,[n,r])},t.prototype.conv3dDerInput=function(n,r,s){var i=new wT(s);return this.compileAndRun(i,[n,r])},t.prototype.conv3dDerFilter=function(n,r,s){var i=new bT(s);return this.compileAndRun(i,[n,r])},t.prototype.maxPool=function(n,r){var s=new Sh(r,"max",!1);return this.compileAndRun(s,[n])},t.prototype.avgPool=function(n,r){var s=new Sh(r,"avg",!1);return this.compileAndRun(s,[n],"float32")},t.prototype.maxPoolBackprop=function(n,r,s,i){var o=new Sh(i,"max",!0),l=this.compileAndRun(o,[r]),c=new oA(i),u=this.compileAndRun(c,[n,l],r.dtype);return l.dispose(),u},t.prototype.avgPoolBackprop=function(n,r,s){var i=new oT(s);return this.compileAndRun(i,[n],r.dtype)},t.prototype.cast=function(n,r){return IN(n,r,this)},t.prototype.unstack=function(n,r){for(var s=n.shape[r],i=new Array(n.rank-1),o=0,l=0;l<n.rank;l++)l!==r&&(i[o++]=n.shape[l]);var c=new Array(n.rank).fill(0),u=n.shape.slice();u[r]=1;var d=new Array(s);for(l=0;l<d.length;l++)c[r]=l,d[l]=this.slice(n,c,u).reshape(i);return d},t.prototype.avgPool3d=function(n,r){var s=new Eh(r,"avg",!1);return this.compileAndRun(s,[n],"float32")},t.prototype.avgPool3dBackprop=function(n,r,s){var i=new lT(s);return this.compileAndRun(i,[n],r.dtype)},t.prototype.maxPool3d=function(n,r){var s=new Eh(r,"max",!1);return this.compileAndRun(s,[n],"float32")},t.prototype.maxPool3dBackprop=function(n,r,s,i){var o=new Eh(i,"max",!0),l=this.compileAndRun(o,[r]),c=new lA(i),u=this.compileAndRun(c,[n,l],r.dtype);return l.dispose(),u},t.prototype.reshape=function(n,r){var s=this.texData.get(n.dataId);if(s.isPacked&&!uc(n.shape,r)&&(s.texture===null||!uc(s.shape,r))){var i=this.packedReshape(n,r);return V.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return sf(n,r)},t.prototype.resizeBilinear=function(n,r,s,i){var o=ee().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new vA(n.shape,r,s,i):new gA(n.shape,r,s,i);return this.compileAndRun(o,[n],"float32")},t.prototype.resizeBilinearBackprop=function(n,r,s){var i=new xA(n,r,s);return this.compileAndRun(i,[n])},t.prototype.resizeNearestNeighbor=function(n,r,s,i){var o=new bA(n.shape,r,s,i);return this.compileAndRun(o,[n])},t.prototype.resizeNearestNeighborBackprop=function(n,r,s){var i=new yA(n,r,s);return this.compileAndRun(i,[n])},t.prototype.multinomial=function(n,r,s,i){var o=r?n:ja(n),l=o.shape[0],c=o.shape[1],u=new cA(l,c,s),d=u.getCustomSetupFunc(i);return this.compileAndRun(u,[o],"int32",d)},t.prototype.oneHot=function(n,r,s,i){var o=new uA(n.size,r,s,i);return this.compileAndRun(o,[n])},t.prototype.diag=function(n){var r=new _T(n.size);return this.compileAndRun(r,[n])},t.prototype.nonMaxSuppression=function(n,r,s,i,o){return Cu("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),Bm(n.dataSync(),r.dataSync(),s,i,o)},t.prototype.cropAndResize=function(n,r,s,i,o,l){var c=new kT(n.shape,r.shape,i,o,l);return this.compileAndRun(c,[n,r,s],"float32")},t.prototype.depthToSpace=function(n,r,s){M(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var i=n.shape[0],o=s==="NHWC"?n.shape[1]:n.shape[2],l=s==="NHWC"?n.shape[2]:n.shape[3],c=s==="NHWC"?n.shape[3]:n.shape[1],u=o*r,d=l*r,h=c/(r*r),p=new RT(s==="NHWC"?[i,u,d,h]:[i,h,u,d],r,s);return this.compileAndRun(p,[n])},t.prototype.split=function(n,r,s){return MN(n,r,s)},t.prototype.scatterND=function(n,r,s){var i=_u(0,n,s),o=i.sliceRank,l=i.numUpdates,c=i.sliceSize,u=i.strides,d=i.outputSize,h=[d/c,c],p=n.reshape([l,o]),f=r.reshape([l,c]);if(d===0)return sf(en([]),s);var x=fe(0),v=new Zy(l,o,p.rank,f.rank,u,h);return this.compileAndRun(v,[f,p,x]).reshape(s)},t.prototype.sparseToDense=function(n,r,s,i){var o=_u(0,n,s),l=o.sliceRank,c=o.numUpdates,u=o.strides,d=o.outputSize,h=new Zy(c,l,n.rank,r.rank,u,[d,1]);return this.compileAndRun(h,[r,n,i]).reshape(s)},t.prototype.fft=function(n){return this.fftImpl(n,!1)},t.prototype.ifft=function(n){return this.fftImpl(n,!0)},t.prototype.fftImpl=function(n,r){var s=this.texData.get(n.dataId),i=new Qy(FT,n.shape,r),o=new Qy(MT,n.shape,r),l=[this.makeComplexComponentTensorInfo(n,s.complexTensors.real),this.makeComplexComponentTensorInfo(n,s.complexTensors.imag)],c=this.compileAndRun(i,l),u=this.compileAndRun(o,l),d=this.complex(c,u).as2D(n.shape[0],n.shape[1]);return c.dispose(),u.dispose(),d},t.prototype.gatherND=function(n,r){var s=r.shape,i=s[s.length-1],o=SN(n,r),l=o[0],c=o[1],u=o[2],d=o[3],h=r.reshape([c,i]),p=n.reshape([n.size/u,u]),f=new BT(i,d,[c,u]);return this.compileAndRun(f,[p,h]).reshape(l)},t.prototype.fill=function(n,r,s){if((s=s||Dl(r))==="string"){var i=bu(s,je(n));return i.fill(r),V.makeTensor(i,n,s,this)}var o=new LT(n,r),l=o.getCustomSetupFunc(r);return this.compileAndRun(o,[],s,l)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){return this.fill(n.shape,n.dtype==="string"?"":0,n.dtype)},t.prototype.linspace=function(n,r,s){return PN(n,r,s)},t.prototype.makeTensorInfo=function(n,r){var s=this.write(null,n,r);return this.texData.get(s).usage=null,{dataId:s,shape:n,dtype:r}},t.prototype.makeOutput=function(n,r){var s=this.makeTensorInfo(n,r).dataId;return V.makeTensorFromDataId(s,n,r,this)},t.prototype.unpackTensor=function(n){var r=new WA(n.shape);return this.runWebGLProgram(r,[n],n.dtype)},t.prototype.packTensor=function(n){var r=new dA(n.shape);return this.runWebGLProgram(r,[n],n.dtype,null,!0)},t.prototype.packedReshape=function(n,r){var s=[Nu(n.shape)].concat(ju(n.shape)),i={dtype:n.dtype,shape:s,dataId:n.dataId},o=[Nu(r)].concat(ju(r)),l=new mA(o,s),c=this.runWebGLProgram(l,[i],n.dtype,null,!0);return{dataId:c.dataId,shape:r,dtype:c.dtype}},t.prototype.decode=function(n){var r,s=this.texData.get(n),i=s.isPacked,o=s.shape,l=s.dtype,c=wh(o);return r=i?new DT(c):new ET(c),{dtype:l,shape:o,dataId:this.runWebGLProgram(r,[{shape:c,dtype:l,dataId:n}],l,null,!0).dataId}},t.prototype.runWebGLProgram=function(n,r,s,i,o){var l=this;o===void 0&&(o=!1);var c=this.makeTensorInfo(n.outputShape,s),u=this.texData.get(c.dataId);if(n.packedOutput&&(u.isPacked=!0),n.outPackingScheme===hl.DENSE){var d=$o(n.outputShape);u.texShape=d.map(function(b){return 2*b})}if(n.outTexUsage!=null&&(u.usage=n.outTexUsage),je(c.shape)===0)return u.values=ul(c.dtype,0),c;var h=[],p=r.map(function(b){if(b.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var w=l.texData.get(b.dataId);if(w.texture==null){if(!n.packedInputs&&je(b.shape)<=ee().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:b.shape,texData:null,isUniform:!0,uniformValues:w.values};n.packedInputs&&(w.isPacked=!0,w.shape=b.shape)}else if(!!w.isPacked!=!!n.packedInputs)b=w.isPacked?l.unpackTensor(b):l.packTensor(b),h.push(b),w=l.texData.get(b.dataId);else if(w.isPacked&&!uc(w.shape,b.shape)){var N=b,C=b.shape;b.shape=w.shape,b=l.packedReshape(b,C),h.push(b),w=l.texData.get(b.dataId),N.shape=C}return l.uploadToGPU(b.dataId),{shape:b.shape,texData:w,isUniform:!1}});this.uploadToGPU(c.dataId);var f,x={shape:c.shape,texData:u,isUniform:!1},v=function(b,w,N){var C="";w.concat(N).forEach(function(k){var R=k.texData!=null&&k.texData.slice!=null&&k.texData.slice.flatOffset>0,E=k.isUniform?"uniform":k.texData.texShape;C+=k.shape+"_"+E+"_"+R});var D=b.userCode,j=b.constructor.name;return j+="_"+C+"_"+D}(n,p,x),y=this.getAndSaveBinary(v,function(){return function(b,w,N,C){var D=w.userCode,j=N.map(function(B,O){var H={logicalShape:B.shape,texShape:B.isUniform?null:B.texData.texShape,isUniform:B.isUniform,isPacked:!B.isUniform&&B.texData.isPacked,flatOffset:null};return B.texData!=null&&B.texData.slice!=null&&B.texData.slice.flatOffset>0&&(H.flatOffset=B.texData.slice.flatOffset),{name:w.variableNames[O],shapeInfo:H}}),k=j.map(function(B){return B.shapeInfo}),R={logicalShape:C.shape,texShape:C.texData.texShape,isUniform:!1,isPacked:C.texData.isPacked,flatOffset:null},E=tT(j,R,D,w.packedInputs),P=b.createProgram(E),F=null,W=b.getUniformLocation(P,"NAN",!1);ee().getNumber("WEBGL_VERSION")===1&&(F=b.getUniformLocation(P,"INFINITY",!1));for(var L={},U=0;U<w.variableNames.length;U++){var _=w.variableNames[U];L[_]=b.getUniformLocation(P,_,!1),L["offset"+_]=b.getUniformLocation(P,"offset"+_,!1)}return{program:w,source:E,webGLProgram:P,uniformLocations:L,inShapeInfos:k,outShapeInfo:R,infLoc:F,nanLoc:W}}(l.gpgpu,n,p,x)}),m=this.activeTimers!=null;if(m&&(f=this.startTimer()),function(b,w,N,C,D){Jy(w.inShapeInfos,N),Jy([w.outShapeInfo],[C]);var j=C.texData.texture,k=C.texData.texShape;C.texData.isPacked?b.setOutputPackedMatrixTexture(j,k[0],k[1]):b.setOutputMatrixTexture(j,k[0],k[1]),b.setProgram(w.webGLProgram),ee().getNumber("WEBGL_VERSION")===1&&w.infLoc!==null&&b.gl.uniform1f(w.infLoc,1/0),w.nanLoc!==null&&b.gl.uniform1f(w.nanLoc,NaN),N.forEach(function(R,E){var P=w.program.variableNames[E],F=w.uniformLocations[P],W=w.uniformLocations["offset"+P];if(F!=null)if(R.isUniform)if(je(R.shape)<2)b.gl.uniform1f(F,R.uniformValues[0]);else{var L=R.uniformValues;L instanceof Float32Array||(L=new Float32Array(L)),b.gl.uniform1fv(F,L)}else R.texData.slice!=null&&W!=null&&b.gl.uniform1i(W,R.texData.slice.flatOffset),b.setInputMatrixTexture(R.texData.texture,F,E)}),D!=null&&D(b,w.webGLProgram),b.executeProgram()}(this.gpgpu,y,p,x,i),h.forEach(function(b){return l.disposeData(b.dataId)}),m&&(f=this.endTimer(f),this.activeTimers.push({name:n.constructor.name,query:this.getQueryTime(f)})),!ee().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&o===!1){var g=this.unpackTensor(c);return this.disposeData(c.dataId),g}return c},t.prototype.compileAndRun=function(n,r,s,i,o){o===void 0&&(o=!1),s=s||r[0].dtype;var l=this.runWebGLProgram(n,r,s,i,o);return V.makeTensorFromDataId(l.dataId,l.shape,l.dtype)},t.prototype.getAndSaveBinary=function(n,r){return n in this.binaryCache||(this.binaryCache[n]=r()),this.binaryCache[n]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var n=this;this.disposed||(ee().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){n.gpgpu.deleteProgram(n.binaryCache[r].webGLProgram),delete n.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var n=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=me(function(){if(!ee().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=ee().getBool("DEBUG");ee().set("DEBUG",!1);var s=n.abs(fe(1e-8)).dataSync()[0];if(ee().set("DEBUG",r),s>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(n){var r,s=this.texData.get(n),i=s.shape,o=s.dtype,l=s.values,c=s.texture,u=s.usage,d=s.isPacked;if(c==null){var h,p=this.activeTimers!=null;p&&(h=Ir());var f=s.texShape;if(f==null&&(f=QR(i,d),s.texShape=f),l!=null){var x=wh(i),v=void 0,y=f[1],m=f[0],g=l instanceof Uint8Array;d?(y=(r=_l(f[0],f[1]))[0],m=r[1],v=new PT(x,[m,y],g)):v=new IT(x,[m,y],g);var b=this.makeTensorInfo([m,y],o);this.texData.get(b.dataId).usage=g?$n.PIXELS:$n.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),y,m,l);var w=this.runWebGLProgram(v,[b],o,null,!0),N=this.texData.get(w.dataId);s.texture=N.texture,s.texShape=N.texShape,s.isPacked=N.isPacked,s.usage=N.usage,this.disposeData(b.dataId),this.texData.delete(w.dataId),s.values=null,p&&(this.uploadWaitMs+=Ir()-h)}else{var C=this.acquireTexture(f,u,o,d);s.texture=C}}},t.prototype.convertAndCacheOnCPU=function(n,r){var s=this.texData.get(n),i=s.dtype;return this.releaseGPUData(n),r!=null&&(s.values=function(o,l){if(l==="float32"||l==="complex64")return o;if(l==="int32"||l==="bool"){for(var c=l==="int32"?new Int32Array(o.length):new Uint8Array(o.length),u=0;u<c.length;++u)c[u]=Math.round(o[u]);return c}throw new Error("Unknown dtype "+l)}(r,i)),s.values},t.prototype.acquireTexture=function(n,r,s,i){if(this.numBytesInGPU+=this.computeBytes(n,s),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+o+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(n,r,i)},t.prototype.computeBytes=function(n,r){return n[0]*n[1]*lN(r)},t}(TN);mN()&&V.registerBackend("webgl",function(){return new HA},2);var qA=z({square_:function(e){var t=T(e,"x","square"),n=[t];return V.runKernelFunc(function(r,s){return s([t]),r.square(t)},{x:t},null,"Square",{},n,[])}}),fl="SquaredDifference",YN=z({squaredDifference_:function(e,t){var n,r=T(e,"a","squaredDifference"),s=T(t,"b","squaredDifference");n=bt(r,s),r=n[0],s=n[1],He(r.shape,s.shape);var i={a:r,b:s},o=[r,s];return V.runKernelFunc(function(l,c){var u=l.squaredDifference(r,s);return c([r,s]),u},i,function(l,c){var u=c[0],d=c[1],h=fe(2);return{a:function(){return l.mul(u.sub(d).mul(h))},b:function(){return l.mul(d.sub(u).mul(h))}}},fl,{},o,[])}}),GA=z({abs_:function(e){var t=T(e,"x","abs");return t.dtype==="complex64"?V.runKernelFunc(function(n){return n.complexAbs(t)},{$x:t}):V.runKernelFunc(function(n,r){var s=n.abs(t);return r([t]),s},{x:t},function(n,r){var s=r[0];return{x:function(){return n.mul(s.toFloat().step(-1))}}},"Abs")}}),KA=z({acos_:function(e){var t=T(e,"x","acos");return V.runKernelFunc(function(n,r){var s=n.acos(t);return r([t]),s},{$x:t},function(n,r){var s=r[0];return{$x:function(){return n.divStrict(fe(1).sub(s.toFloat().square()).sqrt()).neg()}}})}}),XA=z({acosh_:function(e){var t=T(e,"x","acosh");return V.runKernelFunc(function(n,r){var s=n.acosh(t);return r([t]),s},{$x:t},function(n,r){var s=r[0];return{$x:function(){return n.divStrict(s.toFloat().square().sub(1).sqrt())}}})}}),YA=z({asin_:function(e){var t=T(e,"x","asin");return V.runKernelFunc(function(n,r){var s=n.asin(t);return r([t]),s},{$x:t},function(n,r){var s=r[0];return{$x:function(){return n.divStrict(fe(1).sub(s.toFloat().square()).sqrt())}}})}}),QA=z({asinh_:function(e){var t=T(e,"x","asinh");return V.runKernelFunc(function(n,r){var s=n.asinh(t);return r([t]),s},{$x:t},function(n,r){var s=r[0];return{$x:function(){return n.divStrict(fe(1).add(s.toFloat().square()).sqrt())}}})}}),JA=z({atan_:function(e){var t=T(e,"x","atan");return V.runKernelFunc(function(n,r){var s=n.atan(t);return r([t]),s},{$x:t},function(n,r){var s=r[0];return{$x:function(){return n.div(s.toFloat().square().add(1))}}})}}),ZA=z({atanh_:function(e){var t=T(e,"x","atanh");return V.runKernelFunc(function(n,r){var s=n.atanh(t);return r([t]),s},{$x:t},function(n,r){var s=r[0];return{$x:function(){return n.div(fe(1).sub(s.toFloat().square()))}}})}}),e6=z({ceil_:function(e){var t=T(e,"x","ceil");return V.runKernelFunc(function(n){return n.ceil(t)},{$x:t},function(n){return{$x:function(){return Ke(n)}}})}}),Hm=z({clipByValue_:function(e,t,n){var r=T(e,"x","clipByValue");M(t<=n,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."});var s=[r],i={min:t,max:n};return V.runKernelFunc(function(o,l){var c=o.clip(r,t,n);return l([r]),c},{x:r},function(o,l){var c=l[0];return{x:function(){return o.where(c.greaterEqual(t).logicalAnd(c.lessEqual(n)),Ke(o))}}},"ClipByValue",i,s)}}),t6=z({cos_:function(e){var t=T(e,"x","cos"),n=[t];return V.runKernelFunc(function(r,s){var i=r.cos(t);return s([t]),i},{x:t},function(r,s){var i=s[0];return{x:function(){return i.toFloat().sin().neg().mul(r)}}},"Cos",{},n)}}),n6=z({cosh_:function(e){var t=T(e,"x","cosh");return V.runKernelFunc(function(n,r){var s=n.cosh(t);return r([t]),s},{$x:t},function(n,r){var s=r[0];return{$x:function(){return s.toFloat().sinh().mulStrict(n)}}})}}),r6=z({erf_:function(e){var t=T(e,"x","erf");return M(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),V.runKernelFunc(function(n,r){var s=n.erf(t);return r([t]),s},{$x:t},function(n,r){var s=r[0];return{$x:function(){return n.mul(s.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),lf=z({exp_:function(e){var t=T(e,"x","exp");return V.runKernelFunc(function(n,r){var s=n.exp(t);return r([s]),s},{x:t},function(n,r){return{x:function(){return n.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),a6=z({expm1_:function(e){var t=T(e,"x","expm1");return V.runKernelFunc(function(n,r){var s=n.expm1(t);return r([t]),s},{$x:t},function(n,r){var s=r[0];return{$x:function(){return n.mul(s.exp())}}})}}),s6=z({floor_:function(e){var t=T(e,"x","floor");return V.runKernelFunc(function(n){return n.floor(t)},{$x:t},function(n){return{$x:function(){return Ke(n)}}})}}),i6=z({log_:function(e){var t=T(e,"x","log"),n=[t];return V.runKernelFunc(function(r,s){var i=r.log(t);return s([t]),i},{x:t},function(r,s){var i=s[0];return{x:function(){return r.div(i.toFloat())}}},"Log",{},n)}}),o6=z({log1p_:function(e){var t=T(e,"x","log1p");return V.runKernelFunc(function(n,r){var s=n.log1p(t);return r([t]),s},{$x:t},function(n,r){var s=r[0];return{$x:function(){return n.div(s.add(1))}}})}}),l6=z({logSigmoid_:function(e){var t=T(e,"x","logSigmoid");return V.runKernelFunc(function(n,r){var s=n.softplus(t.neg()).neg();return r([t]),s},{$x:t},function(n,r){var s=r[0];return{$x:function(){return n.mul(s.neg().sigmoid())}}})}}),Pu=z({neg_:function(e){var t=T(e,"x","neg"),n=[t];return V.runKernelFunc(function(r){return r.neg(t)},{x:t},function(r){return{x:function(){return r.neg()}}},"Neg",{},n)}}),c6=z({reciprocal_:function(e){var t=T(e,"x","reciprocal");return V.runKernelFunc(function(n,r){var s=n.reciprocal(t);return r([t]),s},{$x:t},function(n,r){var s=r[0];return{$x:function(){return n.div(s.square().neg())}}})}}),u6=z({round_:function(e){var t=T(e,"x","round");return V.runKernelFunc(function(n){return n.round(t)},{$x:t},function(n){return{$x:function(){return Ke(n)}}})}}),QN=z({rsqrt_:function(e){var t=T(e,"x","rsqrt"),n=[t];return V.runKernelFunc(function(r,s){var i=r.rsqrt(t);return s([t]),i},{x:t},function(r,s){var i=s[0];return{x:function(){return r.div(i.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),JN=z({sigmoid_:function(e){var t=T(e,"x","sigmoid");return V.runKernelFunc(function(n,r){var s=n.sigmoid(t);return r([s]),s},{x:t},function(n,r){var s=r[0];return{x:function(){return n.mul(s.mul(fe(1).sub(s)))}}},"Sigmoid")}}),d6=z({sign_:function(e){var t=T(e,"x","sign");return V.runKernelFunc(function(n){return n.sign(t)},{$x:t},function(n){return{$x:function(){return Ke(n)}}})}}),h6=z({isNaN_:function(e){var t=T(e,"x","isNaN");return V.runKernelFunc(function(n){return n.isNaN(t)},{$x:t},function(n){return{$x:function(){return Ke(n)}}})}}),p6=z({isInf_:function(e){var t=T(e,"x","isInf");return V.runKernelFunc(function(n){return n.isInf(t)},{$x:t},function(n){return{$x:function(){return Ke(n)}}})}}),f6=z({isFinite_:function(e){var t=T(e,"x","isFinite");return V.runKernelFunc(function(n){return n.isFinite(t)},{$x:t},function(n){return{$x:function(){return Ke(n)}}})}}),m6=z({sin_:function(e){var t=T(e,"x","sin"),n=[t];return V.runKernelFunc(function(r,s){var i=r.sin(t);return s([t]),i},{x:t},function(r,s){var i=s[0];return{x:function(){return i.toFloat().cos().mul(r)}}},"Sin",{},n)}}),x6=z({sinh_:function(e){var t=T(e,"x","sinh");return V.runKernelFunc(function(n,r){var s=n.sinh(t);return r([t]),s},{$x:t},function(n,r){var s=r[0];return{$x:function(){return s.toFloat().cosh().mulStrict(n)}}})}}),g6=z({softplus_:function(e){var t=T(e,"x","softplus");return V.runKernelFunc(function(n,r){var s=n.softplus(t);return r([t]),s},{$x:t},function(n,r){var s=r[0];return{$x:function(){return n.mul(s.sigmoid())}}})}}),v6=z({sqrt_:function(e){var t=T(e,"x","sqrt");return V.runKernelFunc(function(n,r){var s=n.sqrt(t);return r([t]),s},{$x:t},function(n,r){var s=r[0];return{$x:function(){return n.div(s.toFloat().sqrt().mul(2))}}})}}),y6=z({step_:function(e,t){t===void 0&&(t=0);var n=T(e,"x","step");return V.runKernelFunc(function(r){return r.step(n,t)},{$x:n},function(r){return{$x:function(){return Ke(r)}}})}}),b6=z({tan_:function(e){var t=T(e,"x","tan");return V.runKernelFunc(function(n,r){var s=n.tan(t);return r([t]),s},{$x:t},function(n,r){var s=r[0];return{$x:function(){return n.div(s.cos().square())}}})}}),w6=z({tanh_:function(e){var t=T(e,"x","tanh");return V.runKernelFunc(function(n,r){var s=n.tanh(t);return r([s]),s},{x:t},function(n,r){var s=r[0];return{x:function(){return fe(1).sub(s.square()).mulStrict(n)}}},"Tanh",{},null,[!0])}});function ZN(e,t,n,r,s,i){var o,l,c=T(e,"x","batchNorm"),u=T(t,"mean","batchNorm"),d=T(n,"variance","batchNorm");return s!=null&&(o=T(s,"scale","batchNorm")),r!=null&&(l=T(r,"offset","batchNorm")),M(c.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+c.rank+"."}),M(u.rank===2||u.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+u.rank+"."}),M(d.rank===2||d.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+d.rank+"."}),o!=null&&M(o.rank===2||o.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+o.rank+"."}),l!=null&&M(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+l.rank+"."}),Al(c,u,d,l,o,i)}function ej(e,t,n,r,s,i){var o,l,c=T(e,"x","batchNorm"),u=T(t,"mean","batchNorm"),d=T(n,"variance","batchNorm");return s!=null&&(o=T(s,"scale","batchNorm")),r!=null&&(l=T(r,"offset","batchNorm")),M(c.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+c.rank+"."}),M(u.rank===3||u.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+u.rank+"."}),M(d.rank===3||d.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+d.rank+"."}),o!=null&&M(o.rank===3||o.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+o.rank+"."}),l!=null&&M(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+l.rank+"."}),Al(c,u,d,l,o,i)}function tj(e,t,n,r,s,i){var o,l,c=T(e,"x","batchNorm"),u=T(t,"mean","batchNorm"),d=T(n,"variance","batchNorm");return s!=null&&(o=T(s,"scale","batchNorm")),r!=null&&(l=T(r,"offset","batchNorm")),M(c.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+c.rank+"."}),M(u.rank===4||u.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+u.rank+"."}),M(d.rank===4||d.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+d.rank+"."}),o!=null&&M(o.rank===4||o.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+o.rank+"."}),l!=null&&M(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+l.rank+"."}),Al(c,u,d,l,o,i)}function Al(e,t,n,r,s,i){i==null&&(i=.001);var o,l,c,u=T(e,"x","batchNorm"),d=T(t,"mean","batchNorm"),h=T(n,"variance","batchNorm");s!=null&&(o=T(s,"scale","batchNorm")),r!=null&&(l=T(r,"offset","batchNorm")),M(d.rank===h.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),M(l==null||d.rank===l.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),M(o==null||d.rank===o.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),c=u.rank===0||u.rank===1?u.as4D(1,1,1,u.size):u.rank===2?u.as4D(1,1,u.shape[0],u.shape[1]):u.rank===3?u.as4D(1,u.shape[0],u.shape[1],u.shape[2]):u;var p=[u,d,h,o];return V.runKernelFunc(function(f,x){var v=f.batchNormalization(c,mc(d),mc(h),i,mc(o),mc(l));return x([u,d,h,o]),v},{x:u,mean:d,variance:h,scale:o,offset:l},function(f,x){var v=x,y=v[0],m=v[1],g=v[2],b=v[3],w=b??fe(1),N=$t(m.shape,c.shape),C=[];if(m.rank===1){for(var D=0;D<c.shape.length-1;++D)C.push(c.shape[D]);C.push(1)}var j=y.sub(m),k=f.mul(w),R=QN(g.add(fe(i))),E=R.mul(R).mul(R).mul(fe(-.5));return{x:function(){return m.rank===1?f.mul(Ti(R.as4D(1,1,1,m.shape[0]),C)).mul(w).reshape(y.shape):f.mul(R).mul(w).reshape(y.shape)},mean:function(){var P=R.mul(fe(-1)).mul(k);return m.rank===1&&(P=P.sum(N)),P.reshape(m.shape)},variance:function(){var P=E.mul(j).mul(k);return m.rank===1&&(P=P.sum(N)),P.reshape(m.shape)},scale:function(){var P=j.mul(R),F=f.mul(P);return m.rank===1&&(F=F.sum(N)),F.reshape(m.shape)},offset:function(){var P=f;return m.rank===1&&(P=P.sum(N)),P.reshape(m.shape)}}},"BatchNormalization",{varianceEpsilon:i},p).reshape(u.shape)}function mc(e){return e==null?null:e.rank===0?e.as1D():e.rank===1?e:e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function yd(){xN("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var N6=z({batchNormalization2d_:function(e,t,n,r,s,i){return r===void 0&&(r=.001),yd(),ZN(e,t,n,i,s,r)}}),j6=z({batchNormalization3d_:function(e,t,n,r,s,i){return r===void 0&&(r=.001),yd(),ej(e,t,n,i,s,r)}}),C6=z({batchNormalization4d_:function(e,t,n,r,s,i){return r===void 0&&(r=.001),yd(),tj(e,t,n,i,s,r)}}),k6=z({batchNormalization_:function(e,t,n,r,s,i){return r===void 0&&(r=.001),yd(),Al(e,t,n,i,s,r)}}),nj=z({batchNorm_:Al}),S6=z({batchNorm2d_:ZN}),E6=z({batchNorm3d_:ej}),D6=z({batchNorm4d_:tj}),bd=z({logicalAnd_:function(e,t){var n=T(e,"a","logicalAnd","bool"),r=T(t,"b","logicalAnd","bool");return He(n.shape,r.shape),V.runKernelFunc(function(s){return s.logicalAnd(n,r)},{a:n,b:r},null,"LogicalAnd")}}),R6=z({logicalNot_:function(e){var t=T(e,"x","logicalNot","bool");return V.runKernelFunc(function(n){return n.logicalNot(t)},{$x:t})}}),rj=z({logicalOr_:function(e,t){var n=T(e,"a","logicalOr","bool"),r=T(t,"b","logicalOr","bool");return He(n.shape,r.shape),V.runKernelFunc(function(s){return s.logicalOr(n,r)},{$a:n,$b:r})}}),_6=z({logicalXor_:function(e,t){var n=T(e,"a","logicalXor","bool"),r=T(t,"b","logicalXor","bool");return He(n.shape,r.shape),rj(e,t).logicalAnd(bd(e,t).logicalNot())}}),Hs=z({where_:function(e,t,n){var r=T(t,"a","where"),s=T(n,"b","where"),i=T(e,"condition","where","bool");return Ze(r.shape,s.shape,"Error in where: "),i.rank===1?M(i.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):Ze(i.shape,s.shape,"Error in where: "),V.runKernelFunc(function(o,l){var c=o.select(i,r,s);return l([i]),c},{$condition:i,$a:r,$b:s},function(o,l){var c=l[0];return{$condition:function(){return Ke(c).toFloat()},$a:function(){return o.mul(c.cast(o.dtype))},$b:function(){return o.mul(c.logicalNot().cast(o.dtype))}}})}}),aj=function(e){return we(this,void 0,void 0,function(){var t,n,r;return Ne(this,function(s){switch(s.label){case 0:return[4,(t=T(e,"condition","whereAsync","bool")).data()];case 1:return n=s.sent(),r=zm(t.shape,n),e!==t&&t.dispose(),[2,r]}})})},Ve=z({add_:function(e,t){var n,r=T(e,"a","add"),s=T(t,"b","add");n=bt(r,s),r=n[0],s=n[1];var i=He(r.shape,s.shape);return V.runKernelFunc(function(o){return o.add(r,s)},{a:r,b:s},function(o){return{a:function(){var l=o,c=$t(r.shape,i);return c.length>0&&(l=l.sum(c)),l.reshape(r.shape)},b:function(){var l=o,c=$t(s.shape,i);return c.length>0&&(l=l.sum(c)),l.reshape(s.shape)}}},"Add")}}),T6=z({addN_:function(e){M(Array.isArray(e),function(){return"The argument passed to tf.addN() must be a list of tensors"}),M(e.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length});var t=e.map(function(s,i){return T(s,"tensors"+i,"addN")}),n=t[0];t.forEach(function(s){if(s.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(s){if(!Xt(s.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=t;return V.runKernelFunc(function(s){return s.addN(t)},r,function(s){var i={};return t.forEach(function(o,l){i[l]=function(){return s.clone()}}),i},"AddN")}}),A6=z({addStrict_:function(e,t){var n=T(e,"a","addStrict"),r=T(t,"b","addStrict");return Ze(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),I6=z({atan2_:function(e,t){var n,r=T(e,"a","atan2"),s=T(t,"b","atan2");n=bt(r,s),r=n[0],s=n[1];var i=He(r.shape,s.shape);return V.runKernelFunc(function(o,l){var c=o.atan2(r,s);return l([r,s]),c},{$a:r,$b:s},function(o,l){var c=l[0],u=l[1];return{$a:function(){var d=Ve(c.square(),u.square()),h=o.mul(u.div(d)),p=$t(c.shape,i);return p.length>0&&(h=h.sum(p)),h.reshape(c.shape)},$b:function(){var d=Ve(c.square(),u.square()),h=Pu(o.mul(c.div(d))),p=$t(u.shape,i);return p.length>0&&(h=h.sum(p)),h.reshape(u.shape)}}})}}),mr=z({div_:function(e,t){var n,r=T(e,"a","div"),s=T(t,"b","div");if(n=bt(r,s),r=n[0],s=n[1],r.dtype==="int32"&&s.dtype==="int32")return sj(r,s);var i=He(r.shape,s.shape);return V.runKernelFunc(function(o,l){var c=o.realDivide(r,s);return l([r,s]),c},{a:r,b:s},function(o,l){var c=l[0],u=l[1];return{a:function(){var d=o.div(u.toFloat()),h=$t(c.shape,i);return h.length>0?d.sum(h).reshape(c.shape):d},b:function(){var d=o.mul(c.toFloat()),h=$t(u.shape,i);h.length>0&&(d=d.sum(h).reshape(u.shape));var p=u.square();return d.div(p.toFloat()).neg()}}},"Div")}}),P6=z({divNoNan_:function(e,t){var n,r=T(e,"a","div"),s=T(t,"b","div");r=(n=bt(r,s))[0],s=n[1];var i=mr(r,s),o=Ke(i),l=s.equal(o);return Hs(l,o,i)}}),F6=z({divStrict_:function(e,t){var n=T(e,"a","div"),r=T(t,"b","div");return Ze(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),sj=z({floorDiv_:function(e,t){var n,r=T(e,"a","floorDiv"),s=T(t,"b","floorDiv");n=bt(r,s),r=n[0],s=n[1];var i=He(r.shape,s.shape);return V.runKernelFunc(function(o,l){var c=o.floorDiv(r,s);return l([r,s]),c},{a:r,b:s},function(o,l){var c=l[0],u=l[1];return{a:function(){var d=o.div(u.toFloat()),h=$t(c.shape,i);return h.length>0?d.sum(h).reshape(c.shape):d},b:function(){var d=o.mul(c.toFloat()),h=$t(u.shape,i);h.length>0&&(d=d.sum(h).reshape(u.shape));var p=u.square();return d.div(p.toFloat()).neg()}}},"FloorDiv")}}),qm=z({maximum_:function(e,t){var n,r=T(e,"a","maximum"),s=T(t,"b","maximum");return n=bt(r,s),r=n[0],s=n[1],r.dtype==="bool"&&(r=r.toInt(),s=s.toInt()),He(r.shape,s.shape),V.runKernelFunc(function(i,o){var l=i.maximum(r,s);return o([r,s]),l},{a:r,b:s},function(i,o){var l=o[0],c=o[1];return{a:function(){return i.mul(l.greaterEqual(c).toFloat())},b:function(){return i.mul(l.less(c).toFloat())}}},"Maximum")}}),M6=z({maximumStrict_:function(e,t){var n=T(e,"a","maximumStrict"),r=T(t,"b","maximumStrict");return Ze(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),ij=z({minimum_:function(e,t){var n,r=T(e,"a","minimum"),s=T(t,"b","minimum");return n=bt(r,s),r=n[0],s=n[1],r.dtype==="bool"&&(r=r.toInt(),s=s.toInt()),He(r.shape,s.shape),V.runKernelFunc(function(i,o){var l=i.minimum(r,s);return o([r,s]),l},{a:r,b:s},function(i,o){var l=o[0],c=o[1];return{a:function(){return i.mul(l.lessEqual(c).toFloat())},b:function(){return i.mul(l.greater(c).toFloat())}}},"Minimum")}}),L6=z({minimumStrict_:function(e,t){var n=T(e,"a","minimumStrict"),r=T(t,"b","minimumStrict");return Ze(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),O6=z({mod_:function(e,t){var n,r=T(e,"a","mod"),s=T(t,"b","mod");n=bt(r,s),r=n[0],s=n[1];var i=He(r.shape,s.shape);return V.runKernelFunc(function(o,l){var c=o.mod(r,s);return l([r,s]),c},{$a:r,$b:s},function(o,l){var c=l[0],u=l[1];return{$a:function(){var d=$t(c.shape,i);return d.length>0?o.sum(d).reshape(c.shape):o},$b:function(){var d=o.mul(c.div(u).floor().neg()),h=$t(u.shape,i);return h.length>0?d.sum(h).reshape(u.shape):d}}})}}),B6=z({modStrict_:function(e,t){var n=T(e,"a","modStrict"),r=T(t,"b","modStrict");return Ze(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),hn=z({mul_:function(e,t){var n,r=T(e,"a","mul"),s=T(t,"b","mul");n=bt(r,s),r=n[0],s=n[1];var i=He(r.shape,s.shape);return V.runKernelFunc(function(o,l){var c=o.multiply(r,s);return l([r,s]),c},{a:r,b:s},function(o,l){var c=l[0],u=l[1];return{a:function(){var d=o.mul(u.toFloat()),h=$t(c.shape,i);return h.length>0?d.sum(h).reshape(c.shape):d},b:function(){var d=o.mul(c.toFloat()),h=$t(u.shape,i);return h.length>0?d.sum(h).reshape(u.shape):d}}},"Mul")}}),$6=z({mulStrict_:function(e,t){var n=T(e,"a","mul"),r=T(t,"b","mul");return Ze(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),Fu=z({pow_:function(e,t){var n,r=T(e,"base","pow"),s=T(t,"exp","pow");n=bt(r,s),r=n[0],s=n[1];var i=He(r.shape,s.shape),o=[r,s];return V.runKernelFunc(function(l,c){var u=l.pow(r,s);return c([r,s,u]),u},{a:r,b:s},function(l,c){var u=c[0],d=c[1],h=c[2];return{a:function(){var p=d.toFloat(),f=l.mul(p.mul(u.pow(p.sub(fe(1))))),x=$t(u.shape,i);return x.length>0&&(f=f.sum(x)),f.reshape(u.shape)},b:function(){var p=u.greater(0),f=u.log().where(p,Ke(u)),x=l.mul(h.mul(f)),v=$t(d.shape,i);return v.length>0&&(x=x.sum(v)),x.reshape(d.shape)}}},"Pow",{},o,[!0])}}),z6=z({powStrict_:function(e,t){return Ze(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),U6=z({squaredDifferenceStrict_:function(e,t){var n=T(e,"a","squaredDifferenceStrict"),r=T(t,"b","squaredDifferenceStrict");return Ze(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),zt=z({sub_:function(e,t){var n,r=T(e,"a","sub"),s=T(t,"b","sub");n=bt(r,s),r=n[0],s=n[1];var i=He(r.shape,s.shape);return V.runKernelFunc(function(o){return o.subtract(r,s)},{a:r,b:s},function(o){return{a:function(){var l=o,c=$t(r.shape,i);return c.length>0&&(l=l.sum(c)),l.reshape(r.shape)},b:function(){var l=o,c=$t(s.shape,i);return c.length>0&&(l=l.sum(c)),l.neg().reshape(s.shape)}}},"Sub")}}),W6=z({subStrict_:function(e,t){var n=T(e,"a","subStrict"),r=T(t,"b","subStrict");return Ze(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),oj=z({equal_:function(e,t){var n,r=T(e,"a","equal"),s=T(t,"b","equal");return n=bt(r,s),r=n[0],s=n[1],He(r.shape,s.shape),V.runKernelFunc(function(i){return i.equal(r,s)},{$a:r,$b:s})}}),V6=z({equalStrict_:function(e,t){var n=T(e,"a","equalStrict"),r=T(t,"b","equalStrict");return Ze(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),H6=z({greater_:function(e,t){var n,r=T(e,"a","greater"),s=T(t,"b","greater");return n=bt(r,s),r=n[0],s=n[1],He(r.shape,s.shape),V.runKernelFunc(function(i){return i.greater(r,s)},{a:r,b:s},null,"Greater")}}),lj=z({greaterEqual_:function(e,t){var n,r=T(e,"a","greaterEqual"),s=T(t,"b","greaterEqual");return n=bt(r,s),r=n[0],s=n[1],He(r.shape,s.shape),V.runKernelFunc(function(i,o){var l=i.greaterEqual(r,s);return o([r,s]),l},{a:r,b:s},function(i,o){var l=o[0],c=o[1];return{a:function(){return Ke(l)},b:function(){return Ke(c)}}},"GreaterEqual")}}),q6=z({greaterEqualStrict_:function(e,t){var n=T(e,"a","greaterEqualStrict"),r=T(t,"b","greaterEqualStrict");return Ze(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),G6=z({greaterStrict_:function(e,t){var n=T(e,"a","greaterStrict"),r=T(t,"b","greaterStrict");return Ze(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),K6=z({less_:function(e,t){var n,r=T(e,"a","less"),s=T(t,"b","less");return n=bt(r,s),r=n[0],s=n[1],He(r.shape,s.shape),V.runKernelFunc(function(i){return i.less(r,s)},{a:r,b:s},null,"Less")}}),X6=z({lessEqual_:function(e,t){var n,r=T(e,"a","lessEqual"),s=T(t,"b","lessEqual");return n=bt(r,s),r=n[0],s=n[1],He(r.shape,s.shape),V.runKernelFunc(function(i,o){var l=i.lessEqual(r,s);return o([r,s]),l},{a:r,b:s},null,"LessEqual")}}),Y6=z({lessEqualStrict_:function(e,t){var n=T(e,"a","lessEqualStrict"),r=T(t,"b","lessEqualStrict");return Ze(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),Q6=z({lessStrict_:function(e,t){var n=T(e,"a","lessStrict"),r=T(t,"b","lessStrict");return Ze(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),J6=z({notEqual_:function(e,t){var n,r=T(e,"a","notEqual"),s=T(t,"b","notEqual");return n=bt(r,s),r=n[0],s=n[1],He(r.shape,s.shape),V.runKernelFunc(function(i){return i.notEqual(r,s)},{a:r,b:s},null,"NotEqual")}}),Z6=z({notEqualStrict_:function(e,t){var n=T(e,"a","notEqualStrict"),r=T(t,"b","notEqualStrict");return Ze(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function lb(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function cb(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var Gm=z({gather_:function(e,t,n){n===void 0&&(n=0);var r=T(e,"x","gather"),s=T(t,"indices","gather","int32");n=Ut(n,r.shape)[0];var i=function(o,l,c){for(var u=o.shape[c],d=[],h=1,p=1,f=0;f<c;f++)d.push(o.shape[f]),h*=o.shape[f];for(f=0;f<l.rank;f++)d.push(l.shape[f]);for(f=c+1;f<o.rank;f++)d.push(o.shape[f]),p*=o.shape[f];return{batchSize:h,sliceSize:p,dimSize:u,outputShape:d}}(r,s,n);return V.runKernelFunc(function(o,l){var c=o.gather(r,s.flatten(),n);return l([s]),c},{x:r,indices:s},function(o,l){var c=l[0];return{x:function(){var u=r.shape,d=c.size,h=u.slice(0,n),p=h.length,f=u.slice(n,u.length).slice(1),x=f.length,v=lb(0,p),y=lb(p+1,p+1+x),m=cb([h,[d],f]),g=o.reshape(m),b=c.reshape([d]),w=cb([[p],v,y]),N=g.transpose(w),C=cj(N,b,r.shape[n]),D=Im(w);return C=C.transpose(D)},indices:function(){return c}}},"Gather",{axis:n}).reshape(i.outputShape)}}),cj=z({unsortedSegmentSum_:function(e,t,n){var r=T(e,"x","unsortedSegmentSum"),s=T(t,"segmentIds","unsortedSegmentSum","int32");return M(Dt(n),function(){return"numSegments must be of dtype int"}),V.runKernelFunc(function(i,o){var l=i.unsortedSegmentSum(r,s,n);return o([s]),l},{$x:r},function(i,o){var l=o[0];return{$x:function(){return function(c,u){for(var d=qm(u,Ke(u)),h=Gm(c,d),p=lj(u,fe(0,"int32")),f=h.rank-p.rank,x=0;x<f;++x)p=Jn(p,x+1);p=bd(p,lo(h.shape,"bool"));var v=Ke(h);return Hs(p,h,v)}(i,l)}}})}}),eI=function(e,t,n){return we(this,void 0,void 0,function(){var r,s,i,o,l,c,u,d,h,p,f,x,v;return Ne(this,function(y){switch(y.label){case 0:for(r=T(e,"tensor","boolMask"),s=T(t,"mask","boolMask","bool"),i=n??0,o=s.rank,l=r.shape,M(o>0,function(){return"mask cannot be scalar"}),Ze(l.slice(i,i+o),s.shape,"mask's shape must match the first K dimensions of tensor's shape,"),c=1,u=i;u<i+o;u++)c*=l[u];return d=l.slice(0,i).concat([c],l.slice(i+o)),h=r.reshape(d),p=s.reshape([-1]),[4,aj(p)];case 1:return f=y.sent(),x=f.squeeze([1]),v=Gm(h,x,i),e!==r&&r.dispose(),t!==s&&s.dispose(),x.dispose(),h.dispose(),p.dispose(),f.dispose(),[2,v]}})})};function uj(e,t,n,r,s,i,o){i===void 0&&(i="NHWC"),M(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var l=e,c=t,u=!1;t.rank===3&&(u=!0,c=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),l=[1,e[0],e[1],e[2]]),M(l.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+l.length+"."}),M(c.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+c.rank}),M(n.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var d=i==="NHWC"?l[3]:l[1],h=i==="NHWC"?c.shape[3]:c.shape[1];M(d===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+d+") must match input depth for filter "+n.shape[2]+"."}),M(h===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+h+") must match output depth for filter "+n.shape[3]+"."}),o!=null&&M(Dt(s),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+s+"."});var p=Om(i),f=Js(l,n.shape,r,1,s,o,!1,p),x=V.runKernelFunc(function(v,y){var m=v.conv2dDerInput(c,n,f);return y([n,c]),m},{dy4D:c,filter:n},function(v,y){var m=y[0],g=y[1];return{dy4D:function(){return ur(v,m,r,s,i,1,o)},filter:function(){return Km(v,g,m.shape,r,s,i,o)}}});return u?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x}function Rh(e){var t=function(i){return typeof i=="number"?[i,i,i]:i.length===2?[i[0],i[1],1]:i}(e),n=t[0],r=t[1],s=t[2];return n===1&&r===1&&s===1}function dj(e,t,n,r,s){M(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var i=e,o=t,l=!1;t.rank===4&&(l=!0,o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,e[0],e[1],e[2],e[3]]);var c=i[4],u=o.shape[4];M(i.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),M(o.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+o.rank}),M(n.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),M(c===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+c+") must match input depth for filter "+n.shape[3]+"."}),M(u===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+u+") must match output depth for filter "+n.shape[4]+"."});var d=Au(i,n.shape,r,1,s),h=V.runKernelFunc(function(p){return p.conv3dDerInput(o,n,d)},{dy5D:o});return l?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}var tI=z({conv1d_:function(e,t,n,r,s,i,o){s===void 0&&(s="NWC"),i===void 0&&(i=1);var l=T(e,"x","conv1d"),c=T(t,"filter","conv1d"),u=l,d=!1;l.rank===2&&(d=!0,u=l.as3D(1,l.shape[0],l.shape[1])),M(u.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+u.rank+"."}),M(c.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+c.rank+"."}),o!=null&&M(Dt(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}),M(u.shape[2]===c.shape[1],function(){return"Error in conv1d: depth of input ("+u.shape[2]+") must match input depth for filter "+c.shape[1]+"."}),M(Pn(n,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+i+"'"}),M(s==="NWC",function(){return"Error in conv1d: got dataFormat of "+s+" but only NWC is currently supported."});var h=c.as4D(1,c.shape[0],c.shape[1],c.shape[2]),p=u.as4D(u.shape[0],1,u.shape[1],u.shape[2]),f=ur(p,h,[1,n],r,"NHWC",[1,i],o);return d?f.as2D(f.shape[2],f.shape[3]):f.as3D(f.shape[0],f.shape[2],f.shape[3])}}),ur=z({conv2d_:function(e,t,n,r,s,i,o){s===void 0&&(s="NHWC"),i===void 0&&(i=[1,1]);var l=T(e,"x","conv2d"),c=T(t,"filter","conv2d"),u=l,d=!1;l.rank===3&&(d=!0,u=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),M(u.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+u.rank+"."}),M(c.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+c.rank+"."}),o!=null&&M(Dt(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var h=s==="NHWC"?u.shape[3]:u.shape[1];M(h===c.shape[2],function(){return"Error in conv2d: depth of input ("+h+") must match input depth for filter "+c.shape[2]+"."}),M(Pn(n,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"});var p=Om(s),f=Js(u.shape,c.shape,n,i,r,o,!1,p),x=[c,u],v=V.runKernelFunc(function(y,m){var g=y.conv2d(u,c,f);return m([c,u]),g},{x:u,filter:c},function(y,m){var g=m,b=g[0],w=g[1];return M(eo(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return hj(w.shape,y,b,n,r,s)},filter:function(){return Km(w,y,b.shape,n,r,s)}}},"Conv2D",f,x);return d?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),nI=z({conv3d_:function(e,t,n,r,s,i){s===void 0&&(s="NDHWC"),i===void 0&&(i=[1,1,1]);var o=T(e,"x","conv3d"),l=T(t,"filter","conv3d"),c=o,u=!1;o.rank===4&&(u=!0,c=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),M(c.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+c.rank+"."}),M(l.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+l.rank+"."}),M(c.shape[4]===l.shape[3],function(){return"Error in conv3d: depth of input ("+c.shape[4]+") must match input depth for filter "+l.shape[3]+"."}),M(function(p,f){return Rh(p)||Rh(f)}(n,i),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),M(s==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+s+" but only NDHWC is currently supported."});var d=Au(c.shape,l.shape,n,i,r),h=V.runKernelFunc(function(p,f){var x=p.conv3d(c,l,d);return f([c,l]),x},{x:c,$filter:l},function(p,f){M(Rh(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var x=f[0],v=f[1];return{x:function(){return dj(x.shape,p,v,n,r)},$filter:function(){return function(y,m,g,b,w){var N=y;y.rank===4&&(N=y.as5D(1,y.shape[0],y.shape[1],y.shape[2],y.shape[3]));var C=m;C.rank===4&&(C=m.as5D(1,m.shape[0],m.shape[1],m.shape[2],m.shape[3])),M(N.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+N.shape+"."}),M(C.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+C.shape+"."}),M(g.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+g+"."}),M(N.shape[4]===g[3],function(){return"Error in conv3dDerFilter: depth of input "+N.shape[4]+") must match input depth in filter ("+g[3]+"."}),M(C.shape[4]===g[4],function(){return"Error in conv3dDerFilter: depth of dy ("+C.shape[4]+") must match output depth for filter ("+g[4]+")."});var D=Au(N.shape,g,b,1,w);return V.runKernelFunc(function(j){return j.conv3dDerFilter(N,C,D)},{x5D:N,dy5D:C})}(x,p,v.shape,n,r)}}});return u?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),Km=z({conv2dDerFilter_:function(e,t,n,r,s,i,o){i===void 0&&(i="NHWC");var l=e;e.rank===3&&(l=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var c=t;c.rank===3&&(c=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),M(l.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+l.shape+"."}),M(c.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+c.shape+"."}),M(n.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var u=i==="NHWC"?l.shape[3]:l.shape[1],d=i==="NHWC"?c.shape[3]:c.shape[1];M(u===n[2],function(){return"Error in conv2dDerFilter: depth of input "+u+") must match input depth in filter ("+n[2]+"."}),M(d===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+d+") must match output depth for filter ("+n[3]+")."}),o!=null&&M(Dt(s),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+s+"."});var h=Om(i),p=Js(l.shape,n,r,1,s,o,!1,h);return V.runKernelFunc(function(f){return f.conv2dDerFilter(l,c,p)},{x4D:l,dy4D:c})}}),hj=z({conv2dDerInput_:uj}),wd=z({depthwiseConv2d_:function(e,t,n,r,s,i,o){i===void 0&&(i=[1,1]);var l=T(e,"x","depthwiseConv2d"),c=T(t,"filter","depthwiseConv2d"),u=l,d=!1;l.rank===3&&(d=!0,u=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),M(u.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+u.rank+"."}),M(c.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+c.rank+"."}),M(u.shape[3]===c.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+u.shape[3]+") must match the inChannels dimension in filter "+c.shape[2]+"."}),i==null&&(i=[1,1]),M(Pn(n,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),o!=null&&M(Dt(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var h=Js(u.shape,c.shape,n,i,r,o,!0),p=[u,c],f=V.runKernelFunc(function(x,v){var y=x.depthwiseConv2D(u,c,h);return v([u,c]),y},{x:u,filter:c},function(x,v){M(eo(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var y=v[0],m=v[1];return{x:function(){return pj(y.shape,x,m,h)},filter:function(){return fj(y,x,m.shape,h)}}},"DepthwiseConv2dNative",h,p);return d?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}}),pj=z({depthwiseConv2dDerInput_:function(e,t,n,r){var s=t,i=!1;t.rank===3&&(i=!0,s=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var o=V.runKernelFunc(function(l){return l.depthwiseConv2DDerInput(s,n,r)},{dy4D:s});return i?o.as3D(o.shape[1],o.shape[2],o.shape[3]):o}}),fj=z({depthwiseConv2dDerFilter_:function(e,t,n,r){var s=e;e.rank===3&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var i=t;return i.rank===3&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),V.runKernelFunc(function(o){return o.depthwiseConv2DDerFilter(s,i,r)},{x4D:s,dy4D:i})}}),Xm=z({separableConv2d_:function(e,t,n,r,s,i,o){i===void 0&&(i=[1,1]),o===void 0&&(o="NHWC");var l=T(e,"x","separableConv2d"),c=T(t,"depthwiseFilter","separableConv2d"),u=T(n,"pointwiseFilter","separableConv2d"),d=l,h=!1;if(l.rank===3&&(h=!0,d=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");M(d.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+d.rank+"."}),M(c.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+c.rank+"."}),M(u.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+c.rank+"."}),M(u.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+u.shape[0]+"."}),M(u.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+u.shape[1]+"."});var p=c.shape[2],f=c.shape[3];M(u.shape[2]===p*f,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+p*f+", but got "+u.shape[2]+"."});var x=wd(d,c,r,s,o,i),v=ur(x,u,1,"valid",o);return h?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),rI=z({conv2dTranspose_:function(e,t,n,r,s,i){return uj(n,T(e,"x","conv2dTranspose"),T(t,"filter","conv2dTranspose"),r,s,"NHWC",i)}}),aI=z({conv3dTranspose_:function(e,t,n,r,s){return dj(n,T(e,"x","conv3dTranspose"),T(t,"filter","conv3dTranspose"),r,s)}}),Nd=z({matMul_:function(e,t,n,r){var s;n===void 0&&(n=!1),r===void 0&&(r=!1);var i=T(e,"a","matMul"),o=T(t,"b","matMul");s=bt(i,o),i=s[0],o=s[1];var l=n?i.shape[i.rank-2]:i.shape[i.rank-1],c=r?o.shape[o.rank-1]:o.shape[o.rank-2],u=n?i.shape[i.rank-1]:i.shape[i.rank-2],d=r?o.shape[o.rank-2]:o.shape[o.rank-1],h=i.shape.slice(0,-2),p=o.shape.slice(0,-2),f=je(h),x=je(p);M(i.rank>=2&&o.rank>=2&&i.rank===o.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+o.rank+"."}),M(Xt(h,p),function(){return"Error in matMul: outer dimensions ("+h+") and ("+p+") of Tensors with shapes "+i.shape+" and "+o.shape+" must match."}),M(l===c,function(){return"Error in matMul: inner shapes ("+l+") and ("+c+") of Tensors with shapes "+i.shape+" and "+o.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var v=i.shape.slice(0,-2).concat([u,d]),y=n?i.as3D(f,l,u):i.as3D(f,u,l),m=r?o.as3D(x,d,c):o.as3D(x,c,d),g={transposeA:n,transposeB:r};return V.runKernelFunc(function(b,w){var N=b.batchMatMul(y,m,n,r);return w([y,m]),N},{a:y,b:m},function(b,w){var N=w,C=N[0],D=N[1];return n||r?!n&&r?{a:function(){return b.matMul(D,!1,!1)},b:function(){return b.matMul(C,!0,!1)}}:n&&!r?{a:function(){return D.matMul(b,!1,!0)},b:function(){return C.matMul(b,!1,!1)}}:{a:function(){return D.matMul(b,!0,!0)},b:function(){return b.matMul(C,!0,!0)}}:{a:function(){return b.matMul(D,!1,!0)},b:function(){return C.matMul(b,!0,!1)}}},"BatchMatMul",g).reshape(v)}}),sI=z({dot_:function(e,t){var n=T(e,"t1","dot"),r=T(t,"t2","dot");M(!(n.rank!==1&&n.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."});var s=n.rank===1?n.size:n.shape[1],i=r.rank===1?r.size:r.shape[0];return M(s===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+s+" and "+i+"."}),n.rank===1&&r.rank===1?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():n.rank===1&&r.rank===2?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():n.rank===2&&r.rank===1?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),iI=z({outerProduct_:function(e,t){var n=T(e,"v1","outerProduct"),r=T(t,"v2","outerProduct");return M(n.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."}),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),Il=z({reverse_:function(e,t){var n=T(e,"x","reverse");if(n.rank===0)return n.clone();var r=Ut(t,n.shape);return V.runKernelFunc(function(s){return s.reverse(n,r)},{$x:n},function(s){return{$x:function(){return s.reverse(r)}}}).reshapeAs(n)}}),oI=z({reverse1d_:function(e){var t=T(e,"x","reverse");return M(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),Il(t,0)}}),lI=z({reverse2d_:function(e,t){var n=T(e,"x","reverse");return M(n.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),Il(n,t)}}),cI=z({reverse3d_:function(e,t){var n=T(e,"x","reverse");return M(n.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),Il(n,t)}}),uI=z({reverse4d_:function(e,t){var n=T(e,"x","reverse");return M(n.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),Il(n,t)}});function mj(e,t,n,r,s,i){var o=T(e,"x","maxPool"),l=o,c=!1;o.rank===3&&(c=!0,l=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),M(l.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+l.rank+"."}),M(Pn(n,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}),i!=null&&M(Dt(s),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+s+"."});var u=pl(l.shape,t,n,r,s,i);if(u.filterWidth===1&&u.filterHeight===1&&Xt(u.inShape,u.outShape))return o.clone();var d=[l],h=V.runKernelFunc(function(p,f){var x=p.maxPool(l,u);return f([l,x]),x},{x:l},function(p,f){var x=f[0],v=f[1];return{x:function(){return function(y,m,g,b,w,N,C,D){var j=T(y,"dy","maxPoolBackprop"),k=T(m,"input","maxPoolBackprop"),R=T(g,"output","maxPoolBackprop");M(k.rank===j.rank,function(){return"Rank of input ("+k.rank+") does not match rank of dy ("+j.rank+")"}),M(Pn(w,N),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+N+"'"}),M(j.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+j.rank+"."}),M(k.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+k.rank+"."});var E=pl(k.shape,b,w,N,C,D);return V.runKernelFunc(function(P){return P.maxPoolBackprop(j,k,R,E)},{$dy:j,$input:k})}(p,x,v,t,n,r,s)}}},"MaxPool",u,d);return c?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}function xj(e,t,n,r,s,i){var o=T(e,"x","avgPool","float32");M(Pn(n,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"});var l=o,c=!1;o.rank===3&&(c=!0,l=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),M(l.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+l.rank+"."}),i!=null&&M(Dt(s),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+s+"."});var u=pl(l.shape,t,n,r,s,i);if(u.filterWidth===1&&u.filterHeight===1&&Xt(u.inShape,u.outShape))return o.clone();var d=V.runKernelFunc(function(h){return h.avgPool(l,u)},{x:l},function(h){return{x:function(){return function(p,f,x,v,y,m){var g=T(p,"dy","avgPoolBackprop"),b=T(f,"input","avgPoolBackprop");M(b.rank===g.rank,function(){return"Rank of input ("+b.rank+") does not match rank of dy ("+g.rank+")"}),M(Pn(v,y),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+v+" and dilations '"+y+"'"});var w=b,N=g,C=!1;b.rank===3&&(C=!0,w=b.as4D(1,b.shape[0],b.shape[1],b.shape[2]),N=g.as4D(1,g.shape[0],g.shape[1],g.shape[2])),M(N.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+N.rank+"."}),M(w.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+w.rank+"."});var D=pl(w.shape,x,v,y,m),j=V.runKernelFunc(function(k){return k.avgPoolBackprop(N,w,D)},{dy4D:N,input4D:w});return C?j.as3D(j.shape[1],j.shape[2],j.shape[3]):j}(h,l,t,n,r,s)}}},"AvgPool",u);return d=d.cast(o.dtype),c?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}var Vt=z({maxPool_:function(e,t,n,r,s){return mj(e,t,n,1,r,s)}}),Pl=z({avgPool_:function(e,t,n,r,s){return xj(e,t,n,1,r,s)}}),dI=z({pool_:function(e,t,n,r,s,i){s==null&&(s=[1,1]),i==null&&(i=1),r===0&&(r="valid");var o=T(e,"x","maxPool"),l=o,c=!1;o.rank===3&&(c=!0,l=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),M(Pn(i,s),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+s+"'"});var u,d=pl(l.shape,t,i,s,r),h=[d.dilationHeight,d.dilationWidth];u=r==="same"?function(w,N){var C=w.map(function(k,R){return k+(k-1)*(N[R]-1)}).map(function(k){return k-1}),D=C.map(function(k){return Math.floor(k/2)}),j=C.map(function(k,R){return k-D[R]});return C.map(function(k,R){return[D[R],j[R]]})}([d.filterHeight,d.filterWidth],h):[[0,0],[0,0]];var p=h[0]===1&&h[1]===1,f=function(w,N,C){var D=C.map(function(W){return W[0]}),j=C.map(function(W){return W[1]}),k=w.concat(D,j),R=N.map(function(W,L){return(W-k[L]%W)%W}),E=j.map(function(W,L){return W+R[L]}),P=N.map(function(W,L){return[D[L],E[L]]}),F=N.map(function(W,L){return[0,R[L]]});return[P,F]}([d.inHeight,d.inWidth],h,u),x=f[0],v=f[1],y=p?r:"valid",m=p?l:NN(l,h,x),g=(n==="avg"?function(){return xj(m,t,i,1,y)}:function(){return mj(m,t,i,1,y)})(),b=p?g:yN(g,h,v);return c?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),hI=z({maxPool3d_:function(e,t,n,r,s,i,o){i===void 0&&(i="NDHWC");var l=T(e,"x","maxPool3d"),c=l,u=!1;l.rank===4&&(u=!0,c=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),o==null&&(o=[1,1,1]),M(c.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+c.rank+"."}),M(i==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),M(Pn(n,o),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),s!=null&&M(Dt(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."});var d=Tu(c.shape,t,n,o,r,s,i),h=V.runKernelFunc(function(p,f){var x=p.maxPool3d(c,d);return f([c,x]),x},{x:c},function(p,f){var x=f[0],v=f[1];return{x:function(){return function(y,m,g,b,w,N,C,D){var j=T(y,"dy","maxPool3dBackprop"),k=T(m,"input","maxPool3dBackprop"),R=T(g,"output","maxPool3dBackprop"),E=j,P=k,F=R,W=!1;k.rank===4&&(W=!0,E=j.as5D(1,j.shape[0],j.shape[1],j.shape[2],j.shape[3]),P=k.as5D(1,k.shape[0],k.shape[1],k.shape[2],k.shape[3]),F=R.as5D(1,R.shape[0],R.shape[1],R.shape[2],R.shape[3])),M(E.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+E.rank+"."}),M(P.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+P.rank+"."}),M(F.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+F.rank+"."}),N==null&&(N=[1,1,1]),M(Pn(w,N),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+N+"'"}),D!=null&&M(Dt(C),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+D+" but got pad "+C+"."});var L=Tu(P.shape,b,w,N,C,D),U=V.runKernelFunc(function(_){return _.maxPool3dBackprop(E,P,F,L)},{dy5D:E,input5D:P});return W?U.as4D(U.shape[1],U.shape[2],U.shape[3],U.shape[4]):U}(p,x,v,t,n,o,r,s)}}});return u?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),pI=z({avgPool3d_:function(e,t,n,r,s,i,o){i===void 0&&(i="NDHWC");var l=T(e,"x","avgPool3d","float32"),c=l,u=!1;l.rank===4&&(u=!0,c=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),o==null&&(o=[1,1,1]),M(c.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+c.rank+"."}),M(i==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),M(Pn(n,o),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),s!=null&&M(Dt(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."});var d=Tu(c.shape,t,n,o,r,s,i),h=V.runKernelFunc(function(p){return p.avgPool3d(c,d)},{x:c},function(p){return{x:function(){return function(f,x,v,y,m,g,b){var w=T(f,"dy","avgPool3dBackprop"),N=T(x,"input","avgPool3dBackprop"),C=w,D=N,j=!1;N.rank===4&&(j=!0,C=w.as5D(1,w.shape[0],w.shape[1],w.shape[2],w.shape[3]),D=N.as5D(1,N.shape[0],N.shape[1],N.shape[2],N.shape[3])),M(C.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+C.rank+"."}),M(D.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+D.rank+"."}),m==null&&(m=[1,1,1]),M(Pn(y,m),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+y+" and dilations '"+m+"'"}),b!=null&&M(Dt(g),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+b+" but got pad "+g+"."});var k=Tu(D.shape,v,y,m,g,b),R=V.runKernelFunc(function(E){return E.avgPool3dBackprop(C,D,k)},{dy5D:C,input5D:D});return j?R.as4D(R.shape[1],R.shape[2],R.shape[3],R.shape[4]):R}(p,c,t,n,o,r,s)}}});return h=h.cast(c.dtype),u?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),Gr=z({slice_:function(e,t,n){var r,s,i=T(e,"x","slice");if(i.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof t=="number"?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach(function(c){M(c!==-1,function(){return"slice() does not support negative begin indexing."})}),s=(s=n==null?new Array(i.rank).fill(-1):typeof n=="number"?[n].concat(new Array(i.rank-1).fill(-1)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map(function(c,u){return c>=0?c:(M(c===-1,function(){return"Negative size values should be exactly -1 but got "+c+" for the slice() size at index "+u+"."}),i.shape[u]-r[u])}),z_(i,r,s);var o=i.shape,l={begin:r,size:s};return V.runKernelFunc(function(c){return c.slice(i,r,s)},{x:i},function(c){for(var u=[],d=0;d<c.rank;d++)u.push([r[d],o[d]-r[d]-s[d]]);return{x:function(){return c.pad(u)}}},"Slice",l)}}),fI=z({slice1d_:function(e,t,n){var r=T(e,"x","slice1d");return M(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),Gr(r,[t],[n])}}),mI=z({slice2d_:function(e,t,n){var r=T(e,"x","slice2d");return M(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),Gr(r,t,n)}}),gj=z({slice3d_:function(e,t,n){var r=T(e,"x","slice3d");return M(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),Gr(r,t,n)}}),xI=z({slice4d_:function(e,t,n){var r=T(e,"x","slice4d");return M(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),Gr(r,t,n)}});function vj(e,t,n,r,s){return t.rank<n.rank&&(t=t.reshape(In(t.shape,r))),e.rank<n.rank&&(e=e.reshape(In(e.shape,r))),{x:function(){var i=e.mul(n.equal(t).cast(e.dtype));return s==null?i:i.transpose(s)}}}var gI=z({all_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=T(e,"x","all","bool"),s=Ut(t,r.shape),i=s,o=Xr(i,r.rank);o!=null&&(r=r.transpose(o),i=Yr(i.length,r.rank));var l=V.runKernelFunc(function(u){return u.all(r,i)},{$x:r});if(n){var c=In(l.shape,s);return l.reshape(c)}return l}}),vI=z({any_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=T(e,"x","any","bool"),s=Ut(t,r.shape),i=s,o=Xr(i,r.rank);o!=null&&(r=r.transpose(o),i=Yr(i.length,r.rank));var l=V.runKernelFunc(function(u){return u.any(r,i)},{$x:r});if(n){var c=In(l.shape,s);return l.reshape(c)}return l}}),yI=z({argMax_:function(e,t){t===void 0&&(t=0);var n=T(e,"x","argMax");t==null&&(t=0);var r=Ut(t,n.shape),s=Xr(r,n.rank);s!=null&&(n=n.transpose(s),r=Yr(r.length,n.rank));var i={axis:r[0]},o=[n];return V.runKernelFunc(function(l,c){var u=l.argMax(n,r[0]);return c([n]),u},{x:n},function(l,c){var u=c[0];return{x:function(){return Ke(u)}}},"ArgMax",i,o)}}),bI=z({argMin_:function(e,t){t===void 0&&(t=0);var n=T(e,"x","argMin");t==null&&(t=0);var r=Ut(t,n.shape),s=Xr(r,n.rank);return s!=null&&(n=n.transpose(s),r=Yr(r.length,n.rank)),V.runKernelFunc(function(i,o){var l=i.argMin(n,r[0]);return o([n]),l},{$x:n},function(i,o){var l=o[0];return{$x:function(){return Ke(l)}}})}}),wI=z({logSumExp_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=T(e,"x","logSumExp"),s=Ut(t,r.shape),i=r.max(s,!0),o=r.sub(i).exp().sum(s).log(),l=i.reshape(o.shape).add(o);if(n){var c=In(l.shape,s);return l.reshape(c)}return l}}),jd=z({max_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=T(e,"x","max"),s=r,i=Ut(t,r.shape),o=i,l=Xr(o,r.rank);l!=null&&(r=r.transpose(l),o=Yr(o.length,r.rank));var c=[r],u=V.runKernelFunc(function(h,p){var f=h.max(r,o);return p([s,f]),f},{x:r},function(h,p){return vj(h,p[1],p[0],i,l)},"Max",{axes:o},c,[!0]);if(n){var d=In(u.shape,i);u=u.reshape(d)}return u}}),NI=z({mean_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=T(e,"x","mean"),s=Ut(t,r.shape),i=je(sn(r.shape,s)[1]);return vd(function(o){var l=fe(i);return{value:(l.dtype===o.dtype?o:o.cast(l.dtype)).div(l).sum(t,n),gradFunc:function(c){var u=o.shape.slice();return s.forEach(function(d){u[d]=1}),c.reshape(u).mul(lo(o.shape,"float32")).div(i)}}})(r)}}),jI=z({min_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=T(e,"x","min"),s=r,i=Ut(t,r.shape),o=i,l=Xr(o,r.rank);l!=null&&(r=r.transpose(l),o=Yr(o.length,r.rank));var c=[r],u=V.runKernelFunc(function(h,p){var f=h.min(r,o);return p([s,f]),f},{x:r},function(h,p){return vj(h,p[1],p[0],i,l)},"Min",{axes:o},c,[!0]);if(n){var d=In(u.shape,i);u=u.reshape(d)}return u}}),CI=z({moments_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=Ut(t,(e=T(e,"x","moments")).shape),s=e.mean(r,n),i=s.shape;n||(i=In(s.shape,r));var o=e.toFloat().sub(s.reshape(i)).square();return{mean:s,variance:o.mean(r,n)}}}),yj=z({sum_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=T(e,"x","sum");r.dtype==="bool"&&(r=r.toInt());var s=Ut(t,r.shape);return vd(function(i){var o=Xr(s,i.rank),l=s,c=i;o!=null&&(c=i.transpose(o),l=Yr(l.length,i.rank));var u=function(f){var x=i.shape.slice();return s.forEach(function(v){x[v]=1}),f.reshape(x).mul(lo(i.shape,"float32"))},d={axes:l},h=V.runKernelFunc(function(f){return f.sum(c,l)},{x:c},function(f){return{x:function(){return u(f)}}},"Sum",d);if(n){var p=In(h.shape,s);h=h.reshape(p)}return{value:h,gradFunc:u}})(r)}}),kI=z({prod_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=T(e,"x","prod");r.dtype==="bool"&&(r=r.toInt());var s=Ut(t,r.shape),i=Xr(s,r.rank),o=s,l=r;i!=null&&(l=r.transpose(i),o=Yr(o.length,r.rank));var c=V.runKernelFunc(function(d){return d.prod(l,o)},{permutedX:l});if(n){var u=In(c.shape,s);c=c.reshape(u)}return c}}),bj=z({elu_:function(e){var t=T(e,"x","elu");return V.runKernelFunc(function(n,r){var s=n.elu(t);return r([s]),s},{$x:t},function(n,r){var s=r[0];return{$x:function(){return V.runKernelFunc(function(i){return i.eluDer(n,s)},{dy:n,y:s})}}})}}),SI=z({leakyRelu_:function(e,t){t===void 0&&(t=.2);var n=T(e,"x","leakyRelu");return qm(fe(t).mul(n),n)}}),wj=z({prelu_:function(e,t){var n=T(e,"x","prelu"),r=T(t,"alpha","prelu");return V.runKernelFunc(function(s,i){var o=s.prelu(n,r);return i([n,r]),o},{x:n,alpha:r},function(s,i){var o=i[0],l=i[1],c=o.greater(0);return{x:function(){return Hs(c,s,s.mul(l))},alpha:function(){var u=Hs(c,Ke(s),s.mul(o)),d=$t(l.shape,s.shape);return d.length>0&&(u=u.sum(d)),u.reshape(l.shape)}}},"Prelu")}}),gt=z({relu_:function(e){var t=T(e,"x","relu");return t.dtype==="bool"?t.toInt():V.runKernelFunc(function(n,r){var s=n.relu(t);return r([t]),s},{x:t},function(n,r){var s=r[0];return{x:function(){return n.mulStrict(s.step().toFloat())}}},"Relu")}}),Nj=z({relu6_:function(e){var t=T(e,"x","relu6");return t.dtype==="bool"?t.toInt():V.runKernelFunc(function(n,r){var s=n.relu6(t);return r([t]),s},{x:t},function(n,r){var s=r[0],i=s.lessEqual(6).mul(s.step());return{x:function(){return n.mulStrict(i.toFloat())}}},"Relu6")}}),EI=z({selu_:function(e){var t=T(e,"x","selu");return V.runKernelFunc(function(n,r){var s=n.selu(t);return r([t]),s},{$x:t},function(n,r){var s=r[0];return{$x:function(){var i=s.greater(fe(0)),o=fe(Wm),l=fe(Vm),c=n.mul(l),u=n.mul(o).mul(s.toFloat().exp());return Hs(i,c,u)}}})}}),os=z({transpose_:function(e,t){var n=T(e,"x","transpose");if(t==null&&(t=n.shape.map(function(s,i){return i}).reverse()),M(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."}),t.forEach(function(s){M(s>=0&&s<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t})}),n.rank<=1)return n.clone();var r={perm:t};return V.runKernelFunc(function(s){return s.transpose(n,t)},{x:n},function(s){var i=Im(t);return{x:function(){return s.transpose(i)}}},"Transpose",r)}}),DI=z({localResponseNormalization_:function(e,t,n,r,s){t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),s===void 0&&(s=.5);var i=T(e,"x","localResponseNormalization");M(i.rank===4||i.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+i.rank+"."}),M(Dt(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var o=i,l=!1;i.rank===3&&(l=!0,o=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var c=V.runKernelFunc(function(u,d){var h=u.localResponseNormalization4D(o,t,n,r,s);return d([o,h]),h},{x4D:o},function(u,d){var h=d[0],p=d[1];return{x4D:function(){return V.runKernelFunc(function(f){return f.LRNGrad(u,h,p,t,n,r,s)},{})}}});return l?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),jj=z({norm_:function(e,t,n,r){t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1);var s=function l(c,u,d){if(d===void 0&&(d=null),c.rank===0)return c.abs();if(c.rank!==1&&d===null)return l(c.reshape([-1]),u,d);if(c.rank===1||typeof d=="number"||Array.isArray(d)&&d.length===1){if(u===1)return c.abs().sum(d);if(u===1/0)return c.abs().max(d);if(u===-1/0)return c.abs().min(d);if(u==="euclidean"||u===2)return c.abs().pow(fe(2,"int32")).sum(d).sqrt();throw new Error("Error in norm: invalid ord value: "+u)}if(Array.isArray(d)&&d.length===2){if(u===1)return c.abs().sum(d[0]).max(d[1]-1);if(u===1/0)return c.abs().sum(d[1]).max(d[0]);if(u===-1/0)return c.abs().sum(d[1]).min(d[0]);if(u==="fro"||u==="euclidean")return c.square().sum(d).sqrt();throw new Error("Error in norm: invalid ord value: "+u)}throw new Error("Error in norm: invalid axis: "+d)}(e=T(e,"x","norm"),t,n),i=s.shape;if(r){var o=Ut(n,e.shape);i=In(s.shape,o)}return s.reshape(i)}}),RI=z({basicLSTMCell_:function(e,t,n,r,s,i){var o=T(e,"forgetBias","basicLSTMCell"),l=T(t,"lstmKernel","basicLSTMCell"),c=T(n,"lstmBias","basicLSTMCell"),u=T(r,"data","basicLSTMCell"),d=T(s,"c","basicLSTMCell"),h=T(i,"h","basicLSTMCell"),p=u.concat(h,1).matMul(l).add(c),f=p.shape[0],x=p.shape[1]/4,v=[f,x],y=p.slice([0,0],v),m=p.slice([0,x],v),g=p.slice([0,2*x],v),b=p.slice([0,3*x],v),w=y.sigmoid().mulStrict(m.tanh()).addStrict(d.mulStrict(o.add(g).sigmoid())),N=w.tanh().mulStrict(b.sigmoid());return[w,N]}}),_I=z({multiRNNCell_:function(e,t,n,r){for(var s=T(t,"data","multiRNNCell"),i=ku(n,"c","multiRNNCell"),o=ku(r,"h","multiRNNCell"),l=s,c=[],u=0;u<e.length;u++){var d=e[u](l,i[u],o[u]);c.push(d[0]),c.push(d[1]),l=d[1]}var h=[],p=[];for(u=0;u<c.length;u+=2)h.push(c[u]),p.push(c[u+1]);return[h,p]}}),TI=z({movingAverage_:function(e,t,n,r,s){s===void 0&&(s=!0);var i=T(e,"v","movingAverage"),o=T(t,"x","movingAverage"),l=T(n,"decay","movingAverage");DR(i,o),M(Xt(i.shape,o.shape),function(){return"Shape mismatch in v and x"});var c=fe(1),u=c.sub(l),d=o.sub(i).mul(u);if(s){M(r!=null,function(){return"When using zeroDebias: true, step is required."});var h=T(r,"step","movingAverage");d=d.div(c.sub(Fu(l,h)))}return i.add(d)}}),AI=z({stridedSlice_:function(e,t,n,r,s,i,o,l,c){if(s===void 0&&(s=0),i===void 0&&(i=0),o===void 0&&(o=0),l===void 0&&(l=0),c===void 0&&(c=0),r==null&&(r=new Array(t.length)),o!==0)throw new Error("ellipsis mask is not yet supported");var u=T(e,"x","stridedSlice"),d=Uy(l),h=u.shape.slice();d.forEach(function(y){t[y]=0,n[y]=1,h.splice(y,0,1)}),u=u.reshape(h);for(var p=0;p<u.rank;p++)t[p]=U_(s,t,r,u.shape,p),n[p]=W_(i,n,r,u.shape,p),r[p]=r[p]||1;var f=Uy(c);f.forEach(function(y){n[y]=t[y]+1,r[y]=1});var x=Lm(t,n,r),v=x.filter(function(y,m){return f.indexOf(m)===-1});return r.every(function(y){return y===1})?Gr(u,t,x).reshape(v):V.runKernelFunc(function(y){return y.stridedSlice(u,t,n,r)},{$x:u}).reshape(v)}}),II=z({topk_:function(e,t,n){t===void 0&&(t=1),n===void 0&&(n=!0);var r=T(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var s=r.shape[r.shape.length-1];if(t>s)throw new Error("'k' passed to topk() must be <= the last dimension ("+s+") but got "+t);var i=V.runKernelFunc(function(o){return o.topk(r,t,n)},{$x:r});return{values:i[0],indices:i[1]}}}),PI=z({scatterND_:function(e,t,n){var r=T(e,"indices","scatterND","int32"),s=T(t,"updates","scatterND");return $_(s,r,n),V.runKernelFunc(function(i){return i.scatterND(r,s,n)},{indices:r,updates:s},null,"ScatterNd",{shape:n})}}),Ym=z({fft_:function(e){M(e.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return V.runKernelFunc(function(s){return s.fft(r)},{input:e}).reshape(e.shape)}}),Mu=z({ifft_:function(e){M(e.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return V.runKernelFunc(function(s){return s.ifft(r)},{input:e}).reshape(e.shape)}}),Qm=z({rfft_:function(e,t){M(e.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+e.dtype});var n,r=e.shape[e.shape.length-1],s=e.size/r;if(t!=null&&t<r){var i=e.shape.map(function(m){return 0}),o=e.shape.map(function(m){return m});o[e.shape.length-1]=t,n=e.slice(i,o),r=t}else if(t!=null&&t>r){var l=e.shape.map(function(m){return m});l[e.shape.length-1]=t-r,n=e.concat(ct(l),e.shape.length-1),r=t}else n=e;var c=n.zerosLike(),u=Jt(n,c).as2D(s,r),d=Ym(u),h=Math.floor(r/2)+1,p=Zn(d),f=Mr(d),x=p.split([h,r-h],p.shape.length-1),v=f.split([h,r-h],f.shape.length-1),y=n.shape.slice();return y[n.shape.length-1]=h,Jt(x[0],v[0]).reshape(y)}}),Cj=z({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),s=Mu(r);return Zn(s)}var i=[n,2*(t-1)],o=Zn(e).as2D(n,t),l=Mr(e).as2D(n,t),c=o.slice([0,1],[n,t-2]).reverse(1),u=l.slice([0,1],[n,t-2]).reverse(1).mul(fe(-1)),d=o.concat(c,1),h=l.concat(u,1);return r=Jt(d,h).as2D(i[0],i[1]),s=Mu(r),Zn(s)}}),FI=Object.freeze({fft:Ym,ifft:Mu,rfft:Qm,irfft:Cj}),MI=z({sparseToDense_:function(e,t,n,r){r===void 0&&(r=0);var s=T(e,"sparseIndices","sparseToDense","int32"),i=T(t,"sparseValues","sparseToDense"),o=T(r,"defaultValue","sparseToDense",i.dtype);return function(l,c,u,d){if(l.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+l.dtype+".");if(l.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+l.shape+".");var h=l.rank>0?l.shape[0]:1,p=l.rank>1?l.shape[1]:1;if(u.length!==p)throw new Error("outputShape has incorrect number of elements:, "+u.length+", should be: "+p+".");var f=c.size;if(c.rank!==0&&(c.rank!==1||f!==h))throw new Error("sparseValues has incorrect shape "+c.shape+", should be [] or ["+h+"]");if(c.dtype!==d.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(s,i,n,o),V.runKernelFunc(function(l){return l.sparseToDense(s,i,n,o)},{$sparseIndices:s,$sparseValues:i,$defaultValue:o})}}),LI=z({gatherND_:function(e,t){var n=T(t,"indices","gatherND","int32"),r=T(e,"x","gatherND");return V.runKernelFunc(function(s){return s.gatherND(r,n)},{x:r,indices:n},null,"GatherNd")}}),OI=z({diag_:function(e){var t=T(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return V.runKernelFunc(function(r){return r.diag(t)},{$x:t}).reshape(n)}}),BI=z({dropout_:function(e,t,n,r){var s=T(e,"x","dropout");if(M(s.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+s.dtype+" tensor instead."}),M(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return e instanceof xt?s.clone():s;var i=function(c,u){if(u==null)return c.shape.slice();if(Xt(c.shape,u))return u;if(c.shape.length===u.length){for(var d=[],h=0;h<c.shape.length;h++)u[h]==null&&c.shape[h]!=null?d.push(c.shape[h]):d.push(u[h]);return d}return u}(s,n),o=1-t,l=wN(i,0,1,"float32",r).add(o).floor().div(o);return s.mul(l)}});function kj(e,t,n){for(var r=1-e%2,s=new Float32Array(e),i=0;i<e;++i){var o=2*Math.PI*i/(e+r-1);s[i]=t-n*Math.cos(o)}return Tt(s,"float32")}var Jm=z({hannWindow_:function(e){return kj(e,.5,.5)}}),Sj=z({hammingWindow_:function(e){return kj(e,.54,.46)}}),Zm=z({frame_:function(e,t,n,r,s){r===void 0&&(r=!1),s===void 0&&(s=0);for(var i=0,o=[];i+t<=e.size;)o.push(Gr(e,i,t)),i+=n;if(r)for(;i<e.size;){var l=i+t-e.size,c=Ot([Gr(e,i,t-l),Vr([l],s)]);o.push(c),i+=n}return o.length===0?Za([],[0,t]):Ot(o).as2D(o.length,t)}}),Ej=z({stft_:function(e,t,n,r,s){var i;s===void 0&&(s=Jm),r==null&&(i=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var o=Zm(e,t,n),l=hn(o,s(t)),c=[],u=0;u<o.shape[0];u++)c.push(Qm(l.slice([u,0],[1,t]),r));return Ot(c)}}),$I=Object.freeze({hannWindow:Jm,hammingWindow:Sj,frame:Zm,stft:Ej}),dn,zI=function(e,t,n){return n===void 0&&(n=1),we(this,void 0,void 0,function(){var r,s,i,o,l,c,u,d,h,p,f,x,v,y;return Ne(this,function(m){switch(m.label){case 0:return r=T(e,"predictions","inTopK"),s=T(t,"targets","inTopK"),M(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),M(r.rank-1===s.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+s.rank}),Ze(r.shape.slice(0,r.shape.length-1),s.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],M(n>0&&n<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+n}),[4,r.data()];case 1:return o=m.sent(),[4,s.data()];case 2:for(l=m.sent(),c=[o.length/i,i],d=c[1],h=ul("bool",u=c[0]),p=0;p<u;p++){for(f=p*d,x=o.subarray(f,f+d),v=[],y=0;y<x.length;y++)v.push({value:x[y],index:y});for(v.sort(function(g,b){return b.value-g.value}),h[p]=0,y=0;y<n;y++)if(v[y].index===l[p]){h[p]=1;break}}return e!==r&&r.dispose(),t!==s&&s.dispose(),[2,en(h,s.shape,"bool")]}})})};(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(dn||(dn={}));var UI=z({absoluteDifference_:function(e,t,n,r){r===void 0&&(r=dn.SUM_BY_NONZERO_WEIGHTS);var s=T(e,"labels","absoluteDifference"),i=T(t,"predictions","absoluteDifference"),o=null;n!=null&&(o=T(n,"weights","absoluteDifference")),Ze(s.shape,i.shape,"Error in absoluteDifference: ");var l=s.sub(i).abs();return Ca(l,o,r)}}),Ca=z({computeWeightedLoss_:function(e,t,n){n===void 0&&(n=dn.SUM_BY_NONZERO_WEIGHTS);var r=T(e,"losses","computeWeightedLoss"),s=null;t!=null&&(s=T(t,"weights","computeWeightedLoss"));var i=s==null?r:r.mul(s);if(n===dn.NONE)return i;if(n===dn.SUM)return i.sum();if(n===dn.MEAN){if(s==null)return i.mean();var o=r.size/s.size,l=i.sum().div(s.sum());return o>1?l.div(fe(o)):l}if(n===dn.SUM_BY_NONZERO_WEIGHTS){if(s==null)return i.sum().div(fe(r.size));var c=s.mul(lo(r.shape)).notEqual(fe(0)).sum().toFloat();return i.sum().div(c)}throw Error("Unknown reduction: "+n)}}),WI=z({cosineDistance_:function(e,t,n,r,s){s===void 0&&(s=dn.SUM_BY_NONZERO_WEIGHTS);var i=T(e,"labels","cosineDistance"),o=T(t,"predictions","cosineDistance"),l=null;r!=null&&(l=T(r,"weights","cosineDistance")),Ze(i.shape,o.shape,"Error in cosineDistance: ");var c=fe(1).sub(i.mul(o).sum(n,!0));return Ca(c,l,s)}}),VI=z({hingeLoss_:function(e,t,n,r){r===void 0&&(r=dn.SUM_BY_NONZERO_WEIGHTS);var s=T(e,"labels","hingeLoss"),i=T(t,"predictions","hingeLoss"),o=null;n!=null&&(o=T(n,"weights","hingeLoss")),Ze(s.shape,i.shape,"Error in hingeLoss: ");var l=fe(1);s=fe(2).mul(s).sub(l);var c=l.sub(s.mul(i)).relu();return Ca(c,o,r)}}),HI=z({huberLoss_:function(e,t,n,r,s){r===void 0&&(r=1),s===void 0&&(s=dn.SUM_BY_NONZERO_WEIGHTS);var i=T(e,"labels","huberLoss"),o=T(t,"predictions","huberLoss"),l=null;n!=null&&(l=T(n,"weights","huberLoss")),Ze(i.shape,o.shape,"Error in huberLoss: ");var c=fe(r),u=o.sub(i).abs(),d=ij(u,c),h=u.sub(d),p=fe(.5).mul(d.square()).add(c.mul(h));return Ca(p,l,s)}}),qI=z({logLoss_:function(e,t,n,r,s){r===void 0&&(r=1e-7),s===void 0&&(s=dn.SUM_BY_NONZERO_WEIGHTS);var i=T(e,"labels","logLoss"),o=T(t,"predictions","logLoss"),l=null;n!=null&&(l=T(n,"weights","logLoss")),Ze(i.shape,o.shape,"Error in logLoss: ");var c=fe(1),u=fe(r),d=i.mul(o.add(u).log()).neg().sub(c.sub(i).mul(c.sub(o).add(u).log()));return Ca(d,l,s)}}),GI=z({meanSquaredError_:function(e,t,n,r){r===void 0&&(r=dn.SUM_BY_NONZERO_WEIGHTS);var s=T(e,"labels","meanSquaredError"),i=T(t,"predictions","meanSquaredError"),o=null;n!=null&&(o=T(n,"weights","meanSquaredError")),Ze(s.shape,i.shape,"Error in meanSquaredError: ");var l=s.squaredDifference(i);return Ca(l,o,r)}}),KI=z({sigmoidCrossEntropy_:function(e,t,n,r,s){r===void 0&&(r=0),s===void 0&&(s=dn.SUM_BY_NONZERO_WEIGHTS);var i=T(e,"multiClassLabels","sigmoidCrossEntropy"),o=T(t,"logits","sigmoidCrossEntropy"),l=null;if(n!=null&&(l=T(n,"weights","sigmoidCrossEntropy")),Ze(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var c=fe(r),u=fe(1),d=fe(.5);i=i.mul(u.sub(c)).add(d.mul(c))}var h=function(p,f){var x=T(p,"labels","sigmoidCrossEntropyWithLogits"),v=T(f,"logits","sigmoidCrossEntropyWithLogits");Ze(x.shape,v.shape,"Error in sigmoidCrossEntropyWithLogits: ");var y=v.relu(),m=v.mul(x),g=v.abs().neg().exp().log1p();return y.sub(m).add(g)}(i,o);return Ca(h,l,s)}}),XI=z({softmaxCrossEntropy_:function(e,t,n,r,s){r===void 0&&(r=0),s===void 0&&(s=dn.SUM_BY_NONZERO_WEIGHTS);var i=T(e,"onehotLabels","softmaxCrossEntropy"),o=T(t,"logits","softmaxCrossEntropy"),l=null;if(n!=null&&(l=T(n,"weights","softmaxCrossEntropy")),Ze(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var c=fe(r),u=fe(1),d=fe(i.shape[1]);i=i.mul(u.sub(c)).add(c.div(d))}var h=function(p,f,x){if(x===void 0&&(x=-1),x===-1&&(x=f.rank-1),x!==f.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+f.rank+" and dim was "+x);return vd(function(v,y,m){var g=y.logSumExp([x],!0),b=y.toFloat().sub(g);return m([v,b]),{value:b.mul(v).neg().sum([x]),gradFunc:function(w,N){var C=N[0],D=N[1],j=In(w.shape,[x]);return[w.reshape(j).mul(C.toFloat().sub(D.exp())),w.reshape(j).mul(D.exp().sub(C.toFloat()))]}}})(p,f)}(i,o);return Ca(h,l,s)}}),YI=Object.freeze({get Reduction(){return dn},absoluteDifference:UI,computeWeightedLoss:Ca,cosineDistance:WI,hingeLoss:VI,huberLoss:HI,logLoss:qI,meanSquaredError:GI,sigmoidCrossEntropy:KI,softmaxCrossEntropy:XI});function ub(e,t){return t===void 0&&(t=!1),V.tidy(function(){if(e.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],s=bN(n),i=e.clone(),o=Za([[1]],[1,1]),l=o.clone(),c=n>=r?r:n,u=function(h){var p,f=i,x=l,v=s;p=V.tidy(function(){var y=i.slice([h,h],[n-h,1]),m=y.norm(),g=i.slice([h,h],[1,1]),b=Za([[-1]]).where(g.greater(0),Za([[1]])),w=g.sub(b.mul(m)),N=y.div(w);l=N.shape[0]===1?o.clone():o.concat(N.slice([1,0],[N.shape[0]-1,N.shape[1]]),0);var C=b.matMul(w).div(m).neg(),D=i.slice([h,0],[n-h,r]),j=C.mul(l);if(h===0)i=D.sub(j.matMul(l.transpose().matMul(D)));else{var k=D.sub(j.matMul(l.transpose().matMul(D)));i=i.slice([0,0],[h,r]).concat(k,0)}var R=s.slice([0,h],[n,s.shape[1]-h]);if(h===0)s=R.sub(R.matMul(l).matMul(j.transpose()));else{var E=R.sub(R.matMul(l).matMul(j.transpose()));s=s.slice([0,0],[n,h]).concat(E,1)}return[l,i,s]}),l=p[0],i=p[1],s=p[2],An([f,x,v])},d=0;d<c;++d)u(d);return!t&&n>r&&(s=s.slice([0,0],[n,r]),i=i.slice([0,0],[r,r])),[s,i]})}var QI=z({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=T(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var s=r.shape,i=r.shape.slice(-2),o=i[0],l=i[1];if(!(t<=o))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+o+").");if(!(n<=l))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+l+").");t<0&&(t=o),n<0&&(n=l);var c=Su(0,o,1,"int32").reshape([-1,1]),u=Su(0,l,1,"int32"),d=zt(c,u),h=bd(d.lessEqual(fe(+t,"int32")),d.greaterEqual(fe(-n,"int32"))),p=ct([o,l],r.dtype);return Vn(Bt(r.reshape([-1,o,l])).map(function(f){return Hs(h,f,p)})).reshape(s)}}),JI=z({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,M(e!=null&&e.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=e[0].shape[0],r=function(c){M(e[c].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[c].shape[0]+" vs. "+n+")"})},s=1;s<e.length;++s)r(s)}else t=!0,e=Fm(e,e.shape[0],0).map(function(c){return jN(c,[0])});M(e.length<=e[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."});var i=[],o=e,l=function(c){i.push(V.tidy(function(){var u=o[c];if(c>0)for(var d=0;d<c;++d){var h=yj(i[d].mulStrict(u)).mul(i[d]);u=u.sub(h)}return u.div(jj(u,"euclidean"))}))};for(s=0;s<e.length;++s)l(s);return t?Vn(i,0):i}}),ZI=z({qr_:function(e,t){if(t===void 0&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(e.rank===2)return ub(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce(function(o,l){return o*l}),r=Bt(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),s=[],i=[];return r.forEach(function(o){var l=ub(o,t),c=l[0],u=l[1];s.push(c),i.push(u)}),[Vn(s,0).reshape(e.shape),Vn(i,0).reshape(e.shape)]}}),eP=Object.freeze({bandPart:QI,gramSchmidt:JI,qr:ZI});function Cd(e,t,n,r,s,i){r==null&&(r=.5),s==null&&(s=Number.NEGATIVE_INFINITY),i==null&&(i=0);var o=e.shape[0];return n=Math.min(n,o),M(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),M(e.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"}),M(e.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]}),M(t.rank===1,function(){return"scores must be a 1D tensor"}),M(t.shape[0]===o,function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+t.shape[0]}),M(0<=i&&i<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"}),{maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:i}}var tP=z({resizeBilinear_:function(e,t,n){n===void 0&&(n=!1);var r=T(e,"images","resizeBilinear");M(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),M(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var s=r,i=!1;r.rank===3&&(i=!0,s=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=t[0],l=t[1],c=V.runKernelFunc(function(u,d){return d([s]),u.resizeBilinear(s,o,l,n)},{x:s},function(u,d){return{x:function(){return V.runKernelFunc(function(h){return h.resizeBilinearBackprop(u,d[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:o,newWidth:l});return i?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),nP=z({resizeNearestNeighbor_:function(e,t,n){n===void 0&&(n=!1);var r=T(e,"images","resizeNearestNeighbor");M(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),M(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),M(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var s=r,i=!1;r.rank===3&&(i=!0,s=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=t[0],l=t[1],c=V.runKernelFunc(function(u,d){return d([s]),u.resizeNearestNeighbor(s,o,l,n)},{batchImages:s},function(u,d){return{batchImages:function(){return V.runKernelFunc(function(h){return h.resizeNearestNeighborBackprop(u,d[0],n)},{})}}});return i?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),rP=z({nonMaxSuppression_:function(e,t,n,r,s){r===void 0&&(r=.5),s===void 0&&(s=Number.NEGATIVE_INFINITY);var i=T(e,"boxes","nonMaxSuppression"),o=T(t,"scores","nonMaxSuppression"),l=Cd(i,o,n,r,s);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold;var c={maxOutputSize:n,iouThreshold:r,scoreThreshold:s};return V.runKernelFunc(function(u){return u.nonMaxSuppression(i,o,n,r,s)},{boxes:i,scores:o},null,"NonMaxSuppressionV3",c)}}),aP=function(e,t,n,r,s){return r===void 0&&(r=.5),s===void 0&&(s=Number.NEGATIVE_INFINITY),we(this,void 0,void 0,function(){var i,o,l,c,u,d,h;return Ne(this,function(p){switch(p.label){case 0:return i=T(e,"boxes","nonMaxSuppressionAsync"),o=T(t,"scores","nonMaxSuppressionAsync"),l=Cd(i,o,n,r,s),n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,[4,Promise.all([i.data(),o.data()])];case 1:return c=p.sent(),u=c[0],d=c[1],h=Bm(u,d,n,r,s),i!==e&&i.dispose(),o!==t&&o.dispose(),[2,h]}})})},sP=z({nonMaxSuppressionWithScore_:function(e,t,n,r,s,i){r===void 0&&(r=.5),s===void 0&&(s=Number.NEGATIVE_INFINITY),i===void 0&&(i=0);var o=T(e,"boxes","nonMaxSuppression"),l=T(t,"scores","nonMaxSuppression"),c=Cd(o,l,n,r,s,i),u={maxOutputSize:n=c.maxOutputSize,iouThreshold:r=c.iouThreshold,scoreThreshold:s=c.scoreThreshold,softNmsSigma:i=c.softNmsSigma},d=V.runKernel("NonMaxSuppressionV5",{boxes:o,scores:l},u);return{selectedIndices:d[0],selectedScores:d[1]}}}),iP=function(e,t,n,r,s,i){return r===void 0&&(r=.5),s===void 0&&(s=Number.NEGATIVE_INFINITY),i===void 0&&(i=0),we(this,void 0,void 0,function(){var o,l,c,u,d,h,p;return Ne(this,function(f){switch(f.label){case 0:return o=T(e,"boxes","nonMaxSuppressionAsync"),l=T(t,"scores","nonMaxSuppressionAsync"),c=Cd(o,l,n,r,s,i),n=c.maxOutputSize,r=c.iouThreshold,s=c.scoreThreshold,i=c.softNmsSigma,[4,Promise.all([o.data(),l.data()])];case 1:return u=f.sent(),d=u[0],h=u[1],p=$m(d,h,n,r,s,i),o!==e&&o.dispose(),l!==t&&l.dispose(),[2,p]}})})},oP=z({cropAndResize_:function(e,t,n,r,s,i){var o=T(e,"image","cropAndResize"),l=T(t,"boxes","cropAndResize","float32"),c=T(n,"boxInd","cropAndResize","int32");s=s||"bilinear",i=i||0;var u=l.shape[0];return M(o.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+o.rank+"."}),M(l.rank===2&&l.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+u+",4] but had shape "+l.shape+"."}),M(c.rank===1&&c.shape[0]===u,function(){return"Error in cropAndResize: boxInd must be have size ["+u+"] but had shape "+l.shape+"."}),M(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),M(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),M(s==="bilinear"||s==="nearest",function(){return"method must be bilinear or nearest, but was "+s}),V.runKernelFunc(function(d,h){return d.cropAndResize(o,l,c,r,s,i)},{images:o,boxes:l,boxInd:c},null,"CropAndResize",{method:s,extrapolationValue:i,cropSize:r})}}),ex=Object.freeze({resizeBilinear:tP,resizeNearestNeighbor:nP,nonMaxSuppression:rP,nonMaxSuppressionAsync:aP,nonMaxSuppressionWithScore:sP,nonMaxSuppressionWithScoreAsync:iP,cropAndResize:oP}),tx=function(e,t){return!(e>0)||t==="linear"},nx=function(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},rx=function(e,t){var n=t,r=$t(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},ax=function(e,t,n){if(t==="linear")return e;if(t==="relu")return gt(e);if(t==="elu")return bj(e);if(t==="relu6")return Nj(e);if(t==="prelu")return wj(e,n);throw new Error("Unknown fused activation "+t+".")},lP=z({fusedMatMul_:function(e){var t,n=e.a,r=e.b,s=e.transposeA,i=s!==void 0&&s,o=e.transposeB,l=o!==void 0&&o,c=e.bias,u=e.activation,d=u===void 0?"linear":u,h=e.preluActivationWeights;if(tx(V.state.gradientDepth,d)===!1){var p=Nd(n,r,i,l);return c!=null&&(p=Ve(p,c)),ax(p,d,h)}var f=T(n,"a","fused matMul"),x=T(r,"b","fused matMul");t=bt(f,x),f=t[0],x=t[1];var v=i?f.shape[f.rank-2]:f.shape[f.rank-1],y=l?x.shape[x.rank-1]:x.shape[x.rank-2],m=i?f.shape[f.rank-1]:f.shape[f.rank-2],g=l?x.shape[x.rank-2]:x.shape[x.rank-1],b=f.shape.slice(0,-2),w=x.shape.slice(0,-2),N=je(b),C=je(w);M(f.rank>=2&&x.rank>=2&&f.rank===x.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+f.rank+" and "+x.rank+"."}),M(Xt(b,w),function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+w+") of Tensors with shapes "+f.shape+" and "+x.shape+" must match."}),M(v===y,function(){return"Error in fused matMul: inner shapes ("+v+") and ("+y+") of Tensors with shapes "+f.shape+" and "+x.shape+" and transposeA="+i+" and transposeB="+l+" must match."});var D,j,k=f.shape.slice(0,-2).concat([m,g]),R=i?f.as3D(N,v,m):f.as3D(N,m,v),E=l?x.as3D(C,g,y):x.as3D(C,y,g);c!=null&&He(k,(D=bt(D=T(c,"bias","fused matMul"),f)[0]).shape),h!=null&&(j=T(h,"prelu weights","fused matMul"));var P={a:R,b:E};c!=null&&(P.bias=D),h!=null&&(P.preluActivationWeights=j);var F=[R,E];return V.runKernelFunc(function(W,L){var U=W.fusedBatchMatMul({a:R,b:E,transposeA:i,transposeB:l,bias:D,activation:d,preluActivationWeights:j});return L([R,E,U]),U},P,function(W,L){var U=L[0],_=L[1],B=L[2],O=nx(W,B,d),H={};return c!=null&&(H={bias:function(){return rx(D,O)}}),Object.assign(i||l?!i&&l?{a:function(){return O.matMul(_,!1,!1)},b:function(){return O.matMul(U,!0,!1)}}:i&&!l?{a:function(){return _.matMul(O,!1,!0)},b:function(){return U.matMul(O,!1,!1)}}:{a:function(){return _.matMul(O,!0,!0)},b:function(){return O.matMul(U,!0,!0)}}:{a:function(){return O.matMul(_,!1,!0)},b:function(){return U.matMul(O,!0,!1)}},H)},"_FusedMatMul",{transposeA:i,transposeB:l,activation:d},F,[!0]).reshape(k)}}),cP=z({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,s=e.pad,i=e.dataFormat,o=i===void 0?"NHWC":i,l=e.dilations,c=l===void 0?[1,1]:l,u=e.dimRoundingMode,d=e.bias,h=e.activation,p=h===void 0?"linear":h,f=e.preluActivationWeights;if(p=p||"linear",tx(V.state.gradientDepth,p)===!1){var x=ur(t,n,r,s,o,c,u);return d!=null&&(x=Ve(x,d)),ax(x,p,f)}var v=T(t,"x","conv2d"),y=T(n,"filter","conv2d"),m=v,g=!1;v.rank===3&&(g=!0,m=v.as4D(1,v.shape[0],v.shape[1],v.shape[2])),M(m.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+m.rank+"."}),M(y.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+y.rank+"."}),u!=null&&M(Dt(s),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+s+"."}),M(m.shape[3]===y.shape[2],function(){return"Error in conv2d: depth of input ("+m.shape[3]+") must match input depth for filter "+y.shape[2]+"."}),M(Pn(r,c),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+c+"'"}),M(o==="NHWC",function(){return"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported."});var b,w,N=Js(m.shape,y.shape,r,c,s,u);d!=null&&(b=bt(b=T(d,"bias","fused conv2d"),v)[0],He(N.outShape,b.shape)),f!=null&&(w=T(f,"prelu weights","fused conv2d"));var C={x:m,filter:y};d!=null&&(C.bias=b),f!=null&&(C.preluActivationWeights=w);var D=[y,m],j=V.runKernelFunc(function(k,R){var E=k.fusedConv2d({input:m,filter:y,convInfo:N,bias:b,activation:p,preluActivationWeights:w});return R([y,m,E]),E},C,function(k,R){var E=R,P=E[0],F=E[1],W=E[2],L=nx(k,W,p);M(eo(c),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+c+"'"});var U={};return d!=null&&(U={bias:function(){return rx(b,L)}}),Object.assign({x:function(){return hj(F.shape,L,P,r,s)},filter:function(){return Km(F,L,P.shape,r,s)}},U)},"FusedConv2D",{convInfo:N,activation:p},D,[!0]);return g?j.as3D(j.shape[1],j.shape[2],j.shape[3]):j}}),uP=z({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,s=e.pad,i=e.dataFormat,o=i===void 0?"NHWC":i,l=e.dilations,c=l===void 0?[1,1]:l,u=e.dimRoundingMode,d=e.bias,h=e.activation,p=h===void 0?"linear":h,f=e.preluActivationWeights;if(tx(V.state.gradientDepth,p)===!1){var x=wd(t,n,r,s,o,c,u);return d!=null&&(x=Ve(x,d)),ax(x,p,f)}var v=T(t,"x","depthwiseConv2d"),y=T(n,"filter","depthwiseConv2d"),m=v,g=!1;v.rank===3&&(g=!0,m=v.as4D(1,v.shape[0],v.shape[1],v.shape[2])),M(m.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+m.rank+"."}),M(y.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+y.rank+"."}),M(m.shape[3]===y.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+m.shape[3]+") must match the inChannels dimension in filter "+y.shape[2]+"."}),c==null&&(c=[1,1]),M(Pn(r,c),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+c+"'"}),u!=null&&M(Dt(s),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+u+" but got pad "+s+"."});var b,w,N=Js(m.shape,y.shape,r,c,s,u,!0);d!=null&&(b=bt(b=T(d,"bias","fused conv2d"),v)[0],He(N.outShape,b.shape)),f!=null&&(w=T(f,"prelu weights","fused depthwiseConv2d"));var C={x:m,filter:y};d!=null&&(C.bias=b),f!=null&&(C.preluActivationWeights=w);var D=[y,m],j=V.runKernelFunc(function(k,R){var E=k.fusedDepthwiseConv2D({input:m,filter:y,convInfo:N,bias:b,activation:p,preluActivationWeights:w});return R([y,m,E]),E},C,function(k,R){M(eo(c),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+c+"'"});var E=R[0],P=R[1],F=R[2],W=nx(k,F,p),L={};return d!=null&&(L={bias:function(){return rx(b,W)}}),Object.assign({x:function(){return pj(P.shape,W,E,N)},filter:function(){return fj(P,W,E.shape,N)}},L)},"FusedDepthwiseConv2D",{convInfo:N,activation:p},D,[!0]);return g?j.as3D(j.shape[1],j.shape[2],j.shape[3]):j}}),dP=Object.freeze({matMul:lP,conv2d:cP,depthwiseConv2d:uP}),hP=Object.freeze({image:ex,linalg:eP,losses:YI,spectral:FI,fused:dP,signal:$I,square:qA,squaredDifference:YN,conv1d:tI,conv2d:ur,conv3d:nI,depthwiseConv2d:wd,separableConv2d:Xm,conv2dTranspose:rI,conv3dTranspose:aI,op:z,batchNormalization2d:N6,batchNormalization3d:j6,batchNormalization4d:C6,batchNormalization:k6,batchNorm:nj,batchNorm2d:S6,batchNorm3d:E6,batchNorm4d:D6,booleanMaskAsync:eI,complex:Jt,real:Zn,imag:Mr,concat:Ot,concat1d:d_,concat2d:h_,concat3d:p_,concat4d:f_,split:Fm,matMul:Nd,dot:sI,outerProduct:iI,reverse:Il,reverse1d:oI,reverse2d:lI,reverse3d:cI,reverse4d:uI,maxPool:Vt,avgPool:Pl,pool:dI,maxPool3d:hI,avgPool3d:pI,slice:Gr,slice1d:fI,slice2d:mI,slice3d:gj,slice4d:xI,abs:GA,acos:KA,acosh:XA,asin:YA,asinh:QA,atan:JA,atanh:ZA,ceil:e6,clipByValue:Hm,cos:t6,cosh:n6,erf:r6,exp:lf,expm1:a6,floor:s6,log:i6,log1p:o6,logSigmoid:l6,neg:Pu,reciprocal:c6,round:u6,rsqrt:QN,sigmoid:JN,sign:d6,isNaN:h6,isInf:p6,isFinite:f6,sin:m6,sinh:x6,softplus:g6,sqrt:v6,step:y6,tan:b6,tanh:w6,all:gI,any:vI,argMax:yI,argMin:bI,logSumExp:wI,max:jd,mean:NI,min:jI,moments:CI,sum:yj,prod:kI,equal:oj,equalStrict:V6,greater:H6,greaterEqual:lj,greaterEqualStrict:q6,greaterStrict:G6,less:K6,lessEqual:X6,lessEqualStrict:Y6,lessStrict:Q6,notEqual:J6,notEqualStrict:Z6,add:Ve,addN:T6,addStrict:A6,atan2:I6,div:mr,divNoNan:P6,divStrict:F6,floorDiv:sj,maximum:qm,maximumStrict:M6,minimum:ij,minimumStrict:L6,mod:O6,modStrict:B6,mul:hn,mulStrict:$6,pow:Fu,powStrict:z6,squaredDifferenceStrict:U6,sub:zt,subStrict:W6,elu:bj,leakyRelu:SI,prelu:wj,relu:gt,relu6:Nj,selu:EI,logicalAnd:bd,logicalNot:R6,logicalOr:rj,logicalXor:_6,where:Hs,whereAsync:aj,buffer:Le,print:j_,batchToSpaceND:yN,broadcastTo:C_,cast:k_,clone:S_,cumsum:E_,depthToSpace:D_,expandDims:Jn,eye:bN,multinomial:R_,oneHot:rf,pad:Qs,pad1d:__,pad2d:T_,pad3d:A_,pad4d:I_,rand:P_,randomNormal:F_,randomGamma:M_,randomUniform:wN,reshape:gr,spaceToBatchND:NN,squeeze:jN,stack:Vn,tile:Ti,truncatedNormal:L_,unstack:Bt,setdiff1dAsync:O_,fill:Vr,linspace:u_,ones:lo,range:Su,scalar:fe,tensor:en,tensor1d:Tt,tensor2d:Za,tensor3d:Pm,tensor4d:jn,tensor5d:o_,tensor6d:l_,variable:c_,zeros:ct,onesLike:vN,zerosLike:Ke,transpose:os,softmax:ja,logSoftmax:H_,localResponseNormalization:DI,norm:jj,gather:Gm,unsortedSegmentSum:cj,basicLSTMCell:RI,multiRNNCell:_I,movingAverage:TI,stridedSlice:AI,topk:II,scatterND:PI,fft:Ym,ifft:Mu,rfft:Qm,irfft:Cj,sparseToDense:MI,gatherND:LI,diag:OI,dropout:BI,hannWindow:Jm,hammingWindow:Sj,frame:Zm,stft:Ej,inTopKAsync:zI});function re(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(n){n!=null&&M(n.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function _h(e,t,n,r){if(n==="linear")return e.linear(t);if(n==="relu")return e.relu(t);if(n==="elu")return e.elu(t);if(n==="relu6")return e.relu6(t);if(n==="prelu")return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var pP=function(e){function t(){var n=e.call(this)||this;return n.blockSize=48,n.firstUse=!0,n.data=new _N(n,V),n}return kr(t,e),t.prototype.write=function(n,r,s){this.firstUse&&(this.firstUse=!1,ee().get("IS_NODE")&&Cu(`
============================
Hi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var i={};return this.data.set(i,{values:n,dtype:s}),i},t.prototype.move=function(n,r,s,i){this.data.set(n,{values:r,dtype:i})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(n){return we(this,void 0,void 0,function(){return Ne(this,function(r){return[2,this.readSync(n)]})})},t.prototype.readSync=function(n){var r=this.data.get(n),s=r.dtype,i=r.complexTensors;return s==="complex64"?of(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(n).values},t.prototype.bufferSync=function(n){var r=this.readSync(n.dataId),s=r;if(n.dtype==="string")try{s=r.map(function(i){return wu(i)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Le(n.shape,n.dtype,s)},t.prototype.makeOutput=function(n,r,s){var i=this.write(n,r,s);return V.makeTensorFromDataId(i,r,s,this)},t.prototype.disposeData=function(n){if(this.data.has(n)){var r=this.data.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(n)}},t.prototype.time=function(n){return we(this,void 0,void 0,function(){var r;return Ne(this,function(s){return r=Ir(),n(),[2,{kernelMs:Ir()-r}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(n,r){var s=this.makeOutput(null,n.shape,"complex64");return this.data.get(s.dataId).complexTensors={real:V.keep(n.clone()),imag:V.keep(r.clone())},s},t.prototype.real=function(n){return this.data.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.data.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,s){if(re(n,"slice"),DN(n.shape,r,s)){var i=RN(r,n.strides),o=je(s);return en(this.readSync(n.dataId).subarray(i,i+o),s,n.dtype)}for(var l=Le(s,n.dtype),c=this.bufferSync(n),u=0;u<l.size;++u){var d=l.indexToLoc(u).map(function(h,p){return h+r[p]});l.values[u]=c.get.apply(c,d)}return l.toTensor()},t.prototype.stridedSlice=function(n,r,s,i){re(n,"stridedSlice");var o=Lm(r,s,i);if(o.some(function(f){return f===0}))return en([],o);for(var l=Le(o,n.dtype),c=this.bufferSync(n),u=0;u<l.size;u++){for(var d=l.indexToLoc(u),h=new Array(d.length),p=0;p<h.length;p++)h[p]=d[p]*i[p]+r[p];l.set.apply(l,[c.get.apply(c,h)].concat(d))}return l.toTensor()},t.prototype.diag=function(n){for(var r=this.readSync(n.dataId),s=Le([n.size,n.size],n.dtype),i=s.values,o=0;o<r.length;o++)i[o*n.size+o]=r[o];return s.toTensor()},t.prototype.unstack=function(n,r){for(var s=n.shape[r],i=new Array(n.rank-1),o=0,l=0;l<n.rank;l++)l!==r&&(i[o++]=n.shape[l]);var c=new Array(n.rank).fill(0),u=n.shape.slice();u[r]=1;var d=new Array(s);for(l=0;l<d.length;l++)c[r]=l,d[l]=this.slice(n,c,u).reshape(i);return d},t.prototype.reverse=function(n,r){re(n,"reverse");for(var s=Le(n.shape,n.dtype),i=this.bufferSync(n),o=function(c){var u=s.indexToLoc(c),d=u.slice();r.forEach(function(h){return d[h]=n.shape[h]-1-d[h]}),s.set.apply(s,[i.get.apply(i,d)].concat(u))},l=0;l<s.size;l++)o(l);return s.toTensor()},t.prototype.concat=function(n,r){var s=this;if(n[0].dtype==="complex64"){var i=n.map(function(f){return Zn(f)}),o=n.map(function(f){return Mr(f)});return Jt(this.concat(i,r),this.concat(o,r))}var l=n.map(function(f){var x=je(f.shape.slice(r));return f.as2D(-1,x)}),c=Zi(l.map(function(f){return f.shape}),1),u=Le(c,n[0].dtype).values;if(l[0].shape[0]===1){var d=0;l.forEach(function(f){u.set(s.readSync(f.dataId),d),d+=f.size})}else{var h=0;l.forEach(function(f){for(var x=s.readSync(f.dataId),v=0,y=0;y<f.shape[0];++y)for(var m=y*c[1]+h,g=0;g<f.shape[1];++g)u[m+g]=x[v++];h+=f.shape[1]})}var p=Zi(n.map(function(f){return f.shape}),r);return en(u,p,n[0].dtype)},t.prototype.neg=function(n){return re(n,"neg"),this.multiply(fe(-1),n)},t.prototype.add=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(s,i,o,l){return{real:s+o,imag:i+l}}):this.broadcastedBinaryOp(n,r,Zt(n.dtype,r.dtype),function(s,i){return s+i})},t.prototype.addN=function(n){var r=this;re(n,"addN");for(var s=n.map(function(d){return r.readSync(d.dataId)}),i=Le(n[0].shape,n[0].dtype),o=i.values,l=0;l<n.length;l++)for(var c=s[l],u=0;u<o.length;u++)o[u]+=c[u];return i.toTensor()},t.prototype.softmax=function(n,r){var s=Ut([r],n.shape),i=this.max(n,s),o=In(i.shape,s),l=this.subtract(n,i.reshape(o)),c=this.exp(l),u=this.sum(c,s).reshape(o);return this.realDivide(c,u)},t.prototype.subtract=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(s,i,o,l){return{real:s-o,imag:i-l}}):this.broadcastedBinaryOp(n,r,Zt(n.dtype,r.dtype),function(s,i){return s-i})},t.prototype.pow=function(n,r){return re([n,r],"pow"),this.broadcastedBinaryOp(n,r,n.dtype,function(s,i){return Math.pow(s,i)})},t.prototype.batchMatMul=function(n,r,s,i){re([n,r],"matMul");for(var o=s?n.shape[1]:n.shape[2],l=s?n.shape[2]:n.shape[1],c=i?r.shape[1]:r.shape[2],u=n.shape[0],d=this.readSync(n.dataId),h=this.readSync(r.dataId),p=s?[n.strides[0],1,n.strides[1]]:[n.strides[0],n.strides[1],1],f=p[0],x=p[1],v=p[2],y=i?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],m=y[0],g=y[1],b=y[2],w=l*c,N=Le([u,l,c],n.dtype),C=N.values,D=this.blockSize,j=0;j<u;j++)for(var k=0;k<l;k+=D)for(var R=0;R<c;R+=D)for(var E=0;E<o;E+=D)for(var P=Math.min(k+D,l),F=Math.min(R+D,c),W=Math.min(E+D,o),L=k;L<P;L++)for(var U=R;U<F;U++){for(var _=0,B=E;B<W;B++)_+=d[j*f+L*x+B*v]*h[B*m+U*g+j*b];C[j*w+(L*c+U)]+=_}return N.toTensor()},t.prototype.fusedBatchMatMul=function(n){var r=n.a,s=n.b,i=n.transposeA,o=n.transposeB,l=n.bias,c=n.activation,u=n.preluActivationWeights,d=this.batchMatMul(r,s,i,o);return l&&(d=this.add(d,l)),c&&(d=_h(this,d,c,u)),d},t.prototype.multiply=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(s,i,o,l){return{real:s*o-i*l,imag:s*l+i*o}}):this.broadcastedBinaryOp(n,r,Zt(n.dtype,r.dtype),function(s,i){return s*i})},t.prototype.realDivide=function(n,r){return re([n,r],"realDivide"),this.broadcastedBinaryOp(n,r,"float32",function(s,i){return s/i})},t.prototype.floorDiv=function(n,r){return re([n,r],"floorDiv"),this.broadcastedBinaryOp(n,r,"int32",function(s,i){return Math.floor(s/i)})},t.prototype.sum=function(n,r){re(n,"sum"),Mn("sum",r,n.rank);for(var s=sn(n.shape,r),i=s[0],o=s[1],l=ct(i,Zt(n.dtype,"int32")),c=je(o),u=this.readSync(l.dataId),d=this.readSync(n.dataId),h=0;h<u.length;++h){for(var p=h*c,f=0,x=0;x<c;++x)f+=d[p+x];u[h]=f}return l},t.prototype.prod=function(n,r){re(n,"sum");for(var s=sn(n.shape,r),i=s[0],o=s[1],l=ct(i,Zt(n.dtype,"int32")),c=je(o),u=this.readSync(l.dataId),d=this.readSync(n.dataId),h=0;h<u.length;++h){for(var p=h*c,f=1,x=0;x<c;++x)f*=d[p+x];u[h]=f}return l},t.prototype.unsortedSegmentSum=function(n,r,s){re(n,"unsortedSegmentSum");for(var i=[],o=n.rank-r.rank,l=0;l<o;++l)r=r.expandDims(l+1);for(l=0;l<s;++l){var c=fe(l,"int32"),u=oj(c,r).asType("float32").mul(n).sum(0);i.push(u)}return Vn(i)},t.prototype.argMin=function(n,r){re(n,"argMin");var s=[r];Mn("argMin",s,n.rank);for(var i=sn(n.shape,s),o=i[0],l=i[1],c=ct(o,"int32"),u=je(l),d=this.readSync(c.dataId),h=this.readSync(n.dataId),p=0;p<d.length;++p){for(var f=p*u,x=h[f],v=0,y=0;y<u;++y){var m=h[f+y];m<x&&(x=m,v=y)}d[p]=v}return c},t.prototype.argMax=function(n,r){re(n,"argMax");var s=[r];Mn("argMax",s,n.rank);for(var i=sn(n.shape,s),o=i[0],l=i[1],c=ct(o,"int32"),u=je(l),d=this.readSync(c.dataId),h=this.readSync(n.dataId),p=0;p<d.length;++p){for(var f=p*u,x=h[f],v=0,y=0;y<u;++y){var m=h[f+y];m>x&&(x=m,v=y)}d[p]=v}return c},t.prototype.cumsum=function(n,r,s,i){if(re(n,"cumsum"),r!==n.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(n.rank-1)+" but got axis="+r);for(var o=Zt(n.dtype,"int32"),l=ct(n.shape,o),c=this.readSync(l.dataId),u=this.readSync(n.dataId),d=n.shape[n.rank-1],h=i?function(y,m){return y+d-m-1}:function(y,m){return y+m},p=0;p<u.length;p+=d)for(var f=0;f<d;f++){var x=h(p,f);if(f===0)c[x]=s?0:u[x];else{var v=h(p,f-1);c[x]=s?u[v]+c[v]:u[x]+c[v]}}return l},t.prototype.equal=function(n,r){return re([n,r],"equal"),this.broadcastedBinaryOp(n,r,"bool",function(s,i){return s===i?1:0})},t.prototype.notEqual=function(n,r){return re([n,r],"notEqual"),this.broadcastedBinaryOp(n,r,"bool",function(s,i){return s!==i?1:0})},t.prototype.less=function(n,r){return re([n,r],"less"),this.broadcastedBinaryOp(n,r,"bool",function(s,i){return s<i?1:0})},t.prototype.lessEqual=function(n,r){return re([n,r],"lessEqual"),this.broadcastedBinaryOp(n,r,"bool",function(s,i){return s<=i?1:0})},t.prototype.greater=function(n,r){return re([n,r],"greater"),this.broadcastedBinaryOp(n,r,"bool",function(s,i){return s>i?1:0})},t.prototype.greaterEqual=function(n,r){return re([n,r],"greaterEqual"),this.broadcastedBinaryOp(n,r,"bool",function(s,i){return s>=i?1:0})},t.prototype.logicalNot=function(n){re(n,"logicalNot");for(var r=this.readSync(n.dataId),s=new Uint8Array(r.length),i=0;i<r.length;++i)s[i]=r[i]?0:1;return this.makeOutput(s,n.shape,"bool")},t.prototype.logicalAnd=function(n,r){return re([n,r],"logicalAnd"),this.broadcastedBinaryOp(n,r,"bool",function(s,i){return s&&i})},t.prototype.logicalOr=function(n,r){return re([n,r],"logicalOr"),this.broadcastedBinaryOp(n,r,"bool",function(s,i){return s||i})},t.prototype.select=function(n,r,s){re([n,r,s],"select");for(var i=this.readSync(n.dataId),o=this.readSync(r.dataId),l=this.readSync(s.dataId),c=ct(r.shape,Zt(r.dtype,s.dtype)),u=this.readSync(c.dataId),d=0,h=n.rank===0||n.rank>1||r.rank===1?1:je(r.shape.slice(1)),p=0;p<i.length;p++)for(var f=0;f<h;f++)i[p]===1?u[d++]=o[p]:u[d++]=l[p];return c},t.prototype.where=function(n){re([n],"where");var r=this.readSync(n.dataId);return zm(n.shape,r)},t.prototype.topk=function(n,r,s){return re(n,"topk"),ON(this.readSync(n.dataId),n.shape,n.dtype,r)},t.prototype.min=function(n,r){re(n,"min"),Mn("min",r,n.rank);for(var s=sn(n.shape,r),i=s[0],o=s[1],l=ct(i,n.dtype),c=je(o),u=this.readSync(l.dataId),d=this.readSync(n.dataId),h=0;h<u.length;++h){for(var p=h*c,f=d[p],x=0;x<c;++x){var v=d[p+x];v<f&&(f=v)}u[h]=f}return l},t.prototype.minimum=function(n,r){return re([n,r],"minimum"),this.broadcastedBinaryOp(n,r,n.dtype,function(s,i){return Math.min(s,i)})},t.prototype.mod=function(n,r){return re([n,r],"mod"),this.broadcastedBinaryOp(n,r,n.dtype,function(s,i){var o=s%i;return s<0&&i<0||s>=0&&i>=0?o:(o+i)%i})},t.prototype.max=function(n,r){re(n,"max"),Mn("max",r,n.rank);for(var s=sn(n.shape,r),i=s[0],o=s[1],l=ct(i,n.dtype),c=je(o),u=this.readSync(l.dataId),d=this.readSync(n.dataId),h=0;h<u.length;++h){for(var p=h*c,f=d[p],x=0;x<c;++x){var v=d[p+x];v>f&&(f=v)}u[h]=f}return l},t.prototype.maximum=function(n,r){return re([n,r],"maximum"),this.broadcastedBinaryOp(n,r,n.dtype,function(s,i){return Math.max(s,i)})},t.prototype.all=function(n,r){re(n,"all"),Mn("all",r,n.rank);for(var s=sn(n.shape,r),i=s[0],o=s[1],l=ct(i,n.dtype),c=je(o),u=this.readSync(l.dataId),d=this.readSync(n.dataId),h=0;h<u.length;++h){for(var p=h*c,f=d[p],x=0;x<c;++x){var v=d[p+x];f=f&&v}u[h]=f}return l},t.prototype.any=function(n,r){re(n,"any"),Mn("any",r,n.rank);for(var s=sn(n.shape,r),i=s[0],o=s[1],l=ct(i,n.dtype),c=je(o),u=this.readSync(l.dataId),d=this.readSync(n.dataId),h=0;h<u.length;++h){for(var p=h*c,f=d[p],x=0;x<c;++x){var v=d[p+x];f=f||v}u[h]=f}return l},t.prototype.squaredDifference=function(n,r){return re([n,r],"squaredDifference"),this.broadcastedBinaryOp(n,r,n.dtype,function(s,i){var o=s-i;return o*o})},t.prototype.ceil=function(n){re(n,"ceil");for(var r=this.readSync(n.dataId),s=new Float32Array(r.length),i=0;i<r.length;++i)s[i]=Math.ceil(r[i]);return this.makeOutput(s,n.shape,"float32")},t.prototype.floor=function(n){re(n,"floor");for(var r=this.readSync(n.dataId),s=new Float32Array(r.length),i=0;i<r.length;++i)s[i]=Math.floor(r[i]);return this.makeOutput(s,n.shape,"float32")},t.prototype.sign=function(n){re(n,"x");for(var r=this.readSync(n.dataId),s=new Float32Array(r.length),i=0;i<r.length;++i)r[i]<0?s[i]=-1:r[i]>0?s[i]=1:s[i]=0;return this.makeOutput(s,n.shape,"float32")},t.prototype.isNaN=function(n){re(n,"x");for(var r=this.readSync(n.dataId),s=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isNaN(r[i])&&(s[i]=1);return this.makeOutput(s,n.shape,"bool")},t.prototype.isInf=function(n){re(n,"x");for(var r=this.readSync(n.dataId),s=new Uint8Array(r.length),i=0;i<r.length;++i)Math.abs(r[i])===1/0&&(s[i]=1);return this.makeOutput(s,n.shape,"bool")},t.prototype.isFinite=function(n){re(n,"x");for(var r=this.readSync(n.dataId),s=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isFinite(r[i])&&(s[i]=1);return this.makeOutput(s,n.shape,"bool")},t.prototype.round=function(n){re(n,"round");for(var r=this.readSync(n.dataId),s=new Float32Array(r.length),i=0;i<r.length;++i){var o=Math.floor(r[i]);r[i]-o<.5?s[i]=Math.floor(r[i]):r[i]-o>.5?s[i]=Math.ceil(r[i]):s[i]=o%2==0?o:o+1}return this.makeOutput(s,n.shape,"float32")},t.prototype.exp=function(n){re(n,"exp");for(var r=this.readSync(n.dataId),s=new Float32Array(r.length),i=0;i<r.length;++i)s[i]=Math.exp(r[i]);return this.makeOutput(s,n.shape,"float32")},t.prototype.expm1=function(n){re(n,"expm1");for(var r=this.readSync(n.dataId),s=new Float32Array(r.length),i=0;i<r.length;++i)s[i]=Math.expm1(r[i]);return this.makeOutput(s,n.shape,"float32")},t.prototype.log=function(n){re(n,"log");for(var r=this.readSync(n.dataId),s=new Float32Array(r.length),i=0;i<r.length;++i){var o=r[i];s[i]=Math.log(o)}return this.makeOutput(s,n.shape,"float32")},t.prototype.log1p=function(n){re(n,"log1p");for(var r=this.readSync(n.dataId),s=new Float32Array(r.length),i=0;i<r.length;++i){var o=r[i];s[i]=Math.log1p(o)}return this.makeOutput(s,n.shape,"float32")},t.prototype.sqrt=function(n){re(n,"sqrt");for(var r=this.readSync(n.dataId),s=new Float32Array(r.length),i=0;i<r.length;++i){var o=r[i];s[i]=Math.sqrt(o)}return this.makeOutput(s,n.shape,"float32")},t.prototype.rsqrt=function(n){re(n,"rsqrt");for(var r=this.readSync(n.dataId),s=new Float32Array(r.length),i=0;i<r.length;++i){var o=r[i];s[i]=1/Math.sqrt(o)}return this.makeOutput(s,n.shape,"float32")},t.prototype.reciprocal=function(n){re(n,"reciprocal");for(var r=this.readSync(n.dataId),s=new Float32Array(r.length),i=0;i<r.length;++i)s[i]=1/r[i];return this.makeOutput(s,n.shape,"float32")},t.prototype.linear=function(n){return n},t.prototype.relu=function(n){re(n,"relu");for(var r=ct(n.shape,n.dtype),s=this.readSync(r.dataId),i=this.readSync(n.dataId),o=0;o<i.length;++o)s[o]=Math.max(0,i[o]);return r},t.prototype.relu6=function(n){re(n,"relu");for(var r=ct(n.shape,n.dtype),s=this.readSync(r.dataId),i=this.readSync(n.dataId),o=0;o<i.length;++o)s[o]=Math.min(Math.max(0,i[o]),6);return r},t.prototype.prelu=function(n,r){return re([n,r],"prelu"),this.broadcastedBinaryOp(n,r,n.dtype,function(s,i){return s<0?i*s:s})},t.prototype.elu=function(n){re(n,"elu");for(var r=new Float32Array(n.size),s=this.readSync(n.dataId),i=0;i<s.length;++i){var o=s[i];r[i]=o>=0?o:Math.exp(o)-1}return this.makeOutput(r,n.shape,"float32")},t.prototype.eluDer=function(n,r){re([n,r],"eluDer");for(var s=new Float32Array(r.size),i=this.readSync(r.dataId),o=this.readSync(n.dataId),l=0;l<i.length;++l){var c=i[l];s[l]=c>=1?o[l]:o[l]*(c+1)}return this.makeOutput(s,r.shape,"float32")},t.prototype.selu=function(n){re(n,"selu");for(var r=Wm,s=Vm,i=new Float32Array(n.size),o=this.readSync(n.dataId),l=0;l<o.length;++l){var c=o[l];i[l]=c>=0?s*c:r*(Math.exp(c)-1)}return this.makeOutput(i,n.shape,"float32")},t.prototype.clip=function(n,r,s){re(n,"clip");for(var i=new Float32Array(n.size),o=this.readSync(n.dataId),l=0;l<o.length;++l){var c=o[l];i[l]=c>s?s:c<r?r:c}return this.makeOutput(i,n.shape,"float32")},t.prototype.abs=function(n){for(var r=new Float32Array(n.size),s=this.readSync(n.dataId),i=0;i<s.length;++i)r[i]=Math.abs(s[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.complexAbs=function(n){for(var r=new Float32Array(n.size),s=this.readSync(n.dataId),i=0;i<n.size;++i){var o=s[2*i],l=s[2*i+1];r[i]=Math.hypot(o,l)}return this.makeOutput(r,n.shape,"float32")},t.prototype.int=function(n){re(n,"int");for(var r=new Int32Array(n.size),s=this.readSync(n.dataId),i=0;i<s.length;++i)r[i]=s[i];return this.makeOutput(r,n.shape,"int32")},t.prototype.sigmoid=function(n){re(n,"sigmoid");for(var r=new Float32Array(n.size),s=this.readSync(n.dataId),i=0;i<s.length;++i)r[i]=1/(1+Math.exp(-s[i]));return this.makeOutput(r,n.shape,"float32")},t.prototype.softplus=function(n){re(n,"softplus");for(var r=Math.log(11920928955078125e-23)+2,s=new Float32Array(n.size),i=this.readSync(n.dataId),o=0;o<i.length;++o){var l=i[o]>-r,c=i[o]<r,u=Math.exp(i[o]),d=void 0;d=c?u:l?i[o]:Math.log(1+u),s[o]=d}return this.makeOutput(s,n.shape,"float32")},t.prototype.sin=function(n){re(n,"sin");for(var r=new Float32Array(n.size),s=this.readSync(n.dataId),i=0;i<s.length;++i)r[i]=Math.sin(s[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cos=function(n){re(n,"cos");for(var r=new Float32Array(n.size),s=this.readSync(n.dataId),i=0;i<s.length;++i)r[i]=Math.cos(s[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tan=function(n){re(n,"tan");for(var r=new Float32Array(n.size),s=this.readSync(n.dataId),i=0;i<s.length;++i)r[i]=Math.tan(s[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asin=function(n){re(n,"asin");for(var r=new Float32Array(n.size),s=this.readSync(n.dataId),i=0;i<s.length;++i)r[i]=Math.asin(s[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acos=function(n){re(n,"acos");for(var r=new Float32Array(n.size),s=this.readSync(n.dataId),i=0;i<s.length;++i)r[i]=Math.acos(s[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan=function(n){re(n,"atan");for(var r=new Float32Array(n.size),s=this.readSync(n.dataId),i=0;i<s.length;++i)r[i]=Math.atan(s[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan2=function(n,r){return re([n,r],"atan2"),this.broadcastedBinaryOp(n,r,n.dtype,function(s,i){return Math.atan2(s,i)})},t.prototype.sinh=function(n){re(n,"sinh");for(var r=new Float32Array(n.size),s=this.readSync(n.dataId),i=0;i<s.length;++i)r[i]=Math.sinh(s[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cosh=function(n){re(n,"cosh");for(var r=new Float32Array(n.size),s=this.readSync(n.dataId),i=0;i<s.length;++i)r[i]=Math.cosh(s[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tanh=function(n){re(n,"tanh");for(var r=new Float32Array(n.size),s=this.readSync(n.dataId),i=0;i<s.length;++i)r[i]=fR(s[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asinh=function(n){re(n,"asinh");for(var r=new Float32Array(n.size),s=this.readSync(n.dataId),i=0;i<s.length;++i)r[i]=Math.asinh(s[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acosh=function(n){re(n,"acosh");for(var r=new Float32Array(n.size),s=this.readSync(n.dataId),i=0;i<s.length;++i)r[i]=Math.acosh(s[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atanh=function(n){re(n,"atanh");for(var r=new Float32Array(n.size),s=this.readSync(n.dataId),i=0;i<s.length;++i)r[i]=Math.atanh(s[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.erf=function(n){re(n,"erf");for(var r=new Float32Array(n.size),s=this.readSync(n.dataId),i=0;i<s.length;++i){var o=Math.sign(s[i]),l=Math.abs(s[i]),c=1/(1+.3275911*l);r[i]=o*(1-((((1.061405429*c-1.453152027)*c+1.421413741)*c-.284496736)*c+.254829592)*c*Math.exp(-l*l))}return this.makeOutput(r,n.shape,"float32")},t.prototype.step=function(n,r){r===void 0&&(r=0),re(n,"step");for(var s=new Float32Array(n.size),i=this.readSync(n.dataId),o=0;o<i.length;++o){var l=i[o];isNaN(l)?s[o]=NaN:s[o]=l>0?1:r}return this.makeOutput(s,n.shape,"float32")},t.prototype.fusedConv2d=function(n){var r=n.input,s=n.filter,i=n.convInfo,o=n.bias,l=n.activation,c=n.preluActivationWeights,u=this.conv2d(r,s,i);return o&&(u=this.add(u,o)),l&&(u=_h(this,u,l,c)),u},t.prototype.conv2d=function(n,r,s){re([n,r],"conv2d");for(var i=s.filterHeight,o=s.filterWidth,l=s.dilationHeight,c=s.dilationWidth,u=s.padInfo.left,d=s.padInfo.top,h=s.dataFormat==="channelsLast",p=Le(s.outShape,n.dtype),f=n.strides[0],x=h?n.strides[1]:n.strides[2],v=h?n.strides[2]:1,y=h?1:n.strides[1],m=p.strides[0],g=h?p.strides[1]:p.strides[2],b=h?p.strides[2]:1,w=h?1:p.strides[1],N=this.readSync(n.dataId),C=this.readSync(r.dataId),D=p.values,j=0;j<s.batchSize;++j)for(var k=j*f,R=j*m,E=0;E<s.outHeight;++E)for(var P=R+E*g,F=E*s.strideHeight-d,W=0;W<i;W++){var L=F+W*l;if(!(L<0||L>=s.inHeight))for(var U=W*r.strides[0],_=k+L*x,B=0;B<s.outWidth;++B)for(var O=P+B*b,H=B*s.strideWidth-u,J=0;J<o;J++){var te=H+J*c;if(!(te<0||te>=s.inWidth))for(var ce=_+te*v,se=U+J*r.strides[1],le=0;le<s.inChannels;++le){for(var he=N[ce+le*y],ye=0;ye<s.outChannels;++ye)D[O+ye*w]+=he*C[se+ye];se+=s.outChannels}}}return p.toTensor()},t.prototype.conv3d=function(n,r,s){for(var i=s.filterDepth,o=s.filterHeight,l=s.filterWidth,c=s.dilationDepth,u=s.dilationHeight,d=s.dilationWidth,h=s.padInfo.front,p=s.padInfo.left,f=s.padInfo.top,x=Le(s.outShape,n.dtype),v=this.readSync(n.dataId),y=this.readSync(r.dataId),m=x.values,g=0;g<s.batchSize;++g)for(var b=g*n.strides[0],w=g*x.strides[0],N=0;N<s.outDepth;++N)for(var C=w+N*x.strides[1],D=N*s.strideDepth-h,j=0;j<i;j++){var k=D+j*c;if(!(k<0||k>=s.inDepth))for(var R=j*r.strides[0],E=b+k*n.strides[1],P=0;P<s.outHeight;++P)for(var F=C+P*x.strides[2],W=P*s.strideHeight-f,L=0;L<o;L++){var U=W+L*u;if(!(U<0||U>=s.inHeight))for(var _=R+L*r.strides[1],B=E+U*n.strides[2],O=0;O<s.outWidth;++O)for(var H=F+O*s.outChannels,J=O*s.strideWidth-p,te=0;te<l;te++){var ce=J+te*d;if(!(ce<0||ce>=s.inWidth))for(var se=_+te*r.strides[2],le=B+ce*s.inChannels,he=se,ye=0;ye<s.inChannels;++ye){for(var Ce=v[le+ye],xe=0;xe<s.outChannels;++xe)m[H+xe]+=Ce*y[he+xe];he+=s.outChannels}}}}return x.toTensor()},t.prototype.conv2dDerInput=function(n,r,s){re([n,r],"conv2dDerInput");for(var i=Le(s.inShape,"float32"),o=i.values,l=this.readSync(n.dataId),c=this.readSync(r.dataId),u=r.strides,d=u[0],h=u[1],p=u[2],f=s.batchSize,x=s.filterHeight,v=s.filterWidth,y=s.inChannels,m=s.inHeight,g=s.inWidth,b=s.outChannels,w=s.outHeight,N=s.outWidth,C=s.strideHeight,D=s.strideWidth,j=s.dataFormat,k=x-1-s.padInfo.top,R=v-1-s.padInfo.left,E=j==="channelsLast",P=i.strides[0],F=E?i.strides[1]:i.strides[2],W=E?i.strides[2]:1,L=E?1:i.strides[1],U=n.strides[0],_=E?n.strides[1]:n.strides[2],B=E?n.strides[2]:1,O=E?1:n.strides[1],H=0;H<f;++H)for(var J=0;J<y;++J)for(var te=0;te<m;++te)for(var ce=te-k,se=Math.max(0,Math.ceil(ce/C)),le=Math.min(w,(x+ce)/C),he=0;he<g;++he){for(var ye=he-R,Ce=Math.max(0,Math.ceil(ye/D)),xe=Math.min(N,(v+ye)/D),$e=0,_e=se;_e<le;++_e)for(var Re=_e*C-ce,A=Ce;A<xe;++A)for(var Z=U*H+_*_e+B*A,de=d*(x-1-Re)+h*(v-1-(A*D-ye))+p*J,be=0;be<b;++be)$e+=l[Z+O*be]*c[de+be];o[P*H+F*te+W*he+L*J]=$e}return i.toTensor()},t.prototype.conv3dDerInput=function(n,r,s){for(var i=Le(s.inShape,"float32"),o=i.values,l=i.strides,c=l[0],u=l[1],d=l[2],h=l[3],p=this.readSync(n.dataId),f=n.strides,x=f[0],v=f[1],y=f[2],m=f[3],g=this.readSync(r.dataId),b=r.strides,w=b[0],N=b[1],C=b[2],D=b[3],j=s.batchSize,k=s.filterDepth,R=s.filterHeight,E=s.filterWidth,P=s.inChannels,F=s.inDepth,W=s.inHeight,L=s.inWidth,U=s.outChannels,_=s.outDepth,B=s.outHeight,O=s.outWidth,H=s.strideDepth,J=s.strideHeight,te=s.strideWidth,ce=k-1-s.padInfo.front,se=R-1-s.padInfo.top,le=E-1-s.padInfo.left,he=0;he<j;++he)for(var ye=0;ye<P;++ye)for(var Ce=0;Ce<F;++Ce)for(var xe=Ce-ce,$e=Math.max(0,Math.ceil(xe/H)),_e=Math.min(_,(k+xe)/H),Re=0;Re<W;++Re)for(var A=Re-se,Z=Math.max(0,Math.ceil(A/J)),de=Math.min(B,(R+A)/J),be=0;be<L;++be){for(var ze=be-le,Me=Math.max(0,Math.ceil(ze/te)),Ae=Math.min(O,(E+ze)/te),Ye=0,nt=$e;nt<_e;++nt)for(var ne=nt*H-xe,ie=Z;ie<de;++ie)for(var Te=ie*J-A,Ue=Me;Ue<Ae;++Ue)for(var Rt=x*he+v*nt+y*ie+m*Ue,Wt=w*(k-1-ne)+N*(R-1-Te)+C*(E-1-(Ue*te-ze))+D*ye,At=0;At<U;++At)Ye+=p[Rt+At]*g[Wt+At];o[c*he+u*Ce+d*Re+h*be+ye]=Ye}return i.toTensor()},t.prototype.conv2dDerFilter=function(n,r,s){re([n,r],"conv2dDerFilter");for(var i=s.strideHeight,o=s.strideWidth,l=s.filterHeight,c=s.filterWidth,u=s.dataFormat==="channelsLast",d=Le(s.filterShape,"float32"),h=s.padInfo.left,p=s.padInfo.top,f=this.bufferSync(n),x=this.bufferSync(r),v=0;v<l;++v)for(var y=Math.max(0,Math.ceil((p-v)/i)),m=Math.min(s.outHeight,(s.inHeight+p-v)/i),g=0;g<c;++g)for(var b=Math.max(0,Math.ceil((h-g)/o)),w=Math.min(s.outWidth,(s.inWidth+h-g)/o),N=0;N<s.inChannels;++N)for(var C=0;C<s.outChannels;++C){for(var D=0,j=0;j<s.batchSize;++j)for(var k=y;k<m;++k)for(var R=v+k*i-p,E=b;E<w;++E){var P=g+E*o-h;D+=u?f.get(j,R,P,N)*x.get(j,k,E,C):f.get(j,N,R,P)*x.get(j,C,k,E)}d.set(D,v,g,N,C)}return d.toTensor()},t.prototype.conv3dDerFilter=function(n,r,s){for(var i=s.strideDepth,o=s.strideHeight,l=s.strideWidth,c=s.filterDepth,u=s.filterHeight,d=s.filterWidth,h=Le(s.filterShape,"float32"),p=h.values,f=h.strides,x=f[0],v=f[1],y=f[2],m=f[3],g=this.readSync(r.dataId),b=r.strides,w=b[0],N=b[1],C=b[2],D=b[3],j=this.readSync(n.dataId),k=n.strides,R=k[0],E=k[1],P=k[2],F=k[3],W=s.padInfo.front,L=s.padInfo.left,U=s.padInfo.top,_=0;_<c;++_)for(var B=Math.max(0,Math.ceil((W-_)/i)),O=Math.min(s.outDepth,(s.inDepth+W-_)/i),H=_*x,J=0;J<u;++J)for(var te=Math.max(0,Math.ceil((U-J)/o)),ce=Math.min(s.outHeight,(s.inHeight+U-J)/o),se=J*v+H,le=0;le<d;++le)for(var he=Math.max(0,Math.ceil((L-le)/l)),ye=Math.min(s.outWidth,(s.inWidth+L-le)/l),Ce=le*y+se,xe=0;xe<s.inChannels;++xe)for(var $e=xe*m+Ce,_e=0;_e<s.outChannels;++_e){for(var Re=0,A=0;A<s.batchSize;++A)for(var Z=A*R,de=A*w,be=B;be<O;++be)for(var ze=(_+be*i-W)*E+Z,Me=be*N+de,Ae=te;Ae<ce;++Ae)for(var Ye=(J+Ae*o-U)*P+ze,nt=Ae*C+Me,ne=he;ne<ye;++ne){var ie=ne*D+nt;Re+=j[(le+ne*l-L)*F+Ye+xe]*g[ie+_e]}p[$e+_e]=Re}return h.toTensor()},t.prototype.fusedDepthwiseConv2D=function(n){var r=n.input,s=n.filter,i=n.convInfo,o=n.bias,l=n.activation,c=n.preluActivationWeights,u=this.depthwiseConv2D(r,s,i);return o&&(u=this.add(u,o)),l&&(u=_h(this,u,l,c)),u},t.prototype.depthwiseConv2D=function(n,r,s){re([n,r],"depthwiseConv2D");for(var i=s.filterHeight,o=s.filterWidth,l=s.dilationHeight,c=s.dilationWidth,u=s.padInfo.left,d=s.padInfo.top,h=s.outChannels/s.inChannels,p=Le(s.outShape,n.dtype),f=this.readSync(n.dataId),x=this.readSync(r.dataId),v=p.values,y=0;y<s.batchSize;++y)for(var m=y*n.strides[0],g=y*p.strides[0],b=0;b<s.outHeight;++b)for(var w=g+b*p.strides[1],N=b*s.strideHeight-u,C=0;C<i;++C){var D=N+C*l;if(!(D<0||D>=s.inHeight))for(var j=C*r.strides[0],k=m+D*n.strides[1],R=0;R<s.outWidth;++R)for(var E=w+R*p.strides[2],P=R*s.strideWidth-d,F=0;F<o;++F){var W=P+F*c;if(!(W<0||W>=s.inWidth))for(var L=j+F*r.strides[1],U=k+W*s.inChannels,_=E,B=L,O=0;O<s.inChannels;++O){for(var H=f[U+O],J=0;J<h;++J)v[_+J]+=H*x[B+J];_+=h,B+=h}}}return p.toTensor()},t.prototype.depthwiseConv2DDerInput=function(n,r,s){re([n,r],"depthwiseConv2DDerInput");for(var i=Le(s.inShape,"float32"),o=i.values,l=i.strides,c=l[0],u=l[1],d=l[2],h=this.readSync(n.dataId),p=n.strides,f=p[0],x=p[1],v=p[2],y=this.readSync(r.dataId),m=r.strides,g=m[0],b=m[1],w=m[2],N=s.batchSize,C=s.filterHeight,D=s.filterWidth,j=s.inChannels,k=s.inHeight,R=s.inWidth,E=s.outChannels,P=s.outHeight,F=s.outWidth,W=s.strideHeight,L=s.strideWidth,U=C-1-s.padInfo.top,_=D-1-s.padInfo.left,B=E/j,O=0;O<N;++O)for(var H=0;H<j;++H)for(var J=0;J<k;++J)for(var te=J-U,ce=Math.max(0,Math.ceil(te/W)),se=Math.min(P,(C+te)/W),le=0;le<R;++le){for(var he=le-_,ye=Math.max(0,Math.ceil(he/L)),Ce=Math.min(F,(D+he)/L),xe=0,$e=ce;$e<se;++$e)for(var _e=$e*W-te,Re=ye;Re<Ce;++Re)for(var A=f*O+x*$e+v*Re,Z=g*(C-1-_e)+b*(D-1-(Re*L-he))+w*H,de=0;de<B;++de)xe+=h[A+(H*B+de)]*y[Z+de];o[c*O+u*J+d*le+H]=xe}return i.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(n,r,s){re([n,r],"depthwiseConv2DDerFilter");for(var i=s.strideHeight,o=s.strideWidth,l=s.filterHeight,c=s.filterWidth,u=Le(s.filterShape,"float32"),d=s.padInfo.left,h=s.padInfo.top,p=s.outChannels/s.inChannels,f=this.bufferSync(n),x=this.bufferSync(r),v=0;v<l;++v)for(var y=Math.max(0,Math.ceil((h-v)/i)),m=Math.min(s.outHeight,(s.inHeight+h-v)/i),g=0;g<c;++g)for(var b=Math.max(0,Math.ceil((d-g)/o)),w=Math.min(s.outWidth,(s.inWidth+d-g)/o),N=0;N<s.outChannels;++N){for(var C=Math.trunc(N/p),D=N%p,j=0,k=0;k<s.batchSize;++k)for(var R=y;R<m;++R)for(var E=v+R*i-h,P=b;P<w;++P){var F=g+P*o-d;j+=f.get(k,E,F,C)*x.get(k,R,P,N)}u.set(j,v,g,C,D)}return u.toTensor()},t.prototype.tile=function(n,r){return re(n,"tile"),LN(this.bufferSync(n),r)},t.prototype.pad=function(n,r,s){re(n,"pad");var i=r.map(function(p,f){return p[0]+n.shape[f]+p[1]}),o=r.map(function(p){return p[0]}),l=this.bufferSync(n),c=Le(i,n.dtype);s!==0&&c.values.fill(s);for(var u=0;u<n.size;u++){var d=l.indexToLoc(u),h=d.map(function(p,f){return p+o[f]});c.set.apply(c,[l.get.apply(l,d)].concat(h))}return c.toTensor()},t.prototype.transpose=function(n,r){re(n,"transpose");for(var s=new Array(n.rank),i=0;i<s.length;i++)s[i]=n.shape[r[i]];var o=this.readSync(n.dataId),l=Le(s,n.dtype),c=this.bufferSync(n);for(i=0;i<n.size;++i){for(var u=c.indexToLoc(i),d=new Array(u.length),h=0;h<d.length;h++)d[h]=u[r[h]];var p=l.locToIndex(d);l.values[p]=o[i]}return l.toTensor()},t.prototype.gather=function(n,r,s){re([n,r],"gather");var i=n.shape.slice(),o=this.readSync(r.dataId);i[s]=o.length;for(var l=Le(i,n.dtype),c=this.bufferSync(n),u=0;u<l.size;++u){var d=l.indexToLoc(u),h=d.slice();h[s]=o[d[s]];var p=c.locToIndex(h);l.values[u]=c.values[p]}return l.toTensor()},t.prototype.batchToSpaceND=function(n,r,s){re([n],"batchToSpaceND");var i=r.reduce(function(h,p){return h*p}),o=Eu(n.shape,r,i),l=Du(o.length,r.length),c=Ru(n.shape,r,i),u=CN(s,r.length),d=kN(c,s,r.length);return n.reshape(o).transpose(l).reshape(c).slice(u,d)},t.prototype.spaceToBatchND=function(n,r,s){re([n],"spaceToBatchND");var i=r.reduce(function(p,f){return p*f}),o=[[0,0]];o.push.apply(o,s);for(var l=1+r.length;l<n.shape.length;++l)o.push([0,0]);var c=n.pad(o),u=Eu(c.shape,r,i,!1),d=Du(u.length,r.length,!1),h=Ru(c.shape,r,i,!1);return c.reshape(u).transpose(d).reshape(h)},t.prototype.pool=function(n,r,s){re(n,"pool");for(var i=r.strideHeight,o=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,u=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,p=r.padInfo.left,f=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=this.readSync(n.dataId),v=Le(r.outShape,n.dtype),y=v.values,m=r.outShape[1]*r.outShape[2]*r.outShape[3],g=r.outShape[2]*r.outShape[3],b=r.outShape[3],w=0;w<r.batchSize;++w)for(var N=w*m,C=w*n.strides[0],D=0;D<r.inChannels;++D)for(var j=0;j<r.outHeight;++j)for(var k=j*i-h,R=Math.max(0,k),E=Math.min(r.inHeight,u+k),P=N+j*g,F=0;F<r.outWidth;++F){for(var W=F*o-p,L=Math.max(0,W),U=Math.min(r.inWidth,d+W),_=f,B=0,O=0,H=R;H<E;H+=l){for(var J=C+H*n.strides[1],te=L;te<U;te+=c){var ce=x[J+te*n.strides[2]+D];s==="max"&&ce>_?_=ce:s==="avg"&&(B+=ce,O++)}if(isNaN(_))break}y[P+F*b+D]=s==="avg"?B/O:_}return v.toTensor()},t.prototype.maxPool=function(n,r){return this.pool(n,r,"max")},t.prototype.maxPoolPositions=function(n,r){for(var s=Le(r.outShape,"int32"),i=r.strideHeight,o=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,u=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,p=r.padInfo.left,f=this.bufferSync(n),x=0;x<r.batchSize;++x)for(var v=0;v<r.inChannels;++v)for(var y=0;y<r.outHeight;++y){for(var m=y*i-h,g=m;g<0;)g+=l;for(var b=Math.min(r.inHeight,u+m),w=0;w<r.outWidth;++w){for(var N=w*o-p,C=N;C<0;)C+=c;for(var D=Math.min(r.inWidth,d+N),j=Number.NEGATIVE_INFINITY,k=-1,R=g;R<b;R+=l)for(var E=R-m,P=C;P<D;P+=c){var F=P-N,W=f.get(x,R,P,v);W>j&&(j=W,k=E*d+F)}s.set(k,x,y,w,v)}}return s.toTensor()},t.prototype.maxPoolBackprop=function(n,r,s,i){re([r,s],"maxPoolBackprop");for(var o=this.maxPoolPositions(r,i),l=i.strideHeight,c=i.strideWidth,u=i.dilationHeight,d=i.dilationWidth,h=i.effectiveFilterHeight,p=i.effectiveFilterWidth,f=p-1-i.padInfo.left,x=h-1-i.padInfo.top,v=Le(r.shape,"float32"),y=this.bufferSync(o),m=this.bufferSync(n),g=0;g<i.batchSize;++g)for(var b=0;b<i.inChannels;++b)for(var w=0;w<i.inHeight;++w)for(var N=0;N<i.inWidth;++N){for(var C=w-x,D=N-f,j=0,k=0;k<h;k+=u){var R=(C+k)/l;if(!(R<0||R>=i.outHeight||Math.floor(R)!==R))for(var E=0;E<p;E+=d){var P=(D+E)/c;if(!(P<0||P>=i.outWidth||Math.floor(P)!==P)){var F=h*p-1-y.get(g,R,P,b)===k*p+E?1:0;F!==0&&(j+=m.get(g,R,P,b)*F)}}}v.set(j,g,w,N,b)}return v.toTensor()},t.prototype.avgPoolBackprop=function(n,r,s){re([n,r],"avgPoolBackprop");for(var i=s.strideHeight,o=s.strideWidth,l=s.filterHeight,c=s.filterWidth,u=s.dilationHeight,d=s.dilationWidth,h=s.effectiveFilterHeight,p=s.effectiveFilterWidth,f=p-1-s.padInfo.left,x=h-1-s.padInfo.top,v=Le(r.shape,"float32"),y=1/(l*c),m=this.bufferSync(n),g=0;g<s.batchSize;++g)for(var b=0;b<s.inChannels;++b)for(var w=0;w<s.inHeight;++w)for(var N=0;N<s.inWidth;++N){for(var C=w-x,D=N-f,j=0,k=0;k<h;k+=u){var R=(C+k)/i;if(!(R<0||R>=s.outHeight||Math.floor(R)!==R))for(var E=0;E<p;E+=d){var P=(D+E)/o;P<0||P>=s.outWidth||Math.floor(P)!==P||(j+=m.get(g,R,P,b))}}v.set(j*y,g,w,N,b)}return v.toTensor()},t.prototype.pool3d=function(n,r,s){re(n,"pool3d");for(var i=r.strideDepth,o=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,u=r.dilationHeight,d=r.dilationWidth,h=r.effectiveFilterDepth,p=r.effectiveFilterHeight,f=r.effectiveFilterWidth,x=r.padInfo.front,v=r.padInfo.top,y=r.padInfo.left,m=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=this.readSync(n.dataId),b=Le(r.outShape,n.dtype),w=b.values,N=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],C=r.outShape[2]*r.outShape[3]*r.outShape[4],D=r.outShape[3]*r.outShape[4],j=r.outShape[4],k=0;k<r.batchSize;++k)for(var R=k*N,E=k*n.strides[0],P=0;P<r.inChannels;++P)for(var F=0;F<r.outDepth;++F){for(var W=F*i-x,L=W;L<0;)L+=c;for(var U=Math.min(r.inDepth,h+W),_=R+F*C,B=0;B<r.outHeight;++B){for(var O=B*o-v,H=O;H<0;)H+=u;for(var J=Math.min(r.inHeight,p+O),te=_+B*D,ce=0;ce<r.outWidth;++ce){for(var se=ce*l-y,le=se;le<0;)le+=d;for(var he=Math.min(r.inWidth,f+se),ye=te+ce*j,Ce=m,xe=0,$e=0,_e=L;_e<U;_e+=c){for(var Re=E+_e*n.strides[1],A=H;A<J;A+=u){for(var Z=Re+A*n.strides[2],de=le;de<he;de+=d){var be=g[Z+de*n.strides[3]+P];if(s==="max"&&be>Ce?Ce=be:s==="avg"&&(xe+=be,$e++),isNaN(Ce))break}if(isNaN(Ce))break}if(isNaN(Ce))break}w[ye+P]=s==="avg"?xe/$e:Ce}}}return b.toTensor()},t.prototype.avgPool3d=function(n,r){return re(n,"avgPool3d"),this.pool3d(n,r,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(n,r,s){re([n,r],"avgPool3dBackprop");for(var i=s.strideDepth,o=s.strideHeight,l=s.strideWidth,c=s.filterDepth,u=s.filterHeight,d=s.filterWidth,h=s.dilationDepth,p=s.dilationHeight,f=s.dilationWidth,x=s.effectiveFilterDepth,v=s.effectiveFilterHeight,y=s.effectiveFilterWidth,m=x-1-s.padInfo.front,g=y-1-s.padInfo.left,b=v-1-s.padInfo.top,w=Le(r.shape,"float32"),N=1/(c*u*d),C=this.bufferSync(n),D=0;D<s.batchSize;++D)for(var j=0;j<s.inChannels;++j)for(var k=0;k<s.inDepth;++k)for(var R=0;R<s.inHeight;++R)for(var E=0;E<s.inWidth;++E){for(var P=k-m,F=R-b,W=E-g,L=0,U=0;U<x;U+=h){var _=(P+U)/i;if(!(_<0||_>=s.outDepth||Math.floor(_)!==_))for(var B=0;B<v;B+=p){var O=(F+B)/o;if(!(O<0||O>=s.outHeight||Math.floor(O)!==O))for(var H=0;H<y;H+=f){var J=(W+H)/l;J<0||J>=s.outWidth||Math.floor(J)!==J||(L+=C.get(D,_,O,J,j))}}}w.set(L*N,D,k,R,E,j)}return w.toTensor()},t.prototype.maxPool3d=function(n,r){return re(n,"maxPool3d"),this.pool3d(n,r,"max").toFloat()},t.prototype.maxPool3dPositions=function(n,r){for(var s=Le(r.outShape,"int32"),i=r.strideDepth,o=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,u=r.dilationHeight,d=r.dilationWidth,h=r.effectiveFilterDepth,p=r.effectiveFilterHeight,f=r.effectiveFilterWidth,x=r.padInfo.front,v=r.padInfo.top,y=r.padInfo.left,m=this.bufferSync(n),g=0;g<r.batchSize;++g)for(var b=0;b<r.inChannels;++b)for(var w=0;w<r.outDepth;++w){for(var N=w*i-x,C=N;C<0;)C+=c;for(var D=Math.min(r.inDepth,h+N),j=0;j<r.outHeight;++j){for(var k=j*o-v,R=k;R<0;)R+=u;for(var E=Math.min(r.inHeight,p+k),P=0;P<r.outWidth;++P){for(var F=P*l-y,W=F;W<0;)W+=d;for(var L=Math.min(r.inWidth,f+F),U=Number.NEGATIVE_INFINITY,_=-1,B=C;B<D;B+=c)for(var O=B-N,H=R;H<E;H+=u)for(var J=H-k,te=W;te<L;te+=d){var ce=te-F,se=m.get(g,B,H,te,b);se>=U&&(U=se,_=O*p*f+J*p+ce)}s.set(_,g,w,j,P,b)}}}return s.toTensor()},t.prototype.maxPool3dBackprop=function(n,r,s,i){re([r,s],"maxPool3dBackprop");for(var o=this.maxPool3dPositions(r,i),l=i.strideDepth,c=i.strideHeight,u=i.strideWidth,d=i.dilationDepth,h=i.dilationHeight,p=i.dilationWidth,f=i.effectiveFilterDepth,x=i.effectiveFilterHeight,v=i.effectiveFilterWidth,y=f-1-i.padInfo.front,m=v-1-i.padInfo.left,g=x-1-i.padInfo.top,b=Le(r.shape,"float32"),w=this.bufferSync(o),N=this.bufferSync(n),C=0;C<i.batchSize;++C)for(var D=0;D<i.inChannels;++D)for(var j=0;j<i.inDepth;++j)for(var k=0;k<i.inHeight;++k)for(var R=0;R<i.inWidth;++R){for(var E=j-y,P=k-g,F=R-m,W=0,L=0;L<f;L+=d){var U=(E+L)/l;if(!(U<0||U>=i.outDepth||Math.floor(U)!==U))for(var _=0;_<x;_+=h){var B=(P+_)/c;if(!(B<0||B>=i.outHeight||Math.floor(B)!==B))for(var O=0;O<v;O+=p){var H=(F+O)/u;if(!(H<0||H>=i.outWidth||Math.floor(H)!==H)){var J=f*x*v-1-w.get(C,U,B,H,D)===L*x*v+_*v+O?1:0;J!==0&&(W+=N.get(C,U,B,H,D)*J)}}}}b.set(W,C,j,k,R,D)}return b.toTensor()},t.prototype.cast=function(n,r){return IN(n,r,this)},t.prototype.reshape=function(n,r){return sf(n,r)},t.prototype.avgPool=function(n,r){return re(n,"avgPool"),this.pool(n,r,"avg").toFloat()},t.prototype.resizeBilinear=function(n,r,s,i){re(n,"resizeBilinear");for(var o=n.shape,l=o[0],c=o[1],u=o[2],d=o[3],h=this.readSync(n.dataId),p=new Float32Array(je([l,r,s,d])),f=[i&&r>1?c-1:c,i&&s>1?u-1:u],x=[i&&r>1?r-1:r,i&&s>1?s-1:s],v=0,y=f[0]/x[0],m=f[1]/x[1],g=0;g<l;g++)for(var b=0;b<r;b++)for(var w=y*b,N=Math.floor(w),C=w-N,D=Math.min(c-1,Math.ceil(w)),j=g*n.strides[0]+N*n.strides[1],k=g*n.strides[0]+D*n.strides[1],R=0;R<s;R++)for(var E=m*R,P=Math.floor(E),F=E-P,W=Math.min(u-1,Math.ceil(E)),L=j+P*n.strides[2],U=k+P*n.strides[2],_=j+W*n.strides[2],B=k+W*n.strides[2],O=0;O<d;O++){var H=h[L+O],J=h[U+O],te=H+(h[_+O]-H)*F,ce=te+(J+(h[B+O]-J)*F-te)*C;p[v++]=ce}return en(p,[l,r,s,d])},t.prototype.resizeBilinearBackprop=function(n,r,s){re([n,r],"resizeBilinearBackprop");for(var i=r.shape,o=i[0],l=i[1],c=i[2],u=i[3],d=n.shape,h=d[1],p=d[2],f=new Float32Array(o*l*c*u),x=[s&&h>1?l-1:l,s&&p>1?c-1:c],v=[s&&h>1?h-1:h,s&&p>1?p-1:p],y=x[0]/v[0],m=x[1]/v[1],g=this.readSync(n.dataId),b=0,w=0;w<o;w++)for(var N=w*r.strides[0],C=0;C<h;C++)for(var D=C*y,j=Math.floor(D),k=Math.min(Math.ceil(D),l-1),R=N+j*r.strides[1],E=N+k*r.strides[1],P=D-j,F=1-P,W=0;W<p;W++)for(var L=W*m,U=Math.floor(L),_=Math.min(Math.ceil(L),c-1),B=L-U,O=1-B,H=R+U*r.strides[2],J=R+_*r.strides[2],te=E+U*r.strides[2],ce=E+_*r.strides[2],se=F*O,le=F*B,he=P*O,ye=P*B,Ce=0;Ce<u;Ce++){var xe=g[b++];f[H+Ce]+=xe*se,f[J+Ce]+=xe*le,f[te+Ce]+=xe*he,f[ce+Ce]+=xe*ye}return jn(f,[o,c,l,u],r.dtype)},t.prototype.resizeNearestNeighbor=function(n,r,s,i){re(n,"resizeNearestNeighbor");for(var o=n.shape,l=o[0],c=o[1],u=o[2],d=o[3],h=this.readSync(n.dataId),p=new Float32Array(l*r*s*d),f=[i&&r>1?c-1:c,i&&s>1?u-1:u],x=[i&&r>1?r-1:r,i&&s>1?s-1:s],v=f[0]/x[0],y=f[1]/x[1],m=0,g=0;g<l;g++)for(var b=g*n.strides[0],w=0;w<r;w++)for(var N=v*w,C=b+Math.min(c-1,i?Math.round(N):Math.floor(N))*n.strides[1],D=0;D<s;D++)for(var j=y*D,k=C+Math.min(u-1,i?Math.round(j):Math.floor(j))*n.strides[2],R=0;R<d;R++){var E=h[k+R];p[m++]=E}return en(p,[l,r,s,d],n.dtype)},t.prototype.resizeNearestNeighborBackprop=function(n,r,s){re([n,r],"resizeNearestNeighborBackprop");for(var i=r.shape,o=i[0],l=i[1],c=i[2],u=i[3],d=n.shape,h=d[1],p=d[2],f=new Float32Array(o*l*c*u),x=this.readSync(n.dataId),v=[s&&h>1?l-1:l,s&&p>1?c-1:c],y=[s&&h>1?h-1:h,s&&p>1?p-1:p],m=v[0]/y[0],g=v[1]/y[1],b=1/m,w=1/g,N=2*Math.ceil(b)+2,C=2*Math.ceil(w)+2,D=0;D<o;D++)for(var j=D*r.strides[0],k=0;k<l;k++)for(var R=j+k*r.strides[1],E=Math.floor(k*b),P=Math.floor(E-N/2),F=0;F<c;F++)for(var W=R+F*r.strides[2],L=Math.floor(F*w),U=Math.floor(L-C/2),_=0;_<u;_++){for(var B=0,O=0;O<N;O++){var H=O+P;if(!(H<0||H>=h)){var J=j+H*n.strides[1],te=H*m;if(k===Math.min(l-1,s?Math.round(te):Math.floor(te)))for(var ce=0;ce<C;ce++){var se=ce+U;if(!(se<0||se>=p)){var le=J+se*n.strides[2],he=se*g;F===Math.min(c-1,s?Math.round(he):Math.floor(he))&&(B+=x[le+_])}}}}f[W+_]=B}return jn(f,r.shape,r.dtype)},t.prototype.batchNormalization=function(n,r,s,i,o,l){re([n,r,s,o,l],"batchNorm");for(var c=this.readSync(n.dataId),u=this.readSync(r.dataId),d=this.readSync(s.dataId),h=o?this.readSync(o.dataId):new Float32Array([1]),p=l?this.readSync(l.dataId):new Float32Array([0]),f=new Float32Array(c.length),x=p.length,v=h.length,y=d.length,m=u.length,g=0,b=0,w=0,N=0,C=0;C<c.length;++C)f[C]=p[g++]+(c[C]-u[b++])*h[w++]/Math.sqrt(d[N++]+i),g>=x&&(g=0),b>=m&&(b=0),w>=v&&(w=0),N>=y&&(N=0);return jn(f,n.shape)},t.prototype.localResponseNormalization4D=function(n,r,s,i,o){re(n,"localResponseNormalization4D");var l=n.shape[3],c=l-1,u=this.readSync(n.dataId),d=n.size,h=new Float32Array(d);function p(y){for(var m=y%l,g=y-m+Math.max(0,m-r),b=y-m+Math.min(m+r,c),w=0;g<=b;g++){var N=u[g];w+=N*N}return w}for(var f=0;f<d;f++){var x=p(f),v=u[f]*Math.pow(s+i*x,-o);h[f]=v}return jn(h,n.shape)},t.prototype.LRNGrad=function(n,r,s,i,o,l,c){re(n,"LRNGrad");for(var u=n.shape[3],d=this.readSync(n.dataId),h=this.readSync(r.dataId),p=this.readSync(s.dataId),f=new Float32Array(n.size),x=n.size,v=0;v<x;v++){for(var y=v%u,m=v-y+Math.max(0,y-i),g=v-y+Math.min(u,y+i+1),b=0,w=m;w<g;w++)b+=Math.pow(h[w],2);for(b=l*b+o,w=m;w<g;w++){var N=-2*l*c*h[w]*p[v]/b;v===w&&(N+=Math.pow(b,-c)),N*=d[v],f[w]+=N}}return jn(f,n.shape)},t.prototype.multinomial=function(n,r,s,i){re(n,"multinomial");for(var o=r?n:ja(n),l=o.shape[0],c=o.shape[1],u=ct([l,s],"int32"),d=this.readSync(u.dataId),h=this.readSync(o.dataId),p=0;p<l;++p){var f=p*c,x=new Float32Array(c-1);x[0]=h[f];for(var v=1;v<x.length;++v)x[v]=x[v-1]+h[f+v];for(var y=gd(i.toString()),m=p*s,g=0;g<s;++g){var b=y();d[m+g]=x.length;for(var w=0;w<x.length;w++)if(b<x[w]){d[m+g]=w;break}}}return u},t.prototype.oneHot=function(n,r,s,i){re(n,"oneHot");var o=new Float32Array(n.size*r);o.fill(i);for(var l=this.readSync(n.dataId),c=0;c<n.size;++c)l[c]>=0&&l[c]<r&&(o[c*r+l[c]]=s);return Za(o,[n.size,r],"int32")},t.prototype.nonMaxSuppression=function(n,r,s,i,o){return re(n,"nonMaxSuppression"),Bm(this.readSync(n.dataId),this.readSync(r.dataId),s,i,o)},t.prototype.fft=function(n){return this.fftBatch(n,!1)},t.prototype.ifft=function(n){return this.fftBatch(n,!0)},t.prototype.fftBatch=function(n,r){for(var s=n.shape[0],i=n.shape[1],o=Le(n.shape,"float32"),l=Le(n.shape,"float32"),c=Zn(n).as2D(s,i),u=Mr(n).as2D(s,i),d=0;d<s;d++)for(var h=c.slice([d,0],[1,i]),p=u.slice([d,0],[1,i]),f=Jt(h,p),x=this.readSync(this.fftImpl(f,r).dataId),v=0;v<i;v++){var y=Wy(x,v);o.values[d*i+v]=y.real,l.values[d*i+v]=y.imag}return Jt(o.toTensor(),l.toTensor()).as2D(s,i)},t.prototype.fftImpl=function(n,r){var s=n.as1D(),i=s.size;if(this.isExponentOf2(i)){var o=this.fftRadix2(s,i,r).as2D(n.shape[0],n.shape[1]);return r&&(o=Jt(Zn(o).div(fe(i)),Mr(o).div(fe(i)))),o}var l=this.readSync(n.dataId),c=function(u){for(var d=new Float32Array(u.length/2),h=new Float32Array(u.length/2),p=0;p<u.length;p+=2)d[p/2]=u[p],h[p/2]=u[p+1];return{real:d,imag:h}}(this.fourierTransformByMatmul(l,i,r));return Jt(c.real,c.imag).as2D(n.shape[0],n.shape[1])},t.prototype.isExponentOf2=function(n){return(n&n-1)==0},t.prototype.fftRadix2=function(n,r,s){if(r===1)return n;var i=this.readSync(n.dataId),o=r/2,l=function(m){for(var g=Math.ceil(m.length/4),b=new Float32Array(g),w=new Float32Array(g),N=0;N<m.length;N+=4)b[Math.floor(N/4)]=m[N],w[Math.floor(N/4)]=m[N+1];return{real:b,imag:w}}(i),c=Jt(l.real,l.imag).as1D(),u=function(m){for(var g=Math.floor(m.length/4),b=new Float32Array(g),w=new Float32Array(g),N=2;N<m.length;N+=4)b[Math.floor(N/4)]=m[N],w[Math.floor(N/4)]=m[N+1];return{real:b,imag:w}}(i),d=Jt(u.real,u.imag).as1D();c=this.fftRadix2(c,o,s),d=this.fftRadix2(d,o,s);var h=function(m,g){for(var b=new Float32Array(m/2),w=new Float32Array(m/2),N=0;N<Math.ceil(m/2);N++){var C=(g?2:-2)*Math.PI*(N/m);b[N]=Math.cos(C),w[N]=Math.sin(C)}return{real:b,imag:w}}(r,s),p=Jt(h.real,h.imag).mul(d),f=c.add(p),x=c.sub(p),v=Zn(f).concat(Zn(x)),y=Mr(f).concat(Mr(x));return Jt(v,y).as1D()},t.prototype.fourierTransformByMatmul=function(n,r,s){for(var i=new Float32Array(2*r),o=0;o<r;o++){for(var l=0,c=0,u=0;u<r;u++){var d=G_(o*u,r,s),h=Wy(n,u);l+=h.real*d.real-h.imag*d.imag,c+=h.real*d.imag+h.imag*d.real}s&&(l/=r,c/=r),q_(i,l,c,o)}return i},t.prototype.depthToSpace=function(n,r,s){M(s==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+s}),M(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var i=n.shape[0],o=n.shape[1],l=n.shape[2],c=n.shape[3],u=o*r,d=l*r,h=c/(r*r),p=this.readSync(n.dataId),f=new Float32Array(i*u*d*h),x=0,v=0;v<i;++v)for(var y=0;y<u;++y)for(var m=Math.floor(y/r),g=y%r,b=0;b<d;++b)for(var w=Math.floor(b/r),N=(g*r+b%r)*h,C=0;C<h;++C){var D=C+N+c*(w+l*(m+o*v));f[x++]=p[D]}return jn(f,[i,u,d,h])},t.prototype.broadcastedBinaryOp=function(n,r,s,i){var o=He(n.shape,r.shape),l=Le(o,s),c=this.readSync(n.dataId),u=this.readSync(r.dataId),d=za(n.shape,o),h=za(r.shape,o),p=l.values;if(d.length+h.length===0)for(var f=0;f<p.length;++f)p[f]=i(c[f%c.length],u[f%u.length]);else{var x=this.bufferSync(n),v=this.bufferSync(r),y=function(m){var g=l.indexToLoc(m),b=g.slice(-n.rank);d.forEach(function(D){return b[D]=0});var w=x.locToIndex(b),N=g.slice(-r.rank);h.forEach(function(D){return N[D]=0});var C=v.locToIndex(N);p[m]=i(c[w],u[C])};for(f=0;f<p.length;++f)y(f)}return l.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(n,r,s){var i=He(n.shape,r.shape),o=Le(i,"float32"),l=Le(i,"float32"),c=this.readSync(n.dataId),u=this.readSync(r.dataId),d=za(n.shape,i),h=za(r.shape,i),p=o.values,f=l.values;if(d.length+h.length===0)for(var x=0;x<p.length;x++){var v=x%c.length,y=x%u.length,m=s(c[2*v],c[2*v+1],u[2*y],u[2*y+1]);p[x]=m.real,f[x]=m.imag}else{var g=this.bufferSync(this.data.get(n.dataId).complexTensors.real),b=this.bufferSync(this.data.get(r.dataId).complexTensors.real),w=function(N){var C=o.indexToLoc(N),D=C.slice(-n.rank);d.forEach(function(P){return D[P]=0});var j=g.locToIndex(D),k=C.slice(-r.rank);h.forEach(function(P){return k[P]=0});var R=b.locToIndex(k),E=s(c[2*j],c[2*j+1],u[2*R],u[2*R+1]);p[N]=E.real,f[N]=E.imag};for(x=0;x<p.length;x++)w(x)}return this.complex(o.toTensor(),l.toTensor())},t.prototype.split=function(n,r,s){return MN(n,r,s)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(n,r,s,i,o,l){for(var c=n.shape,u=c[0],d=c[1],h=c[2],p=c[3],f=r.shape[0],x=i[0],v=i[1],y=Le([f,x,v,p],"float32"),m=this.readSync(r.dataId),g=this.readSync(s.dataId),b=this.readSync(n.dataId),w=n.strides,N=y.strides,C=0;C<f;C++){var D=4*C,j=m[D],k=m[D+1],R=m[D+2],E=m[D+3],P=g[C];if(!(P>=u))for(var F=x>1?(R-j)*(d-1)/(x-1):0,W=v>1?(E-k)*(h-1)/(v-1):0,L=0;L<x;L++){var U=x>1?j*(d-1)+L*F:.5*(j+R)*(d-1);if(U<0||U>d-1)for(var _=0;_<v;_++)for(var B=0;B<p;B++){var O=B+_*N[2]+L*N[1]+C*N[0];y.values[O]=l}else if(o==="bilinear"){var H=Math.floor(U),J=Math.ceil(U),te=U-H;for(_=0;_<v;_++)if((_e=v>1?k*(h-1)+_*W:.5*(k+E)*(h-1))<0||_e>h-1)for(B=0;B<p;B++)O=B+_*N[2]+L*N[1]+C*N[0],y.values[O]=l;else{var ce=Math.floor(_e),se=Math.ceil(_e),le=_e-ce;for(B=0;B<p;B++){var he=b[O=B+ce*w[2]+H*w[1]+P*w[0]],ye=b[O=B+se*w[2]+H*w[1]+P*w[0]],Ce=b[O=B+ce*w[2]+J*w[1]+P*w[0]],xe=he+(ye-he)*le,$e=Ce+(b[O=B+se*w[2]+J*w[1]+P*w[0]]-Ce)*le;O=B+_*N[2]+L*N[1]+C*N[0],y.values[O]=xe+($e-xe)*te}}}else for(_=0;_<v;++_){var _e;if((_e=v>1?k*(h-1)+_*W:.5*(k+E)*(h-1))<0||_e>h-1)for(B=0;B<p;B++)O=B+_*N[2]+L*N[1]+C*N[0],y.values[O]=l;else{var Re=Math.round(_e),A=Math.round(U);for(B=0;B<p;B++){var Z=B+Re*w[2]+A*w[1]+P*w[0],de=B+_*N[2]+L*N[1]+C*N[0];y.values[de]=b[Z]}}}}}return y.toTensor()},t.prototype.sparseToDense=function(n,r,s,i){var o=_u(0,n,s),l=o.sliceRank,c=o.numUpdates,u=o.sliceSize,d=o.strides,h=o.outputSize;return this.scatter(n,r,s,h,u,c,l,d,i,!1)},t.prototype.gatherND=function(n,r){var s=r.shape,i=s[s.length-1],o=SN(n,r),l=o[0],c=o[1],u=o[2],d=o[3];if(c===0)return en([],l,n.dtype);for(var h=new dl([c,u],n.dtype),p=this.readSync(r.dataId),f=this.readSync(n.dataId),x=0;x<c;x++){for(var v=[],y=0,m=0;m<i;m++){var g=p[x*i+m];y+=g*d[m],v.push(g)}if(y<0||y>=n.size/u)throw new Error("Invalid indices: "+v+" does not index into "+n.shape);for(var b=0;b<u;b++)h.values[x*u+b]=f[y*u+b]}return h.toTensor().reshape(l)},t.prototype.scatterND=function(n,r,s){var i=_u(0,n,s),o=i.sliceRank,l=i.numUpdates,c=i.sliceSize,u=i.strides,d=i.outputSize,h=fe(0);return this.scatter(n,r,s,d,c,l,o,u,h,!0)},t.prototype.fill=function(n,r,s){var i=bu(s=s||Dl(r),je(n));return i.fill(r),V.makeTensor(i,n,s,this)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){var r=bu(n.dtype,je(n.shape));return this.makeOutput(r,n.shape,n.dtype)},t.prototype.linspace=function(n,r,s){return PN(n,r,s)},t.prototype.scatter=function(n,r,s,i,o,l,c,u,d,h){var p=[i/o,o],f=this.readSync(n.dataId),x=this.readSync(r.dataId);if(i===0)return en([],s,r.dtype);var v=new dl(p,r.dtype);v.values.fill(this.readSync(d.dataId)[0]);for(var y=0;y<l;y++){for(var m=[],g=0,b=0;b<c;b++){var w=f[y*c+b];m.push(w),g+=w*u[b]}if(g<0||g>=i/o)throw new Error("Invalid indices: "+m+" does not index into "+s);for(var N=0;N<o;N++)h?v.values[g*o+N]+=x[y*o+N]:v.values[g*o+N]=r.rank===0?x[0]:x[y*o+N]}return v.toTensor().reshape(s)},t}(TN);V.registerBackend("cpu",function(){return new pP},1);for(var Th=0,db=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,s=t,i=s.boxes,o=s.scores,l=r,c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,h=l.softNmsSigma,p=n;re(i,"NonMaxSuppressionWithScore");var f=$m(p.data.get(i.dataId).values,p.data.get(o.dataId).values,c,u,d,h);return[f.selectedIndices,f.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,s=n;re(r,"square");for(var i=s.data.get(r.dataId).values,o=new Float32Array(i.length),l=0;l<i.length;++l){var c=i[l];o[l]=c*c}return{dataId:s.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:fl,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,s=r.a,i=r.b,o=n;re([s,i],fl);var l=o.data.get(s.dataId).values,c=o.data.get(i.dataId).values,u=function(p,f,x,v,y,m){var g=He(p,f),b=g.length,w=Wr(g),N=ul(y,je(g)),C=p.length,D=f.length,j=Wr(p),k=Wr(f),R=za(p,g),E=za(f,g);if(R.length+E.length===0)for(var P=0;P<N.length;++P)N[P]=m(x[P%x.length],v[P%v.length]);else{var F=function(W){var L=jR(W,b,w),U=L.slice(-C);R.forEach(function(H){return U[H]=0});var _=Py(U,C,j),B=L.slice(-D);E.forEach(function(H){return B[H]=0});var O=Py(B,D,k);N[W]=m(x[_],v[O])};for(P=0;P<N.length;++P)F(P)}return[N,g]}(s.shape,i.shape,l,c,s.dtype,function(p,f){var x=p-f;return x*x}),d=u[0],h=u[1];return{dataId:o.write(d,h,s.dtype),shape:h,dtype:s.dtype}}}];Th<db.length;Th++)sN(db[Th]);var si,fP=function(e){this.variableNames=["A"];var t=un(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+n+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},mP=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=un(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+n+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `};for(var Ah=0,hb=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,s=t.pixels,i=r.numChannels,o=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,l=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,c=o?[s.videoWidth,s.videoHeight]:[s.width,s.height],u=c[0],d=c[1],h=[d,u],p=[d,u,i];(l||o)&&(si==null&&(si=document.createElement("canvas").getContext("2d")),si.canvas.width=u,si.canvas.height=d,si.drawImage(s,0,0,u,d),s=si.canvas);var f=n.makeTensorInfo(h,"int32");n.texData.get(f.dataId).usage=$n.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(f.dataId),s);var x=ee().getBool("WEBGL_PACK")?new mP(p):new fP(p),v=n.runWebGLProgram(x,[f],"int32");return n.disposeData(f.dataId),v}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;Cu("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var s=t,i=s.boxes,o=s.scores,l=r,c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,h=l.softNmsSigma,p=n,f=$m(p.readSync(i.dataId),p.readSync(o.dataId),c,u,d,h);return[f.selectedIndices,f.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,s=n,i=new Be(r.shape,"return x * x;");return s.runWebGLProgram(i,[r],r.dtype)}},{kernelName:fl,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,s=r.a,i=r.b,o=n,l=ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new na("return (a - b) * (a - b);",s.shape,i.shape):new wt("return (a - b) * (a - b);",s.shape,i.shape);return o.compileAndRun(l,[s,i])}}];Ah<hb.length;Ah++)sN(hb[Ah]);for(var Ih=0,pb=[{kernelName:"Square",gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:fl,gradFunc:function(e,t){var n=t[0],r=t[1],s=fe(2);return{a:function(){return hn(e,hn(s,zt(n,r)))},b:function(){return hn(e,hn(s,zt(r,n)))}}}}];Ih<pb.length;Ih++)hR(pb[Ih]);var xP=function(){function e(){}return e.prototype.fetch=function(t,n){return fetch(t,n)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+n);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return new TextDecoder(n).decode(t)},e}();ee().get("IS_BROWSER")&&ee().setPlatform("browser",new xP);var Ph,gP=function(){return require("node-fetch")},vP=function(){function e(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(t,n){return ee().global.fetch!=null?ee().global.fetch(t,n):(Ph==null&&(Ph=gP()),Ph(t,n))},e.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+n);return this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)},e}();ee().get("IS_NODE")&&ee().setPlatform("node",new vP);var cf={float32:4,int32:4,uint16:2,uint8:1,bool:1},Lu=4;function Dj(e,t){for(var n={},r=0,s=function(l){var c=l.name,u=l.dtype,d=l.shape,h=je(d),p=void 0;if("quantization"in l){var f=l.quantization;if(f.dtype!=="uint8"&&f.dtype!=="uint16")throw new Error("Weight "+l.name+" has unknown quantization dtype "+f.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var x=cf[f.dtype],v=e.slice(r,r+h*x),y=f.dtype==="uint8"?new Uint8Array(v):new Uint16Array(v);if(u==="float32")p=Float32Array.from(y,function(C){return C*f.scale+f.min});else{if(u!=="int32")throw new Error("Unsupported dtype in weight '"+c+"': "+u);p=Int32Array.from(y,function(C){return Math.round(C*f.scale+f.min)})}r+=h*x}else if(u==="string"){var m=je(l.shape);p=[];for(var g=0;g<m;g++){var b=new Uint32Array(e.slice(r,r+Lu))[0];r+=Lu;var w=new Uint8Array(e.slice(r,r+b));p.push(w),r+=b}}else{var N=cf[u];if(v=e.slice(r,r+h*N),u==="float32")p=new Float32Array(v);else if(u==="int32")p=new Int32Array(v);else{if(u!=="bool")throw new Error("Unsupported dtype in weight '"+c+"': "+u);p=new Uint8Array(v)}r+=h*N}n[c]=en(p,d,u)},i=0,o=t;i<o.length;i++)s(o[i]);return n}function yP(e){if(e===null)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach(function(i){if(t+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)});var r=new Uint8Array(t),s=0;return n.forEach(function(i){r.set(new Uint8Array(i.buffer),s),s+=i.byteLength}),r.buffer}var uf=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function fb(e){return uf?Buffer.byteLength(e):new Blob([e]).size}function sx(e){var t=0;e.forEach(function(s){t+=s.byteLength});var n=new Uint8Array(t),r=0;return e.forEach(function(s){n.set(new Uint8Array(s),r),r+=s.byteLength}),n.buffer}function mb(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function Fl(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:fb(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:fb(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:e.weightData.byteLength}}var zn=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var s=[];return(n==="load"?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(function(i){var o=i(t,r);o!==null&&s.push(o)}),s},e}(),Ii="://",es=function(){function e(){this.managers={}}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerManager=function(t,n){M(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith(Ii)&&(t=t.slice(0,t.indexOf(Ii))),M(t.length>0,function(){return"scheme must not be an empty string."});var r=e.getInstance();M(r.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),r.managers[t]=n},e.getManager=function(t){var n=this.getInstance().managers[t];if(n==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return n},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function zc(e){if(e.indexOf(Ii)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+es.getSchemes().join(","));return{scheme:e.split(Ii)[0],path:e.split(Ii)[1]}}function xb(e,t,n){return n===void 0&&(n=!1),we(this,void 0,void 0,function(){var r,s,i,o,l,c,u,d,h;return Ne(this,function(p){switch(p.label){case 0:return M(e!==t,function(){return"Old path and new path are the same: '"+e+"'"}),M((r=zn.getLoadHandlers(e)).length>0,function(){return"Copying failed because no load handler is found for source URL "+e+"."}),M(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."}),s=r[0],M((i=zn.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),M(i.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."}),o=i[0],l=zc(e).scheme,c=zc(e).path,u=l===zc(e).scheme,[4,s.load()];case 1:return d=p.sent(),n&&u?[4,es.getManager(l).removeModel(c)]:[3,3];case 2:p.sent(),p.label=3;case 3:return[4,o.save(d)];case 4:return h=p.sent(),!n||u?[3,6]:[4,es.getManager(l).removeModel(c)];case 5:p.sent(),p.label=6;case 6:return[2,h.modelArtifactsInfo]}})})}var Ts="models_store",Ua="model_info_store";function Rj(){if(!ee().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function df(e){var t=e.result;t.createObjectStore(Ts,{keyPath:"modelPath"}),t.createObjectStore(Ua,{keyPath:"modelPath"})}var Pi=function(){function e(t){if(this.indexedDB=Rj(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return e.prototype.save=function(t){return we(this,void 0,void 0,function(){return Ne(this,function(n){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},e.prototype.load=function(){return we(this,void 0,void 0,function(){return Ne(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},e.prototype.databaseAction=function(t,n){var r=this;return new Promise(function(s,i){var o=r.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return df(o)},o.onsuccess=function(){var l=o.result;if(n==null){var c=l.transaction(Ts,"readonly"),u=c.objectStore(Ts).get(r.modelPath);u.onsuccess=function(){if(u.result==null)return l.close(),i(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));s(u.result.modelArtifacts)},u.onerror=function(v){return l.close(),i(u.error)},c.oncomplete=function(){return l.close()}}else{var d,h=Fl(n),p=l.transaction(Ua,"readwrite"),f=p.objectStore(Ua),x=f.put({modelPath:r.modelPath,modelArtifactsInfo:h});x.onsuccess=function(){var v=(d=l.transaction(Ts,"readwrite")).objectStore(Ts).put({modelPath:r.modelPath,modelArtifacts:n,modelArtifactsInfo:h});v.onsuccess=function(){return s({modelArtifactsInfo:h})},v.onerror=function(y){var m=(f=p.objectStore(Ua)).delete(r.modelPath);m.onsuccess=function(){return l.close(),i(v.error)},m.onerror=function(g){return l.close(),i(v.error)}}},x.onerror=function(v){return l.close(),i(x.error)},p.oncomplete=function(){d==null?l.close():d.oncomplete=function(){return l.close()}}}},o.onerror=function(l){return i(o.error)}})},e.URL_SCHEME="indexeddb://",e}(),gb=function(e){return ee().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Pi.URL_SCHEME)?(t=e.slice(Pi.URL_SCHEME.length),new Pi(t)):null;var t};zn.registerSaveRouter(gb),zn.registerLoadRouter(gb);var bP=function(){function e(){this.indexedDB=Rj()}return e.prototype.listModels=function(){return we(this,void 0,void 0,function(){var t=this;return Ne(this,function(n){return[2,new Promise(function(r,s){var i=t.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return df(i)},i.onsuccess=function(){var o=i.result,l=o.transaction(Ua,"readonly"),c=l.objectStore(Ua).getAll();c.onsuccess=function(){for(var u={},d=0,h=c.result;d<h.length;d++){var p=h[d];u[p.modelPath]=p.modelArtifactsInfo}r(u)},c.onerror=function(u){return o.close(),s(c.error)},l.oncomplete=function(){return o.close()}},i.onerror=function(o){return s(i.error)}})]})})},e.prototype.removeModel=function(t){return we(this,void 0,void 0,function(){var n=this;return Ne(this,function(r){var s;return t=(s=t).startsWith(Pi.URL_SCHEME)?s.slice(Pi.URL_SCHEME.length):s,[2,new Promise(function(i,o){var l=n.indexedDB.open("tensorflowjs",1);l.onupgradeneeded=function(){return df(l)},l.onsuccess=function(){var c,u=l.result,d=u.transaction(Ua,"readwrite"),h=d.objectStore(Ua),p=h.get(t);p.onsuccess=function(){if(p.result==null)return u.close(),o(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var f=h.delete(t),x=function(){var v=(c=u.transaction(Ts,"readwrite")).objectStore(Ts).delete(t);v.onsuccess=function(){return i(p.result.modelArtifactsInfo)},v.onerror=function(y){return o(p.error)}};f.onsuccess=x,f.onerror=function(v){return x(),u.close(),o(p.error)}},p.onerror=function(f){return u.close(),o(p.error)},d.oncomplete=function(){c==null?u.close():c.oncomplete=function(){return u.close()}}},l.onerror=function(c){return o(l.error)}})]})})},e}();if(ee().getBool("IS_BROWSER"))try{es.registerManager(Pi.URL_SCHEME,new bP)}catch{}var sa="/",di="tensorflowjs_models",_j="info",wP="model_topology",NP="weight_specs",jP="weight_data",CP="model_metadata";function Tj(e){return{info:[di,e,_j].join(sa),topology:[di,e,wP].join(sa),weightSpecs:[di,e,NP].join(sa),weightData:[di,e,jP].join(sa),modelMetadata:[di,e,CP].join(sa)}}function kP(e){var t=e.split(sa);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(sa)}var Fi=function(){function e(t){if(!ee().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=Tj(this.modelPath)}return e.prototype.save=function(t){return we(this,void 0,void 0,function(){var n,r,s;return Ne(this,function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),s=Fl(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(o){if(uf)return Buffer.from(o).toString("base64");for(var l=new Uint8Array(o),c="",u=0,d=l.length;u<d;u++)c+=String.fromCharCode(l[u]);return btoa(c)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:s}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+s.modelTopologyBytes+", weightSpecsBytes="+s.weightSpecsBytes+", weightDataBytes="+s.weightDataBytes+".")}return[2]})})},e.prototype.load=function(){return we(this,void 0,void 0,function(){var t,n,r,s,i,o,l;return Ne(this,function(c){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(n={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(n.modelTopology=r,(s=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(n.weightSpecs=s,(i=this.LS.getItem(this.keys.modelMetadata))!=null&&(o=JSON.parse(i),n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,n.userDefinedMetadata=o.userDefinedMetadata),(l=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return n.weightData=function(u){if(uf){var d=Buffer.from(u,"base64");return d.buffer.slice(d.byteOffset,d.byteOffset+d.byteLength)}for(var h=atob(u),p=new Uint8Array(h.length),f=0;f<h.length;++f)p.set([h.charCodeAt(f)],f);return p.buffer}(l),[2,n]})})},e.URL_SCHEME="localstorage://",e}(),vb=function(e){return ee().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Fi.URL_SCHEME)?(t=e.slice(Fi.URL_SCHEME.length),new Fi(t)):null;var t};zn.registerSaveRouter(vb),zn.registerLoadRouter(vb);var SP=function(){function e(){M(ee().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),M(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return e.prototype.listModels=function(){return we(this,void 0,void 0,function(){var t,n,r,s,i,o;return Ne(this,function(l){for(t={},n=di+sa,r=sa+_j,s=0;s<this.LS.length;++s)(i=this.LS.key(s)).startsWith(n)&&i.endsWith(r)&&(o=kP(i),t[o]=JSON.parse(this.LS.getItem(i)));return[2,t]})})},e.prototype.removeModel=function(t){return we(this,void 0,void 0,function(){var n,r;return Ne(this,function(s){var i;if(t=(i=t).startsWith(Fi.URL_SCHEME)?i.slice(Fi.URL_SCHEME.length):i,n=Tj(t),this.LS.getItem(n.info)==null)throw new Error("Cannot find model at path '"+t+"'");return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),[2,r]})})},e}();if(ee().getBool("IS_BROWSER"))try{es.registerManager(Fi.URL_SCHEME,new SP)}catch{}var EP="model",DP=".json",RP=".weights.bin";function yb(e){return new Promise(function(t){return setTimeout(t)}).then(e)}var Fh=function(){function e(t){if(!ee().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),t!=null&&t.length!==0||(t=EP),this.modelTopologyFileName=t+DP,this.weightDataFileName=t+RP}return e.prototype.save=function(t){return we(this,void 0,void 0,function(){var n,r,s,i,o,l;return Ne(this,function(c){switch(c.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],s={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},i=window.URL.createObjectURL(new Blob([JSON.stringify(s)],{type:"application/json"})),(o=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,o.href=i,[4,yb(function(){return o.dispatchEvent(new MouseEvent("click"))})];case 2:return c.sent(),t.weightData==null?[3,4]:((l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,l.href=n,[4,yb(function(){return l.dispatchEvent(new MouseEvent("click"))})]);case 3:c.sent(),c.label=4;case 4:return[2,{modelArtifactsInfo:Fl(t)}]}})})},e.URL_SCHEME="downloads://",e}(),_P=function(){function e(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return e.prototype.load=function(){return we(this,void 0,void 0,function(){var t,n,r=this;return Ne(this,function(s){return t=this.files[0],n=this.files.slice(1),[2,new Promise(function(i,o){var l=new FileReader;l.onload=function(c){var u=JSON.parse(c.target.result),d=u.modelTopology;if(d!=null){n.length===0&&i({modelTopology:d});var h=u.weightsManifest;if(h!=null){var p;try{p=r.checkManifestAndWeightFiles(h,n)}catch(y){return void o(y)}var f=[],x=[],v=[];h.forEach(function(y){y.paths.forEach(function(m){x.push(m),v.push(null)}),f.push.apply(f,y.weights)}),h.forEach(function(y){y.paths.forEach(function(m){var g=new FileReader;g.onload=function(b){var w=b.target.result,N=x.indexOf(m);v[N]=w,v.indexOf(null)===-1&&i({modelTopology:d,weightSpecs:f,weightData:sx(v),format:u.format,generatedBy:u.generatedBy,convertedBy:u.convertedBy,userDefinedMetadata:u.userDefinedMetadata})},g.onerror=function(b){return o("Failed to weights data from file of path '"+m+"'.")},g.readAsArrayBuffer(p[m])})})}else o(new Error("weightManifest field is missing from file "+t.name))}else o(new Error("modelTopology field is missing from file "+t.name))},l.onerror=function(c){return o("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},l.readAsText(t)})]})})},e.prototype.checkManifestAndWeightFiles=function(t,n){for(var r=[],s=n.map(function(c){return mb(c.name)}),i={},o=0,l=t;o<l.length;o++)l[o].paths.forEach(function(c){var u=mb(c);if(r.indexOf(u)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+u+"'");if(r.push(u),s.indexOf(u)===-1)throw new Error("Weight file with basename '"+u+"' is not provided.");i[c]=n[s.indexOf(u)]});if(r.length!==n.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+n.length+").");return i},e}();function bb(e,t,n,r){(function(i){M(i!=null&&Array.isArray(i)&&i.length>0,function(){return"promises must be a none empty array"})})(e),function(i,o){M(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i}),M(o>=0&&o<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+o}),M(o>=i,function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+o})}(n=n??0,r=r??1);var s=0;return Promise.all(e.map(function(i){return i.then(function(o){var l=n+ ++s/e.length*(r-n);return t(l),o}),i}))}function Aj(e,t){return we(this,void 0,void 0,function(){var n,r,s,i,o,l,c,u,d;return Ne(this,function(h){switch(h.label){case 0:return t==null&&(t={}),n=t.fetchFunc==null?ee().platform.fetch:t.fetchFunc,r=e.map(function(p){return n(p,t.requestInit,{isBinary:!0})}),s=0,i=.5,t.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return o=h.sent(),[3,4];case 2:return[4,bb(r,t.onProgress,s,i)];case 3:o=h.sent(),h.label=4;case 4:return l=o.map(function(p){return p.arrayBuffer()}),c=.5,u=1,t.onProgress!=null?[3,6]:[4,Promise.all(l)];case 5:return d=h.sent(),[3,8];case 6:return[4,bb(l,t.onProgress,c,u)];case 7:d=h.sent(),h.label=8;case 8:return[2,d]}})})}function wb(e){var t=this;return function(n,r,s){return r===void 0&&(r=""),we(t,void 0,void 0,function(){var i,o,l,c,u,d,h,p,f,x;return Ne(this,function(v){switch(v.label){case 0:if(i=n.map(function(){return!1}),o={},l=s!=null?s.map(function(){return!1}):[],c=[],n.forEach(function(y,m){var g=0;y.weights.forEach(function(b){var w="quantization"in b?b.quantization.dtype:b.dtype,N=cf[w]*je(b.shape),C=function(){i[m]=!0,o[m]==null&&(o[m]=[]),o[m].push({manifestEntry:b,groupOffset:g,sizeBytes:N})};s!=null?s.forEach(function(D,j){D===b.name&&(C(),l[j]=!0)}):C(),c.push(b.name),g+=N})}),!l.every(function(y){return y}))throw u=s.filter(function(y,m){return!l[m]}),new Error("Could not find weights in manifest with names: "+u.join(", ")+`. 
Manifest JSON has weights with names: `+c.join(", ")+".");return d=i.reduce(function(y,m,g){return m&&y.push(g),y},[]),h=[],d.forEach(function(y){n[y].paths.forEach(function(m){var g=r+(r.endsWith("/")?"":"/")+m;h.push(g)})}),[4,e(h)];case 1:return p=v.sent(),f={},x=0,d.forEach(function(y){for(var m=n[y].paths.length,g=0,b=0;b<m;b++)g+=p[x+b].byteLength;for(var w=new ArrayBuffer(g),N=new Uint8Array(w),C=0,D=0;D<m;D++){var j=new Uint8Array(p[x+D]);N.set(j,C),C+=j.byteLength}o[y].forEach(function(k){var R=Dj(w.slice(k.groupOffset,k.groupOffset+k.sizeBytes),[k.manifestEntry]);for(var E in R)f[E]=R[E]}),x+=m}),[2,f]}})})}}zn.registerSaveRouter(function(e){return ee().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Fh.URL_SCHEME)?function(t){return t===void 0&&(t="model"),new Fh(t)}(e.slice(Fh.URL_SCHEME.length)):null});var Ij=function(){function e(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,n.fetchFunc!=null?(M(typeof n.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=n.fetchFunc):this.fetch=ee().platform.fetch,M(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&M(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return e.prototype.save=function(t){return we(this,void 0,void 0,function(){var n,r,s,i;return Ne(this,function(o){switch(o.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],s={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:r},n.body.append("model.json",new Blob([JSON.stringify(s)],{type:"application/json"}),"model.json"),t.weightData!=null&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,n)];case 1:if((i=o.sent()).ok)return[2,{modelArtifactsInfo:Fl(t),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},e.prototype.load=function(){return we(this,void 0,void 0,function(){var t,n,r,s,i,o,l,c,u,d,h,p;return Ne(this,function(f){switch(f.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=f.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");f.label=2;case 2:return f.trys.push([2,4,,5]),[4,t.json()];case 3:return n=f.sent(),[3,5];case 4:throw f.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(s=n.modelTopology,i=n.weightsManifest,o=n.generatedBy,l=n.convertedBy,c=n.format,u=n.userDefinedMetadata,s==null&&i==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return i==null?[3,7]:[4,this.loadWeights(i)];case 6:p=f.sent(),d=p[0],h=p[1],f.label=7;case 7:return[2,{modelTopology:s,weightSpecs:d,weightData:h,userDefinedMetadata:u,generatedBy:o,convertedBy:l,format:c}]}})})},e.prototype.loadWeights=function(t){return we(this,void 0,void 0,function(){var n,r,s,i,o,l,c,u,d,h,p;return Ne(this,function(f){switch(f.label){case 0:for(n=Array.isArray(this.path)?this.path[1]:this.path,r=function(x){var v=x.lastIndexOf("/"),y=x.lastIndexOf("?"),m=x.substring(0,v),g=y>v?x.substring(y):"";return[m+"/",g]}(n),s=r[0],i=r[1],o=this.weightPathPrefix||s,l=[],c=0,u=t;c<u.length;c++)d=u[c],l.push.apply(l,d.weights);return h=[],t.forEach(function(x){x.paths.forEach(function(v){h.push(o+v+i)})}),[4,Aj(h,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return p=f.sent(),[2,[l,sx(p)]]}})})},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function hf(e){return e.match(Ij.URL_SCHEME_REGEX)!=null}var Nb=function(e,t){return typeof fetch>"u"?null:(Array.isArray(e)?e.every(function(n){return hf(n)}):hf(e))?pf(e,{onProgress:t}):null};function pf(e,t){return new Ij(e,t)}zn.registerSaveRouter(Nb),zn.registerLoadRouter(Nb);var Mh=function(){function e(t){this.modelArtifacts=t}return e.prototype.load=function(){return we(this,void 0,void 0,function(){return Ne(this,function(t){return[2,this.modelArtifacts]})})},e}(),TP=function(){function e(t){this.saveHandler=t}return e.prototype.save=function(t){return we(this,void 0,void 0,function(){return Ne(this,function(n){return[2,this.saveHandler(t)]})})},e}(),Pj=Object.freeze({browserFiles:function(e){return new _P(e)},browserHTTPRequest:function(e,t){return pf(e,t)},concatenateArrayBuffers:sx,decodeWeights:Dj,encodeWeights:function(e,t){return we(this,void 0,void 0,function(){var n,r,s,i,o,l=this;return Ne(this,function(c){switch(c.label){case 0:for(n=[],r=[],s=Array.isArray(e)?e.map(function(u){return u.name}):Object.keys(e),i=function(u){var d=s[u],h=Array.isArray(e)?e[u].tensor:e[d];if(h.dtype!=="float32"&&h.dtype!=="int32"&&h.dtype!=="bool"&&h.dtype!=="string")throw new Error("Unsupported dtype in weight '"+d+"': "+h.dtype);var p={name:d,shape:h.shape,dtype:h.dtype};if(h.dtype==="string"){var f=new Promise(function(x){return we(l,void 0,void 0,function(){var v,y,m,g,b,w,N;return Ne(this,function(C){switch(C.label){case 0:return[4,h.bytes()];case 1:for(v=C.sent(),y=v.reduce(function(D,j){return D+j.length},0)+Lu*v.length,m=new Uint8Array(y),g=0,b=0;b<v.length;b++)w=v[b],N=new Uint8Array(new Uint32Array([w.length]).buffer),m.set(N,g),g+=Lu,m.set(w,g),g+=w.length;return x(m),[2]}})})});r.push(f)}else r.push(h.data());t!=null&&(p.group=t),n.push(p)},o=0;o<s.length;++o)i(o);return[4,Promise.all(r)];case 1:return[2,{data:yP(c.sent()),specs:n}]}})})},fromMemory:function(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new Mh(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Mh({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Mh({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return zn.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:Fl,getSaveHandlers:function(e){return zn.getSaveHandlers(e)},http:pf,isHTTPScheme:hf,loadWeights:function(e,t,n,r){return t===void 0&&(t=""),we(this,void 0,void 0,function(){return Ne(this,function(s){return[2,wb(function(i){return Aj(i,{requestInit:r})})(e,t,n)]})})},registerLoadRouter:function(e){return zn.registerLoadRouter(e)},registerSaveRouter:function(e){return zn.registerSaveRouter(e)},weightsLoaderFactory:wb,withSaveHandler:function(e){return new TP(e)},copyModel:function(e,t){return we(this,void 0,void 0,function(){return Ne(this,function(n){return[2,xb(e,t,!1)]})})},listModels:function(){return we(this,void 0,void 0,function(){var e,t,n,r,s,i,o;return Ne(this,function(l){switch(l.label){case 0:e=es.getSchemes(),t={},n=0,r=e,l.label=1;case 1:return n<r.length?(s=r[n],[4,es.getManager(s).listModels()]):[3,4];case 2:for(o in i=l.sent())t[s+Ii+o]=i[o];l.label=3;case 3:return n++,[3,1];case 4:return[2,t]}})})},moveModel:function(e,t){return we(this,void 0,void 0,function(){return Ne(this,function(n){return[2,xb(e,t,!0)]})})},removeModel:function(e){return we(this,void 0,void 0,function(){var t;return Ne(this,function(n){return t=zc(e),[2,es.getManager(t.scheme).removeModel(t.path)]})})}}),ii;z({confusionMatrix_:function(e,t,n){var r=T(e,"labels","confusionMatrix"),s=T(t,"predictions","confusionMatrix");M(n==null||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),M(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),M(s.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+s.rank}),M(r.shape[0]===s.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+s.shape[0]+". Labels and predictions should have the same number of elements."}),M(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var i=rf(r.asType("int32"),n),o=rf(s.asType("int32"),n);return i.transpose().matMul(o).asType("int32")}});var AP=z({fromPixels_:function(e,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,s=!1,i=!1,o=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)s=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)i=!0;else{if(e.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);o=!0}if(s&&s&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(aN("FromPixels",V.backendName)!=null)return V.runKernel("FromPixels",{pixels:e},{numChannels:t});var l,c,u=s?[e.videoWidth,e.videoHeight]:[e.width,e.height],d=u[0],h=u[1];if(o?l=e.getContext("2d").getImageData(0,0,d,h).data:r||n?l=e.data:(i||s)&&(ii==null&&(ii=document.createElement("canvas").getContext("2d")),ii.canvas.width=d,ii.canvas.height=h,ii.drawImage(e,0,0,d,h),l=ii.getImageData(0,0,d,h).data),t===4)c=new Int32Array(l);else{var p=d*h;c=new Int32Array(p*t);for(var f=0;f<p;f++)for(var x=0;x<t;++x)c[f*t+x]=l[4*f+x]}return Pm(c,[h,d,t],"int32")}}),ix=Object.freeze({toPixels:function(e,t){return we(this,void 0,void 0,function(){var n,r,s,i,o,l,c,u,d,h,p,f,x,v,y,m,g,b,w,N,C,D,j;return Ne(this,function(k){switch(k.label){case 0:if(n=T(e,"img","toPixels"),e instanceof xt||(n=n.toInt()),n.rank!==2&&n.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),s=r[0],i=r[1],(o=n.rank===2?1:n.shape[2])>4||o===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+o);return[4,n.data()];case 1:return l=k.sent(),c=n.min(),u=n.max(),[4,Promise.all([c.data(),u.data()])];case 2:if(d=k.sent(),h=d[0],p=d[1],f=h[0],x=p[0],c.dispose(),u.dispose(),n.dtype==="float32"){if(f<0||x>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+f+" - "+x+"].")}else{if(n.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(f<0||x>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+f+" - "+x+"].")}for(v=n.dtype==="float32"?255:1,y=new Uint8ClampedArray(i*s*4),m=0;m<s*i;++m)g=void 0,b=void 0,w=void 0,N=void 0,o===1?(g=l[m]*v,b=l[m]*v,w=l[m]*v,N=255):o===3?(g=l[3*m]*v,b=l[3*m+1]*v,w=l[3*m+2]*v,N=255):o===4&&(g=l[4*m]*v,b=l[4*m+1]*v,w=l[4*m+2]*v,N=l[4*m+3]*v),y[(C=4*m)+0]=Math.round(g),y[C+1]=Math.round(b),y[C+2]=Math.round(w),y[C+3]=Math.round(N);return t!=null&&(t.width=i,t.height=s,D=t.getContext("2d"),j=new ImageData(y,i,s),D.putImageData(j,0,0)),n!==e&&n.dispose(),[2,y]}})})},fromPixels:AP}),IP=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(t,n){return new t(n)},e}(),PP=function(){function e(){this.classNameMap={}}return e.getMap=function(){return e.instance==null&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function Zs(e){M(e.className!=null,function(){return"Class being registered does not have the static className property defined."}),M(typeof e.className=="string",function(){return"className is required to be a string, but got type "+typeof e.className}),M(e.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),PP.register(e)}var ei=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return kr(t,e),t.prototype.minimize=function(n,r,s){r===void 0&&(r=!1);var i=this.computeGradients(n,s),o=i.value,l=i.grads;if(s!=null){var c=s.map(function(u){return{name:u.name,tensor:l[u.name]}});this.applyGradients(c)}else this.applyGradients(l);return An(l),r?o:(o.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(n,r){return V_(n,r)},t.prototype.dispose=function(){this.iterations_!=null&&An(this.iterations_)},t.prototype.saveIterations=function(){return we(this,void 0,void 0,function(){return Ne(this,function(n){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:fe(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return we(this,void 0,void 0,function(){return Ne(this,function(n){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(n){return we(this,void 0,void 0,function(){return Ne(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(n){return we(this,void 0,void 0,function(){var r;return Ne(this,function(s){switch(s.label){case 0:return r=this,[4,n[0].tensor.data()];case 1:return r.iterations_=s.sent()[0],[2,n.slice(1)]}})})},t}(IP);Object.defineProperty(ei,Symbol.hasInstance,{value:function(e){return e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null}});var FP=function(e){function t(n,r,s){s===void 0&&(s=null);var i=e.call(this)||this;return i.learningRate=n,i.rho=r,i.epsilon=s,i.accumulatedGrads=[],i.accumulatedUpdates=[],s==null&&(i.epsilon=V.backend.epsilon()),i}return kr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(s){return s.name}):Object.keys(n)).forEach(function(s,i){var o=V.registeredVariables[s];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:s+"/accum_grad",variable:me(function(){return Ke(o).variable(!1)})}),r.accumulatedUpdates[i]==null&&(r.accumulatedUpdates[i]={originalName:s+"/accum_var",variable:me(function(){return Ke(o).variable(!1)})});var l=Array.isArray(n)?n[i].tensor:n[s];if(l!=null){var c=r.accumulatedGrads[i].variable,u=r.accumulatedUpdates[i].variable;me(function(){var d=c.mul(r.rho).add(l.square().mul(1-r.rho)),h=u.add(r.epsilon).sqrt().div(c.add(r.epsilon).sqrt()).mul(l),p=u.mul(r.rho).add(h.square().mul(1-r.rho));c.assign(d),u.assign(p);var f=h.mul(-r.learningRate).add(o);o.assign(f)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(An(this.accumulatedGrads.map(function(n){return n.variable})),An(this.accumulatedUpdates.map(function(n){return n.variable})))},t.prototype.getWeights=function(){return we(this,void 0,void 0,function(){var n;return Ne(this,function(r){switch(r.label){case 0:return n=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(s){return{name:s.originalName,tensor:s.variable}}))]}})})},t.prototype.setWeights=function(n){return we(this,void 0,void 0,function(){var r;return Ne(this,function(s){switch(s.label){case 0:return[4,this.extractIterations(n)];case 1:return n=s.sent(),r=n.length/2,this.accumulatedGrads=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedUpdates=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.rho,r.epsilon)},t.className="Adadelta",t}(ei);Zs(FP);var MP=function(e){function t(n,r){r===void 0&&(r=.1);var s=e.call(this)||this;return s.learningRate=n,s.initialAccumulatorValue=r,s.accumulatedGrads=[],s}return kr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(s){return s.name}):Object.keys(n)).forEach(function(s,i){var o=V.registeredVariables[s];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:s+"/accumulator",variable:me(function(){return Vr(o.shape,r.initialAccumulatorValue).variable(!1)})});var l=Array.isArray(n)?n[i].tensor:n[s];if(l!=null){var c=r.accumulatedGrads[i].variable;me(function(){var u=c.add(l.square());c.assign(u);var d=l.div(u.add(V.backend.epsilon()).sqrt()).mul(-r.learningRate).add(o);o.assign(d)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&An(this.accumulatedGrads.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return we(this,void 0,void 0,function(){return Ne(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return we(this,void 0,void 0,function(){return Ne(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulatedGrads=n.map(function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(n,r){return new n(r.learningRate,r.initialAccumulatorValue)},t.className="Adagrad",t}(ei);Zs(MP);var LP=function(e){function t(n,r,s,i){i===void 0&&(i=null);var o=e.call(this)||this;return o.learningRate=n,o.beta1=r,o.beta2=s,o.epsilon=i,o.accumulatedFirstMoment=[],o.accumulatedSecondMoment=[],me(function(){o.accBeta1=fe(r).variable(),o.accBeta2=fe(s).variable()}),i==null&&(o.epsilon=V.backend.epsilon()),o}return kr(t,e),t.prototype.applyGradients=function(n){var r=this,s=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);me(function(){var i=zt(1,r.accBeta1),o=zt(1,r.accBeta2);s.forEach(function(l,c){var u=V.registeredVariables[l];r.accumulatedFirstMoment[c]==null&&(r.accumulatedFirstMoment[c]={originalName:l+"/m",variable:me(function(){return Ke(u).variable(!1)})}),r.accumulatedSecondMoment[c]==null&&(r.accumulatedSecondMoment[c]={originalName:l+"/v",variable:me(function(){return Ke(u).variable(!1)})});var d=Array.isArray(n)?n[c].tensor:n[l];if(d!=null){var h=r.accumulatedFirstMoment[c].variable,p=r.accumulatedSecondMoment[c].variable,f=h.mul(r.beta1).add(d.mul(1-r.beta1)),x=p.mul(r.beta2).add(d.square().mul(1-r.beta2)),v=f.div(i),y=x.div(o);h.assign(f),p.assign(x);var m=v.div(y.sqrt().add(r.epsilon)).mul(-r.learningRate).add(u);u.assign(m)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&An(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedSecondMoment!=null&&An(this.accumulatedSecondMoment.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return we(this,void 0,void 0,function(){var n;return Ne(this,function(r){switch(r.label){case 0:return n=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(s){return{name:s.originalName,tensor:s.variable}}))]}})})},t.prototype.setWeights=function(n){return we(this,void 0,void 0,function(){var r,s=this;return Ne(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),me(function(){s.accBeta1.assign(Fu(s.beta1,s.iterations_+1)),s.accBeta2.assign(Fu(s.beta2,s.iterations_+1))}),r=n.length/2,this.accumulatedFirstMoment=n.slice(0,r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),this.accumulatedSecondMoment=n.slice(r,2*r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon)},t.className="Adam",t}(ei);Zs(LP);var OP=function(e){function t(n,r,s,i,o){i===void 0&&(i=null),o===void 0&&(o=0);var l=e.call(this)||this;return l.learningRate=n,l.beta1=r,l.beta2=s,l.epsilon=i,l.decay=o,l.accumulatedFirstMoment=[],l.accumulatedWeightedInfNorm=[],me(function(){l.iteration=fe(0).variable(),l.accBeta1=fe(r).variable()}),i==null&&(l.epsilon=V.backend.epsilon()),l}return kr(t,e),t.prototype.applyGradients=function(n){var r=this,s=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);me(function(){var i=zt(1,r.accBeta1),o=mr(-r.learningRate,r.iteration.mul(r.decay).add(1));s.forEach(function(l,c){var u=V.registeredVariables[l];r.accumulatedFirstMoment[c]==null&&(r.accumulatedFirstMoment[c]={originalName:l+"/m",variable:Ke(u).variable(!1)}),r.accumulatedWeightedInfNorm[c]==null&&(r.accumulatedWeightedInfNorm[c]={originalName:l+"/v",variable:Ke(u).variable(!1)});var d=Array.isArray(n)?n[c].tensor:n[l];if(d!=null){var h=r.accumulatedFirstMoment[c].variable,p=r.accumulatedWeightedInfNorm[c].variable,f=h.mul(r.beta1).add(d.mul(1-r.beta1)),x=p.mul(r.beta2),v=d.abs(),y=x.maximum(v);h.assign(f),p.assign(y);var m=o.div(i).mul(f.div(y.add(r.epsilon))).add(u);u.assign(m)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&An(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedWeightedInfNorm!=null&&An(this.accumulatedWeightedInfNorm.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return we(this,void 0,void 0,function(){return Ne(this,function(n){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(n){return we(this,void 0,void 0,function(){return Ne(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},t.className="Adamax",t}(ei);Zs(OP);var Fj=function(e){function t(n){var r=e.call(this)||this;return r.learningRate=n,r.setLearningRate(n),r}return kr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(s){return s.name}):Object.keys(n)).forEach(function(s,i){var o=Array.isArray(n)?n[i].tensor:n[s];if(o!=null){var l=V.registeredVariables[s];me(function(){var c=r.c.mul(o).add(l);l.assign(c)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(n){this.learningRate=n,this.c!=null&&this.c.dispose(),this.c=a_(fe(-n))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return we(this,void 0,void 0,function(){return Ne(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()]]}})})},t.prototype.setWeights=function(n){return we(this,void 0,void 0,function(){return Ne(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:if((n=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(n,r){return new n(r.learningRate)},t.className="SGD",t}(ei);Zs(Fj);var BP=function(e){function t(n,r,s){s===void 0&&(s=!1);var i=e.call(this,n)||this;return i.learningRate=n,i.momentum=r,i.useNesterov=s,i.accumulations=[],i.m=fe(i.momentum),i}return kr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(s){return s.name}):Object.keys(n)).forEach(function(s,i){var o=V.registeredVariables[s];r.accumulations[i]==null&&(r.accumulations[i]={originalName:s+"/momentum",variable:me(function(){return Ke(o).variable(!1)})});var l=r.accumulations[i].variable,c=Array.isArray(n)?n[i].tensor:n[s];c!=null&&me(function(){var u,d=r.m.mul(l).add(c);u=r.useNesterov?r.c.mul(c.add(d.mul(r.m))).add(o):r.c.mul(d).add(o),l.assign(d),o.assign(u)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&An(this.accumulations.map(function(n){return n.variable}))},t.prototype.setMomentum=function(n){this.momentum=n},t.prototype.getWeights=function(){return we(this,void 0,void 0,function(){return Ne(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return we(this,void 0,void 0,function(){return Ne(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulations=n.map(function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(n,r){return new n(r.learningRate,r.momentum,r.useNesterov)},t.className="Momentum",t}(Fj);Zs(BP);var $P=function(e){function t(n,r,s,i,o){r===void 0&&(r=.9),s===void 0&&(s=0),i===void 0&&(i=null),o===void 0&&(o=!1);var l=e.call(this)||this;if(l.learningRate=n,l.decay=r,l.momentum=s,l.epsilon=i,l.accumulatedMeanSquares=[],l.accumulatedMoments=[],l.accumulatedMeanGrads=[],l.centered=o,i==null&&(l.epsilon=V.backend.epsilon()),n==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return l}return kr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(s){return s.name}):Object.keys(n)).forEach(function(s,i){var o=V.registeredVariables[s];r.accumulatedMeanSquares[i]==null&&(r.accumulatedMeanSquares[i]={originalName:s+"/rms",variable:me(function(){return Ke(o).variable(!1)})}),r.accumulatedMoments[i]==null&&(r.accumulatedMoments[i]={originalName:s+"/momentum",variable:me(function(){return Ke(o).variable(!1)})}),r.accumulatedMeanGrads[i]==null&&r.centered&&(r.accumulatedMeanGrads[i]={originalName:s+"/mg",variable:me(function(){return Ke(o).variable(!1)})});var l=Array.isArray(n)?n[i].tensor:n[s];if(l!=null){var c=r.accumulatedMeanSquares[i].variable,u=r.accumulatedMoments[i].variable;me(function(){var d=c.mul(r.decay).add(l.square().mul(1-r.decay));if(r.centered){var h=r.accumulatedMeanGrads[i].variable,p=h.mul(r.decay).add(l.mul(1-r.decay)),f=u.mul(r.momentum).add(l.mul(r.learningRate).div(d.sub(p.square().add(r.epsilon)).sqrt()));c.assign(d),h.assign(p),u.assign(f);var x=o.sub(f);o.assign(x)}else{var v=c.mul(r.decay).add(l.square().mul(1-r.decay));f=u.mul(r.momentum).add(l.mul(r.learningRate).div(v.add(r.epsilon).sqrt())),c.assign(v),u.assign(f),x=o.sub(f),o.assign(x)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&An(this.accumulatedMeanSquares.map(function(n){return n.variable})),this.accumulatedMeanGrads!=null&&this.centered&&An(this.accumulatedMeanGrads.map(function(n){return n.variable})),this.accumulatedMoments!=null&&An(this.accumulatedMoments.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return we(this,void 0,void 0,function(){var n;return Ne(this,function(r){switch(r.label){case 0:return n=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&n.push.apply(n,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(s){return{name:s.originalName,tensor:s.variable}}))]}})})},t.prototype.setWeights=function(n){return we(this,void 0,void 0,function(){var r;return Ne(this,function(s){switch(s.label){case 0:return[4,this.extractIterations(n)];case 1:return n=s.sent(),r=this.centered?n.length/3:n.length/2,this.accumulatedMeanSquares=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedMoments=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=n.slice(2*r,3*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(n,r){return new n(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},t.className="RMSProp",t}(ei);Zs($P);xt.prototype.squaredDifference=function(e){return YN(this,e)},Y=hP;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ff=function(e,t){return ff=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},ff(e,t)};function Fe(e,t){ff(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var ln=function(){return ln=Object.assign||function(t){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},ln.apply(this,arguments)};function Se(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,[])).next())})}function Ee(e,t){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){n.label=u[1];break}if(u[0]===6&&n.label<i[1]){n.label=i[1],i=u;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(u);break}i[2]&&n.ops.pop(),n.trys.pop();continue}u=t.call(e,n)}catch(d){u=[6,d],s=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Uo(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),s=0,t=0;t<n;t++)for(var i=arguments[t],o=0,l=i.length;o<l;o++,s++)r[s]=i[o];return r}var Mi=function(){function e(t,n){if(!Ms(t)||!Ms(n))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:n}));this._width=t,this._height=n}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.reverse=function(){return new e(1/this.width,1/this.height)},e}();function kd(e,t){return e instanceof xt&&e.shape.length===t}function zP(e){return kd(e,2)}function Sd(e){return kd(e,3)}function ts(e){return kd(e,4)}function UP(e){return e%1!==0}function jb(e){return e%2===0}function WP(e,t){t===void 0&&(t=2);var n=Math.pow(10,t);return Math.floor(e*n)/n}function Cb(e){return e&&e.width&&e.height}function VP(e,t){var n=e.width,r=e.height,s=t/Math.max(r,n);return new Mi(Math.round(n*s),Math.round(r*s))}function ox(e){return e.reduce(function(t,n){return t.add(n)},new Je(0,0)).div(new Je(e.length,e.length))}function ml(e,t,n){return Array(e).fill(0).map(function(r,s){return t+s*n})}function Ms(e){return!!e&&e!==1/0&&e!==-1/0&&!isNaN(e)||e===0}function kb(e){return Ms(e)&&0<=e&&e<=1}var Je=function(){function e(t,n){this._x=t,this._y=n}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.mul=function(t){return new e(this.x*t.x,this.y*t.y)},e.prototype.div=function(t){return new e(this.x/t.x,this.y/t.y)},e.prototype.abs=function(){return new e(Math.abs(this.x),Math.abs(this.y))},e.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y))},e}(),ls=function(){function e(t,n){n===void 0&&(n=!0);var r=t||{},s=[r.left,r.top,r.right,r.bottom].every(Ms),i=[r.x,r.y,r.width,r.height].every(Ms);if(!i&&!s)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var o=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],l=o[0],c=o[1],u=o[2],d=o[3];e.assertIsValidBox({x:l,y:c,width:u,height:d},"Box.constructor",n),this._x=l,this._y=c,this._width=u,this._height=d}return e.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(Ms)},e.assertIsValidBox=function(t,n,r){if(r===void 0&&(r=!1),!e.isRect(t))throw new Error(n+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!r&&(t.width<0||t.height<0))throw new Error(n+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topLeft",{get:function(){return new Je(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topRight",{get:function(){return new Je(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomLeft",{get:function(){return new Je(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRight",{get:function(){return new Je(this.right,this.bottom)},enumerable:!0,configurable:!0}),e.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(o){return Math.round(o)}),n=t[0],r=t[1],s=t[2],i=t[3];return new e({x:n,y:r,width:s,height:i})},e.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(o){return Math.floor(o)}),n=t[0],r=t[1],s=t[2],i=t[3];return new e({x:n,y:r,width:s,height:i})},e.prototype.toSquare=function(){var t=this,n=t.x,r=t.y,s=t.width,i=t.height,o=Math.abs(s-i);return s<i&&(n-=o/2,s+=o),i<s&&(r-=o/2,i+=o),new e({x:n,y:r,width:s,height:i})},e.prototype.rescale=function(t){var n=Cb(t)?t.width:t,r=Cb(t)?t.height:t;return new e({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},e.prototype.pad=function(t,n){var r=[this.x-t/2,this.y-n/2,this.width+t,this.height+n],s=r[0],i=r[1],o=r[2],l=r[3];return new e({x:s,y:i,width:o,height:l})},e.prototype.clipAtImageBorders=function(t,n){var r=this,s=r.x,i=r.y,o=r.right,l=r.bottom,c=Math.max(s,0),u=Math.max(i,0),d=o-c,h=l-u,p=Math.min(d,t-c),f=Math.min(h,n-u);return new e({x:c,y:u,width:p,height:f}).floor()},e.prototype.shift=function(t,n){var r=this,s=r.width,i=r.height,o=this.x+t,l=this.y+n;return new e({x:o,y:l,width:s,height:i})},e.prototype.padAtBorders=function(t,n){var r=this.width+1,s=this.height+1,i=1,o=1,l=r,c=s,u=this.left,d=this.top,h=this.right,p=this.bottom;return h>n&&(l=-h+n+r,h=n),p>t&&(c=-p+t+s,p=t),u<1&&(c=2-u,u=1),d<1&&(c=2-d,d=1),{dy:o,edy:c,dx:i,edx:l,y:d,ey:p,x:u,ex:h,w:r,h:s}},e.prototype.calibrate=function(t){return new e({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},e}(),Ed=function(e){Fe(t,e);function t(n,r,s,i,o){return o===void 0&&(o=!1),e.call(this,{left:n,top:r,right:s,bottom:i},o)||this}return t}(ls),Mj=function(){function e(t,n,r,s,i){this._imageDims=new Mi(i.width,i.height),this._score=t,this._classScore=n,this._className=r,this._box=new ls(s).rescale(this._imageDims)}return Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativeBox",{get:function(){return new ls(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new e(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:n})},e}(),Qr=function(e){Fe(t,e);function t(n,r,s){return e.call(this,n,n,"",r,s)||this}return t.prototype.forSize=function(n,r){var s=e.prototype.forSize.call(this,n,r),i=s.score,o=s.relativeBox,l=s.imageDims;return new t(i,o,l)},t}(Mj);function HP(e,t,n){n===void 0&&(n=!0);var r=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),s=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),i=r*s;return n?i/(e.area+t.area-i):i/Math.min(e.area,t.area)}function qP(e){var t=e.map(function(l){return l.x}),n=e.map(function(l){return l.y}),r=t.reduce(function(l,c){return c<l?c:l},1/0),s=n.reduce(function(l,c){return c<l?c:l},1/0),i=t.reduce(function(l,c){return l<c?c:l},0),o=n.reduce(function(l,c){return l<c?c:l},0);return new Ed(r,s,i,o)}function xl(e,t,n,r){r===void 0&&(r=!0);for(var s=t.map(function(l,c){return{score:l,boxIndex:c}}).sort(function(l,c){return l.score-c.score}).map(function(l){return l.boxIndex}),i=[],o=function(){var l=s.pop();i.push(l);for(var c=s,u=[],d=0;d<c.length;d++){var h=c[d],p=e[l],f=e[h];u.push(HP(p,f,r))}s=s.filter(function(x,v){return u[v]<=n})};s.length>0;)o();return i}function Ml(e,t){return me(function(){var n=t[0],r=t[1],s=t[2],i=Vr(Uo(e.shape.slice(0,3),[1]),n),o=Vr(Uo(e.shape.slice(0,3),[1]),r),l=Vr(Uo(e.shape.slice(0,3),[1]),s),c=Ot([i,o,l],3);return zt(e,c)})}function GP(e,t){return t===void 0&&(t=!1),me(function(){var n=e.shape.slice(1),r=n[0],s=n[1];if(r===s)return e;var i=Math.abs(r-s),o=Math.round(i*(t?.5:1)),l=r>s?2:1,c=function(f){var x=e.shape.slice();return x[l]=f,Vr(x,0)},u=c(o),d=i-u.shape[l],h=t&&d?c(d):null,p=[h,e,u].filter(function(f){return!!f}).map(function(f){return f.toFloat()});return Ot(p,l)})}function Lh(e){return 1/(1+Math.exp(-e))}var lx=function(e){Fe(t,e);function t(n,r,s,i,o){return o===void 0&&(o=!1),e.call(this,{x:n,y:r,width:s,height:i},o)||this}return t}(ls),KP=.5,XP=.43,YP=.45,Ou=function(){function e(t,n,r){r===void 0&&(r=new Je(0,0));var s=n.width,i=n.height;this._imgDims=new Mi(s,i),this._shift=r,this._positions=t.map(function(o){return o.mul(new Je(s,i)).add(r)})}return Object.defineProperty(e.prototype,"shift",{get:function(){return new Je(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map(function(n){return n.sub(t._shift).div(new Je(t.imageWidth,t.imageHeight))})},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new this.constructor(this.relativePositions,{width:t,height:n})},e.prototype.shiftBy=function(t,n){return new this.constructor(this.relativePositions,this._imgDims,new Je(t,n))},e.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},e.prototype.align=function(t,n){if(n===void 0&&(n={}),t){var r=t instanceof Qr?t.box.floor():new ls(t);return this.shiftBy(r.x,r.y).align(null,n)}var s=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},n),i=s.useDlibAlignment,o=s.minBoxPadding;return i?this.alignDlib():this.alignMinBbox(o)},e.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),n=t[0],r=t[1],s=t[2],i=function(h){return s.sub(h).magnitude()},o=(i(n)+i(r))/2,l=Math.floor(o/YP),c=ox(t),u=Math.floor(Math.max(0,c.x-KP*l)),d=Math.floor(Math.max(0,c.y-XP*l));return new lx(u,d,Math.min(l,this.imageWidth+u),Math.min(l,this.imageHeight+d))},e.prototype.alignMinBbox=function(t){var n=qP(this.positions);return n.pad(n.width*t,n.height*t)},e.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},e}(),QP=function(e){Fe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getRefPointsForAlignment=function(){var n=this.positions;return[n[0],n[1],ox([n[3],n[4]])]},t}(Ou),JP=function(e){Fe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(ox)},t}(Ou),Sb=function(){function e(t,n){this._label=t,this._distance=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),e.prototype.toString=function(t){return t===void 0&&(t=!0),""+this.label+(t?" ("+WP(this.distance)+")":"")},e}(),Eb=function(e){Fe(t,e);function t(n,r){var s=e.call(this,n)||this;return s._label=r,s}return t.assertIsValidLabeledBox=function(n,r){if(ls.assertIsValidBox(n,r),!Ms(n.label))throw new Error(r+" - expected property label ("+n.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(ls),xc=function(){function e(t,n){if(typeof t!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(n)||n.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(t){return Array.from(t)})}},e.fromJSON=function(t){var n=t.descriptors.map(function(r){return new Float32Array(r)});return new e(t.label,n)},e}();(function(e){Fe(t,e);function t(n,r,s,i){var o=e.call(this,n,r)||this;return o._score=s,o._classScore=i,o}return t.assertIsValidPredictedBox=function(n,r){if(Eb.assertIsValidLabeledBox(n,r),!kb(n.score)||!kb(n.classScore))throw new Error(r+" - expected properties score ("+n.score+") and ("+n.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),t})(Eb);function ZP(e){return e.detection instanceof Qr}function cx(e,t){var n={detection:t};return Object.assign({},e,n)}function Lj(){var e=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},t=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:e,readFile:t}}function Oj(e){var t="";if(!e)try{e=require("fs")}catch(r){t=r.toString()}var n=e?function(r){return new Promise(function(s,i){e.readFile(r,function(o,l){return o?i(o):s(l)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)};return{readFile:n}}function Bj(){var e=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,n=function(){if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},r=function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},s=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=Oj();return ln({Canvas:e||function(){function o(){}return o}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function o(){}return o}(),Image:t||function(){function o(){}return o}(),ImageData:global.ImageData||function(){function o(){}return o}(),Video:global.HTMLVideoElement||function(){function o(){}return o}(),createCanvasElement:n,createImageElement:r,fetch:s},i)}function $j(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function zj(){return typeof global=="object"&&typeof require=="function"&&typeof yC<"u"&&typeof process<"u"&&!!process.version}var Pt;function eF(){if(!Pt)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return Pt}function mf(e){Pt=e}function ux(){$j()&&mf(Lj()),zj()&&mf(Bj())}function tF(e){if(Pt||ux(),!Pt)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=e.Canvas,n=t===void 0?Pt.Canvas:t,r=e.Image,s=r===void 0?Pt.Image:r;Pt.Canvas=n,Pt.Image=s,Pt.createCanvasElement=e.createCanvasElement||function(){return new n},Pt.createImageElement=e.createImageElement||function(){return new s},Pt.ImageData=e.ImageData||Pt.ImageData,Pt.Video=e.Video||Pt.Video,Pt.fetch=e.fetch||Pt.fetch,Pt.readFile=e.readFile||Pt.readFile}var fn={getEnv:eF,setEnv:mf,initialize:ux,createBrowserEnv:Lj,createFileSystem:Oj,createNodejsEnv:Bj,monkeyPatch:tF,isBrowser:$j,isNodejs:zj};ux();function Uj(e){return!fn.isNodejs()&&typeof e=="string"?document.getElementById(e):e}function qs(e){var t=fn.getEnv(),n=t.Canvas,r=t.CanvasRenderingContext2D;if(e instanceof r)return e;var s=Uj(e);if(!(s instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=s.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}var Db;(function(e){e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT"})(Db||(Db={}));function Wj(e){var t=fn.getEnv(),n=t.Image,r=t.Video;return e instanceof n&&e.complete||e instanceof r&&e.readyState>=3}function nF(e){return new Promise(function(t,n){if(e instanceof fn.getEnv().Canvas||Wj(e))return t();function r(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",s),t(i))}function s(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",s),n(i))}e.addEventListener("load",r),e.addEventListener("error",s)})}function Vj(e){var t=fn.getEnv(),n=t.Image,r=t.Video;return e instanceof n?new Mi(e.naturalWidth,e.naturalHeight):e instanceof r?new Mi(e.videoWidth,e.videoHeight):new Mi(e.width,e.height)}function Dd(e){var t=e.width,n=e.height,r=fn.getEnv().createCanvasElement,s=r();return s.width=t,s.height=n,s}function dx(e,t){var n=fn.getEnv().ImageData;if(!(e instanceof n)&&!Wj(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=Vj(e),s=r.width,i=r.height,o=Dd({width:s,height:i});return e instanceof n?qs(o).putImageData(e,0,0):qs(o).drawImage(e,0,0,s,i),o}function rF(e,t){return Se(this,void 0,void 0,function(){var n,r,s,i,o,l;return Ee(this,function(c){switch(c.label){case 0:return n=fn.getEnv().createCanvasElement(),r=e.shape.slice(ts(e)?1:0),s=r[0],i=r[1],o=r[2],l=me(function(){return e.as3D(s,i,o).toInt()}),[4,ix.toPixels(l,n)];case 1:return c.sent(),l.dispose(),[2,n]}})})}function Rb(e){var t=fn.getEnv(),n=t.Image,r=t.Canvas,s=t.Video;return e instanceof n||e instanceof r||e instanceof s}function aF(e,t,n){n===void 0&&(n=!1);var r=fn.getEnv(),s=r.Image,i=r.Canvas;if(!(e instanceof s||e instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var o=Vj(e),l=t/Math.max(o.height,o.width),c=l*o.width,u=l*o.height,d=Dd({width:t,height:t}),h=e instanceof i?e:dx(e),p=Math.abs(c-u)/2,f=n&&c<u?p:0,x=n&&u<c?p:0;return qs(d).drawImage(h,f,x,c,u),d}var Bu=function(){function e(t,n){var r=this;if(n===void 0&&(n=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=n,this._batchSize=t.length,t.forEach(function(s,i){if(Sd(s)){r._imageTensors[i]=s,r._inputDimensions[i]=s.shape;return}if(ts(s)){var o=s.shape[0];if(o!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+o+" passed, but not supported in input array");r._imageTensors[i]=s,r._inputDimensions[i]=s.shape.slice(1);return}var l=s instanceof fn.getEnv().Canvas?s:dx(s);r._canvases[i]=l,r._inputDimensions[i]=[l.height,l.width,3]})}return Object.defineProperty(e.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reshapedInputDimensions",{get:function(){var t=this;return ml(this.batchSize,0,1).map(function(n,r){return t.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),e.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},e.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},e.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},e.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},e.prototype.getReshapedInputDimensions=function(t){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var n=this.getInputWidth(t),r=this.getInputHeight(t);return VP({width:n,height:r},this.inputSize)},e.prototype.toBatchTensor=function(t,n){var r=this;return n===void 0&&(n=!0),this._inputSize=t,me(function(){var s=ml(r.batchSize,0,1).map(function(o){var l=r.getInput(o);if(l instanceof xt){var c=ts(l)?l:l.expandDims();return c=GP(c,n),(c.shape[1]!==t||c.shape[2]!==t)&&(c=ex.resizeBilinear(c,[t,t])),c.as3D(t,t,3)}if(l instanceof fn.getEnv().Canvas)return ix.fromPixels(aF(l,t,n));throw new Error("toBatchTensor - at batchIdx "+o+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+l)}),i=Vn(s.map(function(o){return o.toFloat()})).as4D(r.batchSize,t,t,3);return i})},e}();function Yt(e){return Se(this,void 0,void 0,function(){var t,n,r;return Ee(this,function(s){switch(s.label){case 0:if(e instanceof Bu)return[2,e];if(t=Array.isArray(e)?e:[e],!t.length)throw new Error("toNetInput - empty array passed as input");return n=function(i){return Array.isArray(e)?" at input index "+i+":":""},r=t.map(Uj),r.forEach(function(i,o){if(!Rb(i)&&!Sd(i)&&!ts(i))throw typeof t[o]=="string"?new Error("toNetInput -"+n(o)+" string passed, but could not resolve HTMLElement for element id "+t[o]):new Error("toNetInput -"+n(o)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(ts(i)){var l=i.shape[0];if(l!==1)throw new Error("toNetInput -"+n(o)+" tf.Tensor4D with batchSize "+l+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(i){return Rb(i)&&nF(i)}))];case 1:return s.sent(),[2,new Bu(r,Array.isArray(e))]}})})}function hx(e,t){return Se(this,void 0,void 0,function(){var n,r,s,i,o,l,c;return Ee(this,function(u){switch(u.label){case 0:return n=fn.getEnv().Canvas,r=e,e instanceof n?[3,5]:[4,Yt(e)];case 1:if(s=u.sent(),s.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return i=s.getInput(0),i instanceof n?(o=i,[3,4]):[3,2];case 2:return[4,rF(i)];case 3:o=u.sent(),u.label=4;case 4:r=o,u.label=5;case 5:return l=qs(r),c=t.map(function(d){return d instanceof Qr?d.forSize(r.width,r.height).box.floor():d}).map(function(d){return d.clipAtImageBorders(r.width,r.height)}),[2,c.map(function(d){var h=d.x,p=d.y,f=d.width,x=d.height,v=Dd({width:f,height:x});return qs(v).putImageData(l.getImageData(h,p,f,x),0,0),v})]}})})}function px(e,t){return Se(this,void 0,void 0,function(){return Ee(this,function(n){if(!Sd(e)&&!ts(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(ts(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,me(function(){var r=e.shape.slice(ts(e)?1:0),s=r[0],i=r[1],o=r[2],l=t.map(function(u){return u instanceof Qr?u.forSize(i,s).box:u}).map(function(u){return u.clipAtImageBorders(i,s)}),c=l.map(function(u){var d=u.x,h=u.y,p=u.width,f=u.height;return gj(e.as3D(s,i,o),[h,d,0],[f,p,o])});return c})]})})}function sF(e,t){return Se(this,void 0,void 0,function(){var n,r;return Ee(this,function(s){switch(s.label){case 0:return n=fn.getEnv().fetch,[4,n(e,t)];case 1:if(r=s.sent(),!(r.status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function iF(e){return Se(this,void 0,void 0,function(){return Ee(this,function(t){switch(t.label){case 0:return[4,sF(e)];case 1:return[2,t.sent().json()]}})})}function Hj(e,t){var n=t+"-weights_manifest.json";if(!e)return{modelBaseUri:"",manifestUri:n};if(e==="/")return{modelBaseUri:"/",manifestUri:"/"+n};var r=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"";e=e.replace(r,"");var s=e.split("/").filter(function(l){return l}),i=e.endsWith(".json")?s[s.length-1]:n,o=r+(e.endsWith(".json")?s.slice(0,s.length-1):s).join("/");return o=e.startsWith("/")?"/"+o:o,{modelBaseUri:o,manifestUri:o==="/"?"/"+i:o+"/"+i}}function oF(e,t){return Se(this,void 0,void 0,function(){var n,r,s,i;return Ee(this,function(o){switch(o.label){case 0:return n=Hj(e,t),r=n.manifestUri,s=n.modelBaseUri,[4,iF(r)];case 1:return i=o.sent(),[2,Pj.loadWeights(i,s)]}})})}var ka=function(){function e(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(e.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),e.prototype.getParamFromPath=function(t){var n=this.traversePropertyPath(t),r=n.obj,s=n.objProp;return r[s]},e.prototype.reassignParamFromPath=function(t,n){var r=this.traversePropertyPath(t),s=r.obj,i=r.objProp;s[i].dispose(),s[i]=n},e.prototype.getParamList=function(){var t=this;return this._paramMappings.map(function(n){var r=n.paramPath;return{path:r,tensor:t.getParamFromPath(r)}})},e.prototype.getTrainableParams=function(){return this.getParamList().filter(function(t){return t.tensor instanceof Ji})},e.prototype.getFrozenParams=function(){return this.getParamList().filter(function(t){return!(t.tensor instanceof Ji)})},e.prototype.variable=function(){var t=this;this.getFrozenParams().forEach(function(n){var r=n.path,s=n.tensor;t.reassignParamFromPath(r,s.variable())})},e.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach(function(n){var r=n.path,s=n.tensor,i=en(s.dataSync());s.dispose(),t.reassignParamFromPath(r,i)})},e.prototype.dispose=function(t){t===void 0&&(t=!0),this.getParamList().forEach(function(n){if(t&&n.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+n.path);n.tensor.dispose()}),this._params=void 0},e.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(t){var n=t.tensor;return Array.from(n.dataSync())}).reduce(function(t,n){return t.concat(n)}))},e.prototype.load=function(t){return Se(this,void 0,void 0,function(){return Ee(this,function(n){switch(n.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return n.sent(),[2]}})})},e.prototype.loadFromUri=function(t){return Se(this,void 0,void 0,function(){var n;return Ee(this,function(r){switch(r.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,oF(t,this.getDefaultModelName())];case 1:return n=r.sent(),this.loadFromWeightMap(n),[2]}})})},e.prototype.loadFromDisk=function(t){return Se(this,void 0,void 0,function(){var n,r,s,i,o,l,c,u,d,h;return Ee(this,function(p){switch(p.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return n=fn.getEnv().readFile,r=Hj(t,this.getDefaultModelName()),s=r.manifestUri,i=r.modelBaseUri,o=function(f){return Promise.all(f.map(function(x){return n(x).then(function(v){return v.buffer})}))},l=Pj.weightsLoaderFactory(o),d=(u=JSON).parse,[4,n(s)];case 1:return c=d.apply(u,[p.sent().toString()]),[4,l(c,i)];case 2:return h=p.sent(),this.loadFromWeightMap(h),[2]}})})},e.prototype.loadFromWeightMap=function(t){var n=this.extractParamsFromWeigthMap(t),r=n.paramMappings,s=n.params;this._paramMappings=r,this._params=s},e.prototype.extractWeights=function(t){var n=this.extractParams(t),r=n.paramMappings,s=n.params;this._paramMappings=r,this._params=s},e.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var n=t.split("/").reduce(function(i,o){if(!i.nextObj.hasOwnProperty(o))throw new Error("traversePropertyPath - object does not have property "+o+", for path "+t);return{obj:i.nextObj,objProp:o,nextObj:i.nextObj[o]}},{nextObj:this.params}),r=n.obj,s=n.objProp;if(!r||!s||!(r[s]instanceof xt))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:r,objProp:s}},e}();function Un(e,t,n){return me(function(){var r=Xm(e,t.depthwise_filter,t.pointwise_filter,n,"same");return r=Ve(r,t.bias),r})}function Oh(e,t,n){return n===void 0&&(n=!1),me(function(){var r=gt(n?Ve(ur(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):Un(e,t.conv0,[2,2])),s=Un(r,t.conv1,[1,1]),i=gt(Ve(r,s)),o=Un(i,t.conv2,[1,1]);return gt(Ve(r,Ve(s,o)))})}function gc(e,t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!0),me(function(){var s=gt(n?Ve(ur(e,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):Un(e,t.conv0,r?[2,2]:[1,1])),i=Un(s,t.conv1,[1,1]),o=gt(Ve(s,i)),l=Un(o,t.conv2,[1,1]),c=gt(Ve(s,Ve(i,l))),u=Un(c,t.conv3,[1,1]);return gt(Ve(s,Ve(i,Ve(l,u))))})}function br(e,t,n,r){return n===void 0&&(n="same"),r===void 0&&(r=!1),me(function(){var s=Ve(ur(e,t.filters,[1,1],n),t.bias);return r?gt(s):s})}function Sa(e,t){Object.keys(e).forEach(function(n){t.some(function(r){return r.originalPath===n})||e[n].dispose()})}function Rd(e,t){return function(n,r,s,i){var o=jn(e(n*r*s*s),[s,s,n,r]),l=Tt(e(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:o,bias:l}}}function fx(e,t){return function(n,r,s){var i=Za(e(n*r),[n,r]),o=Tt(e(r));return t.push({paramPath:s+"/weights"},{paramPath:s+"/bias"}),{weights:i,bias:o}}}var qj=function(){function e(t,n,r){this.depthwise_filter=t,this.pointwise_filter=n,this.bias=r}return e}();function mx(e,t){return function(n,r,s){var i=jn(e(9*n),[3,3,n,1]),o=jn(e(n*r),[1,1,n,r]),l=Tt(e(r));return t.push({paramPath:s+"/depthwise_filter"},{paramPath:s+"/pointwise_filter"},{paramPath:s+"/bias"}),new qj(i,o,l)}}function xx(e){return function(t){var n=e(t+"/depthwise_filter",4),r=e(t+"/pointwise_filter",4),s=e(t+"/bias",1);return new qj(n,r,s)}}function gs(e,t){return function(n,r,s){var i=e[n];if(!kd(i,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+i);return t.push({originalPath:n,paramPath:s||n}),i}}function Ea(e){var t=e;function n(s){var i=t.slice(0,s);return t=t.slice(s),i}function r(){return t}return{extractWeights:n,getRemainingWeights:r}}function Gj(e,t){var n=Rd(e,t),r=mx(e,t);function s(o,l,c,u){u===void 0&&(u=!1);var d=u?n(o,l,3,c+"/conv0"):r(o,l,c+"/conv0"),h=r(l,l,c+"/conv1"),p=r(l,l,c+"/conv2");return{conv0:d,conv1:h,conv2:p}}function i(o,l,c,u){u===void 0&&(u=!1);var d=s(o,l,c,u),h=d.conv0,p=d.conv1,f=d.conv2,x=r(l,l,c+"/conv3");return{conv0:h,conv1:p,conv2:f,conv3:x}}return{extractDenseBlock3Params:s,extractDenseBlock4Params:i}}function lF(e){var t=[],n=Ea(e),r=n.extractWeights,s=n.getRemainingWeights,i=Gj(r,t).extractDenseBlock4Params,o=i(3,32,"dense0",!0),l=i(32,64,"dense1"),c=i(64,128,"dense2"),u=i(128,256,"dense3");if(s().length!==0)throw new Error("weights remaing after extract: "+s().length);return{paramMappings:t,params:{dense0:o,dense1:l,dense2:c,dense3:u}}}function Kj(e){return function(t){var n=e(t+"/filters",4),r=e(t+"/bias",1);return{filters:n,bias:r}}}function Xj(e,t){var n=gs(e,t),r=Kj(n),s=xx(n);function i(l,c){c===void 0&&(c=!1);var u=c?r(l+"/conv0"):s(l+"/conv0"),d=s(l+"/conv1"),h=s(l+"/conv2");return{conv0:u,conv1:d,conv2:h}}function o(l,c){c===void 0&&(c=!1);var u=c?r(l+"/conv0"):s(l+"/conv0"),d=s(l+"/conv1"),h=s(l+"/conv2"),p=s(l+"/conv3");return{conv0:u,conv1:d,conv2:h,conv3:p}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:o}}function cF(e){var t=[],n=Xj(e,t).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return Sa(e,t),{params:r,paramMappings:t}}var Yj=function(e){Fe(t,e);function t(){return e.call(this,"FaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return me(function(){var s=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],o=Ml(s,i).div(fe(255)),l=gc(o,r.dense0,!0);return l=gc(l,r.dense1),l=gc(l,r.dense2),l=gc(l,r.dense3),l=Pl(l,[7,7],[2,2],"valid"),l})},t.prototype.forward=function(n){return Se(this,void 0,void 0,function(){var r;return Ee(this,function(s){switch(s.label){case 0:return r=this.forwardInput,[4,Yt(n)];case 1:return[2,r.apply(this,[s.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(n){return cF(n)},t.prototype.extractParams=function(n){return lF(n)},t}(ka);function Br(e,t){return me(function(){return Ve(Nd(e,t.weights),t.bias)})}function uF(e,t,n){var r=[],s=Ea(e),i=s.extractWeights,o=s.getRemainingWeights,l=fx(i,r),c=l(t,n,"fc");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:r,params:{fc:c}}}function dF(e){var t=[],n=gs(e,t);function r(i){var o=n(i+"/weights",2),l=n(i+"/bias",1);return{weights:o,bias:l}}var s={fc:r("fc")};return Sa(e,t),{params:s,paramMappings:t}}function Qj(e){var t={},n={};return Object.keys(e).forEach(function(r){var s=r.startsWith("fc")?n:t;s[r]=e[r]}),{featureExtractorMap:t,classifierMap:n}}var Jj=function(e){Fe(t,e);function t(n,r){var s=e.call(this,n)||this;return s._faceFeatureExtractor=r,s}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var r=this,s=this.params;if(!s)throw new Error(this._name+" - load model before inference");return me(function(){var i=n instanceof Bu?r.faceFeatureExtractor.forwardInput(n):n;return Br(i.as2D(i.shape[0],-1),s.fc)})},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),s=r.params,i=r.paramMappings;this._params=s,this._paramMappings=i},t.prototype.extractClassifierParams=function(n){return uF(n,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(n){var r=Qj(n),s=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(s),dF(i)},t.prototype.extractParams=function(n){var r=this.getClassifierChannelsIn(),s=this.getClassifierChannelsOut(),i=s*r+s,o=n.slice(0,n.length-i),l=n.slice(n.length-i);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(l)},t}(ka),_b=["neutral","happy","sad","angry","fearful","disgusted","surprised"],hF=function(){function e(t){var n=this;if(t.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);_b.forEach(function(r,s){n[r]=t[s]})}return e.prototype.asSortedArray=function(){var t=this;return _b.map(function(n){return{expression:n,probability:t[n]}}).sort(function(n,r){return r.probability-n.probability})},e}(),pF=function(e){Fe(t,e);function t(n){return n===void 0&&(n=new Yj),e.call(this,"FaceExpressionNet",n)||this}return t.prototype.forwardInput=function(n){var r=this;return me(function(){return ja(r.runNet(n))})},t.prototype.forward=function(n){return Se(this,void 0,void 0,function(){var r;return Ee(this,function(s){switch(s.label){case 0:return r=this.forwardInput,[4,Yt(n)];case 1:return[2,r.apply(this,[s.sent()])]}})})},t.prototype.predictExpressions=function(n){return Se(this,void 0,void 0,function(){var r,s,i,o,l=this;return Ee(this,function(c){switch(c.label){case 0:return[4,Yt(n)];case 1:return r=c.sent(),[4,this.forwardInput(r)];case 2:return s=c.sent(),[4,Promise.all(Bt(s).map(function(u){return Se(l,void 0,void 0,function(){var d;return Ee(this,function(h){switch(h.label){case 0:return[4,u.data()];case 1:return d=h.sent(),u.dispose(),[2,d]}})})}))];case 3:return i=c.sent(),s.dispose(),o=i.map(function(u){return new hF(u)}),[2,r.isBatchInput?o:o[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(Jj);function Zj(e,t){var n={expressions:t};return Object.assign({},e,n)}function fF(e){return ZP(e)&&e.landmarks instanceof Ou&&e.unshiftedLandmarks instanceof Ou&&e.alignedRect instanceof Qr}function gx(e,t){var n=e.detection.box,r=t.shiftBy(n.x,n.y),s=r.align(),i=e.detection.imageDims,o=new Qr(e.detection.score,s.rescale(i.reverse()),i),l={landmarks:r,unshiftedLandmarks:t,alignedRect:o};return Object.assign({},e,l)}function mF(e,t){var n=Rd(e,t),r=mx(e,t);function s(o,l,c){var u=r(o,l,c+"/separable_conv0"),d=r(l,l,c+"/separable_conv1"),h=n(o,l,1,c+"/expansion_conv");return{separable_conv0:u,separable_conv1:d,expansion_conv:h}}function i(o,l){var c=r(o,o,l+"/separable_conv0"),u=r(o,o,l+"/separable_conv1"),d=r(o,o,l+"/separable_conv2");return{separable_conv0:c,separable_conv1:u,separable_conv2:d}}return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:s,extractMainBlockParams:i}}function xF(e,t){var n=[],r=Ea(e),s=r.extractWeights,i=r.getRemainingWeights,o=mF(s,n),l=o.extractConvParams,c=o.extractSeparableConvParams,u=o.extractReductionBlockParams,d=o.extractMainBlockParams,h=l(3,32,3,"entry_flow/conv_in"),p=u(32,64,"entry_flow/reduction_block_0"),f=u(64,128,"entry_flow/reduction_block_1"),x={conv_in:h,reduction_block_0:p,reduction_block_1:f},v={};ml(t,0,1).forEach(function(b){v["main_block_"+b]=d(128,"middle_flow/main_block_"+b)});var y=u(128,256,"exit_flow/reduction_block"),m=c(256,512,"exit_flow/separable_conv"),g={reduction_block:y,separable_conv:m};if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:n,params:{entry_flow:x,middle_flow:v,exit_flow:g}}}function gF(e,t){var n=gs(e,t),r=Kj(n),s=xx(n);function i(l){var c=s(l+"/separable_conv0"),u=s(l+"/separable_conv1"),d=r(l+"/expansion_conv");return{separable_conv0:c,separable_conv1:u,expansion_conv:d}}function o(l){var c=s(l+"/separable_conv0"),u=s(l+"/separable_conv1"),d=s(l+"/separable_conv2");return{separable_conv0:c,separable_conv1:u,separable_conv2:d}}return{extractConvParams:r,extractSeparableConvParams:s,extractReductionBlockParams:i,extractMainBlockParams:o}}function vF(e,t){var n=[],r=gF(e,n),s=r.extractConvParams,i=r.extractSeparableConvParams,o=r.extractReductionBlockParams,l=r.extractMainBlockParams,c=s("entry_flow/conv_in"),u=o("entry_flow/reduction_block_0"),d=o("entry_flow/reduction_block_1"),h={conv_in:c,reduction_block_0:u,reduction_block_1:d},p={};ml(t,0,1).forEach(function(y){p["main_block_"+y]=l("middle_flow/main_block_"+y)});var f=o("exit_flow/reduction_block"),x=i("exit_flow/separable_conv"),v={reduction_block:f,separable_conv:x};return Sa(e,n),{params:{entry_flow:h,middle_flow:p,exit_flow:v},paramMappings:n}}function eC(e,t,n){return Ve(ur(e,t.filters,n,"same"),t.bias)}function Bh(e,t,n){n===void 0&&(n=!0);var r=n?gt(e):e;return r=Un(r,t.separable_conv0,[1,1]),r=Un(gt(r),t.separable_conv1,[1,1]),r=Vt(r,[3,3],[2,2],"same"),r=Ve(r,eC(e,t.expansion_conv,[2,2])),r}function yF(e,t){var n=Un(gt(e),t.separable_conv0,[1,1]);return n=Un(gt(n),t.separable_conv1,[1,1]),n=Un(gt(n),t.separable_conv2,[1,1]),n=Ve(n,e),n}var bF=function(e){Fe(t,e);function t(n){var r=e.call(this,"TinyXception")||this;return r._numMainBlocks=n,r}return t.prototype.forwardInput=function(n){var r=this,s=this.params;if(!s)throw new Error("TinyXception - load model before inference");return me(function(){var i=n.toBatchTensor(112,!0),o=[122.782,117.001,104.298],l=Ml(i,o).div(fe(256)),c=gt(eC(l,s.entry_flow.conv_in,[2,2]));return c=Bh(c,s.entry_flow.reduction_block_0,!1),c=Bh(c,s.entry_flow.reduction_block_1),ml(r._numMainBlocks,0,1).forEach(function(u){c=yF(c,s.middle_flow["main_block_"+u])}),c=Bh(c,s.exit_flow.reduction_block),c=gt(Un(c,s.exit_flow.separable_conv,[1,1])),c})},t.prototype.forward=function(n){return Se(this,void 0,void 0,function(){var r;return Ee(this,function(s){switch(s.label){case 0:return r=this.forwardInput,[4,Yt(n)];case 1:return[2,r.apply(this,[s.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(n){return vF(n,this._numMainBlocks)},t.prototype.extractParams=function(n){return xF(n,this._numMainBlocks)},t}(ka);function wF(e){var t=[],n=Ea(e),r=n.extractWeights,s=n.getRemainingWeights,i=fx(r,t),o=i(512,1,"fc/age"),l=i(512,2,"fc/gender");if(s().length!==0)throw new Error("weights remaing after extract: "+s().length);return{paramMappings:t,params:{fc:{age:o,gender:l}}}}function NF(e){var t=[],n=gs(e,t);function r(i){var o=n(i+"/weights",2),l=n(i+"/bias",1);return{weights:o,bias:l}}var s={fc:{age:r("fc/age"),gender:r("fc/gender")}};return Sa(e,t),{params:s,paramMappings:t}}var $u;(function(e){e.FEMALE="female",e.MALE="male"})($u||($u={}));var jF=function(e){Fe(t,e);function t(n){n===void 0&&(n=new bF(2));var r=e.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=n,r}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var r=this,s=this.params;if(!s)throw new Error(this._name+" - load model before inference");return me(function(){var i=n instanceof Bu?r.faceFeatureExtractor.forwardInput(n):n,o=Pl(i,[7,7],[2,2],"valid").as2D(i.shape[0],-1),l=Br(o,s.fc.age).as1D(),c=Br(o,s.fc.gender);return{age:l,gender:c}})},t.prototype.forwardInput=function(n){var r=this;return me(function(){var s=r.runNet(n),i=s.age,o=s.gender;return{age:i,gender:ja(o)}})},t.prototype.forward=function(n){return Se(this,void 0,void 0,function(){var r;return Ee(this,function(s){switch(s.label){case 0:return r=this.forwardInput,[4,Yt(n)];case 1:return[2,r.apply(this,[s.sent()])]}})})},t.prototype.predictAgeAndGender=function(n){return Se(this,void 0,void 0,function(){var r,s,i,o,l,c,u=this;return Ee(this,function(d){switch(d.label){case 0:return[4,Yt(n)];case 1:return r=d.sent(),[4,this.forwardInput(r)];case 2:return s=d.sent(),i=Bt(s.age),o=Bt(s.gender),l=i.map(function(h,p){return{ageTensor:h,genderTensor:o[p]}}),[4,Promise.all(l.map(function(h){var p=h.ageTensor,f=h.genderTensor;return Se(u,void 0,void 0,function(){var x,v,y,m,g;return Ee(this,function(b){switch(b.label){case 0:return[4,p.data()];case 1:return x=b.sent()[0],[4,f.data()];case 2:return v=b.sent()[0],y=v>.5,m=y?$u.MALE:$u.FEMALE,g=y?v:1-v,p.dispose(),f.dispose(),[2,{age:x,gender:m,genderProbability:g}]}})})}))];case 3:return c=d.sent(),s.age.dispose(),s.gender.dispose(),[2,r.isBatchInput?c:c[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),s=r.params,i=r.paramMappings;this._params=s,this._paramMappings=i},t.prototype.extractClassifierParams=function(n){return wF(n)},t.prototype.extractParamsFromWeigthMap=function(n){var r=Qj(n),s=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(s),NF(i)},t.prototype.extractParams=function(n){var r=1539,s=n.slice(0,n.length-r),i=n.slice(n.length-r);return this.faceFeatureExtractor.extractWeights(s),this.extractClassifierParams(i)},t}(ka),tC=function(e){Fe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.postProcess=function(n,r,s){var i=s.map(function(l){var c=l.width,u=l.height,d=r/Math.max(u,c);return{width:c*d,height:u*d}}),o=i.length;return me(function(){var l=function(p,f){return Vn([Vr([68],p),Vr([68],f)],1).as2D(1,136).as1D()},c=function(p,f){var x=i[p],v=x.width,y=x.height;return f(v,y)?Math.abs(v-y)/2:0},u=function(p){return c(p,function(f,x){return f<x})},d=function(p){return c(p,function(f,x){return x<f})},h=n.mul(Vr([o,136],r)).sub(Vn(Array.from(Array(o),function(p,f){return l(u(f),d(f))}))).div(Vn(Array.from(Array(o),function(p,f){return l(i[f].width,i[f].height)})));return h})},t.prototype.forwardInput=function(n){var r=this;return me(function(){var s=r.runNet(n);return r.postProcess(s,n.inputSize,n.inputDimensions.map(function(i){var o=i[0],l=i[1];return{height:o,width:l}}))})},t.prototype.forward=function(n){return Se(this,void 0,void 0,function(){var r;return Ee(this,function(s){switch(s.label){case 0:return r=this.forwardInput,[4,Yt(n)];case 1:return[2,r.apply(this,[s.sent()])]}})})},t.prototype.detectLandmarks=function(n){return Se(this,void 0,void 0,function(){var r,s,i,o=this;return Ee(this,function(l){switch(l.label){case 0:return[4,Yt(n)];case 1:return r=l.sent(),s=me(function(){return Bt(o.forwardInput(r))}),[4,Promise.all(s.map(function(c,u){return Se(o,void 0,void 0,function(){var d,h,p,f,x;return Ee(this,function(v){switch(v.label){case 0:return p=(h=Array).from,[4,c.data()];case 1:return d=p.apply(h,[v.sent()]),f=d.filter(function(y,m){return jb(m)}),x=d.filter(function(y,m){return!jb(m)}),[2,new JP(Array(68).fill(0).map(function(y,m){return new Je(f[m],x[m])}),{height:r.getInputHeight(u),width:r.getInputWidth(u)})]}})})}))];case 2:return i=l.sent(),s.forEach(function(c){return c.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t}(Jj),nC=function(e){Fe(t,e);function t(n){return n===void 0&&(n=new Yj),e.call(this,"FaceLandmark68Net",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(tC);function CF(e){var t=[],n=Xj(e,t).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return Sa(e,t),{params:r,paramMappings:t}}function kF(e){var t=[],n=Ea(e),r=n.extractWeights,s=n.getRemainingWeights,i=Gj(r,t).extractDenseBlock3Params,o=i(3,32,"dense0",!0),l=i(32,64,"dense1"),c=i(64,128,"dense2");if(s().length!==0)throw new Error("weights remaing after extract: "+s().length);return{paramMappings:t,params:{dense0:o,dense1:l,dense2:c}}}var SF=function(e){Fe(t,e);function t(){return e.call(this,"TinyFaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return me(function(){var s=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],o=Ml(s,i).div(fe(255)),l=Oh(o,r.dense0,!0);return l=Oh(l,r.dense1),l=Oh(l,r.dense2),l=Pl(l,[14,14],[2,2],"valid"),l})},t.prototype.forward=function(n){return Se(this,void 0,void 0,function(){var r;return Ee(this,function(s){switch(s.label){case 0:return r=this.forwardInput,[4,Yt(n)];case 1:return[2,r.apply(this,[s.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(n){return CF(n)},t.prototype.extractParams=function(n){return kF(n)},t}(ka),EF=function(e){Fe(t,e);function t(n){return n===void 0&&(n=new SF),e.call(this,"FaceLandmark68TinyNet",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(tC);(function(e){Fe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(nC);function DF(e,t){return Ve(hn(e,t.weights),t.biases)}function vx(e,t,n,r,s){s===void 0&&(s="same");var i=t.conv,o=i.filters,l=i.bias,c=ur(e,o,n,s);return c=Ve(c,l),c=DF(c,t.scale),r?gt(c):c}function RF(e,t){return vx(e,t,[1,1],!0)}function rC(e,t){return vx(e,t,[1,1],!1)}function aC(e,t){return vx(e,t,[2,2],!0,"valid")}function _F(e,t){function n(l,c,u){var d=e(l),h=d.length/(c*u*u);if(UP(h))throw new Error("depth has to be an integer: "+h+", weights.length: "+d.length+", numFilters: "+c+", filterSize: "+u);return me(function(){return os(jn(d,[c,h,u,u]),[2,3,1,0])})}function r(l,c,u,d){var h=n(l,c,u),p=Tt(e(c));return t.push({paramPath:d+"/filters"},{paramPath:d+"/bias"}),{filters:h,bias:p}}function s(l,c){var u=Tt(e(l)),d=Tt(e(l));return t.push({paramPath:c+"/weights"},{paramPath:c+"/biases"}),{weights:u,biases:d}}function i(l,c,u,d){var h=r(l,c,u,d+"/conv"),p=s(c,d+"/scale");return{conv:h,scale:p}}function o(l,c,u,d,h){h===void 0&&(h=!1);var p=i((h?.5:1)*l,c,u,d+"/conv1"),f=i(l,c,u,d+"/conv2");return{conv1:p,conv2:f}}return{extractConvLayerParams:i,extractResidualLayerParams:o}}function TF(e){var t=Ea(e),n=t.extractWeights,r=t.getRemainingWeights,s=[],i=_F(n,s),o=i.extractConvLayerParams,l=i.extractResidualLayerParams,c=o(4704,32,7,"conv32_down"),u=l(9216,32,3,"conv32_1"),d=l(9216,32,3,"conv32_2"),h=l(9216,32,3,"conv32_3"),p=l(36864,64,3,"conv64_down",!0),f=l(36864,64,3,"conv64_1"),x=l(36864,64,3,"conv64_2"),v=l(36864,64,3,"conv64_3"),y=l(147456,128,3,"conv128_down",!0),m=l(147456,128,3,"conv128_1"),g=l(147456,128,3,"conv128_2"),b=l(589824,256,3,"conv256_down",!0),w=l(589824,256,3,"conv256_1"),N=l(589824,256,3,"conv256_2"),C=l(589824,256,3,"conv256_down_out"),D=me(function(){return os(Za(n(256*128),[128,256]),[1,0])});if(s.push({paramPath:"fc"}),r().length!==0)throw new Error("weights remaing after extract: "+r().length);var j={conv32_down:c,conv32_1:u,conv32_2:d,conv32_3:h,conv64_down:p,conv64_1:f,conv64_2:x,conv64_3:v,conv128_down:y,conv128_1:m,conv128_2:g,conv256_down:b,conv256_1:w,conv256_2:N,conv256_down_out:C,fc:D};return{params:j,paramMappings:s}}function AF(e,t){var n=gs(e,t);function r(o){var l=n(o+"/scale/weights",1),c=n(o+"/scale/biases",1);return{weights:l,biases:c}}function s(o){var l=n(o+"/conv/filters",4),c=n(o+"/conv/bias",1),u=r(o);return{conv:{filters:l,bias:c},scale:u}}function i(o){return{conv1:s(o+"/conv1"),conv2:s(o+"/conv2")}}return{extractConvLayerParams:s,extractResidualLayerParams:i}}function IF(e){var t=[],n=AF(e,t),r=n.extractConvLayerParams,s=n.extractResidualLayerParams,i=r("conv32_down"),o=s("conv32_1"),l=s("conv32_2"),c=s("conv32_3"),u=s("conv64_down"),d=s("conv64_1"),h=s("conv64_2"),p=s("conv64_3"),f=s("conv128_down"),x=s("conv128_1"),v=s("conv128_2"),y=s("conv256_down"),m=s("conv256_1"),g=s("conv256_2"),b=s("conv256_down_out"),w=e.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!zP(w))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+w);var N={conv32_down:i,conv32_1:o,conv32_2:l,conv32_3:c,conv64_down:u,conv64_1:d,conv64_2:h,conv64_3:p,conv128_down:f,conv128_1:x,conv128_2:v,conv256_down:y,conv256_1:m,conv256_2:g,conv256_down_out:b,fc:w};return Sa(e,t),{params:N,paramMappings:t}}function _r(e,t){var n=RF(e,t.conv1);return n=rC(n,t.conv2),n=Ve(n,e),n=gt(n),n}function vc(e,t){var n=aC(e,t.conv1);n=rC(n,t.conv2);var r=Pl(e,2,2,"valid"),s=ct(r.shape),i=r.shape[3]!==n.shape[3],o=r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2];if(o){var l=Uo(n.shape);l[1]=1;var c=ct(l);n=Ot([n,c],1);var u=Uo(n.shape);u[2]=1;var d=ct(u);n=Ot([n,d],2)}return r=i?Ot([r,s],3):r,n=Ve(r,n),n=gt(n),n}var PF=function(e){Fe(t,e);function t(){return e.call(this,"FaceRecognitionNet")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return me(function(){var s=n.toBatchTensor(150,!0).toFloat(),i=[122.782,117.001,104.298],o=Ml(s,i).div(fe(256)),l=aC(o,r.conv32_down);l=Vt(l,3,2,"valid"),l=_r(l,r.conv32_1),l=_r(l,r.conv32_2),l=_r(l,r.conv32_3),l=vc(l,r.conv64_down),l=_r(l,r.conv64_1),l=_r(l,r.conv64_2),l=_r(l,r.conv64_3),l=vc(l,r.conv128_down),l=_r(l,r.conv128_1),l=_r(l,r.conv128_2),l=vc(l,r.conv256_down),l=_r(l,r.conv256_1),l=_r(l,r.conv256_2),l=vc(l,r.conv256_down_out);var c=l.mean([1,2]),u=Nd(c,r.fc);return u})},t.prototype.forward=function(n){return Se(this,void 0,void 0,function(){var r;return Ee(this,function(s){switch(s.label){case 0:return r=this.forwardInput,[4,Yt(n)];case 1:return[2,r.apply(this,[s.sent()])]}})})},t.prototype.computeFaceDescriptor=function(n){return Se(this,void 0,void 0,function(){var r,s,i,o=this;return Ee(this,function(l){switch(l.label){case 0:return[4,Yt(n)];case 1:return r=l.sent(),s=me(function(){return Bt(o.forwardInput(r))}),[4,Promise.all(s.map(function(c){return c.data()}))];case 2:return i=l.sent(),s.forEach(function(c){return c.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(n){return IF(n)},t.prototype.extractParams=function(n){return TF(n)},t}(ka);function sC(e,t){var n={descriptor:t};return Object.assign({},e,n)}function iC(e,t){var n={age:t};return Object.assign({},e,n)}function oC(e,t,n){var r={gender:t,genderProbability:n};return Object.assign({},e,r)}var lC=function(){function e(t){var n=t===void 0?{}:t,r=n.minFaceSize,s=n.scaleFactor,i=n.maxNumScales,o=n.scoreThresholds,l=n.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=s||.709,this._maxNumScales=i||10,this._scoreThresholds=o||[.6,.7,.7],this._scaleSteps=l,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(c){return typeof c!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(c){return typeof c!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(e.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),e}();function FF(e,t){function n(c,u){var d=jn(e(9*c),[3,3,c,1]),h=Tt(e(c)),p=Tt(e(c)),f=Tt(e(c)),x=Tt(e(c));return t.push({paramPath:u+"/filters"},{paramPath:u+"/batch_norm_scale"},{paramPath:u+"/batch_norm_offset"},{paramPath:u+"/batch_norm_mean"},{paramPath:u+"/batch_norm_variance"}),{filters:d,batch_norm_scale:h,batch_norm_offset:p,batch_norm_mean:f,batch_norm_variance:x}}function r(c,u,d,h,p){var f=jn(e(c*u*d*d),[d,d,c,u]),x=Tt(e(u));return t.push({paramPath:h+"/filters"},{paramPath:h+"/"+(p?"batch_norm_offset":"bias")}),{filters:f,bias:x}}function s(c,u,d,h){var p=r(c,u,d,h,!0),f=p.filters,x=p.bias;return{filters:f,batch_norm_offset:x}}function i(c,u,d){var h=n(c,d+"/depthwise_conv"),p=s(c,u,1,d+"/pointwise_conv");return{depthwise_conv:h,pointwise_conv:p}}function o(){var c=s(3,32,3,"mobilenetv1/conv_0"),u=i(32,64,"mobilenetv1/conv_1"),d=i(64,128,"mobilenetv1/conv_2"),h=i(128,128,"mobilenetv1/conv_3"),p=i(128,256,"mobilenetv1/conv_4"),f=i(256,256,"mobilenetv1/conv_5"),x=i(256,512,"mobilenetv1/conv_6"),v=i(512,512,"mobilenetv1/conv_7"),y=i(512,512,"mobilenetv1/conv_8"),m=i(512,512,"mobilenetv1/conv_9"),g=i(512,512,"mobilenetv1/conv_10"),b=i(512,512,"mobilenetv1/conv_11"),w=i(512,1024,"mobilenetv1/conv_12"),N=i(1024,1024,"mobilenetv1/conv_13");return{conv_0:c,conv_1:u,conv_2:d,conv_3:h,conv_4:p,conv_5:f,conv_6:x,conv_7:v,conv_8:y,conv_9:m,conv_10:g,conv_11:b,conv_12:w,conv_13:N}}function l(){var c=s(1024,256,1,"prediction_layer/conv_0"),u=s(256,512,3,"prediction_layer/conv_1"),d=s(512,128,1,"prediction_layer/conv_2"),h=s(128,256,3,"prediction_layer/conv_3"),p=s(256,128,1,"prediction_layer/conv_4"),f=s(128,256,3,"prediction_layer/conv_5"),x=s(256,64,1,"prediction_layer/conv_6"),v=s(64,128,3,"prediction_layer/conv_7"),y=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),m=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),g=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),b=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),w=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),N=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),C=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),D=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),j=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),k=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),R=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),E=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),P={box_encoding_predictor:y,class_predictor:m},F={box_encoding_predictor:g,class_predictor:b},W={box_encoding_predictor:w,class_predictor:N},L={box_encoding_predictor:C,class_predictor:D},U={box_encoding_predictor:j,class_predictor:k},_={box_encoding_predictor:R,class_predictor:E};return{conv_0:c,conv_1:u,conv_2:d,conv_3:h,conv_4:p,conv_5:f,conv_6:x,conv_7:v,box_predictor_0:P,box_predictor_1:F,box_predictor_2:W,box_predictor_3:L,box_predictor_4:U,box_predictor_5:_}}return{extractMobilenetV1Params:o,extractPredictionLayerParams:l}}function MF(e){var t=[],n=Ea(e),r=n.extractWeights,s=n.getRemainingWeights,i=FF(r,t),o=i.extractMobilenetV1Params,l=i.extractPredictionLayerParams,c=o(),u=l(),d=Pm(r(5118*4),[1,5118,4]),h={extra_dim:d};if(t.push({paramPath:"output_layer/extra_dim"}),s().length!==0)throw new Error("weights remaing after extract: "+s().length);return{params:{mobilenetv1:c,prediction_layer:u,output_layer:h},paramMappings:t}}function LF(e,t){var n=gs(e,t);function r(u,d,h){var p=n(u+"/Conv2d_"+d+"_pointwise/weights",4,h+"/filters"),f=n(u+"/Conv2d_"+d+"_pointwise/convolution_bn_offset",1,h+"/batch_norm_offset");return{filters:p,batch_norm_offset:f}}function s(u){var d="mobilenetv1/conv_"+u,h="MobilenetV1/Conv2d_"+u+"_depthwise",p=d+"/depthwise_conv",f=d+"/pointwise_conv",x=n(h+"/depthwise_weights",4,p+"/filters"),v=n(h+"/BatchNorm/gamma",1,p+"/batch_norm_scale"),y=n(h+"/BatchNorm/beta",1,p+"/batch_norm_offset"),m=n(h+"/BatchNorm/moving_mean",1,p+"/batch_norm_mean"),g=n(h+"/BatchNorm/moving_variance",1,p+"/batch_norm_variance");return{depthwise_conv:{filters:x,batch_norm_scale:v,batch_norm_offset:y,batch_norm_mean:m,batch_norm_variance:g},pointwise_conv:r("MobilenetV1",u,f)}}function i(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:s(1),conv_2:s(2),conv_3:s(3),conv_4:s(4),conv_5:s(5),conv_6:s(6),conv_7:s(7),conv_8:s(8),conv_9:s(9),conv_10:s(10),conv_11:s(11),conv_12:s(12),conv_13:s(13)}}function o(u,d){var h=n(u+"/weights",4,d+"/filters"),p=n(u+"/biases",1,d+"/bias");return{filters:h,bias:p}}function l(u){var d=o("Prediction/BoxPredictor_"+u+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+u+"/box_encoding_predictor"),h=o("Prediction/BoxPredictor_"+u+"/ClassPredictor","prediction_layer/box_predictor_"+u+"/class_predictor");return{box_encoding_predictor:d,class_predictor:h}}function c(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:l(0),box_predictor_1:l(1),box_predictor_2:l(2),box_predictor_3:l(3),box_predictor_4:l(4),box_predictor_5:l(5)}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:c}}function OF(e){var t=[],n=LF(e,t),r=n.extractMobilenetV1Params,s=n.extractPredictionLayerParams,i=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!Sd(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var o={mobilenetv1:r(),prediction_layer:s(),output_layer:{extra_dim:i}};return Sa(e,t),{params:o,paramMappings:t}}function Ar(e,t,n){return me(function(){var r=ur(e,t.filters,n,"same");return r=Ve(r,t.batch_norm_offset),Hm(r,0,6)})}var BF=.0010000000474974513;function $F(e,t,n){return me(function(){var r=wd(e,t.filters,n,"same");return r=nj(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,BF),Hm(r,0,6)})}function zF(e){return[2,4,6,12].some(function(t){return t===e})?[2,2]:[1,1]}function UF(e,t){return me(function(){var n=null,r=Ar(e,t.conv_0,[2,2]),s=[t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13];if(s.forEach(function(i,o){var l=o+1,c=zF(l);r=$F(r,i.depthwise_conv,c),r=Ar(r,i.pointwise_conv,[1,1]),l===11&&(n=r)}),n===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}})}function WF(e,t,n,r,s){var i=e.shape[0],o=Math.min(n,i),l=t.map(function(d,h){return{score:d,boxIndex:h}}).filter(function(d){return d.score>s}).sort(function(d,h){return h.score-d.score}),c=function(d){return d<=r?1:0},u=[];return l.forEach(function(d){if(!(u.length>=o)){for(var h=d.score,p=u.length-1;p>=0;--p){var f=VF(e,d.boxIndex,u[p]);if(f!==0&&(d.score*=c(f),d.score<=s))break}h===d.score&&u.push(d.boxIndex)}}),u}function VF(e,t,n){var r=e.arraySync(),s=Math.min(r[t][0],r[t][2]),i=Math.min(r[t][1],r[t][3]),o=Math.max(r[t][0],r[t][2]),l=Math.max(r[t][1],r[t][3]),c=Math.min(r[n][0],r[n][2]),u=Math.min(r[n][1],r[n][3]),d=Math.max(r[n][0],r[n][2]),h=Math.max(r[n][1],r[n][3]),p=(o-s)*(l-i),f=(d-c)*(h-u);if(p<=0||f<=0)return 0;var x=Math.max(s,c),v=Math.max(i,u),y=Math.min(o,d),m=Math.min(l,h),g=Math.max(y-x,0)*Math.max(m-v,0);return g/(p+f-g)}function HF(e){var t=Bt(os(e,[1,0])),n=[zt(t[2],t[0]),zt(t[3],t[1])],r=[Ve(t[0],mr(n[0],fe(2))),Ve(t[1],mr(n[1],fe(2)))];return{sizes:n,centers:r}}function qF(e,t){var n=HF(e),r=n.sizes,s=n.centers,i=Bt(os(t,[1,0])),o=mr(hn(lf(mr(i[2],fe(5))),r[0]),fe(2)),l=Ve(hn(mr(i[0],fe(10)),r[0]),s[0]),c=mr(hn(lf(mr(i[3],fe(5))),r[1]),fe(2)),u=Ve(hn(mr(i[1],fe(10)),r[1]),s[1]);return os(Vn([zt(l,o),zt(u,c),Ve(l,o),Ve(u,c)]),[1,0])}function GF(e,t,n){return me(function(){var r=e.shape[0],s=qF(gr(Ti(n.extra_dim,[r,1,1]),[-1,4]),gr(e,[-1,4]));s=gr(s,[r,s.shape[0]/r,4]);var i=JN(Gr(t,[0,0,1],[-1,-1,-1])),o=Gr(i,[0,0,0],[-1,-1,1]);o=gr(o,[r,o.shape[1]]);var l=Bt(s),c=Bt(o);return{boxes:l,scores:c}})}function oi(e,t){return me(function(){var n=e.shape[0],r=gr(br(e,t.box_encoding_predictor),[n,-1,1,4]),s=gr(br(e,t.class_predictor),[n,-1,3]);return{boxPredictionEncoding:r,classPrediction:s}})}function KF(e,t,n){return me(function(){var r=Ar(e,n.conv_0,[1,1]),s=Ar(r,n.conv_1,[2,2]),i=Ar(s,n.conv_2,[1,1]),o=Ar(i,n.conv_3,[2,2]),l=Ar(o,n.conv_4,[1,1]),c=Ar(l,n.conv_5,[2,2]),u=Ar(c,n.conv_6,[1,1]),d=Ar(u,n.conv_7,[2,2]),h=oi(t,n.box_predictor_0),p=oi(e,n.box_predictor_1),f=oi(s,n.box_predictor_2),x=oi(o,n.box_predictor_3),v=oi(c,n.box_predictor_4),y=oi(d,n.box_predictor_5),m=Ot([h.boxPredictionEncoding,p.boxPredictionEncoding,f.boxPredictionEncoding,x.boxPredictionEncoding,v.boxPredictionEncoding,y.boxPredictionEncoding],1),g=Ot([h.classPrediction,p.classPrediction,f.classPrediction,x.classPrediction,v.classPrediction,y.classPrediction],1);return{boxPredictions:m,classPredictions:g}})}var _d=function(){function e(t){var n=t===void 0?{}:t,r=n.minConfidence,s=n.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=s||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(e.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),e}(),cC=function(e){Fe(t,e);function t(){return e.call(this,"SsdMobilenetv1")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return me(function(){var s=n.toBatchTensor(512,!1).toFloat(),i=zt(hn(s,fe(.007843137718737125)),fe(1)),o=UF(i,r.mobilenetv1),l=KF(o.out,o.conv11,r.prediction_layer),c=l.boxPredictions,u=l.classPredictions;return GF(c,u,r.output_layer)})},t.prototype.forward=function(n){return Se(this,void 0,void 0,function(){var r;return Ee(this,function(s){switch(s.label){case 0:return r=this.forwardInput,[4,Yt(n)];case 1:return[2,r.apply(this,[s.sent()])]}})})},t.prototype.locateFaces=function(n,r){return r===void 0&&(r={}),Se(this,void 0,void 0,function(){var s,i,o,l,c,u,d,h,p,f,x,v,y,m,g,b,w,N,C,D,j;return Ee(this,function(k){switch(k.label){case 0:return s=new _d(r),i=s.maxResults,o=s.minConfidence,[4,Yt(n)];case 1:for(l=k.sent(),c=this.forwardInput(l),u=c.boxes,d=c.scores,h=u[0],p=d[0],f=1;f<u.length;f++)u[f].dispose(),d[f].dispose();return y=(v=Array).from,[4,p.data()];case 2:return x=y.apply(v,[k.sent()]),m=.5,g=WF(h,x,i,m,o),b=l.getReshapedInputDimensions(0),w=l.inputSize,N=w/b.width,C=w/b.height,D=h.arraySync(),j=g.map(function(R){var E=[Math.max(0,D[R][0]),Math.min(1,D[R][2])].map(function(_){return _*C}),P=E[0],F=E[1],W=[Math.max(0,D[R][1]),Math.min(1,D[R][3])].map(function(_){return _*N}),L=W[0],U=W[1];return new Qr(x[R],new lx(L,P,U-L,F-P),{height:l.getInputHeight(0),width:l.getInputWidth(0)})}),h.dispose(),p.dispose(),[2,j]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(n){return OF(n)},t.prototype.extractParams=function(n){return MF(n)},t}(ka);(function(e){Fe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(cC);var XF=.4,YF=[new Je(.738768,.874946),new Je(2.42204,2.65704),new Je(4.30971,7.04493),new Je(10.246,4.59428),new Je(12.6868,11.8741)],QF=[new Je(1.603231,2.094468),new Je(6.041143,7.080126),new Je(2.882459,3.518061),new Je(4.266906,5.178857),new Je(9.041765,10.66308)],JF=[117.001,114.697,97.404],ZF="tiny_yolov2_model",eM="tiny_yolov2_separable_conv_model",yc=function(e){return typeof e=="number"};function tM(e){if(!e)throw new Error("invalid config: "+e);if(typeof e.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+e.withSeparableConvs);if(!yc(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+e.iouThreshold);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(function(t){return typeof t=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(e.classes));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(function(t){return t||{}}).every(function(t){return yc(t.x)&&yc(t.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(e.anchors));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||e.meanRgb.length!==3||!e.meanRgb.every(yc)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(e.meanRgb))}function yx(e){return me(function(){var t=hn(e,fe(.10000000149011612));return Ve(gt(zt(e,t)),t)})}function Ta(e,t){return me(function(){var n=Qs(e,[[0,0],[1,1],[1,1],[0,0]]);return n=ur(n,t.conv.filters,[1,1],"valid"),n=zt(n,t.bn.sub),n=hn(n,t.bn.truediv),n=Ve(n,t.conv.bias),yx(n)})}function Aa(e,t){return me(function(){var n=Qs(e,[[0,0],[1,1],[1,1],[0,0]]);return n=Xm(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),n=Ve(n,t.bias),yx(n)})}function nM(e,t){var n=Rd(e,t);function r(o,l){var c=Tt(e(o)),u=Tt(e(o));return t.push({paramPath:l+"/sub"},{paramPath:l+"/truediv"}),{sub:c,truediv:u}}function s(o,l,c){var u=n(o,l,3,c+"/conv"),d=r(l,c+"/bn");return{conv:u,bn:d}}var i=mx(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:s,extractSeparableConvParams:i}}function rM(e,t,n,r){var s=Ea(e),i=s.extractWeights,o=s.getRemainingWeights,l=[],c=nM(i,l),u=c.extractConvParams,d=c.extractConvWithBatchNormParams,h=c.extractSeparableConvParams,p;if(t.withSeparableConvs){var f=r[0],x=r[1],v=r[2],y=r[3],m=r[4],g=r[5],b=r[6],w=r[7],N=r[8],C=t.isFirstLayerConv2d?u(f,x,3,"conv0"):h(f,x,"conv0"),D=h(x,v,"conv1"),j=h(v,y,"conv2"),k=h(y,m,"conv3"),R=h(m,g,"conv4"),E=h(g,b,"conv5"),P=w?h(b,w,"conv6"):void 0,F=N?h(w,N,"conv7"):void 0,W=u(N||w||b,5*n,1,"conv8");p={conv0:C,conv1:D,conv2:j,conv3:k,conv4:R,conv5:E,conv6:P,conv7:F,conv8:W}}else{var f=r[0],x=r[1],v=r[2],y=r[3],m=r[4],g=r[5],b=r[6],w=r[7],N=r[8],C=d(f,x,"conv0"),D=d(x,v,"conv1"),j=d(v,y,"conv2"),k=d(y,m,"conv3"),R=d(m,g,"conv4"),E=d(g,b,"conv5"),P=d(b,w,"conv6"),F=d(w,N,"conv7"),W=u(N,5*n,1,"conv8");p={conv0:C,conv1:D,conv2:j,conv3:k,conv4:R,conv5:E,conv6:P,conv7:F,conv8:W}}if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{params:p,paramMappings:l}}function aM(e,t){var n=gs(e,t);function r(l){var c=n(l+"/sub",1),u=n(l+"/truediv",1);return{sub:c,truediv:u}}function s(l){var c=n(l+"/filters",4),u=n(l+"/bias",1);return{filters:c,bias:u}}function i(l){var c=s(l+"/conv"),u=r(l+"/bn");return{conv:c,bn:u}}var o=xx(n);return{extractConvParams:s,extractConvWithBatchNormParams:i,extractSeparableConvParams:o}}function sM(e,t){var n=[],r=aM(e,n),s=r.extractConvParams,i=r.extractConvWithBatchNormParams,o=r.extractSeparableConvParams,l;if(t.withSeparableConvs){var c=t.filterSizes&&t.filterSizes.length||9;l={conv0:t.isFirstLayerConv2d?s("conv0"):o("conv0"),conv1:o("conv1"),conv2:o("conv2"),conv3:o("conv3"),conv4:o("conv4"),conv5:o("conv5"),conv6:c>7?o("conv6"):void 0,conv7:c>8?o("conv7"):void 0,conv8:s("conv8")}}else l={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:s("conv8")};return Sa(e,n),{params:l,paramMappings:n}}var Tb;(function(e){e[e.XS=224]="XS",e[e.SM=320]="SM",e[e.MD=416]="MD",e[e.LG=608]="LG"})(Tb||(Tb={}));var bx=function(){function e(t){var n=t===void 0?{}:t,r=n.inputSize,s=n.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=s||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),e}(),uC=function(e){Fe(t,e);function t(n){var r=e.call(this,"TinyYolov2")||this;return tM(n),r._config=n,r}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(n,r){var s=Ta(n,r.conv0);return s=Vt(s,[2,2],[2,2],"same"),s=Ta(s,r.conv1),s=Vt(s,[2,2],[2,2],"same"),s=Ta(s,r.conv2),s=Vt(s,[2,2],[2,2],"same"),s=Ta(s,r.conv3),s=Vt(s,[2,2],[2,2],"same"),s=Ta(s,r.conv4),s=Vt(s,[2,2],[2,2],"same"),s=Ta(s,r.conv5),s=Vt(s,[2,2],[1,1],"same"),s=Ta(s,r.conv6),s=Ta(s,r.conv7),br(s,r.conv8,"valid",!1)},t.prototype.runMobilenet=function(n,r){var s=this.config.isFirstLayerConv2d?yx(br(n,r.conv0,"valid",!1)):Aa(n,r.conv0);return s=Vt(s,[2,2],[2,2],"same"),s=Aa(s,r.conv1),s=Vt(s,[2,2],[2,2],"same"),s=Aa(s,r.conv2),s=Vt(s,[2,2],[2,2],"same"),s=Aa(s,r.conv3),s=Vt(s,[2,2],[2,2],"same"),s=Aa(s,r.conv4),s=Vt(s,[2,2],[2,2],"same"),s=Aa(s,r.conv5),s=Vt(s,[2,2],[1,1],"same"),s=r.conv6?Aa(s,r.conv6):s,s=r.conv7?Aa(s,r.conv7):s,br(s,r.conv8,"valid",!1)},t.prototype.forwardInput=function(n,r){var s=this,i=this.params;if(!i)throw new Error("TinyYolov2 - load model before inference");return me(function(){var o=n.toBatchTensor(r,!1).toFloat();return o=s.config.meanRgb?Ml(o,s.config.meanRgb):o,o=o.div(fe(256)),s.config.withSeparableConvs?s.runMobilenet(o,i):s.runTinyYolov2(o,i)})},t.prototype.forward=function(n,r){return Se(this,void 0,void 0,function(){var s;return Ee(this,function(i){switch(i.label){case 0:return s=this.forwardInput,[4,Yt(n)];case 1:return[4,s.apply(this,[i.sent(),r])];case 2:return[2,i.sent()]}})})},t.prototype.detect=function(n,r){return r===void 0&&(r={}),Se(this,void 0,void 0,function(){var s,i,o,l,c,u,d,h,p,f,x,v,y,m,g=this;return Ee(this,function(b){switch(b.label){case 0:return s=new bx(r),i=s.inputSize,o=s.scoreThreshold,[4,Yt(n)];case 1:return l=b.sent(),[4,this.forwardInput(l,i)];case 2:return c=b.sent(),u=me(function(){return Bt(c)[0].expandDims()}),d={width:l.getInputWidth(0),height:l.getInputHeight(0)},[4,this.extractBoxes(u,l.getReshapedInputDimensions(0),o)];case 3:return h=b.sent(),c.dispose(),u.dispose(),p=h.map(function(w){return w.box}),f=h.map(function(w){return w.score}),x=h.map(function(w){return w.classScore}),v=h.map(function(w){return g.config.classes[w.label]}),y=xl(p.map(function(w){return w.rescale(i)}),f,this.config.iouThreshold,!0),m=y.map(function(w){return new Mj(f[w],x[w],v[w],p[w],d)}),[2,m]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(n){return sM(n,this.config)},t.prototype.extractParams=function(n){var r=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,s=r?r.length:void 0;if(s!==7&&s!==8&&s!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+s+" filterSizes in config");return rM(n,this.config,this.boxEncodingSize,r)},t.prototype.extractBoxes=function(n,r,s){return Se(this,void 0,void 0,function(){var i,o,l,c,u,d,h,p,f,x,v,y,m,g,b,w,N,C,D,j,k,R,E,P,F,W,L,U,_,B=this;return Ee(this,function(O){switch(O.label){case 0:return i=r.width,o=r.height,l=Math.max(i,o),c=l/i,u=l/o,d=n.shape[1],h=this.config.anchors.length,p=me(function(){var H=n.reshape([d,d,h,B.boxEncodingSize]),J=H.slice([0,0,0,0],[d,d,h,4]),te=H.slice([0,0,0,4],[d,d,h,1]),ce=B.withClassScores?ja(H.slice([0,0,0,5],[d,d,h,B.config.classes.length]),3):fe(0);return[J,te,ce]}),f=p[0],x=p[1],v=p[2],y=[],[4,x.array()];case 1:return m=O.sent(),[4,f.array()];case 2:g=O.sent(),b=0,O.label=3;case 3:if(!(b<d))return[3,12];w=0,O.label=4;case 4:if(!(w<d))return[3,11];N=0,O.label=5;case 5:return N<h?(C=Lh(m[b][w][N][0]),!s||C>s?(D=(w+Lh(g[b][w][N][0]))/d*c,j=(b+Lh(g[b][w][N][1]))/d*u,k=Math.exp(g[b][w][N][2])*this.config.anchors[N].x/d*c,R=Math.exp(g[b][w][N][3])*this.config.anchors[N].y/d*u,E=D-k/2,P=j-R/2,F={row:b,col:w,anchor:N},this.withClassScores?[4,this.extractPredictedClass(v,F)]:[3,7]):[3,9]):[3,10];case 6:return _=O.sent(),[3,8];case 7:_={classScore:1,label:0},O.label=8;case 8:W=_,L=W.classScore,U=W.label,y.push(ln({box:new Ed(E,P,E+k,P+R),score:C,classScore:C*L,label:U},F)),O.label=9;case 9:return N++,[3,5];case 10:return w++,[3,4];case 11:return b++,[3,3];case 12:return f.dispose(),x.dispose(),v.dispose(),[2,y]}})})},t.prototype.extractPredictedClass=function(n,r){return Se(this,void 0,void 0,function(){var s,i,o,l;return Ee(this,function(c){switch(c.label){case 0:return s=r.row,i=r.col,o=r.anchor,[4,n.array()];case 1:return l=c.sent(),[2,Array(this.config.classes.length).fill(0).map(function(u,d){return l[s][i][o][d]}).map(function(u,d){return{classScore:u,label:d}}).reduce(function(u,d){return u.classScore>d.classScore?u:d})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(ka),iM=function(e){Fe(t,e);function t(n){n===void 0&&(n=!0);var r=this,s=Object.assign({},{withSeparableConvs:n,iouThreshold:XF,classes:["face"]},n?{anchors:QF,meanRgb:JF}:{anchors:YF,withClassScores:!0});return r=e.call(this,s)||this,r}return Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,r){return Se(this,void 0,void 0,function(){var s;return Ee(this,function(i){switch(i.label){case 0:return[4,this.detect(n,r)];case 1:return s=i.sent(),[2,s.map(function(o){return new Qr(o.score,o.relativeBox,{width:o.imageWidth,height:o.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?eM:ZF},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(uC),zu=function(e){Fe(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n._name="TinyFaceDetectorOptions",n}return t}(bx),Ll=function(){function e(){}return e.prototype.then=function(t){return Se(this,void 0,void 0,function(){var n;return Ee(this,function(r){switch(r.label){case 0:return n=t,[4,this.run()];case 1:return[2,n.apply(void 0,[r.sent()])]}})})},e.prototype.run=function(){return Se(this,void 0,void 0,function(){return Ee(this,function(t){throw new Error("ComposableTask - run is not implemented")})})},e}();function Td(e,t,n,r,s){return s===void 0&&(s=function(i){var o=i.alignedRect;return o}),Se(this,void 0,void 0,function(){var i,o,l,c,u;return Ee(this,function(d){switch(d.label){case 0:return i=e.map(function(h){return fF(h)?s(h):h.detection}),l=r,l?[3,5]:t instanceof xt?[4,px(t,i)]:[3,2];case 1:return c=d.sent(),[3,4];case 2:return[4,hx(t,i)];case 3:c=d.sent(),d.label=4;case 4:l=c,d.label=5;case 5:return o=l,[4,n(o)];case 6:return u=d.sent(),o.forEach(function(h){return h instanceof xt&&h.dispose()}),[2,u]}})})}function wx(e,t,n,r,s){return Se(this,void 0,void 0,function(){var i=this;return Ee(this,function(o){return[2,Td([e],t,function(l){return Se(i,void 0,void 0,function(){return Ee(this,function(c){return[2,n(l[0])]})})},r,s)]})})}function oM(e){return me(function(){return Vn(Bt(e,3).reverse(),3)})}var bc=2,Uu=12;function lM(e,t){var n=Rd(e,t),r=fx(e,t);function s(u,d){var h=Tt(e(u));return t.push({paramPath:d}),h}function i(u,d,h){h===void 0&&(h=!1);var p=n(u[0],u[1],3,d+"/conv1"),f=s(u[1],d+"/prelu1_alpha"),x=n(u[1],u[2],3,d+"/conv2"),v=s(u[2],d+"/prelu2_alpha"),y=n(u[2],u[3],h?2:3,d+"/conv3"),m=s(u[3],d+"/prelu3_alpha");return{conv1:p,prelu1_alpha:f,conv2:x,prelu2_alpha:v,conv3:y,prelu3_alpha:m}}function o(){var u=i([3,10,16,32],"pnet"),d=n(32,2,1,"pnet/conv4_1"),h=n(32,4,1,"pnet/conv4_2");return ln(ln({},u),{conv4_1:d,conv4_2:h})}function l(){var u=i([3,28,48,64],"rnet",!0),d=r(576,128,"rnet/fc1"),h=s(128,"rnet/prelu4_alpha"),p=r(128,2,"rnet/fc2_1"),f=r(128,4,"rnet/fc2_2");return ln(ln({},u),{fc1:d,prelu4_alpha:h,fc2_1:p,fc2_2:f})}function c(){var u=i([3,32,64,64],"onet"),d=n(64,128,2,"onet/conv4"),h=s(128,"onet/prelu4_alpha"),p=r(1152,256,"onet/fc1"),f=s(256,"onet/prelu5_alpha"),x=r(256,2,"onet/fc2_1"),v=r(256,4,"onet/fc2_2"),y=r(256,10,"onet/fc2_3");return ln(ln({},u),{conv4:d,prelu4_alpha:h,fc1:p,prelu5_alpha:f,fc2_1:x,fc2_2:v,fc2_3:y})}return{extractPNetParams:o,extractRNetParams:l,extractONetParams:c}}function cM(e){var t=Ea(e),n=t.extractWeights,r=t.getRemainingWeights,s=[],i=lM(n,s),o=i.extractPNetParams,l=i.extractRNetParams,c=i.extractONetParams,u=o(),d=l(),h=c();if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:u,rnet:d,onet:h},paramMappings:s}}function uM(e,t){var n=gs(e,t);function r(d){var h=n(d+"/weights",4,d+"/filters"),p=n(d+"/bias",1);return{filters:h,bias:p}}function s(d){var h=n(d+"/weights",2),p=n(d+"/bias",1);return{weights:h,bias:p}}function i(d){return n(d,1)}function o(d){var h=r(d+"/conv1"),p=i(d+"/prelu1_alpha"),f=r(d+"/conv2"),x=i(d+"/prelu2_alpha"),v=r(d+"/conv3"),y=i(d+"/prelu3_alpha");return{conv1:h,prelu1_alpha:p,conv2:f,prelu2_alpha:x,conv3:v,prelu3_alpha:y}}function l(){var d=o("pnet"),h=r("pnet/conv4_1"),p=r("pnet/conv4_2");return ln(ln({},d),{conv4_1:h,conv4_2:p})}function c(){var d=o("rnet"),h=s("rnet/fc1"),p=i("rnet/prelu4_alpha"),f=s("rnet/fc2_1"),x=s("rnet/fc2_2");return ln(ln({},d),{fc1:h,prelu4_alpha:p,fc2_1:f,fc2_2:x})}function u(){var d=o("onet"),h=r("onet/conv4"),p=i("onet/prelu4_alpha"),f=s("onet/fc1"),x=i("onet/prelu5_alpha"),v=s("onet/fc2_1"),y=s("onet/fc2_2"),m=s("onet/fc2_3");return ln(ln({},d),{conv4:h,prelu4_alpha:p,fc1:f,prelu5_alpha:x,fc2_1:v,fc2_2:y,fc2_3:m})}return{extractPNetParams:l,extractRNetParams:c,extractONetParams:u}}function dM(e){var t=[],n=uM(e,t),r=n.extractPNetParams,s=n.extractRNetParams,i=n.extractONetParams,o=r(),l=s(),c=i();return Sa(e,t),{params:{pnet:o,rnet:l,onet:c},paramMappings:t}}function xf(e,t){var n=t[0],r=t[1];return{height:Math.floor(n*e),width:Math.floor(r*e)}}function hM(e,t,n){for(var r=n[0],s=n[1],i=Uu/e,o=[],l=Math.min(r,s)*i,c=0;l>=12;)o.push(i*Math.pow(t,c)),l=l*t,c+=1;return o}var Nx=function(e){Fe(t,e);function t(n,r,s,i){return e.call(this,{left:n,top:r,right:s,bottom:i},!0)||this}return t}(ls);function dC(e){return me(function(){return hn(zt(e,fe(127.5)),fe(.0078125))})}function Li(e,t){return me(function(){return Ve(gt(e),hn(t,Pu(gt(Pu(e)))))})}function jx(e,t,n){return n===void 0&&(n=!1),me(function(){var r=br(e,t.conv1,"valid");return r=Li(r,t.prelu1_alpha),r=Vt(r,n?[2,2]:[3,3],[2,2],"same"),r=br(r,t.conv2,"valid"),r=Li(r,t.prelu2_alpha),r=n?r:Vt(r,[3,3],[2,2],"valid"),r=br(r,t.conv3,"valid"),r=Li(r,t.prelu3_alpha),r})}function pM(e,t){return me(function(){var n=jx(e,t,!0),r=br(n,t.conv4_1,"valid"),s=Jn(jd(r,3),3),i=ja(zt(r,s),3),o=br(n,t.conv4_2,"valid");return{prob:i,regions:o}})}function fM(e,t){return me(function(){var n=xf(t,e.shape.slice(1)),r=n.height,s=n.width,i=ex.resizeBilinear(e,[r,s]),o=dC(i);return os(o,[0,2,1,3])})}function mM(e,t,n,r){for(var s=[],i=e.arraySync(),o=0;o<e.shape[0];o++)for(var l=0;l<e.shape[1];l++)i[o][l]>=r&&s.push(new Je(l,o));var c=s.map(function(u){var d=new Ed(Math.round((u.y*bc+1)/n),Math.round((u.x*bc+1)/n),Math.round((u.y*bc+Uu)/n),Math.round((u.x*bc+Uu)/n)),h=i[u.y][u.x],p=t.arraySync(),f=new Nx(p[u.y][u.x][0],p[u.y][u.x][1],p[u.y][u.x][2],p[u.y][u.x][3]);return{cell:d,score:h,region:f}});return c}function xM(e,t,n,r,s){s.stage1=[];var i=t.map(function(p){return me(function(){var f={scale:p},x=fM(e,p),v=Date.now(),y=pM(x,r),m=y.prob,g=y.regions;f.pnet=Date.now()-v;var b=Bt(Bt(m,3)[1])[0],w=Bt(g)[0];return{scoresTensor:b,regionsTensor:w,scale:p,statsForScale:f}})}),o=i.map(function(p){var f=p.scoresTensor,x=p.regionsTensor,v=p.scale,y=p.statsForScale,m=mM(f,x,v,n);if(f.dispose(),x.dispose(),!m.length)return s.stage1.push(y),[];var g=Date.now(),b=xl(m.map(function(w){return w.cell}),m.map(function(w){return w.score}),.5);return y.nms=Date.now()-g,y.numBoxes=b.length,s.stage1.push(y),b.map(function(w){return m[w]})}),l=o.reduce(function(p,f){return p.concat(f)},[]),c=[],u=[];if(l.length>0){var d=Date.now(),h=xl(l.map(function(p){return p.cell}),l.map(function(p){return p.score}),.7);s.stage1_nms=Date.now()-d,u=h.map(function(p){return l[p].score}),c=h.map(function(p){return l[p]}).map(function(p){var f=p.cell,x=p.region;return new Ed(f.left+x.left*f.width,f.top+x.top*f.height,f.right+x.right*f.width,f.bottom+x.bottom*f.height).toSquare().round()})}return{boxes:c,scores:u}}function hC(e,t,n){var r=n.width,s=n.height;return Se(this,void 0,void 0,function(){var i,o,l,c=this;return Ee(this,function(u){switch(u.label){case 0:return i=qs(e),[4,Promise.all(t.map(function(d){return Se(c,void 0,void 0,function(){var h,p,f,x,v,y,m,g;return Ee(this,function(b){return h=d.padAtBorders(e.height,e.width),p=h.y,f=h.ey,x=h.x,v=h.ex,y=x-1,m=p-1,g=i.getImageData(y,m,v-y,f-m),[2,fn.isNodejs()?dx(g):createImageBitmap(g)]})})}))];case 1:return o=u.sent(),l=[],o.forEach(function(d){var h=Dd({width:r,height:s}),p=qs(h);p.drawImage(d,0,0,r,s);for(var f=p.getImageData(0,0,r,s).data,x=[],v=0;v<f.length;v+=4)x.push(f[v+2]),x.push(f[v+1]),x.push(f[v]);l.push(x)}),[2,l.map(function(d){var h=me(function(){var p=os(jn(d,[1,r,s,3]),[0,2,1,3]).toFloat();return dC(p)});return h})]}})})}function gM(e,t){return me(function(){var n=jx(e,t),r=gr(n,[n.shape[0],t.fc1.weights.shape[0]]),s=Br(r,t.fc1),i=Li(s,t.prelu4_alpha),o=Br(i,t.fc2_1),l=Jn(jd(o,1),1),c=ja(zt(o,l),1),u=Br(i,t.fc2_2),d=Bt(c,1)[1];return{scores:d,regions:u}})}function vM(e,t,n,r,s){return Se(this,void 0,void 0,function(){var i,o,l,c,u,d,h,p,f,x,v,y,m,g;return Ee(this,function(b){switch(b.label){case 0:return i=Date.now(),[4,hC(e,t,{width:24,height:24})];case 1:return o=b.sent(),s.stage2_extractImagePatches=Date.now()-i,i=Date.now(),l=o.map(function(w){var N=gM(w,r);return w.dispose(),N}),s.stage2_rnet=Date.now()-i,c=l.length>1?Ot(l.map(function(w){return w.scores})):l[0].scores,h=(d=Array).from,[4,c.data()];case 2:return u=h.apply(d,[b.sent()]),c.dispose(),p=u.map(function(w,N){return{score:w,idx:N}}).filter(function(w){return w.score>n}).map(function(w){var N=w.idx;return N}),f=p.map(function(w){return t[w]}),x=p.map(function(w){return u[w]}),v=[],y=[],f.length>0&&(i=Date.now(),m=xl(f,x,.7),s.stage2_nms=Date.now()-i,g=m.map(function(w){var N=l[p[w]].regions.arraySync();return new Nx(N[0][0],N[0][1],N[0][2],N[0][3])}),y=m.map(function(w){return x[w]}),v=m.map(function(w,N){return f[w].calibrate(g[N])})),l.forEach(function(w){w.regions.dispose(),w.scores.dispose()}),[2,{boxes:v,scores:y}]}})})}function yM(e,t){return me(function(){var n=jx(e,t);n=Vt(n,[2,2],[2,2],"same"),n=br(n,t.conv4,"valid"),n=Li(n,t.prelu4_alpha);var r=gr(n,[n.shape[0],t.fc1.weights.shape[0]]),s=Br(r,t.fc1),i=Li(s,t.prelu5_alpha),o=Br(i,t.fc2_1),l=Jn(jd(o,1),1),c=ja(zt(o,l),1),u=Br(i,t.fc2_2),d=Br(i,t.fc2_3),h=Bt(c,1)[1];return{scores:h,regions:u,points:d}})}function bM(e,t,n,r,s){return Se(this,void 0,void 0,function(){var i,o,l,c,u,d,h,p,f,x,v,y,m,g,b;return Ee(this,function(w){switch(w.label){case 0:return i=Date.now(),[4,hC(e,t,{width:48,height:48})];case 1:return o=w.sent(),s.stage3_extractImagePatches=Date.now()-i,i=Date.now(),l=o.map(function(N){var C=yM(N,r);return N.dispose(),C}),s.stage3_onet=Date.now()-i,c=l.length>1?Ot(l.map(function(N){return N.scores})):l[0].scores,h=(d=Array).from,[4,c.data()];case 2:return u=h.apply(d,[w.sent()]),c.dispose(),p=u.map(function(N,C){return{score:N,idx:C}}).filter(function(N){return N.score>n}).map(function(N){var C=N.idx;return C}),f=p.map(function(N){var C=l[N].regions.arraySync();return new Nx(C[0][0],C[0][1],C[0][2],C[0][3])}),x=p.map(function(N,C){return t[N].calibrate(f[C])}),v=p.map(function(N){return u[N]}),y=[],m=[],g=[],x.length>0&&(i=Date.now(),b=xl(x,v,.7,!1),s.stage3_nms=Date.now()-i,y=b.map(function(N){return x[N]}),m=b.map(function(N){return v[N]}),g=b.map(function(N,C){return Array(5).fill(0).map(function(D,j){var k=l[N].points.arraySync();return new Je(k[0][j]*(y[C].width+1)+y[C].left,k[0][j+5]*(y[C].height+1)+y[C].top)})})),l.forEach(function(N){N.regions.dispose(),N.scores.dispose(),N.points.dispose()}),[2,{boxes:y,scores:m,points:g}]}})})}var wM=function(e){Fe(t,e);function t(){return e.call(this,"Mtcnn")||this}return t.prototype.load=function(n){return Se(this,void 0,void 0,function(){return Ee(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.load.call(this,n)]})})},t.prototype.loadFromDisk=function(n){return Se(this,void 0,void 0,function(){return Ee(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.loadFromDisk.call(this,n)]})})},t.prototype.forwardInput=function(n,r){return r===void 0&&(r={}),Se(this,void 0,void 0,function(){var s,i,o,l,c,u,d,h,p,f,x,v,y,m,g,b,w,N,C,D,j;return Ee(this,function(k){switch(k.label){case 0:if(s=this.params,!s)throw new Error("Mtcnn - load model before inference");if(i=n.canvases[0],!i)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return o={},l=Date.now(),c=me(function(){return oM(Jn(ix.fromPixels(i)).toFloat())}),u=function(R){return c.dispose(),o.total=Date.now()-l,R},d=c.shape.slice(1),h=d[0],p=d[1],f=new lC(r),x=f.minFaceSize,v=f.scaleFactor,y=f.maxNumScales,m=f.scoreThresholds,g=f.scaleSteps,b=(g||hM(x,v,[h,p])).filter(function(R){var E=xf(R,[h,p]);return Math.min(E.width,E.height)>Uu}).slice(0,y),o.scales=b,o.pyramid=b.map(function(R){return xf(R,[h,p])}),w=Date.now(),[4,xM(c,b,m[0],s.pnet,o)];case 1:return N=k.sent(),o.total_stage1=Date.now()-w,N.boxes.length?(o.stage2_numInputBoxes=N.boxes.length,w=Date.now(),[4,vM(i,N.boxes,m[1],s.rnet,o)]):[2,u({results:[],stats:o})];case 2:return C=k.sent(),o.total_stage2=Date.now()-w,C.boxes.length?(o.stage3_numInputBoxes=C.boxes.length,w=Date.now(),[4,bM(i,C.boxes,m[2],s.onet,o)]):[2,u({results:[],stats:o})];case 3:return D=k.sent(),o.total_stage3=Date.now()-w,j=D.boxes.map(function(R,E){return gx(cx({},new Qr(D.scores[E],new lx(R.left/p,R.top/h,R.width/p,R.height/h),{height:h,width:p})),new QP(D.points[E].map(function(P){return P.sub(new Je(R.left,R.top)).div(new Je(R.width,R.height))}),{width:R.width,height:R.height}))}),[2,u({results:j,stats:o})]}})})},t.prototype.forward=function(n,r){return r===void 0&&(r={}),Se(this,void 0,void 0,function(){var s;return Ee(this,function(i){switch(i.label){case 0:return s=this.forwardInput,[4,Yt(n)];case 1:return[4,s.apply(this,[i.sent(),r])];case 2:return[2,i.sent().results]}})})},t.prototype.forwardWithStats=function(n,r){return r===void 0&&(r={}),Se(this,void 0,void 0,function(){var s;return Ee(this,function(i){switch(i.label){case 0:return s=this.forwardInput,[4,Yt(n)];case 1:return[2,s.apply(this,[i.sent(),r])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(n){return dM(n)},t.prototype.extractParams=function(n){return cM(n)},t}(ka),NM=.4,jM=[new Je(1.603231,2.094468),new Je(6.041143,7.080126),new Je(2.882459,3.518061),new Je(4.266906,5.178857),new Je(9.041765,10.66308)],CM=[117.001,114.697,97.404],kM=function(e){Fe(t,e);function t(){var n=this,r={withSeparableConvs:!0,iouThreshold:NM,classes:["face"],anchors:jM,meanRgb:CM,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return n=e.call(this,r)||this,n}return Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,r){return Se(this,void 0,void 0,function(){var s;return Ee(this,function(i){switch(i.label){case 0:return[4,this.detect(n,r)];case 1:return s=i.sent(),[2,s.map(function(o){return new Qr(o.score,o.relativeBox,{width:o.imageWidth,height:o.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(uC),qt={ssdMobilenetv1:new cC,tinyFaceDetector:new kM,tinyYolov2:new iM,mtcnn:new wM,faceLandmark68Net:new nC,faceLandmark68TinyNet:new EF,faceRecognitionNet:new PF,faceExpressionNet:new pF,ageGenderNet:new jF},pC=function(e){Fe(t,e);function t(n,r,s){var i=e.call(this)||this;return i.parentTask=n,i.input=r,i.extractedFaces=s,i}return t}(Ll),Cx=function(e){Fe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Se(this,void 0,void 0,function(){var n,r,s=this;return Ee(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,Td(n,this.input,function(o){return Se(s,void 0,void 0,function(){return Ee(this,function(l){switch(l.label){case 0:return[4,Promise.all(o.map(function(c){return qt.faceExpressionNet.predictExpressions(c)}))];case 1:return[2,l.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,n.map(function(o,l){return Zj(o,r[l])})]}})})},t.prototype.withAgeAndGender=function(){return new Dx(this,this.input)},t}(pC),kx=function(e){Fe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Se(this,void 0,void 0,function(){var n,r;return Ee(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?[4,wx(n,this.input,function(i){return qt.faceExpressionNet.predictExpressions(i)},this.extractedFaces)]:[2];case 2:return r=s.sent(),[2,Zj(n,r)]}})})},t.prototype.withAgeAndGender=function(){return new Rx(this,this.input)},t}(pC),Sx=function(e){Fe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new _x(this,this.input)},t.prototype.withFaceDescriptors=function(){return new Ax(this,this.input)},t}(Cx),Ex=function(e){Fe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new Tx(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Ix(this,this.input)},t}(kx),fC=function(e){Fe(t,e);function t(n,r,s){var i=e.call(this)||this;return i.parentTask=n,i.input=r,i.extractedFaces=s,i}return t}(Ll),Dx=function(e){Fe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Se(this,void 0,void 0,function(){var n,r,s=this;return Ee(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,Td(n,this.input,function(o){return Se(s,void 0,void 0,function(){return Ee(this,function(l){switch(l.label){case 0:return[4,Promise.all(o.map(function(c){return qt.ageGenderNet.predictAgeAndGender(c)}))];case 1:return[2,l.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,n.map(function(o,l){var c=r[l],u=c.age,d=c.gender,h=c.genderProbability;return iC(oC(o,d,h),u)})]}})})},t.prototype.withFaceExpressions=function(){return new Cx(this,this.input)},t}(fC),Rx=function(e){Fe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Se(this,void 0,void 0,function(){var n,r,s,i,o;return Ee(this,function(l){switch(l.label){case 0:return[4,this.parentTask];case 1:return n=l.sent(),n?[4,wx(n,this.input,function(c){return qt.ageGenderNet.predictAgeAndGender(c)},this.extractedFaces)]:[2];case 2:return r=l.sent(),s=r.age,i=r.gender,o=r.genderProbability,[2,iC(oC(n,i,o),s)]}})})},t.prototype.withFaceExpressions=function(){return new kx(this,this.input)},t}(fC),_x=function(e){Fe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new Sx(this,this.input)},t.prototype.withFaceDescriptors=function(){return new Ax(this,this.input)},t}(Dx),Tx=function(e){Fe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new Ex(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Ix(this,this.input)},t}(Rx),mC=function(e){Fe(t,e);function t(n,r){var s=e.call(this)||this;return s.parentTask=n,s.input=r,s}return t}(Ll),Ax=function(e){Fe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Se(this,void 0,void 0,function(){var n,r;return Ee(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),[4,Td(n,this.input,function(i){return Promise.all(i.map(function(o){return qt.faceRecognitionNet.computeFaceDescriptor(o)}))},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return r=s.sent(),[2,r.map(function(i,o){return sC(n[o],i)})]}})})},t.prototype.withFaceExpressions=function(){return new Sx(this,this.input)},t.prototype.withAgeAndGender=function(){return new _x(this,this.input)},t}(mC),Ix=function(e){Fe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Se(this,void 0,void 0,function(){var n,r;return Ee(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?[4,wx(n,this.input,function(i){return qt.faceRecognitionNet.computeFaceDescriptor(i)},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=s.sent(),[2,sC(n,r)]}})})},t.prototype.withFaceExpressions=function(){return new Ex(this,this.input)},t.prototype.withAgeAndGender=function(){return new Tx(this,this.input)},t}(mC),xC=function(e){Fe(t,e);function t(n,r,s){var i=e.call(this)||this;return i.parentTask=n,i.input=r,i.useTinyLandmarkNet=s,i}return Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?qt.faceLandmark68TinyNet:qt.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(Ll),SM=function(e){Fe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Se(this,void 0,void 0,function(){var n,r,s,i,o,l=this;return Ee(this,function(c){switch(c.label){case 0:return[4,this.parentTask];case 1:return n=c.sent(),r=n.map(function(u){return u.detection}),this.input instanceof xt?[4,px(this.input,r)]:[3,3];case 2:return i=c.sent(),[3,5];case 3:return[4,hx(this.input,r)];case 4:i=c.sent(),c.label=5;case 5:return s=i,[4,Promise.all(s.map(function(u){return l.landmarkNet.detectLandmarks(u)}))];case 6:return o=c.sent(),s.forEach(function(u){return u instanceof xt&&u.dispose()}),[2,n.map(function(u,d){return gx(u,o[d])})]}})})},t.prototype.withFaceExpressions=function(){return new Sx(this,this.input)},t.prototype.withAgeAndGender=function(){return new _x(this,this.input)},t.prototype.withFaceDescriptors=function(){return new Ax(this,this.input)},t}(xC),EM=function(e){Fe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Se(this,void 0,void 0,function(){var n,r,s,i,o;return Ee(this,function(l){switch(l.label){case 0:return[4,this.parentTask];case 1:return n=l.sent(),n?(r=n.detection,this.input instanceof xt?[4,px(this.input,[r])]:[3,3]):[2];case 2:return i=l.sent(),[3,5];case 3:return[4,hx(this.input,[r])];case 4:i=l.sent(),l.label=5;case 5:return s=i,[4,this.landmarkNet.detectLandmarks(s[0])];case 6:return o=l.sent(),s.forEach(function(c){return c instanceof xt&&c.dispose()}),[2,gx(n,o)]}})})},t.prototype.withFaceExpressions=function(){return new Ex(this,this.input)},t.prototype.withAgeAndGender=function(){return new Tx(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Ix(this,this.input)},t}(xC),gC=function(e){Fe(t,e);function t(n,r){r===void 0&&(r=new _d);var s=e.call(this)||this;return s.input=n,s.options=r,s}return t}(Ll),DM=function(e){Fe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Se(this,void 0,void 0,function(){var n,r,s,i;return Ee(this,function(o){switch(o.label){case 0:return n=this,r=n.input,s=n.options,s instanceof lC?[4,qt.mtcnn.forward(r,s)]:[3,2];case 1:return[2,o.sent().map(function(l){return l.detection})];case 2:if(i=s instanceof zu?function(l){return qt.tinyFaceDetector.locateFaces(l,s)}:s instanceof _d?function(l){return qt.ssdMobilenetv1.locateFaces(l,s)}:s instanceof bx?function(l){return qt.tinyYolov2.locateFaces(l,s)}:null,!i)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,i(r)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var n=this;return new Promise(function(r){return Se(n,void 0,void 0,function(){var s;return Ee(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return s=i.sent(),[2,r(s.map(function(o){return cx({},o)}))]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new SM(this.runAndExtendWithFaceDetections(),this.input,n)},t.prototype.withFaceExpressions=function(){return new Cx(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new Dx(this.runAndExtendWithFaceDetections(),this.input)},t}(gC),RM=function(e){Fe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Se(this,void 0,void 0,function(){var n,r;return Ee(this,function(s){switch(s.label){case 0:return[4,new DM(this.input,this.options)];case 1:return n=s.sent(),r=n[0],n.forEach(function(i){i.score>r.score&&(r=i)}),[2,r]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var n=this;return new Promise(function(r){return Se(n,void 0,void 0,function(){var s;return Ee(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return s=i.sent(),[2,r(s?cx({},s):void 0)]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new EM(this.runAndExtendWithFaceDetection(),this.input,n)},t.prototype.withFaceExpressions=function(){return new kx(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new Rx(this.runAndExtendWithFaceDetection(),this.input)},t}(gC);function gf(e,t){return t===void 0&&(t=new _d),new RM(e,t)}function _M(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(e),r=Array.from(t);return Math.sqrt(n.map(function(s,i){return s-r[i]}).reduce(function(s,i){return s+Math.pow(i,2)},0))}(function(){function e(t,n){n===void 0&&(n=.6),this._distanceThreshold=n;var r=Array.isArray(t)?t:[t];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var s=1,i=function(){return"person "+s++};this._labeledDescriptors=r.map(function(o){if(o instanceof xc)return o;if(o instanceof Float32Array)return new xc(i(),[o]);if(o.descriptor&&o.descriptor instanceof Float32Array)return new xc(i(),[o.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(e.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),e.prototype.computeMeanDistance=function(t,n){return n.map(function(r){return _M(r,t)}).reduce(function(r,s){return r+s},0)/(n.length||1)},e.prototype.matchDescriptor=function(t){var n=this;return this.labeledDescriptors.map(function(r){var s=r.descriptors,i=r.label;return new Sb(i,n.computeMeanDistance(t,s))}).reduce(function(r,s){return r.distance<s.distance?r:s})},e.prototype.findBestMatch=function(t){var n=this.matchDescriptor(t);return n.distance<this.distanceThreshold?n:new Sb("unknown",n.distance)},e.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(t){return t.toJSON()})}},e.fromJSON=function(t){var n=t.labeledDescriptors.map(function(r){return xc.fromJSON(r)});return new e(n,t.distanceThreshold)},e})();const Ab="336620578429-9et3ddov717t2hcbabm90tfuupqne5ts.apps.googleusercontent.com",TM=()=>{const e=lr(),{login:t,setAuth:n,isLoading:r}=cr(),[s,i]=S.useState(!1),[o,l]=S.useState("email"),[c,u]=S.useState(!1),[d,h]=S.useState(!1),[p,f]=S.useState({email:"",password:""}),x=S.useRef(null),v=S.useRef(null);S.useEffect(()=>((async()=>{try{await Promise.all([qt.tinyFaceDetector.loadFromUri("/models"),qt.faceLandmark68Net.loadFromUri("/models"),qt.faceRecognitionNet.loadFromUri("/models")]),u(!0)}catch{console.log("Face models not loaded - facial recognition unavailable")}})(),()=>m()),[]);const y=async()=>{try{const N=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}});v.current=N,setTimeout(()=>{x.current&&(x.current.srcObject=N)},100)}catch(N){console.error("Camera error:",N),$.error("Impossible d'accder  la camra")}},m=()=>{v.current&&(v.current.getTracks().forEach(N=>N.stop()),v.current=null)},g=async()=>{var N,C;if(!p.email){$.error("Veuillez entrer votre email");return}if(!c){$.error("Modles de reconnaissance non chargs");return}h(!0);try{await new Promise(R=>setTimeout(R,500));const D=new zu({inputSize:320,scoreThreshold:.3});let j=null;for(let R=0;R<3&&(j=await gf(x.current,D).withFaceLandmarks().withFaceDescriptor(),!j);R++)await new Promise(E=>setTimeout(E,300));if(!j){$.error("Aucun visage dtect. Assurez-vous que votre visage est bien visible."),h(!1);return}const k=await K.post("/auth/face/login",{email:p.email,faceDescriptor:Array.from(j.descriptor)});n(k.data.token,k.data.user),$.success("Connexion russie !"),m(),e("/dashboard")}catch(D){$.error(((C=(N=D.response)==null?void 0:N.data)==null?void 0:C.message)||"Reconnaissance faciale choue")}finally{h(!1)}},b=N=>{f({...p,[N.target.name]:N.target.value})},w=async N=>{N.preventDefault();const C=await t(p.email,p.password);C.success?($.success("Connexion russie !"),e("/dashboard")):$.error(C.error)};return a.jsx(tN,{clientId:Ab,children:a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex",children:[a.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:a.jsxs("div",{className:"w-full max-w-md bg-white/10 backdrop-blur-xl rounded-3xl p-8 shadow-2xl border border-white/20",children:[a.jsxs(ve,{to:"/",className:"flex items-center gap-2 mb-8",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-cyan-500 to-purple-500 rounded-xl flex items-center justify-center",children:a.jsx(qr,{className:"w-6 h-6 text-white"})}),a.jsx("span",{className:"text-2xl font-bold text-white",children:"StartUpLab"})]}),a.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Bon retour !"}),a.jsx("p",{className:"text-gray-300 mb-6",children:"Connectez-vous pour accder  votre espace."}),a.jsxs("div",{className:"flex gap-2 mb-6 p-1 bg-white/10 rounded-xl",children:[a.jsx("button",{onClick:()=>{l("email"),m()},className:`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-all ${o==="email"?"bg-white text-gray-900":"text-white hover:bg-white/10"}`,children:"Email"}),a.jsxs("button",{onClick:()=>{l("face"),y()},className:`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-all flex items-center justify-center gap-2 ${o==="face"?"bg-white text-gray-900":"text-white hover:bg-white/10"}`,children:[a.jsx(mu,{className:"w-4 h-4"})," Visage"]})]}),o==="email"?a.jsxs("form",{onSubmit:w,className:"space-y-5",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:"Adresse email"}),a.jsxs("div",{className:"relative",children:[a.jsx(rr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"email",name:"email",value:p.email,onChange:b,className:"w-full bg-white/10 border border-white/20 rounded-xl py-3 pl-10 pr-4 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"vous@exemple.com",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:"Mot de passe"}),a.jsxs("div",{className:"relative",children:[a.jsx(ss,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:s?"text":"password",name:"password",value:p.password,onChange:b,className:"w-full bg-white/10 border border-white/20 rounded-xl py-3 pl-10 pr-10 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"",required:!0}),a.jsx("button",{type:"button",onClick:()=>i(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white",children:s?a.jsx(jm,{className:"w-5 h-5"}):a.jsx(Nr,{className:"w-5 h-5"})})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",className:"rounded bg-white/10 border-white/20 text-cyan-500"}),a.jsx("span",{className:"text-sm text-gray-300",children:"Se souvenir de moi"})]}),a.jsx("a",{href:"#",className:"text-sm text-cyan-400 hover:text-cyan-300",children:"Mot de passe oubli ?"})]}),a.jsx("button",{type:"submit",disabled:r,className:"w-full py-3 bg-gradient-to-r from-cyan-500 to-purple-500 text-white font-semibold rounded-xl hover:opacity-90 transition-opacity disabled:opacity-50",children:r?"Connexion...":"Se connecter"})]}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:"Adresse email"}),a.jsxs("div",{className:"relative",children:[a.jsx(rr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"email",name:"email",value:p.email,onChange:b,className:"w-full bg-white/10 border border-white/20 rounded-xl py-3 pl-10 pr-4 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"vous@exemple.com",required:!0})]})]}),a.jsxs("div",{className:"relative aspect-video bg-black rounded-xl overflow-hidden",children:[a.jsx("video",{ref:x,autoPlay:!0,muted:!0,playsInline:!0,className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute inset-0 border-4 border-dashed border-cyan-500/50 rounded-xl pointer-events-none"})]}),a.jsx("button",{onClick:g,disabled:d||!p.email,className:"w-full py-3 bg-gradient-to-r from-cyan-500 to-purple-500 text-white font-semibold rounded-xl hover:opacity-90 transition-opacity disabled:opacity-50 flex items-center justify-center gap-2",children:d?a.jsxs(a.Fragment,{children:[a.jsx(Ja,{className:"w-5 h-5 animate-spin"})," Analyse du visage..."]}):a.jsxs(a.Fragment,{children:[a.jsx(mu,{className:"w-5 h-5"})," Se connecter avec le visage"]})})]}),a.jsxs("div",{className:"flex items-center gap-4 my-6",children:[a.jsx("div",{className:"flex-1 h-px bg-white/20"}),a.jsx("span",{className:"text-sm text-gray-400",children:"ou continuer avec"}),a.jsx("div",{className:"flex-1 h-px bg-white/20"})]}),a.jsx("div",{className:"flex justify-center",children:a.jsxs("button",{onClick:()=>{const N=`https://accounts.google.com/o/oauth2/v2/auth?client_id=${Ab}&redirect_uri=${encodeURIComponent(window.location.origin+"/auth/google/callback")}&response_type=code&scope=openid%20email%20profile&access_type=offline`;window.location.href=N},className:"flex items-center gap-3 px-6 py-3 bg-white text-gray-700 font-medium rounded-full hover:bg-gray-100 transition-colors shadow-lg",children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continuer avec Google"]})}),a.jsxs("p",{className:"text-center text-gray-300 mt-8",children:["Pas encore de compte ?"," ",a.jsx(ve,{to:"/register",className:"text-cyan-400 hover:text-cyan-300 font-medium",children:"S'inscrire gratuitement"})]})]})}),a.jsx("div",{className:"hidden lg:flex flex-1 items-center justify-center p-12",children:a.jsxs("div",{className:"text-center text-white max-w-lg",children:[a.jsx("div",{className:"w-32 h-32 mx-auto mb-8 bg-gradient-to-r from-cyan-500 to-purple-500 rounded-full flex items-center justify-center",children:a.jsx(qr,{className:"w-16 h-16"})}),a.jsx("h2",{className:"text-4xl font-bold mb-4 bg-gradient-to-r from-cyan-400 to-purple-400 bg-clip-text text-transparent",children:"Transformez vos ides en ralit"}),a.jsx("p",{className:"text-xl text-gray-300",children:"Rejoignez des centaines d'entrepreneurs qui utilisent StartUpLab pour crer et dvelopper leur startup."}),a.jsxs("div",{className:"mt-12 grid grid-cols-3 gap-6",children:[a.jsxs("div",{className:"p-4 bg-white/5 rounded-2xl border border-white/10",children:[a.jsx("div",{className:"text-3xl font-bold text-cyan-400",children:"500+"}),a.jsx("div",{className:"text-sm text-gray-400",children:"Startups cres"})]}),a.jsxs("div",{className:"p-4 bg-white/5 rounded-2xl border border-white/10",children:[a.jsx("div",{className:"text-3xl font-bold text-purple-400",children:"98%"}),a.jsx("div",{className:"text-sm text-gray-400",children:"Satisfaction"})]}),a.jsxs("div",{className:"p-4 bg-white/5 rounded-2xl border border-white/10",children:[a.jsx("div",{className:"text-3xl font-bold text-pink-400",children:"24/7"}),a.jsx("div",{className:"text-sm text-gray-400",children:"Support"})]})]})]})})]})})},Ib="336620578429-9et3ddov717t2hcbabm90tfuupqne5ts.apps.googleusercontent.com",AM=()=>{const e=lr(),{register:t,setAuth:n,isLoading:r}=cr(),[s,i]=S.useState(!1),[o,l]=S.useState(!1),[c,u]=S.useState({firstName:"",lastName:"",email:"",password:"",phone:"",company:""}),d=p=>{u({...c,[p.target.name]:p.target.value})},h=async p=>{if(p.preventDefault(),!o){$.error("Veuillez accepter les conditions d'utilisation");return}if(c.password.length<6){$.error("Le mot de passe doit contenir au moins 6 caractres");return}const f=await t(c);f.success?($.success("Compte cr avec succs !"),e("/dashboard")):$.error(f.error)};return a.jsx(tN,{clientId:Ib,children:a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex",children:[a.jsx("div",{className:"hidden lg:flex flex-1 items-center justify-center p-12",children:a.jsxs("div",{className:"text-center text-white max-w-lg",children:[a.jsx("div",{className:"w-32 h-32 mx-auto mb-8 bg-gradient-to-r from-cyan-500 to-purple-500 rounded-full flex items-center justify-center animate-float",children:a.jsx(qr,{className:"w-16 h-16"})}),a.jsx("h2",{className:"text-4xl font-bold mb-4 bg-gradient-to-r from-cyan-400 to-purple-400 bg-clip-text text-transparent",children:"Lancez votre startup"}),a.jsx("p",{className:"text-xl text-gray-300",children:"Tous les outils ncessaires pour passer de l'ide au lancement en un seul endroit."}),a.jsxs("div",{className:"mt-12 grid grid-cols-3 gap-6",children:[a.jsxs("div",{className:"p-4 bg-white/5 rounded-2xl border border-white/10",children:[a.jsx("div",{className:"text-3xl font-bold text-cyan-400",children:"100%"}),a.jsx("div",{className:"text-sm text-gray-400",children:"Gratuit"})]}),a.jsxs("div",{className:"p-4 bg-white/5 rounded-2xl border border-white/10",children:[a.jsx("div",{className:"text-3xl font-bold text-purple-400",children:"5 min"}),a.jsx("div",{className:"text-sm text-gray-400",children:"Pour commencer"})]}),a.jsxs("div",{className:"p-4 bg-white/5 rounded-2xl border border-white/10",children:[a.jsx("div",{className:"text-3xl font-bold text-pink-400",children:""}),a.jsx("div",{className:"text-sm text-gray-400",children:"Possibilits"})]})]})]})}),a.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:a.jsxs("div",{className:"w-full max-w-md bg-white/10 backdrop-blur-xl rounded-3xl p-8 shadow-2xl border border-white/20",children:[a.jsxs(ve,{to:"/",className:"flex items-center gap-2 mb-6",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-cyan-500 to-purple-500 rounded-xl flex items-center justify-center",children:a.jsx(qr,{className:"w-6 h-6 text-white"})}),a.jsx("span",{className:"text-2xl font-bold text-white",children:"StartUpLab"})]}),a.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Crer un compte"}),a.jsx("p",{className:"text-gray-300 mb-6",children:"Commencez gratuitement, sans carte bancaire."}),a.jsxs("form",{onSubmit:h,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Prnom"}),a.jsxs("div",{className:"relative",children:[a.jsx(qn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx("input",{type:"text",name:"firstName",value:c.firstName,onChange:d,className:"w-full bg-white/10 border border-white/20 rounded-xl py-2.5 pl-9 pr-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 text-sm",placeholder:"Ahmed",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Nom"}),a.jsx("input",{type:"text",name:"lastName",value:c.lastName,onChange:d,className:"w-full bg-white/10 border border-white/20 rounded-xl py-2.5 px-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 text-sm",placeholder:"Ben Ali",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Email"}),a.jsxs("div",{className:"relative",children:[a.jsx(rr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx("input",{type:"email",name:"email",value:c.email,onChange:d,className:"w-full bg-white/10 border border-white/20 rounded-xl py-2.5 pl-9 pr-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 text-sm",placeholder:"vous@exemple.com",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Mot de passe"}),a.jsxs("div",{className:"relative",children:[a.jsx(ss,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx("input",{type:s?"text":"password",name:"password",value:c.password,onChange:d,className:"w-full bg-white/10 border border-white/20 rounded-xl py-2.5 pl-9 pr-10 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 text-sm",placeholder:"Min. 6 caractres",required:!0,autoComplete:"new-password"}),a.jsx("button",{type:"button",onClick:()=>i(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white",children:s?a.jsx(jm,{className:"w-4 h-4"}):a.jsx(Nr,{className:"w-4 h-4"})})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Tlphone"}),a.jsxs("div",{className:"relative",children:[a.jsx(km,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx("input",{type:"tel",name:"phone",value:c.phone,onChange:d,className:"w-full bg-white/10 border border-white/20 rounded-xl py-2.5 pl-9 pr-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 text-sm",placeholder:"+216 XX XXX"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Entreprise"}),a.jsxs("div",{className:"relative",children:[a.jsx(md,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx("input",{type:"text",name:"company",value:c.company,onChange:d,className:"w-full bg-white/10 border border-white/20 rounded-xl py-2.5 pl-9 pr-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 text-sm",placeholder:"Startup"})]})]})]}),a.jsxs("label",{className:"flex items-start gap-2",children:[a.jsx("input",{type:"checkbox",checked:o,onChange:p=>l(p.target.checked),className:"rounded bg-white/10 border-white/20 text-cyan-500 mt-0.5"}),a.jsxs("span",{className:"text-xs text-gray-300",children:["J'accepte les ",a.jsx("a",{href:"#",className:"text-cyan-400 hover:underline",children:"conditions d'utilisation"})," et la ",a.jsx("a",{href:"#",className:"text-cyan-400 hover:underline",children:"politique de confidentialit"})]})]}),a.jsx("button",{type:"submit",disabled:r,className:"w-full py-3 bg-gradient-to-r from-cyan-500 to-purple-500 text-white font-semibold rounded-xl hover:opacity-90 transition-opacity disabled:opacity-50",children:r?"Cration...":"Crer mon compte"})]}),a.jsxs("div",{className:"flex items-center gap-4 my-5",children:[a.jsx("div",{className:"flex-1 h-px bg-white/20"}),a.jsx("span",{className:"text-xs text-gray-400",children:"ou"}),a.jsx("div",{className:"flex-1 h-px bg-white/20"})]}),a.jsx("div",{className:"flex justify-center",children:a.jsxs("button",{onClick:()=>{const p=`https://accounts.google.com/o/oauth2/v2/auth?client_id=${Ib}&redirect_uri=${encodeURIComponent(window.location.origin+"/auth/google/callback")}&response_type=code&scope=openid%20email%20profile&access_type=offline`;window.location.href=p},className:"flex items-center gap-3 px-6 py-3 bg-white text-gray-700 font-medium rounded-full hover:bg-gray-100 transition-colors shadow-lg",children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"S'inscrire avec Google"]})}),a.jsxs("p",{className:"text-center text-gray-300 mt-6 text-sm",children:["Dj un compte ?"," ",a.jsx(ve,{to:"/login",className:"text-cyan-400 hover:text-cyan-300 font-medium",children:"Se connecter"})]})]})})]})})},IM=()=>{const{user:e}=cr(),[t,n]=S.useState({projects:0,ideas:0,tasks:0,completedTasks:0}),[r,s]=S.useState([]),[i,o]=S.useState(!0);S.useEffect(()=>{l()},[]);const l=async()=>{try{const[d,h]=await Promise.all([K.get("/projects"),K.get("/ideas")]),p=d.data.projects||[],f=h.data.ideas||[];let x=0,v=0;p.forEach(y=>{x+=y.taskCount||0,v+=y.completedTasks||0}),n({projects:p.length,ideas:f.length,tasks:x,completedTasks:v}),s(p.slice(0,3))}catch(d){console.error("Error fetching dashboard data:",d)}finally{o(!1)}},c=[{title:"Projets",value:t.projects,icon:xr,color:"bg-blue-500",link:"/projects"},{title:"Ides sauvegardes",value:t.ideas,icon:ca,color:"bg-yellow-500",link:"/ideas"},{title:"Tches compltes",value:`${t.completedTasks}/${t.tasks}`,icon:tt,color:"bg-green-500",link:"/projects"},{title:"Progression",value:t.tasks>0?`${Math.round(t.completedTasks/t.tasks*100)}%`:"0%",icon:Kt,color:"bg-purple-500",link:"/projects"}],u=[{title:"Gnrer une ide",icon:ca,href:"/ideas",color:"text-yellow-600 bg-yellow-100"},{title:"Nouveau projet",icon:ir,href:"/projects",color:"text-blue-600 bg-blue-100"}];return i?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:["Bonjour, ",e==null?void 0:e.firstName," ! "]}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Voici un aperu de vos projets et activits."})]}),a.jsx("div",{className:"flex gap-3 mt-4 md:mt-0",children:u.map((d,h)=>a.jsxs(ve,{to:d.href,className:`flex items-center gap-2 px-4 py-2 rounded-lg ${d.color} font-medium`,children:[a.jsx(d.icon,{className:"w-5 h-5"}),a.jsx("span",{children:d.title})]},h))})]}),a.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6",children:c.map((d,h)=>a.jsxs(ve,{to:d.link,className:"card-hover",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:`w-12 h-12 ${d.color} rounded-lg flex items-center justify-center`,children:a.jsx(d.icon,{className:"w-6 h-6 text-white"})}),a.jsx(xa,{className:"w-5 h-5 text-gray-400"})]}),a.jsx("h3",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:d.value}),a.jsx("p",{className:"text-gray-600 text-sm",children:d.title})]},h))}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Projets rcents"}),a.jsxs(ve,{to:"/projects",className:"text-primary-600 hover:text-primary-700 text-sm font-medium flex items-center gap-1",children:["Voir tous",a.jsx(xa,{className:"w-4 h-4"})]})]}),r.length>0?a.jsx("div",{className:"grid md:grid-cols-3 gap-4",children:r.map(d=>a.jsxs(ve,{to:`/projects/${d.id}`,className:"card-hover",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center",children:a.jsx(xr,{className:"w-5 h-5 text-primary-600"})}),a.jsx("span",{className:`badge ${d.stage==="idea"?"badge-info":d.stage==="development"?"badge-warning":"badge-success"}`,children:d.stage==="idea"?"Ide":d.stage==="development"?"Dveloppement":"Lanc"})]}),a.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:d.name}),a.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:d.description||"Aucune description"}),a.jsxs("div",{className:"flex items-center gap-2 mt-4 text-xs text-gray-500",children:[a.jsx(Et,{className:"w-4 h-4"}),a.jsxs("span",{children:["Modifi ",new Date(d.updatedAt).toLocaleDateString("fr-FR")]})]})]},d.id))}):a.jsxs("div",{className:"card text-center py-12",children:[a.jsx(xr,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun projet"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Crez votre premier projet pour commencer."}),a.jsxs(ve,{to:"/projects",className:"btn-primary inline-flex items-center gap-2",children:[a.jsx(ir,{className:"w-5 h-5"}),"Crer un projet"]})]})]}),t.projects===0&&a.jsxs("div",{className:"card bg-gradient-to-r from-primary-50 to-accent-50 border-0",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Guide de dmarrage"}),a.jsx("div",{className:"grid md:grid-cols-4 gap-4",children:[{step:1,title:"Gnrez une ide",desc:"Utilisez notre gnrateur d'ides"},{step:2,title:"Crez un projet",desc:"Transformez votre ide en projet"},{step:3,title:"Business Model",desc:"Dfinissez votre modle conomique"},{step:4,title:"Business Plan",desc:"Crez votre plan d'affaires"}].map(d=>a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-primary-600 text-white flex items-center justify-center font-bold text-sm shrink-0",children:d.step}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900",children:d.title}),a.jsx("p",{className:"text-sm text-gray-600",children:d.desc})]})]},d.step))})]})]})},Pb={free:{id:"free",name:"Gratuit",price:0,limits:{projects:1,ideas:10,teamMembers:1},features:{ideaGenerator:"basic",businessModelCanvas:!0,businessPlanPdf:!1,pitchDeck:!1,branding:!1,teamManagement:!1,exports:"limited",apiAccess:!1,whiteLabel:!1,prioritySupport:!1}},starter:{id:"starter",name:"Starter",price:29,limits:{projects:5,ideas:50,teamMembers:3},features:{ideaGenerator:"advanced",businessModelCanvas:!0,businessPlanPdf:!0,pitchDeck:!0,branding:!1,teamManagement:!1,exports:"limited",apiAccess:!1,whiteLabel:!1,prioritySupport:!1}},pro:{id:"pro",name:"Professionnel",price:79,limits:{projects:-1,ideas:-1,teamMembers:10},features:{ideaGenerator:"advanced",businessModelCanvas:!0,businessPlanPdf:!0,pitchDeck:!0,branding:!0,teamManagement:!0,exports:"unlimited",apiAccess:!1,whiteLabel:!1,prioritySupport:!0}},enterprise:{id:"enterprise",name:"Entreprise",price:199,limits:{projects:-1,ideas:-1,teamMembers:-1},features:{ideaGenerator:"advanced",businessModelCanvas:!0,businessPlanPdf:!0,pitchDeck:!0,branding:!0,teamManagement:!0,exports:"unlimited",apiAccess:!0,whiteLabel:!0,prioritySupport:!0}}},vC=e=>(Pb[e]||Pb.free).limits,PM=(e,t)=>{const n=vC(e);return n.projects===-1?!0:t<n.projects},FM=()=>{const{user:e}=cr(),[t,n]=S.useState([]),[r,s]=S.useState(!0),[i,o]=S.useState(""),[l,c]=S.useState(!1),[u,d]=S.useState(null),[h,p]=S.useState({name:"",description:"",industry:"",stage:"idea"}),f=(e==null?void 0:e.subscription)||"free",x=vC(f),v=PM(f,t.length);S.useEffect(()=>{y()},[]);const y=async()=>{try{const j=await K.get("/projects");n(j.data.projects||[])}catch{$.error("Erreur lors du chargement des projets")}finally{s(!1)}},m=async j=>{var k,R;j.preventDefault();try{u?(await K.put(`/projects/${u.id}`,h),$.success("Projet mis  jour")):(await K.post("/projects",h),$.success("Projet cr avec succs")),y(),w()}catch(E){$.error(((R=(k=E.response)==null?void 0:k.data)==null?void 0:R.message)||"Erreur")}},g=async j=>{if(confirm("tes-vous sr de vouloir supprimer ce projet ?"))try{await K.delete(`/projects/${j}`),$.success("Projet supprim"),y()}catch{$.error("Erreur lors de la suppression")}},b=(j=null)=>{j?(d(j),p({name:j.name,description:j.description||"",industry:j.industry||"",stage:j.stage||"idea"})):(d(null),p({name:"",description:"",industry:"",stage:"idea"})),c(!0)},w=()=>{c(!1),d(null),p({name:"",description:"",industry:"",stage:"idea"})},N=t.filter(j=>{var k;return j.name.toLowerCase().includes(i.toLowerCase())||((k=j.description)==null?void 0:k.toLowerCase().includes(i.toLowerCase()))}),C=[{value:"tech",label:"Technologie"},{value:"ecommerce",label:"E-commerce"},{value:"fintech",label:"Fintech"},{value:"health",label:"Sant"},{value:"food",label:"Agroalimentaire"},{value:"services",label:"Services"},{value:"education",label:"ducation"},{value:"other",label:"Autre"}],D=[{value:"idea",label:"Ide",color:"badge-info"},{value:"validation",label:"Validation",color:"badge-warning"},{value:"development",label:"Dveloppement",color:"badge-info"},{value:"launch",label:"Lancement",color:"badge-success"},{value:"growth",label:"Croissance",color:"badge-success"}];return r?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Mes Projets"}),a.jsxs("p",{className:"text-gray-600",children:["Grez tous vos projets de startup en un seul endroit.",x.projects!==-1&&a.jsxs("span",{className:"ml-2 text-sm",children:["(",t.length,"/",x.projects," projets)"]})]})]}),v?a.jsxs("button",{onClick:()=>b(),className:"btn-primary flex items-center gap-2",children:[a.jsx(ir,{className:"w-5 h-5"}),"Nouveau projet"]}):a.jsxs(ve,{to:"/pricing",className:"btn-secondary flex items-center gap-2",children:[a.jsx(ss,{className:"w-5 h-5"}),"Limite atteinte - Upgrader"]})]}),a.jsxs("div",{className:"relative max-w-md",children:[a.jsx(Vs,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Rechercher un projet...",value:i,onChange:j=>o(j.target.value),className:"input-field pl-10"})]}),N.length>0?a.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:N.map(j=>{var k,R;return a.jsxs("div",{className:"card group relative",children:[j.role==="owner"&&a.jsx("div",{className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>b(j),className:"p-2 text-gray-500 hover:text-primary-600 hover:bg-gray-100 rounded-lg",children:a.jsx(Dm,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>g(j.id),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-gray-100 rounded-lg",children:a.jsx(or,{className:"w-4 h-4"})})]})}),a.jsxs(ve,{to:`/projects/${j.id}`,children:[a.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[a.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center ${j.role!=="owner"?"bg-indigo-100":"bg-primary-100"}`,children:j.role!=="owner"?a.jsx(st,{className:"w-6 h-6 text-indigo-600"}):a.jsx(xr,{className:"w-6 h-6 text-primary-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:j.name}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx("span",{className:`badge ${((k=D.find(E=>E.value===j.stage))==null?void 0:k.color)||"badge-info"}`,children:((R=D.find(E=>E.value===j.stage))==null?void 0:R.label)||j.stage}),j.role!=="owner"&&a.jsx("span",{className:"badge bg-indigo-100 text-indigo-700",children:j.role==="admin"?"Admin":j.role==="member"?"Membre":"Lecteur"})]})]})]}),a.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-4",children:j.description||"Aucune description"}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 pt-4 border-t border-gray-100",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(tt,{className:"w-4 h-4"}),a.jsxs("span",{children:[j.completedTasks||0,"/",j.taskCount||0," tches"]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Et,{className:"w-4 h-4"}),a.jsx("span",{children:new Date(j.updatedAt).toLocaleDateString("fr-FR")})]})]})]})]},j.id)})}):a.jsxs("div",{className:"card text-center py-16",children:[a.jsx(xr,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:i?"Aucun projet trouv":"Aucun projet"}),a.jsx("p",{className:"text-gray-600 mb-6",children:i?"Essayez avec d'autres termes.":"Crez votre premier projet pour commencer."}),!i&&a.jsxs("button",{onClick:()=>b(),className:"btn-primary inline-flex items-center gap-2",children:[a.jsx(ir,{className:"w-5 h-5"}),"Crer un projet"]})]}),l&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsx("h2",{className:"text-xl font-semibold",children:u?"Modifier le projet":"Nouveau projet"}),a.jsx("button",{onClick:w,className:"text-gray-500 hover:text-gray-700",children:a.jsx(kt,{className:"w-6 h-6"})})]}),a.jsxs("form",{onSubmit:m,className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom du projet *"}),a.jsx("input",{type:"text",value:h.name,onChange:j=>p({...h,name:j.target.value}),className:"input-field",placeholder:"Ma super startup",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),a.jsx("textarea",{value:h.description,onChange:j=>p({...h,description:j.target.value}),className:"input-field resize-none",rows:3,placeholder:"Dcrivez brivement votre projet..."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Secteur d'activit"}),a.jsxs("select",{value:h.industry,onChange:j=>p({...h,industry:j.target.value}),className:"input-field",children:[a.jsx("option",{value:"",children:"Slectionner..."}),C.map(j=>a.jsx("option",{value:j.value,children:j.label},j.value))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"tape"}),a.jsx("select",{value:h.stage,onChange:j=>p({...h,stage:j.target.value}),className:"input-field",children:D.map(j=>a.jsx("option",{value:j.value,children:j.label},j.value))})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:w,className:"btn-secondary flex-1",children:"Annuler"}),a.jsx("button",{type:"submit",className:"btn-primary flex-1",children:u?"Enregistrer":"Crer le projet"})]})]})]})})]})},MM=()=>{var p,f,x,v,y,m,g;const{id:e}=jr(),[t,n]=S.useState(null),[r,s]=S.useState(null),[i,o]=S.useState(!0);S.useEffect(()=>{l()},[e]);const l=async()=>{try{const[b,w]=await Promise.all([K.get(`/projects/${e}`),K.get(`/projects/${e}/stats`)]);n(b.data),s(w.data)}catch{$.error("Erreur lors du chargement du projet")}finally{o(!1)}},c=[{name:"Business Model",description:"Crez votre modle conomique avec le Business Model Canvas",icon:Kw,href:`/business-model/${e}`,color:"bg-blue-500",completed:t==null?void 0:t.businessModel},{name:"Branding",description:"Gnrez le nom, slogan et identit visuelle",icon:xu,href:`/branding/${e}`,color:"bg-pink-500",completed:t==null?void 0:t.branding},{name:"Business Plan",description:"Crez votre plan d'affaires complet en PDF",icon:Ge,href:`/business-plan/${e}`,color:"bg-green-500",completed:t==null?void 0:t.businessPlan},{name:"Pitch Deck",description:"Construisez une prsentation pour vos investisseurs",icon:gu,href:`/pitch-deck/${e}`,color:"bg-purple-500",completed:t==null?void 0:t.pitchDeck},{name:"Gestion de Tches",description:"Grez vos tches avec un tableau Kanban",icon:UD,href:`/tasks/${e}`,color:"bg-orange-500",completed:!1},{name:"Membres d'quipe",description:"Grez votre quipe et assignez des tches",icon:st,href:`/team/${e}`,color:"bg-indigo-500",completed:!1}];if(i)return a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});if(!t)return a.jsxs("div",{className:"text-center py-16",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Projet non trouv"}),a.jsx(ve,{to:"/projects",className:"text-primary-600 hover:underline mt-2 inline-block",children:"Retour aux projets"})]});((p=r==null?void 0:r.tasks)==null?void 0:p.total)>0&&Math.round(r.tasks.done/r.tasks.total*100);const u=[{name:"Business Model",done:(f=r==null?void 0:r.completion)==null?void 0:f.businessModel},{name:"Branding",done:(x=r==null?void 0:r.completion)==null?void 0:x.branding},{name:"Business Plan",done:(v=r==null?void 0:r.completion)==null?void 0:v.businessPlan},{name:"Pitch Deck",done:(y=r==null?void 0:r.completion)==null?void 0:y.pitchDeck}],d=u.filter(b=>b.done).length,h=Math.round(d/u.length*100);return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(ve,{to:"/projects",className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:a.jsx(yn,{className:"w-5 h-5"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:t.project.name}),a.jsx("p",{className:"text-gray-600",children:t.project.description||"Aucune description"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsx("div",{className:"card",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Kt,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[h,"%"]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Progression globale"})]})]})}),a.jsx("div",{className:"card",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:a.jsx(tt,{className:"w-5 h-5 text-green-600"})}),a.jsxs("div",{children:[a.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[((m=r==null?void 0:r.tasks)==null?void 0:m.done)||0,"/",((g=r==null?void 0:r.tasks)==null?void 0:g.total)||0]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Tches compltes"})]})]})}),a.jsx("div",{className:"card",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:a.jsx(st,{className:"w-5 h-5 text-purple-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(r==null?void 0:r.teamMembers)||0}),a.jsx("p",{className:"text-sm text-gray-600",children:"Membres d'quipe"})]})]})}),a.jsx("div",{className:"card",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:a.jsx(Et,{className:"w-5 h-5 text-orange-600"})}),a.jsxs("div",{children:[a.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[d,"/4"]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Documents crs"})]})]})})]}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Progression du projet"}),a.jsx("div",{className:"space-y-3",children:u.map((b,w)=>a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center ${b.done?"bg-green-500":"bg-gray-200"}`,children:b.done&&a.jsx(tt,{className:"w-4 h-4 text-white"})}),a.jsx("span",{className:b.done?"text-gray-900":"text-gray-500",children:b.name})]},w))}),a.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100",children:[a.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[a.jsx("span",{className:"text-gray-600",children:"Progression globale"}),a.jsxs("span",{className:"font-medium text-gray-900",children:[h,"%"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-500",style:{width:`${h}%`}})})]})]}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Outils du projet"}),a.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map((b,w)=>a.jsxs(ve,{to:b.href,className:"card-hover relative overflow-hidden",children:[b.completed&&a.jsx("div",{className:"absolute top-3 right-3",children:a.jsx("span",{className:"badge-success",children:"Complt"})}),a.jsx("div",{className:`w-12 h-12 ${b.color} rounded-xl flex items-center justify-center mb-4`,children:a.jsx(b.icon,{className:"w-6 h-6 text-white"})}),a.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:b.name}),a.jsx("p",{className:"text-sm text-gray-600",children:b.description})]},w))})]})]})},LM=()=>{const[e,t]=S.useState([]),[n,r]=S.useState([]),[s,i]=S.useState(!1),[o,l]=S.useState("generate"),[c,u]=S.useState({industry:"tech",interests:"",skills:"",budget:"medium"});S.useEffect(()=>{d()},[]);const d=async()=>{try{const g=await K.get("/ideas");r(g.data.ideas||[])}catch(g){console.error("Error fetching ideas:",g)}},h=async()=>{i(!0);try{const g=await K.post("/ideas/generate",c);t(g.data.ideas||[]),$.success("Ides gnres avec succs !")}catch{$.error("Erreur lors de la gnration")}finally{i(!1)}},p=async g=>{try{await K.post("/ideas",g),$.success("Ide sauvegarde"),d()}catch{$.error("Erreur lors de la sauvegarde")}},f=async g=>{try{await K.delete(`/ideas/${g}`),$.success("Ide supprime"),d()}catch{$.error("Erreur lors de la suppression")}},x=async g=>{try{await K.put(`/ideas/${g}/favorite`),d()}catch{$.error("Erreur")}},v=async g=>{try{const b=await K.post(`/ideas/${g}/to-project`);$.success("Projet cr avec succs !"),d()}catch{$.error("Erreur lors de la cration du projet")}},y=[{value:"tech",label:"Technologie"},{value:"ecommerce",label:"E-commerce"},{value:"fintech",label:"Fintech"},{value:"health",label:"Sant"},{value:"food",label:"Agroalimentaire"},{value:"services",label:"Services"},{value:"education",label:"ducation"}],m=[{value:"low",label:"Faible (< 10K TND)"},{value:"medium",label:"Moyen (10K - 50K TND)"},{value:"high",label:"lev (> 50K TND)"}];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Gnrateur d'Ides"}),a.jsx("p",{className:"text-gray-600",children:"Trouvez l'ide de startup parfaite pour le march tunisien."})]}),a.jsxs("div",{className:"flex gap-2 border-b border-gray-200",children:[a.jsx("button",{onClick:()=>l("generate"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${o==="generate"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Gnrer des ides"}),a.jsxs("button",{onClick:()=>l("saved"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${o==="saved"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Ides sauvegardes (",n.length,")"]})]}),o==="generate"?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"card",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Paramtres de gnration"}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Secteur d'activit"}),a.jsx("select",{value:c.industry,onChange:g=>u({...c,industry:g.target.value}),className:"input-field",children:y.map(g=>a.jsx("option",{value:g.value,children:g.label},g.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Budget initial"}),a.jsx("select",{value:c.budget,onChange:g=>u({...c,budget:g.target.value}),className:"input-field",children:m.map(g=>a.jsx("option",{value:g.value,children:g.label},g.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vos intrts (optionnel)"}),a.jsx("input",{type:"text",value:c.interests,onChange:g=>u({...c,interests:g.target.value}),className:"input-field",placeholder:"ex: innovation, durabilit, digital"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vos comptences (optionnel)"}),a.jsx("input",{type:"text",value:c.skills,onChange:g=>u({...c,skills:g.target.value}),className:"input-field",placeholder:"ex: dveloppement, marketing, finance"})]})]}),a.jsx("button",{onClick:h,disabled:s,className:"btn-primary mt-6 flex items-center gap-2",children:s?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Gnration en cours..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ua,{className:"w-5 h-5"}),"Gnrer des ides"]})})]}),e.length>0&&a.jsxs("div",{className:"space-y-4",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Ides gnres"}),a.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:e.map((g,b)=>a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ca,{className:"w-5 h-5 text-yellow-500"}),a.jsxs("span",{className:"font-medium text-gray-500 text-sm",children:["Score: ",g.score,"/100"]})]}),a.jsx("button",{onClick:()=>p(g),className:"p-2 text-gray-500 hover:text-primary-600 hover:bg-primary-50 rounded-lg",children:a.jsx(Xs,{className:"w-5 h-5"})})]}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:g.title}),a.jsx("p",{className:"text-gray-600 text-sm mb-4",children:g.description}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Rm,{className:"w-4 h-4 text-red-500 mt-0.5"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Problme:"}),a.jsx("p",{className:"text-gray-600",children:g.problem})]})]}),a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Kt,{className:"w-4 h-4 text-green-500 mt-0.5"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Solution:"}),a.jsx("p",{className:"text-gray-600",children:g.solution})]})]}),a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(st,{className:"w-4 h-4 text-blue-500 mt-0.5"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Cible:"}),a.jsx("p",{className:"text-gray-600",children:g.targetMarket})]})]})]}),g.viability&&a.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100",children:[a.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Viabilit"}),a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-lg font-bold text-green-600",children:[g.viability.market,"%"]}),a.jsx("div",{className:"text-xs text-gray-500",children:"March"})]}),a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-lg font-bold text-yellow-600",children:[g.viability.competition,"%"]}),a.jsx("div",{className:"text-xs text-gray-500",children:"Concurrence"})]}),a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[g.viability.implementation,"%"]}),a.jsx("div",{className:"text-xs text-gray-500",children:"Faisabilit"})]})]})]})]},b))})]})]}):a.jsx("div",{className:"space-y-4",children:n.length>0?a.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:n.map(g=>a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ca,{className:"w-5 h-5 text-yellow-500"}),g.projectName&&a.jsxs("span",{className:"badge-success",children:["Projet: ",g.projectName]})]}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>x(g.id),className:`p-2 rounded-lg ${g.isFavorite?"text-yellow-500":"text-gray-400 hover:text-yellow-500"}`,children:g.isFavorite?a.jsx(Or,{className:"w-5 h-5 fill-current"}):a.jsx(ZD,{className:"w-5 h-5"})}),a.jsx("button",{onClick:()=>f(g.id),className:"p-2 text-gray-400 hover:text-red-500 rounded-lg",children:a.jsx(or,{className:"w-5 h-5"})})]})]}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:g.title}),a.jsx("p",{className:"text-gray-600 text-sm mb-4",children:g.description}),g.problem&&a.jsxs("div",{className:"text-sm mb-2",children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Problme:"}),a.jsx("p",{className:"text-gray-600",children:g.problem})]}),!g.projectId&&a.jsxs("button",{onClick:()=>v(g.id),className:"btn-primary w-full mt-4 flex items-center justify-center gap-2",children:["Crer un projet",a.jsx(xa,{className:"w-4 h-4"})]})]},g.id))}):a.jsxs("div",{className:"card text-center py-12",children:[a.jsx(ca,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune ide sauvegarde"}),a.jsx("p",{className:"text-gray-600",children:"Gnrez des ides et sauvegardez vos prfres."})]})})]})},OM=()=>{const{projectId:e}=jr(),[t,n]=S.useState(!0),[r,s]=S.useState(!1),[i,o]=S.useState(null),[l,c]=S.useState([]),[u,d]=S.useState("saas"),[h,p]=S.useState({keyPartners:"",keyActivities:"",keyResources:"",valuePropositions:"",customerRelationships:"",channels:"",customerSegments:"",costStructure:"",revenueStreams:""});S.useEffect(()=>{f()},[e]);const f=async()=>{try{const[g,b,w]=await Promise.all([K.get(`/projects/${e}`),K.get(`/business-model/project/${e}`),K.get("/business-model/templates")]);o(g.data.project),c(w.data.templates||[]),b.data.businessModel&&p(b.data.businessModel)}catch{$.error("Erreur lors du chargement")}finally{n(!1)}},x=async()=>{try{const g=await K.post("/business-model/generate",{projectId:e,template:u});p(g.data.businessModel),$.success("Template appliqu !")}catch{$.error("Erreur")}},v=async()=>{s(!0);try{await K.post(`/business-model/project/${e}`,h),$.success("Business Model sauvegard")}catch{$.error("Erreur lors de la sauvegarde")}finally{s(!1)}},y=(g,b)=>{p({...h,[g]:b})},m=[{key:"keyPartners",label:"Partenaires Cls",description:"Qui sont vos partenaires et fournisseurs cls ?",color:"bg-blue-50 border-blue-200"},{key:"keyActivities",label:"Activits Cls",description:"Quelles activits cls votre proposition de valeur requiert-elle ?",color:"bg-green-50 border-green-200"},{key:"keyResources",label:"Ressources Cls",description:"Quelles ressources cls votre proposition de valeur requiert-elle ?",color:"bg-yellow-50 border-yellow-200"},{key:"valuePropositions",label:"Proposition de Valeur",description:"Quelle valeur apportez-vous au client ?",color:"bg-red-50 border-red-200"},{key:"customerRelationships",label:"Relations Clients",description:"Quel type de relation chaque segment client attend-il ?",color:"bg-purple-50 border-purple-200"},{key:"channels",label:"Canaux",description:"Par quels canaux vos segments clients veulent-ils tre atteints ?",color:"bg-indigo-50 border-indigo-200"},{key:"customerSegments",label:"Segments Clients",description:"Pour qui crez-vous de la valeur ?",color:"bg-pink-50 border-pink-200"},{key:"costStructure",label:"Structure de Cots",description:"Quels sont les cots les plus importants de votre modle ?",color:"bg-orange-50 border-orange-200"},{key:"revenueStreams",label:"Flux de Revenus",description:"Pour quelle valeur vos clients sont-ils prts  payer ?",color:"bg-teal-50 border-teal-200"}];return t?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(ve,{to:`/projects/${e}`,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:a.jsx(yn,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Business Model Canvas"}),a.jsx("p",{className:"text-gray-600",children:i==null?void 0:i.name})]})]}),a.jsx("div",{className:"flex gap-3",children:a.jsxs("button",{onClick:v,disabled:r,className:"btn-primary flex items-center gap-2",children:[a.jsx(Xs,{className:"w-5 h-5"}),r?"Sauvegarde...":"Sauvegarder"]})})]}),a.jsx("div",{className:"card",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Appliquer un template"}),a.jsx("select",{value:u,onChange:g=>d(g.target.value),className:"input-field",children:l.map(g=>a.jsxs("option",{value:g.id,children:[g.name," - ",g.description]},g.id))})]}),a.jsxs("button",{onClick:x,className:"btn-secondary flex items-center gap-2 md:mt-7",children:[a.jsx(Fs,{className:"w-5 h-5"}),"Appliquer"]})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[a.jsxs("div",{className:`card border-2 ${m[0].color}`,children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:m[0].label}),a.jsx("p",{className:"text-xs text-gray-500 mb-3",children:m[0].description}),a.jsx("textarea",{value:h.keyPartners,onChange:g=>y("keyPartners",g.target.value),className:"w-full h-32 p-2 text-sm border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Listez vos partenaires cls..."})]}),a.jsxs("div",{className:"md:col-span-1 space-y-4",children:[a.jsxs("div",{className:`card border-2 ${m[1].color}`,children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:m[1].label}),a.jsx("p",{className:"text-xs text-gray-500 mb-3",children:m[1].description}),a.jsx("textarea",{value:h.keyActivities,onChange:g=>y("keyActivities",g.target.value),className:"w-full h-20 p-2 text-sm border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500",placeholder:"Vos activits principales..."})]}),a.jsxs("div",{className:`card border-2 ${m[2].color}`,children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:m[2].label}),a.jsx("p",{className:"text-xs text-gray-500 mb-3",children:m[2].description}),a.jsx("textarea",{value:h.keyResources,onChange:g=>y("keyResources",g.target.value),className:"w-full h-20 p-2 text-sm border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500",placeholder:"Vos ressources principales..."})]})]}),a.jsxs("div",{className:`card border-2 ${m[3].color}`,children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:m[3].label}),a.jsx("p",{className:"text-xs text-gray-500 mb-3",children:m[3].description}),a.jsx("textarea",{value:h.valuePropositions,onChange:g=>y("valuePropositions",g.target.value),className:"w-full h-32 p-2 text-sm border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500",placeholder:"Votre proposition de valeur..."})]}),a.jsxs("div",{className:"md:col-span-1 space-y-4",children:[a.jsxs("div",{className:`card border-2 ${m[4].color}`,children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:m[4].label}),a.jsx("p",{className:"text-xs text-gray-500 mb-3",children:m[4].description}),a.jsx("textarea",{value:h.customerRelationships,onChange:g=>y("customerRelationships",g.target.value),className:"w-full h-20 p-2 text-sm border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500",placeholder:"Type de relations..."})]}),a.jsxs("div",{className:`card border-2 ${m[5].color}`,children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:m[5].label}),a.jsx("p",{className:"text-xs text-gray-500 mb-3",children:m[5].description}),a.jsx("textarea",{value:h.channels,onChange:g=>y("channels",g.target.value),className:"w-full h-20 p-2 text-sm border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500",placeholder:"Vos canaux de distribution..."})]})]}),a.jsxs("div",{className:`card border-2 ${m[6].color}`,children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:m[6].label}),a.jsx("p",{className:"text-xs text-gray-500 mb-3",children:m[6].description}),a.jsx("textarea",{value:h.customerSegments,onChange:g=>y("customerSegments",g.target.value),className:"w-full h-32 p-2 text-sm border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500",placeholder:"Vos segments de clients..."})]}),a.jsxs("div",{className:`md:col-span-2 card border-2 ${m[7].color}`,children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:m[7].label}),a.jsx("p",{className:"text-xs text-gray-500 mb-3",children:m[7].description}),a.jsx("textarea",{value:h.costStructure,onChange:g=>y("costStructure",g.target.value),className:"w-full h-24 p-2 text-sm border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500",placeholder:"Vos principaux cots..."})]}),a.jsxs("div",{className:`md:col-span-3 card border-2 ${m[8].color}`,children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:m[8].label}),a.jsx("p",{className:"text-xs text-gray-500 mb-3",children:m[8].description}),a.jsx("textarea",{value:h.revenueStreams,onChange:g=>y("revenueStreams",g.target.value),className:"w-full h-24 p-2 text-sm border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500",placeholder:"Vos sources de revenus..."})]})]})]})},BM=()=>{var R;const{projectId:e}=jr(),[t,n]=S.useState(!0),[r,s]=S.useState(!1),[i,o]=S.useState(null),[l,c]=S.useState([]),[u,d]=S.useState([]),[h,p]=S.useState([]),[f,x]=S.useState([]),[v,y]=S.useState({companyName:"",slogan:"",logoUrl:"",logoStyle:null,primaryColor:"#0ea5e9",secondaryColor:"#d946ef",fontFamily:"Inter",brandVoice:""}),[m,g]=S.useState(null);S.useEffect(()=>{b()},[e]);const b=async()=>{try{const[E,P,F]=await Promise.all([K.get(`/projects/${e}`),K.get(`/branding/project/${e}`),K.get("/branding/colors")]);o(E.data.project),x(F.data.colorPalettes||[]),P.data.branding&&y(P.data.branding)}catch{$.error("Erreur lors du chargement")}finally{n(!1)}},w=async()=>{try{const E=await K.post("/branding/generate-names",{industry:i==null?void 0:i.industry,keywords:v.companyName});c(E.data.names||[]),$.success("Noms gnrs !")}catch{$.error("Erreur")}},N=async()=>{if(!v.companyName){$.error("Entrez d'abord un nom d'entreprise");return}try{const E=await K.post("/branding/generate-slogans",{companyName:v.companyName,industry:i==null?void 0:i.industry});d(E.data.slogans||[]),$.success("Slogans gnrs !")}catch{$.error("Erreur")}},C=async()=>{if(!v.companyName){$.error("Entrez d'abord un nom d'entreprise");return}try{const E=await K.post("/branding/generate-logo",{companyName:v.companyName,industry:i==null?void 0:i.industry});p(E.data.logoSuggestions||[]),$.success("Suggestions de logo gnres !")}catch{$.error("Erreur")}},D=async()=>{s(!0);try{await K.post(`/branding/project/${e}`,v),$.success("Branding sauvegard")}catch{$.error("Erreur lors de la sauvegarde")}finally{s(!1)}},j=["Inter","Roboto","Open Sans","Lato","Montserrat","Poppins","Raleway","Playfair Display","Merriweather"],k=(E,P)=>{const F=(P==null?void 0:P.substring(0,2).toUpperCase())||"SU",W=(P==null?void 0:P.charAt(0).toUpperCase())||"S";switch(E.logoType){case"monogram":return a.jsx("div",{className:"w-16 h-16 mx-auto mb-3 rounded-xl flex items-center justify-center text-white font-bold text-2xl",style:{backgroundColor:E.colors.primary},children:F});case"abstract":return a.jsxs("div",{className:"w-16 h-16 mx-auto mb-3 relative",children:[a.jsx("div",{className:"absolute inset-0 rounded-full opacity-80",style:{backgroundColor:E.colors.primary}}),a.jsx("div",{className:"absolute inset-2 rounded-full",style:{backgroundColor:E.colors.secondary}}),a.jsx("div",{className:"absolute inset-4 rounded-full bg-white flex items-center justify-center font-bold",style:{color:E.colors.primary},children:W})]});case"geometric":return a.jsxs("div",{className:"w-16 h-16 mx-auto mb-3 relative flex items-center justify-center",children:[a.jsx("div",{className:"absolute w-12 h-12 rotate-45",style:{backgroundColor:E.colors.primary}}),a.jsx("span",{className:"relative z-10 text-white font-bold text-xl",children:W})]});case"gradient":return a.jsx("div",{className:"w-16 h-16 mx-auto mb-3 rounded-2xl flex items-center justify-center text-white font-bold text-2xl",style:{background:`linear-gradient(135deg, ${E.colors.primary}, ${E.colors.secondary})`},children:F});case"outline":return a.jsx("div",{className:"w-16 h-16 mx-auto mb-3 rounded-xl flex items-center justify-center font-bold text-2xl border-4",style:{borderColor:E.colors.primary,color:E.colors.primary},children:F});case"circle":return a.jsx("div",{className:"w-16 h-16 mx-auto mb-3 rounded-full flex items-center justify-center text-white font-bold text-2xl",style:{backgroundColor:E.colors.primary},children:F});case"hexagon":return a.jsx("div",{className:"w-16 h-16 mx-auto mb-3 flex items-center justify-center",children:a.jsxs("svg",{viewBox:"0 0 100 100",className:"w-full h-full",children:[a.jsx("polygon",{points:"50,5 95,27.5 95,72.5 50,95 5,72.5 5,27.5",fill:E.colors.primary}),a.jsx("text",{x:"50",y:"58",textAnchor:"middle",fill:"white",fontSize:"28",fontWeight:"bold",children:F})]})});case"shield":return a.jsx("div",{className:"w-16 h-16 mx-auto mb-3 flex items-center justify-center",children:a.jsxs("svg",{viewBox:"0 0 100 120",className:"w-full h-full",children:[a.jsx("path",{d:"M50,5 L95,20 L95,60 Q95,100 50,115 Q5,100 5,60 L5,20 Z",fill:E.colors.primary}),a.jsx("text",{x:"50",y:"70",textAnchor:"middle",fill:"white",fontSize:"28",fontWeight:"bold",children:F})]})});case"wave":return a.jsxs("div",{className:"w-16 h-16 mx-auto mb-3 rounded-xl flex items-center justify-center text-white font-bold text-2xl overflow-hidden relative",style:{backgroundColor:E.colors.primary},children:[a.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-6 opacity-50",style:{backgroundColor:E.colors.secondary,borderRadius:"100% 100% 0 0"}}),a.jsx("span",{className:"relative z-10",children:F})]});case"minimal":return a.jsxs("div",{className:"w-16 h-16 mx-auto mb-3 flex items-center justify-center",children:[a.jsx("span",{className:"text-4xl font-light",style:{color:E.colors.primary},children:W}),a.jsx("div",{className:"w-2 h-2 rounded-full ml-1",style:{backgroundColor:E.colors.secondary}})]});default:return a.jsx("div",{className:"w-16 h-16 mx-auto mb-3 rounded-xl flex items-center justify-center text-white font-bold text-2xl",style:{backgroundColor:E.colors.primary},children:F})}};return t?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(ve,{to:`/projects/${e}`,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:a.jsx(yn,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Branding"}),a.jsx("p",{className:"text-gray-600",children:i==null?void 0:i.name})]})]}),a.jsxs("button",{onClick:D,disabled:r,className:"btn-primary flex items-center gap-2",children:[a.jsx(Xs,{className:"w-5 h-5"}),r?"Sauvegarde...":"Sauvegarder"]})]}),a.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Jw,{className:"w-5 h-5 text-primary-600"}),a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Nom de l'entreprise"})]}),a.jsx("input",{type:"text",value:v.companyName,onChange:E=>y({...v,companyName:E.target.value}),className:"input-field mb-4",placeholder:"Nom de votre startup"}),a.jsxs("button",{onClick:w,className:"btn-secondary flex items-center gap-2 mb-4",children:[a.jsx(ua,{className:"w-4 h-4"}),"Gnrer des suggestions"]}),l.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2",children:l.map((E,P)=>a.jsx("button",{onClick:()=>y({...v,companyName:E}),className:"px-3 py-1.5 bg-gray-100 hover:bg-primary-100 hover:text-primary-700 rounded-full text-sm transition-colors",children:E},P))})]}),a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(VD,{className:"w-5 h-5 text-primary-600"}),a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Slogan"})]}),a.jsx("input",{type:"text",value:v.slogan,onChange:E=>y({...v,slogan:E.target.value}),className:"input-field mb-4",placeholder:"Votre slogan accrocheur"}),a.jsxs("button",{onClick:N,className:"btn-secondary flex items-center gap-2 mb-4",children:[a.jsx(ua,{className:"w-4 h-4"}),"Gnrer des slogans"]}),u.length>0&&a.jsx("div",{className:"space-y-2",children:u.map((E,P)=>a.jsx("button",{onClick:()=>y({...v,slogan:E}),className:"block w-full text-left px-3 py-2 bg-gray-100 hover:bg-primary-100 hover:text-primary-700 rounded-lg text-sm transition-colors",children:E},P))})]}),a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(xu,{className:"w-5 h-5 text-primary-600"}),a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Couleurs"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Couleur principale"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"color",value:v.primaryColor,onChange:E=>y({...v,primaryColor:E.target.value}),className:"w-12 h-10 rounded cursor-pointer"}),a.jsx("input",{type:"text",value:v.primaryColor,onChange:E=>y({...v,primaryColor:E.target.value}),className:"input-field flex-1"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Couleur secondaire"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"color",value:v.secondaryColor,onChange:E=>y({...v,secondaryColor:E.target.value}),className:"w-12 h-10 rounded cursor-pointer"}),a.jsx("input",{type:"text",value:v.secondaryColor,onChange:E=>y({...v,secondaryColor:E.target.value}),className:"input-field flex-1"})]})]})]}),a.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Palettes suggres:"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:f.map((E,P)=>a.jsxs("button",{onClick:()=>y({...v,primaryColor:E.primary,secondaryColor:E.secondary}),className:"p-2 border border-gray-200 rounded-lg hover:border-primary-500 transition-colors",children:[a.jsxs("div",{className:"flex gap-1 mb-1",children:[a.jsx("div",{className:"w-6 h-6 rounded",style:{backgroundColor:E.primary}}),a.jsx("div",{className:"w-6 h-6 rounded",style:{backgroundColor:E.secondary}}),a.jsx("div",{className:"w-6 h-6 rounded",style:{backgroundColor:E.accent}})]}),a.jsx("p",{className:"text-xs text-gray-600",children:E.name})]},P))})]}),a.jsxs("div",{className:"card",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Typographie"}),a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Police principale"}),a.jsx("select",{value:v.fontFamily,onChange:E=>y({...v,fontFamily:E.target.value}),className:"input-field mb-4",children:j.map(E=>a.jsx("option",{value:E,children:E},E))}),a.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",style:{fontFamily:v.fontFamily},children:[a.jsx("p",{className:"text-2xl font-bold mb-2",style:{color:v.primaryColor},children:v.companyName||"Votre Startup"}),a.jsx("p",{className:"text-gray-600",children:v.slogan||"Votre slogan ici"})]})]}),a.jsxs("div",{className:"card lg:col-span-2",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Suggestions de Logo"}),a.jsxs("button",{onClick:C,className:"btn-secondary flex items-center gap-2",children:[a.jsx(ua,{className:"w-4 h-4"}),"Gnrer des ides"]})]}),h.length>0?a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:h.map((E,P)=>a.jsxs("button",{onClick:()=>{g(P),y({...v,logoStyle:E,primaryColor:E.colors.primary,secondaryColor:E.colors.secondary}),$.success(`Style "${E.type}" slectionn !`)},className:`p-4 rounded-xl text-center transition-all cursor-pointer hover:scale-105 h-40 flex flex-col items-center justify-center ${m===P?"ring-2 ring-primary-500 bg-primary-50 shadow-lg":"bg-gray-50 hover:bg-gray-100 border border-gray-200"}`,children:[a.jsx("div",{className:"flex-1 flex items-center justify-center w-full",children:k(E,v.companyName)}),a.jsxs("div",{className:"mt-auto pt-2",children:[a.jsx("p",{className:"font-medium text-gray-900 text-sm",children:E.type}),a.jsx("p",{className:"text-xs text-gray-500",children:E.style})]})]},P))}):a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(xu,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),a.jsx("p",{children:'Cliquez sur "Gnrer des ides" pour obtenir des suggestions de logo'})]})]}),a.jsxs("div",{className:"card lg:col-span-2",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Voix de la Marque"}),a.jsx("textarea",{value:v.brandVoice,onChange:E=>y({...v,brandVoice:E.target.value}),className:"input-field resize-none",rows:4,placeholder:"Dcrivez le ton et la personnalit de votre marque. Ex: Professionnel mais accessible, innovant, proche des clients..."})]})]}),a.jsxs("div",{className:"card",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Aperu"}),a.jsxs("div",{className:"p-8 rounded-xl text-center",style:{background:`linear-gradient(135deg, ${v.primaryColor}15, ${v.secondaryColor}15)`,fontFamily:v.fontFamily},children:[a.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-2xl flex items-center justify-center text-white font-bold text-3xl",style:{backgroundColor:v.primaryColor},children:((R=v.companyName)==null?void 0:R.substring(0,2).toUpperCase())||"SU"}),a.jsx("h3",{className:"text-3xl font-bold mb-2",style:{color:v.primaryColor},children:v.companyName||"Nom de votre startup"}),a.jsx("p",{className:"text-lg",style:{color:v.secondaryColor},children:v.slogan||"Votre slogan accrocheur"})]})]})]})},$M=()=>{const{projectId:e}=jr(),[t,n]=S.useState(!0),[r,s]=S.useState(!1),[i,o]=S.useState(!1),[l,c]=S.useState(null),[u,d]=S.useState({executiveSummary:"",companyDescription:"",marketAnalysis:"",organization:"",productLine:"",marketing:"",fundingRequest:"",financialProjections:"",appendix:""});S.useEffect(()=>{h()},[e]);const h=async()=>{try{const[m,g,b]=await Promise.all([K.get(`/projects/${e}`),K.get(`/business-plan/project/${e}`),K.get("/business-plan/template")]);c(m.data.project),g.data.businessPlan?d(g.data.businessPlan):b.data.template&&d(b.data.template)}catch{$.error("Erreur lors du chargement")}finally{n(!1)}},p=async()=>{s(!0);try{await K.post(`/business-plan/project/${e}`,u),$.success("Business Plan sauvegard")}catch{$.error("Erreur lors de la sauvegarde")}finally{s(!1)}},f=async()=>{o(!0);try{await K.post(`/business-plan/project/${e}`,u);const m=await K.post(`/business-plan/project/${e}/pdf`);$.success("PDF gnr avec succs !"),window.open(`http://localhost:5000${m.data.pdfUrl}`,"_blank")}catch{$.error("Erreur lors de la gnration du PDF")}finally{o(!1)}},x=[{key:"executiveSummary",title:"Rsum Excutif",icon:""},{key:"companyDescription",title:"Description de l'Entreprise",icon:""},{key:"marketAnalysis",title:"Analyse de March",icon:""},{key:"organization",title:"Organisation et Gestion",icon:""},{key:"productLine",title:"Produits et Services",icon:""},{key:"marketing",title:"Stratgie Marketing",icon:""},{key:"fundingRequest",title:"Demande de Financement",icon:""},{key:"financialProjections",title:"Projections Financires",icon:""},{key:"appendix",title:"Annexes",icon:""}],[v,y]=S.useState("executiveSummary");return t?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(ve,{to:`/projects/${e}`,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:a.jsx(yn,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Business Plan"}),a.jsx("p",{className:"text-gray-600",children:l==null?void 0:l.name})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{onClick:p,disabled:r,className:"btn-secondary flex items-center gap-2",children:[a.jsx(Xs,{className:"w-5 h-5"}),r?"Sauvegarde...":"Sauvegarder"]}),a.jsxs("button",{onClick:f,disabled:i,className:"btn-primary flex items-center gap-2",children:[a.jsx(vn,{className:"w-5 h-5"}),i?"Gnration...":"Gnrer PDF"]})]})]}),a.jsxs("div",{className:"grid lg:grid-cols-4 gap-6",children:[a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"card sticky top-24",children:[a.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[a.jsx(wD,{className:"w-5 h-5"}),"Sections"]}),a.jsx("nav",{className:"space-y-1",children:x.map(m=>a.jsxs("button",{onClick:()=>y(m.key),className:`w-full text-left px-3 py-2 rounded-lg text-sm transition-colors flex items-center gap-2 ${v===m.key?"bg-primary-50 text-primary-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[a.jsx("span",{children:m.icon}),a.jsx("span",{children:m.title}),u[m.key]&&u[m.key].length>50&&a.jsx("span",{className:"ml-auto w-2 h-2 bg-green-500 rounded-full"})]},m.key))})]})}),a.jsx("div",{className:"lg:col-span-3",children:x.map(m=>{var g;return a.jsx("div",{className:v===m.key?"block":"hidden",children:a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("span",{className:"text-2xl",children:m.icon}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:m.title})]}),a.jsx("textarea",{value:u[m.key],onChange:b=>d({...u,[m.key]:b.target.value}),className:"input-field resize-none min-h-[400px]",placeholder:`Rdigez votre ${m.title.toLowerCase()} ici...`}),a.jsxs("div",{className:"flex justify-between items-center mt-4 pt-4 border-t border-gray-100",children:[a.jsxs("p",{className:"text-sm text-gray-500",children:[((g=u[m.key])==null?void 0:g.length)||0," caractres"]}),a.jsxs("div",{className:"flex gap-2",children:[x.findIndex(b=>b.key===v)>0&&a.jsx("button",{onClick:()=>y(x[x.findIndex(b=>b.key===v)-1].key),className:"btn-secondary text-sm",children:" Prcdent"}),x.findIndex(b=>b.key===v)<x.length-1&&a.jsx("button",{onClick:()=>y(x[x.findIndex(b=>b.key===v)+1].key),className:"btn-primary text-sm",children:"Suivant "})]})]})]})},m.key)})})]}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Progression"}),a.jsx("div",{className:"grid grid-cols-3 md:grid-cols-9 gap-2",children:x.map(m=>{const g=u[m.key]&&u[m.key].length>50;return a.jsxs("div",{className:`p-2 rounded-lg text-center ${g?"bg-green-100":"bg-gray-100"}`,children:[a.jsx("span",{className:"text-lg",children:m.icon}),a.jsx("p",{className:`text-xs mt-1 ${g?"text-green-700":"text-gray-500"}`,children:g?"":"-"})]},m.key)})}),a.jsxs("p",{className:"text-sm text-gray-600 mt-4",children:[x.filter(m=>u[m.key]&&u[m.key].length>50).length," / ",x.length," sections compltes"]})]})]})},zM=()=>{var se,le,he,ye,Ce,xe,$e,_e,Re,A,Z,de,be,ze,Me,Ae,Ye,nt;const{projectId:e}=jr(),[t,n]=S.useState(!0),[r,s]=S.useState(!1),[i,o]=S.useState(null),[l,c]=S.useState([]),[u,d]=S.useState(null),[h,p]=S.useState([]),[f,x]=S.useState(0),[v,y]=S.useState(null),[m,g]=S.useState(!1),[b,w]=S.useState(null),[N,C]=S.useState(!1),[D,j]=S.useState("images"),k=S.useRef(null),R=[{id:"minimal",name:"Minimal",colors:{bg:"#FFFFFF",text:"#1F2937",accent:"#6366F1"}},{id:"dark",name:"Sombre",colors:{bg:"#1F2937",text:"#FFFFFF",accent:"#F59E0B"}},{id:"gradient-blue",name:"Dgrad Bleu",colors:{bg:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",text:"#FFFFFF",accent:"#FBBF24"}},{id:"gradient-sunset",name:"Coucher de soleil",colors:{bg:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",text:"#FFFFFF",accent:"#FDE68A"}},{id:"gradient-ocean",name:"Ocan",colors:{bg:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",text:"#FFFFFF",accent:"#1E3A8A"}},{id:"gradient-forest",name:"Fort",colors:{bg:"linear-gradient(135deg, #11998e 0%, #38ef7d 100%)",text:"#FFFFFF",accent:"#064E3B"}},{id:"corporate",name:"Corporate",colors:{bg:"#F3F4F6",text:"#111827",accent:"#2563EB"}},{id:"creative",name:"Cratif",colors:{bg:"#FDF4FF",text:"#701A75",accent:"#D946EF"}}],E=[{id:"rocket",icon:qr,label:"Fuse"},{id:"star",icon:Or,label:"toile"},{id:"heart",icon:Xi,label:"Cur"},{id:"zap",icon:eN,label:"clair"},{id:"award",icon:Uw,label:"Trophe"},{id:"target",icon:Rm,label:"Cible"}];S.useEffect(()=>{P()},[e]),S.useEffect(()=>{const ne=ie=>{m&&(ie.key==="ArrowRight"||ie.key===" "?x(Te=>Math.min(h.length-1,Te+1)):ie.key==="ArrowLeft"?x(Te=>Math.max(0,Te-1)):ie.key==="Escape"&&g(!1))};return window.addEventListener("keydown",ne),()=>window.removeEventListener("keydown",ne)},[m,h.length]);const P=async()=>{try{const[ne,ie,Te]=await Promise.all([K.get(`/projects/${e}`),K.get(`/pitch-deck/project/${e}`),K.get("/pitch-deck/templates")]);o(ne.data.project),c(Te.data.templates||[]),ie.data.pitchDeck&&(d(ie.data.pitchDeck),p(ie.data.pitchDeck.slides||[]))}catch{$.error("Erreur lors du chargement")}finally{n(!1)}},F=async ne=>{try{const ie=await K.post(`/pitch-deck/project/${e}/create`,{template:ne});d(ie.data.pitchDeck),p(ie.data.pitchDeck.slides||[]),$.success("Pitch deck cr !")}catch{$.error("Erreur")}},W=async()=>{s(!0);try{await K.put(`/pitch-deck/project/${e}/slides`,{slides:h}),$.success("Pitch deck sauvegard")}catch{$.error("Erreur lors de la sauvegarde")}finally{s(!1)}},L=(ne,ie,Te)=>{const Ue=[...h];Ue[ne]={...Ue[ne],[ie]:Te},p(Ue)},U=ne=>{if(h.length<=1){$.error("Vous devez garder au moins une slide");return}const ie=h.filter((Te,Ue)=>Ue!==ne);p(ie),f>=ie.length&&x(ie.length-1)},_=()=>{const ne={id:Date.now(),type:"custom",title:"Nouvelle slide",content:"",template:b||"minimal",media:[],stickers:[]};p([...h,ne]),x(h.length)},B=ne=>{const ie=ne.target.files[0];if(ie){const Te=new FileReader;Te.onloadend=()=>{var Rt;const Ue={id:Date.now(),type:"image",url:Te.result,name:ie.name};L(f,"media",[...((Rt=h[f])==null?void 0:Rt.media)||[],Ue]),$.success("Image ajoute !")},Te.readAsDataURL(ie)}},O=()=>{var ie,Te,Ue,Rt;const ne=prompt("Entrez l'URL de la vido YouTube ou Vimeo:");if(ne){let Wt=ne;ne.includes("youtube.com/watch")?Wt=`https://www.youtube.com/embed/${(ie=ne.split("v=")[1])==null?void 0:ie.split("&")[0]}`:ne.includes("youtu.be/")?Wt=`https://www.youtube.com/embed/${(Te=ne.split("youtu.be/")[1])==null?void 0:Te.split("?")[0]}`:ne.includes("vimeo.com/")&&(Wt=`https://player.vimeo.com/video/${(Ue=ne.split("vimeo.com/")[1])==null?void 0:Ue.split("?")[0]}`);const At={id:Date.now(),type:"video",url:Wt,originalUrl:ne};L(f,"media",[...((Rt=h[f])==null?void 0:Rt.media)||[],At]),$.success("Vido ajoute !")}},H=ne=>{var Te;const ie={id:Date.now(),stickerId:ne.id,x:50,y:50};L(f,"stickers",[...((Te=h[f])==null?void 0:Te.stickers)||[],ie]),$.success("Autocollant ajout !")},J=ne=>{var Te,Ue;const ie=((Ue=(Te=h[f])==null?void 0:Te.media)==null?void 0:Ue.filter(Rt=>Rt.id!==ne))||[];L(f,"media",ie)},te=ne=>{w(ne.id),L(f,"template",ne.id),$.success(`Template "${ne.name}" appliqu !`)},ce=ne=>(R.find(Te=>Te.id===ne)||R[0]).colors;if(t)return a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});if(!u)return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(ve,{to:`/projects/${e}`,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:a.jsx(yn,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Pitch Deck"}),a.jsx("p",{className:"text-gray-600",children:i==null?void 0:i.name})]})]}),a.jsxs("div",{className:"card text-center py-12",children:[a.jsx(gu,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Crer votre Pitch Deck"}),a.jsx("p",{className:"text-gray-600 mb-8",children:"Choisissez un template pour commencer"}),a.jsx("div",{className:"grid md:grid-cols-3 gap-4 max-w-2xl mx-auto",children:l.map(ne=>a.jsxs("button",{onClick:()=>F(ne.id),className:"card-hover text-left",children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:ne.name}),a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:ne.description}),a.jsxs("span",{className:"badge-info",children:[ne.slideCount," slides"]})]},ne.id))})]})]});if(m){const ne=ce((se=h[f])==null?void 0:se.template);return a.jsxs("div",{className:"fixed inset-0 bg-gray-900 z-50 flex flex-col",children:[a.jsx("div",{className:"flex-1 flex items-center justify-center p-4 md:p-8",children:a.jsxs("div",{className:"w-full max-w-5xl aspect-video rounded-2xl shadow-2xl p-8 md:p-12 relative overflow-hidden",style:{background:ne.bg,color:ne.text},children:[(he=(le=h[f])==null?void 0:le.stickers)==null?void 0:he.map(ie=>{const Te=E.find(Rt=>Rt.id===ie.stickerId),Ue=(Te==null?void 0:Te.icon)||Or;return a.jsx("div",{className:"absolute animate-pulse",style:{left:`${ie.x}%`,top:`${ie.y}%`,transform:"translate(-50%, -50%)"},children:a.jsx(Ue,{className:"w-16 h-16 md:w-20 md:h-20",style:{color:ne.accent}})},ie.id)}),a.jsxs("div",{className:"flex h-full gap-8",children:[a.jsxs("div",{className:"flex-1 flex flex-col justify-center",children:[a.jsx("h1",{className:"text-3xl md:text-5xl font-bold mb-6",style:{color:ne.text},children:(ye=h[f])==null?void 0:ye.title}),a.jsx("div",{className:"text-lg md:text-2xl whitespace-pre-wrap opacity-90",children:(Ce=h[f])==null?void 0:Ce.content})]}),(($e=(xe=h[f])==null?void 0:xe.media)==null?void 0:$e.length)>0&&a.jsx("div",{className:"w-2/5 flex flex-col justify-center gap-4",children:h[f].media.map(ie=>ie.type==="image"?a.jsx("img",{src:ie.url,alt:"",className:"w-full max-h-64 object-contain rounded-xl shadow-lg"},ie.id):a.jsx("div",{className:"w-full aspect-video rounded-xl overflow-hidden shadow-lg",children:a.jsx("iframe",{src:ie.url,className:"w-full h-full",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})},ie.id))})]})]})}),a.jsxs("div",{className:"p-4 flex items-center justify-between bg-gray-800/90 backdrop-blur",children:[a.jsx("button",{onClick:()=>g(!1),className:"px-4 py-2 text-white hover:bg-white/10 rounded-lg transition-colors",children:"Quitter"}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("button",{onClick:()=>x(Math.max(0,f-1)),disabled:f===0,className:"p-2 text-white hover:bg-white/10 rounded-lg disabled:opacity-50 transition-colors",children:a.jsx(Gi,{className:"w-6 h-6"})}),a.jsxs("span",{className:"text-white font-medium",children:[f+1," / ",h.length]}),a.jsx("button",{onClick:()=>x(Math.min(h.length-1,f+1)),disabled:f===h.length-1,className:"p-2 text-white hover:bg-white/10 rounded-lg disabled:opacity-50 transition-colors",children:a.jsx(ga,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"text-white/50 text-sm",children:"Utilisez   pour naviguer"})]})]})}return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(ve,{to:`/projects/${e}`,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:a.jsx(yn,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Pitch Deck"}),a.jsx("p",{className:"text-gray-600",children:i==null?void 0:i.name})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{onClick:()=>g(!0),className:"btn-secondary flex items-center gap-2",children:[a.jsx(gu,{className:"w-5 h-5"}),"Prsenter"]}),a.jsxs("button",{onClick:W,disabled:r,className:"btn-primary flex items-center gap-2",children:[a.jsx(Xs,{className:"w-5 h-5"}),r?"Sauvegarde...":"Sauvegarder"]})]})]}),a.jsxs("div",{className:"grid lg:grid-cols-4 gap-6",children:[a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"card sticky top-24",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"Slides"}),a.jsx("button",{onClick:_,className:"p-1.5 text-primary-600 hover:bg-primary-50 rounded-lg",children:a.jsx(ir,{className:"w-5 h-5"})})]}),a.jsx("div",{className:"space-y-2 max-h-[60vh] overflow-y-auto",children:h.map((ne,ie)=>a.jsx("button",{onClick:()=>x(ie),className:`w-full text-left p-3 rounded-lg border-2 transition-all ${f===ie?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}`,children:a.jsx("div",{className:"flex items-start justify-between",children:a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("p",{className:"text-xs text-gray-500 mb-1",children:["Slide ",ie+1]}),a.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:ne.title})]})})},ne.id||ie))})]})}),a.jsxs("div",{className:"lg:col-span-3 space-y-4",children:[a.jsx("div",{className:"card !p-3",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700 mr-2",children:"Ajouter:"}),a.jsx("input",{type:"file",ref:k,onChange:B,accept:"image/*",className:"hidden"}),a.jsxs("button",{onClick:()=>{var ne;return(ne=k.current)==null?void 0:ne.click()},className:"flex items-center gap-1.5 px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[a.jsx(Gw,{className:"w-4 h-4"}),"Photo"]}),a.jsxs("button",{onClick:O,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[a.jsx($c,{className:"w-4 h-4"}),"Vido"]}),a.jsxs("div",{className:"relative group",children:[a.jsxs("button",{className:"flex items-center gap-1.5 px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[a.jsx(JD,{className:"w-4 h-4"}),"Autocollants"]}),a.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white rounded-lg shadow-lg border border-gray-200 p-2 hidden group-hover:grid grid-cols-3 gap-1 z-10 min-w-[150px]",children:E.map(ne=>{const ie=ne.icon;return a.jsxs("button",{onClick:()=>H(ne),className:"p-2 hover:bg-gray-100 rounded-lg flex flex-col items-center gap-1",title:ne.label,children:[a.jsx(ie,{className:"w-5 h-5 text-primary-600"}),a.jsx("span",{className:"text-xs text-gray-500",children:ne.label})]},ne.id)})})]}),a.jsx("div",{className:"h-6 w-px bg-gray-300 mx-2"}),a.jsx("span",{className:"text-sm font-medium text-gray-700 mr-2",children:"Template:"}),a.jsxs("div",{className:"flex gap-1",children:[R.slice(0,4).map(ne=>{var ie;return a.jsx("button",{onClick:()=>te(ne),className:`w-6 h-6 rounded border-2 transition-all ${((ie=h[f])==null?void 0:ie.template)===ne.id?"border-primary-500 scale-110":"border-gray-300 hover:border-gray-400"}`,style:{background:ne.colors.bg},title:ne.name},ne.id)}),a.jsxs("div",{className:"relative group",children:[a.jsx("button",{className:"w-6 h-6 rounded border-2 border-gray-300 hover:border-gray-400 flex items-center justify-center text-xs text-gray-500",children:"+"}),a.jsx("div",{className:"absolute top-full right-0 mt-1 bg-white rounded-lg shadow-lg border border-gray-200 p-2 hidden group-hover:grid grid-cols-4 gap-1 z-10",children:R.map(ne=>{var ie;return a.jsx("button",{onClick:()=>te(ne),className:`w-8 h-8 rounded border-2 transition-all ${((ie=h[f])==null?void 0:ie.template)===ne.id?"border-primary-500":"border-gray-200 hover:border-gray-300"}`,style:{background:ne.colors.bg},title:ne.name},ne.id)})})]})]})]})}),a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h3",{className:"font-semibold text-gray-900",children:["Slide ",f+1," - ",((_e=h[f])==null?void 0:_e.type)||"custom"]}),a.jsx("button",{onClick:()=>U(f),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg",children:a.jsx(or,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Titre"}),a.jsx("input",{type:"text",value:((Re=h[f])==null?void 0:Re.title)||"",onChange:ne=>L(f,"title",ne.target.value),className:"input-field",placeholder:"Titre de la slide"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contenu"}),a.jsx("textarea",{value:((A=h[f])==null?void 0:A.content)||"",onChange:ne=>L(f,"content",ne.target.value),className:"input-field resize-none min-h-[150px]",placeholder:"Contenu de la slide..."})]}),(((de=(Z=h[f])==null?void 0:Z.media)==null?void 0:de.length)>0||((ze=(be=h[f])==null?void 0:be.stickers)==null?void 0:ze.length)>0)&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mdias ajouts"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[(Ae=(Me=h[f])==null?void 0:Me.media)==null?void 0:Ae.map(ne=>a.jsxs("div",{className:"relative group",children:[ne.type==="image"?a.jsx("img",{src:ne.url,alt:"",className:"w-20 h-20 object-cover rounded-lg border border-gray-200"}):a.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:a.jsx($c,{className:"w-8 h-8 text-gray-400"})}),a.jsx("button",{onClick:()=>J(ne.id),className:"absolute -top-2 -right-2 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:a.jsx(kt,{className:"w-3 h-3"})})]},ne.id)),(nt=(Ye=h[f])==null?void 0:Ye.stickers)==null?void 0:nt.map(ne=>{const ie=E.find(Ue=>Ue.id===ne.stickerId),Te=(ie==null?void 0:ie.icon)||Or;return a.jsx("div",{className:"w-12 h-12 bg-primary-50 rounded-lg flex items-center justify-center",children:a.jsx(Te,{className:"w-6 h-6 text-primary-600"})},ne.id)})]})]})]}),a.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Aperu"}),(()=>{var ie,Te,Ue,Rt,Wt,At,Xn;const ne=ce((ie=h[f])==null?void 0:ie.template);return a.jsxs("div",{className:"aspect-video rounded-xl p-8 flex flex-col justify-center relative overflow-hidden",style:{background:ne.bg,color:ne.text},children:[(Ue=(Te=h[f])==null?void 0:Te.stickers)==null?void 0:Ue.map(mn=>{const Da=E.find(Ra=>Ra.id===mn.stickerId),co=(Da==null?void 0:Da.icon)||Or;return a.jsx("div",{className:"absolute",style:{left:`${mn.x}%`,top:`${mn.y}%`,transform:"translate(-50%, -50%)"},children:a.jsx(co,{className:"w-12 h-12",style:{color:ne.accent}})},mn.id)}),a.jsxs("div",{className:"flex gap-6",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h2",{className:"text-2xl font-bold mb-4",style:{color:ne.text},children:((Rt=h[f])==null?void 0:Rt.title)||"Titre"}),a.jsx("p",{className:"whitespace-pre-wrap opacity-90",children:((Wt=h[f])==null?void 0:Wt.content)||"Contenu de la slide"})]}),((Xn=(At=h[f])==null?void 0:At.media)==null?void 0:Xn.length)>0&&a.jsx("div",{className:"w-1/3 flex flex-col gap-2",children:h[f].media.slice(0,2).map(mn=>mn.type==="image"?a.jsx("img",{src:mn.url,alt:"",className:"w-full h-24 object-cover rounded-lg"},mn.id):a.jsx("div",{className:"w-full h-24 bg-black/20 rounded-lg flex items-center justify-center",children:a.jsx($c,{className:"w-8 h-8 opacity-50"})},mn.id))})]})]})})()]}),a.jsxs("div",{className:"flex justify-between items-center mt-6 pt-6 border-t border-gray-200",children:[a.jsxs("button",{onClick:()=>x(Math.max(0,f-1)),disabled:f===0,className:"btn-secondary flex items-center gap-2 disabled:opacity-50",children:[a.jsx(Gi,{className:"w-5 h-5"}),"Prcdent"]}),a.jsxs("span",{className:"text-gray-500",children:[f+1," / ",h.length]}),a.jsxs("button",{onClick:()=>x(Math.min(h.length-1,f+1)),disabled:f===h.length-1,className:"btn-primary flex items-center gap-2 disabled:opacity-50",children:["Suivant",a.jsx(ga,{className:"w-5 h-5"})]})]})]})]})]})]})},UM=()=>{var Bx,$x,zx,Ux,Wx,Vx,Hx,qx,Gx,Kx,Xx,Yx,Qx,Jx,Zx,eg,tg,ng,rg,ag,sg,ig,og,lg,cg,ug,dg,hg,pg,fg,mg,xg,gg,vg,yg,bg,wg,Ng,jg,Cg,kg,Sg,Eg,Dg,Rg,_g,Tg,Ag,Ig,Pg,Fg,Mg,Lg,Og,Bg,$g,zg,Ug,Wg,Vg,Hg,qg,Gg,Kg,Xg,Yg,Qg,Jg,Zg,e0,t0,n0,r0,a0,s0,i0,o0,l0,c0,u0,d0,h0,p0,f0,m0,x0,g0,v0,y0,b0,w0,N0,j0,C0,k0,S0,E0;const{projectId:e}=jr(),[t,n]=S.useState(!0),[r,s]=S.useState(!1),[i,o]=S.useState(null),[l,c]=S.useState(null),[u,d]=S.useState([]),[h,p]=S.useState(0),[f,x]=S.useState(!1),[v,y]=S.useState("design"),[m,g]=S.useState(!1),[b,w]=S.useState(""),[N,C]=S.useState(!1),[D,j]=S.useState(null),[k,R]=S.useState(100),[E,P]=S.useState(null),[F,W]=S.useState(!1),[L,U]=S.useState(""),[_,B]=S.useState(null),[O,H]=S.useState({fontSize:16,fontFamily:"Inter",color:"#000000",fontWeight:"normal"}),J=S.useRef(null),te=S.useRef(null),ce=S.useRef(null),[se,le]=S.useState(!1),[he,ye]=S.useState(!1),[Ce,xe]=S.useState({x:0,y:0}),[$e,_e]=S.useState(""),[Re,A]=S.useState(null),[Z,de]=S.useState(null),[be,ze]=S.useState(null),[Me,Ae]=S.useState("templates"),[Ye,nt]=S.useState("style"),[ne,ie]=S.useState(!1),[Te,Ue]=S.useState(null),Rt=[{id:"Inter",name:"Inter",category:"Sans-serif"},{id:"Arial",name:"Arial",category:"Sans-serif"},{id:"Helvetica",name:"Helvetica",category:"Sans-serif"},{id:"Roboto",name:"Roboto",category:"Sans-serif"},{id:"Open Sans",name:"Open Sans",category:"Sans-serif"},{id:"Montserrat",name:"Montserrat",category:"Sans-serif"},{id:"Georgia",name:"Georgia",category:"Serif"},{id:"Times New Roman",name:"Times New Roman",category:"Serif"},{id:"Playfair Display",name:"Playfair Display",category:"Serif"},{id:"Merriweather",name:"Merriweather",category:"Serif"},{id:"Courier New",name:"Courier New",category:"Mono"},{id:"Verdana",name:"Verdana",category:"Sans-serif"},{id:"Trebuchet MS",name:"Trebuchet MS",category:"Sans-serif"},{id:"Comic Sans MS",name:"Comic Sans MS",category:"Display"},{id:"Impact",name:"Impact",category:"Display"}],Wt=[{id:"none",name:"Aucun",style:{}},{id:"shadow",name:"Ombre",style:{textShadow:"2px 2px 4px rgba(0,0,0,0.3)"}},{id:"shadow-hard",name:"Ombre dure",style:{textShadow:"3px 3px 0px rgba(0,0,0,0.5)"}},{id:"glow",name:"Lueur",style:{textShadow:"0 0 10px currentColor, 0 0 20px currentColor"}},{id:"neon",name:"Non",style:{textShadow:"0 0 5px #fff, 0 0 10px #fff, 0 0 15px currentColor, 0 0 20px currentColor"}},{id:"outline",name:"Contour",style:{WebkitTextStroke:"1px currentColor",WebkitTextFillColor:"transparent"}},{id:"emboss",name:"Relief",style:{textShadow:"-1px -1px 0 rgba(255,255,255,0.5), 1px 1px 0 rgba(0,0,0,0.3)"}},{id:"retro",name:"Rtro",style:{textShadow:"3px 3px 0 #ff6b6b, 6px 6px 0 #ffd93d"}}],At=[{id:"none",name:"Aucune",class:""},{id:"fade-in",name:"Fondu",class:"animate-fadeIn"},{id:"slide-up",name:"Glisser haut",class:"animate-slideUp"},{id:"slide-down",name:"Glisser bas",class:"animate-slideDown"},{id:"zoom",name:"Zoom",class:"animate-zoom"},{id:"bounce",name:"Rebond",class:"animate-bounce"},{id:"pulse",name:"Pulsation",class:"animate-pulse"},{id:"shake",name:"Secouer",class:"animate-shake"}],Xn=["#000000","#434343","#666666","#999999","#cccccc","#ffffff","#ff0000","#ff6b6b","#ff9500","#ffd93d","#00ff00","#00d084","#0693e3","#00d4ff","#6b5bff","#9b59b6","#ff69b4","#eb144c"],mn=[{id:"modern-beige",name:"lgant Beige",category:"Business",colors:{bg:"linear-gradient(180deg, #f5f0e8 0%, #e8dfd3 100%)",text:"#3d3d3d",accent:"#8b7355"},previewBg:"linear-gradient(180deg, #f5f0e8 0%, #e8dfd3 100%)",previewElements:["title-center","subtitle-elegant"]},{id:"startup-purple",name:"Startup Moderne",category:"Tech",colors:{bg:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",text:"#ffffff",accent:"#fbbf24"},previewBg:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",previewElements:["title-bold","icons"]},{id:"minimal-clean",name:"Minimal Clean",category:"Prsentation",colors:{bg:"#ffffff",text:"#1a1a1a",accent:"#0066ff"},previewBg:"#ffffff",previewElements:["title-left","line-accent"]},{id:"dark-premium",name:"Dark Premium",category:"Luxe",colors:{bg:"linear-gradient(180deg, #1a1a2e 0%, #0d0d1a 100%)",text:"#ffffff",accent:"#c9a962"},previewBg:"linear-gradient(180deg, #1a1a2e 0%, #0d0d1a 100%)",previewElements:["title-gold","border-gold"]},{id:"nature-green",name:"Nature Fresh",category:"Nature",colors:{bg:"linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%)",text:"#2e7d32",accent:"#1b5e20"},previewBg:"linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%)",previewElements:["title-nature","leaf-icon"]},{id:"ocean-blue",name:"Ocan Calme",category:"Cratif",colors:{bg:"linear-gradient(180deg, #e3f2fd 0%, #90caf9 100%)",text:"#0d47a1",accent:"#1565c0"},previewBg:"linear-gradient(180deg, #e3f2fd 0%, #90caf9 100%)",previewElements:["title-wave","wave-decoration"]},{id:"sunset-warm",name:"Coucher Soleil",category:"Cratif",colors:{bg:"linear-gradient(135deg, #fff3e0 0%, #ffccbc 100%)",text:"#bf360c",accent:"#e65100"},previewBg:"linear-gradient(135deg, #fff3e0 0%, #ffccbc 100%)",previewElements:["title-warm","sun-icon"]},{id:"corporate-navy",name:"Corporate Pro",category:"Business",colors:{bg:"#f8fafc",text:"#1e3a5f",accent:"#2563eb"},previewBg:"#f8fafc",previewElements:["title-corporate","chart-icon"]},{id:"creative-gradient",name:"Cratif Vibrant",category:"Cratif",colors:{bg:"linear-gradient(135deg, #ff6b6b 0%, #feca57 50%, #48dbfb 100%)",text:"#ffffff",accent:"#ffffff"},previewBg:"linear-gradient(135deg, #ff6b6b 0%, #feca57 50%, #48dbfb 100%)",previewElements:["title-vibrant","shapes"]},{id:"photo-overlay",name:"Photo Moderne",category:"Photo",colors:{bg:"linear-gradient(135deg, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.4) 100%)",text:"#ffffff",accent:"#ffffff"},previewBg:"linear-gradient(135deg, #2c3e50 0%, #4a6741 100%)",previewElements:["title-photo","overlay"]},{id:"pastel-pink",name:"Pastel Doux",category:"Cratif",colors:{bg:"linear-gradient(180deg, #fce4ec 0%, #f8bbd9 100%)",text:"#880e4f",accent:"#ad1457"},previewBg:"linear-gradient(180deg, #fce4ec 0%, #f8bbd9 100%)",previewElements:["title-soft","hearts"]},{id:"tech-cyber",name:"Tech Cyber",category:"Tech",colors:{bg:"#0a0a0f",text:"#00ff88",accent:"#00d4ff"},previewBg:"#0a0a0f",previewElements:["title-cyber","grid-lines"]}],Da={shapes:[{id:"rect",icon:Sy,name:"Rectangle"},{id:"circle",icon:CD,name:"Cercle"},{id:"triangle",icon:tR,name:"Triangle"},{id:"star",icon:Or,name:"toile"},{id:"heart",icon:Xi,name:"Cur"},{id:"diamond",icon:RD,name:"Losange"},{id:"hexagon",icon:MD,name:"Hexagone"},{id:"octagon",icon:HD,name:"Octogone"}],arrows:[{id:"arrow-right",icon:xa,name:"Flche droite"},{id:"arrow-up",icon:vD,name:"Flche haut"},{id:"arrow-down",icon:xD,name:"Flche bas"},{id:"trending-up",icon:Kt,name:"Tendance +"},{id:"trending-down",icon:ya,name:"Tendance -"}],business:[{id:"briefcase",icon:Vp,name:"Business"},{id:"building",icon:md,name:"Entreprise"},{id:"chart",icon:bD,name:"Graphique"},{id:"pie",icon:Sm,name:"Camembert"},{id:"line-chart",icon:BD,name:"Courbe"},{id:"dollar",icon:va,name:"Dollar"},{id:"target",icon:Rm,name:"Objectif"},{id:"trophy",icon:nR,name:"Trophe"}],tech:[{id:"cpu",icon:jy,name:"CPU"},{id:"database",icon:DD,name:"Database"},{id:"cloud",icon:kD,name:"Cloud"},{id:"server",icon:XD,name:"Serveur"},{id:"globe",icon:qw,name:"Web"},{id:"smartphone",icon:QD,name:"Mobile"},{id:"laptop",icon:OD,name:"Laptop"},{id:"wifi",icon:sR,name:"Wifi"}],people:[{id:"user",icon:qn,name:"Utilisateur"},{id:"users",icon:st,name:"quipe"},{id:"user-plus",icon:_m,name:"Ajouter"},{id:"brain",icon:Ww,name:"Intelligence"},{id:"graduation",icon:ID,name:"ducation"}],communication:[{id:"mail",icon:rr,name:"Email"},{id:"phone",icon:km,name:"Tlphone"},{id:"message",icon:ky,name:"Message"},{id:"send",icon:Em,name:"Envoyer"},{id:"bell",icon:Wp,name:"Notification"}],status:[{id:"check",icon:tt,name:"Valid"},{id:"x-circle",icon:vu,name:"Refus"},{id:"alert",icon:fD,name:"Attention"},{id:"info",icon:LD,name:"Info"},{id:"lightbulb",icon:ca,name:"Ide"}],misc:[{id:"rocket",icon:qr,name:"Fuse"},{id:"zap",icon:eN,name:"clair"},{id:"award",icon:Uw,name:"Rcompense"},{id:"gem",icon:_D,name:"Premium"},{id:"crown",icon:Hp,name:"Couronne"},{id:"gift",icon:TD,name:"Cadeau"},{id:"flag",icon:Hw,name:"Drapeau"},{id:"bookmark",icon:ND,name:"Signet"}],social:[{id:"thumbs-up",icon:Ey,name:"Like"},{id:"thumbs-down",icon:eR,name:"Dislike"},{id:"github",icon:AD,name:"GitHub"},{id:"linkedin",icon:zD,name:"LinkedIn"},{id:"twitter",icon:rR,name:"Twitter"}]},co=[{id:"shapes",name:"Formes",icon:Sy},{id:"arrows",name:"Flches",icon:xa},{id:"business",name:"Business",icon:Vp},{id:"tech",name:"Tech",icon:jy},{id:"people",name:"Personnes",icon:st},{id:"communication",name:"Communication",icon:ky},{id:"status",name:"Statuts",icon:tt},{id:"misc",name:"Divers",icon:ua},{id:"social",name:"Social",icon:Ey}],[Ra,uo]=S.useState("shapes"),ti=()=>Object.values(Da).flat(),bC=[{id:"design",icon:qD,label:"Design"},{id:"elements",icon:PD,label:"lments"},{id:"text",icon:Jw,label:"Texte"},{id:"images",icon:Gw,label:"Images"},{id:"videos",icon:$c,label:"Vidos"},{id:"ai",icon:_y,label:"IA"}];S.useEffect(()=>{NC()},[e]),S.useEffect(()=>{const I=q=>{f&&(q.key==="ArrowRight"||q.key===" "?p(ue=>Math.min(u.length-1,ue+1)):q.key==="ArrowLeft"?p(ue=>Math.max(0,ue-1)):q.key==="Escape"&&x(!1))};return window.addEventListener("keydown",I),()=>window.removeEventListener("keydown",I)},[f,u.length]);const[Ol,Px]=S.useState(!1),[Bl,wC]=S.useState(!0);S.useEffect(()=>{Bl||Px(!0)},[u]),S.useEffect(()=>{if(!Ol||Bl||t)return;const I=setTimeout(async()=>{try{if(l)await K.put(`/pitch-deck/project/${e}/slides`,{slides:u});else{const q=await K.post(`/pitch-deck/project/${e}/create`,{template:"custom",slides:u});c(q.data.pitchDeck)}Px(!1),console.log("Auto-saved")}catch(q){console.error("Auto-save failed:",q)}},1500);return()=>clearTimeout(I)},[Ol,u,l,e,Bl,t]);const NC=async()=>{try{const[I,q]=await Promise.all([K.get(`/projects/${e}`),K.get(`/pitch-deck/project/${e}`)]);o(I.data.project),q.data.pitchDeck?(c(q.data.pitchDeck),d(q.data.pitchDeck.slides||Fx())):d(Fx())}catch{$.error("Erreur lors du chargement")}finally{n(!1),setTimeout(()=>wC(!1),500)}},Fx=()=>[{id:1,type:"title",title:"Ma Prsentation",content:"Sous-titre de votre prsentation",template:"modern-beige",media:[],elements:[]}],jC=async()=>{s(!0);try{if(l)await K.put(`/pitch-deck/project/${e}/slides`,{slides:u});else{const I=await K.post(`/pitch-deck/project/${e}/create`,{template:"custom",slides:u});c(I.data.pitchDeck)}$.success("Sauvegard !")}catch{$.error("Erreur de sauvegarde")}finally{s(!1)}},ft=(I,q,ue)=>{const ae=[...u];ae[I]={...ae[I],[q]:ue},d(ae)},CC=()=>{var ae;const I=((ae=u[h])==null?void 0:ae.template)||"minimal-white",q={id:Date.now(),type:"content",title:"Nouveau slide",content:"",template:I,media:[],elements:[]},ue=[...u];ue.splice(h+1,0,q),d(ue),p(h+1)},kC=()=>{const I={...u[h],id:Date.now()},q=[...u];q.splice(h+1,0,I),d(q),p(h+1),$.success("Slide dupliqu")},SC=()=>{if(u.length<=1){$.error("Gardez au moins un slide");return}const I=u.filter((q,ue)=>ue!==h);d(I),p(Math.max(0,h-1))},Mx=I=>{ft(h,"template",I.id),I.colors&&ft(h,"customColors",I.colors),$.success(`Template "${I.name}" appliqu`)},EC=I=>{const q=I.target.files[0];if(q){const ue=new FileReader;ue.onloadend=()=>{var pe;const ae={id:Date.now(),type:"image",url:ue.result,x:60,y:30,width:35,height:40};ft(h,"media",[...((pe=u[h])==null?void 0:pe.media)||[],ae]),$.success("Image ajoute")},ue.readAsDataURL(q)}},DC=()=>{var ue,ae,pe,De;if(!L.trim()){$.error("Entrez une URL");return}let I=L;L.includes("youtube.com/watch")?I=`https://www.youtube.com/embed/${(ue=L.split("v=")[1])==null?void 0:ue.split("&")[0]}`:L.includes("youtu.be/")?I=`https://www.youtube.com/embed/${(ae=L.split("youtu.be/")[1])==null?void 0:ae.split("?")[0]}`:L.includes("vimeo.com/")&&(I=`https://player.vimeo.com/video/${(pe=L.split("vimeo.com/")[1])==null?void 0:pe.split("?")[0]}`);const q={id:Date.now(),type:"video",url:I,isEmbed:!0,x:55,y:25,width:40,height:45};ft(h,"media",[...((De=u[h])==null?void 0:De.media)||[],q]),U(""),W(!1),$.success("Vido ajoute")},RC=I=>{const q=I.target.files[0];if(q){if(q.size>50*1024*1024){$.error("Vido trop lourde (max 50MB)");return}const ue=new FileReader;ue.onloadend=()=>{var pe;const ae={id:Date.now(),type:"video",url:ue.result,isLocal:!0,x:55,y:25,width:40,height:45};ft(h,"media",[...((pe=u[h])==null?void 0:pe.media)||[],ae]),$.success("Vido locale ajoute")},ue.readAsDataURL(q)}},ho=(I,q,ue)=>{var De;const pe=(((De=u[h])==null?void 0:De.media)||[]).map(Oe=>Oe.id===I?{...Oe,width:Math.max(10,Math.min(90,Oe.width+q)),height:Math.max(10,Math.min(90,Oe.height+ue))}:Oe);ft(h,"media",pe)},_C=(I,q,ue)=>{var De;const pe=(((De=u[h])==null?void 0:De.media)||[]).map(Oe=>Oe.id===I?{...Oe,x:Math.max(0,Math.min(100,q)),y:Math.max(0,Math.min(100,ue))}:Oe);ft(h,"media",pe)},Ad=I=>{var ue,ae;const q=((ae=(ue=u[h])==null?void 0:ue.media)==null?void 0:ae.filter(pe=>pe.id!==I))||[];ft(h,"media",q),P(null),$.success("Mdia supprim")},Qe=(I,q)=>{var pe;const ae=(((pe=u[h])==null?void 0:pe.elements)||[]).map(De=>De.id===I?{...De,...q}:De);ft(h,"elements",ae)},Id=I=>{var ue,ae;const q=((ae=(ue=u[h])==null?void 0:ue.elements)==null?void 0:ae.filter(pe=>pe.id!==I))||[];ft(h,"elements",q),B(null),$.success("lment supprim")},Jr=(I,q,ue,ae="drag")=>{I.preventDefault(),I.stopPropagation();const pe=ce.current;if(!pe)return;const De=pe.getBoundingClientRect();xe({x:I.clientX,y:I.clientY,canvasWidth:De.width,canvasHeight:De.height}),de(ue),ue==="media"?(P(q),A(null)):(A(q),P(null)),ae==="resize"?ye(!0):le(!0)},TC=I=>{var Er,vs,D0,R0,_0,T0,A0,I0;if(!se&&!he)return;const q=ce.current;if(!q)return;const ue=q.getBoundingClientRect(),ae=ue.width,pe=ue.height,De=(I.clientX-Ce.x)/ae*100,Oe=(I.clientY-Ce.y)/pe*100;if(Z==="media"&&E){const rt=(vs=(Er=u[h])==null?void 0:Er.media)==null?void 0:vs.find(It=>It.id===E);if(!rt)return;if(he)ho(E,De,Oe);else if(se){const It=Math.max(0,Math.min(100-rt.width,rt.x+De)),Zr=Math.max(0,Math.min(100-rt.height,rt.y+Oe));_C(E,It,Zr)}}else if(Z==="element"&&Re){const rt=(R0=(D0=u[h])==null?void 0:D0.elements)==null?void 0:R0.find(It=>It.id===Re);if(!rt)return;if(rt.type==="text"){if(se){const It=Math.max(0,Math.min(90,rt.x+De)),Zr=Math.max(0,Math.min(90,rt.y+Oe));Qe(Re,{x:It,y:Zr})}}else if(he&&rt.size!==void 0){const It=Math.max(16,Math.min(200,rt.size+De));Ox(Re,{size:It})}else if(se){const It=Math.max(0,Math.min(90,rt.x+De)),Zr=Math.max(0,Math.min(90,rt.y+Oe));Ox(Re,{x:It,y:Zr})}}else if(Z==="slideTitle"&&se){const rt=((_0=u[h])==null?void 0:_0.titleStyle)||{},It=Math.max(0,Math.min(90,(rt.x||5)+De)),Zr=Math.max(0,Math.min(90,(rt.y||10)+Oe));ft(h,"titleStyle",{...rt,x:It,y:Zr})}else if(Z==="slideContent"&&se){const rt=((T0=u[h])==null?void 0:T0.contentStyle)||{},It=Math.max(0,Math.min(90,(rt.x||5)+De)),Zr=Math.max(0,Math.min(90,(rt.y||30)+Oe));ft(h,"contentStyle",{...rt,x:It,y:Zr})}else if(Z==="textResize"&&he&&Re){const rt=(I0=(A0=u[h])==null?void 0:A0.elements)==null?void 0:I0.find(It=>It.id===Re);if(rt){const It=Math.max(8,Math.min(200,(rt.fontSize||16)+De*.5));Qe(Re,{fontSize:Math.round(It)})}}xe(rt=>({...rt,x:I.clientX,y:I.clientY}))},Lx=()=>{le(!1),ye(!1),de(null)},Ox=(I,q)=>{var pe;const ae=(((pe=u[h])==null?void 0:pe.elements)||[]).map(De=>De.id===I?{...De,...q}:De);ft(h,"elements",ae)},AC=(I,q)=>{I.preventDefault(),I.stopPropagation(),Jr(I,q,"element","drag"),B(q),y("text")},IC=(I,q)=>{I.stopPropagation(),B(q.id),_e(q.text),y("text")},PC=(I,q)=>{var ae,pe;const ue={id:Date.now(),elementId:I.id,type:q,x:50+Math.random()*20,y:50+Math.random()*20,size:48,color:ni((ae=u[h])==null?void 0:ae.template).accent};ft(h,"elements",[...((pe=u[h])==null?void 0:pe.elements)||[],ue]),$.success(`${I.name} ajout`)},Pd=I=>{var ue,ae,pe,De;const q={id:Date.now(),type:"text",text:I.text,x:10,y:(ae=(ue=u[h])==null?void 0:ue.elements)!=null&&ae.length?60:40,fontSize:I.fontSize,fontWeight:I.fontWeight,color:ni((pe=u[h])==null?void 0:pe.template).text};ft(h,"elements",[...((De=u[h])==null?void 0:De.elements)||[],q])},FC=async()=>{if(!b.trim()){$.error("Dcrivez votre prsentation");return}C(!0);try{await new Promise(q=>setTimeout(q,2e3));const I=[{id:"option-1",name:"Pitch Investisseur",description:"Structure classique pour lever des fonds",template:"startup-purple",slides:[{id:1,type:"title",title:b.split(" ").slice(0,5).join(" "),content:"Rvolutionnez votre industrie",template:"startup-purple",media:[],elements:[]},{id:2,type:"content",title:" Le Problme",content:` Douleur client identifie
 Impact conomique
 Urgence de la solution`,template:"startup-purple",media:[],elements:[]},{id:3,type:"content",title:" Notre Solution",content:` Innovation unique
 Avantage concurrentiel
 Technologie propritaire`,template:"startup-purple",media:[],elements:[]},{id:4,type:"content",title:" Le March",content:` TAM: XX milliards
 SAM: XX millions
 SOM: XX millions`,template:"startup-purple",media:[],elements:[]},{id:5,type:"content",title:" Business Model",content:` Revenue SaaS
 Marge: XX%
 LTV/CAC: X:1`,template:"startup-purple",media:[],elements:[]},{id:6,type:"content",title:" Traction",content:` X utilisateurs actifs
 +XX% MoM
 Clients rfrences`,template:"startup-purple",media:[],elements:[]},{id:7,type:"content",title:" L'quipe",content:` CEO - Vision & Strategy
 CTO - Tech & Product
 CMO - Growth`,template:"startup-purple",media:[],elements:[]},{id:8,type:"content",title:" Ask",content:` Leve: X millions
 Utilisation: Produit, quipe, Marketing
 Contact: hello@startup.com`,template:"startup-purple",media:[],elements:[]}]},{id:"option-2",name:"Prsentation Produit",description:"Focus sur les fonctionnalits et bnfices",template:"modern-beige",slides:[{id:1,type:"title",title:b.split(" ").slice(0,5).join(" "),content:"La solution qui change tout",template:"modern-beige",media:[],elements:[]},{id:2,type:"content",title:"Pourquoi nous?",content:` Simplicit d'utilisation
 Rsultats prouvs
 Support ddi`,template:"modern-beige",media:[],elements:[]},{id:3,type:"content",title:"Fonctionnalits cls",content:` Feature 1 - Gain de temps
 Feature 2 - Automatisation
 Feature 3 - Analytics`,template:"modern-beige",media:[],elements:[]},{id:4,type:"content",title:"Comment a marche",content:`1. Inscrivez-vous
2. Configurez
3. Profitez des rsultats`,template:"modern-beige",media:[],elements:[]},{id:5,type:"content",title:"Tmoignages",content:`"Incroyable!" - Client A
"Indispensable" - Client B`,template:"modern-beige",media:[],elements:[]},{id:6,type:"content",title:"Tarifs",content:` Starter: Gratuit
 Pro: XX/mois
 Enterprise: Sur devis`,template:"modern-beige",media:[],elements:[]}]},{id:"option-3",name:"Story Telling",description:"Narrative immersive et motionnelle",template:"dark-premium",slides:[{id:1,type:"title",title:b.split(" ").slice(0,5).join(" "),content:"Une histoire qui inspire",template:"dark-premium",media:[],elements:[]},{id:2,type:"content",title:"Il tait une fois...",content:"Un problme que tout le monde connat mais que personne n'osait rsoudre.",template:"dark-premium",media:[],elements:[]},{id:3,type:"content",title:"Le dclic",content:"C'est alors que nous avons eu une ide folle...",template:"dark-premium",media:[],elements:[]},{id:4,type:"content",title:"La transformation",content:"Aujourd'hui, des milliers de personnes vivent mieux grce  nous.",template:"dark-premium",media:[],elements:[]},{id:5,type:"content",title:"Rejoignez l'aventure",content:"Ensemble, crivons la suite de cette histoire.",template:"dark-premium",media:[],elements:[]}]}];ze(I),$.success("3 options gnres ! Choisissez celle qui vous convient.")}catch{$.error("Erreur de gnration")}finally{C(!1)}},MC=I=>{d(I.slides),p(0),ze(null),g(!1),$.success(`"${I.name}" appliqu !`)},ni=(I,q=h)=>{const ue=u[q];return ue!=null&&ue.customColors?ue.customColors:(mn.find(pe=>pe.id===I)||mn[0]).colors};if(t)return a.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-900",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-400",children:"Chargement de l'diteur..."})]})});if(f){const I=ni((Bx=u[h])==null?void 0:Bx.template);return a.jsxs("div",{className:"fixed inset-0 bg-gray-900 z-50 flex flex-col",children:[a.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:a.jsxs("div",{className:"w-full max-w-6xl aspect-video rounded-lg shadow-2xl p-12 relative overflow-hidden",style:{background:I.bg,color:I.text},children:[(zx=($x=u[h])==null?void 0:$x.elements)==null?void 0:zx.map(q=>{if(q.type==="text")return a.jsx("div",{style:{position:"absolute",left:`${q.x}%`,top:`${q.y}%`,fontSize:q.fontSize,fontWeight:q.fontWeight,color:q.color},children:q.text},q.id);const ue=ti().find(ae=>ae.id===q.elementId);if(ue){const ae=ue.icon;return a.jsx("div",{style:{position:"absolute",left:`${q.x}%`,top:`${q.y}%`,transform:"translate(-50%, -50%)"},children:a.jsx(ae,{size:q.size*1.5,style:{color:q.color}})},q.id)}return null}),a.jsxs("div",{className:"flex h-full gap-8",children:[a.jsxs("div",{className:"flex-1 flex flex-col justify-center",children:[a.jsx("h1",{className:"mb-6",style:{fontSize:`${((Wx=(Ux=u[h])==null?void 0:Ux.titleStyle)==null?void 0:Wx.fontSize)||48}px`,fontWeight:((Hx=(Vx=u[h])==null?void 0:Vx.titleStyle)==null?void 0:Hx.fontWeight)||"bold",fontFamily:((Gx=(qx=u[h])==null?void 0:qx.titleStyle)==null?void 0:Gx.fontFamily)||"Inter",color:((Xx=(Kx=u[h])==null?void 0:Kx.titleStyle)==null?void 0:Xx.color)||I.text,fontStyle:(Qx=(Yx=u[h])==null?void 0:Yx.titleStyle)!=null&&Qx.italic?"italic":"normal",textDecoration:`${(Zx=(Jx=u[h])==null?void 0:Jx.titleStyle)!=null&&Zx.underline?"underline":""} ${(tg=(eg=u[h])==null?void 0:eg.titleStyle)!=null&&tg.strikethrough?"line-through":""}`.trim()||"none",textAlign:((rg=(ng=u[h])==null?void 0:ng.titleStyle)==null?void 0:rg.align)||"left"},children:(ag=u[h])==null?void 0:ag.title}),a.jsx("div",{className:"whitespace-pre-wrap",style:{fontSize:`${((ig=(sg=u[h])==null?void 0:sg.contentStyle)==null?void 0:ig.fontSize)||24}px`,fontWeight:((lg=(og=u[h])==null?void 0:og.contentStyle)==null?void 0:lg.fontWeight)||"normal",fontFamily:((ug=(cg=u[h])==null?void 0:cg.contentStyle)==null?void 0:ug.fontFamily)||"Inter",color:((hg=(dg=u[h])==null?void 0:dg.contentStyle)==null?void 0:hg.color)||I.text,fontStyle:(fg=(pg=u[h])==null?void 0:pg.contentStyle)!=null&&fg.italic?"italic":"normal",textDecoration:`${(xg=(mg=u[h])==null?void 0:mg.contentStyle)!=null&&xg.underline?"underline":""} ${(vg=(gg=u[h])==null?void 0:gg.contentStyle)!=null&&vg.strikethrough?"line-through":""}`.trim()||"none",textAlign:((bg=(yg=u[h])==null?void 0:yg.contentStyle)==null?void 0:bg.align)||"left",opacity:.9},children:(wg=u[h])==null?void 0:wg.content})]}),((jg=(Ng=u[h])==null?void 0:Ng.media)==null?void 0:jg.length)>0&&a.jsx("div",{className:"w-2/5 flex flex-col justify-center gap-4",children:u[h].media.map(q=>q.type==="image"?a.jsx("img",{src:q.url,alt:"",className:"max-h-80 object-contain rounded-xl"},q.id):a.jsx("iframe",{src:q.url,className:"w-full aspect-video rounded-xl",frameBorder:"0",allowFullScreen:!0},q.id))})]})]})}),a.jsxs("div",{className:"p-4 flex items-center justify-between bg-gray-800/90",children:[a.jsx("button",{onClick:()=>x(!1),className:"px-4 py-2 text-white hover:bg-white/10 rounded-lg",children:"Quitter"}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("button",{onClick:()=>p(Math.max(0,h-1)),disabled:h===0,className:"p-2 text-white hover:bg-white/10 rounded-lg disabled:opacity-50",children:a.jsx(Gi,{className:"w-6 h-6"})}),a.jsxs("span",{className:"text-white",children:[h+1," / ",u.length]}),a.jsx("button",{onClick:()=>p(Math.min(u.length-1,h+1)),disabled:h===u.length-1,className:"p-2 text-white hover:bg-white/10 rounded-lg disabled:opacity-50",children:a.jsx(ga,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"text-white/50 text-sm",children:"  pour naviguer  Esc pour quitter"})]})]})}const $l=ni((Cg=u[h])==null?void 0:Cg.template);return a.jsxs("div",{className:"h-screen flex flex-col bg-gray-100",children:[a.jsxs("div",{className:"h-14 bg-white border-b flex items-center justify-between px-4 shadow-sm",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(ve,{to:`/projects/${e}`,className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(yn,{className:"w-5 h-5 text-gray-600"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"font-semibold text-gray-900",children:(i==null?void 0:i.name)||"Pitch Deck"}),a.jsx("p",{className:"text-xs text-gray-500",children:"diteur de prsentation"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg text-gray-600",children:a.jsx(aR,{className:"w-5 h-5"})}),a.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg text-gray-600",children:a.jsx(KD,{className:"w-5 h-5"})}),a.jsx("div",{className:"h-6 w-px bg-gray-300 mx-2"}),a.jsxs("select",{value:k,onChange:I=>R(Number(I.target.value)),className:"text-sm border rounded-lg px-2 py-1",children:[a.jsx("option",{value:50,children:"50%"}),a.jsx("option",{value:75,children:"75%"}),a.jsx("option",{value:100,children:"100%"}),a.jsx("option",{value:125,children:"125%"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:()=>x(!0),className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-gray-700",children:[a.jsx(Qw,{className:"w-4 h-4"}),"Prsenter"]}),Ol&&a.jsxs("span",{className:"text-xs text-gray-400 flex items-center gap-1",children:[a.jsx("div",{className:"w-2 h-2 bg-yellow-400 rounded-full animate-pulse"}),"Sauvegarde auto..."]}),!Ol&&!Bl&&a.jsxs("span",{className:"text-xs text-green-500 flex items-center gap-1",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Sauvegard"]}),a.jsxs("button",{onClick:jC,disabled:r,className:"flex items-center gap-2 px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg",children:[a.jsx(Xs,{className:"w-4 h-4"}),r?"Sauvegarde...":"Sauvegarder"]})]})]}),a.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[a.jsx("div",{className:"w-16 bg-gray-900 flex flex-col items-center py-4 gap-1",children:bC.map(I=>{const q=I.icon;return a.jsxs("button",{onClick:()=>y(I.id),className:`w-12 h-12 flex flex-col items-center justify-center rounded-lg transition-colors ${v===I.id?"bg-primary-600 text-white":"text-gray-400 hover:bg-gray-800 hover:text-white"}`,children:[a.jsx(q,{className:"w-5 h-5"}),a.jsx("span",{className:"text-[10px] mt-1",children:I.label})]},I.id)})}),a.jsx("div",{className:"w-72 bg-white border-r overflow-y-auto",children:a.jsxs("div",{className:"p-4",children:[v==="ai"&&a.jsxs("div",{children:[a.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[a.jsx(_y,{className:"w-5 h-5 text-primary-600"}),"Assistant IA"]}),be?a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Choisissez la prsentation qui vous convient :"}),a.jsx("div",{className:"space-y-3",children:be.map(I=>{var ue,ae;const q=ni(I.template);return a.jsxs("div",{className:"border rounded-lg overflow-hidden hover:shadow-lg transition-all cursor-pointer group",onClick:()=>MC(I),children:[a.jsxs("div",{className:"h-20 p-3 flex flex-col justify-center",style:{background:q.bg,color:q.text},children:[a.jsx("div",{className:"text-xs font-bold truncate",children:(ue=I.slides[0])==null?void 0:ue.title}),a.jsx("div",{className:"text-[10px] opacity-70 truncate",children:(ae=I.slides[0])==null?void 0:ae.content})]}),a.jsxs("div",{className:"p-3 bg-white",children:[a.jsx("h4",{className:"font-semibold text-sm text-gray-900",children:I.name}),a.jsx("p",{className:"text-xs text-gray-500",children:I.description}),a.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[I.slides.length," slides"]})]}),a.jsx("div",{className:"px-3 pb-3",children:a.jsx("button",{className:"w-full py-2 bg-primary-100 text-primary-700 rounded-lg text-sm font-medium group-hover:bg-primary-600 group-hover:text-white transition-colors",children:"Utiliser ce modle"})})]},I.id)})}),a.jsx("button",{onClick:()=>ze(null),className:"w-full mt-4 py-2 text-gray-600 hover:text-gray-900 text-sm",children:" Gnrer de nouvelles options"})]}):a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Dcrivez votre prsentation et l'IA gnrera plusieurs options  choisir."}),a.jsx("textarea",{value:b,onChange:I=>w(I.target.value),placeholder:"Ex: Une prsentation pour lever des fonds pour une app de livraison cologique...",className:"w-full h-32 p-3 border rounded-lg resize-none text-sm"}),a.jsxs("button",{onClick:FC,disabled:N,className:"w-full mt-3 py-3 bg-gradient-to-r from-primary-600 to-purple-600 text-white rounded-lg flex items-center justify-center gap-2 hover:opacity-90 disabled:opacity-50",children:[a.jsx(ua,{className:"w-4 h-4"}),N?"Gnration en cours...":"Gnrer des options"]}),a.jsx("div",{className:"mt-4 p-3 bg-purple-50 rounded-lg",children:a.jsxs("p",{className:"text-xs text-purple-700",children:[a.jsx("strong",{children:" Style Gamma :"})," L'IA gnre 3 versions diffrentes. Vous choisissez celle qui vous convient !"]})})]})]}),v==="design"&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex gap-1 mb-4 p-1 bg-gray-100 rounded-lg",children:[a.jsx("button",{onClick:()=>Ae("templates"),className:`flex-1 py-2 px-3 rounded-md text-sm font-medium transition-all ${Me==="templates"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Modles"}),a.jsx("button",{onClick:()=>Ae("styles"),className:`flex-1 py-2 px-3 rounded-md text-sm font-medium transition-all ${Me==="styles"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Styles"})]}),Me==="templates"&&a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Cliquez pour appliquer au slide actuel"}),a.jsx("div",{className:"grid grid-cols-2 gap-3",children:mn.map(I=>{var q;return a.jsxs("button",{onClick:()=>Mx(I),className:`rounded-lg overflow-hidden transition-all hover:scale-105 ${((q=u[h])==null?void 0:q.template)===I.id?"ring-2 ring-primary-500 ring-offset-2":"hover:shadow-lg"}`,children:[a.jsxs("div",{className:"w-full aspect-video p-2 flex flex-col justify-center",style:{background:I.previewBg||I.colors.bg},children:[a.jsx("div",{className:"h-2 w-3/4 rounded mb-1",style:{backgroundColor:I.colors.text,opacity:.9}}),a.jsx("div",{className:"h-1.5 w-1/2 rounded mb-2",style:{backgroundColor:I.colors.text,opacity:.5}}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("div",{className:"h-1 w-full rounded",style:{backgroundColor:I.colors.text,opacity:.3}}),a.jsx("div",{className:"h-1 w-4/5 rounded",style:{backgroundColor:I.colors.text,opacity:.3}})]})]}),a.jsxs("div",{className:"bg-white px-2 py-1.5 border-t",children:[a.jsx("p",{className:"text-xs font-medium text-gray-800 truncate",children:I.name}),a.jsx("p",{className:"text-[10px] text-gray-400",children:I.category})]})]},I.id)})})]}),Me==="styles"&&a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Palettes de couleurs et polices"}),a.jsx("h4",{className:"font-medium text-gray-900 text-sm mb-2",children:"Palettes de couleurs"}),a.jsx("div",{className:"grid grid-cols-3 gap-2 mb-4",children:[{id:"warm",colors:["#FF6B6B","#FFA500","#FFD93D"],name:"Chaud",bg:"#FFF5F5",text:"#C41E3A"},{id:"cool",colors:["#6B5BFF","#00D4FF","#00FF88"],name:"Froid",bg:"#F0F4FF",text:"#1E3A8A"},{id:"earth",colors:["#8B4513","#DAA520","#228B22"],name:"Terre",bg:"#FAF5EF",text:"#5D4037"},{id:"ocean",colors:["#1E90FF","#00CED1","#20B2AA"],name:"Ocan",bg:"#E0F7FA",text:"#006064"},{id:"sunset",colors:["#FF4500","#FF6347","#FFB6C1"],name:"Coucher",bg:"#FFF3E0",text:"#E65100"},{id:"mono",colors:["#2C3E50","#7F8C8D","#ECF0F1"],name:"Mono",bg:"#FFFFFF",text:"#2C3E50"},{id:"purple",colors:["#9B59B6","#8E44AD","#E8DAEF"],name:"Violet",bg:"#F5EEF8",text:"#6C3483"},{id:"green",colors:["#27AE60","#2ECC71","#D5F5E3"],name:"Vert",bg:"#E8F8F5",text:"#1E8449"},{id:"dark",colors:["#1A1A2E","#16213E","#E94560"],name:"Sombre",bg:"#1A1A2E",text:"#FFFFFF"}].map(I=>a.jsxs("button",{onClick:()=>{const q={id:`custom-${I.id}`,name:I.name,colors:{bg:I.bg,text:I.text,accent:I.colors[0]}};Mx(q),$.success(`Palette "${I.name}" applique !`)},className:"p-2 rounded-lg border hover:border-primary-500 hover:shadow transition-all hover:scale-105",children:[a.jsx("div",{className:"flex gap-0.5 mb-1",children:I.colors.map((q,ue)=>a.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:q}},ue))}),a.jsx("p",{className:"text-[10px] text-gray-600",children:I.name})]},I.id))}),a.jsx("h4",{className:"font-medium text-gray-900 text-sm mb-2",children:"Combinaisons de polices"}),a.jsx("div",{className:"space-y-2",children:[{id:"modern",title:"Inter",body:"Inter",label:"Moderne"},{id:"classic",title:"Georgia",body:"Arial",label:"Classique"},{id:"elegant",title:"Playfair Display",body:"Georgia",label:"lgant"},{id:"tech",title:"Courier New",body:"Verdana",label:"Tech"},{id:"bold",title:"Impact",body:"Arial",label:"Audacieux"},{id:"friendly",title:"Comic Sans MS",body:"Verdana",label:"Amical"}].map(I=>a.jsxs("button",{onClick:()=>{var De,Oe,Er;const q=((De=u[h])==null?void 0:De.titleStyle)||{};ft(h,"titleStyle",{...q,fontFamily:I.title});const ue=((Oe=u[h])==null?void 0:Oe.contentStyle)||{};ft(h,"contentStyle",{...ue,fontFamily:I.body});const pe=(((Er=u[h])==null?void 0:Er.elements)||[]).map(vs=>vs.type==="text"?{...vs,fontFamily:vs.fontSize>20?I.title:I.body}:vs);ft(h,"elements",pe),$.success(`Police "${I.label}" applique !`)},className:"w-full p-3 border rounded-lg hover:border-primary-500 hover:shadow text-left transition-all hover:scale-[1.02]",children:[a.jsx("p",{className:"font-bold text-sm",style:{fontFamily:I.title},children:I.label}),a.jsx("p",{className:"text-xs text-gray-500",style:{fontFamily:I.body},children:"Texte de paragraphe"})]},I.id))})]})]}),v==="elements"&&a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"lments"}),a.jsx("div",{className:"flex flex-wrap gap-1 mb-4",children:co.map(I=>{const q=I.icon;return a.jsxs("button",{onClick:()=>uo(I.id),className:`px-2 py-1.5 rounded-lg text-xs flex items-center gap-1 transition-all ${Ra===I.id?"bg-primary-100 text-primary-700 font-medium":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[a.jsx(q,{className:"w-3 h-3"}),I.name]},I.id)})}),a.jsx("div",{className:"grid grid-cols-4 gap-2",children:(kg=Da[Ra])==null?void 0:kg.map(I=>{const q=I.icon;return a.jsxs("button",{onClick:()=>PC(I,"icon"),className:"p-3 bg-gray-100 hover:bg-gray-200 rounded-lg group relative",title:I.name,children:[a.jsx(q,{className:"w-6 h-6 mx-auto text-gray-700 group-hover:text-primary-600 transition-colors"}),a.jsx("span",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 text-[9px] text-gray-500 opacity-0 group-hover:opacity-100 whitespace-nowrap",children:I.name})]},I.id)})}),a.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg text-xs text-blue-700",children:a.jsxs("p",{children:[a.jsx("strong",{children:"Astuce :"})," Cliquez sur un lment pour l'ajouter au slide. Glissez pour le dplacer, utilisez les poignes pour redimensionner."]})})]}),v==="text"&&a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Ajouter du texte"}),a.jsxs("div",{className:"space-y-2 mb-4",children:[a.jsx("button",{onClick:()=>Pd({text:"Titre",fontSize:32,fontWeight:"bold"}),className:"w-full p-3 bg-gray-100 hover:bg-gray-200 rounded-lg text-left",children:a.jsx("span",{className:"text-xl font-bold",children:"Ajouter un titre"})}),a.jsx("button",{onClick:()=>Pd({text:"Sous-titre",fontSize:24,fontWeight:"600"}),className:"w-full p-3 bg-gray-100 hover:bg-gray-200 rounded-lg text-left",children:a.jsx("span",{className:"text-lg font-semibold",children:"Ajouter un sous-titre"})}),a.jsx("button",{onClick:()=>Pd({text:"Corps de texte",fontSize:16,fontWeight:"normal"}),className:"w-full p-3 bg-gray-100 hover:bg-gray-200 rounded-lg text-left",children:a.jsx("span",{className:"text-sm",children:"Ajouter du texte"})})]}),Te&&!_&&(()=>{var De;const I=Te==="title"?"titleStyle":"contentStyle",q=((De=u[h])==null?void 0:De[I])||{},ue=Te==="title"?32:18,ae=Te==="title"?"bold":"normal",pe=Oe=>{const Er={...q,...Oe};ft(h,I,Er)};return a.jsxs("div",{className:"border-t pt-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:Te==="title"?" Modifier le titre":" Modifier le contenu"}),a.jsx("button",{onClick:()=>Ue(null),className:"text-gray-400 hover:text-gray-600",children:a.jsx(kt,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Police"}),a.jsx("select",{value:q.fontFamily||"Inter",onChange:Oe=>pe({fontFamily:Oe.target.value}),className:"w-full border rounded-lg px-2 py-2 text-sm",style:{fontFamily:q.fontFamily||"Inter"},children:Rt.map(Oe=>a.jsx("option",{value:Oe.id,style:{fontFamily:Oe.id},children:Oe.name},Oe.id))})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Taille"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>pe({fontSize:Math.max(8,(q.fontSize||ue)-2)}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded-lg",children:""}),a.jsx("input",{type:"number",min:"8",max:"200",value:q.fontSize||ue,onChange:Oe=>pe({fontSize:parseInt(Oe.target.value)||ue}),className:"flex-1 border rounded-lg px-2 py-2 text-sm text-center"}),a.jsx("button",{onClick:()=>pe({fontSize:Math.min(200,(q.fontSize||ue)+2)}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded-lg",children:"+"})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Couleur"}),a.jsx("div",{className:"grid grid-cols-6 gap-1 mb-2",children:Xn.map(Oe=>a.jsx("button",{onClick:()=>pe({color:Oe}),className:`w-7 h-7 rounded-md border-2 transition-all ${q.color===Oe?"border-primary-500 scale-110":"border-transparent hover:scale-105"}`,style:{backgroundColor:Oe}},Oe))}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"color",value:q.color||"#000000",onChange:Oe=>pe({color:Oe.target.value}),className:"w-10 h-10 border rounded-lg cursor-pointer"}),a.jsx("input",{type:"text",value:q.color||"#000000",onChange:Oe=>pe({color:Oe.target.value}),className:"flex-1 border rounded-lg px-2 text-sm font-mono"})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Style"}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>pe({fontWeight:q.fontWeight==="bold"?"normal":"bold"}),className:`p-2.5 rounded-lg flex-1 ${(q.fontWeight||ae)==="bold"?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,children:a.jsx(wy,{className:"w-4 h-4 mx-auto"})}),a.jsx("button",{onClick:()=>pe({italic:!q.italic}),className:`p-2.5 rounded-lg flex-1 ${q.italic?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,children:a.jsx(Cy,{className:"w-4 h-4 mx-auto"})}),a.jsx("button",{onClick:()=>pe({underline:!q.underline}),className:`p-2.5 rounded-lg flex-1 ${q.underline?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,children:a.jsx(Ry,{className:"w-4 h-4 mx-auto"})}),a.jsx("button",{onClick:()=>pe({strikethrough:!q.strikethrough}),className:`p-2.5 rounded-lg flex-1 ${q.strikethrough?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,children:a.jsx("span",{className:"text-sm font-medium line-through",children:"S"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Alignement"}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>pe({align:"left"}),className:`p-2.5 rounded-lg flex-1 ${(q.align||"left")==="left"?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,children:a.jsx(yy,{className:"w-4 h-4 mx-auto"})}),a.jsx("button",{onClick:()=>pe({align:"center"}),className:`p-2.5 rounded-lg flex-1 ${q.align==="center"?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,children:a.jsx(vy,{className:"w-4 h-4 mx-auto"})}),a.jsx("button",{onClick:()=>pe({align:"right"}),className:`p-2.5 rounded-lg flex-1 ${q.align==="right"?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,children:a.jsx(by,{className:"w-4 h-4 mx-auto"})})]})]})]})})(),_&&(()=>{var q,ue;const I=(ue=(q=u[h])==null?void 0:q.elements)==null?void 0:ue.find(ae=>ae.id===_);return I?a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("div",{className:"flex gap-1 mb-4 text-xs",children:[{id:"style",label:"Style"},{id:"effects",label:"Effets"},{id:"animate",label:"Animer"},{id:"position",label:"Position"}].map(ae=>a.jsx("button",{onClick:()=>nt(ae.id),className:`flex-1 py-2 px-2 rounded-lg font-medium transition-all ${Ye===ae.id?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:ae.label},ae.id))}),Ye==="style"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Police"}),a.jsx("select",{value:I.fontFamily||"Inter",onChange:ae=>Qe(_,{fontFamily:ae.target.value}),className:"w-full border rounded-lg px-2 py-2 text-sm",style:{fontFamily:I.fontFamily},children:Rt.map(ae=>a.jsx("option",{value:ae.id,style:{fontFamily:ae.id},children:ae.name},ae.id))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Taille"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>Qe(_,{fontSize:Math.max(8,(I.fontSize||16)-2)}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded-lg",children:""}),a.jsx("input",{type:"number",min:"8",max:"200",value:I.fontSize||16,onChange:ae=>Qe(_,{fontSize:parseInt(ae.target.value)||16}),className:"flex-1 border rounded-lg px-2 py-2 text-sm text-center"}),a.jsx("button",{onClick:()=>Qe(_,{fontSize:Math.min(200,(I.fontSize||16)+2)}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded-lg",children:"+"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Couleur du texte"}),a.jsx("div",{className:"grid grid-cols-6 gap-1 mb-2",children:Xn.map(ae=>a.jsx("button",{onClick:()=>Qe(_,{color:ae}),className:`w-7 h-7 rounded-md border-2 transition-all ${I.color===ae?"border-primary-500 scale-110":"border-transparent hover:scale-105"}`,style:{backgroundColor:ae}},ae))}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"color",value:I.color||"#000000",onChange:ae=>Qe(_,{color:ae.target.value}),className:"w-10 h-10 border rounded-lg cursor-pointer"}),a.jsx("input",{type:"text",value:I.color||"#000000",onChange:ae=>Qe(_,{color:ae.target.value}),className:"flex-1 border rounded-lg px-2 text-sm font-mono",placeholder:"#000000"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Style"}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>Qe(_,{fontWeight:I.fontWeight==="bold"?"normal":"bold"}),className:`p-2.5 rounded-lg flex-1 ${I.fontWeight==="bold"?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,title:"Gras",children:a.jsx(wy,{className:"w-4 h-4 mx-auto"})}),a.jsx("button",{onClick:()=>Qe(_,{italic:!I.italic}),className:`p-2.5 rounded-lg flex-1 ${I.italic?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,title:"Italique",children:a.jsx(Cy,{className:"w-4 h-4 mx-auto"})}),a.jsx("button",{onClick:()=>Qe(_,{underline:!I.underline}),className:`p-2.5 rounded-lg flex-1 ${I.underline?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,title:"Soulign",children:a.jsx(Ry,{className:"w-4 h-4 mx-auto"})}),a.jsx("button",{onClick:()=>Qe(_,{strikethrough:!I.strikethrough}),className:`p-2.5 rounded-lg flex-1 ${I.strikethrough?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,title:"Barr",children:a.jsx("span",{className:"text-sm font-medium line-through",children:"S"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Alignement"}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>Qe(_,{align:"left"}),className:`p-2.5 rounded-lg flex-1 ${I.align==="left"||!I.align?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,children:a.jsx(yy,{className:"w-4 h-4 mx-auto"})}),a.jsx("button",{onClick:()=>Qe(_,{align:"center"}),className:`p-2.5 rounded-lg flex-1 ${I.align==="center"?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,children:a.jsx(vy,{className:"w-4 h-4 mx-auto"})}),a.jsx("button",{onClick:()=>Qe(_,{align:"right"}),className:`p-2.5 rounded-lg flex-1 ${I.align==="right"?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,children:a.jsx(by,{className:"w-4 h-4 mx-auto"})})]})]})]}),Ye==="effects"&&a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-xs text-gray-500",children:"Choisissez un effet pour votre texte"}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:Wt.map(ae=>a.jsxs("button",{onClick:()=>Qe(_,{effect:ae.id}),className:`p-3 rounded-lg border-2 text-left transition-all ${I.effect===ae.id?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}`,children:[a.jsx("span",{className:"text-lg font-bold block",style:{...ae.style,color:I.color||"#000"},children:"Ag"}),a.jsx("span",{className:"text-xs text-gray-500",children:ae.name})]},ae.id))})]}),Ye==="animate"&&a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-xs text-gray-500",children:"Ajoutez une animation  votre texte"}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:At.map(ae=>a.jsxs("button",{onClick:()=>Qe(_,{animation:ae.id}),className:`p-3 rounded-lg border-2 text-center transition-all ${I.animation===ae.id?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}`,children:[a.jsx("div",{className:`text-2xl mb-1 ${ae.class}`,children:""}),a.jsx("span",{className:"text-xs text-gray-600",children:ae.name})]},ae.id))})]}),Ye==="position"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-2 block",children:"Aligner sur la page"}),a.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[a.jsx("button",{onClick:()=>Qe(_,{x:5,y:5}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded text-xs",children:" Haut-G"}),a.jsx("button",{onClick:()=>Qe(_,{x:50,y:5}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded text-xs",children:" Haut"}),a.jsx("button",{onClick:()=>Qe(_,{x:85,y:5}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded text-xs",children:" Haut-D"}),a.jsx("button",{onClick:()=>Qe(_,{x:5,y:45}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded text-xs",children:" Gauche"}),a.jsx("button",{onClick:()=>Qe(_,{x:50,y:45}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded text-xs",children:" Centre"}),a.jsx("button",{onClick:()=>Qe(_,{x:85,y:45}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded text-xs",children:" Droite"}),a.jsx("button",{onClick:()=>Qe(_,{x:5,y:85}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded text-xs",children:" Bas-G"}),a.jsx("button",{onClick:()=>Qe(_,{x:50,y:85}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded text-xs",children:" Bas"}),a.jsx("button",{onClick:()=>Qe(_,{x:85,y:85}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded text-xs",children:" Bas-D"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-2 block",children:"Position prcise"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] text-gray-400",children:"X (%)"}),a.jsx("input",{type:"number",min:"0",max:"100",value:Math.round(I.x||0),onChange:ae=>Qe(_,{x:parseFloat(ae.target.value)||0}),className:"w-full border rounded px-2 py-1.5 text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] text-gray-400",children:"Y (%)"}),a.jsx("input",{type:"number",min:"0",max:"100",value:Math.round(I.y||0),onChange:ae=>Qe(_,{y:parseFloat(ae.target.value)||0}),className:"w-full border rounded px-2 py-1.5 text-sm"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-2 block",children:"Rotation"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"range",min:"-180",max:"180",value:I.rotation||0,onChange:ae=>Qe(_,{rotation:parseInt(ae.target.value)}),className:"flex-1"}),a.jsxs("span",{className:"text-xs text-gray-600 w-12 text-right",children:[I.rotation||0,""]})]})]})]}),a.jsx("button",{type:"button",onClick:ae=>{ae.preventDefault(),ae.stopPropagation(),Id(_)},className:"w-full mt-4 py-2 text-red-600 bg-red-50 hover:bg-red-100 rounded-lg text-sm",children:"Supprimer le texte"})]}):null})()]}),v==="images"&&a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Images"}),a.jsx("input",{type:"file",ref:J,onChange:EC,accept:"image/*",className:"hidden"}),a.jsxs("button",{onClick:()=>{var I;return(I=J.current)==null?void 0:I.click()},className:"w-full p-8 border-2 border-dashed border-gray-300 rounded-lg hover:border-primary-500 hover:bg-primary-50 transition-colors",children:[a.jsx(qp,{className:"w-8 h-8 mx-auto text-gray-400 mb-2"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Importer une image"})]}),E&&((Eg=(Sg=u[h])==null?void 0:Sg.media)==null?void 0:Eg.find(I=>I.id===E&&I.type==="image"))&&a.jsxs("div",{className:"mt-4 pt-4 border-t",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Modifier l'image"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Taille"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>ho(E,-5,-5),className:"flex-1 py-2 bg-gray-100 hover:bg-gray-200 rounded text-sm",children:"- Petit"}),a.jsx("button",{onClick:()=>ho(E,5,5),className:"flex-1 py-2 bg-gray-100 hover:bg-gray-200 rounded text-sm",children:"+ Grand"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Taille prcise"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"number",value:((_g=(Rg=(Dg=u[h])==null?void 0:Dg.media)==null?void 0:Rg.find(I=>I.id===E))==null?void 0:_g.width)||35,onChange:I=>{var ae;const ue=(((ae=u[h])==null?void 0:ae.media)||[]).map(pe=>pe.id===E?{...pe,width:parseInt(I.target.value)}:pe);ft(h,"media",ue)},className:"w-full border rounded px-2 py-1 text-sm",placeholder:"Largeur %"}),a.jsx("input",{type:"number",value:((Ig=(Ag=(Tg=u[h])==null?void 0:Tg.media)==null?void 0:Ag.find(I=>I.id===E))==null?void 0:Ig.height)||40,onChange:I=>{var ae;const ue=(((ae=u[h])==null?void 0:ae.media)||[]).map(pe=>pe.id===E?{...pe,height:parseInt(I.target.value)}:pe);ft(h,"media",ue)},className:"w-full border rounded px-2 py-1 text-sm",placeholder:"Hauteur %"})]})]}),a.jsx("button",{type:"button",onClick:I=>{I.preventDefault(),I.stopPropagation(),Ad(E)},className:"w-full py-2 text-red-600 bg-red-50 hover:bg-red-100 rounded-lg text-sm",children:"Supprimer l'image"})]})]})]}),v==="videos"&&a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Vidos"}),a.jsx("input",{type:"file",ref:te,onChange:RC,accept:"video/*",className:"hidden"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("button",{onClick:()=>{var I;return(I=te.current)==null?void 0:I.click()},className:"w-full p-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-primary-500 hover:bg-primary-50 transition-colors",children:[a.jsx(qp,{className:"w-6 h-6 mx-auto text-gray-400 mb-2"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Importer vido locale"}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Max 50MB"})]}),a.jsx("div",{className:"text-center text-gray-400 text-sm",children:"ou"}),a.jsxs("button",{onClick:()=>W(!0),className:"w-full p-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-primary-500 hover:bg-primary-50 transition-colors",children:[a.jsx($D,{className:"w-6 h-6 mx-auto text-gray-400 mb-2"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Lien YouTube/Vimeo"})]})]}),E&&((Fg=(Pg=u[h])==null?void 0:Pg.media)==null?void 0:Fg.find(I=>I.id===E))&&a.jsxs("div",{className:"mt-4 pt-4 border-t",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Modifier le mdia"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Taille"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>ho(E,-5,-5),className:"flex-1 py-2 bg-gray-100 hover:bg-gray-200 rounded text-sm",children:"- Petit"}),a.jsx("button",{onClick:()=>ho(E,5,5),className:"flex-1 py-2 bg-gray-100 hover:bg-gray-200 rounded text-sm",children:"+ Grand"})]})]}),a.jsx("button",{type:"button",onClick:I=>{I.preventDefault(),I.stopPropagation(),Ad(E)},className:"w-full py-2 text-red-600 bg-red-50 hover:bg-red-100 rounded-lg text-sm",children:"Supprimer"})]})]})]})]})}),a.jsx("div",{className:"flex-1 bg-gray-200 p-8 overflow-auto flex items-center justify-center",onMouseMove:TC,onMouseUp:Lx,onMouseLeave:Lx,children:a.jsx("div",{ref:ce,className:"bg-white rounded-lg shadow-xl overflow-hidden",style:{width:`${16*k/100*40}px`,aspectRatio:"16/9"},children:a.jsxs("div",{className:"w-full h-full p-8 relative select-none",style:{background:$l.bg,color:$l.text},onClick:()=>{P(null),B(null),A(null),Ue(null)},children:[(Lg=(Mg=u[h])==null?void 0:Mg.elements)==null?void 0:Lg.map(I=>{if(I.type==="text"){const ue=_===I.id,ae=Wt.find(De=>De.id===I.effect)||Wt[0],pe=At.find(De=>De.id===I.animation)||At[0];return a.jsxs("div",{onMouseDown:De=>AC(De,I.id),onDoubleClick:De=>IC(De,I),className:`absolute cursor-move hover:outline hover:outline-2 hover:outline-primary-300 ${ue?"outline outline-2 outline-primary-500":""} ${pe.class}`,style:{left:`${I.x}%`,top:`${I.y}%`,fontSize:I.fontSize*k/100,fontWeight:I.fontWeight,fontFamily:I.fontFamily||"Inter",color:I.color,fontStyle:I.italic?"italic":"normal",textDecoration:`${I.underline?"underline":""} ${I.strikethrough?"line-through":""}`.trim()||"none",textAlign:I.align||"left",transform:I.rotation?`rotate(${I.rotation}deg)`:"none",minWidth:"50px",...ae.style},children:[ue?a.jsx("input",{type:"text",value:I.text,onChange:De=>Qe(I.id,{text:De.target.value}),className:"bg-transparent border-none outline-none w-full",style:{fontSize:"inherit",fontWeight:"inherit",fontFamily:"inherit",fontStyle:"inherit",textDecoration:"inherit",textAlign:"inherit",color:"inherit"},autoFocus:!0,onClick:De=>De.stopPropagation()}):I.text,ue&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"absolute -right-2 -bottom-2 w-4 h-4 bg-primary-500 rounded-full cursor-se-resize hover:bg-primary-600 hover:scale-110 transition-transform z-10",onMouseDown:De=>{De.preventDefault(),De.stopPropagation();const Oe=ce.current;if(!Oe)return;const Er=Oe.getBoundingClientRect();xe({x:De.clientX,y:De.clientY,canvasWidth:Er.width,canvasHeight:Er.height}),ye(!0),de("textResize"),A(I.id)}}),a.jsx("button",{type:"button",onClick:De=>{De.preventDefault(),De.stopPropagation(),Id(I.id)},className:"absolute -top-3 -right-3 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-xs hover:bg-red-600",children:a.jsx(kt,{className:"w-3 h-3"})}),a.jsxs("div",{className:"absolute -bottom-5 left-0 bg-black/60 text-white text-[10px] px-1.5 py-0.5 rounded whitespace-nowrap",children:[I.fontSize,"px"]})]})]},I.id)}const q=ti().find(ue=>ue.id===I.elementId);if(q){const ue=q.icon,ae=Re===I.id;return a.jsxs("div",{onMouseDown:pe=>Jr(pe,I.id,"element","drag"),onClick:pe=>{pe.stopPropagation(),A(I.id)},className:`absolute cursor-move ${ae?"outline outline-2 outline-primary-500":"hover:outline hover:outline-2 hover:outline-primary-300"}`,style:{left:`${I.x}%`,top:`${I.y}%`,transform:"translate(-50%, -50%)"},children:[a.jsx(ue,{size:I.size*k/100,style:{color:I.color}}),ae&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"absolute -right-2 -bottom-2 w-4 h-4 bg-primary-500 rounded-full cursor-se-resize hover:bg-primary-600 hover:scale-110 transition-transform z-10",onMouseDown:pe=>Jr(pe,I.id,"element","resize")}),a.jsx("div",{className:"absolute -left-2 -top-2 w-4 h-4 bg-primary-500 rounded-full cursor-nw-resize hover:bg-primary-600 hover:scale-110 transition-transform z-10",onMouseDown:pe=>Jr(pe,I.id,"element","resize")}),a.jsx("button",{type:"button",onClick:pe=>{pe.preventDefault(),pe.stopPropagation(),Id(I.id)},className:"absolute -top-4 left-1/2 -translate-x-1/2 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 z-10",children:a.jsx(kt,{className:"w-3 h-3"})}),a.jsxs("div",{className:"absolute -bottom-5 left-1/2 -translate-x-1/2 bg-black/60 text-white text-[10px] px-1.5 py-0.5 rounded whitespace-nowrap",children:[Math.round(I.size),"px"]})]})]},I.id)}return null}),(Bg=(Og=u[h])==null?void 0:Og.media)==null?void 0:Bg.map(I=>a.jsxs("div",{onMouseDown:q=>Jr(q,I.id,"media","drag"),onClick:q=>{q.stopPropagation(),P(I.id),A(null),y(I.type==="image"?"images":"videos")},className:`absolute cursor-move group ${E===I.id?"outline outline-2 outline-primary-500":"hover:outline hover:outline-2 hover:outline-primary-300"}`,style:{left:`${I.x}%`,top:`${I.y}%`,width:`${I.width}%`,height:`${I.height}%`},children:[I.type==="image"?a.jsx("img",{src:I.url,alt:"",className:"w-full h-full object-contain rounded-lg pointer-events-none",draggable:!1}):I.isLocal?a.jsx("video",{src:I.url,className:"w-full h-full object-contain rounded-lg",controls:!0}):a.jsx("iframe",{src:I.url,className:"w-full h-full rounded-lg pointer-events-none",frameBorder:"0"}),E===I.id&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"absolute -right-2 -bottom-2 w-4 h-4 bg-primary-500 rounded-full cursor-se-resize hover:bg-primary-600 hover:scale-110 transition-transform z-10",onMouseDown:q=>Jr(q,I.id,"media","resize")}),a.jsx("div",{className:"absolute -left-2 -top-2 w-4 h-4 bg-primary-500 rounded-full cursor-nw-resize hover:bg-primary-600 hover:scale-110 transition-transform z-10",onMouseDown:q=>Jr(q,I.id,"media","resize")}),a.jsx("div",{className:"absolute -right-2 -top-2 w-4 h-4 bg-primary-500 rounded-full cursor-ne-resize hover:bg-primary-600 hover:scale-110 transition-transform z-10",onMouseDown:q=>Jr(q,I.id,"media","resize")}),a.jsx("div",{className:"absolute -left-2 -bottom-2 w-4 h-4 bg-primary-500 rounded-full cursor-sw-resize hover:bg-primary-600 hover:scale-110 transition-transform z-10",onMouseDown:q=>Jr(q,I.id,"media","resize")}),a.jsx("button",{type:"button",onClick:q=>{q.preventDefault(),q.stopPropagation(),Ad(I.id)},className:"absolute -top-4 right-1/2 translate-x-1/2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center text-xs hover:bg-red-600 shadow-lg z-10",children:a.jsx(kt,{className:"w-3 h-3"})}),a.jsxs("div",{className:"absolute bottom-1 left-1 bg-black/50 text-white text-xs px-1.5 py-0.5 rounded z-10",children:[Math.round(I.width),"%  ",Math.round(I.height),"%"]})]})]},I.id)),a.jsx("div",{onMouseDown:I=>{if(I.target.tagName==="INPUT")return;I.preventDefault(),I.stopPropagation();const q=ce.current;if(!q)return;const ue=q.getBoundingClientRect();xe({x:I.clientX,y:I.clientY,canvasWidth:ue.width,canvasHeight:ue.height}),Ue("title"),le(!0),de("slideTitle")},onClick:I=>{I.stopPropagation(),Ue("title"),B(null),y("text")},className:`absolute cursor-move rounded-lg transition-all ${Te==="title"?"ring-2 ring-primary-500 bg-white/10":"hover:bg-white/5"}`,style:{left:`${((zg=($g=u[h])==null?void 0:$g.titleStyle)==null?void 0:zg.x)||5}%`,top:`${((Wg=(Ug=u[h])==null?void 0:Ug.titleStyle)==null?void 0:Wg.y)||10}%`,maxWidth:"90%"},children:a.jsx("input",{type:"text",value:((Vg=u[h])==null?void 0:Vg.title)||"",onChange:I=>ft(h,"title",I.target.value),className:"bg-transparent border-none outline-none px-2 py-1 cursor-text",style:{color:((qg=(Hg=u[h])==null?void 0:Hg.titleStyle)==null?void 0:qg.color)||$l.text,fontSize:`${(((Kg=(Gg=u[h])==null?void 0:Gg.titleStyle)==null?void 0:Kg.fontSize)||32)*k/100}px`,fontWeight:((Yg=(Xg=u[h])==null?void 0:Xg.titleStyle)==null?void 0:Yg.fontWeight)||"bold",fontFamily:((Jg=(Qg=u[h])==null?void 0:Qg.titleStyle)==null?void 0:Jg.fontFamily)||"Inter",fontStyle:(e0=(Zg=u[h])==null?void 0:Zg.titleStyle)!=null&&e0.italic?"italic":"normal",textDecoration:`${(n0=(t0=u[h])==null?void 0:t0.titleStyle)!=null&&n0.underline?"underline":""} ${(a0=(r0=u[h])==null?void 0:r0.titleStyle)!=null&&a0.strikethrough?"line-through":""}`.trim()||"none",textAlign:((i0=(s0=u[h])==null?void 0:s0.titleStyle)==null?void 0:i0.align)||"left",minWidth:"100px"},placeholder:"Titre"})}),a.jsx("div",{onMouseDown:I=>{if(I.target.tagName==="TEXTAREA")return;I.preventDefault(),I.stopPropagation();const q=ce.current;if(!q)return;const ue=q.getBoundingClientRect();xe({x:I.clientX,y:I.clientY,canvasWidth:ue.width,canvasHeight:ue.height}),Ue("content"),le(!0),de("slideContent")},onClick:I=>{I.stopPropagation(),Ue("content"),B(null),y("text")},className:`absolute cursor-move rounded-lg transition-all ${Te==="content"?"ring-2 ring-primary-500 bg-white/10":"hover:bg-white/5"}`,style:{left:`${((l0=(o0=u[h])==null?void 0:o0.contentStyle)==null?void 0:l0.x)||5}%`,top:`${((u0=(c0=u[h])==null?void 0:c0.contentStyle)==null?void 0:u0.y)||30}%`,maxWidth:"90%"},children:a.jsx("textarea",{value:((d0=u[h])==null?void 0:d0.content)||"",onChange:I=>ft(h,"content",I.target.value),className:"bg-transparent border-none outline-none resize-none min-h-[60px] px-2 py-1 cursor-text",style:{color:((p0=(h0=u[h])==null?void 0:h0.contentStyle)==null?void 0:p0.color)||$l.text,fontSize:`${(((m0=(f0=u[h])==null?void 0:f0.contentStyle)==null?void 0:m0.fontSize)||18)*k/100}px`,fontWeight:((g0=(x0=u[h])==null?void 0:x0.contentStyle)==null?void 0:g0.fontWeight)||"normal",fontFamily:((y0=(v0=u[h])==null?void 0:v0.contentStyle)==null?void 0:y0.fontFamily)||"Inter",fontStyle:(w0=(b0=u[h])==null?void 0:b0.contentStyle)!=null&&w0.italic?"italic":"normal",textDecoration:`${(j0=(N0=u[h])==null?void 0:N0.contentStyle)!=null&&j0.underline?"underline":""} ${(k0=(C0=u[h])==null?void 0:C0.contentStyle)!=null&&k0.strikethrough?"line-through":""}`.trim()||"none",textAlign:((E0=(S0=u[h])==null?void 0:S0.contentStyle)==null?void 0:E0.align)||"left"},placeholder:"Contenu..."})})]})})}),a.jsxs("div",{className:"w-48 bg-gray-900 p-4 overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("span",{className:"text-white text-sm font-medium",children:"Slides"}),a.jsx("button",{onClick:CC,className:"p-1 hover:bg-gray-700 rounded text-gray-400 hover:text-white",children:a.jsx(ir,{className:"w-4 h-4"})})]}),a.jsx("div",{className:"space-y-2",children:u.map((I,q)=>{var ae;const ue=ni(I.template);return a.jsxs("button",{onClick:()=>p(q),className:`w-full rounded-lg overflow-hidden border-2 transition-all ${h===q?"border-primary-500":"border-transparent hover:border-gray-600"}`,children:[a.jsxs("div",{className:"aspect-video p-2 text-left",style:{background:ue.bg,color:ue.text},children:[a.jsx("p",{className:"text-[8px] font-bold truncate",children:I.title}),a.jsx("p",{className:"text-[6px] opacity-70 truncate",children:(ae=I.content)==null?void 0:ae.substring(0,30)})]}),a.jsxs("div",{className:"bg-gray-800 px-2 py-1 flex items-center justify-between",children:[a.jsx("span",{className:"text-[10px] text-gray-400",children:q+1}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:pe=>{pe.stopPropagation(),kC()},className:"p-0.5 hover:bg-gray-700 rounded",children:a.jsx(ED,{className:"w-3 h-3 text-gray-400"})}),a.jsx("button",{onClick:pe=>{pe.stopPropagation(),SC()},className:"p-0.5 hover:bg-gray-700 rounded",children:a.jsx(or,{className:"w-3 h-3 text-gray-400"})})]})]})]},I.id||q)})})]})]}),F&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Ajouter une vido"}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Collez l'URL YouTube ou Vimeo"}),a.jsx("input",{type:"text",value:L,onChange:I=>U(I.target.value),placeholder:"https://www.youtube.com/watch?v=...",className:"w-full border rounded-lg px-3 py-2 mb-4",autoFocus:!0}),a.jsxs("div",{className:"flex gap-2 justify-end",children:[a.jsx("button",{onClick:()=>{W(!1),U("")},className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:"Annuler"}),a.jsx("button",{onClick:DC,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"Ajouter"})]})]})})]})},WM=()=>{const{projectId:e}=jr(),[t,n]=S.useState(!0),[r,s]=S.useState(null),[i,o]=S.useState({todo:{title:" faire",tasks:[]},in_progress:{title:"En cours",tasks:[]},done:{title:"Termin",tasks:[]}}),[l,c]=S.useState(!1),[u,d]=S.useState(null),[h,p]=S.useState({title:"",description:"",priority:"medium",dueDate:"",status:"todo",assignedTo:""}),[f,x]=S.useState([]);S.useEffect(()=>{v()},[e]);const v=async()=>{try{const[E,P,F]=await Promise.all([K.get(`/projects/${e}`),K.get(`/tasks/project/${e}/kanban`),K.get(`/team-members/${e}`)]);s(E.data.project),o(P.data.columns),x(F.data.members||[])}catch{$.error("Erreur lors du chargement")}finally{n(!1)}},y=async E=>{var P,F;E.preventDefault();try{u?(await K.put(`/tasks/${u.id}`,h),$.success("Tche mise  jour")):(await K.post(`/tasks/project/${e}`,h),$.success("Tche cre")),v(),w()}catch(W){$.error(((F=(P=W.response)==null?void 0:P.data)==null?void 0:F.message)||"Erreur")}},m=async(E,P)=>{try{await K.patch(`/tasks/${E}/status`,{status:P}),v()}catch{$.error("Erreur")}},g=async E=>{if(confirm("Supprimer cette tche ?"))try{await K.delete(`/tasks/${E}`),$.success("Tche supprime"),v()}catch{$.error("Erreur")}},b=(E=null,P="todo")=>{E?(d(E),p({title:E.title,description:E.description||"",priority:E.priority||"medium",dueDate:E.dueDate?E.dueDate.split("T")[0]:"",status:E.status,assignedTo:E.assignedTo||""})):(d(null),p({title:"",description:"",priority:"medium",dueDate:"",status:P,assignedTo:""})),c(!0)},w=()=>{c(!1),d(null),p({title:"",description:"",priority:"medium",dueDate:"",status:"todo",assignedTo:""})},N=E=>{var F;if(!E)return null;const P=f.find(W=>W.userId===E||W.id===E);return P?P.firstName?`${P.firstName} ${((F=P.lastName)==null?void 0:F[0])||""}`:P.email.split("@")[0]:null},C={low:"bg-green-100 text-green-700",medium:"bg-yellow-100 text-yellow-700",high:"bg-red-100 text-red-700"},D={low:"Basse",medium:"Moyenne",high:"Haute"},j={todo:"border-gray-300",in_progress:"border-blue-400",done:"border-green-400"};if(t)return a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});const k=Object.values(i).reduce((E,P)=>E+P.tasks.length,0),R=i.done.tasks.length;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(ve,{to:`/projects/${e}`,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:a.jsx(yn,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Gestion des Tches"}),a.jsx("p",{className:"text-gray-600",children:r==null?void 0:r.name})]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsx(tt,{className:"w-4 h-4 inline mr-1 text-green-500"}),R,"/",k," tches compltes"]}),a.jsxs("button",{onClick:()=>b(),className:"btn-primary flex items-center gap-2",children:[a.jsx(ir,{className:"w-5 h-5"}),"Nouvelle tche"]})]})]}),a.jsx("div",{className:"grid md:grid-cols-3 gap-4",children:Object.entries(i).map(([E,P])=>a.jsxs("div",{className:`bg-gray-50 rounded-xl p-4 border-t-4 ${j[E]}`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h3",{className:"font-semibold text-gray-900",children:[P.title,a.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",P.tasks.length,")"]})]}),a.jsx("button",{onClick:()=>b(null,E),className:"p-1.5 text-gray-500 hover:text-primary-600 hover:bg-white rounded-lg",children:a.jsx(ir,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-3 min-h-[200px]",children:[P.tasks.map(F=>a.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:F.title}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>b(F),className:"p-1 text-gray-400 hover:text-primary-600 rounded",children:a.jsx(Dm,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>g(F.id),className:"p-1 text-gray-400 hover:text-red-600 rounded",children:a.jsx(or,{className:"w-4 h-4"})})]})]}),F.description&&a.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:F.description}),a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsxs("span",{className:`badge ${C[F.priority]}`,children:[a.jsx(Hw,{className:"w-3 h-3 mr-1"}),D[F.priority]]}),F.dueDate&&a.jsxs("span",{className:"badge bg-gray-100 text-gray-700",children:[a.jsx(Hr,{className:"w-3 h-3 mr-1"}),new Date(F.dueDate).toLocaleDateString("fr-FR")]}),F.assignedTo&&N(F.assignedTo)&&a.jsxs("span",{className:"badge bg-indigo-100 text-indigo-700",children:[a.jsx(qn,{className:"w-3 h-3 mr-1"}),N(F.assignedTo)]})]}),E!=="done"&&a.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100 flex gap-2",children:[E==="todo"&&a.jsx("button",{onClick:()=>m(F.id,"in_progress"),className:"text-xs text-blue-600 hover:underline",children:"Dmarrer "}),E==="in_progress"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>m(F.id,"todo"),className:"text-xs text-gray-600 hover:underline",children:"  faire"}),a.jsx("button",{onClick:()=>m(F.id,"done"),className:"text-xs text-green-600 hover:underline",children:"Terminer "})]})]})]},F.id)),P.tasks.length===0&&a.jsx("div",{className:"text-center py-8 text-gray-400",children:a.jsx("p",{className:"text-sm",children:"Aucune tche"})})]})]},E))}),l&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsx("h2",{className:"text-xl font-semibold",children:u?"Modifier la tche":"Nouvelle tche"}),a.jsx("button",{onClick:w,className:"text-gray-500 hover:text-gray-700",children:a.jsx(kt,{className:"w-6 h-6"})})]}),a.jsxs("form",{onSubmit:y,className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Titre *"}),a.jsx("input",{type:"text",value:h.title,onChange:E=>p({...h,title:E.target.value}),className:"input-field",placeholder:"Titre de la tche",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),a.jsx("textarea",{value:h.description,onChange:E=>p({...h,description:E.target.value}),className:"input-field resize-none",rows:3,placeholder:"Description de la tche..."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priorit"}),a.jsxs("select",{value:h.priority,onChange:E=>p({...h,priority:E.target.value}),className:"input-field",children:[a.jsx("option",{value:"low",children:"Basse"}),a.jsx("option",{value:"medium",children:"Moyenne"}),a.jsx("option",{value:"high",children:"Haute"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date limite"}),a.jsx("input",{type:"date",value:h.dueDate,onChange:E=>p({...h,dueDate:E.target.value}),className:"input-field"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut"}),a.jsxs("select",{value:h.status,onChange:E=>p({...h,status:E.target.value}),className:"input-field",children:[a.jsx("option",{value:"todo",children:" faire"}),a.jsx("option",{value:"in_progress",children:"En cours"}),a.jsx("option",{value:"done",children:"Termin"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assign "}),a.jsxs("select",{value:h.assignedTo,onChange:E=>p({...h,assignedTo:E.target.value}),className:"input-field",children:[a.jsx("option",{value:"",children:"Non assign"}),f.filter(E=>E.status==="active").map(E=>a.jsx("option",{value:E.userId||E.id,children:E.firstName?`${E.firstName} ${E.lastName||""}`:E.email},E.id))]})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:w,className:"btn-secondary flex-1",children:"Annuler"}),a.jsx("button",{type:"submit",className:"btn-primary flex-1",children:u?"Enregistrer":"Crer la tche"})]})]})]})})]})},VM=()=>{const{id:e}=jr(),[t,n]=S.useState(null),[r,s]=S.useState([]),[i,o]=S.useState(!0),[l,c]=S.useState(!1),[u,d]=S.useState(""),[h,p]=S.useState("member"),[f,x]=S.useState(!1),[v,y]=S.useState(null);S.useEffect(()=>{m()},[e]);const m=async()=>{try{const[j,k]=await Promise.all([K.get(`/projects/${e}`),K.get(`/team-members/${e}`)]);n(j.data.project),s(k.data.members),y(j.data.userRole||"owner")}catch{$.error("Erreur lors du chargement")}finally{o(!1)}},g=async j=>{var k,R;if(j.preventDefault(),!!u.trim()){x(!0);try{const E=await K.post(`/team-members/${e}`,{email:u,role:h});s([E.data.member,...r]),d(""),p("member"),c(!1),$.success(E.data.message)}catch(E){$.error(((R=(k=E.response)==null?void 0:k.data)==null?void 0:R.message)||"Erreur lors de l'ajout")}finally{x(!1)}}},b=async(j,k)=>{try{await K.put(`/team-members/${e}/${j}`,{role:k}),s(r.map(R=>R.id===j?{...R,role:k}:R)),$.success("Rle mis  jour")}catch{$.error("Erreur lors de la mise  jour")}},w=async j=>{if(confirm("tes-vous sr de vouloir retirer ce membre ?"))try{await K.delete(`/team-members/${e}/${j}`),s(r.filter(k=>k.id!==j)),$.success("Membre retir")}catch{$.error("Erreur lors de la suppression")}},N=j=>{switch(j){case"admin":return a.jsx(Hp,{className:"w-4 h-4 text-yellow-500"});case"member":return a.jsx(is,{className:"w-4 h-4 text-blue-500"});case"viewer":return a.jsx(Nr,{className:"w-4 h-4 text-gray-500"});default:return a.jsx(st,{className:"w-4 h-4 text-gray-500"})}},C=j=>{switch(j){case"admin":return"bg-yellow-100 text-yellow-800";case"member":return"bg-blue-100 text-blue-800";case"viewer":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},D=j=>{switch(j){case"active":return"bg-green-100 text-green-800";case"pending":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}};return i?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(ve,{to:`/projects/${e}`,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:a.jsx(yn,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Membres d'quipe"}),a.jsx("p",{className:"text-gray-600",children:t==null?void 0:t.name})]})]}),v!=="viewer"&&a.jsxs("button",{onClick:()=>c(!0),className:"btn-primary flex items-center gap-2",children:[a.jsx(_m,{className:"w-5 h-5"}),"Ajouter un membre"]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsx("div",{className:"card",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(st,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.length}),a.jsx("p",{className:"text-sm text-gray-600",children:"Total membres"})]})]})}),a.jsx("div",{className:"card",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:a.jsx(Ct,{className:"w-5 h-5 text-green-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.filter(j=>j.status==="active").length}),a.jsx("p",{className:"text-sm text-gray-600",children:"Membres actifs"})]})]})}),a.jsx("div",{className:"card",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:a.jsx(Et,{className:"w-5 h-5 text-orange-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.filter(j=>j.status==="pending").length}),a.jsx("p",{className:"text-sm text-gray-600",children:"En attente"})]})]})})]}),a.jsxs("div",{className:"card",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Liste des membres"}),r.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(st,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500",children:"Aucun membre dans l'quipe"}),a.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Ajoutez des membres pour collaborer sur ce projet"})]}):a.jsx("div",{className:"space-y-3",children:r.map(j=>a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl hover:bg-gray-100 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-primary-400 to-primary-600 rounded-full flex items-center justify-center text-white font-semibold",children:j.firstName?j.firstName[0]:j.email[0].toUpperCase()}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("p",{className:"font-medium text-gray-900",children:j.firstName&&j.lastName?`${j.firstName} ${j.lastName}`:j.email}),N(j.role)]}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx(rr,{className:"w-3 h-3 text-gray-400"}),a.jsx("span",{className:"text-sm text-gray-500",children:j.email})]})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${D(j.status)}`,children:j.status==="active"?"Actif":"En attente"}),v==="owner"||v==="admin"?a.jsxs("select",{value:j.role,onChange:k=>b(j.id,k.target.value),className:`px-3 py-1.5 rounded-lg text-sm font-medium border-0 cursor-pointer ${C(j.role)}`,children:[a.jsx("option",{value:"admin",children:"Admin"}),a.jsx("option",{value:"member",children:"Membre"}),a.jsx("option",{value:"viewer",children:"Lecteur"})]}):a.jsx("span",{className:`px-3 py-1.5 rounded-lg text-sm font-medium ${C(j.role)}`,children:j.role==="admin"?"Admin":j.role==="member"?"Membre":"Lecteur"}),v==="owner"&&a.jsx("button",{onClick:()=>w(j.id),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"Retirer le membre",children:a.jsx(or,{className:"w-4 h-4"})})]})]},j.id))})]}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Niveaux d'accs"}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"p-4 bg-yellow-50 rounded-xl border border-yellow-100",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Hp,{className:"w-5 h-5 text-yellow-600"}),a.jsx("span",{className:"font-medium text-yellow-800",children:"Admin"})]}),a.jsx("p",{className:"text-sm text-yellow-700",children:"Peut grer les membres, crer et modifier toutes les tches"})]}),a.jsxs("div",{className:"p-4 bg-blue-50 rounded-xl border border-blue-100",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(is,{className:"w-5 h-5 text-blue-600"}),a.jsx("span",{className:"font-medium text-blue-800",children:"Membre"})]}),a.jsx("p",{className:"text-sm text-blue-700",children:"Peut crer des tches et modifier celles qui lui sont assignes"})]}),a.jsxs("div",{className:"p-4 bg-gray-50 rounded-xl border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Nr,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"font-medium text-gray-800",children:"Lecteur"})]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Peut voir le projet et les tches sans pouvoir les modifier"})]})]})]}),l&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Ajouter un membre"}),a.jsx("button",{onClick:()=>c(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:a.jsx(kt,{className:"w-5 h-5"})})]}),a.jsxs("form",{onSubmit:g,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Adresse email"}),a.jsxs("div",{className:"relative",children:[a.jsx(rr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"email",value:u,onChange:j=>d(j.target.value),placeholder:"membre@exemple.com",className:"input pl-10",required:!0})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Si l'utilisateur existe, il recevra une notification. Sinon, une invitation sera cre."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rle"}),a.jsxs("select",{value:h,onChange:j=>p(j.target.value),className:"input",children:[(v==="owner"||v==="admin")&&a.jsx("option",{value:"admin",children:"Admin - Accs complet"}),a.jsx("option",{value:"member",children:"Membre - Peut crer et modifier ses tches"}),a.jsx("option",{value:"viewer",children:"Lecteur - Lecture seule"})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>c(!1),className:"flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 font-medium",children:"Annuler"}),a.jsx("button",{type:"submit",disabled:f||!u.trim(),className:"flex-1 btn-primary disabled:opacity-50",children:f?"Ajout...":"Ajouter"})]})]})]})})]})},HM=()=>{const{token:e}=jr(),t=lr(),{setAuth:n}=cr(),[r,s]=S.useState(!0),[i,o]=S.useState(!1),[l,c]=S.useState(null),[u,d]=S.useState(null),[h,p]=S.useState({firstName:"",lastName:"",password:"",confirmPassword:""});S.useEffect(()=>{f()},[e]);const f=async()=>{var y,m;try{const g=await K.get(`/auth/invite/${e}`);c(g.data)}catch(g){d(((m=(y=g.response)==null?void 0:y.data)==null?void 0:m.message)||"Invitation invalide ou expire")}finally{s(!1)}},x=async y=>{var m,g;if(y.preventDefault(),h.password!==h.confirmPassword){$.error("Les mots de passe ne correspondent pas");return}o(!0);try{const b=await K.post(`/auth/invite/${e}/register`,{firstName:h.firstName,lastName:h.lastName,password:h.password});n(b.data.token,b.data.user),$.success("Compte cr avec succs ! Bienvenue dans l'quipe !"),t(`/projects/${b.data.projectId}`)}catch(b){$.error(((g=(m=b.response)==null?void 0:m.data)==null?void 0:g.message)||"Erreur lors de la cration du compte")}finally{o(!1)}},v={admin:"Administrateur",member:"Membre",viewer:"Lecteur"};return r?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:a.jsxs("div",{className:"text-center text-white",children:[a.jsx(Ja,{className:"w-12 h-12 animate-spin mx-auto mb-4 text-cyan-400"}),a.jsx("p",{className:"text-xl",children:"Vrification de l'invitation..."})]})}):u?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white/10 backdrop-blur-xl rounded-2xl p-8 max-w-md w-full text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx("span",{className:"text-3xl",children:""})}),a.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Invitation invalide"}),a.jsx("p",{className:"text-gray-300 mb-6",children:u}),a.jsx(ve,{to:"/login",className:"inline-block bg-primary-600 text-white px-6 py-3 rounded-xl hover:bg-primary-700 transition-colors",children:"Aller  la connexion"})]})}):a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white/10 backdrop-blur-xl rounded-2xl p-8 max-w-md w-full",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-cyan-400 to-purple-500 rounded-2xl flex items-center justify-center mx-auto mb-4",children:a.jsx(st,{className:"w-8 h-8 text-white"})}),a.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Rejoindre l'quipe"}),a.jsx("p",{className:"text-gray-300",children:"Vous avez t invit(e) au projet"}),a.jsxs("p",{className:"text-cyan-400 font-semibold text-lg mt-1",children:['"',l==null?void 0:l.projectName,'"']})]}),a.jsxs("div",{className:"bg-white/5 rounded-xl p-4 mb-6 space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(rr,{className:"w-5 h-5 text-gray-400"}),a.jsx("span",{className:"text-white",children:l==null?void 0:l.email})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(tt,{className:"w-5 h-5 text-green-400"}),a.jsxs("span",{className:"text-gray-300",children:["Rle : ",a.jsx("span",{className:"text-white font-medium",children:v[l==null?void 0:l.role]})]})]})]}),a.jsxs("form",{onSubmit:x,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Prnom"}),a.jsxs("div",{className:"relative",children:[a.jsx(qn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",value:h.firstName,onChange:y=>p({...h,firstName:y.target.value}),className:"w-full bg-white/10 border border-white/20 rounded-xl py-3 pl-10 pr-4 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-400",placeholder:"Prnom",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Nom"}),a.jsxs("div",{className:"relative",children:[a.jsx(qn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",value:h.lastName,onChange:y=>p({...h,lastName:y.target.value}),className:"w-full bg-white/10 border border-white/20 rounded-xl py-3 pl-10 pr-4 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-400",placeholder:"Nom",required:!0})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Mot de passe"}),a.jsxs("div",{className:"relative",children:[a.jsx(ss,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"password",value:h.password,onChange:y=>p({...h,password:y.target.value}),className:"w-full bg-white/10 border border-white/20 rounded-xl py-3 pl-10 pr-4 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-400",placeholder:"",minLength:6,required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Confirmer le mot de passe"}),a.jsxs("div",{className:"relative",children:[a.jsx(ss,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"password",value:h.confirmPassword,onChange:y=>p({...h,confirmPassword:y.target.value}),className:"w-full bg-white/10 border border-white/20 rounded-xl py-3 pl-10 pr-4 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-400",placeholder:"",minLength:6,required:!0})]})]}),a.jsx("button",{type:"submit",disabled:i,className:"w-full bg-gradient-to-r from-cyan-500 to-purple-600 text-white py-3 rounded-xl font-semibold hover:opacity-90 transition-opacity disabled:opacity-50 flex items-center justify-center gap-2",children:i?a.jsxs(a.Fragment,{children:[a.jsx(Ja,{className:"w-5 h-5 animate-spin"}),"Cration en cours..."]}):"Crer mon compte et rejoindre"})]}),a.jsxs("p",{className:"text-center text-gray-400 text-sm mt-6",children:["Vous avez dj un compte ?"," ",a.jsx(ve,{to:"/login",className:"text-cyan-400 hover:underline",children:"Se connecter"})]})]})})},qM={Calculator:Bn,Users:st,Building2:Ws,TrendingUp:Kt,Briefcase:Vp,Brain:Ww},GM=()=>{const[e,t]=S.useState([]),[n,r]=S.useState(!0),[s,i]=S.useState(""),[o,l]=S.useState("all"),[c,u]=S.useState([]);S.useEffect(()=>{d()},[]);const d=async()=>{try{const[m,g]=await Promise.all([K.get("/products/categories"),K.get("/products/my-products").catch(()=>({data:{products:[]}}))]);t(m.data.categories),u(g.data.products||[])}catch(m){console.error("Error fetching products:",m),$.error("Erreur lors du chargement des produits")}finally{r(!1)}},h=async m=>{var g,b,w,N;try{await K.post("/products/activate",{productId:m}),$.success("Produit activ avec succs !"),d()}catch(C){(b=(g=C.response)==null?void 0:g.data)!=null&&b.requiredPlan?$.error(`Abonnement ${C.response.data.requiredPlan} requis`):$.error(((N=(w=C.response)==null?void 0:w.data)==null?void 0:N.message)||"Erreur lors de l'activation")}},p=m=>c.some(g=>g.productId===m),f=m=>qM[m]||Bn,x=e.filter(m=>o==="all"||m.slug===o).map(m=>({...m,products:m.products.filter(g=>g.name.toLowerCase().includes(s.toLowerCase())||g.description.toLowerCase().includes(s.toLowerCase()))})).filter(m=>m.products.length>0||s===""),v=m=>{switch(m){case"student":return"bg-gray-100 text-gray-700";case"startup":return"bg-blue-100 text-blue-700";case"founder":return"bg-purple-100 text-purple-700";case"enterprise":return"bg-gradient-to-r from-amber-500 to-orange-500 text-white";default:return"bg-gray-100 text-gray-700"}},y=m=>{switch(m){case"student":return"Student";case"startup":return"Startup";case"founder":return"Founder Pro";case"enterprise":return"Enterprise";default:return m}};return n?a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("div",{className:"bg-gradient-to-br from-primary-600 via-primary-700 to-purple-800 text-white",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4",children:"Des logiciels et services pour chaque startup"}),a.jsx("p",{className:"text-xl text-primary-100 max-w-3xl mx-auto mb-8",children:"Quelle que soit la taille de votre startup, StartUpLab a la solution pour vous. Activez les modules dont vous avez besoin et dveloppez votre entreprise."}),a.jsx("div",{className:"max-w-2xl mx-auto",children:a.jsxs("div",{className:"relative",children:[a.jsx(Vs,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Rechercher un produit ou service...",value:s,onChange:m=>i(m.target.value),className:"w-full pl-12 pr-4 py-4 rounded-xl text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-primary-300 focus:outline-none"})]})})]})})}),a.jsx("div",{className:"bg-white border-b sticky top-0 z-10",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex items-center gap-2 py-4 overflow-x-auto scrollbar-hide",children:[a.jsx("button",{onClick:()=>l("all"),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors ${o==="all"?"bg-primary-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Tous les produits"}),e.map(m=>{const g=f(m.icon);return a.jsxs("button",{onClick:()=>l(m.slug),className:`flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors ${o===m.slug?"text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,style:o===m.slug?{backgroundColor:m.color}:{},children:[a.jsx(g,{className:"w-4 h-4"}),m.name]},m.id)})]})})}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[x.map(m=>{const g=f(m.icon);return a.jsxs("div",{className:"mb-16",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[a.jsx("div",{className:"w-14 h-14 rounded-2xl flex items-center justify-center",style:{backgroundColor:`${m.color}20`},children:a.jsx(g,{className:"w-7 h-7",style:{color:m.color}})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:m.name}),a.jsx("p",{className:"text-gray-600",children:m.description})]})]}),a.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:m.products.map(b=>a.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-6 hover:shadow-lg transition-all duration-300 hover:border-primary-200 group relative",children:[a.jsxs("div",{className:"absolute top-4 right-4 flex gap-2",children:[b.isPopular===1&&a.jsxs("span",{className:"flex items-center gap-1 px-2 py-1 bg-amber-100 text-amber-700 text-xs font-medium rounded-full",children:[a.jsx(Or,{className:"w-3 h-3 fill-current"}),"Populaire"]}),b.isNew===1&&a.jsxs("span",{className:"flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 text-xs font-medium rounded-full",children:[a.jsx(ua,{className:"w-3 h-3"}),"Nouveau"]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2 pr-20",children:b.name}),a.jsx("p",{className:"text-gray-600 text-sm mb-4",children:b.description})]}),a.jsxs("div",{className:"space-y-2 mb-6",children:[b.features.slice(0,4).map((w,N)=>a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Ct,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),a.jsx("span",{className:"text-sm text-gray-600",children:w})]},N)),b.features.length>4&&a.jsxs("p",{className:"text-sm text-primary-600 font-medium",children:["+",b.features.length-4," autres fonctionnalits"]})]}),a.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[a.jsxs("div",{children:[a.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:[b.price," TND"]}),a.jsx("span",{className:"text-gray-500 text-sm",children:"/mois"}),a.jsx("div",{className:"mt-1",children:a.jsxs("span",{className:`text-xs px-2 py-0.5 rounded-full ${v(b.requiredPlan)}`,children:[y(b.requiredPlan),"+"]})})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(ve,{to:`/produit/demo/${b.slug}`,className:"flex items-center gap-1 px-3 py-2 border border-gray-300 text-gray-700 hover:bg-gray-50 rounded-xl text-sm font-medium transition-colors",children:[a.jsx(Nr,{className:"w-4 h-4"}),"Demo"]}),p(b.id)?a.jsxs("span",{className:"flex items-center gap-2 px-4 py-2 bg-green-100 text-green-700 rounded-xl text-sm font-medium",children:[a.jsx(Ct,{className:"w-4 h-4"}),"Activ"]}):a.jsxs("button",{onClick:()=>h(b.id),className:"flex items-center gap-2 px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-xl text-sm font-medium transition-colors group-hover:shadow-md",children:["Activer",a.jsx(xa,{className:"w-4 h-4"})]})]})]})]},b.id))})]},m.id)}),x.length===0&&a.jsxs("div",{className:"text-center py-16",children:[a.jsx(Vs,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Aucun produit trouv"}),a.jsx("p",{className:"text-gray-600",children:"Essayez de modifier votre recherche ou vos filtres"})]})]}),a.jsx("div",{className:"bg-gradient-to-r from-primary-600 to-purple-600 text-white",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 text-center",children:[a.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Besoin d'une solution personnalise ?"}),a.jsx("p",{className:"text-primary-100 mb-8 max-w-2xl mx-auto",children:"Notre quipe peut crer des modules sur mesure pour votre startup. Contactez-nous pour discuter de vos besoins spcifiques."}),a.jsxs(ve,{to:"/contact",className:"inline-flex items-center gap-2 px-8 py-4 bg-white text-primary-600 rounded-xl font-semibold hover:bg-primary-50 transition-colors",children:["Nous contacter",a.jsx(ga,{className:"w-5 h-5"})]})]})})]})},KM=()=>{const[e,t]=S.useState([]),[n,r]=S.useState({active:0,pending:0,expired:0,rejected:0}),[s,i]=S.useState(!0),[o,l]=S.useState("active");S.useEffect(()=>{c()},[]);const c=async()=>{try{const x=await K.get("/products/my-products");t(x.data.products||[]),r(x.data.summary||{active:0,pending:0,expired:0,rejected:0})}catch(x){console.error("Error fetching products:",x),$.error("Erreur lors du chargement")}finally{i(!1)}},u=async x=>{var v,y;try{await K.post(`/products/renew/${x}`,{duration:1}),$.success("Demande de renouvellement envoye !"),c()}catch(m){$.error(((y=(v=m.response)==null?void 0:v.data)==null?void 0:y.message)||"Erreur")}},d=()=>{switch(o){case"active":return e.filter(x=>x.status==="active"&&!x.isExpired);case"pending":return e.filter(x=>x.status==="pending");case"expired":return e.filter(x=>x.status==="expired"||x.isExpired);case"rejected":return e.filter(x=>x.status==="rejected");default:return e}},h=x=>x.status==="pending"?a.jsxs("span",{className:"flex items-center gap-1 px-3 py-1 bg-amber-100 text-amber-700 rounded-full text-sm font-medium",children:[a.jsx(Et,{className:"w-4 h-4"}),"En attente"]}):x.status==="rejected"?a.jsxs("span",{className:"flex items-center gap-1 px-3 py-1 bg-red-100 text-red-700 rounded-full text-sm font-medium",children:[a.jsx(vu,{className:"w-4 h-4"}),"Refuse"]}):x.isExpired||x.status==="expired"?a.jsxs("span",{className:"flex items-center gap-1 px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm font-medium",children:[a.jsx(cl,{className:"w-4 h-4"}),"Expir"]}):x.isExpiringSoon?a.jsxs("span",{className:"flex items-center gap-1 px-3 py-1 bg-orange-100 text-orange-700 rounded-full text-sm font-medium",children:[a.jsx(Dy,{className:"w-4 h-4"}),"Expire bientt"]}):a.jsxs("span",{className:"flex items-center gap-1 px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-medium",children:[a.jsx(tt,{className:"w-4 h-4"}),"Actif"]}),p=x=>x?new Date(x).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}):"-";if(s)return a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});const f=d();return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Mes Offres & Abonnements"}),a.jsx("p",{className:"text-gray-600",children:"Grez vos produits et services actifs"})]}),a.jsxs(ve,{to:"/entreprise/produits-solutions",className:"btn-primary flex items-center gap-2",children:[a.jsx(ua,{className:"w-5 h-5"}),"Dcouvrir plus d'offres"]})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsx("div",{onClick:()=>l("active"),className:`card cursor-pointer transition-all ${o==="active"?"ring-2 ring-green-500":"hover:shadow-md"}`,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:a.jsx(tt,{className:"w-6 h-6 text-green-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.active}),a.jsx("p",{className:"text-sm text-gray-600",children:"Actifs"})]})]})}),a.jsx("div",{onClick:()=>l("pending"),className:`card cursor-pointer transition-all ${o==="pending"?"ring-2 ring-amber-500":"hover:shadow-md"}`,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-xl flex items-center justify-center",children:a.jsx(Et,{className:"w-6 h-6 text-amber-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.pending}),a.jsx("p",{className:"text-sm text-gray-600",children:"En attente"})]})]})}),a.jsx("div",{onClick:()=>l("expired"),className:`card cursor-pointer transition-all ${o==="expired"?"ring-2 ring-gray-500":"hover:shadow-md"}`,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center",children:a.jsx(cl,{className:"w-6 h-6 text-gray-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.expired}),a.jsx("p",{className:"text-sm text-gray-600",children:"Expirs"})]})]})}),a.jsx("div",{onClick:()=>l("rejected"),className:`card cursor-pointer transition-all ${o==="rejected"?"ring-2 ring-red-500":"hover:shadow-md"}`,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center",children:a.jsx(vu,{className:"w-6 h-6 text-red-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.rejected}),a.jsx("p",{className:"text-sm text-gray-600",children:"Refuses"})]})]})})]}),a.jsxs("div",{className:"card",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:[o==="active"&&"Offres actives",o==="pending"&&"Demandes en attente",o==="expired"&&"Offres expires",o==="rejected"&&"Demandes refuses"]}),f.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Yi,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500",children:"Aucune offre dans cette catgorie"}),a.jsxs(ve,{to:"/entreprise/produits-solutions",className:"inline-flex items-center gap-2 mt-4 text-primary-600 hover:text-primary-700 font-medium",children:["Dcouvrir les offres",a.jsx(xa,{className:"w-4 h-4"})]})]}):a.jsx("div",{className:"space-y-4",children:f.map(x=>a.jsx("div",{className:"border border-gray-200 rounded-xl p-5 hover:border-gray-300 transition-colors",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:`${x.color}20`},children:a.jsx(Yi,{className:"w-5 h-5",style:{color:x.color}})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:x.name}),a.jsx("p",{className:"text-sm text-gray-500",children:x.categoryName})]})]}),a.jsx("p",{className:"text-gray-600 text-sm mb-4",children:x.description}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500",children:"Prix"}),a.jsxs("p",{className:"font-semibold text-gray-900",children:[x.price," TND"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500",children:"Dure"}),a.jsxs("p",{className:"font-semibold text-gray-900",children:[x.duration," ",x.durationUnit==="month"?"mois":x.durationUnit==="year"?"an(s)":"jour(s)"]})]}),x.activatedAt&&a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500",children:"Activ le"}),a.jsx("p",{className:"font-semibold text-gray-900",children:p(x.activatedAt)})]}),x.expiresAt&&a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500",children:"Expire le"}),a.jsx("p",{className:`font-semibold ${x.isExpiringSoon?"text-orange-600":"text-gray-900"}`,children:p(x.expiresAt)})]})]}),x.status==="active"&&x.daysRemaining!==null&&a.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[a.jsx(Dy,{className:`w-4 h-4 ${x.isExpiringSoon?"text-orange-500":"text-green-500"}`}),a.jsxs("span",{className:`text-sm font-medium ${x.isExpiringSoon?"text-orange-600":"text-green-600"}`,children:[x.daysRemaining," jours restants"]})]}),x.status==="rejected"&&x.adminNote&&a.jsx("div",{className:"mt-4 p-3 bg-red-50 rounded-lg",children:a.jsxs("p",{className:"text-sm text-red-700",children:[a.jsx("strong",{children:"Raison :"})," ",x.adminNote]})})]}),a.jsxs("div",{className:"flex flex-col items-end gap-3",children:[h(x),(x.isExpired||x.isExpiringSoon||x.status==="expired")&&a.jsxs("button",{onClick:()=>u(x.id),className:"flex items-center gap-2 px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg text-sm font-medium transition-colors",children:[a.jsx(Fs,{className:"w-4 h-4"}),"Renouveler"]})]})]})},x.id))})]})]})},XM=()=>{const e=lr(),{isAuthenticated:t,user:n}=cr(),[r,s]=S.useState([]),[i,o]=S.useState(!0),[l,c]=S.useState(null),[u,d]=S.useState([]),[h,p]=S.useState(null),[f,x]=S.useState(!1);S.useEffect(()=>{v()},[]);const v=async()=>{try{const[g,b]=await Promise.all([K.get("/payments/plans"),K.get("/payments/methods")]);s(g.data.plans||[]),d(b.data.methods||[])}catch(g){console.error("Error fetching plans:",g)}finally{o(!1)}},y=g=>{if(!t){$.error("Connectez-vous pour choisir un plan"),e("/login");return}if(g.id==="free"){$.info("Vous tes dj sur le plan gratuit");return}c(g)},m=async()=>{var g,b;if(!h){$.error("Choisissez une mthode de paiement");return}x(!0);try{const w=await K.post("/payments/initiate",{planId:l.id,paymentMethod:h});$.success("Paiement initi !"),await K.post(`/payments/confirm/${w.data.transactionId}`),$.success("Abonnement activ avec succs !"),c(null),e("/dashboard")}catch(w){$.error(((b=(g=w.response)==null?void 0:g.data)==null?void 0:b.message)||"Erreur de paiement")}finally{x(!1)}};return i?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("nav",{className:"bg-white border-b border-gray-200",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs(ve,{to:"/",className:"flex items-center gap-2",children:[a.jsx(qr,{className:"w-8 h-8 text-primary-600"}),a.jsx("span",{className:"text-xl font-bold gradient-text",children:"StartUpLab"})]}),t?a.jsxs(ve,{to:"/dashboard",className:"btn-secondary flex items-center gap-2",children:[a.jsx(yn,{className:"w-4 h-4"}),"Retour au tableau de bord"]}):a.jsx(ve,{to:"/login",className:"btn-primary",children:"Se connecter"})]})})}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-12",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"Choisissez votre plan"}),a.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Des tarifs adapts  chaque tape de votre startup. Commencez gratuitement et voluez selon vos besoins."})]}),a.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12",children:r.map(g=>{const b=(n==null?void 0:n.subscription)===g.id,w=g.id==="pro";return a.jsxs("div",{className:`card relative ${w?"border-2 border-primary-500 shadow-lg":""}`,children:[w&&a.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:a.jsx("span",{className:"bg-primary-600 text-white text-xs font-medium px-3 py-1 rounded-full",children:"Populaire"})}),a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:g.name}),a.jsxs("div",{className:"flex items-baseline justify-center gap-1",children:[a.jsx("span",{className:"text-4xl font-bold text-gray-900",children:g.price}),a.jsxs("span",{className:"text-gray-600",children:[g.currency,"/",g.period||"gratuit"]})]})]}),a.jsx("ul",{className:"space-y-3 mb-6",children:g.features.map((N,C)=>a.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[a.jsx(Ct,{className:"w-5 h-5 text-green-500 shrink-0"}),a.jsx("span",{className:"text-gray-600",children:N})]},C))}),a.jsx("button",{onClick:()=>y(g),disabled:b,className:`w-full py-3 rounded-lg font-medium transition-colors ${b?"bg-gray-100 text-gray-500 cursor-not-allowed":w?"btn-primary":"btn-secondary"}`,children:b?"Plan actuel":g.price===0?"Commencer":"Choisir ce plan"})]},g.id)})}),l&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsxs("h2",{className:"text-xl font-semibold",children:["Paiement - ",l.name]}),a.jsxs("p",{className:"text-gray-600",children:[l.price," ",l.currency,"/",l.period]})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsx("h3",{className:"font-medium text-gray-900",children:"Mthode de paiement"}),a.jsx("div",{className:"space-y-2",children:u.map(g=>a.jsxs("label",{className:`flex items-center gap-3 p-4 border-2 rounded-lg cursor-pointer transition-colors ${h===g.id?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}`,children:[a.jsx("input",{type:"radio",name:"paymentMethod",value:g.id,checked:h===g.id,onChange:b=>p(b.target.value),className:"text-primary-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:g.name}),a.jsx("p",{className:"text-sm text-gray-500",children:g.description})]})]},g.id))}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{onClick:()=>c(null),className:"btn-secondary flex-1",children:"Annuler"}),a.jsx("button",{onClick:m,disabled:f||!h,className:"btn-primary flex-1 disabled:opacity-50",children:f?"Traitement...":"Payer"})]})]})]})}),a.jsxs("div",{className:"max-w-3xl mx-auto",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 text-center mb-8",children:"Questions frquentes"}),a.jsx("div",{className:"space-y-4",children:[{q:"Puis-je changer de plan  tout moment ?",a:"Oui, vous pouvez upgrader ou downgrader votre plan  tout moment. Le changement prend effet immdiatement."},{q:"Quels moyens de paiement acceptez-vous ?",a:"Nous acceptons D17, Flouci, les cartes bancaires tunisiennes (Visa/Mastercard) et les virements bancaires."},{q:"Y a-t-il un engagement ?",a:"Non, tous nos plans sont sans engagement. Vous pouvez annuler  tout moment."},{q:"Mes donnes sont-elles scurises ?",a:"Oui, nous utilisons le chiffrement SSL et respectons les normes de scurit les plus strictes pour protger vos donnes."}].map((g,b)=>a.jsxs("div",{className:"card",children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:g.q}),a.jsx("p",{className:"text-gray-600",children:g.a})]},b))})]})]})]})},YM=()=>{var ce,se,le,he,ye,Ce,xe,$e,_e,Re;const{user:e,updateUser:t,fetchUser:n}=cr(),[r,s]=S.useState("profile"),[i,o]=S.useState(!1),[l,c]=S.useState(null),[u,d]=S.useState([]),h=S.useRef(null),[p,f]=S.useState(!1),[x,v]=S.useState(!1),[y,m]=S.useState(!1),[g,b]=S.useState(!1),w=S.useRef(null),N=S.useRef(null),[C,D]=S.useState({firstName:(e==null?void 0:e.firstName)||"",lastName:(e==null?void 0:e.lastName)||"",phone:(e==null?void 0:e.phone)||"",company:(e==null?void 0:e.company)||""});S.useEffect(()=>(n(),j(),k(),()=>E()),[]);const j=async()=>{try{await Promise.all([qt.tinyFaceDetector.loadFromUri("/models"),qt.faceLandmark68Net.loadFromUri("/models"),qt.faceRecognitionNet.loadFromUri("/models")]),f(!0)}catch{console.log("Face models not loaded")}},k=async()=>{try{const A=await K.get("/auth/face/status");v(A.data.hasFaceRegistered)}catch{console.log("Face status check failed")}},R=async()=>{try{const A=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}});N.current=A,b(!0),setTimeout(()=>{w.current&&(w.current.srcObject=A)},100)}catch(A){console.error("Camera error:",A),$.error("Impossible d'accder  la camra")}},E=()=>{N.current&&(N.current.getTracks().forEach(A=>A.stop()),N.current=null),b(!1)},P=async()=>{if(!p){$.error("Modles non chargs");return}m(!0);try{await new Promise(de=>setTimeout(de,500));const A=new zu({inputSize:320,scoreThreshold:.3});let Z=null;for(let de=0;de<3&&(Z=await gf(w.current,A).withFaceLandmarks().withFaceDescriptor(),!Z);de++)await new Promise(be=>setTimeout(be,300));if(!Z){$.error("Aucun visage dtect. Regardez bien la camra."),m(!1);return}await K.post("/auth/face/register",{faceDescriptor:Array.from(Z.descriptor)}),v(!0),E(),$.success("Reconnaissance faciale configure !")}catch{$.error("Erreur lors de l'enregistrement")}finally{m(!1)}},F=async()=>{if(!(e!=null&&e.avatarUrl)||!p){$.error("Photo Google non disponible");return}m(!0);try{const A=new Image;A.crossOrigin="anonymous";const Z=await new Promise(de=>{A.onload=async()=>{try{const be=new zu({inputSize:416,scoreThreshold:.2}),ze=await gf(A,be).withFaceLandmarks().withFaceDescriptor();de(ze?Array.from(ze.descriptor):null)}catch{de(null)}},A.onerror=()=>de(null),A.src=e.avatarUrl});if(!Z){$.error("Impossible de dtecter le visage sur la photo Google. Utilisez la camra."),m(!1);return}await K.post("/auth/face/register",{faceDescriptor:Z}),v(!0),$.success("Reconnaissance faciale configure depuis votre photo Google !")}catch{$.error("Erreur lors de l'enregistrement")}finally{m(!1)}};S.useEffect(()=>{e&&D({firstName:e.firstName||"",lastName:e.lastName||"",phone:e.phone||"",company:e.company||""})},[e]);const[W,L]=S.useState({currentPassword:"",newPassword:"",confirmPassword:""});S.useEffect(()=>{r==="subscription"?U():r==="history"&&_()},[r]);const U=async()=>{try{const A=await K.get("/payments/subscription");c(A.data)}catch(A){console.error("Error fetching subscription:",A)}},_=async()=>{try{const A=await K.get("/payments/history");d(A.data.payments||[])}catch(A){console.error("Error fetching history:",A)}},B=async A=>{A.preventDefault(),o(!0);try{const Z=await K.put("/auth/profile",C);t(Z.data.user),$.success("Profil mis  jour")}catch{$.error("Erreur lors de la mise  jour")}finally{o(!1)}},O=async A=>{var be;const Z=(be=A.target.files)==null?void 0:be[0];if(!Z)return;if(!Z.type.startsWith("image/")){$.error("Veuillez slectionner une image");return}const de=(ze,Me=200,Ae=.8)=>new Promise(Ye=>{const nt=new FileReader;nt.onload=ne=>{const ie=new Image;ie.onload=()=>{const Te=document.createElement("canvas"),Ue=Math.min(Me/ie.width,Me/ie.height);Te.width=ie.width*Ue,Te.height=ie.height*Ue,Te.getContext("2d").drawImage(ie,0,0,Te.width,Te.height),Ye(Te.toDataURL("image/jpeg",Ae))},ie.src=ne.target.result},nt.readAsDataURL(ze)});try{const ze=await de(Z);await K.post("/auth/avatar",{avatarUrl:ze}),t({avatarUrl:ze}),$.success("Avatar mis  jour")}catch{$.error("Erreur lors de la mise  jour de l'avatar")}},H=async A=>{var Z,de;if(A.preventDefault(),W.newPassword!==W.confirmPassword){$.error("Les mots de passe ne correspondent pas");return}if(W.newPassword.length<6){$.error("Le mot de passe doit contenir au moins 6 caractres");return}o(!0);try{await K.put("/auth/password",{currentPassword:W.currentPassword,newPassword:W.newPassword}),$.success("Mot de passe modifi"),L({currentPassword:"",newPassword:"",confirmPassword:""})}catch(be){$.error(((de=(Z=be.response)==null?void 0:Z.data)==null?void 0:de.message)||"Erreur")}finally{o(!1)}},J=async()=>{if(confirm("tes-vous sr de vouloir annuler votre abonnement ?"))try{await K.post("/payments/cancel"),$.success("Abonnement annul"),U()}catch{$.error("Erreur")}},te=[{id:"profile",label:"Profil",icon:qn},{id:"security",label:"Scurit",icon:ss},{id:"face",label:"Reconnaissance",icon:hh},{id:"subscription",label:"Abonnement",icon:as},{id:"history",label:"Historique",icon:Lc}];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Mon Profil"}),a.jsx("p",{className:"text-gray-600",children:"Grez vos informations personnelles et votre abonnement."})]}),a.jsxs("div",{className:"grid lg:grid-cols-4 gap-6",children:[a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsxs("div",{className:"relative inline-block",children:[e!=null&&e.avatarUrl?a.jsx("img",{src:e.avatarUrl,alt:"Avatar",className:"w-20 h-20 rounded-full mx-auto object-cover border-4 border-cyan-500"}):a.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-cyan-500 to-purple-500 rounded-full flex items-center justify-center mx-auto",children:a.jsxs("span",{className:"text-2xl font-bold text-white",children:[(ce=e==null?void 0:e.firstName)==null?void 0:ce[0],(se=e==null?void 0:e.lastName)==null?void 0:se[0]]})}),a.jsx("button",{onClick:()=>{var A;return(A=h.current)==null?void 0:A.click()},className:"absolute bottom-0 right-0 w-8 h-8 bg-cyan-500 rounded-full flex items-center justify-center text-white hover:bg-cyan-600 transition-colors shadow-lg",children:a.jsx(mu,{className:"w-4 h-4"})}),a.jsx("input",{ref:h,type:"file",accept:"image/*",onChange:O,className:"hidden"})]}),a.jsxs("h3",{className:"font-semibold text-gray-900",children:[e==null?void 0:e.firstName," ",e==null?void 0:e.lastName]}),a.jsx("p",{className:"text-sm text-gray-500",children:e==null?void 0:e.email}),a.jsxs("span",{className:`badge mt-2 ${(e==null?void 0:e.subscription)==="free"?"badge-info":"badge-success"}`,children:["Plan ",(e==null?void 0:e.subscription)||"Gratuit"]})]}),a.jsx("nav",{className:"space-y-1",children:te.map(A=>a.jsxs("button",{onClick:()=>s(A.id),className:`w-full flex items-center gap-3 px-4 py-2.5 rounded-lg text-left transition-colors ${r===A.id?"bg-primary-50 text-primary-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[a.jsx(A.icon,{className:"w-5 h-5"}),A.label]},A.id))})]})}),a.jsxs("div",{className:"lg:col-span-3",children:[r==="profile"&&a.jsxs("div",{className:"card",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Informations personnelles"}),a.jsxs("form",{onSubmit:B,className:"space-y-4",children:[a.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prnom"}),a.jsxs("div",{className:"relative",children:[a.jsx(qn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",value:C.firstName,onChange:A=>D({...C,firstName:A.target.value}),className:"input-field pl-10"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom"}),a.jsx("input",{type:"text",value:C.lastName,onChange:A=>D({...C,lastName:A.target.value}),className:"input-field"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),a.jsxs("div",{className:"relative",children:[a.jsx(rr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"email",value:e==null?void 0:e.email,className:"input-field pl-10 bg-gray-50",disabled:!0})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"L'email ne peut pas tre modifi"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tlphone"}),a.jsxs("div",{className:"relative",children:[a.jsx(km,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"tel",value:C.phone,onChange:A=>D({...C,phone:A.target.value}),className:"input-field pl-10",placeholder:"+216 XX XXX XXX"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Entreprise"}),a.jsxs("div",{className:"relative",children:[a.jsx(md,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",value:C.company,onChange:A=>D({...C,company:A.target.value}),className:"input-field pl-10",placeholder:"Nom de votre entreprise"})]})]}),a.jsx("button",{type:"submit",disabled:i,className:"btn-primary",children:i?"Enregistrement...":"Enregistrer les modifications"})]})]}),r==="security"&&a.jsxs("div",{className:"card",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Changer le mot de passe"}),a.jsxs("form",{onSubmit:H,className:"space-y-4 max-w-md",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mot de passe actuel"}),a.jsx("input",{type:"password",value:W.currentPassword,onChange:A=>L({...W,currentPassword:A.target.value}),className:"input-field",autoComplete:"current-password",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nouveau mot de passe"}),a.jsx("input",{type:"password",value:W.newPassword,onChange:A=>L({...W,newPassword:A.target.value}),className:"input-field",placeholder:"Min. 6 caractres",autoComplete:"new-password",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirmer le nouveau mot de passe"}),a.jsx("input",{type:"password",value:W.confirmPassword,onChange:A=>L({...W,confirmPassword:A.target.value}),className:"input-field",autoComplete:"new-password",required:!0})]}),a.jsx("button",{type:"submit",disabled:i,className:"btn-primary",children:i?"Modification...":"Modifier le mot de passe"})]})]}),r==="face"&&a.jsxs("div",{className:"card",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Reconnaissance faciale"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Configurez la reconnaissance faciale pour vous connecter plus rapidement et de manire scurise."}),x?a.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center",children:a.jsx(hh,{className:"w-5 h-5 text-white"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-green-800",children:"Reconnaissance faciale active"}),a.jsx("p",{className:"text-sm text-green-600",children:"Vous pouvez vous connecter avec votre visage"})]})]})}):a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:a.jsx("p",{className:"text-yellow-800",children:"La reconnaissance faciale n'est pas encore configure."})}),g?a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"relative rounded-xl overflow-hidden bg-black aspect-video max-w-md",children:a.jsx("video",{ref:w,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"})}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:P,disabled:y,className:"btn-primary flex items-center gap-2",children:y?a.jsxs(a.Fragment,{children:[a.jsx(Ja,{className:"w-5 h-5 animate-spin"}),"Analyse en cours..."]}):a.jsxs(a.Fragment,{children:[a.jsx(hh,{className:"w-5 h-5"}),"Enregistrer mon visage"]})}),a.jsx("button",{onClick:E,className:"btn-secondary",children:"Annuler"})]})]}):a.jsxs("div",{className:"flex flex-col gap-3",children:[(e==null?void 0:e.avatarUrl)&&!x&&a.jsx("button",{onClick:F,disabled:!p||y,className:"btn-primary flex items-center gap-2",children:y?a.jsxs(a.Fragment,{children:[a.jsx(Ja,{className:"w-5 h-5 animate-spin"})," Analyse en cours..."]}):a.jsxs(a.Fragment,{children:[a.jsx("img",{src:e.avatarUrl,alt:"",className:"w-5 h-5 rounded-full"})," Utiliser ma photo Google"]})}),a.jsxs("button",{onClick:R,disabled:!p||y,className:"btn-secondary flex items-center gap-2",children:[a.jsx(mu,{className:"w-5 h-5"}),x?"Reconfigurer avec la camra":"Configurer avec la camra"]})]}),!p&&a.jsxs("p",{className:"text-sm text-gray-500 mt-4",children:[a.jsx(Ja,{className:"w-4 h-4 inline animate-spin mr-2"}),"Chargement des modles de reconnaissance..."]})]}),r==="subscription"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"card",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Mon abonnement"}),(l==null?void 0:l.paymentStatus)==="pending"&&a.jsxs("div",{className:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[a.jsx("p",{className:"text-yellow-800 font-medium",children:" Paiement en attente de validation"}),a.jsx("p",{className:"text-sm text-yellow-600",children:"Votre paiement est en cours de vrification par l'administrateur. Vous serez notifi une fois approuv."})]}),(l==null?void 0:l.paymentStatus)==="rejected"&&a.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:[a.jsx("p",{className:"text-red-800 font-medium",children:" Paiement rejet"}),a.jsx("p",{className:"text-sm text-red-600",children:"Votre paiement a t rejet. Veuillez contacter le support ou ressayer."})]}),(l==null?void 0:l.paymentStatus)==="approved"&&((le=l==null?void 0:l.subscription)==null?void 0:le.plan)!=="free"&&a.jsxs("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg",children:[a.jsx("p",{className:"text-green-800 font-medium",children:" Abonnement actif"}),a.jsx("p",{className:"text-sm text-green-600",children:"Votre abonnement est actif et toutes les fonctionnalits sont disponibles."})]}),l&&a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{children:[a.jsxs("p",{className:"font-medium text-gray-900",children:["Plan ",((he=l.planDetails)==null?void 0:he.name)||"Gratuit"]}),a.jsx("p",{className:"text-sm text-gray-500",children:((ye=l.planDetails)==null?void 0:ye.price)===0?"Gratuit":`${(Ce=l.planDetails)==null?void 0:Ce.price} ${(xe=l.planDetails)==null?void 0:xe.currency}/${($e=l.planDetails)==null?void 0:$e.period}`})]}),((_e=l.subscription)==null?void 0:_e.plan)!=="free"&&l.canAccessFeatures&&a.jsx("button",{onClick:J,className:"text-red-600 hover:underline text-sm",children:"Annuler l'abonnement"})]}),((Re=l==null?void 0:l.planDetails)==null?void 0:Re.features)&&a.jsxs("div",{className:"mt-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Fonctionnalits incluses:"}),a.jsx("ul",{className:"space-y-1",children:l.planDetails.features.map((A,Z)=>a.jsxs("li",{className:"text-sm text-gray-600 flex items-center gap-2",children:[a.jsx("span",{className:"text-green-500",children:""}),A]},Z))})]})]}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Changer de plan"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Vous souhaitez accder  plus de fonctionnalits ?"}),a.jsx("a",{href:"/pricing",className:"btn-primary inline-block",children:"Voir les plans disponibles"})]})]}),r==="history"&&a.jsxs("div",{className:"card",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Historique des paiements"}),u.length>0?a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-left text-sm text-gray-500 border-b",children:[a.jsx("th",{className:"pb-3 font-medium",children:"Date"}),a.jsx("th",{className:"pb-3 font-medium",children:"Plan"}),a.jsx("th",{className:"pb-3 font-medium",children:"Montant"}),a.jsx("th",{className:"pb-3 font-medium",children:"Mthode"}),a.jsx("th",{className:"pb-3 font-medium",children:"Statut"})]})}),a.jsx("tbody",{children:u.map(A=>a.jsxs("tr",{className:"border-b last:border-0",children:[a.jsx("td",{className:"py-3 text-sm",children:new Date(A.createdAt).toLocaleDateString("fr-FR")}),a.jsx("td",{className:"py-3 text-sm capitalize",children:A.subscriptionType}),a.jsxs("td",{className:"py-3 text-sm",children:[A.amount," ",A.currency]}),a.jsx("td",{className:"py-3 text-sm capitalize",children:A.method}),a.jsx("td",{className:"py-3",children:a.jsx("span",{className:`badge ${A.status==="completed"||A.status==="approved"?"badge-success":A.status==="pending"?"badge-warning":(A.status==="rejected","badge-danger")}`,children:A.status==="completed"?"Pay":A.status==="approved"?"Approuv":A.status==="pending"?"En attente":A.status==="rejected"?"Rejet":"chou"})})]},A.id))})]})}):a.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucun paiement"})]})]})]})]})},QM=()=>{const e=lr(),[t]=m3(),{setAuth:n}=cr(),r=S.useRef(!1);S.useEffect(()=>{if(r.current)return;const i=t.get("code");i?(r.current=!0,s(i)):($.error("Erreur de connexion Google"),e("/login"))},[t]);const s=async i=>{try{const o=await K.post("/auth/google/callback",{code:i,redirectUri:window.location.origin+"/auth/google/callback"});n(o.data.token,o.data.user),$.success("Connexion Google russie !"),e("/dashboard")}catch(o){console.error("Google callback error:",o),$.error("Erreur de connexion Google"),e("/login")}};return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:a.jsxs("div",{className:"text-center text-white",children:[a.jsx(Ja,{className:"w-12 h-12 animate-spin mx-auto mb-4 text-cyan-400"}),a.jsx("p",{className:"text-xl",children:"Connexion en cours..."})]})})},JM=()=>{const[e,t]=S.useState([]),[n,r]=S.useState(0),[s,i]=S.useState(!1),o=S.useRef(null);S.useEffect(()=>{l();const p=setInterval(l,3e4);return()=>clearInterval(p)},[]),S.useEffect(()=>{const p=f=>{o.current&&!o.current.contains(f.target)&&i(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]);const l=async()=>{try{const p=await K.get("/notifications");t(p.data.notifications||[]),r(p.data.unreadCount||0)}catch(p){console.error("Error fetching notifications:",p)}},c=async p=>{try{await K.put(`/notifications/${p}/read`),t(f=>f.map(x=>x.id===p?{...x,isRead:1}:x)),r(f=>Math.max(0,f-1))}catch(f){console.error("Error marking notification as read:",f)}},u=async()=>{try{await K.put("/notifications/read-all"),t(p=>p.map(f=>({...f,isRead:1}))),r(0)}catch(p){console.error("Error marking all as read:",p)}},d=p=>{switch(p){case"subscription_approved":return"";case"subscription_rejected":return"";default:return""}},h=p=>{const f=new Date(p),v=new Date-f,y=Math.floor(v/6e4),m=Math.floor(v/36e5),g=Math.floor(v/864e5);return y<1?" l'instant":y<60?`Il y a ${y}min`:m<24?`Il y a ${m}h`:g<7?`Il y a ${g}j`:f.toLocaleDateString("fr-FR")};return a.jsxs("div",{className:"relative",ref:o,children:[a.jsxs("button",{onClick:()=>i(!s),className:"relative p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:[a.jsx(Wp,{className:"w-5 h-5"}),n>0&&a.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center font-medium",children:n>9?"9+":n})]}),s&&a.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-xl shadow-xl border border-gray-200 z-50 overflow-hidden",children:[a.jsxs("div",{className:"p-3 border-b border-gray-100 flex items-center justify-between bg-gray-50",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"Notifications"}),n>0&&a.jsxs("button",{onClick:u,className:"text-xs text-cyan-600 hover:text-cyan-700 flex items-center gap-1",children:[a.jsx(jD,{className:"w-3 h-3"}),"Tout marquer lu"]})]}),a.jsx("div",{className:"max-h-80 overflow-y-auto",children:e.length===0?a.jsxs("div",{className:"p-6 text-center text-gray-500",children:[a.jsx(Wp,{className:"w-8 h-8 mx-auto mb-2 text-gray-300"}),a.jsx("p",{className:"text-sm",children:"Aucune notification"})]}):e.map(p=>a.jsx("div",{className:`p-3 border-b border-gray-50 hover:bg-gray-50 cursor-pointer transition-colors ${p.isRead?"":"bg-cyan-50/50"}`,onClick:()=>!p.isRead&&c(p.id),children:a.jsxs("div",{className:"flex gap-3",children:[a.jsx("span",{className:"text-xl",children:d(p.type)}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:`text-sm ${p.isRead?"text-gray-700":"font-semibold text-gray-900"}`,children:p.title}),a.jsx("p",{className:"text-xs text-gray-500 mt-0.5 line-clamp-2",children:p.message}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:h(p.createdAt)})]}),!p.isRead&&a.jsx("div",{className:"w-2 h-2 bg-cyan-500 rounded-full mt-1.5 flex-shrink-0"})]})},p.id))})]})]})},dt=({children:e})=>{var F,W,L;const[t,n]=S.useState(!1),[r,s]=S.useState(!1),[i,o]=S.useState(!1),[l,c]=S.useState([]),[u,d]=S.useState([]),h=ps(),p=lr(),{user:f,logout:x}=cr();S.useEffect(()=>{v(),y()},[]);const v=async()=>{try{const U=await K.get("/accounting/my-modules");c(U.data.modules||[])}catch(U){console.error("Error fetching modules:",U)}},y=async()=>{try{const _=((await K.get("/products/my-products")).data.products||[]).filter(B=>B.status==="active");d(_)}catch(U){console.error("Error fetching products:",U)}},m=u.filter(U=>{var _,B;return U.categoryName==="Comptabilit & Gestion"||((_=U.slug)==null?void 0:_.includes("comptabilite"))||((B=U.slug)==null?void 0:B.includes("pack-comptabilite"))||U.slug==="bilan-auto"||U.slug==="tva-tunisie"||U.slug==="export-expert"}),g=l.length>0||m.length>0,b=u.filter(U=>U.categoryName==="Paie & Ressources Humaines"||U.slug==="gestion-employes"||U.slug==="fiches-paie"||U.slug==="declaration-cnss"||U.slug==="gestion-conges"||U.slug==="signature-contrat"),w=b.length>0,N=(f==null?void 0:f.subscription)==="enterprise",C=[{name:"Tableau de bord",href:"/dashboard",icon:ic},{name:"Mes Projets",href:"/projects",icon:xr},{name:"Gnrateur d'ides",href:"/ideas",icon:ca},...N?[{name:"Produits & Solutions",href:"/entreprise/produits-solutions",icon:Yi},{name:"Mes Offres",href:"/mes-offres",icon:as}]:[{name:"Abonnement",href:"/pricing",icon:as}],{name:"Mon Profil",href:"/profile",icon:qn}],D={"pack-comptabilite-complet":[{name:"Tableau de bord",href:"/comptabilite",icon:ic},{name:"Transactions",href:"/comptabilite/transactions",icon:Bc},{name:"Bilan & Rsultat",href:"/comptabilite/bilan",icon:Ge},{name:"TVA Tunisie",href:"/comptabilite/tva",icon:Bn},{name:"Export",href:"/comptabilite/export",icon:Ge}],"comptabilite-lite":[{name:"Tableau de bord",href:"/comptabilite",icon:ic},{name:"Transactions",href:"/comptabilite/transactions",icon:Bc},{name:"Export",href:"/comptabilite/export",icon:Ge}],"comptabilite-pro":[{name:"Tableau de bord",href:"/comptabilite",icon:ic},{name:"Transactions",href:"/comptabilite/transactions",icon:Bc},{name:"Bilan & Rsultat",href:"/comptabilite/bilan",icon:Ge}],"bilan-auto":[{name:"Bilan & Rsultat",href:"/comptabilite/bilan",icon:Ge}],"tva-tunisie":[{name:"TVA Tunisie",href:"/comptabilite/tva",icon:Bn}],"export-expert":[{name:"Export",href:"/comptabilite/export",icon:Ge}],"gestion-employes":[{name:"Employs",href:"/rh/employes",icon:st}],"fiches-paie":[{name:"Fiches de paie",href:"/rh/fiches-paie",icon:Ge}],"declaration-cnss":[{name:"CNSS",href:"/rh/cnss",icon:Ws}],"gestion-conges":[{name:"Congs",href:"/rh/conges",icon:Hr}],"signature-contrat":[{name:"Contrats",href:"/rh/contrats",icon:Oc}]},k=(()=>{const U=[],_=new Set;b.forEach(O=>{(D[O.slug]||[]).forEach(J=>{const te=`${J.name}-${J.href}`;_.has(te)||(_.add(te),U.push(J))})});const B=["/rh/employes","/rh/fiches-paie","/rh/cnss","/rh/conges","/rh/contrats"];return U.sort((O,H)=>B.indexOf(O.href)-B.indexOf(H.href))})(),E=(()=>{const U=[],_=new Set;m.forEach(O=>{(D[O.slug]||[]).forEach(J=>{const te=`${J.name}-${J.href}`;_.has(te)||(_.add(te),U.push(J))})});const B=["/comptabilite","/comptabilite/transactions","/comptabilite/bilan","/comptabilite/tva","/comptabilite/export"];return U.sort((O,H)=>B.indexOf(O.href)-B.indexOf(H.href))})(),P=()=>{x(),p("/")};return a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>n(!1)}),a.jsx("aside",{className:`
        fixed top-0 left-0 z-50 h-full w-64 bg-white border-r border-gray-200 
        transform transition-transform duration-300 ease-in-out
        ${t?"translate-x-0":"-translate-x-full"}
        lg:translate-x-0
      `,children:a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"flex items-center justify-between h-16 px-6 border-b border-gray-200",children:[a.jsxs(ve,{to:"/dashboard",className:"flex items-center gap-2",children:[a.jsx(qr,{className:"w-8 h-8 text-primary-600"}),a.jsx("span",{className:"text-xl font-bold gradient-text",children:"StartUpLab"})]}),a.jsx("button",{onClick:()=>n(!1),className:"lg:hidden text-gray-500 hover:text-gray-700",children:a.jsx(kt,{className:"w-6 h-6"})})]}),a.jsxs("nav",{className:"flex-1 px-4 py-6 space-y-1 overflow-y-auto",children:[C.map(U=>{const _=h.pathname===U.href;return a.jsxs(ve,{to:U.href,className:`sidebar-link ${_?"active":""}`,onClick:()=>n(!1),children:[a.jsx(U.icon,{className:"w-5 h-5"}),a.jsx("span",{children:U.name})]},U.name)}),g&&a.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[a.jsxs("button",{onClick:()=>s(!r),className:"w-full flex items-center justify-between px-3 py-2 text-sm font-medium text-green-700 bg-green-50 rounded-lg hover:bg-green-100 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Bn,{className:"w-5 h-5"}),a.jsx("span",{children:"Comptabilit"})]}),r?a.jsx(Ny,{className:"w-4 h-4"}):a.jsx(ga,{className:"w-4 h-4"})]}),r&&a.jsx("div",{className:"mt-1 ml-2 space-y-1",children:E.map(U=>{const _=h.pathname===U.href;return a.jsxs(ve,{to:U.href,className:`sidebar-link text-sm ${_?"active":""}`,onClick:()=>n(!1),children:[a.jsx(U.icon,{className:"w-4 h-4"}),a.jsx("span",{children:U.name})]},U.name)})})]}),w&&a.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[a.jsxs("button",{onClick:()=>o(!i),className:"w-full flex items-center justify-between px-3 py-2 text-sm font-medium text-blue-700 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(st,{className:"w-5 h-5"}),a.jsx("span",{children:"Paie & RH"})]}),i?a.jsx(Ny,{className:"w-4 h-4"}):a.jsx(ga,{className:"w-4 h-4"})]}),i&&a.jsx("div",{className:"mt-1 ml-2 space-y-1",children:k.map(U=>{const _=h.pathname===U.href;return a.jsxs(ve,{to:U.href,className:`sidebar-link text-sm ${_?"active":""}`,onClick:()=>n(!1),children:[a.jsx(U.icon,{className:"w-4 h-4"}),a.jsx("span",{children:U.name})]},U.name)})})]}),u.length>0&&a.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[a.jsx("p",{className:"px-3 text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:"Offres Actives"}),a.jsxs("div",{className:"space-y-3",children:[u.slice(0,3).map(U=>{const B={"bilan-auto":["Bilan actif/passif","Analyse automatique","Format standard tunisien"],"comptabilite-lite":["Saisie revenus/dpenses","Calcul automatique","Export PDF"],"comptabilite-pro":["Bilan automatique","Compte de rsultat","Cash Flow","Prvision financire"],"tva-tunisie":["Calcul TVA 19%/7%","Dclaration mensuelle","Export administration"],"export-expert":["Format FEC","Export Excel/PDF","Partage scuris"]}[U.slug]||[];return a.jsxs("div",{className:"px-3",children:[a.jsxs(ve,{to:`/produit/demo/${U.slug}`,className:"flex items-center gap-2 text-sm font-medium text-green-700 mb-2 hover:text-green-800",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full flex-shrink-0"}),a.jsx("span",{children:U.productName})]}),B.length>0&&a.jsx("div",{className:"ml-4 space-y-1",children:B.map((O,H)=>a.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[a.jsx(Ct,{className:"w-3 h-3 text-green-500 flex-shrink-0"}),a.jsx("span",{children:O})]},H))})]},U.id)}),u.length>3&&a.jsxs(ve,{to:"/mes-offres",className:"block px-3 py-1 text-xs text-primary-600 hover:underline",children:["+",u.length-3," autres offres"]})]})]})]}),a.jsxs("div",{className:"p-4 border-t border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4 px-2",children:[f!=null&&f.avatarUrl?a.jsx("img",{src:f.avatarUrl,alt:"Avatar",className:"w-10 h-10 rounded-full object-cover",referrerPolicy:"no-referrer"}):a.jsx("div",{className:"w-10 h-10 rounded-full bg-primary-100 flex items-center justify-center",children:a.jsxs("span",{className:"text-primary-700 font-semibold",children:[(F=f==null?void 0:f.firstName)==null?void 0:F[0],(W=f==null?void 0:f.lastName)==null?void 0:W[0]]})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("p",{className:"text-sm font-medium text-gray-900 truncate",children:[f==null?void 0:f.firstName," ",f==null?void 0:f.lastName]}),a.jsx("p",{className:"text-xs text-gray-500 truncate",children:f==null?void 0:f.email})]})]}),a.jsxs("button",{onClick:P,className:"sidebar-link w-full text-red-600 hover:bg-red-50 hover:text-red-700",children:[a.jsx(Xw,{className:"w-5 h-5"}),a.jsx("span",{children:"Dconnexion"})]})]})]})}),a.jsxs("div",{className:"lg:pl-64",children:[a.jsxs("header",{className:"sticky top-0 z-30 h-16 bg-white border-b border-gray-200 flex items-center px-4 lg:px-8",children:[a.jsx("button",{onClick:()=>n(!0),className:"lg:hidden p-2 text-gray-500 hover:text-gray-700",children:a.jsx(WD,{className:"w-6 h-6"})}),a.jsx("div",{className:"flex-1"}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(JM,{}),a.jsx("span",{className:`badge ${(f==null?void 0:f.subscription)==="free"?"badge-info":"badge-success"}`,children:(f==null?void 0:f.subscription)==="free"?"Plan Gratuit":(L=f==null?void 0:f.subscription)==null?void 0:L.toUpperCase()})]})]}),a.jsx("main",{className:"p-4 lg:p-8",children:e})]})]})},So=({children:e})=>{var u,d;const t=ps(),n=lr(),[r,s]=S.useState(null);S.useEffect(()=>{const h=sessionStorage.getItem("admin-token"),p=sessionStorage.getItem("admin-user");if(h&&p)try{const f=JSON.parse(p);if(f.role==="admin"||f.email==="admin@startuplab.com"){s(f);return}}catch{}window.location.href="/admin/login"},[]);const i=()=>{sessionStorage.removeItem("admin-token"),sessionStorage.removeItem("admin-user"),window.location.href="/admin/login"};if(!r)return a.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500"})});const o=r,l=[{path:"/admin",icon:Nm,label:"Tableau de bord"},{path:"/admin/users",icon:st,label:"Utilisateurs"},{path:"/admin/projects",icon:Ki,label:"Projets"},{path:"/admin/products",icon:Yi,label:"Offres & Produits"},{path:"/admin/payments",icon:as,label:"Paiements"}],c=()=>{i(),n("/login")};return a.jsxs("div",{className:"min-h-screen bg-gray-100 flex",children:[a.jsxs("aside",{className:"w-64 bg-slate-900 text-white flex flex-col",children:[a.jsx("div",{className:"p-6 border-b border-slate-700",children:a.jsxs(ve,{to:"/admin",className:"flex items-center gap-3",children:[a.jsx("div",{className:"bg-gradient-to-br from-cyan-400 to-purple-500 p-2 rounded-xl",children:a.jsx(is,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"font-bold text-lg",children:"StartUpLab"}),a.jsx("p",{className:"text-xs text-slate-400",children:"Administration"})]})]})}),a.jsx("nav",{className:"flex-1 p-4 space-y-1",children:l.map(h=>{const p=t.pathname===h.path;return a.jsxs(ve,{to:h.path,className:`flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${p?"bg-gradient-to-r from-cyan-500 to-purple-500 text-white shadow-lg":"text-slate-300 hover:bg-slate-800 hover:text-white"}`,children:[a.jsx(h.icon,{className:"w-5 h-5"}),a.jsx("span",{className:"font-medium",children:h.label})]},h.path)})}),a.jsxs("div",{className:"p-4 border-t border-slate-700",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o!=null&&o.avatarUrl?a.jsx("img",{src:o.avatarUrl,alt:"",className:"w-10 h-10 rounded-full object-cover"}):a.jsxs("div",{className:"w-10 h-10 bg-gradient-to-br from-cyan-400 to-purple-500 rounded-full flex items-center justify-center text-white font-bold",children:[(u=o==null?void 0:o.firstName)==null?void 0:u[0],(d=o==null?void 0:o.lastName)==null?void 0:d[0]]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("p",{className:"font-medium truncate",children:[o==null?void 0:o.firstName," ",o==null?void 0:o.lastName]}),a.jsx("p",{className:"text-xs text-slate-400 truncate",children:o==null?void 0:o.email})]})]}),a.jsxs("button",{onClick:c,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-red-500/10 text-red-400 rounded-lg hover:bg-red-500/20 transition-colors",children:[a.jsx(Xw,{className:"w-4 h-4"}),"Dconnexion"]})]})]}),a.jsx("main",{className:"flex-1 overflow-auto",children:a.jsx("div",{className:"p-8",children:e})})]})},ZM=()=>{lr(),S.useEffect(()=>{sessionStorage.getItem("admin-token")&&(window.location.href="/admin")},[]);const[e,t]=S.useState(!1),[n,r]=S.useState(!1),[s,i]=S.useState({email:"",password:""}),o=async l=>{var c,u;l.preventDefault(),r(!0);try{console.log("Sending admin login:",s);const d=await pt.post("/api/admin/login",s,{headers:{"Content-Type":"application/json"}});console.log("Admin login response:",d.data),sessionStorage.setItem("admin-token",d.data.token),sessionStorage.setItem("admin-user",JSON.stringify(d.data.user)),$.success("Connexion admin russie"),window.location.href="/admin"}catch(d){$.error(((u=(c=d.response)==null?void 0:c.data)==null?void 0:u.message)||"Identifiants incorrects")}finally{r(!1)}};return a.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center p-4",children:a.jsxs("div",{className:"w-full max-w-md",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-cyan-500 to-purple-600 rounded-2xl mb-4",children:a.jsx(is,{className:"w-8 h-8 text-white"})}),a.jsx("h1",{className:"text-2xl font-bold text-white",children:"Administration"}),a.jsx("p",{className:"text-slate-400 mt-2",children:"StartUpLab - Espace rserv"})]}),a.jsx("div",{className:"bg-slate-800 rounded-2xl p-8 shadow-xl border border-slate-700",children:a.jsxs("form",{onSubmit:o,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Email administrateur"}),a.jsxs("div",{className:"relative",children:[a.jsx(rr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-500"}),a.jsx("input",{type:"email",value:s.email,onChange:l=>i({...s,email:l.target.value}),className:"w-full pl-10 pr-4 py-3 bg-slate-700 border border-slate-600 rounded-xl text-white placeholder-slate-400 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"admin@startuplab.com",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Mot de passe"}),a.jsxs("div",{className:"relative",children:[a.jsx(ss,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-500"}),a.jsx("input",{type:e?"text":"password",value:s.password,onChange:l=>i({...s,password:l.target.value}),className:"w-full pl-10 pr-12 py-3 bg-slate-700 border border-slate-600 rounded-xl text-white placeholder-slate-400 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"",required:!0}),a.jsx("button",{type:"button",onClick:()=>t(!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 hover:text-slate-300",children:e?a.jsx(jm,{className:"w-5 h-5"}):a.jsx(Nr,{className:"w-5 h-5"})})]})]}),a.jsx("button",{type:"submit",disabled:n,className:"w-full py-3 bg-gradient-to-r from-cyan-500 to-purple-600 text-white font-semibold rounded-xl hover:opacity-90 transition-opacity disabled:opacity-50 flex items-center justify-center gap-2",children:n?a.jsxs(a.Fragment,{children:[a.jsx(Ja,{className:"w-5 h-5 animate-spin"}),"Connexion..."]}):a.jsxs(a.Fragment,{children:[a.jsx(is,{className:"w-5 h-5"}),"Se connecter"]})})]})}),a.jsx("p",{className:"text-center text-slate-500 text-sm mt-6",children:"Accs rserv aux administrateurs"})]})})},kn=pt.create({baseURL:"http://localhost:5000/api"});kn.interceptors.request.use(e=>{const t=sessionStorage.getItem("admin-token");return t&&(e.headers.Authorization=`Bearer ${t}`),e});kn.interceptors.response.use(e=>e,e=>{var t,n;return(((t=e.response)==null?void 0:t.status)===401||((n=e.response)==null?void 0:n.status)===403)&&(sessionStorage.removeItem("admin-token"),sessionStorage.removeItem("admin-user"),window.location.href="/admin/login"),Promise.reject(e)});const eL=()=>{var c;const[e,t]=S.useState(null),[n,r]=S.useState([]),[s,i]=S.useState(!0);S.useEffect(()=>{o()},[]);const o=async()=>{try{const[u,d]=await Promise.all([kn.get("/admin/stats"),kn.get("/admin/activity")]);t(u.data),r(d.data.activities)}catch{$.error("Erreur lors du chargement des donnes")}finally{i(!1)}};if(s)return a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500"})});const l=[{title:"Utilisateurs",value:(e==null?void 0:e.totalUsers)||0,icon:st,color:"bg-blue-500",link:"/admin/users"},{title:"Projets",value:(e==null?void 0:e.totalProjects)||0,icon:Ki,color:"bg-purple-500",link:"/admin/projects"},{title:"Ides",value:(e==null?void 0:e.totalIdeas)||0,icon:ca,color:"bg-yellow-500"},{title:"Abonnements actifs",value:(e==null?void 0:e.activeSubscriptions)||0,icon:Zw,color:"bg-green-500"},{title:"Nouveaux (7j)",value:(e==null?void 0:e.recentUsers)||0,icon:Kt,color:"bg-cyan-500"},{title:"Revenus total",value:`${(e==null?void 0:e.totalRevenue)||0} TND`,icon:va,color:"bg-emerald-500",link:"/admin/payments"}];return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[a.jsx(is,{className:"w-8 h-8 text-cyan-600"}),"Administration"]}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Grez votre plateforme StartUpLab"})]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map((u,d)=>a.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-shadow",children:u.link?a.jsx(ve,{to:u.link,className:"block",children:a.jsx(Fb,{...u})}):a.jsx(Fb,{...u})},d))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[a.jsx(as,{className:"w-5 h-5 text-purple-500"}),"Rpartition des abonnements"]}),a.jsx("div",{className:"space-y-3",children:(c=e==null?void 0:e.usersByPlan)==null?void 0:c.map((u,d)=>a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"capitalize font-medium",children:u.plan}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:`h-2 rounded-full ${u.plan==="premium"?"bg-purple-500":u.plan==="pro"?"bg-cyan-500":"bg-gray-400"}`,style:{width:`${u.count/e.totalUsers*100}%`}})}),a.jsx("span",{className:"text-gray-600 w-10 text-right",children:u.count})]})]},d))})]}),a.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[a.jsx(Kt,{className:"w-5 h-5 text-green-500"}),"Revenus ce mois"]}),a.jsxs("div",{className:"text-center py-8",children:[a.jsxs("p",{className:"text-4xl font-bold text-green-600",children:[(e==null?void 0:e.monthlyRevenue)||0," TND"]}),a.jsx("p",{className:"text-gray-500 mt-2",children:"Revenus des 30 derniers jours"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[a.jsx(zw,{className:"w-5 h-5 text-cyan-500"}),"Activit rcente"]}),a.jsxs("div",{className:"space-y-4",children:[n.map((u,d)=>a.jsx(tL,{item:u},d)),n.length===0&&a.jsx("p",{className:"text-gray-500 text-center py-4",children:"Aucune activit rcente"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs(ve,{to:"/admin/users",className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl p-4 flex items-center gap-3 hover:shadow-lg transition-shadow",children:[a.jsx(st,{className:"w-6 h-6"}),a.jsx("span",{className:"font-medium",children:"Grer les utilisateurs"})]}),a.jsxs(ve,{to:"/admin/projects",className:"bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-xl p-4 flex items-center gap-3 hover:shadow-lg transition-shadow",children:[a.jsx(Ki,{className:"w-6 h-6"}),a.jsx("span",{className:"font-medium",children:"Voir les projets"})]}),a.jsxs(ve,{to:"/admin/payments",className:"bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl p-4 flex items-center gap-3 hover:shadow-lg transition-shadow",children:[a.jsx(as,{className:"w-6 h-6"}),a.jsx("span",{className:"font-medium",children:"Grer les paiements"})]})]})]})},Fb=({title:e,value:t,icon:n,color:r})=>a.jsx(a.Fragment,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500 text-sm",children:e}),a.jsx("p",{className:"text-2xl font-bold mt-1",children:t})]}),a.jsx("div",{className:`${r} p-3 rounded-xl`,children:a.jsx(n,{className:"w-6 h-6 text-white"})})]})}),tL=({item:e})=>{const t=()=>{switch(e.type){case"registration":return a.jsx(Zw,{className:"w-4 h-4 text-green-500"});case"project":return a.jsx(Ki,{className:"w-4 h-4 text-purple-500"});case"payment":return a.jsx(as,{className:"w-4 h-4 text-blue-500"});default:return a.jsx(zw,{className:"w-4 h-4 text-gray-500"})}},n=()=>{switch(e.type){case"registration":return`${e.firstName} ${e.lastName} s'est inscrit`;case"project":return`Nouveau projet "${e.name}" par ${e.userEmail}`;case"payment":return`Paiement de ${e.amount} TND par ${e.userEmail}`;default:return"Activit"}};return a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[t(),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm",children:n()}),a.jsx("p",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleDateString("fr-FR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]})]})},nL=()=>{var j,k,R,E,P,F,W,L,U;const[e,t]=S.useState([]),[n,r]=S.useState({page:1,pages:1,total:0}),[s,i]=S.useState(!0),[o,l]=S.useState(""),[c,u]=S.useState(""),[d,h]=S.useState(""),[p,f]=S.useState(null),[x,v]=S.useState(!1),[y,m]=S.useState(!1);S.useEffect(()=>{g()},[n.page,c,d]);const g=async()=>{try{i(!0);const _=new URLSearchParams({page:n.page,limit:20,search:o,role:c,status:d}),B=await kn.get(`/admin/users?${_}`);t(B.data.users),r(B.data.pagination)}catch{$.error("Erreur lors du chargement des utilisateurs")}finally{i(!1)}},b=_=>{_.preventDefault(),r(B=>({...B,page:1})),g()},w=async _=>{try{const B=await kn.get(`/admin/users/${_}`);f(B.data),m(!1),v(!0)}catch{$.error("Erreur lors du chargement de l'utilisateur")}},N=async()=>{try{await kn.put(`/admin/users/${p.user.id}`,{firstName:p.user.firstName,lastName:p.user.lastName,email:p.user.email,role:p.user.role,isActive:p.user.isActive,subscription:p.user.subscriptionPlan}),$.success("Utilisateur mis  jour"),v(!1),g()}catch{$.error("Erreur lors de la mise  jour")}},C=async _=>{var B,O;if(confirm("tes-vous sr de vouloir supprimer cet utilisateur ?"))try{await kn.delete(`/admin/users/${_}`),$.success("Utilisateur supprim"),g()}catch(H){$.error(((O=(B=H.response)==null?void 0:B.data)==null?void 0:O.message)||"Erreur lors de la suppression")}},D=async _=>{try{await kn.put(`/admin/users/${_.id}`,{..._,isActive:!_.isActive}),$.success(`Utilisateur ${_.isActive?"dsactiv":"activ"}`),g()}catch{$.error("Erreur lors de la modification")}};return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[a.jsx(st,{className:"w-8 h-8 text-blue-600"}),"Gestion des utilisateurs"]}),a.jsxs("p",{className:"text-gray-600 mt-1",children:[n.total," utilisateurs au total"]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow p-4",children:a.jsxs("form",{onSubmit:b,className:"flex flex-wrap gap-4",children:[a.jsx("div",{className:"flex-1 min-w-[200px]",children:a.jsxs("div",{className:"relative",children:[a.jsx(Vs,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Rechercher par nom ou email...",value:o,onChange:_=>l(_.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]})}),a.jsxs("select",{value:c,onChange:_=>u(_.target.value),className:"px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"Tous les rles"}),a.jsx("option",{value:"user",children:"Utilisateur"}),a.jsx("option",{value:"admin",children:"Admin"})]}),a.jsxs("select",{value:d,onChange:_=>h(_.target.value),className:"px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"Tous les statuts"}),a.jsx("option",{value:"active",children:"Actif"}),a.jsx("option",{value:"inactive",children:"Inactif"})]}),a.jsxs("button",{type:"submit",className:"btn-primary",children:[a.jsx(Vw,{className:"w-4 h-4 mr-2"}),"Filtrer"]})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow overflow-hidden",children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Utilisateur"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Email"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Rle"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Abonnement"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Statut"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Inscription"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:s?a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"px-6 py-8 text-center",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"})})}):e.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-gray-500",children:"Aucun utilisateur trouv"})}):e.map(_=>{var B,O;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[_.avatarUrl?a.jsx("img",{src:_.avatarUrl,alt:"",className:"w-10 h-10 rounded-full object-cover"}):a.jsxs("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white font-medium",children:[(B=_.firstName)==null?void 0:B[0],(O=_.lastName)==null?void 0:O[0]]}),a.jsxs("div",{children:[a.jsxs("p",{className:"font-medium",children:[_.firstName," ",_.lastName]}),a.jsx("p",{className:"text-sm text-gray-500",children:_.company||"-"})]})]})}),a.jsx("td",{className:"px-6 py-4 text-sm",children:_.email}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${_.role==="admin"?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-700"}`,children:_.role==="admin"?" Admin":"Utilisateur"})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${_.subscriptionPlan==="premium"?"bg-yellow-100 text-yellow-700":_.subscriptionPlan==="pro"?"bg-cyan-100 text-cyan-700":"bg-gray-100 text-gray-700"}`,children:_.subscriptionPlan||"free"})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("button",{onClick:()=>D(_),className:`px-2 py-1 rounded-full text-xs font-medium ${_.isActive?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:_.isActive?" Actif":" Inactif"})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:new Date(_.createdAt).toLocaleDateString("fr-FR")}),a.jsx("td",{className:"px-6 py-4 text-right",children:a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsx("button",{onClick:()=>w(_.id),className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg",title:"Voir",children:a.jsx(Nr,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>C(_.id),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg",title:"Supprimer",children:a.jsx(or,{className:"w-4 h-4"})})]})})]},_.id)})})]})}),n.pages>1&&a.jsxs("div",{className:"px-6 py-4 border-t flex items-center justify-between",children:[a.jsxs("p",{className:"text-sm text-gray-500",children:["Page ",n.page," sur ",n.pages]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>r(_=>({..._,page:_.page-1})),disabled:n.page===1,className:"p-2 rounded-lg border hover:bg-gray-50 disabled:opacity-50",children:a.jsx(Gi,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>r(_=>({..._,page:_.page+1})),disabled:n.page===n.pages,className:"p-2 rounded-lg border hover:bg-gray-50 disabled:opacity-50",children:a.jsx(ga,{className:"w-4 h-4"})})]})]})]}),x&&p&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-bold",children:"Dtails de l'utilisateur"}),a.jsx("button",{onClick:()=>v(!1),className:"text-gray-500 hover:text-gray-700",children:""})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[p.user.avatarUrl?a.jsx("img",{src:p.user.avatarUrl,alt:"",className:"w-20 h-20 rounded-full object-cover"}):a.jsxs("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white text-2xl font-bold",children:[(j=p.user.firstName)==null?void 0:j[0],(k=p.user.lastName)==null?void 0:k[0]]}),a.jsxs("div",{children:[y?a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{value:p.user.firstName,onChange:_=>f({...p,user:{...p.user,firstName:_.target.value}}),className:"border rounded px-2 py-1"}),a.jsx("input",{value:p.user.lastName,onChange:_=>f({...p,user:{...p.user,lastName:_.target.value}}),className:"border rounded px-2 py-1"})]}):a.jsxs("h3",{className:"text-xl font-bold",children:[p.user.firstName," ",p.user.lastName]}),a.jsx("p",{className:"text-gray-500",children:p.user.email})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rle"}),y?a.jsxs("select",{value:p.user.role,onChange:_=>f({...p,user:{...p.user,role:_.target.value}}),className:"w-full border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"user",children:"Utilisateur"}),a.jsx("option",{value:"admin",children:"Admin"})]}):a.jsx("p",{className:"py-2",children:p.user.role==="admin"?" Admin":"Utilisateur"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Abonnement"}),y?a.jsxs("select",{value:p.user.subscriptionPlan||"free",onChange:_=>f({...p,user:{...p.user,subscriptionPlan:_.target.value}}),className:"w-full border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"free",children:"Free"}),a.jsx("option",{value:"pro",children:"Pro"}),a.jsx("option",{value:"premium",children:"Premium"})]}):a.jsx("p",{className:"py-2 capitalize",children:p.user.subscriptionPlan||"free"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Statut"}),y?a.jsxs("select",{value:p.user.isActive?"1":"0",onChange:_=>f({...p,user:{...p.user,isActive:_.target.value==="1"}}),className:"w-full border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"1",children:"Actif"}),a.jsx("option",{value:"0",children:"Inactif"})]}):a.jsx("p",{className:"py-2",children:p.user.isActive?" Actif":" Inactif"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Inscription"}),a.jsx("p",{className:"py-2",children:new Date(p.user.createdAt).toLocaleDateString("fr-FR")})]})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-semibold mb-2",children:["Projets (",((R=p.projects)==null?void 0:R.length)||0,")"]}),a.jsxs("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:[(E=p.projects)==null?void 0:E.map(_=>a.jsx("div",{className:"p-2 bg-gray-50 rounded-lg text-sm",children:_.name},_.id)),(!p.projects||p.projects.length===0)&&a.jsx("p",{className:"text-gray-500 text-sm",children:"Aucun projet"})]})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-semibold mb-2",children:["Offres actives (",((P=p.userProducts)==null?void 0:P.length)||0,")"]}),a.jsxs("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:[(F=p.userProducts)==null?void 0:F.map(_=>a.jsxs("div",{className:"p-2 bg-blue-50 rounded-lg text-sm flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:_.productName}),a.jsxs("span",{className:"text-gray-500 ml-2",children:["(",_.price," TND/mois)"]})]}),a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${_.status==="active"?"bg-green-100 text-green-700":_.status==="pending"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:_.status})]},_.id)),(!p.userProducts||p.userProducts.length===0)&&a.jsx("p",{className:"text-gray-500 text-sm",children:"Aucune offre active"})]})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-semibold mb-2",children:["Paiements (",((W=p.payments)==null?void 0:W.length)||0,")"]}),a.jsxs("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:[(L=p.payments)==null?void 0:L.map(_=>a.jsxs("div",{className:"p-2 bg-gray-50 rounded-lg text-sm flex justify-between",children:[a.jsxs("span",{children:[_.amount," ",_.currency]}),a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${_.status==="completed"?"bg-green-100 text-green-700":_.status==="rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:_.status==="completed"?"complt":_.status==="rejected"?"rejet":_.status})]},_.id)),(!p.payments||p.payments.length===0)&&a.jsx("p",{className:"text-gray-500 text-sm",children:"Aucun paiement"})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Historique d'activit"}),a.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[(U=p.activityLog)==null?void 0:U.map((_,B)=>a.jsxs("div",{className:"p-2 bg-gray-50 rounded-lg text-sm flex items-center gap-3",children:[a.jsx("span",{className:`w-2 h-2 rounded-full ${_.type==="registration"?"bg-blue-500":_.type==="project"?"bg-purple-500":_.type==="payment"?"bg-green-500":_.type==="product"?"bg-orange-500":"bg-gray-500"}`}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-gray-700",children:_.description}),a.jsx("p",{className:"text-xs text-gray-400",children:new Date(_.date).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]},B)),(!p.activityLog||p.activityLog.length===0)&&a.jsx("p",{className:"text-gray-500 text-sm",children:"Aucune activit"})]})]})]}),a.jsx("div",{className:"p-6 border-t flex justify-end gap-3",children:y?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>m(!1),className:"btn-secondary",children:"Annuler"}),a.jsx("button",{onClick:N,className:"btn-primary",children:"Enregistrer"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>v(!1),className:"btn-secondary",children:"Fermer"}),a.jsxs("button",{onClick:()=>m(!0),className:"btn-primary flex items-center gap-2",children:[a.jsx(Dm,{className:"w-4 h-4"}),"Modifier"]})]})})]})})]})},rL=()=>{const[e,t]=S.useState([]),[n,r]=S.useState({page:1,pages:1,total:0}),[s,i]=S.useState(!0),[o,l]=S.useState(""),[c,u]=S.useState({total:0,completed:0,pending:0});S.useEffect(()=>{d()},[n.page,o]);const d=async()=>{try{i(!0);const v=new URLSearchParams({page:n.page,limit:20,status:o}),y=await kn.get(`/admin/payments?${v}`);t(y.data.payments),r(y.data.pagination),y.data.stats&&u({total:y.data.stats.totalRevenue,completed:y.data.stats.completed,pending:y.data.stats.pending})}catch{$.error("Erreur lors du chargement des paiements")}finally{i(!1)}},h=v=>{switch(v){case"completed":return a.jsx(tt,{className:"w-4 h-4 text-green-500"});case"pending":return a.jsx(Et,{className:"w-4 h-4 text-yellow-500"});case"failed":return a.jsx(vu,{className:"w-4 h-4 text-red-500"});default:return null}},p=v=>{switch(v){case"completed":case"approved":return"bg-green-100 text-green-700";case"pending":return"bg-yellow-100 text-yellow-700";case"failed":case"rejected":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},f=async v=>{try{await kn.put(`/admin/payments/${v}/status`,{status:"approved"}),$.success("Paiement approuv - Abonnement activ"),d()}catch{$.error("Erreur lors de l'approbation")}},x=async v=>{if(confirm("tes-vous sr de vouloir rejeter ce paiement ?"))try{await kn.put(`/admin/payments/${v}/status`,{status:"rejected"}),$.success("Paiement rejet"),d()}catch{$.error("Erreur lors du rejet")}};return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[a.jsx(as,{className:"w-8 h-8 text-green-600"}),"Gestion des paiements"]}),a.jsxs("p",{className:"text-gray-600 mt-1",children:[n.total," paiements au total"]})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow p-4 flex items-center gap-4",children:[a.jsx("div",{className:"bg-green-100 p-3 rounded-lg",children:a.jsx(va,{className:"w-6 h-6 text-green-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Total revenus"}),a.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[c.total," TND"]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow p-4 flex items-center gap-4",children:[a.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:a.jsx(tt,{className:"w-6 h-6 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Complts"}),a.jsx("p",{className:"text-2xl font-bold",children:c.completed})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow p-4 flex items-center gap-4",children:[a.jsx("div",{className:"bg-yellow-100 p-3 rounded-lg",children:a.jsx(Et,{className:"w-6 h-6 text-yellow-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"En attente"}),a.jsx("p",{className:"text-2xl font-bold",children:c.pending})]})]})]}),a.jsx("div",{className:"bg-white rounded-xl shadow p-4",children:a.jsx("div",{className:"flex gap-4",children:a.jsxs("select",{value:o,onChange:v=>{l(v.target.value),r(y=>({...y,page:1}))},className:"px-4 py-2 border rounded-lg focus:ring-2 focus:ring-green-500",children:[a.jsx("option",{value:"",children:"Tous les statuts"}),a.jsx("option",{value:"completed",children:"Complt"}),a.jsx("option",{value:"pending",children:"En attente"}),a.jsx("option",{value:"failed",children:"chou"})]})})}),a.jsxs("div",{className:"bg-white rounded-xl shadow overflow-hidden",children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ID"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Utilisateur"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Montant"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Mthode"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Statut"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:s?a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"px-6 py-8 text-center",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-500 mx-auto"})})}):e.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"px-6 py-8 text-center text-gray-500",children:"Aucun paiement trouv"})}):e.map(v=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsxs("td",{className:"px-6 py-4 text-sm font-mono",children:["#",v.id]}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{children:[a.jsxs("p",{className:"font-medium",children:[v.firstName," ",v.lastName]}),a.jsx("p",{className:"text-sm text-gray-500",children:v.userEmail})]})}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("span",{className:"font-bold text-lg",children:v.amount}),a.jsx("span",{className:"text-gray-500 ml-1",children:v.currency})]}),a.jsx("td",{className:"px-6 py-4 text-sm capitalize",children:v.method||"-"}),a.jsx("td",{className:"px-6 py-4 text-sm capitalize",children:v.subscriptionType||"-"}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${p(v.status)}`,children:[h(v.status),v.status]})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:new Date(v.createdAt).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}),a.jsx("td",{className:"px-6 py-4",children:v.status==="pending"?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>f(v.id),className:"p-2 bg-green-100 text-green-600 rounded-lg hover:bg-green-200 transition-colors",title:"Approuver",children:a.jsx(Ct,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>x(v.id),className:"p-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors",title:"Rejeter",children:a.jsx(kt,{className:"w-4 h-4"})})]}):a.jsx("span",{className:"text-gray-400 text-sm",children:"-"})})]},v.id))})]})}),n.pages>1&&a.jsxs("div",{className:"px-6 py-4 border-t flex items-center justify-between",children:[a.jsxs("p",{className:"text-sm text-gray-500",children:["Page ",n.page," sur ",n.pages]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>r(v=>({...v,page:v.page-1})),disabled:n.page===1,className:"p-2 rounded-lg border hover:bg-gray-50 disabled:opacity-50",children:a.jsx(Gi,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>r(v=>({...v,page:v.page+1})),disabled:n.page===n.pages,className:"p-2 rounded-lg border hover:bg-gray-50 disabled:opacity-50",children:a.jsx(ga,{className:"w-4 h-4"})})]})]})]})]})},aL=()=>{const[e,t]=S.useState([]),[n,r]=S.useState({page:1,pages:1,total:0}),[s,i]=S.useState(!0),[o,l]=S.useState(""),[c,u]=S.useState(null),[d,h]=S.useState(!1);S.useEffect(()=>{p()},[n.page]);const p=async()=>{try{i(!0);const m=new URLSearchParams({page:n.page,limit:20,search:o}),g=await kn.get(`/admin/projects?${m}`);t(g.data.projects||[]),r(g.data.pagination||{page:1,pages:1,total:0})}catch{$.error("Erreur lors du chargement des projets")}finally{i(!1)}},f=m=>{m.preventDefault(),r(g=>({...g,page:1})),p()},x=m=>{u(m),h(!0)},v=async m=>{if(confirm("tes-vous sr de vouloir supprimer ce projet ?"))try{await kn.delete(`/admin/projects/${m}`),$.success("Projet supprim"),p()}catch{$.error("Erreur lors de la suppression")}},y=m=>m?new Date(m).toLocaleDateString("fr-FR"):"-";return s?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[a.jsx(Ki,{className:"w-8 h-8 text-cyan-600"}),"Gestion des projets"]}),a.jsxs("p",{className:"text-gray-600 mt-1",children:[n.total," projets au total"]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:a.jsxs("form",{onSubmit:f,className:"flex gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(Vs,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",value:o,onChange:m=>l(m.target.value),placeholder:"Rechercher par nom de projet...",className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]}),a.jsxs("button",{type:"submit",className:"px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 flex items-center gap-2",children:[a.jsx(Vw,{className:"w-4 h-4"}),"Filtrer"]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm border overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Projet"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Propritaire"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Statut"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Cr le"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y",children:e.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:"5",className:"px-6 py-8 text-center text-gray-500",children:"Aucun projet trouv"})}):e.map(m=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-cyan-500 to-purple-600 rounded-lg flex items-center justify-center",children:a.jsx(Ki,{className:"w-5 h-5 text-white"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:m.name}),a.jsx("p",{className:"text-sm text-gray-500 truncate max-w-xs",children:m.description||"Pas de description"})]})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(qn,{className:"w-4 h-4 text-gray-400"}),a.jsx("span",{className:"text-gray-700",children:m.ownerName||m.ownerEmail||"Inconnu"})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${m.status==="active"?"bg-green-100 text-green-700":m.status==="completed"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:m.status||"En cours"})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[a.jsx(Hr,{className:"w-4 h-4"}),y(m.createdAt)]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>x(m),className:"p-2 text-gray-500 hover:text-cyan-600 hover:bg-cyan-50 rounded-lg",title:"Voir",children:a.jsx(Nr,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>v(m.id),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg",title:"Supprimer",children:a.jsx(or,{className:"w-4 h-4"})})]})})]},m.id))})]})}),n.pages>1&&a.jsxs("div",{className:"flex items-center justify-between bg-white rounded-xl shadow-sm border p-4",children:[a.jsxs("p",{className:"text-sm text-gray-600",children:["Page ",n.page," sur ",n.pages]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>r(m=>({...m,page:m.page-1})),disabled:n.page===1,className:"p-2 border rounded-lg hover:bg-gray-50 disabled:opacity-50",children:a.jsx(Gi,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>r(m=>({...m,page:m.page+1})),disabled:n.page===n.pages,className:"p-2 border rounded-lg hover:bg-gray-50 disabled:opacity-50",children:a.jsx(ga,{className:"w-4 h-4"})})]})]}),d&&c&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg mx-4 max-h-[80vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b",children:a.jsx("h2",{className:"text-xl font-bold",children:"Dtails du projet"})}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom"}),a.jsx("p",{className:"py-2 font-medium",children:c.name})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("p",{className:"py-2 text-gray-600",children:c.description||"Aucune description"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Propritaire"}),a.jsx("p",{className:"py-2",children:c.ownerName||c.ownerEmail||"Inconnu"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de cration"}),a.jsx("p",{className:"py-2",children:y(c.createdAt)})]})]}),a.jsx("div",{className:"p-6 border-t flex justify-end",children:a.jsx("button",{onClick:()=>h(!1),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Fermer"})})]})})]})},sL=()=>{const[e,t]=S.useState([]),[n,r]=S.useState([]),[s,i]=S.useState(!0),[o,l]=S.useState("requests"),[c,u]=S.useState({show:!1,requestId:null}),[d,h]=S.useState("");S.useEffect(()=>{p()},[]);const p=async()=>{try{const[m,g]=await Promise.all([K.get("/products/admin/requests"),K.get("/products/admin/subscriptions")]);t(m.data.requests||[]),r(g.data.subscriptions||[])}catch(m){console.error("Error fetching data:",m),$.error("Erreur lors du chargement")}finally{i(!1)}},f=async m=>{var g,b;try{await K.post(`/products/admin/approve/${m}`),$.success("Offre approuve et active !"),p()}catch(w){$.error(((b=(g=w.response)==null?void 0:g.data)==null?void 0:b.message)||"Erreur")}},x=async()=>{var m,g;if(c.requestId)try{await K.post(`/products/admin/reject/${c.requestId}`,{reason:d}),$.success("Demande refuse"),u({show:!1,requestId:null}),h(""),p()}catch(b){$.error(((g=(m=b.response)==null?void 0:m.data)==null?void 0:g.message)||"Erreur")}},v=m=>m?new Date(m).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",y=(m,g)=>m==="pending"?a.jsx("span",{className:"px-2 py-1 bg-amber-100 text-amber-700 rounded-full text-xs font-medium",children:"En attente"}):m==="active"?g?a.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-700 rounded-full text-xs font-medium",children:"Expire bientt"}):a.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs font-medium",children:"Actif"}):m==="expired"?a.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded-full text-xs font-medium",children:"Expir"}):m==="rejected"?a.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-700 rounded-full text-xs font-medium",children:"Refus"}):a.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded-full text-xs font-medium",children:m});return s?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestion des Offres"}),a.jsx("p",{className:"text-gray-600",children:"Approuver ou refuser les demandes d'activation"})]}),a.jsxs("button",{onClick:p,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors",children:[a.jsx(Fs,{className:"w-4 h-4"}),"Actualiser"]})]}),a.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[a.jsx("div",{className:"bg-white rounded-xl border p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-lg flex items-center justify-center",children:a.jsx(Et,{className:"w-5 h-5 text-amber-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.length}),a.jsx("p",{className:"text-sm text-gray-600",children:"En attente"})]})]})}),a.jsx("div",{className:"bg-white rounded-xl border p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:a.jsx(tt,{className:"w-5 h-5 text-green-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.filter(m=>m.status==="active").length}),a.jsx("p",{className:"text-sm text-gray-600",children:"Actifs"})]})]})}),a.jsx("div",{className:"bg-white rounded-xl border p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:a.jsx(cl,{className:"w-5 h-5 text-orange-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.filter(m=>m.isExpiringSoon).length}),a.jsx("p",{className:"text-sm text-gray-600",children:"Expire bientt"})]})]})}),a.jsx("div",{className:"bg-white rounded-xl border p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(va,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[n.filter(m=>m.status==="active").reduce((m,g)=>m+(g.price||0),0)," TND"]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Revenus actifs"})]})]})})]}),a.jsxs("div",{className:"flex gap-2 border-b",children:[a.jsxs("button",{onClick:()=>l("requests"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${o==="requests"?"text-primary-600 border-primary-600":"text-gray-500 border-transparent hover:text-gray-700"}`,children:["Demandes en attente (",e.length,")"]}),a.jsxs("button",{onClick:()=>l("subscriptions"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${o==="subscriptions"?"text-primary-600 border-primary-600":"text-gray-500 border-transparent hover:text-gray-700"}`,children:["Tous les abonnements (",n.length,")"]})]}),o==="requests"&&a.jsx("div",{className:"bg-white rounded-xl border",children:e.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(tt,{className:"w-16 h-16 text-green-300 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500",children:"Aucune demande en attente"})]}):a.jsx("div",{className:"divide-y",children:e.map(m=>a.jsx("div",{className:"p-4 hover:bg-gray-50",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:`${m.color}20`},children:a.jsx(Yi,{className:"w-5 h-5",style:{color:m.color}})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:m.productName}),a.jsx("p",{className:"text-sm text-gray-500",children:m.categoryName})]})]}),a.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm mt-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(qn,{className:"w-4 h-4 text-gray-400"}),a.jsxs("span",{children:[m.firstName," ",m.lastName]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Email:"})," ",m.email]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Plan:"}),a.jsx("span",{className:"ml-1 font-medium",children:m.userPlan})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Demand:"})," ",v(m.requestedAt)]})]}),a.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm",children:[a.jsxs("span",{className:"font-semibold text-lg text-primary-600",children:[m.price," TND"]}),a.jsxs("span",{className:"text-gray-500",children:["pour ",m.duration," ",m.durationUnit==="month"?"mois":m.durationUnit==="year"?"an(s)":"jour(s)"]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:()=>f(m.id),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium transition-colors",children:[a.jsx(Ct,{className:"w-4 h-4"}),"Approuver"]}),a.jsxs("button",{onClick:()=>u({show:!0,requestId:m.id}),className:"flex items-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg text-sm font-medium transition-colors",children:[a.jsx(kt,{className:"w-4 h-4"}),"Refuser"]})]})]})},m.id))})}),o==="subscriptions"&&a.jsx("div",{className:"bg-white rounded-xl border overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-600",children:"Utilisateur"}),a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-600",children:"Produit"}),a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-600",children:"Prix"}),a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-600",children:"Statut"}),a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-600",children:"Expire"}),a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-600",children:"Jours restants"})]})}),a.jsx("tbody",{className:"divide-y",children:n.map(m=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{children:[a.jsxs("p",{className:"font-medium text-gray-900",children:[m.firstName," ",m.lastName]}),a.jsx("p",{className:"text-sm text-gray-500",children:m.email})]})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:`${m.color}20`},children:a.jsx(Yi,{className:"w-4 h-4",style:{color:m.color}})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:m.productName}),a.jsx("p",{className:"text-xs text-gray-500",children:m.categoryName})]})]})}),a.jsxs("td",{className:"px-4 py-3 font-medium",children:[m.price," TND"]}),a.jsx("td",{className:"px-4 py-3",children:y(m.status,m.isExpiringSoon)}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:m.expiresAt?v(m.expiresAt):"-"}),a.jsx("td",{className:"px-4 py-3",children:m.daysRemaining!==null?a.jsxs("span",{className:`font-medium ${m.isExpiringSoon?"text-orange-600":"text-gray-900"}`,children:[m.daysRemaining," jours"]}):"-"})]},m.id))})]})}),c.show&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-6",children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Refuser la demande"}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Raison du refus (optionnel)"}),a.jsx("textarea",{value:d,onChange:m=>h(m.target.value),placeholder:"Expliquez pourquoi vous refusez cette demande...",className:"input",rows:3})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>u({show:!1,requestId:null}),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 font-medium",children:"Annuler"}),a.jsx("button",{onClick:x,className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-xl font-medium",children:"Confirmer le refus"})]})]})})]})},iL=()=>{var R,E,P,F,W,L,U,_,B;const[e,t]=S.useState(null),[n,r]=S.useState(!0),[s,i]=S.useState(new Date().getFullYear()),[o,l]=S.useState(""),[c,u]=S.useState(!1),[d,h]=S.useState([]),[p,f]=S.useState({type:"revenue",category:"",description:"",amount:"",date:new Date().toISOString().split("T")[0],paymentMethod:"virement",reference:""}),x={"pack-comptabilite-complet":["transactions","bilan","tva","export"],"comptabilite-lite":["transactions","export"],"comptabilite-pro":["transactions","bilan"],"bilan-auto":["bilan"],"tva-tunisie":["tva"],"export-expert":["export"]},y=(()=>{const O=new Set;return d.forEach(H=>{const J=H.slug;(x[J]||[]).forEach(ce=>O.add(ce))}),O})(),m=O=>y.has(O),g=["Ventes produits","Prestations services","Abonnements","Commissions","Autres revenus"],b=["Achats marchandises","Salaires","Loyer","lectricit","Internet/Tlphone","Marketing","Fournitures","Transport","Assurances","Autres charges"],w=[{value:"",label:"Toute l'anne"},{value:"1",label:"Janvier"},{value:"2",label:"Fvrier"},{value:"3",label:"Mars"},{value:"4",label:"Avril"},{value:"5",label:"Mai"},{value:"6",label:"Juin"},{value:"7",label:"Juillet"},{value:"8",label:"Aot"},{value:"9",label:"Septembre"},{value:"10",label:"Octobre"},{value:"11",label:"Novembre"},{value:"12",label:"Dcembre"}];S.useEffect(()=>{C(),N()},[s,o]);const N=async()=>{try{const H=((await K.get("/products/my-products")).data.products||[]).filter(J=>J.status==="active");h(H)}catch(O){console.error("Error fetching products:",O)}},C=async()=>{try{const O=new URLSearchParams({year:s});o&&O.append("month",o);const H=await K.get(`/accounting/summary?${O}`);t(H.data)}catch(O){console.error("Error fetching summary:",O),$.error("Erreur lors du chargement")}finally{r(!1)}},D=async O=>{var H,J;O.preventDefault();try{await K.post("/accounting/transactions",{...p,amount:parseFloat(p.amount)}),$.success("Transaction ajoute !"),u(!1),f({type:"revenue",category:"",description:"",amount:"",date:new Date().toISOString().split("T")[0],paymentMethod:"virement",reference:""}),C()}catch(te){$.error(((J=(H=te.response)==null?void 0:H.data)==null?void 0:J.message)||"Erreur")}},j=O=>new Intl.NumberFormat("fr-TN",{style:"decimal",minimumFractionDigits:2}).format(O)+" TND",k=O=>new Date(O).toLocaleDateString("fr-FR",{day:"numeric",month:"short"});return n?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Comptabilit"}),a.jsx("p",{className:"text-gray-600",children:"Tableau de bord financier"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("select",{value:s,onChange:O=>i(O.target.value),className:"input py-2",children:[2024,2025,2026].map(O=>a.jsx("option",{value:O,children:O},O))}),a.jsx("select",{value:o,onChange:O=>l(O.target.value),className:"input py-2",children:w.map(O=>a.jsx("option",{value:O.value,children:O.label},O.value))}),a.jsxs("button",{onClick:()=>u(!0),className:"btn-primary flex items-center gap-2",children:[a.jsx(ir,{className:"w-5 h-5"}),"Nouvelle transaction"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx("div",{className:"card bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Revenus"}),a.jsx("p",{className:"text-2xl font-bold text-green-700",children:j(((R=e==null?void 0:e.summary)==null?void 0:R.totalRevenues)||0)})]}),a.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-xl flex items-center justify-center",children:a.jsx(Kt,{className:"w-6 h-6 text-white"})})]})}),a.jsx("div",{className:"card bg-gradient-to-br from-red-50 to-red-100 border-red-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-red-600 font-medium",children:"Dpenses"}),a.jsx("p",{className:"text-2xl font-bold text-red-700",children:j(((E=e==null?void 0:e.summary)==null?void 0:E.totalExpenses)||0)})]}),a.jsx("div",{className:"w-12 h-12 bg-red-500 rounded-xl flex items-center justify-center",children:a.jsx(ya,{className:"w-6 h-6 text-white"})})]})}),a.jsx("div",{className:"card bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Bnfice Net"}),a.jsx("p",{className:`text-2xl font-bold ${(((P=e==null?void 0:e.summary)==null?void 0:P.profit)||0)>=0?"text-blue-700":"text-red-700"}`,children:j(((F=e==null?void 0:e.summary)==null?void 0:F.profit)||0)})]}),a.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-xl flex items-center justify-center",children:a.jsx(va,{className:"w-6 h-6 text-white"})})]})}),a.jsx("div",{className:"card bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-purple-600 font-medium",children:"Marge"}),a.jsxs("p",{className:"text-2xl font-bold text-purple-700",children:[((W=e==null?void 0:e.summary)==null?void 0:W.profitMargin)||0,"%"]})]}),a.jsx("div",{className:"w-12 h-12 bg-purple-500 rounded-xl flex items-center justify-center",children:a.jsx(Sm,{className:"w-6 h-6 text-white"})})]})})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[m("transactions")&&a.jsx(ve,{to:"/comptabilite/transactions",className:"card hover:shadow-lg transition-shadow cursor-pointer group",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center group-hover:bg-blue-200 transition-colors",children:a.jsx(Bc,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:"Transactions"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Voir toutes"})]})]})}),m("bilan")&&a.jsx(ve,{to:"/comptabilite/bilan",className:"card hover:shadow-lg transition-shadow cursor-pointer group",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center group-hover:bg-green-200 transition-colors",children:a.jsx(Ge,{className:"w-5 h-5 text-green-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:"Bilan"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Actif/Passif"})]})]})}),m("tva")&&a.jsx(ve,{to:"/comptabilite/tva",className:"card hover:shadow-lg transition-shadow cursor-pointer group",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center group-hover:bg-orange-200 transition-colors",children:a.jsx(Bn,{className:"w-5 h-5 text-orange-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:"TVA"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Dclarations"})]})]})}),m("export")&&a.jsx(ve,{to:"/comptabilite/export",className:"card hover:shadow-lg transition-shadow cursor-pointer group",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center group-hover:bg-purple-200 transition-colors",children:a.jsx(vn,{className:"w-5 h-5 text-purple-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:"Export"}),a.jsx("p",{className:"text-sm text-gray-500",children:"PDF/Excel"})]})]})}),y.size===0&&a.jsxs("div",{className:"col-span-full text-center py-8 bg-gray-50 rounded-xl",children:[a.jsx("p",{className:"text-gray-500",children:"Activez une offre comptabilit pour accder aux fonctionnalits"}),a.jsx(ve,{to:"/entreprise/produits-solutions",className:"text-primary-600 font-medium hover:underline",children:"Voir les offres "})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"card",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"volution mensuelle"}),a.jsxs("div",{className:"space-y-3",children:[(L=e==null?void 0:e.monthlyData)==null?void 0:L.map(O=>{var J,te;const H=Math.max(...((J=e==null?void 0:e.monthlyData)==null?void 0:J.map(ce=>Math.max(ce.revenues,ce.expenses)))||[1]);return a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:((te=w.find(ce=>ce.value===O.month))==null?void 0:te.label)||O.month}),a.jsx("span",{className:"font-medium",children:j(O.revenues-O.expenses)})]}),a.jsxs("div",{className:"flex gap-1 h-4",children:[a.jsx("div",{className:"bg-green-500 rounded-l",style:{width:`${O.revenues/H*50}%`}}),a.jsx("div",{className:"bg-red-500 rounded-r",style:{width:`${O.expenses/H*50}%`}})]})]},O.month)}),(!(e!=null&&e.monthlyData)||e.monthlyData.length===0)&&a.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune donne pour cette priode"})]})]}),a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Transactions rcentes"}),a.jsx(ve,{to:"/comptabilite/transactions",className:"text-primary-600 hover:text-primary-700 text-sm font-medium",children:"Voir tout "})]}),a.jsxs("div",{className:"space-y-3",children:[(U=e==null?void 0:e.recentTransactions)==null?void 0:U.map(O=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${O.type==="revenue"?"bg-green-100":"bg-red-100"}`,children:O.type==="revenue"?a.jsx(gD,{className:"w-4 h-4 text-green-600"}):a.jsx(mD,{className:"w-4 h-4 text-red-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:O.category}),a.jsx("p",{className:"text-sm text-gray-500",children:k(O.date)})]})]}),a.jsxs("span",{className:`font-semibold ${O.type==="revenue"?"text-green-600":"text-red-600"}`,children:[O.type==="revenue"?"+":"-",j(O.amount)]})]},O.id)),(!(e!=null&&e.recentTransactions)||e.recentTransactions.length===0)&&a.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune transaction"})]})]})]}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Rpartition par catgorie"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-green-600 mb-3",children:"Revenus"}),a.jsx("div",{className:"space-y-2",children:(_=e==null?void 0:e.categoryBreakdown)==null?void 0:_.filter(O=>O.type==="revenue").map(O=>a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-600",children:O.category}),a.jsx("span",{className:"font-medium text-green-600",children:j(O.total)})]},O.category))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-red-600 mb-3",children:"Dpenses"}),a.jsx("div",{className:"space-y-2",children:(B=e==null?void 0:e.categoryBreakdown)==null?void 0:B.filter(O=>O.type==="expense").map(O=>a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-600",children:O.category}),a.jsx("span",{className:"font-medium text-red-600",children:j(O.total)})]},O.category))})]})]})]}),c&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-lg w-full p-6 max-h-[90vh] overflow-y-auto",children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Nouvelle transaction"}),a.jsxs("form",{onSubmit:D,className:"space-y-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{type:"button",onClick:()=>{p.type!=="revenue"&&f({...p,type:"revenue",category:""})},className:`flex-1 py-3 rounded-xl font-medium transition-colors ${p.type==="revenue"?"bg-green-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[a.jsx(Kt,{className:"w-5 h-5 inline mr-2"}),"Revenu"]}),a.jsxs("button",{type:"button",onClick:()=>{p.type!=="expense"&&f({...p,type:"expense",category:""})},className:`flex-1 py-3 rounded-xl font-medium transition-colors ${p.type==="expense"?"bg-red-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[a.jsx(ya,{className:"w-5 h-5 inline mr-2"}),"Dpense"]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Catgorie"}),a.jsxs("select",{value:p.category,onChange:O=>f({...p,category:O.target.value}),className:"input",required:!0,children:[a.jsx("option",{value:"",children:"Slectionner..."}),(p.type==="revenue"?g:b).map(O=>a.jsx("option",{value:O,children:O},O))]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Montant (TND)"}),a.jsx("input",{type:"number",step:"0.01",value:p.amount,onChange:O=>f({...p,amount:O.target.value}),className:"input",placeholder:"0.00",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),a.jsx("input",{type:"date",value:p.date,onChange:O=>f({...p,date:O.target.value}),className:"input",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("input",{type:"text",value:p.description,onChange:O=>f({...p,description:O.target.value}),className:"input",placeholder:"Description de la transaction"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mode de paiement"}),a.jsxs("select",{value:p.paymentMethod,onChange:O=>f({...p,paymentMethod:O.target.value}),className:"input",children:[a.jsx("option",{value:"virement",children:"Virement"}),a.jsx("option",{value:"especes",children:"Espces"}),a.jsx("option",{value:"cheque",children:"Chque"}),a.jsx("option",{value:"carte",children:"Carte bancaire"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rfrence"}),a.jsx("input",{type:"text",value:p.reference,onChange:O=>f({...p,reference:O.target.value}),className:"input",placeholder:"N facture..."})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>u(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 font-medium",children:"Annuler"}),a.jsx("button",{type:"submit",className:"flex-1 btn-primary",children:"Ajouter"})]})]})]})})]})},oL=()=>{const[e,t]=S.useState([]),[n,r]=S.useState(!0),[s,i]=S.useState(""),[o,l]=S.useState(""),[c,u]=S.useState(""),[d,h]=S.useState(""),[p,f]=S.useState(""),[x,v]=S.useState(!1),[y,m]=S.useState(null),[g,b]=S.useState({type:"revenue",category:"",description:"",amount:"",date:new Date().toISOString().split("T")[0],paymentMethod:"virement",reference:""}),w=["Ventes produits","Prestations services","Abonnements","Commissions","Autres revenus"],N=["Achats marchandises","Salaires","Loyer","lectricit","Internet/Tlphone","Marketing","Fournitures","Transport","Assurances","Autres charges"];S.useEffect(()=>{C()},[o,c,d,p]);const C=async()=>{try{const L=new URLSearchParams;o&&L.append("type",o),c&&L.append("category",c),d&&L.append("startDate",d),p&&L.append("endDate",p);const U=await K.get(`/accounting/transactions?${L}`);t(U.data.transactions||[])}catch(L){console.error("Error fetching transactions:",L),$.error("Erreur lors du chargement")}finally{r(!1)}},D=async L=>{var U,_;L.preventDefault();try{y?(await K.put(`/accounting/transactions/${y.id}`,{...g,amount:parseFloat(g.amount)}),$.success("Transaction mise  jour !")):(await K.post("/accounting/transactions",{...g,amount:parseFloat(g.amount)}),$.success("Transaction ajoute !")),v(!1),m(null),R(),C()}catch(B){$.error(((_=(U=B.response)==null?void 0:U.data)==null?void 0:_.message)||"Erreur")}},j=L=>{m(L),b({type:L.type,category:L.category,description:L.description||"",amount:L.amount.toString(),date:L.date,paymentMethod:L.paymentMethod||"virement",reference:L.reference||""}),v(!0)},k=async L=>{if(confirm("Supprimer cette transaction ?"))try{await K.delete(`/accounting/transactions/${L}`),$.success("Transaction supprime"),C()}catch{$.error("Erreur lors de la suppression")}},R=()=>{b({type:"revenue",category:"",description:"",amount:"",date:new Date().toISOString().split("T")[0],paymentMethod:"virement",reference:""})},E=L=>new Intl.NumberFormat("fr-TN",{style:"decimal",minimumFractionDigits:2}).format(L)+" TND",P=L=>new Date(L).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}),F=e.filter(L=>{var U,_;return((U=L.description)==null?void 0:U.toLowerCase().includes(s.toLowerCase()))||L.category.toLowerCase().includes(s.toLowerCase())||((_=L.reference)==null?void 0:_.toLowerCase().includes(s.toLowerCase()))}),W=F.reduce((L,U)=>(U.type==="revenue"?L.revenues+=U.amount:L.expenses+=U.amount,L),{revenues:0,expenses:0});return n?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(ve,{to:"/comptabilite",className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(yn,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Transactions"}),a.jsxs("p",{className:"text-gray-600",children:[F.length," transaction(s)"]})]})]}),a.jsxs("button",{onClick:()=>{R(),m(null),v(!0)},className:"btn-primary flex items-center gap-2",children:[a.jsx(ir,{className:"w-5 h-5"}),"Nouvelle transaction"]})]}),a.jsx("div",{className:"card",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[a.jsxs("div",{className:"relative md:col-span-2",children:[a.jsx(Vs,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Rechercher...",value:s,onChange:L=>i(L.target.value),className:"input pl-10"})]}),a.jsxs("select",{value:o,onChange:L=>l(L.target.value),className:"input",children:[a.jsx("option",{value:"",children:"Tous les types"}),a.jsx("option",{value:"revenue",children:"Revenus"}),a.jsx("option",{value:"expense",children:"Dpenses"})]}),a.jsx("input",{type:"date",value:d,onChange:L=>h(L.target.value),className:"input",placeholder:"Date dbut"}),a.jsx("input",{type:"date",value:p,onChange:L=>f(L.target.value),className:"input",placeholder:"Date fin"})]})}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{className:"card bg-green-50 border-green-200",children:[a.jsx("p",{className:"text-sm text-green-600",children:"Total Revenus"}),a.jsx("p",{className:"text-xl font-bold text-green-700",children:E(W.revenues)})]}),a.jsxs("div",{className:"card bg-red-50 border-red-200",children:[a.jsx("p",{className:"text-sm text-red-600",children:"Total Dpenses"}),a.jsx("p",{className:"text-xl font-bold text-red-700",children:E(W.expenses)})]}),a.jsxs("div",{className:"card bg-blue-50 border-blue-200",children:[a.jsx("p",{className:"text-sm text-blue-600",children:"Solde"}),a.jsx("p",{className:`text-xl font-bold ${W.revenues-W.expenses>=0?"text-blue-700":"text-red-700"}`,children:E(W.revenues-W.expenses)})]})]}),a.jsxs("div",{className:"card overflow-hidden",children:[a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-600",children:"Date"}),a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-600",children:"Type"}),a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-600",children:"Catgorie"}),a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-600",children:"Description"}),a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-600",children:"Rfrence"}),a.jsx("th",{className:"text-right px-4 py-3 text-sm font-medium text-gray-600",children:"Montant"}),a.jsx("th",{className:"text-right px-4 py-3 text-sm font-medium text-gray-600",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y",children:F.map(L=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 text-sm",children:P(L.date)}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${L.type==="revenue"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[L.type==="revenue"?a.jsx(Kt,{className:"w-3 h-3"}):a.jsx(ya,{className:"w-3 h-3"}),L.type==="revenue"?"Revenu":"Dpense"]})}),a.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:L.category}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:L.description||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:L.reference||"-"}),a.jsxs("td",{className:`px-4 py-3 text-sm font-semibold text-right ${L.type==="revenue"?"text-green-600":"text-red-600"}`,children:[L.type==="revenue"?"+":"-",E(L.amount)]}),a.jsx("td",{className:"px-4 py-3 text-right",children:a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsx("button",{onClick:()=>j(L),className:"p-1.5 hover:bg-gray-100 rounded-lg text-gray-500 hover:text-gray-700",children:a.jsx(Yw,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>k(L.id),className:"p-1.5 hover:bg-red-50 rounded-lg text-gray-500 hover:text-red-600",children:a.jsx(or,{className:"w-4 h-4"})})]})})]},L.id))})]}),F.length===0&&a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-500",children:"Aucune transaction trouve"})})]}),x&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-lg w-full p-6 max-h-[90vh] overflow-y-auto",children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:y?"Modifier la transaction":"Nouvelle transaction"}),a.jsxs("form",{onSubmit:D,className:"space-y-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",onClick:()=>b({...g,type:"revenue",category:""}),className:`flex-1 py-3 rounded-xl font-medium transition-colors ${g.type==="revenue"?"bg-green-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Revenu"}),a.jsx("button",{type:"button",onClick:()=>b({...g,type:"expense",category:""}),className:`flex-1 py-3 rounded-xl font-medium transition-colors ${g.type==="expense"?"bg-red-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Dpense"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Catgorie"}),a.jsxs("select",{value:g.category,onChange:L=>b({...g,category:L.target.value}),className:"input",required:!0,children:[a.jsx("option",{value:"",children:"Slectionner..."}),(g.type==="revenue"?w:N).map(L=>a.jsx("option",{value:L,children:L},L))]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Montant (TND)"}),a.jsx("input",{type:"number",step:"0.01",value:g.amount,onChange:L=>b({...g,amount:L.target.value}),className:"input",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),a.jsx("input",{type:"date",value:g.date,onChange:L=>b({...g,date:L.target.value}),className:"input",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("input",{type:"text",value:g.description,onChange:L=>b({...g,description:L.target.value}),className:"input"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mode de paiement"}),a.jsxs("select",{value:g.paymentMethod,onChange:L=>b({...g,paymentMethod:L.target.value}),className:"input",children:[a.jsx("option",{value:"virement",children:"Virement"}),a.jsx("option",{value:"especes",children:"Espces"}),a.jsx("option",{value:"cheque",children:"Chque"}),a.jsx("option",{value:"carte",children:"Carte bancaire"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rfrence"}),a.jsx("input",{type:"text",value:g.reference,onChange:L=>b({...g,reference:L.target.value}),className:"input"})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{v(!1),m(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 font-medium",children:"Annuler"}),a.jsx("button",{type:"submit",className:"flex-1 btn-primary",children:y?"Modifier":"Ajouter"})]})]})]})})]})},lL=()=>{var m,g,b,w,N,C,D,j,k,R,E,P,F,W,L,U,_,B,O,H,J,te,ce;const[e,t]=S.useState(null),[n,r]=S.useState(null),[s,i]=S.useState([]),[o,l]=S.useState(!0),[c,u]=S.useState("balance"),[d,h]=S.useState(new Date().toISOString().split("T")[0]);S.useEffect(()=>{p()},[d]);const p=async()=>{try{const[se,le,he]=await Promise.all([K.get(`/accounting/balance-sheet?date=${d}`),K.get("/accounting/income-statement"),K.get("/accounting/cash-flow")]);t(se.data),r(le.data),i(he.data.cashFlow||[])}catch(se){console.error("Error fetching data:",se),$.error("Erreur lors du chargement")}finally{l(!1)}},f=se=>new Intl.NumberFormat("fr-TN",{style:"decimal",minimumFractionDigits:2}).format(se||0)+" TND",x=()=>{var he,ye,Ce,xe,$e,_e,Re,A,Z,de,be,ze;const se=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>tats Financiers - ${new Date(d).toLocaleDateString("fr-FR")}</title>
        <style>
          body { font-family: Arial, sans-serif; padding: 40px; color: #333; }
          h1 { color: #1a1a1a; border-bottom: 3px solid #4f46e5; padding-bottom: 10px; }
          h2 { color: #4f46e5; margin-top: 30px; border-bottom: 1px solid #ddd; padding-bottom: 8px; }
          .header { text-align: center; margin-bottom: 40px; }
          .date { color: #666; font-size: 14px; }
          .section { margin: 20px 0; padding: 20px; border: 1px solid #e5e7eb; border-radius: 8px; }
          .section-title { font-size: 18px; font-weight: bold; margin-bottom: 15px; }
          .row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #f3f4f6; }
          .row:last-child { border-bottom: none; }
          .label { color: #374151; }
          .value { font-weight: 600; }
          .value.positive { color: #059669; }
          .value.negative { color: #dc2626; }
          .total { background: #f3f4f6; padding: 15px; border-radius: 8px; margin-top: 10px; }
          .total .row { border-bottom: none; font-size: 18px; }
          .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
          .footer { margin-top: 50px; text-align: center; color: #9ca3af; font-size: 12px; border-top: 1px solid #e5e7eb; padding-top: 20px; }
          @media print { body { padding: 20px; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1> tats Financiers</h1>
          <p class="date">Au ${new Date(d).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})}</p>
        </div>

        <h2>Bilan Comptable</h2>
        <div class="grid">
          <div class="section">
            <div class="section-title" style="color: #059669;">ACTIF</div>
            <div class="row">
              <span class="label">Trsorerie disponible</span>
              <span class="value positive">${f(((he=e==null?void 0:e.assets)==null?void 0:he.currentAssets)||0)}</span>
            </div>
            ${((Ce=(ye=e==null?void 0:e.assets)==null?void 0:ye.details)==null?void 0:Ce.map(Me=>`
              <div class="row">
                <span class="label">${Me.category}</span>
                <span class="value">${f(Me.total)}</span>
              </div>
            `).join(""))||""}
            <div class="total">
              <div class="row">
                <span class="label"><strong>TOTAL ACTIF</strong></span>
                <span class="value positive"><strong>${f((e==null?void 0:e.totalAssets)||0)}</strong></span>
              </div>
            </div>
          </div>

          <div class="section">
            <div class="section-title" style="color: #2563eb;">PASSIF</div>
            <div class="row">
              <span class="label">Dettes courantes</span>
              <span class="value negative">${f(((xe=e==null?void 0:e.liabilities)==null?void 0:xe.currentLiabilities)||0)}</span>
            </div>
            <div class="row">
              <span class="label">Rsultat cumul</span>
              <span class="value ${((($e=e==null?void 0:e.equity)==null?void 0:$e.retainedEarnings)||0)>=0?"positive":"negative"}">${f(((_e=e==null?void 0:e.equity)==null?void 0:_e.retainedEarnings)||0)}</span>
            </div>
            <div class="total">
              <div class="row">
                <span class="label"><strong>TOTAL PASSIF</strong></span>
                <span class="value"><strong>${f((e==null?void 0:e.totalAssets)||0)}</strong></span>
              </div>
            </div>
          </div>
        </div>

        <h2>Compte de Rsultat</h2>
        <div class="section">
          <div class="section-title" style="color: #059669;">Produits d'exploitation</div>
          ${((A=(Re=n==null?void 0:n.revenues)==null?void 0:Re.items)==null?void 0:A.map(Me=>`
            <div class="row">
              <span class="label">${Me.category}</span>
              <span class="value positive">${f(Me.total)}</span>
            </div>
          `).join(""))||'<div class="row"><span class="label">Aucun revenu</span><span class="value">0,00 TND</span></div>'}
          <div class="total">
            <div class="row">
              <span class="label"><strong>Total Produits</strong></span>
              <span class="value positive"><strong>${f(((Z=n==null?void 0:n.revenues)==null?void 0:Z.total)||0)}</strong></span>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="section-title" style="color: #dc2626;">Charges d'exploitation</div>
          ${((be=(de=n==null?void 0:n.expenses)==null?void 0:de.items)==null?void 0:be.map(Me=>`
            <div class="row">
              <span class="label">${Me.category}</span>
              <span class="value negative">${f(Me.total)}</span>
            </div>
          `).join(""))||'<div class="row"><span class="label">Aucune charge</span><span class="value">0,00 TND</span></div>'}
          <div class="total">
            <div class="row">
              <span class="label"><strong>Total Charges</strong></span>
              <span class="value negative"><strong>${f(((ze=n==null?void 0:n.expenses)==null?void 0:ze.total)||0)}</strong></span>
            </div>
          </div>
        </div>

        <div class="section" style="background: ${((n==null?void 0:n.netIncome)||0)>=0?"#ecfdf5":"#fef2f2"};">
          <div class="row" style="border: none;">
            <span class="label" style="font-size: 20px;"><strong>RSULTAT NET</strong></span>
            <span class="value ${((n==null?void 0:n.netIncome)||0)>=0?"positive":"negative"}" style="font-size: 24px;">
              <strong>${f((n==null?void 0:n.netIncome)||0)}</strong>
            </span>
          </div>
        </div>

        <div class="footer">
          <p>Document gnr par StartUpLab - Module Comptabilit</p>
          <p>Gnr le ${new Date().toLocaleDateString("fr-FR")}  ${new Date().toLocaleTimeString("fr-FR")}</p>
        </div>
      </body>
      </html>
    `,le=window.open("","_blank");le.document.write(se),le.document.close(),le.print(),$.success("PDF gnr avec succs !")},v=()=>{var ye,Ce,xe,$e,_e;const se=`
BILAN COMPTABLE - FORMAT TUNISIEN
Date: ${new Date(d).toLocaleDateString("fr-FR")}

ACTIF
Trsorerie disponible;${((ye=e==null?void 0:e.assets)==null?void 0:ye.currentAssets)||0}
${((xe=(Ce=e==null?void 0:e.assets)==null?void 0:Ce.details)==null?void 0:xe.map(Re=>`${Re.category};${Re.total}`).join(`
`))||""}
TOTAL ACTIF;${(e==null?void 0:e.totalAssets)||0}

PASSIF
Dettes courantes;${(($e=e==null?void 0:e.liabilities)==null?void 0:$e.currentLiabilities)||0}
Rsultat cumul;${((_e=e==null?void 0:e.equity)==null?void 0:_e.retainedEarnings)||0}
TOTAL PASSIF;${(e==null?void 0:e.totalAssets)||0}

Gnr par StartUpLab - Conforme NCT
`,le=new Blob([se],{type:"text/csv;charset=utf-8;"}),he=document.createElement("a");he.href=URL.createObjectURL(le),he.download=`bilan_tunisien_${d}.csv`,he.click(),$.success("Export Excel (CSV) tlcharg !")},y=()=>{var ye,Ce,xe;const se=`<?xml version="1.0" encoding="UTF-8"?>
<DeclarationFiscale xmlns="http://www.finances.gov.tn/dgcf">
  <Entete>
    <TypeDeclaration>BILAN_ANNUEL</TypeDeclaration>
    <DateGeneration>${new Date().toISOString()}</DateGeneration>
    <PeriodeReference>${d}</PeriodeReference>
  </Entete>
  <Bilan>
    <Actif>
      <TresorerieDisponible>${((ye=e==null?void 0:e.assets)==null?void 0:ye.currentAssets)||0}</TresorerieDisponible>
      <TotalActif>${(e==null?void 0:e.totalAssets)||0}</TotalActif>
    </Actif>
    <Passif>
      <DettesCourantes>${((Ce=e==null?void 0:e.liabilities)==null?void 0:Ce.currentLiabilities)||0}</DettesCourantes>
      <CapitauxPropres>${((xe=e==null?void 0:e.equity)==null?void 0:xe.retainedEarnings)||0}</CapitauxPropres>
      <TotalPassif>${(e==null?void 0:e.totalAssets)||0}</TotalPassif>
    </Passif>
  </Bilan>
  <Signature>
    <Application>StartUpLab</Application>
    <ConformiteNCT>true</ConformiteNCT>
  </Signature>
</DeclarationFiscale>`,le=new Blob([se],{type:"application/xml;charset=utf-8;"}),he=document.createElement("a");he.href=URL.createObjectURL(le),he.download=`declaration_dgcf_${d}.xml`,he.click(),$.success("Export XML DGCF tlcharg !")};return o?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(ve,{to:"/comptabilite",className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(yn,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"tats Financiers"}),a.jsx("p",{className:"text-gray-600",children:"Bilan, compte de rsultat et cash flow"})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("input",{type:"date",value:d,onChange:se=>h(se.target.value),className:"input py-2"}),a.jsxs("button",{onClick:x,className:"btn-primary flex items-center gap-2",children:[a.jsx(vn,{className:"w-5 h-5"}),"Exporter PDF"]})]})]}),a.jsxs("div",{className:"flex gap-2 border-b",children:[a.jsx("button",{onClick:()=>u("balance"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${c==="balance"?"text-primary-600 border-primary-600":"text-gray-500 border-transparent hover:text-gray-700"}`,children:"Bilan"}),a.jsx("button",{onClick:()=>u("income"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${c==="income"?"text-primary-600 border-primary-600":"text-gray-500 border-transparent hover:text-gray-700"}`,children:"Compte de Rsultat"}),a.jsx("button",{onClick:()=>u("cashflow"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${c==="cashflow"?"text-primary-600 border-primary-600":"text-gray-500 border-transparent hover:text-gray-700"}`,children:"Cash Flow"})]}),c==="balance"&&e&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4 pb-4 border-b",children:[a.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:a.jsx(Kt,{className:"w-5 h-5 text-green-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"ACTIF"}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Au ",new Date(d).toLocaleDateString("fr-FR")]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"Actif Circulant"}),a.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-gray-700",children:"Trsorerie disponible"}),a.jsx("span",{className:"font-semibold text-green-700",children:f((m=e.assets)==null?void 0:m.currentAssets)})]})})]}),((b=(g=e.assets)==null?void 0:g.details)==null?void 0:b.length)>0&&a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"Dtail par catgorie"}),a.jsx("div",{className:"space-y-2",children:e.assets.details.map((se,le)=>a.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[a.jsx("span",{className:"text-gray-600",children:se.category}),a.jsx("span",{className:"font-medium",children:f(se.total)})]},le))})]}),a.jsx("div",{className:"pt-4 border-t",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"font-semibold text-gray-900",children:"TOTAL ACTIF"}),a.jsx("span",{className:"text-xl font-bold text-green-600",children:f(e.totalAssets)})]})})]})]}),a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4 pb-4 border-b",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(ya,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"PASSIF"}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Au ",new Date(d).toLocaleDateString("fr-FR")]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"Dettes"}),a.jsx("div",{className:"bg-red-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-gray-700",children:"Dettes courantes"}),a.jsx("span",{className:"font-semibold text-red-700",children:f((w=e.liabilities)==null?void 0:w.currentLiabilities)})]})})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"Capitaux Propres"}),a.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-gray-700",children:"Rsultat cumul"}),a.jsx("span",{className:`font-semibold ${((N=e.equity)==null?void 0:N.retainedEarnings)>=0?"text-blue-700":"text-red-700"}`,children:f((C=e.equity)==null?void 0:C.retainedEarnings)})]})})]}),a.jsx("div",{className:"pt-4 border-t",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"font-semibold text-gray-900",children:"TOTAL PASSIF"}),a.jsx("span",{className:"text-xl font-bold text-blue-600",children:f(e.totalAssets)})]})})]})]})]}),a.jsxs("div",{className:"card bg-gradient-to-r from-indigo-50 to-purple-50 border border-indigo-200",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-indigo-500 rounded-lg flex items-center justify-center",children:a.jsx(ua,{className:"w-5 h-5 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-indigo-900",children:"Analyse Automatique"}),a.jsx("p",{className:"text-sm text-indigo-600",children:"Recommandation IA base sur vos donnes"})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[a.jsxs("div",{className:"bg-white p-4 rounded-lg text-center shadow-sm",children:[a.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[(e==null?void 0:e.totalAssets)>0?Math.round(((D=e==null?void 0:e.equity)==null?void 0:D.retainedEarnings)/(e==null?void 0:e.totalAssets)*100):0,"%"]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Marge nette"})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg text-center shadow-sm",children:[a.jsx("p",{className:"text-2xl font-bold text-blue-600",children:((j=e==null?void 0:e.liabilities)==null?void 0:j.currentLiabilities)>0?(((k=e==null?void 0:e.assets)==null?void 0:k.currentAssets)/((R=e==null?void 0:e.liabilities)==null?void 0:R.currentLiabilities)).toFixed(1):""}),a.jsx("p",{className:"text-sm text-gray-600",children:"Ratio liquidit"})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg text-center shadow-sm",children:[a.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[((E=e==null?void 0:e.equity)==null?void 0:E.retainedEarnings)>=0?"+":"",Math.round((((P=e==null?void 0:e.equity)==null?void 0:P.retainedEarnings)||0)/Math.max(1,Math.abs((e==null?void 0:e.totalAssets)||1))*100),"%"]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Performance"})]})]}),a.jsx("div",{className:"bg-white p-4 rounded-lg border border-indigo-100",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-indigo-500 rounded-full flex items-center justify-center text-white text-sm font-bold flex-shrink-0",children:"IA"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-indigo-800",children:"Recommandation"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:((F=e==null?void 0:e.equity)==null?void 0:F.retainedEarnings)>=0?`Votre situation financire est saine avec un rsultat positif de ${f((W=e==null?void 0:e.equity)==null?void 0:W.retainedEarnings)}. Considrez d'investir dans l'expansion de votre activit.`:`Attention : Votre rsultat est ngatif (${f((L=e==null?void 0:e.equity)==null?void 0:L.retainedEarnings)}). Rduisez les charges ou augmentez les revenus.`})]})]})})]}),a.jsxs("div",{className:"card border border-orange-200",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-orange-500 rounded-lg flex items-center justify-center",children:a.jsx(qw,{className:"w-5 h-5 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-orange-900",children:"Format Standard Tunisien"}),a.jsx("p",{className:"text-sm text-orange-600",children:"Conforme aux normes comptables tunisiennes (NCT)"})]})]}),a.jsx("div",{className:"bg-orange-50 p-4 rounded-lg",children:a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-orange-800 mb-2",children:"Conformit"}),a.jsxs("ul",{className:"space-y-1 text-gray-600",children:[a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Plan Comptable Tunisien"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Normes NCT 01  15"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Format dclaration fiscale"]})]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-orange-800 mb-2",children:"Export disponible"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("button",{onClick:x,className:"w-full flex items-center gap-2 p-2 bg-white rounded-lg hover:bg-red-50 transition-colors text-left",children:[a.jsx(Ge,{className:"w-4 h-4 text-red-500"}),a.jsx("span",{className:"text-gray-700",children:"PDF conforme CNI"})]}),a.jsxs("button",{onClick:v,className:"w-full flex items-center gap-2 p-2 bg-white rounded-lg hover:bg-green-50 transition-colors text-left",children:[a.jsx(Cm,{className:"w-4 h-4 text-green-500"}),a.jsx("span",{className:"text-gray-700",children:"Excel format tunisien"})]}),a.jsxs("button",{onClick:y,className:"w-full flex items-center gap-2 p-2 bg-white rounded-lg hover:bg-blue-50 transition-colors text-left",children:[a.jsx(SD,{className:"w-4 h-4 text-blue-500"}),a.jsx("span",{className:"text-gray-700",children:"XML dclaration DGCF"})]})]})]})]})})]})]}),c==="income"&&n&&a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-4 border-b",children:[a.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:a.jsx(Ge,{className:"w-5 h-5 text-purple-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Compte de Rsultat"}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Du ",new Date((U=n.period)==null?void 0:U.start).toLocaleDateString("fr-FR")," au ",new Date((_=n.period)==null?void 0:_.end).toLocaleDateString("fr-FR")]})]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h4",{className:"text-sm font-medium text-green-600 mb-3 flex items-center gap-2",children:[a.jsx(Kt,{className:"w-4 h-4"}),"PRODUITS D'EXPLOITATION"]}),a.jsx("div",{className:"space-y-2 ml-6",children:(O=(B=n.revenues)==null?void 0:B.items)==null?void 0:O.map((se,le)=>a.jsxs("div",{className:"flex justify-between items-center p-2 bg-green-50 rounded",children:[a.jsx("span",{className:"text-gray-700",children:se.category}),a.jsx("span",{className:"font-medium text-green-700",children:f(se.total)})]},le))}),a.jsxs("div",{className:"flex justify-between items-center mt-3 p-3 bg-green-100 rounded-lg",children:[a.jsx("span",{className:"font-semibold text-green-800",children:"Total Produits"}),a.jsx("span",{className:"font-bold text-green-700",children:f((H=n.revenues)==null?void 0:H.total)})]})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"text-sm font-medium text-red-600 mb-3 flex items-center gap-2",children:[a.jsx(ya,{className:"w-4 h-4"}),"CHARGES D'EXPLOITATION"]}),a.jsx("div",{className:"space-y-2 ml-6",children:(te=(J=n.expenses)==null?void 0:J.items)==null?void 0:te.map((se,le)=>a.jsxs("div",{className:"flex justify-between items-center p-2 bg-red-50 rounded",children:[a.jsx("span",{className:"text-gray-700",children:se.category}),a.jsx("span",{className:"font-medium text-red-700",children:f(se.total)})]},le))}),a.jsxs("div",{className:"flex justify-between items-center mt-3 p-3 bg-red-100 rounded-lg",children:[a.jsx("span",{className:"font-semibold text-red-800",children:"Total Charges"}),a.jsx("span",{className:"font-bold text-red-700",children:f((ce=n.expenses)==null?void 0:ce.total)})]})]}),a.jsx("div",{className:"pt-4 border-t-2 border-dashed",children:a.jsxs("div",{className:`flex justify-between items-center p-4 rounded-xl ${n.netIncome>=0?"bg-blue-100":"bg-red-100"}`,children:[a.jsx("span",{className:"text-lg font-bold text-gray-900",children:"RSULTAT NET"}),a.jsx("span",{className:`text-2xl font-bold ${n.netIncome>=0?"text-blue-700":"text-red-700"}`,children:f(n.netIncome)})]})})]})]}),c==="cashflow"&&a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-4 border-b",children:[a.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center",children:a.jsx(Nm,{className:"w-5 h-5 text-indigo-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Flux de Trsorerie"}),a.jsx("p",{className:"text-sm text-gray-500",children:"volution sur les 12 derniers mois"})]})]}),s.length>0?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-4 py-2 text-sm font-medium text-gray-600",children:"Priode"}),a.jsx("th",{className:"text-right px-4 py-2 text-sm font-medium text-gray-600",children:"Entres"}),a.jsx("th",{className:"text-right px-4 py-2 text-sm font-medium text-gray-600",children:"Sorties"}),a.jsx("th",{className:"text-right px-4 py-2 text-sm font-medium text-gray-600",children:"Flux Net"}),a.jsx("th",{className:"text-right px-4 py-2 text-sm font-medium text-gray-600",children:"Solde Cumul"})]})}),a.jsx("tbody",{className:"divide-y",children:s.map((se,le)=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium",children:se.period}),a.jsx("td",{className:"px-4 py-3 text-right text-green-600",children:f(se.inflow)}),a.jsx("td",{className:"px-4 py-3 text-right text-red-600",children:f(se.outflow)}),a.jsxs("td",{className:`px-4 py-3 text-right font-medium ${se.netFlow>=0?"text-blue-600":"text-red-600"}`,children:[se.netFlow>=0?"+":"",f(se.netFlow)]}),a.jsx("td",{className:`px-4 py-3 text-right font-bold ${se.balance>=0?"text-green-600":"text-red-600"}`,children:f(se.balance)})]},le))})]}),a.jsxs("div",{className:"mt-6 pt-6 border-t",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-4",children:"volution graphique"}),(()=>{const se=Math.max(...s.map(le=>Math.max(le.inflow||0,le.outflow||0)),1);return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"h-48 flex items-end gap-3 px-2 pb-2 bg-gray-50 rounded-lg",children:s.map((le,he)=>{const ye=Math.max((le.inflow||0)/se*100,2),Ce=Math.max((le.outflow||0)/se*100,2);return a.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[a.jsxs("div",{className:"flex gap-1 items-end h-36 w-full",children:[a.jsxs("div",{className:"relative flex-1 group",children:[a.jsx("div",{className:"w-full bg-gradient-to-t from-green-500 to-green-400 rounded-t transition-all hover:from-green-600 hover:to-green-500",style:{height:`${ye}%`,minHeight:"4px"}}),a.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 hidden group-hover:block bg-gray-800 text-white text-xs px-2 py-1 rounded whitespace-nowrap z-10",children:["Entres: ",f(le.inflow)]})]}),a.jsxs("div",{className:"relative flex-1 group",children:[a.jsx("div",{className:"w-full bg-gradient-to-t from-red-500 to-red-400 rounded-t transition-all hover:from-red-600 hover:to-red-500",style:{height:`${Ce}%`,minHeight:"4px"}}),a.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 hidden group-hover:block bg-gray-800 text-white text-xs px-2 py-1 rounded whitespace-nowrap z-10",children:["Sorties: ",f(le.outflow)]})]})]}),a.jsx("span",{className:"text-xs text-gray-600 mt-2 font-medium",children:le.period.split("-")[1]||le.period})]},he)})}),a.jsxs("div",{className:"flex items-center justify-center gap-6 mt-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-4 h-4 bg-gradient-to-t from-green-500 to-green-400 rounded"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Entres"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-4 h-4 bg-gradient-to-t from-red-500 to-red-400 rounded"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Sorties"})]})]})]})})()]})]}):a.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune donne de trsorerie"}),a.jsxs("div",{className:"mt-8 pt-6 border-t",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Kt,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Prvision Financire"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Anticipez votre trsorerie sur 12 mois"})]})]}),(()=>{var Z,de,be,ze,Me;const se=s.length>0?s.reduce((Ae,Ye)=>Ae+(Ye.inflow||0),0)/s.length:5e3,le=s.length>0?s.reduce((Ae,Ye)=>Ae+(Ye.outflow||0),0)/s.length:3500,he=s.length>0?((Z=s[s.length-1])==null?void 0:Z.balance)||0:1e4,ye=["Jan","Fv","Mar","Avr","Mai","Jun","Jul","Ao","Sep","Oct","Nov","Dc"],Ce=new Date().getMonth(),xe=[];let $e=he;for(let Ae=0;Ae<12;Ae++){const Ye=(Ce+Ae)%12,nt=1+Math.sin(Ae*.5)*.15,ne=se*nt,ie=le*(1+(Math.random()*.1-.05));$e+=ne-ie,xe.push({month:ye[Ye],balance:$e})}const _e=Math.max(...xe.map(Ae=>Ae.balance)),Re=Math.min(...xe.map(Ae=>Ae.balance)),A=_e-Re||1;return a.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6",children:[a.jsx("div",{className:"h-64 flex items-end gap-2",children:xe.map((Ae,Ye)=>{const nt=(Ae.balance-Re)/A*100,ne=Ae.balance>=0;return a.jsxs("div",{className:"flex-1 flex flex-col items-center group",children:[a.jsxs("div",{className:"relative w-full flex flex-col items-center",children:[a.jsx("div",{className:"absolute bottom-full mb-2 hidden group-hover:block bg-gray-800 text-white text-xs px-2 py-1 rounded whitespace-nowrap z-10",children:f(Ae.balance)}),a.jsx("div",{className:`w-full rounded-t transition-all ${ne?"bg-gradient-to-t from-blue-500 to-blue-400 hover:from-blue-600 hover:to-blue-500":"bg-gradient-to-t from-red-500 to-red-400 hover:from-red-600 hover:to-red-500"}`,style:{height:`${Math.max(nt,10)}%`,minHeight:"20px"}})]}),a.jsx("span",{className:"text-xs text-gray-600 mt-2 font-medium",children:Ae.month})]},Ye)})}),a.jsxs("div",{className:"mt-6 grid grid-cols-3 gap-4 text-center",children:[a.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:[a.jsx("p",{className:"text-xs text-gray-500",children:"Solde actuel"}),a.jsx("p",{className:"text-lg font-bold text-gray-900",children:f(he)})]}),a.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:[a.jsx("p",{className:"text-xs text-gray-500",children:"Prvision 6 mois"}),a.jsx("p",{className:`text-lg font-bold ${((de=xe[5])==null?void 0:de.balance)>=0?"text-green-600":"text-red-600"}`,children:f(((be=xe[5])==null?void 0:be.balance)||0)})]}),a.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:[a.jsx("p",{className:"text-xs text-gray-500",children:"Prvision 12 mois"}),a.jsx("p",{className:`text-lg font-bold ${((ze=xe[11])==null?void 0:ze.balance)>=0?"text-green-600":"text-red-600"}`,children:f(((Me=xe[11])==null?void 0:Me.balance)||0)})]})]})]})})()]})]})]})},cL=()=>{var W,L,U;const[e,t]=S.useState(null),[n,r]=S.useState([]),[s,i]=S.useState(!0),[o,l]=S.useState(new Date().getFullYear()),[c,u]=S.useState(new Date().getMonth()+1),[d,h]=S.useState(19),[p,f]=S.useState(!1),[x,v]=S.useState(0),[y,m]=S.useState(0),g=[{value:1,label:"Janvier"},{value:2,label:"Fvrier"},{value:3,label:"Mars"},{value:4,label:"Avril"},{value:5,label:"Mai"},{value:6,label:"Juin"},{value:7,label:"Juillet"},{value:8,label:"Aot"},{value:9,label:"Septembre"},{value:10,label:"Octobre"},{value:11,label:"Novembre"},{value:12,label:"Dcembre"}];S.useEffect(()=>{b()},[o,c]);const b=async()=>{try{const[_,B]=await Promise.all([K.get(`/accounting/vat/summary?year=${o}&month=${c}`),K.get("/accounting/vat/declarations")]);t(_.data),r(B.data.declarations||[])}catch(_){console.error("Error fetching VAT data:",_),$.error("Erreur lors du chargement")}finally{i(!1)}},w=async()=>{var _,B;try{await K.post("/accounting/vat/declarations",{year:o,month:c,salesAmount:P,purchasesAmount:F,vatCollected:D,vatDeductible:j,vatDue:k,vatRate:d}),$.success("Dclaration TVA enregistre !"),b()}catch(O){$.error(((B=(_=O.response)==null?void 0:_.data)==null?void 0:B.message)||"Erreur")}},N=async _=>{var B,O;if(confirm("Supprimer cette dclaration ?"))try{await K.delete(`/accounting/vat/declarations/${_}`),$.success("Dclaration supprime !"),b()}catch(H){$.error(((O=(B=H.response)==null?void 0:B.data)==null?void 0:O.message)||"Erreur")}},C=_=>new Intl.NumberFormat("fr-TN",{style:"decimal",minimumFractionDigits:2}).format(_||0)+" TND",D=(x||(e==null?void 0:e.salesHT)||0)*(d/100),j=(y||(e==null?void 0:e.purchasesHT)||0)*(d/100),k=D-j,R=x||(e==null?void 0:e.salesHT)||0,E=y||(e==null?void 0:e.purchasesHT)||0,P=R*(1+d/100),F=E*(1+d/100);return s?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(ve,{to:"/comptabilite",className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(yn,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"TVA Tunisie"}),a.jsx("p",{className:"text-gray-600",children:"Calcul et dclaration de TVA automatiss"})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("select",{value:c,onChange:_=>u(parseInt(_.target.value)),className:"input py-2",children:g.map(_=>a.jsx("option",{value:_.value,children:_.label},_.value))}),a.jsx("select",{value:o,onChange:_=>l(parseInt(_.target.value)),className:"input py-2",children:[2024,2025,2026].map(_=>a.jsx("option",{value:_,children:_},_))})]})]}),a.jsxs("div",{className:"card bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("div",{className:"w-12 h-12 bg-orange-500 rounded-xl flex items-center justify-center",children:a.jsx(Bn,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Dclaration TVA"}),a.jsxs("p",{className:"text-orange-600",children:[(W=g.find(_=>_.value===c))==null?void 0:W.label," ",o]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-xl p-5 border border-orange-200",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-4",children:"VENTES / PRESTATIONS"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-gray-600",children:"Chiffre d'affaires HT"}),a.jsx("span",{className:"font-medium",children:C(R)})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-gray-600",children:"Chiffre d'affaires TTC"}),a.jsx("span",{className:"font-medium",children:C(P)})]}),a.jsxs("div",{className:"flex justify-between items-center pt-3 border-t",children:[a.jsxs("span",{className:"font-medium text-orange-700",children:["TVA Collecte (",d,"%)"]}),a.jsx("span",{className:"font-bold text-orange-600",children:C(D)})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl p-5 border border-orange-200",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-4",children:"ACHATS / CHARGES"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-gray-600",children:"Total achats HT"}),a.jsx("span",{className:"font-medium",children:C(E)})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-gray-600",children:"Total achats TTC"}),a.jsx("span",{className:"font-medium",children:C(F)})]}),a.jsxs("div",{className:"flex justify-between items-center pt-3 border-t",children:[a.jsxs("span",{className:"font-medium text-green-700",children:["TVA Dductible (",d,"%)"]}),a.jsx("span",{className:"font-bold text-green-600",children:C(j)})]})]})]})]}),a.jsx("div",{className:`mt-6 p-5 rounded-xl ${k>=0?"bg-red-50 border border-red-200":"bg-green-50 border border-green-200"}`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600 mb-1",children:k>=0?"TVA  payer":"Crdit de TVA"}),a.jsx("p",{className:`text-3xl font-bold ${k>=0?"text-red-600":"text-green-600"}`,children:C(Math.abs(k))})]}),a.jsxs("button",{onClick:w,className:"btn-primary flex items-center gap-2",children:[a.jsx(Ge,{className:"w-5 h-5"}),"Enregistrer la dclaration"]})]})})]}),a.jsxs("div",{className:"card border-2 border-primary-200 bg-gradient-to-r from-primary-50 to-indigo-50",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Configuration du taux TVA"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx("button",{onClick:()=>{h(19),f(!1)},className:`p-4 rounded-xl border-2 transition-all ${d===19&&!p?"border-primary-500 bg-primary-100":"border-gray-200 bg-white hover:border-primary-300"}`,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Bn,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{className:"text-left",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Standard"}),a.jsx("p",{className:"text-xl font-bold text-gray-900",children:"19%"})]})]})}),a.jsx("button",{onClick:()=>{h(7),f(!1)},className:`p-4 rounded-xl border-2 transition-all ${d===7&&!p?"border-primary-500 bg-primary-100":"border-gray-200 bg-white hover:border-primary-300"}`,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:a.jsx(Bn,{className:"w-5 h-5 text-green-600"})}),a.jsxs("div",{className:"text-left",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Rduit"}),a.jsx("p",{className:"text-xl font-bold text-gray-900",children:"7%"})]})]})}),a.jsx("div",{className:`p-4 rounded-xl border-2 transition-all ${p?"border-primary-500 bg-primary-100":"border-gray-200 bg-white"}`,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:a.jsx(Bn,{className:"w-5 h-5 text-purple-600"})}),a.jsxs("div",{className:"text-left flex-1",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Personnalis"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("input",{type:"number",value:p?d:"",onChange:_=>{f(!0),h(parseFloat(_.target.value)||0)},placeholder:"Taux",className:"w-16 px-2 py-1 border rounded text-lg font-bold",min:"0",max:"100",step:"0.5"}),a.jsx("span",{className:"text-xl font-bold",children:"%"})]})]})]})}),a.jsx("div",{className:"p-4 rounded-xl border-2 border-gray-200 bg-white",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:a.jsx(Hr,{className:"w-5 h-5 text-orange-600"})}),a.jsxs("div",{className:"text-left",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"chance"}),a.jsx("p",{className:"text-xl font-bold text-gray-900",children:"28 du mois"})]})]})})]})]}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Saisie manuelle (optionnel)"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ventes HT (TND)"}),a.jsx("input",{type:"number",value:x||"",onChange:_=>v(parseFloat(_.target.value)||0),placeholder:((L=e==null?void 0:e.salesHT)==null?void 0:L.toString())||"0",className:"input w-full"}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["TVA calcule: ",C(x*d/100)," (",d,"%)"]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Achats HT (TND)"}),a.jsx("input",{type:"number",value:y||"",onChange:_=>m(parseFloat(_.target.value)||0),placeholder:((U=e==null?void 0:e.purchasesHT)==null?void 0:U.toString())||"0",className:"input w-full"}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["TVA dductible: ",C(y*d/100)," (",d,"%)"]})]})]})]}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Historique des dclarations"}),n.length>0?a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-600",children:"Priode"}),a.jsx("th",{className:"text-right px-4 py-3 text-sm font-medium text-gray-600",children:"CA TTC"}),a.jsx("th",{className:"text-right px-4 py-3 text-sm font-medium text-gray-600",children:"TVA Collecte"}),a.jsx("th",{className:"text-right px-4 py-3 text-sm font-medium text-gray-600",children:"TVA Dductible"}),a.jsx("th",{className:"text-right px-4 py-3 text-sm font-medium text-gray-600",children:"TVA Due"}),a.jsx("th",{className:"text-center px-4 py-3 text-sm font-medium text-gray-600",children:"Statut"}),a.jsx("th",{className:"text-center px-4 py-3 text-sm font-medium text-gray-600",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y",children:n.map(_=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium",children:_.period}),a.jsx("td",{className:"px-4 py-3 text-right",children:C(_.salesAmount)}),a.jsx("td",{className:"px-4 py-3 text-right text-orange-600",children:C(_.vatCollected)}),a.jsx("td",{className:"px-4 py-3 text-right text-green-600",children:C(_.vatDeductible)}),a.jsx("td",{className:`px-4 py-3 text-right font-bold ${_.vatDue>=0?"text-red-600":"text-green-600"}`,children:C(_.vatDue)}),a.jsx("td",{className:"px-4 py-3 text-center",children:_.status==="submitted"?a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs font-medium",children:[a.jsx(tt,{className:"w-3 h-3"}),"Soumise"]}):a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-amber-100 text-amber-700 rounded-full text-xs font-medium",children:[a.jsx(Et,{className:"w-3 h-3"}),"Brouillon"]})}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx("button",{onClick:()=>N(_.id),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"Supprimer",children:a.jsx(or,{className:"w-4 h-4"})})})]},_.id))})]}):a.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune dclaration enregistre"})]})]})},uL=()=>{const[e,t]=S.useState(!1),[n,r]=S.useState(new Date(new Date().getFullYear(),0,1).toISOString().split("T")[0]),[s,i]=S.useState(new Date().toISOString().split("T")[0]),[o,l]=S.useState(null),[c,u]=S.useState(!1),[d,h]=S.useState(""),[p,f]=S.useState(""),[x,v]=S.useState(!1),y=async()=>{t(!0);try{const w=await K.get(`/accounting/export/fec?startDate=${n}&endDate=${s}`);l(w.data);const N=new Blob([JSON.stringify(w.data,null,2)],{type:"application/json"}),C=URL.createObjectURL(N),D=document.createElement("a");D.href=C,D.download=`FEC_${n}_${s}.json`,D.click(),URL.revokeObjectURL(C),$.success("Export FEC tlcharg !")}catch{$.error("Erreur lors de l'export")}finally{t(!1)}},m=async()=>{t(!0);try{const w=await K.get(`/accounting/export/summary?startDate=${n}&endDate=${s}`),N=`
        <!DOCTYPE html>
        <html>
        <head>
          <title>Rapport Comptable</title>
          <style>
            body { font-family: Arial, sans-serif; padding: 40px; }
            h1 { color: #1a1a1a; border-bottom: 2px solid #4f46e5; padding-bottom: 10px; }
            h2 { color: #4f46e5; margin-top: 30px; }
            table { width: 100%; border-collapse: collapse; margin: 20px 0; }
            th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
            th { background: #f3f4f6; font-weight: 600; }
            .total { font-weight: bold; background: #f0fdf4; }
            .profit { font-size: 24px; color: ${w.data.netProfit>=0?"#16a34a":"#dc2626"}; }
            .header-info { margin-bottom: 30px; color: #666; }
            .footer { margin-top: 40px; text-align: center; color: #999; font-size: 12px; }
          </style>
        </head>
        <body>
          <h1>Rapport Comptable</h1>
          <div class="header-info">
            <p><strong>Entreprise:</strong> ${w.data.company}</p>
            <p><strong>Priode:</strong> Du ${new Date(w.data.period.start).toLocaleDateString("fr-FR")} au ${new Date(w.data.period.end).toLocaleDateString("fr-FR")}</p>
            <p><strong>Gnr le:</strong> ${new Date(w.data.generatedAt).toLocaleDateString("fr-FR")}</p>
          </div>
          
          <h2>Revenus</h2>
          <table>
            <tr><th>Catgorie</th><th>Transactions</th><th>Montant</th></tr>
            ${w.data.revenues.items.map(D=>`<tr><td>${D.category}</td><td>${D.count}</td><td>${D.total.toFixed(2)} TND</td></tr>`).join("")}
            <tr class="total"><td>TOTAL REVENUS</td><td></td><td>${w.data.revenues.total.toFixed(2)} TND</td></tr>
          </table>
          
          <h2>Dpenses</h2>
          <table>
            <tr><th>Catgorie</th><th>Transactions</th><th>Montant</th></tr>
            ${w.data.expenses.items.map(D=>`<tr><td>${D.category}</td><td>${D.count}</td><td>${D.total.toFixed(2)} TND</td></tr>`).join("")}
            <tr class="total"><td>TOTAL DPENSES</td><td></td><td>${w.data.expenses.total.toFixed(2)} TND</td></tr>
          </table>
          
          <h2>Rsultat</h2>
          <p class="profit">Bnfice Net: ${w.data.netProfit.toFixed(2)} TND (Marge: ${w.data.profitMargin}%)</p>
          
          <div class="footer">
            <p>Document gnr par StartUpLab - Module Comptabilit</p>
          </div>
        </body>
        </html>
      `,C=window.open("","_blank");C.document.write(N),C.document.close(),C.print(),$.success("Rapport gnr !")}catch{$.error("Erreur lors de la gnration")}finally{t(!1)}},g=async()=>{t(!0);try{const w=await K.get(`/accounting/transactions?startDate=${n}&endDate=${s}`),N=["Date","Type","Catgorie","Description","Montant","Mode de paiement","Rfrence"],C=w.data.transactions.map(E=>[E.date,E.type==="revenue"?"Revenu":"Dpense",E.category,E.description||"",E.amount,E.paymentMethod||"",E.reference||""]),D=[N.join(";"),...C.map(E=>E.join(";"))].join(`
`),j=new Blob(["\uFEFF"+D],{type:"text/csv;charset=utf-8"}),k=URL.createObjectURL(j),R=document.createElement("a");R.href=k,R.download=`Transactions_${n}_${s}.csv`,R.click(),URL.revokeObjectURL(k),$.success("Export Excel tlcharg !")}catch{$.error("Erreur lors de l'export")}finally{t(!1)}},b=async()=>{var w,N;if(!d){$.error("Veuillez entrer l'email du comptable");return}v(!0);try{await K.post("/accounting/share/invite",{email:d,name:p,startDate:n,endDate:s}),$.success(`Invitation envoye  ${d} !`),u(!1),h(""),f("")}catch(C){$.error(((N=(w=C.response)==null?void 0:w.data)==null?void 0:N.message)||"Erreur lors de l'envoi")}finally{v(!1)}};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(ve,{to:"/comptabilite",className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(yn,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Export & Partage"}),a.jsx("p",{className:"text-gray-600",children:"Exportez vos donnes pour votre expert-comptable"})]})]}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Priode d'export"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de dbut"}),a.jsx("input",{type:"date",value:n,onChange:w=>r(w.target.value),className:"input"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de fin"}),a.jsx("input",{type:"date",value:s,onChange:w=>i(w.target.value),className:"input"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"card hover:shadow-lg transition-shadow",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:a.jsx(Ge,{className:"w-6 h-6 text-purple-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"Export FEC"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Format standard comptable"})]})]}),a.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"Fichier des critures Comptables au format standard. Compatible avec tous les logiciels de comptabilit."}),a.jsxs("ul",{className:"text-sm text-gray-500 space-y-1 mb-4",children:[a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(tt,{className:"w-4 h-4 text-green-500"}),"Format lgal franais"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(tt,{className:"w-4 h-4 text-green-500"}),"Compatible tous logiciels"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(tt,{className:"w-4 h-4 text-green-500"}),"Audit trail complet"]})]}),a.jsxs("button",{onClick:y,disabled:e,className:"w-full btn-primary flex items-center justify-center gap-2",children:[a.jsx(vn,{className:"w-5 h-5"}),"Tlcharger FEC"]})]}),a.jsxs("div",{className:"card hover:shadow-lg transition-shadow",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center",children:a.jsx(Ge,{className:"w-6 h-6 text-red-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"Rapport PDF"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Synthse comptable"})]})]}),a.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"Rapport de synthse avec revenus, dpenses et bnfice net. Idal pour les runions et prsentations."}),a.jsxs("ul",{className:"text-sm text-gray-500 space-y-1 mb-4",children:[a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(tt,{className:"w-4 h-4 text-green-500"}),"Synthse par catgorie"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(tt,{className:"w-4 h-4 text-green-500"}),"Calcul automatique"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(tt,{className:"w-4 h-4 text-green-500"}),"Prt  imprimer"]})]}),a.jsxs("button",{onClick:m,disabled:e,className:"w-full btn-primary flex items-center justify-center gap-2",children:[a.jsx(vn,{className:"w-5 h-5"}),"Gnrer PDF"]})]}),a.jsxs("div",{className:"card hover:shadow-lg transition-shadow",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:a.jsx(Cm,{className:"w-6 h-6 text-green-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"Export Excel"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Donnes brutes"})]})]}),a.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"Export CSV de toutes les transactions. Ouvrable avec Excel, Google Sheets ou LibreOffice."}),a.jsxs("ul",{className:"text-sm text-gray-500 space-y-1 mb-4",children:[a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(tt,{className:"w-4 h-4 text-green-500"}),"Toutes les transactions"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(tt,{className:"w-4 h-4 text-green-500"}),"Format CSV universel"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(tt,{className:"w-4 h-4 text-green-500"}),"Modifiable"]})]}),a.jsxs("button",{onClick:g,disabled:e,className:"w-full btn-primary flex items-center justify-center gap-2",children:[a.jsx(vn,{className:"w-5 h-5"}),"Tlcharger Excel"]})]})]}),a.jsx("div",{className:"card bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-200",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-blue-500 rounded-xl flex items-center justify-center",children:a.jsx(YD,{className:"w-7 h-7 text-white"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Partager avec votre expert-comptable"}),a.jsx("p",{className:"text-gray-600",children:"Envoyez un accs scuris  votre comptable pour qu'il puisse consulter vos donnes"})]}),a.jsxs("button",{onClick:()=>u(!0),className:"btn-primary flex items-center gap-2",children:[a.jsx(rr,{className:"w-5 h-5"}),"Inviter"]})]})}),c&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-md mx-4 shadow-2xl",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:a.jsx(rr,{className:"w-6 h-6 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Inviter un expert-comptable"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Envoi par email scuris"})]})]}),a.jsx("button",{onClick:()=>u(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(kt,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom du comptable (optionnel)"}),a.jsxs("div",{className:"relative",children:[a.jsx(qn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",value:p,onChange:w=>f(w.target.value),placeholder:"M. Dupont",className:"input pl-10 w-full"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email du comptable *"}),a.jsxs("div",{className:"relative",children:[a.jsx(rr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"email",value:d,onChange:w=>h(w.target.value),placeholder:"comptable@cabinet.com",className:"input pl-10 w-full",required:!0})]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:a.jsx("strong",{children:"Donnes partages :"})}),a.jsxs("ul",{className:"text-sm text-gray-500 space-y-1",children:[a.jsxs("li",{children:[" Priode : ",new Date(n).toLocaleDateString("fr-FR")," - ",new Date(s).toLocaleDateString("fr-FR")]}),a.jsx("li",{children:" Fichier FEC (critures comptables)"}),a.jsx("li",{children:" Rapport de synthse (revenus/dpenses)"}),a.jsx("li",{children:" Export des transactions"})]})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx("button",{onClick:()=>u(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Annuler"}),a.jsx("button",{onClick:b,disabled:x||!d,className:"flex-1 btn-primary flex items-center justify-center gap-2",children:x?a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(Em,{className:"w-5 h-5"}),"Envoyer"]})})]})]})]})})]})},dL=()=>{const{token:e}=jr(),[t,n]=S.useState(null),[r,s]=S.useState(!0),[i,o]=S.useState(null);S.useEffect(()=>{l()},[e]);const l=async()=>{var d,h;try{const p=await pt.get(`http://localhost:5000/api/accounting/shared/${e}`);n(p.data)}catch(p){o(((h=(d=p.response)==null?void 0:d.data)==null?void 0:h.message)||"Lien invalide ou expir")}finally{s(!1)}},c=d=>new Intl.NumberFormat("fr-TN",{style:"decimal",minimumFractionDigits:2}).format(d||0)+" TND",u=()=>{if(!(t!=null&&t.transactions))return;const d=["Date","Type","Catgorie","Description","Montant"],h=t.transactions.map(y=>[y.date,y.type==="revenue"?"Revenu":"Dpense",y.category,y.description||"",y.amount]),p=[d.join(";"),...h.map(y=>y.join(";"))].join(`
`),f=new Blob(["\uFEFF"+p],{type:"text/csv;charset=utf-8"}),x=URL.createObjectURL(f),v=document.createElement("a");v.href=x,v.download=`Transactions_${t.owner.name.replace(/\s/g,"_")}.csv`,v.click(),URL.revokeObjectURL(x),$.success("Export tlcharg !")};return r?a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):i?a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"bg-white rounded-2xl p-8 max-w-md text-center shadow-lg",children:[a.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(cl,{className:"w-8 h-8 text-red-600"})}),a.jsx("h1",{className:"text-xl font-bold text-gray-900 mb-2",children:"Accs refus"}),a.jsx("p",{className:"text-gray-600 mb-6",children:i}),a.jsx(ve,{to:"/",className:"btn-primary inline-block",children:"Retour  l'accueil"})]})}):a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("div",{className:"bg-gradient-to-r from-primary-600 to-indigo-600 text-white py-8",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx("span",{className:"text-2xl",children:""}),a.jsx("span",{className:"text-xl font-bold",children:"StartUpLab"})]}),a.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Donnes Comptables Partages"}),a.jsxs("p",{className:"opacity-90",children:["Accs scuris aux donnes de ",t.owner.name]})]})}),a.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[a.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm mb-6",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-6",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center",children:a.jsx(qn,{className:"w-6 h-6 text-primary-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900",children:t.owner.name}),a.jsx("p",{className:"text-sm text-gray-500",children:t.owner.email})]})]}),t.owner.company&&a.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[a.jsx(md,{className:"w-5 h-5"}),a.jsx("span",{children:t.owner.company})]}),a.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[a.jsx(Hr,{className:"w-5 h-5"}),a.jsxs("span",{children:["Du ",new Date(t.period.start).toLocaleDateString("fr-FR")," au ",new Date(t.period.end).toLocaleDateString("fr-FR")]})]}),a.jsxs("div",{className:"flex items-center gap-2 text-amber-600 ml-auto",children:[a.jsx(Et,{className:"w-5 h-5"}),a.jsxs("span",{className:"text-sm",children:["Expire le ",new Date(t.expiresAt).toLocaleDateString("fr-FR")]})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:a.jsx(Kt,{className:"w-5 h-5 text-green-600"})}),a.jsx("span",{className:"text-sm text-gray-500",children:"Revenus"})]}),a.jsx("p",{className:"text-2xl font-bold text-green-600",children:c(t.summary.totalRevenue)})]}),a.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:a.jsx(ya,{className:"w-5 h-5 text-red-600"})}),a.jsx("span",{className:"text-sm text-gray-500",children:"Dpenses"})]}),a.jsx("p",{className:"text-2xl font-bold text-red-600",children:c(t.summary.totalExpense)})]}),a.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(va,{className:"w-5 h-5 text-blue-600"})}),a.jsx("span",{className:"text-sm text-gray-500",children:"Bnfice Net"})]}),a.jsx("p",{className:`text-2xl font-bold ${t.summary.netProfit>=0?"text-green-600":"text-red-600"}`,children:c(t.summary.netProfit)})]}),a.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:a.jsx(Ge,{className:"w-5 h-5 text-purple-600"})}),a.jsx("span",{className:"text-sm text-gray-500",children:"Transactions"})]}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.summary.transactionCount})]})]}),a.jsx("div",{className:"flex justify-end mb-4",children:a.jsxs("button",{onClick:u,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[a.jsx(Cm,{className:"w-5 h-5"}),"Exporter CSV"]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden mb-6",children:[a.jsx("div",{className:"px-6 py-4 border-b",children:a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Transactions"})}),t.transactions.length>0?a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-500",children:"Date"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-500",children:"Type"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-500",children:"Catgorie"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-500",children:"Description"}),a.jsx("th",{className:"px-6 py-3 text-right text-sm font-medium text-gray-500",children:"Montant"})]})}),a.jsx("tbody",{className:"divide-y",children:t.transactions.map(d=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:new Date(d.date).toLocaleDateString("fr-FR")}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${d.type==="revenue"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:d.type==="revenue"?a.jsxs(a.Fragment,{children:[a.jsx(Kt,{className:"w-3 h-3"})," Revenu"]}):a.jsxs(a.Fragment,{children:[a.jsx(ya,{className:"w-3 h-3"})," Dpense"]})})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:d.category}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:d.description||"-"}),a.jsxs("td",{className:`px-6 py-4 text-sm font-medium text-right ${d.type==="revenue"?"text-green-600":"text-red-600"}`,children:[d.type==="revenue"?"+":"-",c(d.amount)]})]},d.id))})]}):a.jsx("p",{className:"px-6 py-8 text-center text-gray-500",children:"Aucune transaction pour cette priode"})]}),t.vatDeclarations.length>0&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[a.jsx("div",{className:"px-6 py-4 border-b",children:a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Dclarations TVA"})}),a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-500",children:"Priode"}),a.jsx("th",{className:"px-6 py-3 text-right text-sm font-medium text-gray-500",children:"TVA Collecte"}),a.jsx("th",{className:"px-6 py-3 text-right text-sm font-medium text-gray-500",children:"TVA Dductible"}),a.jsx("th",{className:"px-6 py-3 text-right text-sm font-medium text-gray-500",children:"TVA Due"}),a.jsx("th",{className:"px-6 py-3 text-center text-sm font-medium text-gray-500",children:"Statut"})]})}),a.jsx("tbody",{className:"divide-y",children:t.vatDeclarations.map(d=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 font-medium",children:d.period}),a.jsx("td",{className:"px-6 py-4 text-right text-orange-600",children:c(d.vatCollected)}),a.jsx("td",{className:"px-6 py-4 text-right text-green-600",children:c(d.vatDeductible)}),a.jsx("td",{className:`px-6 py-4 text-right font-bold ${d.vatDue>=0?"text-red-600":"text-green-600"}`,children:c(d.vatDue)}),a.jsx("td",{className:"px-6 py-4 text-center",children:d.status==="submitted"?a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs",children:[a.jsx(tt,{className:"w-3 h-3"})," Soumise"]}):a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-amber-100 text-amber-700 rounded-full text-xs",children:[a.jsx(Et,{className:"w-3 h-3"})," Brouillon"]})})]},d.id))})]})]}),a.jsx("div",{className:"mt-8 text-center text-gray-500 text-sm",children:a.jsx("p",{children:"Donnes partages via StartUpLab - Plateforme de gestion pour entrepreneurs tunisiens"})})]})]})},hL=()=>{const{slug:e}=jr(),t=lr(),{user:n}=cr(),[r,s]=S.useState(null),[i,o]=S.useState(!0),[l,c]=S.useState(!1),[u,d]=S.useState(null),h={"bilan-auto":"/comptabilite/bilan","comptabilite-lite":"/comptabilite","comptabilite-pro":"/comptabilite","tva-tunisie":"/comptabilite/tva","export-expert":"/comptabilite/export","pack-comptabilite-complet":"/comptabilite"};S.useEffect(()=>{f(),p()},[e]);const p=async()=>{var g;try{const w=(g=(await K.get("/products/my-products")).data.products)==null?void 0:g.find(N=>N.slug===e);w&&d(w)}catch{}},f=async()=>{try{const g=await K.get(`/products/product/${e}`);s(g.data.product)}catch(g){console.error("Error fetching product:",g),$.error("Produit non trouv"),t("/entreprise/produits-solutions")}finally{o(!1)}},x=async()=>{var g,b;if((n==null?void 0:n.subscription)!=="enterprise"){$.error("Cette fonctionnalit ncessite un abonnement Enterprise"),t("/pricing");return}c(!0);try{await K.post("/products/activate",{productId:r.id,duration:1}),$.success("Demande envoye ! En attente d'approbation."),t("/mes-offres")}catch(w){$.error(((b=(g=w.response)==null?void 0:g.data)==null?void 0:b.message)||"Erreur")}finally{c(!1)}},v=()=>r?{"comptabilite-lite":{title:"StartUp Comptabilit Lite",description:"Comptabilit simplifie pour les petites startups",screens:[{title:"Tableau de bord mensuel",description:"Visualisez vos revenus et dpenses en un coup d'il",component:a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[a.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[a.jsx("p",{className:"text-sm text-green-600",children:"Revenus"}),a.jsx("p",{className:"text-2xl font-bold text-green-700",children:"12,450 TND"})]}),a.jsxs("div",{className:"bg-red-50 rounded-lg p-4",children:[a.jsx("p",{className:"text-sm text-red-600",children:"Dpenses"}),a.jsx("p",{className:"text-2xl font-bold text-red-700",children:"8,320 TND"})]}),a.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[a.jsx("p",{className:"text-sm text-blue-600",children:"Bnfice"}),a.jsx("p",{className:"text-2xl font-bold text-blue-700",children:"4,130 TND"})]})]}),a.jsx("div",{className:"h-32 bg-gradient-to-r from-green-100 to-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Nm,{className:"w-16 h-16 text-primary-400"})})]})},{title:"Saisie revenus/dpenses",description:"Ajoutez vos transactions facilement",component:a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[a.jsxs("div",{className:"flex gap-2 mb-4",children:[a.jsxs("button",{className:"flex-1 py-3 bg-green-500 text-white rounded-lg font-medium",children:[a.jsx(Kt,{className:"w-5 h-5 inline mr-2"}),"Revenu"]}),a.jsxs("button",{className:"flex-1 py-3 bg-gray-100 text-gray-600 rounded-lg font-medium",children:[a.jsx(ya,{className:"w-5 h-5 inline mr-2"}),"Dpense"]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("input",{className:"w-full p-3 border rounded-lg",placeholder:"Catgorie: Ventes produits",disabled:!0}),a.jsx("input",{className:"w-full p-3 border rounded-lg",placeholder:"Montant: 1,500 TND",disabled:!0}),a.jsx("input",{className:"w-full p-3 border rounded-lg",placeholder:"Date: 07/02/2026",disabled:!0})]})]})}]},"comptabilite-pro":{title:"StartUp Comptabilit Pro",description:"Comptabilit complte avec bilan et prvisions",screens:[{title:"Bilan automatique",description:"Bilan actif/passif gnr automatiquement",component:a.jsx("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:a.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[a.jsxs("div",{className:"border-r pr-6",children:[a.jsx("h4",{className:"font-semibold text-green-600 mb-3",children:"ACTIF"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Trsorerie"}),a.jsx("span",{className:"font-medium",children:"45,000 TND"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Crances clients"}),a.jsx("span",{className:"font-medium",children:"12,000 TND"})]}),a.jsxs("div",{className:"flex justify-between font-bold border-t pt-2",children:[a.jsx("span",{children:"Total Actif"}),a.jsx("span",{children:"57,000 TND"})]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-blue-600 mb-3",children:"PASSIF"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Dettes fournisseurs"}),a.jsx("span",{className:"font-medium",children:"8,000 TND"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Capitaux propres"}),a.jsx("span",{className:"font-medium",children:"49,000 TND"})]}),a.jsxs("div",{className:"flex justify-between font-bold border-t pt-2",children:[a.jsx("span",{children:"Total Passif"}),a.jsx("span",{children:"57,000 TND"})]})]})]})]})})},{title:"Prvision financire",description:"Anticipez votre trsorerie sur 12 mois",component:a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[a.jsx("div",{className:"flex items-end gap-2 h-40",children:[65,72,68,85,90,88,95,102,98,110,115,125].map((b,w)=>a.jsx("div",{className:"flex-1 bg-gradient-to-t from-primary-500 to-primary-300 rounded-t",style:{height:`${b}%`}},w))}),a.jsxs("div",{className:"flex justify-between mt-2 text-xs text-gray-500",children:[a.jsx("span",{children:"Jan"}),a.jsx("span",{children:"Fv"}),a.jsx("span",{children:"Mar"}),a.jsx("span",{children:"Avr"}),a.jsx("span",{children:"Mai"}),a.jsx("span",{children:"Jun"}),a.jsx("span",{children:"Jul"}),a.jsx("span",{children:"Ao"}),a.jsx("span",{children:"Sep"}),a.jsx("span",{children:"Oct"}),a.jsx("span",{children:"Nov"}),a.jsx("span",{children:"Dc"})]})]})}]},"bilan-auto":{title:"Bilan Automatique",description:"Gnration automatique de bilans comptables",screens:[{title:"Bilan Actif / Passif",description:"Vue complte de votre situation financire",component:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[a.jsxs("div",{className:"bg-gradient-to-r from-primary-600 to-indigo-600 p-4 text-white flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold",children:"tats Financiers"}),a.jsx("p",{className:"text-sm text-white/80",children:"Bilan, compte de rsultat et cash flow"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm",children:"07/02/2026"}),a.jsxs("button",{className:"px-3 py-1 bg-red-500 text-white rounded-lg text-sm flex items-center gap-1",children:[a.jsx(Ge,{className:"w-4 h-4"}),"Exporter PDF"]})]})]}),a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex gap-4 mb-4 border-b",children:[a.jsx("button",{className:"px-4 py-2 border-b-2 border-primary-600 text-primary-600 font-medium",children:"Bilan"}),a.jsx("button",{className:"px-4 py-2 text-gray-500",children:"Compte de Rsultat"}),a.jsx("button",{className:"px-4 py-2 text-gray-500",children:"Cash Flow"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-green-50 rounded-xl p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Kt,{className:"w-5 h-5 text-green-600"}),a.jsx("h4",{className:"font-bold text-green-800",children:"ACTIF"}),a.jsx("span",{className:"text-xs text-gray-500 ml-auto",children:"Au 07/02/2026"})]}),a.jsxs("div",{className:"space-y-3 text-sm",children:[a.jsx("div",{className:"text-green-700 font-medium",children:"Actif Circulant"}),a.jsxs("div",{className:"flex justify-between pl-4",children:[a.jsx("span",{children:"Trsorerie disponible"}),a.jsx("span",{className:"font-bold text-green-600",children:"600,00 TND"})]}),a.jsx("div",{className:"text-green-700 font-medium mt-2",children:"Dtail par catgorie"}),a.jsxs("div",{className:"flex justify-between pl-4",children:[a.jsx("span",{children:"Ventes produits"}),a.jsx("span",{children:"1200,00 TND"})]}),a.jsxs("div",{className:"flex justify-between pt-2 border-t font-bold",children:[a.jsx("span",{children:"TOTAL ACTIF"}),a.jsx("span",{className:"text-green-600",children:"600,00 TND"})]})]})]}),a.jsxs("div",{className:"bg-blue-50 rounded-xl p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Sm,{className:"w-5 h-5 text-blue-600"}),a.jsx("h4",{className:"font-bold text-blue-800",children:"PASSIF"}),a.jsx("span",{className:"text-xs text-gray-500 ml-auto",children:"Au 07/02/2026"})]}),a.jsxs("div",{className:"space-y-3 text-sm",children:[a.jsx("div",{className:"text-blue-700 font-medium",children:"Dettes"}),a.jsxs("div",{className:"flex justify-between pl-4",children:[a.jsx("span",{children:"Dettes courantes"}),a.jsx("span",{children:"0,00 TND"})]}),a.jsx("div",{className:"text-blue-700 font-medium mt-2",children:"Capitaux Propres"}),a.jsxs("div",{className:"flex justify-between pl-4",children:[a.jsx("span",{children:"Rsultat cumul"}),a.jsx("span",{className:"font-bold text-blue-600",children:"600,00 TND"})]}),a.jsxs("div",{className:"flex justify-between pt-2 border-t font-bold",children:[a.jsx("span",{children:"TOTAL PASSIF"}),a.jsx("span",{className:"text-blue-600",children:"600,00 TND"})]})]})]})]})]})]})},{title:"Compte de Rsultat",description:"Analyse des revenus et charges",component:a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[a.jsx("h4",{className:"font-bold text-lg mb-4",children:"Compte de Rsultat - Exercice 2026"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("span",{className:"font-medium text-green-700",children:"Produits d'exploitation"}),a.jsx("span",{className:"font-bold text-green-600",children:"15,500 TND"})]}),a.jsxs("div",{className:"text-sm text-gray-600 pl-4 space-y-1",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Ventes de marchandises"}),a.jsx("span",{children:"12,000 TND"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Prestations de services"}),a.jsx("span",{children:"3,500 TND"})]})]})]}),a.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("span",{className:"font-medium text-red-700",children:"Charges d'exploitation"}),a.jsx("span",{className:"font-bold text-red-600",children:"-8,200 TND"})]}),a.jsxs("div",{className:"text-sm text-gray-600 pl-4 space-y-1",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Achats de matires"}),a.jsx("span",{children:"-4,500 TND"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Charges de personnel"}),a.jsx("span",{children:"-2,500 TND"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Autres charges"}),a.jsx("span",{children:"-1,200 TND"})]})]})]}),a.jsx("div",{className:"bg-primary-50 p-4 rounded-lg border-2 border-primary-200",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"font-bold text-primary-700",children:"Rsultat Net"}),a.jsx("span",{className:"font-bold text-2xl text-primary-600",children:"+7,300 TND"})]})})]})]})},{title:"Analyse automatique",description:"Indicateurs et recommandations IA",component:a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[a.jsx("h4",{className:"font-bold text-lg mb-4",children:"Analyse Financire Automatique"}),a.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-green-600",children:"47%"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Marge nette"})]}),a.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-blue-600",children:"1.8"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Ratio liquidit"})]}),a.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-purple-600",children:"+23%"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Croissance"})]})]}),a.jsx("div",{className:"bg-gradient-to-r from-primary-50 to-indigo-50 p-4 rounded-lg border border-primary-200",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-primary-500 rounded-full flex items-center justify-center text-white text-sm",children:"IA"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-primary-800",children:"Recommandation IA"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Votre marge nette est excellente (47%). Considrez d'investir dans l'expansion pour maintenir cette croissance."})]})]})})]})}]},"tva-tunisie":{title:"TVA Tunisie Auto",description:"Calcul et dclaration TVA automatiss",screens:[{title:"Calcul automatique TVA",description:"TVA 19% et 7% calcules automatiquement",component:a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[a.jsx("div",{className:"bg-orange-50 rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-orange-700 font-medium",children:"Priode: Fvrier 2026"}),a.jsx("span",{className:"text-sm bg-orange-200 px-2 py-1 rounded",children:"Taux: 19%"})]})}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded",children:[a.jsx("span",{children:"TVA Collecte"}),a.jsx("span",{className:"font-bold text-orange-600",children:"2,365 TND"})]}),a.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded",children:[a.jsx("span",{children:"TVA Dductible"}),a.jsx("span",{className:"font-bold text-green-600",children:"1,580 TND"})]}),a.jsxs("div",{className:"flex justify-between p-3 bg-red-50 rounded border border-red-200",children:[a.jsx("span",{className:"font-medium",children:"TVA  payer"}),a.jsx("span",{className:"font-bold text-red-600",children:"785 TND"})]})]})]})}]},"export-expert":{title:"Export Expert-Comptable",description:"Export de donnes pour votre expert-comptable",screens:[{title:"Formats d'export",description:"FEC, Excel, PDF - Compatible tous logiciels",component:a.jsx("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{className:"border-2 border-dashed border-purple-300 rounded-lg p-4 text-center hover:border-purple-500 cursor-pointer",children:[a.jsx(Ge,{className:"w-10 h-10 text-purple-500 mx-auto mb-2"}),a.jsx("p",{className:"font-medium",children:"Format FEC"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Standard lgal"})]}),a.jsxs("div",{className:"border-2 border-dashed border-green-300 rounded-lg p-4 text-center hover:border-green-500 cursor-pointer",children:[a.jsx(vn,{className:"w-10 h-10 text-green-500 mx-auto mb-2"}),a.jsx("p",{className:"font-medium",children:"Excel/CSV"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Donnes brutes"})]}),a.jsxs("div",{className:"border-2 border-dashed border-red-300 rounded-lg p-4 text-center hover:border-red-500 cursor-pointer",children:[a.jsx(Ge,{className:"w-10 h-10 text-red-500 mx-auto mb-2"}),a.jsx("p",{className:"font-medium",children:"PDF"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Rapport complet"})]})]})})}]},"pack-comptabilite-complet":{title:"Pack Comptabilit Complet",description:"Toutes les solutions comptabilit en un seul pack",screens:[{title:"Tableau de bord complet",description:"Vue d'ensemble de votre comptabilit",component:a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[a.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-gradient-to-br from-green-400 to-green-600 rounded-xl p-4 text-white",children:[a.jsx("p",{className:"text-sm opacity-80",children:"Revenus"}),a.jsx("p",{className:"text-2xl font-bold",children:"45,230 TND"}),a.jsx("p",{className:"text-xs opacity-70",children:"+12% ce mois"})]}),a.jsxs("div",{className:"bg-gradient-to-br from-red-400 to-red-600 rounded-xl p-4 text-white",children:[a.jsx("p",{className:"text-sm opacity-80",children:"Dpenses"}),a.jsx("p",{className:"text-2xl font-bold",children:"28,150 TND"}),a.jsx("p",{className:"text-xs opacity-70",children:"-5% ce mois"})]}),a.jsxs("div",{className:"bg-gradient-to-br from-blue-400 to-blue-600 rounded-xl p-4 text-white",children:[a.jsx("p",{className:"text-sm opacity-80",children:"Bnfice Net"}),a.jsx("p",{className:"text-2xl font-bold",children:"17,080 TND"}),a.jsx("p",{className:"text-xs opacity-70",children:"Marge: 37.8%"})]}),a.jsxs("div",{className:"bg-gradient-to-br from-orange-400 to-orange-600 rounded-xl p-4 text-white",children:[a.jsx("p",{className:"text-sm opacity-80",children:"TVA  payer"}),a.jsx("p",{className:"text-2xl font-bold",children:"3,245 TND"}),a.jsx("p",{className:"text-xs opacity-70",children:"chance: 15/03"})]})]}),a.jsx("div",{className:"h-40 bg-gradient-to-r from-primary-100 via-green-100 to-blue-100 rounded-xl flex items-center justify-center",children:a.jsx("div",{className:"flex items-end gap-2 h-32",children:[40,55,45,70,65,80,75,90,85,95,88,100].map((b,w)=>a.jsx("div",{className:"w-6 bg-gradient-to-t from-primary-600 to-primary-400 rounded-t transition-all hover:from-primary-700",style:{height:`${b}%`}},w))})})]})},{title:"Bilan & Compte de rsultat",description:"tats financiers gnrs automatiquement",component:a.jsx("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:a.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[a.jsxs("div",{className:"border rounded-xl p-4",children:[a.jsxs("h4",{className:"font-bold text-green-600 mb-4 flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),"ACTIF"]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between p-2 bg-green-50 rounded",children:[a.jsx("span",{children:"Trsorerie"}),a.jsx("span",{className:"font-semibold",children:"125,000 TND"})]}),a.jsxs("div",{className:"flex justify-between p-2 bg-green-50 rounded",children:[a.jsx("span",{children:"Crances clients"}),a.jsx("span",{className:"font-semibold",children:"45,000 TND"})]}),a.jsxs("div",{className:"flex justify-between p-2 bg-green-50 rounded",children:[a.jsx("span",{children:"Stocks"}),a.jsx("span",{className:"font-semibold",children:"32,000 TND"})]}),a.jsxs("div",{className:"flex justify-between p-3 bg-green-200 rounded-lg font-bold",children:[a.jsx("span",{children:"TOTAL ACTIF"}),a.jsx("span",{children:"202,000 TND"})]})]})]}),a.jsxs("div",{className:"border rounded-xl p-4",children:[a.jsxs("h4",{className:"font-bold text-blue-600 mb-4 flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),"PASSIF"]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between p-2 bg-blue-50 rounded",children:[a.jsx("span",{children:"Dettes fournisseurs"}),a.jsx("span",{className:"font-semibold",children:"28,000 TND"})]}),a.jsxs("div",{className:"flex justify-between p-2 bg-blue-50 rounded",children:[a.jsx("span",{children:"Emprunts"}),a.jsx("span",{className:"font-semibold",children:"50,000 TND"})]}),a.jsxs("div",{className:"flex justify-between p-2 bg-blue-50 rounded",children:[a.jsx("span",{children:"Capitaux propres"}),a.jsx("span",{className:"font-semibold",children:"124,000 TND"})]}),a.jsxs("div",{className:"flex justify-between p-3 bg-blue-200 rounded-lg font-bold",children:[a.jsx("span",{children:"TOTAL PASSIF"}),a.jsx("span",{children:"202,000 TND"})]})]})]})]})})},{title:"TVA & Dclarations",description:"Gestion automatique de la TVA tunisienne",component:a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[a.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-4",children:[a.jsx("p",{className:"text-sm text-orange-600",children:"TVA Collecte (19%)"}),a.jsx("p",{className:"text-xl font-bold text-orange-700",children:"8,594 TND"})]}),a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4",children:[a.jsx("p",{className:"text-sm text-green-600",children:"TVA Dductible"}),a.jsx("p",{className:"text-xl font-bold text-green-700",children:"5,349 TND"})]}),a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:[a.jsx("p",{className:"text-sm text-red-600",children:"TVA  Payer"}),a.jsx("p",{className:"text-xl font-bold text-red-700",children:"3,245 TND"})]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[a.jsx("h5",{className:"font-semibold mb-3",children:"Historique des dclarations"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between p-2 bg-white rounded border",children:[a.jsx("span",{children:"Janvier 2026"}),a.jsx("span",{className:"text-green-600 font-medium",children:" Dclare"})]}),a.jsxs("div",{className:"flex items-center justify-between p-2 bg-white rounded border",children:[a.jsx("span",{children:"Fvrier 2026"}),a.jsx("span",{className:"text-orange-600 font-medium",children:" En cours"})]})]})]})]})},{title:"Export & Partage",description:"Exportez vos donnes pour votre expert-comptable",component:a.jsx("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:a.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"font-semibold mb-4",children:"Formats disponibles"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg hover:bg-purple-50 cursor-pointer",children:[a.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:a.jsx(Ge,{className:"w-5 h-5 text-purple-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Format FEC"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Fichier des critures Comptables"})]})]}),a.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg hover:bg-green-50 cursor-pointer",children:[a.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:a.jsx(vn,{className:"w-5 h-5 text-green-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Excel / CSV"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Donnes tabulaires"})]})]}),a.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg hover:bg-red-50 cursor-pointer",children:[a.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:a.jsx(Ge,{className:"w-5 h-5 text-red-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Rapport PDF"}),a.jsx("p",{className:"text-xs text-gray-500",children:"tats financiers complets"})]})]})]})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-semibold mb-4",children:"Partage scuris"}),a.jsxs("div",{className:"bg-blue-50 rounded-xl p-4",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold",children:"EC"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Expert-Comptable"}),a.jsx("p",{className:"text-sm text-gray-600",children:"cabinet@exemple.tn"})]})]}),a.jsx("button",{className:"w-full py-2 bg-blue-600 text-white rounded-lg font-medium",children:"Envoyer les documents"})]})]})]})})}]},"gestion-employes":{title:"Gestion Employs",description:"Grez vos employs facilement",screens:[{title:"Liste des employs",description:"Vue d'ensemble de votre quipe",component:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[a.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 p-4 text-white",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold",children:"Mes Employs"}),a.jsx("p",{className:"text-sm text-white/80",children:"12 employs actifs"})]}),a.jsx("button",{className:"px-4 py-2 bg-white text-blue-600 rounded-lg font-medium text-sm",children:"+ Ajouter"})]})}),a.jsx("div",{className:"p-4",children:a.jsx("div",{className:"space-y-3",children:[{name:"Ahmed Ben Ali",role:"Dveloppeur Senior",dept:"IT",salary:"3,500 TND",status:"Actif"},{name:"Fatma Trabelsi",role:"Chef de Projet",dept:"Management",salary:"4,200 TND",status:"Actif"},{name:"Mohamed Sassi",role:"Designer UI/UX",dept:"Cratif",salary:"2,800 TND",status:"Actif"},{name:"Sarra Karoui",role:"Comptable",dept:"Finance",salary:"2,500 TND",status:"Cong"}].map((b,w)=>a.jsxs("div",{className:"flex items-center gap-4 p-3 border rounded-lg hover:bg-gray-50",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center text-white font-bold",children:b.name.split(" ").map(N=>N[0]).join("")}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium",children:b.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:[b.role,"  ",b.dept]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"font-semibold text-green-600",children:b.salary}),a.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${b.status==="Actif"?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:b.status})]})]},w))})})]})},{title:"Fiche employ dtaille",description:"Toutes les informations d'un employ",component:a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[a.jsxs("div",{className:"flex items-start gap-6 mb-6",children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-2xl flex items-center justify-center text-white text-2xl font-bold",children:"AB"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-xl font-bold",children:"Ahmed Ben Ali"}),a.jsx("p",{className:"text-gray-600",children:"Dveloppeur Senior  IT"}),a.jsxs("div",{className:"flex gap-2 mt-2",children:[a.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs",children:"CDI"}),a.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded-full text-xs",children:"Temps plein"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Date d'embauche"}),a.jsx("p",{className:"font-semibold",children:"15/03/2023"})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Salaire brut"}),a.jsx("p",{className:"font-semibold text-green-600",children:"3,500 TND"})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"N CNSS"}),a.jsx("p",{className:"font-semibold",children:"12345678"})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Congs restants"}),a.jsx("p",{className:"font-semibold",children:"18 jours"})]})]})]})},{title:"Documents employ",description:"Contrats, attestations et documents RH",component:a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[a.jsx("h4",{className:"font-bold mb-4",children:"Documents de Ahmed Ben Ali"}),a.jsx("div",{className:"space-y-3",children:[{name:"Contrat CDI",date:"15/03/2023",type:"PDF",icon:""},{name:"Attestation de travail",date:"01/02/2026",type:"PDF",icon:""},{name:"Fiche de paie - Janvier 2026",date:"31/01/2026",type:"PDF",icon:""},{name:"Certificat CNSS",date:"15/03/2023",type:"PDF",icon:""}].map((b,w)=>a.jsxs("div",{className:"flex items-center gap-4 p-3 border rounded-lg hover:bg-blue-50 cursor-pointer",children:[a.jsx("span",{className:"text-2xl",children:b.icon}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium",children:b.name}),a.jsx("p",{className:"text-sm text-gray-500",children:b.date})]}),a.jsx("button",{className:"px-3 py-1 bg-blue-100 text-blue-600 rounded-lg text-sm",children:"Tlcharger"})]},w))})]})}]},"fiches-paie":{title:"Fiches de Paie Auto",description:"Gnration automatique des fiches de paie",screens:[{title:"Gnration automatique",description:"Fiches de paie calcules automatiquement",component:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[a.jsx("div",{className:"bg-gradient-to-r from-green-600 to-emerald-600 p-4 text-white",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold",children:"Fiches de Paie - Fvrier 2026"}),a.jsx("p",{className:"text-sm text-white/80",children:"12 fiches  gnrer"})]}),a.jsx("button",{className:"px-4 py-2 bg-white text-green-600 rounded-lg font-medium text-sm",children:"Gnrer tout"})]})}),a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[a.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-blue-600",children:"12"}),a.jsx("p",{className:"text-xs text-gray-600",children:"Employs"})]}),a.jsxs("div",{className:"bg-green-50 p-3 rounded-lg text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-green-600",children:"36,500"}),a.jsx("p",{className:"text-xs text-gray-600",children:"Masse salariale"})]}),a.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-orange-600",children:"3,285"}),a.jsx("p",{className:"text-xs text-gray-600",children:"CNSS"})]}),a.jsxs("div",{className:"bg-red-50 p-3 rounded-lg text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-red-600",children:"4,380"}),a.jsx("p",{className:"text-xs text-gray-600",children:"IRPP"})]})]}),a.jsx("div",{className:"space-y-2",children:[{name:"Ahmed Ben Ali",brut:"3,500",net:"2,835",status:"ready"},{name:"Fatma Trabelsi",brut:"4,200",net:"3,360",status:"ready"},{name:"Mohamed Sassi",brut:"2,800",net:"2,310",status:"pending"}].map((b,w)=>a.jsxs("div",{className:"flex items-center gap-4 p-3 border rounded-lg",children:[a.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center text-green-600 font-bold text-sm",children:b.name.split(" ").map(N=>N[0]).join("")}),a.jsx("div",{className:"flex-1",children:a.jsx("p",{className:"font-medium",children:b.name})}),a.jsxs("div",{className:"text-right text-sm",children:[a.jsxs("p",{className:"text-gray-500",children:["Brut: ",b.brut," TND"]}),a.jsxs("p",{className:"font-semibold text-green-600",children:["Net: ",b.net," TND"]})]}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${b.status==="ready"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:b.status==="ready"?" Prte":" En cours"})]},w))})]})]})},{title:"Dtail fiche de paie",description:"Calcul dtaill avec retenues CNSS et IRPP",component:a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[a.jsxs("div",{className:"flex justify-between items-start mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold",children:"Fiche de Paie"}),a.jsx("p",{className:"text-gray-600",children:"Ahmed Ben Ali - Fvrier 2026"})]}),a.jsxs("button",{className:"px-4 py-2 bg-red-500 text-white rounded-lg text-sm flex items-center gap-2",children:[a.jsx(Ge,{className:"w-4 h-4"}),"PDF"]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("span",{className:"font-medium text-green-700",children:"Salaire Brut"}),a.jsx("span",{className:"font-bold text-green-600",children:"3,500.00 TND"})]}),a.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Salaire de base"}),a.jsx("span",{children:"3,200.00 TND"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Prime de rendement"}),a.jsx("span",{children:"300.00 TND"})]})]})]}),a.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("span",{className:"font-medium text-red-700",children:"Retenues"}),a.jsx("span",{className:"font-bold text-red-600",children:"-665.00 TND"})]}),a.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"CNSS (9.18%)"}),a.jsx("span",{children:"-321.30 TND"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"IRPP"}),a.jsx("span",{children:"-343.70 TND"})]})]})]}),a.jsx("div",{className:"bg-blue-100 p-4 rounded-lg border-2 border-blue-300",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"font-bold text-blue-800",children:"Salaire Net  Payer"}),a.jsx("span",{className:"font-bold text-2xl text-blue-600",children:"2,835.00 TND"})]})})]})]})},{title:"Export PDF professionnel",description:"Fiches de paie au format lgal tunisien",component:a.jsx("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:a.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(Ge,{className:"w-8 h-8 text-red-500"})}),a.jsx("h4",{className:"font-bold text-lg mb-2",children:"Aperu PDF"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Format conforme  la lgislation tunisienne"}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-left text-sm max-w-sm mx-auto",children:[a.jsx("p",{className:"font-bold border-b pb-2 mb-2",children:"BULLETIN DE PAIE"}),a.jsx("p",{children:"Entreprise: StartUpLab SARL"}),a.jsx("p",{children:"Employ: Ahmed Ben Ali"}),a.jsx("p",{children:"Priode: Fvrier 2026"}),a.jsx("p",{className:"mt-2 font-semibold",children:"Net  payer: 2,835.00 TND"})]})]})})}]},"declaration-cnss":{title:"Dclaration CNSS",description:"Dclarations CNSS automatises",screens:[{title:"Calcul des cotisations",description:"Cotisations CNSS calcules automatiquement",component:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[a.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-amber-500 p-4 text-white",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold",children:"Dclaration CNSS"}),a.jsx("p",{className:"text-sm text-white/80",children:"Trimestre 1 - 2026"})]}),a.jsx("span",{className:"px-3 py-1 bg-white/20 rounded-full text-sm",children:"chance: 15/04/2026"})]})}),a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[a.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Masse salariale"}),a.jsx("p",{className:"text-xl font-bold text-blue-600",children:"109,500 TND"})]}),a.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg text-center",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Part patronale (16.57%)"}),a.jsx("p",{className:"text-xl font-bold text-orange-600",children:"18,144 TND"})]}),a.jsxs("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Part salariale (9.18%)"}),a.jsx("p",{className:"text-xl font-bold text-green-600",children:"10,052 TND"})]})]}),a.jsx("div",{className:"bg-amber-50 border border-amber-200 p-4 rounded-lg",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-amber-800",children:"Total  dclarer"}),a.jsx("p",{className:"text-sm text-amber-600",children:"Part patronale + Part salariale"})]}),a.jsx("p",{className:"text-2xl font-bold text-amber-600",children:"28,196 TND"})]})})]})]})},{title:"Dclaration trimestrielle",description:"Formulaire DS conforme CNSS",component:a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[a.jsxs("h4",{className:"font-bold mb-4 flex items-center gap-2",children:[a.jsx("span",{className:"text-2xl",children:""}),"Dclaration de Salaires (DS)"]}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500",children:"N Employeur CNSS"}),a.jsx("p",{className:"font-semibold",children:"12345-67"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500",children:"Trimestre"}),a.jsx("p",{className:"font-semibold",children:"T1 2026"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500",children:"Nombre d'employs"}),a.jsx("p",{className:"font-semibold",children:"12"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500",children:"Jours dclars"}),a.jsx("p",{className:"font-semibold",children:"1,080"})]})]})}),a.jsx("div",{className:"space-y-2",children:["Janvier 2026","Fvrier 2026","Mars 2026"].map((b,w)=>a.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[a.jsx("span",{children:b}),a.jsx("span",{className:"font-semibold",children:"36,500 TND"}),a.jsx("span",{className:"text-green-600",children:""})]},w))})]})},{title:"Export formulaires",description:"Gnration des formulaires officiels",component:a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[a.jsx("h4",{className:"font-bold mb-4",children:"Formulaires  tlcharger"}),a.jsx("div",{className:"space-y-3",children:[{name:"Dclaration DS - T1 2026",desc:"Dclaration trimestrielle des salaires",icon:""},{name:"Bordereau de paiement",desc:" joindre avec le rglement",icon:""},{name:"Liste nominative",desc:"Dtail par employ",icon:""}].map((b,w)=>a.jsxs("div",{className:"flex items-center gap-4 p-4 border rounded-lg hover:bg-orange-50 cursor-pointer",children:[a.jsx("span",{className:"text-3xl",children:b.icon}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium",children:b.name}),a.jsx("p",{className:"text-sm text-gray-500",children:b.desc})]}),a.jsx("button",{className:"px-4 py-2 bg-orange-500 text-white rounded-lg text-sm",children:"Tlcharger"})]},w))})]})}]},"gestion-conges":{title:"Gestion Congs",description:"Suivi des congs et absences",screens:[{title:"Demandes en ligne",description:"Les employs font leurs demandes en ligne",component:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[a.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 p-4 text-white",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold",children:"Demandes de Congs"}),a.jsx("p",{className:"text-sm text-white/80",children:"3 demandes en attente"})]}),a.jsx("button",{className:"px-4 py-2 bg-white text-purple-600 rounded-lg font-medium text-sm",children:"+ Nouvelle demande"})]})}),a.jsx("div",{className:"p-4 space-y-3",children:[{emp:"Ahmed Ben Ali",type:"Cong annuel",dates:"15/03 - 22/03/2026",days:6,status:"pending"},{emp:"Fatma Trabelsi",type:"Cong maladie",dates:"10/03 - 12/03/2026",days:3,status:"pending"},{emp:"Mohamed Sassi",type:"Cong annuel",dates:"01/04 - 15/04/2026",days:11,status:"pending"}].map((b,w)=>a.jsxs("div",{className:"flex items-center gap-4 p-4 border rounded-lg",children:[a.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center text-purple-600 font-bold",children:b.emp.split(" ").map(N=>N[0]).join("")}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium",children:b.emp}),a.jsxs("p",{className:"text-sm text-gray-500",children:[b.type,"  ",b.dates]})]}),a.jsxs("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 rounded-full text-sm",children:[b.days," jours"]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{className:"p-2 bg-green-100 text-green-600 rounded-lg hover:bg-green-200",children:""}),a.jsx("button",{className:"p-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200",children:""})]})]},w))})]})},{title:"Solde temps rel",description:"Suivi des soldes de congs par employ",component:a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[a.jsx("h4",{className:"font-bold mb-4",children:"Soldes de congs"}),a.jsx("div",{className:"space-y-4",children:[{name:"Ahmed Ben Ali",used:6,remaining:18,total:24},{name:"Fatma Trabelsi",used:10,remaining:14,total:24},{name:"Mohamed Sassi",used:3,remaining:21,total:24},{name:"Sarra Karoui",used:15,remaining:9,total:24}].map((b,w)=>a.jsxs("div",{className:"p-4 border rounded-lg",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("span",{className:"font-medium",children:b.name}),a.jsxs("span",{className:"text-sm text-gray-500",children:[b.remaining,"/",b.total," jours restants"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:a.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-pink-500 h-3 rounded-full",style:{width:`${b.used/b.total*100}%`}})}),a.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[a.jsxs("span",{children:[b.used," jours pris"]}),a.jsxs("span",{children:[b.remaining," jours disponibles"]})]})]},w))})]})},{title:"Planning quipe",description:"Vue calendrier des absences",component:a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h4",{className:"font-bold",children:"Planning Mars 2026"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{className:"p-2 border rounded-lg",children:""}),a.jsx("button",{className:"p-2 border rounded-lg",children:""})]})]}),a.jsx("div",{className:"grid grid-cols-7 gap-1 text-center text-sm mb-2",children:["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"].map(b=>a.jsx("div",{className:"font-medium text-gray-500 py-2",children:b},b))}),a.jsx("div",{className:"grid grid-cols-7 gap-1",children:Array.from({length:31},(b,w)=>w+1).map(b=>a.jsx("div",{className:`p-2 text-center rounded-lg text-sm ${[15,16,17,18,19,20,21,22].includes(b)?"bg-purple-100 text-purple-700":[10,11,12].includes(b)?"bg-orange-100 text-orange-700":"hover:bg-gray-100"}`,children:b},b))}),a.jsxs("div",{className:"flex gap-4 mt-4 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-4 h-4 bg-purple-100 rounded"}),a.jsx("span",{children:"Ahmed (Cong annuel)"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-4 h-4 bg-orange-100 rounded"}),a.jsx("span",{children:"Fatma (Maladie)"})]})]})]})}]},"signature-contrat":{title:"Signature Contrat Digital",description:"Signature lectronique des contrats",screens:[{title:"Signature lgale",description:"Signature lectronique conforme  la loi tunisienne",component:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[a.jsx("div",{className:"bg-gradient-to-r from-indigo-600 to-violet-600 p-4 text-white",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold",children:"Signature lectronique"}),a.jsx("p",{className:"text-sm text-white/80",children:"Conforme  la loi n2000-83"})]}),a.jsx("span",{className:"px-3 py-1 bg-green-500 rounded-full text-sm flex items-center gap-1",children:" Certifi"})]})}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center mb-4",children:[a.jsx("div",{className:"w-16 h-16 bg-indigo-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(Ge,{className:"w-8 h-8 text-indigo-500"})}),a.jsx("h4",{className:"font-bold text-lg mb-2",children:"Contrat de Travail CDI"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Ahmed Ben Ali - Dveloppeur Senior"}),a.jsxs("div",{className:"flex justify-center gap-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-1",children:""}),a.jsx("p",{className:"text-xs text-gray-500",children:"Employeur"}),a.jsx("p",{className:"text-xs font-medium text-green-600",children:"Sign"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-1",children:""}),a.jsx("p",{className:"text-xs text-gray-500",children:"Employ"}),a.jsx("p",{className:"text-xs font-medium text-yellow-600",children:"En attente"})]})]})]}),a.jsx("button",{className:"w-full py-3 bg-indigo-600 text-white rounded-xl font-medium hover:bg-indigo-700",children:"Envoyer pour signature"})]})]})},{title:"Horodatage",description:"Preuve de date et heure certifie",component:a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[a.jsxs("h4",{className:"font-bold mb-4 flex items-center gap-2",children:[a.jsx(Et,{className:"w-5 h-5 text-indigo-600"}),"Horodatage Certifi"]}),a.jsx("div",{className:"bg-indigo-50 rounded-xl p-4 mb-4",children:a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Date de signature"}),a.jsx("p",{className:"font-semibold",children:"07/02/2026  14:32:15"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Fuseau horaire"}),a.jsx("p",{className:"font-semibold",children:"UTC+1 (Tunis)"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Hash SHA-256"}),a.jsx("p",{className:"font-mono text-xs",children:"a3f2b8c9..."})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Certificat"}),a.jsx("p",{className:"font-semibold text-green-600",children:" Valide"})]})]})}),a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-50 rounded-lg",children:[a.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center text-white",children:""}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-green-800",children:"Document authentique"}),a.jsx("p",{className:"text-sm text-green-600",children:"Intgrit vrifie et horodatage certifi"})]})]})]})},{title:"Archivage scuris",description:"Conservation lgale des contrats signs",component:a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[a.jsx("h4",{className:"font-bold mb-4",children:" Archives des Contrats"}),a.jsx("div",{className:"space-y-3",children:[{name:"CDI - Ahmed Ben Ali",date:"15/03/2023",status:"signed",parties:2},{name:"CDI - Fatma Trabelsi",date:"01/06/2023",status:"signed",parties:2},{name:"CDD - Mohamed Sassi",date:"01/01/2026",status:"signed",parties:2},{name:"Avenant - Ahmed Ben Ali",date:"01/02/2026",status:"pending",parties:1}].map((b,w)=>a.jsxs("div",{className:"flex items-center gap-4 p-4 border rounded-lg hover:bg-gray-50",children:[a.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${b.status==="signed"?"bg-green-100 text-green-600":"bg-yellow-100 text-yellow-600"}`,children:b.status==="signed"?"":""}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium",children:b.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:[b.date,"  ",b.parties,"/2 signatures"]})]}),a.jsx("button",{className:"px-3 py-1 border rounded-lg text-sm hover:bg-gray-100",children:"Voir"})]},w))})]})}]}}[r.slug]||{title:r.name,description:r.description,screens:[{title:"Aperu",description:"Dcouvrez les fonctionnalits de ce module",component:a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg text-center",children:[a.jsx(Bn,{className:"w-16 h-16 text-primary-500 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Dmonstration bientt disponible"})]})}]}:null;if(i)return a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});const y=v(),m=Array.isArray(r==null?void 0:r.features)?r.features:[];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(ve,{to:"/entreprise/produits-solutions",className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(yn,{className:"w-5 h-5"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:y.title}),a.jsx("p",{className:"text-gray-600",children:y.description})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"text-3xl font-bold text-primary-600",children:[r==null?void 0:r.price," TND",a.jsx("span",{className:"text-sm text-gray-500",children:"/mois"})]}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Plan requis: ",r==null?void 0:r.requiredPlan]})]})]}),a.jsx("div",{className:"bg-gradient-to-r from-primary-600 to-indigo-600 rounded-2xl p-6 text-white",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-xl flex items-center justify-center",children:a.jsx(Qw,{className:"w-8 h-8"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h2",{className:"text-xl font-bold",children:"Dmonstration interactive"}),a.jsx("p",{className:"text-white/80",children:"Dcouvrez les fonctionnalits avant d'activer"})]}),(u==null?void 0:u.status)==="active"?a.jsxs(ve,{to:h[e]||"/mes-offres",className:"px-6 py-3 bg-green-500 text-white rounded-xl font-semibold hover:bg-green-600 transition-colors flex items-center gap-2",children:[a.jsx(Ct,{className:"w-5 h-5"}),"Accder  la fonctionnalit"]}):(u==null?void 0:u.status)==="pending"?a.jsxs("div",{className:"px-6 py-3 bg-yellow-500 text-white rounded-xl font-semibold flex items-center gap-2",children:[a.jsx(Et,{className:"w-5 h-5"}),"En attente d'approbation"]}):(n==null?void 0:n.subscription)==="enterprise"?a.jsx("button",{onClick:x,disabled:l,className:"px-6 py-3 bg-white text-primary-600 rounded-xl font-semibold hover:bg-gray-100 transition-colors",children:l?"Envoi...":"Activer maintenant"}):a.jsxs(ve,{to:"/pricing",className:"px-6 py-3 bg-white/20 text-white rounded-xl font-semibold hover:bg-white/30 transition-colors flex items-center gap-2",children:[a.jsx(ss,{className:"w-5 h-5"}),"Passer  Enterprise"]})]})}),a.jsxs("div",{className:"card",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Fonctionnalits incluses"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:m.map((g,b)=>a.jsxs("div",{className:"flex items-center gap-2 p-3 bg-green-50 rounded-lg",children:[a.jsx(Ct,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),a.jsx("span",{className:"text-sm text-gray-700",children:g})]},b))})]}),a.jsx("div",{className:"space-y-6",children:y.screens.map((g,b)=>a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center text-primary-600 font-bold",children:b+1}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:g.title}),a.jsx("p",{className:"text-sm text-gray-500",children:g.description})]})]}),a.jsx("div",{className:"bg-gray-50 rounded-xl p-6",children:g.component})]},b))}),a.jsx("div",{className:"card bg-gradient-to-br from-gray-50 to-gray-100 border-2 border-dashed border-gray-300",children:a.jsxs("div",{className:"text-center py-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Prt  commencer ?"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Activez ce module et commencez  grer votre comptabilit"}),(u==null?void 0:u.status)==="active"?a.jsxs(ve,{to:h[e]||"/mes-offres",className:"btn-primary px-8 py-3 inline-flex items-center gap-2 bg-green-600 hover:bg-green-700",children:[a.jsx(Ct,{className:"w-5 h-5"}),"Accder  la fonctionnalit"]}):(u==null?void 0:u.status)==="pending"?a.jsxs("div",{className:"btn-primary px-8 py-3 inline-flex items-center gap-2 bg-yellow-500",children:[a.jsx(Et,{className:"w-5 h-5"}),"En attente d'approbation"]}):(n==null?void 0:n.subscription)==="enterprise"?a.jsx("button",{onClick:x,disabled:l,className:"btn-primary px-8 py-3",children:l?"Envoi en cours...":`Activer pour ${r==null?void 0:r.price} TND/mois`}):a.jsxs(ve,{to:"/pricing",className:"btn-primary px-8 py-3 inline-flex items-center gap-2",children:[a.jsx(Or,{className:"w-5 h-5"}),"Passer  Enterprise pour accder"]})]})})]})},pL=()=>{var H,J,te,ce,se,le,he,ye,Ce,xe,$e,_e,Re;const[e,t]=S.useState([]),[n,r]=S.useState(!0),[s,i]=S.useState(""),[o,l]=S.useState("all"),[c,u]=S.useState(!1),[d,h]=S.useState(!1),[p,f]=S.useState(null),[x,v]=S.useState(null),[y,m]=S.useState("info"),[g,b]=S.useState(!1),[w,N]=S.useState({documentType:"",file:null}),[C,D]=S.useState({firstName:"",lastName:"",email:"",phone:"",cin:"",cnssNumber:"",address:"",birthDate:"",hireDate:"",position:"",department:"",contractType:"CDI",workSchedule:"full_time",baseSalary:"",transportAllowance:"",mealAllowance:"",otherAllowances:"",bankName:"",bankAccount:"",notes:"",annualLeave:24,usedAnnualLeave:0,sickLeave:15,usedSickLeave:0});S.useEffect(()=>{j()},[]);const j=async()=>{try{const A=await K.get("/hr/employees");t(A.data.employees||[])}catch{$.error("Erreur lors du chargement des employs")}finally{r(!1)}},k=async A=>{var Z,de;A.preventDefault();try{p?(await K.put(`/hr/employees/${p.id}`,C),await K.put(`/hr/employees/${p.id}/leave-balance`,{annualLeave:C.annualLeave,usedAnnualLeave:C.usedAnnualLeave,sickLeave:C.sickLeave,usedSickLeave:C.usedSickLeave}),$.success("Employ mis  jour")):(await K.post("/hr/employees",C),$.success("Employ cr avec succs")),u(!1),F(),j()}catch(be){$.error(((de=(Z=be.response)==null?void 0:Z.data)==null?void 0:de.message)||"Erreur")}},R=async A=>{if(confirm("Voulez-vous vraiment supprimer cet employ ?"))try{await K.delete(`/hr/employees/${A}`),$.success("Employ supprim"),j()}catch{$.error("Erreur lors de la suppression")}},E=async A=>{try{const Z=await K.get(`/hr/employees/${A.id}`),de=await K.get(`/hr/employees/${A.id}/history`);v({...Z.data,history:de.data.history}),h(!0)}catch{$.error("Erreur lors du chargement")}},P=async A=>{f(A),D({firstName:A.firstName||"",lastName:A.lastName||"",email:A.email||"",phone:A.phone||"",cin:A.cin||"",cnssNumber:A.cnssNumber||"",address:A.address||"",birthDate:A.birthDate||"",hireDate:A.hireDate||"",position:A.position||"",department:A.department||"",contractType:A.contractType||"CDI",workSchedule:A.workSchedule||"full_time",baseSalary:A.baseSalary||"",transportAllowance:A.transportAllowance||"",mealAllowance:A.mealAllowance||"",otherAllowances:A.otherAllowances||"",bankName:A.bankName||"",bankAccount:A.bankAccount||"",notes:A.notes||"",annualLeave:24,usedAnnualLeave:0,sickLeave:15,usedSickLeave:0});try{const Z=await K.get(`/hr/employees/${A.id}`);v(Z.data),Z.data.leaveBalance&&D(de=>({...de,annualLeave:Z.data.leaveBalance.annualLeave||24,usedAnnualLeave:Z.data.leaveBalance.usedAnnualLeave||0,sickLeave:Z.data.leaveBalance.sickLeave||15,usedSickLeave:Z.data.leaveBalance.usedSickLeave||0}))}catch(Z){console.error("Error fetching employee data:",Z)}m("info"),u(!0)},F=()=>{f(null),D({firstName:"",lastName:"",email:"",phone:"",cin:"",cnssNumber:"",address:"",birthDate:"",hireDate:"",position:"",department:"",contractType:"CDI",workSchedule:"full_time",baseSalary:"",transportAllowance:"",mealAllowance:"",otherAllowances:"",bankName:"",bankAccount:"",notes:"",annualLeave:24,usedAnnualLeave:0,sickLeave:15,usedSickLeave:0}),m("info")},W=async()=>{if(!w.file||!w.documentType||!p){$.error("Veuillez slectionner un fichier et un type de document");return}b(!0);try{const A=new FormData;A.append("file",w.file),A.append("documentType",w.documentType),A.append("employeeId",p.id),await K.post("/hr/documents/upload",A,{headers:{"Content-Type":"multipart/form-data"}}),$.success("Document ajout avec succs"),N({documentType:"",file:null});const Z=await K.get(`/hr/employees/${p.id}`);v(Z.data)}catch{$.error("Erreur lors de l'upload du document")}finally{b(!1)}},L=async A=>{try{const Z=await K.get(`/hr/documents/${A.id}/download`,{responseType:"blob"}),de=window.URL.createObjectURL(new Blob([Z.data])),be=document.createElement("a");be.href=de,be.setAttribute("download",A.documentName),document.body.appendChild(be),be.click(),be.remove()}catch{$.error("Erreur lors du tlchargement")}},U=async A=>{if(confirm("Supprimer ce document ?"))try{if(await K.delete(`/hr/documents/${A}`),$.success("Document supprim"),p){const Z=await K.get(`/hr/employees/${p.id}`);v(Z.data)}}catch{$.error("Erreur lors de la suppression")}},_=A=>{var Ae,Ye,nt,ne;const Z=A.employee,de=A.leaveBalance,be=A.history,ze=`
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Fiche Employ - ${Z.firstName} ${Z.lastName}</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; padding: 40px; color: #333; }
    .header { background: linear-gradient(135deg, #3b82f6, #6366f1); color: white; padding: 30px; border-radius: 10px; margin-bottom: 30px; }
    .header h1 { font-size: 28px; margin-bottom: 5px; }
    .header p { opacity: 0.9; }
    .section { margin-bottom: 25px; }
    .section-title { font-size: 16px; font-weight: bold; color: #1e40af; margin-bottom: 15px; padding-bottom: 5px; border-bottom: 2px solid #3b82f6; }
    .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }
    .grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
    .field { background: #f8fafc; padding: 12px; border-radius: 8px; }
    .field-label { font-size: 11px; color: #64748b; text-transform: uppercase; margin-bottom: 4px; }
    .field-value { font-size: 14px; font-weight: 500; }
    .salary { background: #dcfce7; }
    .salary .field-value { color: #15803d; font-size: 18px; }
    .leave-box { background: #f3e8ff; padding: 15px; border-radius: 8px; text-align: center; }
    .leave-title { font-size: 12px; color: #7c3aed; margin-bottom: 5px; }
    .leave-value { font-size: 20px; font-weight: bold; color: #5b21b6; }
    .history-item { background: #f8fafc; padding: 12px; border-radius: 8px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }
    .badge { padding: 4px 10px; border-radius: 20px; font-size: 11px; font-weight: 500; }
    .badge-green { background: #dcfce7; color: #15803d; }
    .badge-yellow { background: #fef3c7; color: #b45309; }
    .footer { margin-top: 40px; text-align: center; font-size: 12px; color: #94a3b8; }
    @media print { body { padding: 20px; } }
  </style>
</head>
<body>
  <div class="header">
    <h1>${Z.firstName} ${Z.lastName}</h1>
    <p>${Z.position} ${Z.department?" "+Z.department:""}</p>
    <p style="margin-top: 10px;">${Z.contractType}  ${Z.workSchedule==="full_time"?"Temps plein":"Temps partiel"}</p>
  </div>

  <div class="section">
    <div class="section-title">Informations personnelles</div>
    <div class="grid">
      <div class="field"><div class="field-label">Email</div><div class="field-value">${Z.email||"-"}</div></div>
      <div class="field"><div class="field-label">Tlphone</div><div class="field-value">${Z.phone||"-"}</div></div>
      <div class="field"><div class="field-label">CIN</div><div class="field-value">${Z.cin||"-"}</div></div>
      <div class="field"><div class="field-label">Date de naissance</div><div class="field-value">${Z.birthDate?new Date(Z.birthDate).toLocaleDateString("fr-FR"):"-"}</div></div>
      <div class="field" style="grid-column: span 2;"><div class="field-label">Adresse</div><div class="field-value">${Z.address||"-"}</div></div>
    </div>
  </div>

  <div class="section">
    <div class="section-title">Informations professionnelles</div>
    <div class="grid">
      <div class="field"><div class="field-label">Poste</div><div class="field-value">${Z.position}</div></div>
      <div class="field"><div class="field-label">Dpartement</div><div class="field-value">${Z.department||"-"}</div></div>
      <div class="field"><div class="field-label">N CNSS</div><div class="field-value">${Z.cnssNumber||"-"}</div></div>
      <div class="field"><div class="field-label">Date d'embauche</div><div class="field-value">${Z.hireDate?new Date(Z.hireDate).toLocaleDateString("fr-FR"):"-"}</div></div>
      <div class="field"><div class="field-label">Type de contrat</div><div class="field-value">${Z.contractType}</div></div>
      <div class="field"><div class="field-label">Temps de travail</div><div class="field-value">${Z.workSchedule==="full_time"?"Temps plein":"Temps partiel"}</div></div>
    </div>
  </div>

  <div class="section">
    <div class="section-title">Rmunration</div>
    <div class="grid" style="grid-template-columns: repeat(4, 1fr);">
      <div class="field salary"><div class="field-label">Salaire de base</div><div class="field-value">${Number(Z.baseSalary||0).toLocaleString()} TND</div></div>
      <div class="field"><div class="field-label">Prime transport</div><div class="field-value">${Number(Z.transportAllowance||0).toLocaleString()} TND</div></div>
      <div class="field"><div class="field-label">Prime repas</div><div class="field-value">${Number(Z.mealAllowance||0).toLocaleString()} TND</div></div>
      <div class="field"><div class="field-label">Autres primes</div><div class="field-value">${Number(Z.otherAllowances||0).toLocaleString()} TND</div></div>
    </div>
  </div>

  <div class="section">
    <div class="section-title">Informations bancaires</div>
    <div class="grid-2">
      <div class="field"><div class="field-label">Banque</div><div class="field-value">${Z.bankName||"-"}</div></div>
      <div class="field"><div class="field-label">RIB</div><div class="field-value">${Z.bankAccount||"-"}</div></div>
    </div>
  </div>

  <div class="section">
    <div class="section-title">Solde de congs</div>
    <div class="grid-2">
      <div class="leave-box">
        <div class="leave-title">Congs annuels</div>
        <div class="leave-value">${de?de.annualLeave-de.usedAnnualLeave:24} / ${de?de.annualLeave:24} jours</div>
      </div>
      <div class="leave-box" style="background: #fee2e2;">
        <div class="leave-title" style="color: #dc2626;">Congs maladie</div>
        <div class="leave-value" style="color: #b91c1c;">${de?de.sickLeave-de.usedSickLeave:15} / ${de?de.sickLeave:15} jours</div>
      </div>
    </div>
  </div>

  ${be&&(((Ae=be.payslips)==null?void 0:Ae.length)>0||((Ye=be.leaves)==null?void 0:Ye.length)>0)?`
  <div class="section">
    <div class="section-title">Historique</div>
    ${((nt=be.payslips)==null?void 0:nt.slice(0,5).map(ie=>`
      <div class="history-item">
        <div>
          <strong>Fiche de paie - ${ie.period}</strong>
          <div style="font-size: 12px; color: #64748b;">Net: ${Number(ie.netSalary).toLocaleString()} TND</div>
        </div>
        <span class="badge ${ie.status==="paid"?"badge-green":"badge-yellow"}">${ie.status==="paid"?"Paye":"En attente"}</span>
      </div>
    `).join(""))||""}
    ${((ne=be.leaves)==null?void 0:ne.slice(0,5).map(ie=>`
      <div class="history-item">
        <div>
          <strong>Cong ${ie.leaveType==="annual"?"annuel":"maladie"}</strong>
          <div style="font-size: 12px; color: #64748b;">${ie.totalDays} jours - ${new Date(ie.startDate).toLocaleDateString("fr-FR")}</div>
        </div>
        <span class="badge ${ie.status==="approved"?"badge-green":"badge-yellow"}">${ie.status==="approved"?"Approuv":ie.status==="rejected"?"Refus":"En attente"}</span>
      </div>
    `).join(""))||""}
  </div>
  `:""}

  <div class="footer">
    <p>Document gnr le ${new Date().toLocaleDateString("fr-FR")}  ${new Date().toLocaleTimeString("fr-FR")}</p>
    <p>StartUpLab - Gestion des Ressources Humaines</p>
  </div>
</body>
</html>
    `,Me=window.open("","_blank");Me.document.write(ze),Me.document.close(),Me.focus(),setTimeout(()=>{Me.print()},500),$.success("Prparation du PDF...")},B=e.filter(A=>{const Z=`${A.firstName} ${A.lastName} ${A.position}`.toLowerCase().includes(s.toLowerCase()),de=o==="all"||A.status===o;return Z&&de}),O={total:e.length,active:e.filter(A=>A.status==="active").length,onLeave:e.filter(A=>A.status==="on_leave").length,inactive:e.filter(A=>A.status==="inactive").length};return n?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestion des Employs"}),a.jsx("p",{className:"text-gray-600",children:"Grez vos employs et leurs informations"})]}),a.jsxs("button",{onClick:()=>{F(),u(!0)},className:"btn-primary flex items-center gap-2",children:[a.jsx(_m,{className:"w-5 h-5"}),"Nouvel Employ"]})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsx("div",{className:"card bg-gradient-to-br from-blue-50 to-blue-100",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-xl flex items-center justify-center",children:a.jsx(st,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-blue-700",children:O.total}),a.jsx("p",{className:"text-sm text-blue-600",children:"Total"})]})]})}),a.jsx("div",{className:"card bg-gradient-to-br from-green-50 to-green-100",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-xl flex items-center justify-center",children:a.jsx(st,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-green-700",children:O.active}),a.jsx("p",{className:"text-sm text-green-600",children:"Actifs"})]})]})}),a.jsx("div",{className:"card bg-gradient-to-br from-orange-50 to-orange-100",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-orange-500 rounded-xl flex items-center justify-center",children:a.jsx(Hr,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-orange-700",children:O.onLeave}),a.jsx("p",{className:"text-sm text-orange-600",children:"En cong"})]})]})}),a.jsx("div",{className:"card bg-gradient-to-br from-gray-50 to-gray-100",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-gray-500 rounded-xl flex items-center justify-center",children:a.jsx(st,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-gray-700",children:O.inactive}),a.jsx("p",{className:"text-sm text-gray-600",children:"Inactifs"})]})]})})]}),a.jsx("div",{className:"card",children:a.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(Vs,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Rechercher un employ...",value:s,onChange:A=>i(A.target.value),className:"input pl-10 w-full"})]}),a.jsxs("select",{value:o,onChange:A=>l(A.target.value),className:"input w-full md:w-48",children:[a.jsx("option",{value:"all",children:"Tous les statuts"}),a.jsx("option",{value:"active",children:"Actifs"}),a.jsx("option",{value:"on_leave",children:"En cong"}),a.jsx("option",{value:"inactive",children:"Inactifs"})]})]})}),a.jsx("div",{className:"card",children:B.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(st,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500",children:"Aucun employ trouv"}),a.jsx("button",{onClick:()=>{F(),u(!0)},className:"mt-4 text-primary-600 hover:text-primary-700 font-medium",children:"Ajouter votre premier employ"})]}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-gray-200",children:[a.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Employ"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Poste"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Dpartement"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Salaire"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Statut"}),a.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-600",children:"Actions"})]})}),a.jsx("tbody",{children:B.map(A=>{var Z,de;return a.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center text-white font-bold",children:[(Z=A.firstName)==null?void 0:Z[0],(de=A.lastName)==null?void 0:de[0]]}),a.jsxs("div",{children:[a.jsxs("p",{className:"font-medium text-gray-900",children:[A.firstName," ",A.lastName]}),a.jsx("p",{className:"text-sm text-gray-500",children:A.email})]})]})}),a.jsx("td",{className:"py-4 px-4 text-gray-700",children:A.position}),a.jsx("td",{className:"py-4 px-4 text-gray-700",children:A.department||"-"}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("span",{className:"font-semibold text-green-600",children:[Number(A.baseSalary).toLocaleString()," TND"]})}),a.jsx("td",{className:"py-4 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${A.status==="active"?"bg-green-100 text-green-700":A.status==="on_leave"?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-700"}`,children:A.status==="active"?"Actif":A.status==="on_leave"?"En cong":"Inactif"})}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{className:"flex items-center justify-end gap-1",children:[a.jsx("button",{onClick:()=>E(A),className:"p-2 hover:bg-blue-100 rounded-lg text-blue-600",title:"Voir fiche complte",children:a.jsx(Nr,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>E(A),className:"p-2 hover:bg-purple-100 rounded-lg text-purple-600",title:"Historique",children:a.jsx(Lc,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>P(A),className:"p-2 hover:bg-amber-100 rounded-lg text-amber-600",title:"Modifier",children:a.jsx(Yw,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>R(A.id),className:"p-2 hover:bg-red-100 rounded-lg text-red-600",title:"Supprimer",children:a.jsx(or,{className:"w-4 h-4"})})]})})]},A.id)})})]})})}),c&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-semibold",children:p?"Modifier l'employ":"Nouvel employ"}),a.jsx("button",{onClick:()=>u(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(kt,{className:"w-5 h-5"})})]}),a.jsxs("form",{onSubmit:k,className:"p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Informations personnelles"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prnom *"}),a.jsx("input",{type:"text",value:C.firstName,onChange:A=>D({...C,firstName:A.target.value}),className:"input w-full",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom *"}),a.jsx("input",{type:"text",value:C.lastName,onChange:A=>D({...C,lastName:A.target.value}),className:"input w-full",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("input",{type:"email",value:C.email,onChange:A=>D({...C,email:A.target.value}),className:"input w-full"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tlphone"}),a.jsx("input",{type:"tel",value:C.phone,onChange:A=>D({...C,phone:A.target.value}),className:"input w-full"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CIN"}),a.jsx("input",{type:"text",value:C.cin,onChange:A=>D({...C,cin:A.target.value}),className:"input w-full"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"N CNSS"}),a.jsx("input",{type:"text",value:C.cnssNumber,onChange:A=>D({...C,cnssNumber:A.target.value}),className:"input w-full"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de naissance"}),a.jsx("input",{type:"date",value:C.birthDate,onChange:A=>D({...C,birthDate:A.target.value}),className:"input w-full"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adresse"}),a.jsx("input",{type:"text",value:C.address,onChange:A=>D({...C,address:A.target.value}),className:"input w-full"})]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Informations professionnelles"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Poste *"}),a.jsx("input",{type:"text",value:C.position,onChange:A=>D({...C,position:A.target.value}),className:"input w-full",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dpartement"}),a.jsx("input",{type:"text",value:C.department,onChange:A=>D({...C,department:A.target.value}),className:"input w-full"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date d'embauche *"}),a.jsx("input",{type:"date",value:C.hireDate,onChange:A=>D({...C,hireDate:A.target.value}),className:"input w-full",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type de contrat"}),a.jsxs("select",{value:C.contractType,onChange:A=>D({...C,contractType:A.target.value}),className:"input w-full",children:[a.jsx("option",{value:"CDI",children:"CDI"}),a.jsx("option",{value:"CDD",children:"CDD"}),a.jsx("option",{value:"SIVP",children:"SIVP"}),a.jsx("option",{value:"Stage",children:"Stage"}),a.jsx("option",{value:"Freelance",children:"Freelance"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Temps de travail"}),a.jsxs("select",{value:C.workSchedule,onChange:A=>D({...C,workSchedule:A.target.value}),className:"input w-full",children:[a.jsx("option",{value:"full_time",children:"Temps plein"}),a.jsx("option",{value:"part_time",children:"Temps partiel"})]})]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Rmunration"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Salaire de base (TND) *"}),a.jsx("input",{type:"number",value:C.baseSalary,onChange:A=>D({...C,baseSalary:A.target.value}),className:"input w-full",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prime transport (TND)"}),a.jsx("input",{type:"number",value:C.transportAllowance,onChange:A=>D({...C,transportAllowance:A.target.value}),className:"input w-full"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prime repas (TND)"}),a.jsx("input",{type:"number",value:C.mealAllowance,onChange:A=>D({...C,mealAllowance:A.target.value}),className:"input w-full"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Autres primes (TND)"}),a.jsx("input",{type:"number",value:C.otherAllowances,onChange:A=>D({...C,otherAllowances:A.target.value}),className:"input w-full"})]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Informations bancaires"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Banque"}),a.jsx("input",{type:"text",value:C.bankName,onChange:A=>D({...C,bankName:A.target.value}),className:"input w-full"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"RIB"}),a.jsx("input",{type:"text",value:C.bankAccount,onChange:A=>D({...C,bankAccount:A.target.value}),className:"input w-full"})]})]})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium text-gray-900 mb-4 flex items-center gap-2",children:[a.jsx(Cs,{className:"w-5 h-5 text-purple-600"}),"Solde de congs"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(Cs,{className:"w-5 h-5 text-blue-600"}),a.jsx("span",{className:"font-medium text-blue-800",children:"Congs annuels"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-blue-600 mb-1",children:"Total jours"}),a.jsx("input",{type:"number",value:C.annualLeave,onChange:A=>D({...C,annualLeave:Number(A.target.value)}),className:"input w-full text-center",min:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-blue-600 mb-1",children:"Jours utiliss"}),a.jsx("input",{type:"number",value:C.usedAnnualLeave,onChange:A=>D({...C,usedAnnualLeave:Number(A.target.value)}),className:"input w-full text-center",min:"0"})]})]}),a.jsx("div",{className:"mt-2 text-center",children:a.jsxs("span",{className:"text-sm text-blue-700 font-semibold",children:["Restant: ",C.annualLeave-C.usedAnnualLeave," jours"]})})]}),a.jsxs("div",{className:"bg-red-50 p-4 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(Xi,{className:"w-5 h-5 text-red-600"}),a.jsx("span",{className:"font-medium text-red-800",children:"Congs maladie"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-red-600 mb-1",children:"Total jours"}),a.jsx("input",{type:"number",value:C.sickLeave,onChange:A=>D({...C,sickLeave:Number(A.target.value)}),className:"input w-full text-center",min:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-red-600 mb-1",children:"Jours utiliss"}),a.jsx("input",{type:"number",value:C.usedSickLeave,onChange:A=>D({...C,usedSickLeave:Number(A.target.value)}),className:"input w-full text-center",min:"0"})]})]}),a.jsx("div",{className:"mt-2 text-center",children:a.jsxs("span",{className:"text-sm text-red-700 font-semibold",children:["Restant: ",C.sickLeave-C.usedSickLeave," jours"]})})]})]})]}),p&&a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium text-gray-900 mb-4 flex items-center gap-2",children:[a.jsx(xr,{className:"w-5 h-5 text-indigo-600"}),"Documents employ",a.jsx("span",{className:"text-xs text-gray-500 font-normal",children:"Contrats, attestations et documents RH"})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl mb-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"Ajouter un document"}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[a.jsxs("select",{value:w.documentType,onChange:A=>N({...w,documentType:A.target.value}),className:"input flex-1",children:[a.jsx("option",{value:"",children:"Type de document"}),a.jsx("option",{value:"Contrat CDI",children:"Contrat CDI"}),a.jsx("option",{value:"Contrat CDD",children:"Contrat CDD"}),a.jsx("option",{value:"Avenant",children:"Avenant au contrat"}),a.jsx("option",{value:"Attestation de travail",children:"Attestation de travail"}),a.jsx("option",{value:"Certificat CNSS",children:"Certificat CNSS"}),a.jsx("option",{value:"Fiche de paie",children:"Fiche de paie"}),a.jsx("option",{value:"CIN",children:"Copie CIN"}),a.jsx("option",{value:"Diplme",children:"Diplme"}),a.jsx("option",{value:"CV",children:"CV"}),a.jsx("option",{value:"Autre",children:"Autre document"})]}),a.jsx("input",{type:"file",onChange:A=>N({...w,file:A.target.files[0]}),className:"input flex-1",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png"}),a.jsxs("button",{type:"button",onClick:W,disabled:g||!w.file||!w.documentType,className:"btn-primary flex items-center gap-2 whitespace-nowrap",children:[g?a.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):a.jsx(qp,{className:"w-5 h-5"}),"Ajouter"]})]})]}),x!=null&&x.documents&&x.documents.length>0?a.jsx("div",{className:"space-y-2",children:x.documents.map(A=>{var Z,de,be,ze,Me,Ae;return a.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg hover:bg-gray-50",children:[a.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${(Z=A.documentType)!=null&&Z.includes("Contrat")?"bg-blue-100":(de=A.documentType)!=null&&de.includes("Fiche")?"bg-green-100":(be=A.documentType)!=null&&be.includes("CNSS")?"bg-orange-100":"bg-gray-100"}`,children:a.jsx(Ge,{className:`w-5 h-5 ${(ze=A.documentType)!=null&&ze.includes("Contrat")?"text-blue-600":(Me=A.documentType)!=null&&Me.includes("Fiche")?"text-green-600":(Ae=A.documentType)!=null&&Ae.includes("CNSS")?"text-orange-600":"text-gray-600"}`})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium text-gray-900",children:A.documentName}),a.jsxs("p",{className:"text-xs text-gray-500",children:[A.documentType,"  ",A.uploadedAt?new Date(A.uploadedAt).toLocaleDateString("fr-FR"):""]})]}),a.jsx("button",{type:"button",onClick:()=>L(A),className:"p-2 hover:bg-blue-100 rounded-lg text-blue-600",title:"Tlcharger",children:a.jsx(vn,{className:"w-5 h-5"})}),a.jsx("button",{type:"button",onClick:()=>U(A.id),className:"p-2 hover:bg-red-100 rounded-lg text-red-600",title:"Supprimer",children:a.jsx(or,{className:"w-4 h-4"})})]},A.id)})}):a.jsxs("div",{className:"text-center py-6 text-gray-500",children:[a.jsx(xr,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),a.jsx("p",{children:"Aucun document"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("textarea",{value:C.notes,onChange:A=>D({...C,notes:A.target.value}),className:"input w-full",rows:3})]}),a.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:()=>u(!1),className:"btn-secondary flex-1",children:"Annuler"}),a.jsxs("button",{type:"submit",className:"btn-primary flex-1 flex items-center justify-center gap-2",children:[a.jsx(Xs,{className:"w-5 h-5"}),p?"Mettre  jour":"Crer l'employ"]})]})]})]})}),d&&x&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 flex items-center justify-between z-10",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Fiche Employ Complte"}),a.jsx("button",{onClick:()=>h(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(kt,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"flex items-start gap-6 bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-2xl",children:[a.jsxs("div",{className:"w-24 h-24 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-2xl flex items-center justify-center text-white text-3xl font-bold shadow-lg",children:[(H=x.employee.firstName)==null?void 0:H[0],(J=x.employee.lastName)==null?void 0:J[0]]}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("h3",{className:"text-2xl font-bold text-gray-900",children:[x.employee.firstName," ",x.employee.lastName]}),a.jsx("p",{className:"text-lg text-gray-600",children:x.employee.position}),a.jsx("p",{className:"text-gray-500",children:x.employee.department||"Dpartement non spcifi"}),a.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[a.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-medium",children:x.employee.contractType}),a.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-medium",children:x.employee.workSchedule==="full_time"?"Temps plein":"Temps partiel"}),a.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${x.employee.status==="active"?"bg-emerald-100 text-emerald-700":x.employee.status==="on_leave"?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-700"}`,children:x.employee.status==="active"?" Actif":x.employee.status==="on_leave"?" En cong":" Inactif"})]})]})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[a.jsx(st,{className:"w-5 h-5 text-blue-600"}),"Informations personnelles"]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Email"}),a.jsx("p",{className:"font-medium text-gray-900",children:x.employee.email||"-"})]}),a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Tlphone"}),a.jsx("p",{className:"font-medium text-gray-900",children:x.employee.phone||"-"})]}),a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"CIN"}),a.jsx("p",{className:"font-medium text-gray-900",children:x.employee.cin||"-"})]}),a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Date de naissance"}),a.jsx("p",{className:"font-medium text-gray-900",children:x.employee.birthDate?new Date(x.employee.birthDate).toLocaleDateString("fr-FR"):"-"})]}),a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg md:col-span-2",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Adresse"}),a.jsx("p",{className:"font-medium text-gray-900",children:x.employee.address||"-"})]})]})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[a.jsx(Ws,{className:"w-5 h-5 text-indigo-600"}),"Informations professionnelles"]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Poste"}),a.jsx("p",{className:"font-medium text-gray-900",children:x.employee.position})]}),a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Dpartement"}),a.jsx("p",{className:"font-medium text-gray-900",children:x.employee.department||"-"})]}),a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"N CNSS"}),a.jsx("p",{className:"font-medium text-gray-900",children:x.employee.cnssNumber||"-"})]}),a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Date d'embauche"}),a.jsx("p",{className:"font-medium text-gray-900",children:x.employee.hireDate?new Date(x.employee.hireDate).toLocaleDateString("fr-FR"):"-"})]}),a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Type de contrat"}),a.jsx("p",{className:"font-medium text-gray-900",children:x.employee.contractType})]}),a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Temps de travail"}),a.jsx("p",{className:"font-medium text-gray-900",children:x.employee.workSchedule==="full_time"?"Temps plein":"Temps partiel"})]})]})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[a.jsx(va,{className:"w-5 h-5 text-green-600"}),"Rmunration"]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[a.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[a.jsx("p",{className:"text-xs text-green-600 uppercase tracking-wide",children:"Salaire de base"}),a.jsxs("p",{className:"font-bold text-green-700 text-lg",children:[Number(x.employee.baseSalary||0).toLocaleString()," TND"]})]}),a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Prime transport"}),a.jsxs("p",{className:"font-medium text-gray-900",children:[Number(x.employee.transportAllowance||0).toLocaleString()," TND"]})]}),a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Prime repas"}),a.jsxs("p",{className:"font-medium text-gray-900",children:[Number(x.employee.mealAllowance||0).toLocaleString()," TND"]})]}),a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Autres primes"}),a.jsxs("p",{className:"font-medium text-gray-900",children:[Number(x.employee.otherAllowances||0).toLocaleString()," TND"]})]})]})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[a.jsx(Ws,{className:"w-5 h-5 text-purple-600"}),"Informations bancaires"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Banque"}),a.jsx("p",{className:"font-medium text-gray-900",children:x.employee.bankName||"-"})]}),a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"RIB"}),a.jsx("p",{className:"font-medium text-gray-900 font-mono",children:x.employee.bankAccount||"-"})]})]})]}),a.jsxs("div",{className:"bg-purple-50 p-4 rounded-xl",children:[a.jsxs("h4",{className:"font-semibold text-purple-800 mb-3 flex items-center gap-2",children:[a.jsx(Cs,{className:"w-5 h-5"}),"Solde de congs"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Cs,{className:"w-5 h-5 text-blue-600"}),a.jsx("span",{className:"font-medium text-blue-800",children:"Congs annuels"})]}),a.jsxs("p",{className:"text-2xl font-bold text-blue-700",children:[x.leaveBalance?`${x.leaveBalance.annualLeave-x.leaveBalance.usedAnnualLeave} / ${x.leaveBalance.annualLeave}`:"24 / 24"," ",a.jsx("span",{className:"text-sm font-normal",children:"jours"})]}),a.jsx("div",{className:"mt-2 w-full bg-blue-200 rounded-full h-2",children:a.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:x.leaveBalance?`${x.leaveBalance.usedAnnualLeave/x.leaveBalance.annualLeave*100}%`:"0%"}})})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Xi,{className:"w-5 h-5 text-red-600"}),a.jsx("span",{className:"font-medium text-red-800",children:"Congs maladie"})]}),a.jsxs("p",{className:"text-2xl font-bold text-red-700",children:[x.leaveBalance?`${x.leaveBalance.sickLeave-x.leaveBalance.usedSickLeave} / ${x.leaveBalance.sickLeave}`:"15 / 15"," ",a.jsx("span",{className:"text-sm font-normal",children:"jours"})]}),a.jsx("div",{className:"mt-2 w-full bg-red-200 rounded-full h-2",children:a.jsx("div",{className:"bg-red-500 h-2 rounded-full",style:{width:x.leaveBalance?`${x.leaveBalance.usedSickLeave/x.leaveBalance.sickLeave*100}%`:"0%"}})})]})]})]}),x.employee.notes&&a.jsxs("div",{className:"bg-yellow-50 p-4 rounded-xl",children:[a.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"Notes"}),a.jsx("p",{className:"text-gray-700",children:x.employee.notes})]}),a.jsxs("div",{className:"bg-indigo-50 p-4 rounded-xl",children:[a.jsxs("h4",{className:"font-semibold text-indigo-800 mb-3 flex items-center gap-2",children:[a.jsx(xr,{className:"w-5 h-5"}),"Documents employ",a.jsx("span",{className:"text-xs font-normal text-indigo-600",children:"Contrats, attestations et documents RH"})]}),x.documents&&x.documents.length>0?a.jsx("div",{className:"space-y-2",children:x.documents.map((A,Z)=>{var de,be,ze,Me,Ae,Ye,nt,ne;return a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg hover:shadow-sm transition-shadow",children:[a.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${(de=A.documentType)!=null&&de.includes("Contrat")?"bg-blue-100":(be=A.documentType)!=null&&be.includes("Fiche")?"bg-green-100":(ze=A.documentType)!=null&&ze.includes("CNSS")?"bg-orange-100":(Me=A.documentType)!=null&&Me.includes("Attestation")?"bg-purple-100":"bg-gray-100"}`,children:a.jsx(Ge,{className:`w-5 h-5 ${(Ae=A.documentType)!=null&&Ae.includes("Contrat")?"text-blue-600":(Ye=A.documentType)!=null&&Ye.includes("Fiche")?"text-green-600":(nt=A.documentType)!=null&&nt.includes("CNSS")?"text-orange-600":(ne=A.documentType)!=null&&ne.includes("Attestation")?"text-purple-600":"text-gray-600"}`})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium text-gray-900",children:A.documentName}),a.jsxs("p",{className:"text-xs text-gray-500",children:[A.documentType,"  ",A.uploadedAt?new Date(A.uploadedAt).toLocaleDateString("fr-FR"):""]})]}),a.jsx("button",{onClick:()=>L(A),className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-lg text-sm hover:bg-blue-200 transition-colors",children:"Tlcharger"})]},Z)})}):a.jsxs("div",{className:"text-center py-6 bg-white rounded-lg",children:[a.jsx(xr,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),a.jsx("p",{className:"text-gray-500",children:"Aucun document"})]})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl",children:[a.jsxs("h4",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[a.jsx(Lc,{className:"w-5 h-5"}),"Historique des oprations"]}),x.history&&(((te=x.history.payslips)==null?void 0:te.length)>0||((ce=x.history.leaves)==null?void 0:ce.length)>0||((se=x.history.contracts)==null?void 0:se.length)>0)?a.jsxs("div",{className:"space-y-3",children:[(he=(le=x.history)==null?void 0:le.payslips)==null?void 0:he.map((A,Z)=>a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white rounded-lg border border-gray-100",children:[a.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:a.jsx(va,{className:"w-5 h-5 text-green-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-medium text-gray-900",children:["Fiche de paie - ",A.period]}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Net: ",Number(A.netSalary).toLocaleString()," TND"]})]}),a.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${A.status==="paid"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:A.status==="paid"?" Paye":" En attente"})]},`pay-${Z}`)),(Ce=(ye=x.history)==null?void 0:ye.leaves)==null?void 0:Ce.map((A,Z)=>a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white rounded-lg border border-gray-100",children:[a.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:a.jsx(Cs,{className:"w-5 h-5 text-purple-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-medium text-gray-900",children:["Cong ",A.leaveType==="annual"?"annuel":A.leaveType==="sick"?"maladie":A.leaveType]}),a.jsxs("p",{className:"text-sm text-gray-500",children:[A.totalDays," jours  ",new Date(A.startDate).toLocaleDateString("fr-FR")," - ",new Date(A.endDate).toLocaleDateString("fr-FR")]})]}),a.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${A.status==="approved"?"bg-green-100 text-green-700":A.status==="rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:A.status==="approved"?" Approuv":A.status==="rejected"?" Refus":" En attente"})]},`leave-${Z}`)),($e=(xe=x.history)==null?void 0:xe.contracts)==null?void 0:$e.map((A,Z)=>a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white rounded-lg border border-gray-100",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:a.jsx(Ge,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium text-gray-900",children:A.title}),a.jsxs("p",{className:"text-sm text-gray-500",children:[A.contractType,"  ",new Date(A.startDate).toLocaleDateString("fr-FR")]})]}),a.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${A.status==="signed"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:A.status==="signed"?" Sign":"Brouillon"})]},`contract-${Z}`)),(Re=(_e=x.history)==null?void 0:_e.documents)==null?void 0:Re.map((A,Z)=>a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white rounded-lg border border-gray-100",children:[a.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center",children:a.jsx(xr,{className:"w-5 h-5 text-indigo-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium text-gray-900",children:A.documentName}),a.jsxs("p",{className:"text-sm text-gray-500",children:[A.documentType,"  ",A.uploadedAt?new Date(A.uploadedAt).toLocaleDateString("fr-FR"):""]})]})]},`doc-${Z}`))]}):a.jsxs("div",{className:"text-center py-8 bg-white rounded-lg",children:[a.jsx(Lc,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),a.jsx("p",{className:"text-gray-500",children:"Aucun historique disponible"}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Les fiches de paie, congs et contrats apparatront ici"})]})]}),a.jsx("div",{className:"flex justify-center pt-4 border-t border-gray-200",children:a.jsxs("button",{onClick:()=>_(x),className:"btn-primary flex items-center gap-2",children:[a.jsx(vn,{className:"w-5 h-5"}),"Tlcharger la fiche complte (PDF)"]})})]})]})})]})},fL=()=>{const[e,t]=S.useState([]),[n,r]=S.useState([]),[s,i]=S.useState(!0),[o,l]=S.useState(!1),[c,u]=S.useState(new Date().getFullYear()),[d,h]=S.useState(new Date().getMonth()+1),[p,f]=S.useState(null),[x,v]=S.useState(!1),[y,m]=S.useState(!1),[g,b]=S.useState(null),w=["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"];S.useEffect(()=>{N()},[c,d]);const N=async()=>{try{const[F,W,L]=await Promise.all([K.get(`/hr/payslips?year=${c}&month=${d}`),K.get("/hr/employees"),K.get(`/hr/payslips/summary?year=${c}&month=${d}`)]);t(F.data.payslips||[]),r(W.data.employees||[]),f(L.data.summary)}catch(F){console.error("Error fetching data:",F)}finally{i(!1)}},C=async()=>{var F,W;l(!0);try{const L=await K.post("/hr/payslips/generate-all",{year:c,month:d});$.success(L.data.message),N(),v(!1)}catch(L){$.error(((W=(F=L.response)==null?void 0:F.data)==null?void 0:W.message)||"Erreur lors de la gnration")}finally{l(!1)}},D=async F=>{try{await K.post(`/hr/payslips/${F}/pay`),$.success("Fiche de paie marque comme paye"),N()}catch{$.error("Erreur")}},j=F=>{b(F),m(!0)},k=F=>Number(F||0).toLocaleString("fr-TN",{minimumFractionDigits:2}),R=F=>{const W=P(F),L=window.open("","_blank");L.document.write(W),L.document.close(),L.focus(),setTimeout(()=>{L.print()},300)},E=F=>{const W=P(F),L=window.open("","_blank");L.document.write(W),L.document.close(),L.focus(),setTimeout(()=>{L.print()},300),$.success("Prparation du PDF...")},P=F=>{const W=Number(F.cnssEmployee||0)+Number(F.irpp||0)+Number(F.otherDeductions||0);return`
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Bulletin de Paie - ${F.firstName} ${F.lastName}</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Segoe UI', Arial, sans-serif; padding: 30px; color: #333; max-width: 800px; margin: 0 auto; }
    .header { background: linear-gradient(135deg, #1e40af, #3b82f6); color: white; padding: 25px; border-radius: 12px; margin-bottom: 25px; }
    .header-top { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px; }
    .company-name { font-size: 24px; font-weight: bold; }
    .document-title { font-size: 18px; font-weight: bold; background: rgba(255,255,255,0.2); padding: 8px 16px; border-radius: 8px; }
    .period { font-size: 14px; opacity: 0.9; margin-top: 5px; }
    .employee-info { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px; padding: 20px; background: #f8fafc; border-radius: 12px; }
    .info-group { }
    .info-label { font-size: 11px; color: #64748b; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 4px; }
    .info-value { font-size: 14px; font-weight: 600; color: #1e293b; }
    .section { margin-bottom: 20px; border: 1px solid #e2e8f0; border-radius: 12px; overflow: hidden; }
    .section-header { background: #f1f5f9; padding: 12px 16px; font-weight: 600; font-size: 14px; border-bottom: 1px solid #e2e8f0; }
    .section-header.gains { background: #dcfce7; color: #166534; }
    .section-header.deductions { background: #fee2e2; color: #991b1b; }
    .section-content { padding: 16px; }
    .line-item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #f1f5f9; }
    .line-item:last-child { border-bottom: none; }
    .line-item.total { border-top: 2px solid #e2e8f0; padding-top: 12px; margin-top: 8px; font-weight: bold; }
    .amount { font-weight: 600; }
    .amount.positive { color: #166534; }
    .amount.negative { color: #dc2626; }
    .net-section { background: linear-gradient(135deg, #1e40af, #3b82f6); color: white; padding: 20px; border-radius: 12px; margin: 25px 0; }
    .net-section .label { font-size: 14px; opacity: 0.9; }
    .net-section .amount { font-size: 32px; font-weight: bold; }
    .employer-charges { background: #fef3c7; padding: 16px; border-radius: 12px; margin-bottom: 20px; }
    .employer-charges-title { font-weight: 600; color: #92400e; margin-bottom: 8px; }
    .footer { text-align: center; padding: 20px; color: #64748b; font-size: 12px; border-top: 1px solid #e2e8f0; margin-top: 30px; }
    @media print { 
      body { padding: 15px; } 
      .header { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      .net-section { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="header-top">
      <div>
        <div class="company-name">StartUpLab SARL</div>
        <div class="period">Priode: ${w[F.month-1]} ${F.year}</div>
      </div>
      <div class="document-title">BULLETIN DE PAIE</div>
    </div>
  </div>

  <div class="employee-info">
    <div class="info-group">
      <div class="info-label">Employ</div>
      <div class="info-value">${F.firstName} ${F.lastName}</div>
    </div>
    <div class="info-group">
      <div class="info-label">Poste</div>
      <div class="info-value">${F.position||"-"}</div>
    </div>
    <div class="info-group">
      <div class="info-label">N CNSS</div>
      <div class="info-value">${F.cnssNumber||"-"}</div>
    </div>
    <div class="info-group">
      <div class="info-label">CIN</div>
      <div class="info-value">${F.cin||"-"}</div>
    </div>
  </div>

  <div class="section">
    <div class="section-header gains"> GAINS</div>
    <div class="section-content">
      <div class="line-item">
        <span>Salaire de base</span>
        <span class="amount positive">${k(F.baseSalary)} TND</span>
      </div>
      ${F.transportAllowance>0?`
      <div class="line-item">
        <span>Prime de transport</span>
        <span class="amount positive">${k(F.transportAllowance)} TND</span>
      </div>
      `:""}
      ${F.mealAllowance>0?`
      <div class="line-item">
        <span>Prime de repas</span>
        <span class="amount positive">${k(F.mealAllowance)} TND</span>
      </div>
      `:""}
      ${F.bonus>0?`
      <div class="line-item">
        <span>Prime / Bonus</span>
        <span class="amount positive">${k(F.bonus)} TND</span>
      </div>
      `:""}
      ${F.otherAllowances>0?`
      <div class="line-item">
        <span>Autres primes</span>
        <span class="amount positive">${k(F.otherAllowances)} TND</span>
      </div>
      `:""}
      <div class="line-item total">
        <span>SALAIRE BRUT</span>
        <span class="amount positive">${k(F.grossSalary)} TND</span>
      </div>
    </div>
  </div>

  <div class="section">
    <div class="section-header deductions"> RETENUES</div>
    <div class="section-content">
      <div class="line-item">
        <span>CNSS salari (9.18%)</span>
        <span class="amount negative">-${k(F.cnssEmployee)} TND</span>
      </div>
      <div class="line-item">
        <span>IRPP (Impt sur le revenu)</span>
        <span class="amount negative">-${k(F.irpp)} TND</span>
      </div>
      ${F.otherDeductions>0?`
      <div class="line-item">
        <span>Autres retenues</span>
        <span class="amount negative">-${k(F.otherDeductions)} TND</span>
      </div>
      `:""}
      <div class="line-item total">
        <span>TOTAL RETENUES</span>
        <span class="amount negative">-${k(W)} TND</span>
      </div>
    </div>
  </div>

  <div class="net-section">
    <div class="label">SALAIRE NET  PAYER</div>
    <div class="amount">${k(F.netSalary)} TND</div>
  </div>

  <div class="employer-charges">
    <div class="employer-charges-title">Charges patronales</div>
    <div class="line-item">
      <span>CNSS employeur (16.57%)</span>
      <span class="amount">${k(F.cnssEmployer)} TND</span>
    </div>
  </div>

  <div class="footer">
    <p>Document gnr le ${new Date().toLocaleDateString("fr-FR")}  ${new Date().toLocaleTimeString("fr-FR")}</p>
    <p>StartUpLab SARL - Gestion des Ressources Humaines</p>
    <p style="margin-top: 10px; font-size: 10px;">Ce bulletin de paie est conforme  la lgislation tunisienne en vigueur</p>
  </div>
</body>
</html>
    `};return s?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Fiches de Paie"}),a.jsx("p",{className:"text-gray-600",children:"Gnration automatique avec calcul CNSS et IRPP"})]}),a.jsxs("button",{onClick:()=>v(!0),className:"btn-primary flex items-center gap-2",children:[a.jsx(Fs,{className:"w-5 h-5"}),"Gnrer les fiches"]})]}),a.jsx("div",{className:"card",children:a.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Hr,{className:"w-5 h-5 text-gray-500"}),a.jsx("span",{className:"font-medium",children:"Priode :"})]}),a.jsx("select",{value:d,onChange:F=>h(Number(F.target.value)),className:"input w-48",children:w.map((F,W)=>a.jsx("option",{value:W+1,children:F},W))}),a.jsx("select",{value:c,onChange:F=>u(Number(F.target.value)),className:"input w-32",children:[2024,2025,2026,2027].map(F=>a.jsx("option",{value:F,children:F},F))})]})}),p&&a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsx("div",{className:"card bg-gradient-to-br from-blue-50 to-blue-100",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-xl flex items-center justify-center",children:a.jsx(st,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-blue-700",children:p.totalPayslips||0}),a.jsx("p",{className:"text-sm text-blue-600",children:"Fiches gnres"})]})]})}),a.jsx("div",{className:"card bg-gradient-to-br from-green-50 to-green-100",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-xl flex items-center justify-center",children:a.jsx(va,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xl font-bold text-green-700",children:k(p.totalGross)}),a.jsx("p",{className:"text-sm text-green-600",children:"Masse salariale brute"})]})]})}),a.jsx("div",{className:"card bg-gradient-to-br from-orange-50 to-orange-100",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-orange-500 rounded-xl flex items-center justify-center",children:a.jsx(Bn,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xl font-bold text-orange-700",children:k((p.totalCnssEmployee||0)+(p.totalCnssEmployer||0))}),a.jsx("p",{className:"text-sm text-orange-600",children:"Total CNSS"})]})]})}),a.jsx("div",{className:"card bg-gradient-to-br from-purple-50 to-purple-100",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-purple-500 rounded-xl flex items-center justify-center",children:a.jsx(Kt,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xl font-bold text-purple-700",children:k(p.totalNet)}),a.jsx("p",{className:"text-sm text-purple-600",children:"Total Net  payer"})]})]})})]}),a.jsxs("div",{className:"card",children:[a.jsxs("h2",{className:"text-lg font-semibold mb-4",children:["Fiches de paie - ",w[d-1]," ",c]}),e.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Ge,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500",children:"Aucune fiche de paie pour cette priode"}),a.jsx("button",{onClick:()=>v(!0),className:"mt-4 text-primary-600 hover:text-primary-700 font-medium",children:"Gnrer les fiches de paie"})]}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-gray-200",children:[a.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Employ"}),a.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-600",children:"Brut"}),a.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-600",children:"CNSS"}),a.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-600",children:"IRPP"}),a.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-600",children:"Net"}),a.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Statut"}),a.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-600",children:"Actions"})]})}),a.jsx("tbody",{children:e.map(F=>{var W,L;return a.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"w-8 h-8 bg-gradient-to-br from-green-400 to-emerald-500 rounded-full flex items-center justify-center text-white text-sm font-bold",children:[(W=F.firstName)==null?void 0:W[0],(L=F.lastName)==null?void 0:L[0]]}),a.jsxs("div",{children:[a.jsxs("p",{className:"font-medium",children:[F.firstName," ",F.lastName]}),a.jsx("p",{className:"text-sm text-gray-500",children:F.position})]})]})}),a.jsxs("td",{className:"py-4 px-4 text-right font-medium",children:[k(F.grossSalary)," TND"]}),a.jsxs("td",{className:"py-4 px-4 text-right text-orange-600",children:["-",k(F.cnssEmployee)," TND"]}),a.jsxs("td",{className:"py-4 px-4 text-right text-red-600",children:["-",k(F.irpp)," TND"]}),a.jsxs("td",{className:"py-4 px-4 text-right font-bold text-green-600",children:[k(F.netSalary)," TND"]}),a.jsx("td",{className:"py-4 px-4 text-center",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${F.status==="paid"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:F.status==="paid"?" Paye":" En attente"})}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsx("button",{onClick:()=>j(F),className:"p-2 hover:bg-blue-100 rounded-lg text-blue-600",title:"Voir dtails",children:a.jsx(Nr,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>E(F),className:"p-2 hover:bg-red-100 rounded-lg text-red-600",title:"Tlcharger PDF",children:a.jsx(vn,{className:"w-4 h-4"})}),F.status!=="paid"&&a.jsx("button",{onClick:()=>D(F.id),className:"p-2 hover:bg-green-100 rounded-lg text-green-600",title:"Marquer comme paye",children:a.jsx(Ct,{className:"w-4 h-4"})})]})})]},F.id)})})]})})]}),x&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Gnrer les fiches de paie"}),a.jsxs("p",{className:"text-gray-600",children:[w[d-1]," ",c]})]}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 mb-4",children:[a.jsx("h3",{className:"font-medium text-blue-800 mb-2",children:"Calculs automatiques"}),a.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[a.jsx("li",{children:" CNSS salari : 9.18% du brut"}),a.jsx("li",{children:" CNSS patronal : 16.57% du brut"}),a.jsx("li",{children:" IRPP selon barme tunisien 2024"})]})]}),a.jsxs("p",{className:"text-gray-600 mb-4",children:[a.jsx("strong",{children:n.filter(F=>F.status==="active").length})," employs actifs seront traits."]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>v(!1),className:"btn-secondary flex-1",children:"Annuler"}),a.jsx("button",{onClick:C,disabled:o,className:"btn-primary flex-1 flex items-center justify-center gap-2",children:o?a.jsxs(a.Fragment,{children:[a.jsx(Fs,{className:"w-5 h-5 animate-spin"}),"Gnration..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Fs,{className:"w-5 h-5"}),"Gnrer"]})})]})]})]})}),y&&g&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Fiche de Paie"}),a.jsxs("p",{className:"text-gray-600",children:[g.firstName," ",g.lastName," - ",w[g.month-1]," ",g.year]})]}),a.jsx("button",{onClick:()=>m(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(kt,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"bg-green-50 p-4 rounded-xl",children:[a.jsx("h3",{className:"font-semibold text-green-800 mb-3",children:"Gains"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Salaire de base"}),a.jsxs("span",{className:"font-medium",children:[k(g.baseSalary)," TND"]})]}),g.transportAllowance>0&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Prime de transport"}),a.jsxs("span",{className:"font-medium",children:[k(g.transportAllowance)," TND"]})]}),g.mealAllowance>0&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Prime de repas"}),a.jsxs("span",{className:"font-medium",children:[k(g.mealAllowance)," TND"]})]}),g.bonus>0&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Prime/Bonus"}),a.jsxs("span",{className:"font-medium",children:[k(g.bonus)," TND"]})]}),a.jsxs("div",{className:"flex justify-between pt-2 border-t border-green-200 font-bold",children:[a.jsx("span",{children:"Salaire Brut"}),a.jsxs("span",{className:"text-green-700",children:[k(g.grossSalary)," TND"]})]})]})]}),a.jsxs("div",{className:"bg-red-50 p-4 rounded-xl",children:[a.jsx("h3",{className:"font-semibold text-red-800 mb-3",children:"Retenues"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"CNSS salari (9.18%)"}),a.jsxs("span",{className:"font-medium text-red-600",children:["-",k(g.cnssEmployee)," TND"]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"IRPP"}),a.jsxs("span",{className:"font-medium text-red-600",children:["-",k(g.irpp)," TND"]})]}),g.otherDeductions>0&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Autres retenues"}),a.jsxs("span",{className:"font-medium text-red-600",children:["-",k(g.otherDeductions)," TND"]})]}),a.jsxs("div",{className:"flex justify-between pt-2 border-t border-red-200 font-bold",children:[a.jsx("span",{children:"Total Retenues"}),a.jsxs("span",{className:"text-red-700",children:["-",k(Number(g.cnssEmployee)+Number(g.irpp)+Number(g.otherDeductions||0))," TND"]})]})]})]}),a.jsx("div",{className:"bg-blue-100 p-4 rounded-xl border-2 border-blue-300",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"font-bold text-blue-800",children:"Salaire Net  Payer"}),a.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:[k(g.netSalary)," TND"]})]})}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl",children:[a.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Charges patronales"}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"CNSS employeur (16.57%)"}),a.jsxs("span",{className:"font-medium",children:[k(g.cnssEmployer)," TND"]})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsxs("button",{onClick:()=>R(g),className:"btn-secondary flex-1 flex items-center justify-center gap-2",children:[a.jsx(GD,{className:"w-5 h-5"}),"Imprimer"]}),a.jsxs("button",{onClick:()=>E(g),className:"btn-primary flex-1 flex items-center justify-center gap-2",children:[a.jsx(vn,{className:"w-5 h-5"}),"Tlcharger PDF"]})]})]})]})})]})},mL=()=>{const[e,t]=S.useState([]),[n,r]=S.useState(!0),[s,i]=S.useState(!1),[o,l]=S.useState(new Date().getFullYear()),[c,u]=S.useState(Math.ceil((new Date().getMonth()+1)/3)),d=[{value:1,label:"T1 (Jan-Mar)",months:"Janvier - Mars"},{value:2,label:"T2 (Avr-Jun)",months:"Avril - Juin"},{value:3,label:"T3 (Jul-Sep)",months:"Juillet - Septembre"},{value:4,label:"T4 (Oct-Dc)",months:"Octobre - Dcembre"}];S.useEffect(()=>{h()},[]);const h=async()=>{try{const m=await K.get("/hr/cnss");t(m.data.declarations||[])}catch{$.error("Erreur lors du chargement")}finally{r(!1)}},p=async()=>{var m,g;i(!0);try{const b=await K.post("/hr/cnss/generate",{quarter:c,year:o});$.success(b.data.message),h()}catch(b){$.error(((g=(m=b.response)==null?void 0:m.data)==null?void 0:g.message)||"Erreur lors de la gnration")}finally{i(!1)}},f=async m=>{try{const g=await K.post(`/hr/cnss/${m}/submit`);$.success(`Dclaration soumise - Rf: ${g.data.referenceNumber}`),h()}catch{$.error("Erreur lors de la soumission")}},x=m=>Number(m||0).toLocaleString("fr-TN",{minimumFractionDigits:2}),v=m=>{switch(m){case"submitted":return a.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs font-medium flex items-center gap-1",children:[a.jsx(Ct,{className:"w-3 h-3"})," Soumise"]});case"paid":return a.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium flex items-center gap-1",children:[a.jsx(Ct,{className:"w-3 h-3"})," Paye"]});default:return a.jsxs("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-700 rounded-full text-xs font-medium flex items-center gap-1",children:[a.jsx(Et,{className:"w-3 h-3"})," Brouillon"]})}};if(n)return a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});const y=e.find(m=>m.year===o&&m.quarter===c);return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dclaration CNSS"}),a.jsx("p",{className:"text-gray-600",children:"Dclarations trimestrielles des cotisations sociales"})]})}),a.jsx("div",{className:"card bg-gradient-to-r from-orange-500 to-amber-500 text-white",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:a.jsx(Ws,{className:"w-6 h-6"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h2",{className:"text-lg font-bold",children:"Taux de cotisation CNSS Tunisie"}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mt-3",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-white/80 text-sm",children:"Part salariale"}),a.jsx("p",{className:"text-2xl font-bold",children:"9.18%"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-white/80 text-sm",children:"Part patronale"}),a.jsx("p",{className:"text-2xl font-bold",children:"16.57%"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-white/80 text-sm",children:"Total"}),a.jsx("p",{className:"text-2xl font-bold",children:"25.75%"})]})]})]})]})}),a.jsxs("div",{className:"card",children:[a.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Gnrer une dclaration"}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-end",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trimestre"}),a.jsx("select",{value:c,onChange:m=>u(Number(m.target.value)),className:"input w-full",children:d.map(m=>a.jsxs("option",{value:m.value,children:[m.label," - ",m.months]},m.value))})]}),a.jsxs("div",{className:"w-32",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Anne"}),a.jsx("select",{value:o,onChange:m=>l(Number(m.target.value)),className:"input w-full",children:[2024,2025,2026,2027].map(m=>a.jsx("option",{value:m,children:m},m))})]}),a.jsxs("button",{onClick:p,disabled:s||y,className:"btn-primary flex items-center gap-2 whitespace-nowrap",children:[s?a.jsx(Fs,{className:"w-5 h-5 animate-spin"}):a.jsx(Bn,{className:"w-5 h-5"}),y?"Dj gnre":"Gnrer"]})]}),y&&a.jsx("div",{className:"mt-4 p-4 bg-green-50 rounded-xl",children:a.jsxs("p",{className:"text-green-700 flex items-center gap-2",children:[a.jsx(Ct,{className:"w-5 h-5"}),"Une dclaration existe dj pour ",d[c-1].label," ",o]})})]}),a.jsxs("div",{className:"card",children:[a.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Historique des dclarations"}),e.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Ge,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500",children:"Aucune dclaration CNSS"})]}):a.jsx("div",{className:"space-y-4",children:e.map(m=>{var g;return a.jsxs("div",{className:"border border-gray-200 rounded-xl p-5 hover:border-orange-300 transition-colors",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-xl flex items-center justify-center",children:a.jsx(Ws,{className:"w-6 h-6 text-orange-600"})}),a.jsxs("div",{children:[a.jsxs("h3",{className:"font-semibold text-gray-900",children:[(g=d[m.quarter-1])==null?void 0:g.label," ",m.year]}),a.jsxs("p",{className:"text-sm text-gray-500",children:[m.totalEmployees," employs  chance: ",m.dueDate?new Date(m.dueDate).toLocaleDateString("fr-FR"):"-"]}),m.referenceNumber&&a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Rf: ",m.referenceNumber]})]})]}),v(m.status)]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4",children:[a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Masse salariale"}),a.jsxs("p",{className:"font-semibold",children:[x(m.totalGrossSalary)," TND"]})]}),a.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Part salariale"}),a.jsxs("p",{className:"font-semibold text-orange-600",children:[x(m.cnssEmployeeTotal)," TND"]})]}),a.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Part patronale"}),a.jsxs("p",{className:"font-semibold text-orange-600",children:[x(m.cnssEmployerTotal)," TND"]})]}),a.jsxs("div",{className:"bg-amber-100 p-3 rounded-lg",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Total  payer"}),a.jsxs("p",{className:"font-bold text-amber-700",children:[x(m.totalContributions)," TND"]})]})]}),a.jsxs("div",{className:"flex gap-2 mt-4 pt-4 border-t border-gray-100",children:[m.status==="draft"&&a.jsxs("button",{onClick:()=>f(m.id),className:"btn-primary text-sm flex items-center gap-2",children:[a.jsx(Em,{className:"w-4 h-4"}),"Soumettre"]}),a.jsxs("button",{className:"btn-secondary text-sm flex items-center gap-2",children:[a.jsx(vn,{className:"w-4 h-4"}),"Formulaire DS"]}),a.jsxs("button",{className:"btn-secondary text-sm flex items-center gap-2",children:[a.jsx(Ge,{className:"w-4 h-4"}),"Liste nominative"]})]})]},m.id)})})]}),a.jsxs("div",{className:"card bg-blue-50",children:[a.jsxs("h3",{className:"font-semibold text-blue-800 mb-3 flex items-center gap-2",children:[a.jsx(cl,{className:"w-5 h-5"}),"Rappel des chances"]}),a.jsxs("div",{className:"grid md:grid-cols-4 gap-4 text-sm",children:[a.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[a.jsx("p",{className:"font-medium text-blue-800",children:"T1 (Jan-Mar)"}),a.jsx("p",{className:"text-gray-600",children:"chance: 15 Avril"})]}),a.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[a.jsx("p",{className:"font-medium text-blue-800",children:"T2 (Avr-Jun)"}),a.jsx("p",{className:"text-gray-600",children:"chance: 15 Juillet"})]}),a.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[a.jsx("p",{className:"font-medium text-blue-800",children:"T3 (Jul-Sep)"}),a.jsx("p",{className:"text-gray-600",children:"chance: 15 Octobre"})]}),a.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[a.jsx("p",{className:"font-medium text-blue-800",children:"T4 (Oct-Dc)"}),a.jsx("p",{className:"text-gray-600",children:"chance: 15 Janvier"})]})]})]})]})},xL=()=>{const[e,t]=S.useState([]),[n,r]=S.useState([]),[s,i]=S.useState([]),[o,l]=S.useState(!0),[c,u]=S.useState("requests"),[d,h]=S.useState("all"),[p,f]=S.useState(!1),[x,v]=S.useState({employeeId:"",leaveType:"annual",startDate:"",endDate:"",reason:""}),y=[{value:"annual",label:"Cong annuel",icon:Cs,color:"blue"},{value:"sick",label:"Cong maladie",icon:Xi,color:"red"},{value:"maternity",label:"Cong maternit",icon:yD,color:"pink"},{value:"unpaid",label:"Cong sans solde",icon:Hr,color:"gray"}];S.useEffect(()=>{m()},[]);const m=async()=>{var k;try{const[R,E,P]=await Promise.all([K.get("/hr/leaves"),K.get("/hr/leaves/balances"),K.get("/hr/employees")]);t(R.data.leaves||[]),r(E.data.balances||[]),i(((k=P.data.employees)==null?void 0:k.filter(F=>F.status==="active"))||[])}catch{$.error("Erreur lors du chargement")}finally{l(!1)}},g=async k=>{var R,E;k.preventDefault();try{await K.post("/hr/leaves",x),$.success("Demande de cong cre"),f(!1),v({employeeId:"",leaveType:"annual",startDate:"",endDate:"",reason:""}),m()}catch(P){$.error(((E=(R=P.response)==null?void 0:R.data)==null?void 0:E.message)||"Erreur")}},b=async k=>{try{await K.post(`/hr/leaves/${k}/approve`),$.success("Cong approuv"),m()}catch{$.error("Erreur")}},w=async k=>{const R=prompt("Raison du refus:");if(R)try{await K.post(`/hr/leaves/${k}/reject`,{reason:R}),$.success("Demande refuse"),m()}catch{$.error("Erreur")}},N=e.filter(k=>d==="all"?!0:k.status===d),C=k=>{switch(k){case"approved":return a.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs font-medium flex items-center gap-1",children:[a.jsx(Ct,{className:"w-3 h-3"})," Approuv"]});case"rejected":return a.jsxs("span",{className:"px-2 py-1 bg-red-100 text-red-700 rounded-full text-xs font-medium flex items-center gap-1",children:[a.jsx(kt,{className:"w-3 h-3"})," Refus"]});default:return a.jsxs("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-700 rounded-full text-xs font-medium flex items-center gap-1",children:[a.jsx(Et,{className:"w-3 h-3"})," En attente"]})}},D=k=>y.find(R=>R.value===k)||y[0];if(o)return a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});const j=e.filter(k=>k.status==="pending").length;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestion des Congs"}),a.jsx("p",{className:"text-gray-600",children:"Demandes et suivi des congs employs"})]}),a.jsxs("button",{onClick:()=>f(!0),className:"btn-primary flex items-center gap-2",children:[a.jsx(ir,{className:"w-5 h-5"}),"Nouvelle demande"]})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsx("div",{onClick:()=>{u("requests"),h("pending")},className:`card cursor-pointer transition-all ${d==="pending"?"ring-2 ring-yellow-500":"hover:shadow-md"}`,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-xl flex items-center justify-center",children:a.jsx(Et,{className:"w-6 h-6 text-yellow-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-yellow-700",children:j}),a.jsx("p",{className:"text-sm text-gray-600",children:"En attente"})]})]})}),a.jsx("div",{onClick:()=>{u("requests"),h("approved")},className:`card cursor-pointer transition-all ${d==="approved"?"ring-2 ring-green-500":"hover:shadow-md"}`,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:a.jsx(Ct,{className:"w-6 h-6 text-green-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-green-700",children:e.filter(k=>k.status==="approved").length}),a.jsx("p",{className:"text-sm text-gray-600",children:"Approuvs"})]})]})}),a.jsx("div",{onClick:()=>{u("requests"),h("rejected")},className:`card cursor-pointer transition-all ${d==="rejected"?"ring-2 ring-red-500":"hover:shadow-md"}`,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center",children:a.jsx(kt,{className:"w-6 h-6 text-red-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-red-700",children:e.filter(k=>k.status==="rejected").length}),a.jsx("p",{className:"text-sm text-gray-600",children:"Refuss"})]})]})}),a.jsx("div",{onClick:()=>{u("balances"),h("all")},className:`card cursor-pointer transition-all ${c==="balances"?"ring-2 ring-purple-500":"hover:shadow-md"}`,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:a.jsx(st,{className:"w-6 h-6 text-purple-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-purple-700",children:n.length}),a.jsx("p",{className:"text-sm text-gray-600",children:"Soldes"})]})]})})]}),a.jsxs("div",{className:"flex gap-2 border-b border-gray-200",children:[a.jsx("button",{onClick:()=>{u("requests"),h("all")},className:`px-4 py-2 font-medium border-b-2 transition-colors ${c==="requests"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Demandes de congs"}),a.jsx("button",{onClick:()=>u("balances"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${c==="balances"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Soldes par employ"})]}),c==="requests"&&a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Demandes de congs"}),a.jsxs("select",{value:d,onChange:k=>h(k.target.value),className:"input w-40",children:[a.jsx("option",{value:"all",children:"Tous"}),a.jsx("option",{value:"pending",children:"En attente"}),a.jsx("option",{value:"approved",children:"Approuvs"}),a.jsx("option",{value:"rejected",children:"Refuss"})]})]}),N.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Hr,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500",children:"Aucune demande de cong"})]}):a.jsx("div",{className:"space-y-4",children:N.map(k=>{const R=D(k.leaveType),E=R.icon;return a.jsx("div",{className:"border border-gray-200 rounded-xl p-4 hover:border-purple-300 transition-colors",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:`w-12 h-12 bg-${R.color}-100 rounded-xl flex items-center justify-center`,children:a.jsx(E,{className:`w-6 h-6 text-${R.color}-600`})}),a.jsxs("div",{children:[a.jsxs("h3",{className:"font-semibold text-gray-900",children:[k.firstName," ",k.lastName]}),a.jsx("p",{className:"text-sm text-gray-500",children:k.position}),a.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm",children:[a.jsx("span",{className:"font-medium text-purple-600",children:R.label}),a.jsxs("span",{className:"text-gray-500",children:[new Date(k.startDate).toLocaleDateString("fr-FR")," - ",new Date(k.endDate).toLocaleDateString("fr-FR")]}),a.jsxs("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 rounded-full",children:[k.totalDays," jours"]})]}),k.reason&&a.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:['"',k.reason,'"']}),k.rejectionReason&&a.jsxs("p",{className:"text-sm text-red-600 mt-2 bg-red-50 p-2 rounded",children:["Raison du refus: ",k.rejectionReason]})]})]}),a.jsxs("div",{className:"flex flex-col items-end gap-2",children:[C(k.status),k.status==="pending"&&a.jsxs("div",{className:"flex gap-2 mt-2",children:[a.jsx("button",{onClick:()=>b(k.id),className:"p-2 bg-green-100 hover:bg-green-200 rounded-lg text-green-600",title:"Approuver",children:a.jsx(Ct,{className:"w-5 h-5"})}),a.jsx("button",{onClick:()=>w(k.id),className:"p-2 bg-red-100 hover:bg-red-200 rounded-lg text-red-600",title:"Refuser",children:a.jsx(kt,{className:"w-5 h-5"})})]})]})]})},k.id)})})]}),c==="balances"&&a.jsxs("div",{className:"card",children:[a.jsxs("h2",{className:"text-lg font-semibold mb-4",children:["Soldes de congs ",new Date().getFullYear()]}),n.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(st,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500",children:"Aucun solde de congs"})]}):a.jsx("div",{className:"space-y-4",children:n.map(k=>{var W,L;const R=k.annualLeave-k.usedAnnualLeave,E=k.sickLeave-k.usedSickLeave,P=k.usedAnnualLeave/k.annualLeave*100,F=k.usedSickLeave/k.sickLeave*100;return a.jsxs("div",{className:"border border-gray-200 rounded-xl p-4",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[a.jsxs("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-400 to-pink-500 rounded-full flex items-center justify-center text-white font-bold",children:[(W=k.firstName)==null?void 0:W[0],(L=k.lastName)==null?void 0:L[0]]}),a.jsxs("div",{children:[a.jsxs("p",{className:"font-semibold",children:[k.firstName," ",k.lastName]}),a.jsx("p",{className:"text-sm text-gray-500",children:k.position})]})]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("span",{className:"font-medium text-blue-800 flex items-center gap-2",children:[a.jsx(Cs,{className:"w-4 h-4"}),"Congs annuels"]}),a.jsxs("span",{className:"text-sm text-blue-600",children:[R," / ",k.annualLeave," jours"]})]}),a.jsx("div",{className:"w-full bg-blue-200 rounded-full h-3",children:a.jsx("div",{className:"bg-blue-500 h-3 rounded-full transition-all",style:{width:`${P}%`}})}),a.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[k.usedAnnualLeave," jours utiliss"]})]}),a.jsxs("div",{className:"bg-red-50 p-4 rounded-xl",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("span",{className:"font-medium text-red-800 flex items-center gap-2",children:[a.jsx(Xi,{className:"w-4 h-4"}),"Congs maladie"]}),a.jsxs("span",{className:"text-sm text-red-600",children:[E," / ",k.sickLeave," jours"]})]}),a.jsx("div",{className:"w-full bg-red-200 rounded-full h-3",children:a.jsx("div",{className:"bg-red-500 h-3 rounded-full transition-all",style:{width:`${F}%`}})}),a.jsxs("p",{className:"text-xs text-red-600 mt-1",children:[k.usedSickLeave," jours utiliss"]})]})]})]},k.id)})})]}),p&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Nouvelle demande de cong"}),a.jsx("button",{onClick:()=>f(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(kt,{className:"w-5 h-5"})})]}),a.jsxs("form",{onSubmit:g,className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employ *"}),a.jsxs("select",{value:x.employeeId,onChange:k=>v({...x,employeeId:k.target.value}),className:"input w-full",required:!0,children:[a.jsx("option",{value:"",children:"Slectionner un employ"}),s.map(k=>a.jsxs("option",{value:k.id,children:[k.firstName," ",k.lastName," - ",k.position]},k.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type de cong *"}),a.jsx("select",{value:x.leaveType,onChange:k=>v({...x,leaveType:k.target.value}),className:"input w-full",required:!0,children:y.map(k=>a.jsx("option",{value:k.value,children:k.label},k.value))})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date dbut *"}),a.jsx("input",{type:"date",value:x.startDate,onChange:k=>v({...x,startDate:k.target.value}),className:"input w-full",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date fin *"}),a.jsx("input",{type:"date",value:x.endDate,onChange:k=>v({...x,endDate:k.target.value}),className:"input w-full",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Motif"}),a.jsx("textarea",{value:x.reason,onChange:k=>v({...x,reason:k.target.value}),className:"input w-full",rows:3,placeholder:"Raison de la demande..."})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>f(!1),className:"btn-secondary flex-1",children:"Annuler"}),a.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Crer la demande"})]})]})]})})]})},gL=()=>{const[e,t]=S.useState([]),[n,r]=S.useState([]),[s,i]=S.useState(!0),[o,l]=S.useState(!1),[c,u]=S.useState(!1),[d,h]=S.useState(null),[p,f]=S.useState({employeeId:"",contractType:"CDI",title:"",startDate:"",endDate:"",salary:"",position:"",content:""}),x=[{value:"CDI",label:"Contrat  Dure Indtermine (CDI)"},{value:"CDD",label:"Contrat  Dure Dtermine (CDD)"},{value:"SIVP",label:"Stage d'Initiation  la Vie Professionnelle (SIVP)"},{value:"Stage",label:"Convention de Stage"},{value:"Avenant",label:"Avenant au contrat"}];S.useEffect(()=>{v()},[]);const v=async()=>{var j;try{const[k,R]=await Promise.all([K.get("/hr/contracts"),K.get("/hr/employees")]);t(k.data.contracts||[]),r(((j=R.data.employees)==null?void 0:j.filter(E=>E.status==="active"))||[])}catch{$.error("Erreur lors du chargement")}finally{i(!1)}},y=async j=>{var k,R;j.preventDefault();try{await K.post("/hr/contracts",p),$.success("Contrat cr avec succs"),l(!1),b(),v()}catch(E){$.error(((R=(k=E.response)==null?void 0:k.data)==null?void 0:R.message)||"Erreur")}},m=async j=>{try{const k=await K.post(`/hr/contracts/${j}/sign-employer`);$.success("Contrat sign par l'employeur"),v()}catch{$.error("Erreur lors de la signature")}},g=async j=>{try{const k=await K.post(`/hr/contracts/${j}/sign-employee`);$.success("Contrat sign par l'employ"),v()}catch{$.error("Erreur lors de la signature")}},b=()=>{f({employeeId:"",contractType:"CDI",title:"",startDate:"",endDate:"",salary:"",position:"",content:""})},w=j=>{h(j),u(!0)},N=j=>j.status==="signed"?a.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs font-medium flex items-center gap-1",children:[a.jsx(Ct,{className:"w-3 h-3"})," Sign"]}):j.employerSignedAt&&!j.employeeSignedAt?a.jsxs("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-700 rounded-full text-xs font-medium flex items-center gap-1",children:[a.jsx(Et,{className:"w-3 h-3"})," Attente signature employ"]}):!j.employerSignedAt&&j.employeeSignedAt?a.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium flex items-center gap-1",children:[a.jsx(Et,{className:"w-3 h-3"})," Attente signature employeur"]}):a.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded-full text-xs font-medium flex items-center gap-1",children:[a.jsx(Ge,{className:"w-3 h-3"})," Brouillon"]}),C=()=>{const j=n.find(R=>R.id===Number(p.employeeId));if(!j)return;const k=`CONTRAT DE TRAVAIL ${p.contractType}

Entre les soussigns :

L'EMPLOYEUR :
[Nom de l'entreprise]
Reprsente par : [Nom du reprsentant]
Adresse : [Adresse de l'entreprise]

ET

L'EMPLOY(E) :
Nom et prnom : ${j.firstName} ${j.lastName}
CIN : ${j.cin||"[ complter]"}
Adresse : ${j.address||"[ complter]"}

Il a t convenu ce qui suit :

ARTICLE 1 - ENGAGEMENT
L'employeur engage l'employ(e) en qualit de ${p.position||"[Poste]"}  compter du ${p.startDate||"[Date]"}.

ARTICLE 2 - DURE
${p.contractType==="CDI"?"Le prsent contrat est conclu pour une dure indtermine.":`Le prsent contrat est conclu pour une dure dtermine jusqu'au ${p.endDate||"[Date de fin]"}.`}

ARTICLE 3 - RMUNRATION
L'employ(e) percevra une rmunration mensuelle brute de ${p.salary||"[Montant]"} TND.

ARTICLE 4 - PRIODE D'ESSAI
Une priode d'essai de ${p.contractType==="CDI"?"3 mois":"1 mois"} est prvue, renouvelable une fois.

ARTICLE 5 - HORAIRES DE TRAVAIL
L'employ(e) est soumis(e)  la dure lgale du travail en vigueur en Tunisie.

ARTICLE 6 - CONGS PAYS
L'employ(e) bnficiera des congs pays conformment  la lgislation tunisienne en vigueur.

Fait en deux exemplaires originaux.

 _____________, le _____________

L'EMPLOYEUR                                    L'EMPLOY(E)
(Signature et cachet)                          (Signature)`;f({...p,content:k})};if(s)return a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});const D={total:e.length,signed:e.filter(j=>j.status==="signed").length,pending:e.filter(j=>j.status!=="signed"&&j.status!=="draft").length,draft:e.filter(j=>j.status==="draft").length};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Signature Contrat Digital"}),a.jsx("p",{className:"text-gray-600",children:"Signature lectronique conforme  la loi n2000-83"})]}),a.jsxs("button",{onClick:()=>{b(),l(!0)},className:"btn-primary flex items-center gap-2",children:[a.jsx(ir,{className:"w-5 h-5"}),"Nouveau contrat"]})]}),a.jsx("div",{className:"card bg-gradient-to-r from-indigo-600 to-violet-600 text-white",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:a.jsx(is,{className:"w-6 h-6"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-bold",children:"Signature lectronique lgale"}),a.jsx("p",{className:"text-white/80 text-sm mt-1",children:"Conforme  la loi tunisienne n2000-83 relative aux changes et au commerce lectroniques. Chaque signature est horodate et scurise par un hash SHA-256."})]})]})}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsx("div",{className:"card",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:a.jsx(Ge,{className:"w-6 h-6 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:D.total}),a.jsx("p",{className:"text-sm text-gray-600",children:"Total"})]})]})}),a.jsx("div",{className:"card",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:a.jsx(Ct,{className:"w-6 h-6 text-green-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-green-700",children:D.signed}),a.jsx("p",{className:"text-sm text-gray-600",children:"Signs"})]})]})}),a.jsx("div",{className:"card",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-xl flex items-center justify-center",children:a.jsx(Et,{className:"w-6 h-6 text-yellow-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-yellow-700",children:D.pending}),a.jsx("p",{className:"text-sm text-gray-600",children:"En attente"})]})]})}),a.jsx("div",{className:"card",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center",children:a.jsx(Ge,{className:"w-6 h-6 text-gray-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-gray-700",children:D.draft}),a.jsx("p",{className:"text-sm text-gray-600",children:"Brouillons"})]})]})})]}),a.jsxs("div",{className:"card",children:[a.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Contrats"}),e.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Ge,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500",children:"Aucun contrat"}),a.jsx("button",{onClick:()=>{b(),l(!0)},className:"mt-4 text-primary-600 hover:text-primary-700 font-medium",children:"Crer votre premier contrat"})]}):a.jsx("div",{className:"space-y-4",children:e.map(j=>a.jsxs("div",{className:"border border-gray-200 rounded-xl p-5 hover:border-indigo-300 transition-colors",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center ${j.status==="signed"?"bg-green-100":"bg-indigo-100"}`,children:a.jsx(Ge,{className:`w-6 h-6 ${j.status==="signed"?"text-green-600":"text-indigo-600"}`})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:j.title}),a.jsxs("p",{className:"text-sm text-gray-500",children:[j.firstName," ",j.lastName,"  ",j.contractType]}),a.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-500",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Hr,{className:"w-4 h-4"}),new Date(j.startDate).toLocaleDateString("fr-FR")]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Ws,{className:"w-4 h-4"}),j.position]}),a.jsxs("span",{className:"font-medium text-green-600",children:[Number(j.salary).toLocaleString()," TND"]})]})]})]}),a.jsxs("div",{className:"flex flex-col items-end gap-2",children:[N(j),j.signatureHash&&a.jsxs("span",{className:"text-xs text-gray-400 flex items-center gap-1",children:[a.jsx(FD,{className:"w-3 h-3"}),j.signatureHash.substring(0,12),"..."]})]})]}),a.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-8",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${j.employerSignedAt?"bg-green-100 text-green-600":"bg-gray-100 text-gray-400"}`,children:j.employerSignedAt?a.jsx(Ct,{className:"w-4 h-4"}):a.jsx(Oc,{className:"w-4 h-4"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:"Employeur"}),a.jsx("p",{className:"text-xs text-gray-500",children:j.employerSignedAt?new Date(j.employerSignedAt).toLocaleString("fr-FR"):"Non sign"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${j.employeeSignedAt?"bg-green-100 text-green-600":"bg-gray-100 text-gray-400"}`,children:j.employeeSignedAt?a.jsx(Ct,{className:"w-4 h-4"}):a.jsx(qn,{className:"w-4 h-4"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:"Employ"}),a.jsx("p",{className:"text-xs text-gray-500",children:j.employeeSignedAt?new Date(j.employeeSignedAt).toLocaleString("fr-FR"):"Non sign"})]})]})]})}),a.jsxs("div",{className:"flex gap-2 mt-4",children:[a.jsxs("button",{onClick:()=>w(j),className:"btn-secondary text-sm flex items-center gap-2",children:[a.jsx(Nr,{className:"w-4 h-4"}),"Voir"]}),!j.employerSignedAt&&a.jsxs("button",{onClick:()=>m(j.id),className:"btn-primary text-sm flex items-center gap-2",children:[a.jsx(Oc,{className:"w-4 h-4"}),"Signer (Employeur)"]}),j.employerSignedAt&&!j.employeeSignedAt&&a.jsxs("button",{onClick:()=>g(j.id),className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm flex items-center gap-2",children:[a.jsx(Oc,{className:"w-4 h-4"}),"Signer (Employ)"]}),j.status==="signed"&&a.jsxs("button",{className:"btn-secondary text-sm flex items-center gap-2",children:[a.jsx(vn,{className:"w-4 h-4"}),"Tlcharger PDF"]})]})]},j.id))})]}),o&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Nouveau contrat"}),a.jsx("button",{onClick:()=>l(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(kt,{className:"w-5 h-5"})})]}),a.jsxs("form",{onSubmit:y,className:"p-6 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employ *"}),a.jsxs("select",{value:p.employeeId,onChange:j=>f({...p,employeeId:j.target.value}),className:"input w-full",required:!0,children:[a.jsx("option",{value:"",children:"Slectionner"}),n.map(j=>a.jsxs("option",{value:j.id,children:[j.firstName," ",j.lastName]},j.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type de contrat *"}),a.jsx("select",{value:p.contractType,onChange:j=>f({...p,contractType:j.target.value}),className:"input w-full",required:!0,children:x.map(j=>a.jsx("option",{value:j.value,children:j.label},j.value))})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Titre du contrat *"}),a.jsx("input",{type:"text",value:p.title,onChange:j=>f({...p,title:j.target.value}),className:"input w-full",placeholder:"Ex: Contrat CDI - Dveloppeur Senior",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Poste *"}),a.jsx("input",{type:"text",value:p.position,onChange:j=>f({...p,position:j.target.value}),className:"input w-full",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Salaire brut (TND) *"}),a.jsx("input",{type:"number",value:p.salary,onChange:j=>f({...p,salary:j.target.value}),className:"input w-full",required:!0})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de dbut *"}),a.jsx("input",{type:"date",value:p.startDate,onChange:j=>f({...p,startDate:j.target.value}),className:"input w-full",required:!0})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date de fin ",p.contractType!=="CDI"&&"*"]}),a.jsx("input",{type:"date",value:p.endDate,onChange:j=>f({...p,endDate:j.target.value}),className:"input w-full",required:p.contractType!=="CDI"})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Contenu du contrat"}),a.jsx("button",{type:"button",onClick:C,className:"text-sm text-primary-600 hover:text-primary-700",children:"Gnrer automatiquement"})]}),a.jsx("textarea",{value:p.content,onChange:j=>f({...p,content:j.target.value}),className:"input w-full font-mono text-sm",rows:12,placeholder:"Contenu du contrat de travail..."})]}),a.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:()=>l(!1),className:"btn-secondary flex-1",children:"Annuler"}),a.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Crer le contrat"})]})]})]})}),c&&d&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold",children:d.title}),a.jsxs("p",{className:"text-gray-500 text-sm",children:[d.firstName," ",d.lastName]})]}),a.jsx("button",{onClick:()=>u(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(kt,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Type"}),a.jsx("p",{className:"font-semibold",children:d.contractType})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Poste"}),a.jsx("p",{className:"font-semibold",children:d.position})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Date de dbut"}),a.jsx("p",{className:"font-semibold",children:new Date(d.startDate).toLocaleDateString("fr-FR")})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Salaire brut"}),a.jsxs("p",{className:"font-semibold text-green-600",children:[Number(d.salary).toLocaleString()," TND"]})]})]}),d.signatureHash&&a.jsxs("div",{className:"bg-indigo-50 p-4 rounded-xl",children:[a.jsxs("h4",{className:"font-medium text-indigo-800 mb-2 flex items-center gap-2",children:[a.jsx(is,{className:"w-5 h-5"}),"Certificat de signature"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500",children:"Hash SHA-256"}),a.jsx("p",{className:"font-mono text-xs break-all",children:d.signatureHash})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500",children:"Statut"}),a.jsx("p",{className:"font-medium text-green-600",children:" Authentique"})]})]})]}),d.content&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Contenu du contrat"}),a.jsx("div",{className:"bg-gray-50 p-4 rounded-lg font-mono text-sm whitespace-pre-wrap max-h-64 overflow-y-auto",children:d.content})]}),a.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[a.jsx("button",{onClick:()=>u(!1),className:"btn-secondary flex-1",children:"Fermer"}),a.jsxs("button",{className:"btn-primary flex-1 flex items-center justify-center gap-2",children:[a.jsx(vn,{className:"w-5 h-5"}),"Tlcharger PDF"]})]})]})]})})]})},ot=({children:e})=>{const{isAuthenticated:t}=cr();return t?e:a.jsx(sw,{to:"/login",replace:!0})},Mb=({children:e})=>{const{isAuthenticated:t}=cr();return t?a.jsx(sw,{to:"/dashboard",replace:!0}):e};function vL(){return a.jsxs(d3,{children:[a.jsx(rE,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"},success:{style:{background:"#10b981"}},error:{style:{background:"#ef4444"}}}}),a.jsxs(r3,{children:[a.jsx(We,{path:"/",element:a.jsx(iR,{})}),a.jsx(We,{path:"/login",element:a.jsx(Mb,{children:a.jsx(TM,{})})}),a.jsx(We,{path:"/register",element:a.jsx(Mb,{children:a.jsx(AM,{})})}),a.jsx(We,{path:"/pricing",element:a.jsx(XM,{})}),a.jsx(We,{path:"/auth/google/callback",element:a.jsx(QM,{})}),a.jsx(We,{path:"/invite/:token",element:a.jsx(HM,{})}),a.jsx(We,{path:"/dashboard",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx(IM,{})})})}),a.jsx(We,{path:"/projects",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx(FM,{})})})}),a.jsx(We,{path:"/projects/:id",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx(MM,{})})})}),a.jsx(We,{path:"/ideas",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx(LM,{})})})}),a.jsx(We,{path:"/business-model/:projectId",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx(OM,{})})})}),a.jsx(We,{path:"/branding/:projectId",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx(BM,{})})})}),a.jsx(We,{path:"/business-plan/:projectId",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx($M,{})})})}),a.jsx(We,{path:"/pitch-deck/:projectId",element:a.jsx(ot,{children:a.jsx(UM,{})})}),a.jsx(We,{path:"/pitch-deck-old/:projectId",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx(zM,{})})})}),a.jsx(We,{path:"/tasks/:projectId",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx(WM,{})})})}),a.jsx(We,{path:"/team/:id",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx(VM,{})})})}),a.jsx(We,{path:"/profile",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx(YM,{})})})}),a.jsx(We,{path:"/entreprise/produits-solutions",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx(GM,{})})})}),a.jsx(We,{path:"/produit/demo/:slug",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx(hL,{})})})}),a.jsx(We,{path:"/mes-offres",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx(KM,{})})})}),a.jsx(We,{path:"/comptabilite",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx(iL,{})})})}),a.jsx(We,{path:"/comptabilite/transactions",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx(oL,{})})})}),a.jsx(We,{path:"/comptabilite/bilan",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx(lL,{})})})}),a.jsx(We,{path:"/comptabilite/tva",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx(cL,{})})})}),a.jsx(We,{path:"/comptabilite/export",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx(uL,{})})})}),a.jsx(We,{path:"/comptabilite/shared/:token",element:a.jsx(dL,{})}),a.jsx(We,{path:"/rh/employes",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx(pL,{})})})}),a.jsx(We,{path:"/rh/fiches-paie",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx(fL,{})})})}),a.jsx(We,{path:"/rh/cnss",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx(mL,{})})})}),a.jsx(We,{path:"/rh/conges",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx(xL,{})})})}),a.jsx(We,{path:"/rh/contrats",element:a.jsx(ot,{children:a.jsx(dt,{children:a.jsx(gL,{})})})}),a.jsx(We,{path:"/admin/login",element:a.jsx(ZM,{})}),a.jsx(We,{path:"/admin",element:a.jsx(So,{children:a.jsx(eL,{})})}),a.jsx(We,{path:"/admin/users",element:a.jsx(So,{children:a.jsx(nL,{})})}),a.jsx(We,{path:"/admin/payments",element:a.jsx(So,{children:a.jsx(rL,{})})}),a.jsx(We,{path:"/admin/projects",element:a.jsx(So,{children:a.jsx(aL,{})})}),a.jsx(We,{path:"/admin/products",element:a.jsx(So,{children:a.jsx(sL,{})})})]})]})}$h.createRoot(document.getElementById("root")).render(a.jsx(Vu.StrictMode,{children:a.jsx(vL,{})}))});export default yL();
