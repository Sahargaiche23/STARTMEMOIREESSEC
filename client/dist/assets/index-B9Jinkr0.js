var mk=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var B6=mk((iO,QC)=>{function vk(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const o=Object.getOwnPropertyDescriptor(r,a);o&&Object.defineProperty(e,a,o.get?o:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();function p1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var m1={exports:{}},kc={},v1={exports:{}},$e={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nl=Symbol.for("react.element"),gk=Symbol.for("react.portal"),xk=Symbol.for("react.fragment"),yk=Symbol.for("react.strict_mode"),bk=Symbol.for("react.profiler"),wk=Symbol.for("react.provider"),Nk=Symbol.for("react.context"),Ck=Symbol.for("react.forward_ref"),kk=Symbol.for("react.suspense"),jk=Symbol.for("react.memo"),Sk=Symbol.for("react.lazy"),d0=Symbol.iterator;function Ek(e){return e===null||typeof e!="object"?null:(e=d0&&e[d0]||e["@@iterator"],typeof e=="function"?e:null)}var g1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x1=Object.assign,y1={};function Ui(e,t,n){this.props=e,this.context=t,this.refs=y1,this.updater=n||g1}Ui.prototype.isReactComponent={};Ui.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ui.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function b1(){}b1.prototype=Ui.prototype;function Yf(e,t,n){this.props=e,this.context=t,this.refs=y1,this.updater=n||g1}var Qf=Yf.prototype=new b1;Qf.constructor=Yf;x1(Qf,Ui.prototype);Qf.isPureReactComponent=!0;var h0=Array.isArray,w1=Object.prototype.hasOwnProperty,Jf={current:null},N1={key:!0,ref:!0,__self:!0,__source:!0};function C1(e,t,n){var r,a={},o=null,i=null;if(t!=null)for(r in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(o=""+t.key),t)w1.call(t,r)&&!N1.hasOwnProperty(r)&&(a[r]=t[r]);var s=arguments.length-2;if(s===1)a.children=n;else if(1<s){for(var l=Array(s),c=0;c<s;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(r in s=e.defaultProps,s)a[r]===void 0&&(a[r]=s[r]);return{$$typeof:nl,type:e,key:o,ref:i,props:a,_owner:Jf.current}}function _k(e,t){return{$$typeof:nl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Zf(e){return typeof e=="object"&&e!==null&&e.$$typeof===nl}function Rk(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var f0=/\/+/g;function md(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Rk(""+e.key):t.toString(36)}function iu(e,t,n,r,a){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case nl:case gk:i=!0}}if(i)return i=e,a=a(i),e=r===""?"."+md(i,0):r,h0(a)?(n="",e!=null&&(n=e.replace(f0,"$&/")+"/"),iu(a,t,n,"",function(c){return c})):a!=null&&(Zf(a)&&(a=_k(a,n+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(f0,"$&/")+"/")+e)),t.push(a)),1;if(i=0,r=r===""?".":r+":",h0(e))for(var s=0;s<e.length;s++){o=e[s];var l=r+md(o,s);i+=iu(o,t,n,l,a)}else if(l=Ek(e),typeof l=="function")for(e=l.call(e),s=0;!(o=e.next()).done;)o=o.value,l=r+md(o,s++),i+=iu(o,t,n,l,a);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function Sl(e,t,n){if(e==null)return e;var r=[],a=0;return iu(e,r,"","",function(o){return t.call(n,o,a++)}),r}function Ik(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var cn={current:null},su={transition:null},Ak={ReactCurrentDispatcher:cn,ReactCurrentBatchConfig:su,ReactCurrentOwner:Jf};function k1(){throw Error("act(...) is not supported in production builds of React.")}$e.Children={map:Sl,forEach:function(e,t,n){Sl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Sl(e,function(){t++}),t},toArray:function(e){return Sl(e,function(t){return t})||[]},only:function(e){if(!Zf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};$e.Component=Ui;$e.Fragment=xk;$e.Profiler=bk;$e.PureComponent=Yf;$e.StrictMode=yk;$e.Suspense=kk;$e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ak;$e.act=k1;$e.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=x1({},e.props),a=e.key,o=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,i=Jf.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(l in t)w1.call(t,l)&&!N1.hasOwnProperty(l)&&(r[l]=t[l]===void 0&&s!==void 0?s[l]:t[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){s=Array(l);for(var c=0;c<l;c++)s[c]=arguments[c+2];r.children=s}return{$$typeof:nl,type:e.type,key:a,ref:o,props:r,_owner:i}};$e.createContext=function(e){return e={$$typeof:Nk,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:wk,_context:e},e.Consumer=e};$e.createElement=C1;$e.createFactory=function(e){var t=C1.bind(null,e);return t.type=e,t};$e.createRef=function(){return{current:null}};$e.forwardRef=function(e){return{$$typeof:Ck,render:e}};$e.isValidElement=Zf;$e.lazy=function(e){return{$$typeof:Sk,_payload:{_status:-1,_result:e},_init:Ik}};$e.memo=function(e,t){return{$$typeof:jk,type:e,compare:t===void 0?null:t}};$e.startTransition=function(e){var t=su.transition;su.transition={};try{e()}finally{su.transition=t}};$e.unstable_act=k1;$e.useCallback=function(e,t){return cn.current.useCallback(e,t)};$e.useContext=function(e){return cn.current.useContext(e)};$e.useDebugValue=function(){};$e.useDeferredValue=function(e){return cn.current.useDeferredValue(e)};$e.useEffect=function(e,t){return cn.current.useEffect(e,t)};$e.useId=function(){return cn.current.useId()};$e.useImperativeHandle=function(e,t,n){return cn.current.useImperativeHandle(e,t,n)};$e.useInsertionEffect=function(e,t){return cn.current.useInsertionEffect(e,t)};$e.useLayoutEffect=function(e,t){return cn.current.useLayoutEffect(e,t)};$e.useMemo=function(e,t){return cn.current.useMemo(e,t)};$e.useReducer=function(e,t,n){return cn.current.useReducer(e,t,n)};$e.useRef=function(e){return cn.current.useRef(e)};$e.useState=function(e){return cn.current.useState(e)};$e.useSyncExternalStore=function(e,t,n){return cn.current.useSyncExternalStore(e,t,n)};$e.useTransition=function(){return cn.current.useTransition()};$e.version="18.3.1";v1.exports=$e;var I=v1.exports;const jc=p1(I),Dk=vk({__proto__:null,default:jc},[I]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tk=I,Pk=Symbol.for("react.element"),Fk=Symbol.for("react.fragment"),Mk=Object.prototype.hasOwnProperty,Ok=Tk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Lk={key:!0,ref:!0,__self:!0,__source:!0};function j1(e,t,n){var r,a={},o=null,i=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(i=t.ref);for(r in t)Mk.call(t,r)&&!Lk.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:Pk,type:e,key:o,ref:i,props:a,_owner:Ok.current}}kc.Fragment=Fk;kc.jsx=j1;kc.jsxs=j1;m1.exports=kc;var u=m1.exports,bh={},S1={exports:{}},Mn={},E1={exports:{}},_1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(M,U){var H=M.length;M.push(U);e:for(;0<H;){var Z=H-1>>>1,ne=M[Z];if(0<a(ne,U))M[Z]=U,M[H]=ne,H=Z;else break e}}function n(M){return M.length===0?null:M[0]}function r(M){if(M.length===0)return null;var U=M[0],H=M.pop();if(H!==U){M[0]=H;e:for(var Z=0,ne=M.length,ue=ne>>>1;Z<ue;){var he=2*(Z+1)-1,ye=M[he],we=he+1,ke=M[we];if(0>a(ye,H))we<ne&&0>a(ke,ye)?(M[Z]=ke,M[we]=H,Z=we):(M[Z]=ye,M[he]=H,Z=he);else if(we<ne&&0>a(ke,H))M[Z]=ke,M[we]=H,Z=we;else break e}}return U}function a(M,U){var H=M.sortIndex-U.sortIndex;return H!==0?H:M.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var i=Date,s=i.now();e.unstable_now=function(){return i.now()-s}}var l=[],c=[],d=1,h=null,f=3,p=!1,v=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(M){for(var U=n(c);U!==null;){if(U.callback===null)r(c);else if(U.startTime<=M)r(c),U.sortIndex=U.expirationTime,t(l,U);else break;U=n(c)}}function w(M){if(g=!1,b(M),!v)if(n(l)!==null)v=!0,K(N);else{var U=n(c);U!==null&&z(w,U.startTime-M)}}function N(M,U){v=!1,g&&(g=!1,m(k),k=-1),p=!0;var H=f;try{for(b(U),h=n(l);h!==null&&(!(h.expirationTime>U)||M&&!j());){var Z=h.callback;if(typeof Z=="function"){h.callback=null,f=h.priorityLevel;var ne=Z(h.expirationTime<=U);U=e.unstable_now(),typeof ne=="function"?h.callback=ne:h===n(l)&&r(l),b(U)}else r(l);h=n(l)}if(h!==null)var ue=!0;else{var he=n(c);he!==null&&z(w,he.startTime-U),ue=!1}return ue}finally{h=null,f=H,p=!1}}var C=!1,S=null,k=-1,_=5,E=-1;function j(){return!(e.unstable_now()-E<_)}function T(){if(S!==null){var M=e.unstable_now();E=M;var U=!0;try{U=S(!0,M)}finally{U?L():(C=!1,S=null)}}else C=!1}var L;if(typeof x=="function")L=function(){x(T)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,B=P.port2;P.port1.onmessage=T,L=function(){B.postMessage(null)}}else L=function(){y(T,0)};function K(M){S=M,C||(C=!0,L())}function z(M,U){k=y(function(){M(e.unstable_now())},U)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(M){M.callback=null},e.unstable_continueExecution=function(){v||p||(v=!0,K(N))},e.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<M?Math.floor(1e3/M):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(M){switch(f){case 1:case 2:case 3:var U=3;break;default:U=f}var H=f;f=U;try{return M()}finally{f=H}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(M,U){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var H=f;f=M;try{return U()}finally{f=H}},e.unstable_scheduleCallback=function(M,U,H){var Z=e.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?Z+H:Z):H=Z,M){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=H+ne,M={id:d++,callback:U,priorityLevel:M,startTime:H,expirationTime:ne,sortIndex:-1},H>Z?(M.sortIndex=H,t(c,M),n(l)===null&&M===n(c)&&(g?(m(k),k=-1):g=!0,z(w,H-Z))):(M.sortIndex=ne,t(l,M),v||p||(v=!0,K(N))),M},e.unstable_shouldYield=j,e.unstable_wrapCallback=function(M){var U=f;return function(){var H=f;f=U;try{return M.apply(this,arguments)}finally{f=H}}}})(_1);E1.exports=_1;var Bk=E1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zk=I,Fn=Bk;function re(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var R1=new Set,Rs={};function Ao(e,t){Ci(e,t),Ci(e+"Capture",t)}function Ci(e,t){for(Rs[e]=t,e=0;e<t.length;e++)R1.add(t[e])}var Xr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wh=Object.prototype.hasOwnProperty,$k=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p0={},m0={};function Uk(e){return wh.call(m0,e)?!0:wh.call(p0,e)?!1:$k.test(e)?m0[e]=!0:(p0[e]=!0,!1)}function Wk(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Vk(e,t,n,r){if(t===null||typeof t>"u"||Wk(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function dn(e,t,n,r,a,o,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=i}var qt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){qt[e]=new dn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];qt[t]=new dn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){qt[e]=new dn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){qt[e]=new dn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){qt[e]=new dn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){qt[e]=new dn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){qt[e]=new dn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){qt[e]=new dn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){qt[e]=new dn(e,5,!1,e.toLowerCase(),null,!1,!1)});var ep=/[\-:]([a-z])/g;function tp(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(ep,tp);qt[t]=new dn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(ep,tp);qt[t]=new dn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(ep,tp);qt[t]=new dn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){qt[e]=new dn(e,1,!1,e.toLowerCase(),null,!1,!1)});qt.xlinkHref=new dn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){qt[e]=new dn(e,1,!1,e.toLowerCase(),null,!0,!0)});function np(e,t,n,r){var a=qt.hasOwnProperty(t)?qt[t]:null;(a!==null?a.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Vk(t,n,a,r)&&(n=null),r||a===null?Uk(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,r=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var na=zk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,El=Symbol.for("react.element"),Xo=Symbol.for("react.portal"),Yo=Symbol.for("react.fragment"),rp=Symbol.for("react.strict_mode"),Nh=Symbol.for("react.profiler"),I1=Symbol.for("react.provider"),A1=Symbol.for("react.context"),ap=Symbol.for("react.forward_ref"),Ch=Symbol.for("react.suspense"),kh=Symbol.for("react.suspense_list"),op=Symbol.for("react.memo"),va=Symbol.for("react.lazy"),D1=Symbol.for("react.offscreen"),v0=Symbol.iterator;function es(e){return e===null||typeof e!="object"?null:(e=v0&&e[v0]||e["@@iterator"],typeof e=="function"?e:null)}var ut=Object.assign,vd;function fs(e){if(vd===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);vd=t&&t[1]||""}return`
`+vd+e}var gd=!1;function xd(e,t){if(!e||gd)return"";gd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),o=r.stack.split(`
`),i=a.length-1,s=o.length-1;1<=i&&0<=s&&a[i]!==o[s];)s--;for(;1<=i&&0<=s;i--,s--)if(a[i]!==o[s]){if(i!==1||s!==1)do if(i--,s--,0>s||a[i]!==o[s]){var l=`
`+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=s);break}}}finally{gd=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?fs(e):""}function Hk(e){switch(e.tag){case 5:return fs(e.type);case 16:return fs("Lazy");case 13:return fs("Suspense");case 19:return fs("SuspenseList");case 0:case 2:case 15:return e=xd(e.type,!1),e;case 11:return e=xd(e.type.render,!1),e;case 1:return e=xd(e.type,!0),e;default:return""}}function jh(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Yo:return"Fragment";case Xo:return"Portal";case Nh:return"Profiler";case rp:return"StrictMode";case Ch:return"Suspense";case kh:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case A1:return(e.displayName||"Context")+".Consumer";case I1:return(e._context.displayName||"Context")+".Provider";case ap:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case op:return t=e.displayName||null,t!==null?t:jh(e.type)||"Memo";case va:t=e._payload,e=e._init;try{return jh(e(t))}catch{}}return null}function Gk(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return jh(t);case 8:return t===rp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function za(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function T1(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function qk(e){var t=T1(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){r=""+i,o.call(this,i)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function _l(e){e._valueTracker||(e._valueTracker=qk(e))}function P1(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=T1(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function ku(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Sh(e,t){var n=t.checked;return ut({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function g0(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=za(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function F1(e,t){t=t.checked,t!=null&&np(e,"checked",t,!1)}function Eh(e,t){F1(e,t);var n=za(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?_h(e,t.type,n):t.hasOwnProperty("defaultValue")&&_h(e,t.type,za(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function x0(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function _h(e,t,n){(t!=="number"||ku(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var ps=Array.isArray;function si(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+za(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,r&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Rh(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(re(91));return ut({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function y0(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(re(92));if(ps(n)){if(1<n.length)throw Error(re(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:za(n)}}function M1(e,t){var n=za(t.value),r=za(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function b0(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function O1(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ih(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?O1(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Rl,L1=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Rl=Rl||document.createElement("div"),Rl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Rl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Is(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var gs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Kk=["Webkit","ms","Moz","O"];Object.keys(gs).forEach(function(e){Kk.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),gs[t]=gs[e]})});function B1(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||gs.hasOwnProperty(e)&&gs[e]?(""+t).trim():t+"px"}function z1(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=B1(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}var Xk=ut({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ah(e,t){if(t){if(Xk[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(re(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(re(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(re(61))}if(t.style!=null&&typeof t.style!="object")throw Error(re(62))}}function Dh(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Th=null;function ip(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ph=null,li=null,ui=null;function w0(e){if(e=ol(e)){if(typeof Ph!="function")throw Error(re(280));var t=e.stateNode;t&&(t=Ic(t),Ph(e.stateNode,e.type,t))}}function $1(e){li?ui?ui.push(e):ui=[e]:li=e}function U1(){if(li){var e=li,t=ui;if(ui=li=null,w0(e),t)for(e=0;e<t.length;e++)w0(t[e])}}function W1(e,t){return e(t)}function V1(){}var yd=!1;function H1(e,t,n){if(yd)return e(t,n);yd=!0;try{return W1(e,t,n)}finally{yd=!1,(li!==null||ui!==null)&&(V1(),U1())}}function As(e,t){var n=e.stateNode;if(n===null)return null;var r=Ic(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(re(231,t,typeof n));return n}var Fh=!1;if(Xr)try{var ts={};Object.defineProperty(ts,"passive",{get:function(){Fh=!0}}),window.addEventListener("test",ts,ts),window.removeEventListener("test",ts,ts)}catch{Fh=!1}function Yk(e,t,n,r,a,o,i,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(d){this.onError(d)}}var xs=!1,ju=null,Su=!1,Mh=null,Qk={onError:function(e){xs=!0,ju=e}};function Jk(e,t,n,r,a,o,i,s,l){xs=!1,ju=null,Yk.apply(Qk,arguments)}function Zk(e,t,n,r,a,o,i,s,l){if(Jk.apply(this,arguments),xs){if(xs){var c=ju;xs=!1,ju=null}else throw Error(re(198));Su||(Su=!0,Mh=c)}}function Do(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function G1(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function N0(e){if(Do(e)!==e)throw Error(re(188))}function ej(e){var t=e.alternate;if(!t){if(t=Do(e),t===null)throw Error(re(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(a===null)break;var o=a.alternate;if(o===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return N0(a),e;if(o===r)return N0(a),t;o=o.sibling}throw Error(re(188))}if(n.return!==r.return)n=a,r=o;else{for(var i=!1,s=a.child;s;){if(s===n){i=!0,n=a,r=o;break}if(s===r){i=!0,r=a,n=o;break}s=s.sibling}if(!i){for(s=o.child;s;){if(s===n){i=!0,n=o,r=a;break}if(s===r){i=!0,r=o,n=a;break}s=s.sibling}if(!i)throw Error(re(189))}}if(n.alternate!==r)throw Error(re(190))}if(n.tag!==3)throw Error(re(188));return n.stateNode.current===n?e:t}function q1(e){return e=ej(e),e!==null?K1(e):null}function K1(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=K1(e);if(t!==null)return t;e=e.sibling}return null}var X1=Fn.unstable_scheduleCallback,C0=Fn.unstable_cancelCallback,tj=Fn.unstable_shouldYield,nj=Fn.unstable_requestPaint,vt=Fn.unstable_now,rj=Fn.unstable_getCurrentPriorityLevel,sp=Fn.unstable_ImmediatePriority,Y1=Fn.unstable_UserBlockingPriority,Eu=Fn.unstable_NormalPriority,aj=Fn.unstable_LowPriority,Q1=Fn.unstable_IdlePriority,Sc=null,jr=null;function oj(e){if(jr&&typeof jr.onCommitFiberRoot=="function")try{jr.onCommitFiberRoot(Sc,e,void 0,(e.current.flags&128)===128)}catch{}}var rr=Math.clz32?Math.clz32:lj,ij=Math.log,sj=Math.LN2;function lj(e){return e>>>=0,e===0?32:31-(ij(e)/sj|0)|0}var Il=64,Al=4194304;function ms(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function _u(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,a=e.suspendedLanes,o=e.pingedLanes,i=n&268435455;if(i!==0){var s=i&~a;s!==0?r=ms(s):(o&=i,o!==0&&(r=ms(o)))}else i=n&~a,i!==0?r=ms(i):o!==0&&(r=ms(o));if(r===0)return 0;if(t!==0&&t!==r&&!(t&a)&&(a=r&-r,o=t&-t,a>=o||a===16&&(o&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-rr(t),a=1<<n,r|=e[n],t&=~a;return r}function uj(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function cj(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,o=e.pendingLanes;0<o;){var i=31-rr(o),s=1<<i,l=a[i];l===-1?(!(s&n)||s&r)&&(a[i]=uj(s,t)):l<=t&&(e.expiredLanes|=s),o&=~s}}function Oh(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function J1(){var e=Il;return Il<<=1,!(Il&4194240)&&(Il=64),e}function bd(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function rl(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-rr(t),e[t]=n}function dj(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-rr(n),o=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~o}}function lp(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-rr(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var qe=0;function Z1(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var eb,up,tb,nb,rb,Lh=!1,Dl=[],Ea=null,_a=null,Ra=null,Ds=new Map,Ts=new Map,xa=[],hj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function k0(e,t){switch(e){case"focusin":case"focusout":Ea=null;break;case"dragenter":case"dragleave":_a=null;break;case"mouseover":case"mouseout":Ra=null;break;case"pointerover":case"pointerout":Ds.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ts.delete(t.pointerId)}}function ns(e,t,n,r,a,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[a]},t!==null&&(t=ol(t),t!==null&&up(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function fj(e,t,n,r,a){switch(t){case"focusin":return Ea=ns(Ea,e,t,n,r,a),!0;case"dragenter":return _a=ns(_a,e,t,n,r,a),!0;case"mouseover":return Ra=ns(Ra,e,t,n,r,a),!0;case"pointerover":var o=a.pointerId;return Ds.set(o,ns(Ds.get(o)||null,e,t,n,r,a)),!0;case"gotpointercapture":return o=a.pointerId,Ts.set(o,ns(Ts.get(o)||null,e,t,n,r,a)),!0}return!1}function ab(e){var t=lo(e.target);if(t!==null){var n=Do(t);if(n!==null){if(t=n.tag,t===13){if(t=G1(n),t!==null){e.blockedOn=t,rb(e.priority,function(){tb(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function lu(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Bh(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Th=r,n.target.dispatchEvent(r),Th=null}else return t=ol(n),t!==null&&up(t),e.blockedOn=n,!1;t.shift()}return!0}function j0(e,t,n){lu(e)&&n.delete(t)}function pj(){Lh=!1,Ea!==null&&lu(Ea)&&(Ea=null),_a!==null&&lu(_a)&&(_a=null),Ra!==null&&lu(Ra)&&(Ra=null),Ds.forEach(j0),Ts.forEach(j0)}function rs(e,t){e.blockedOn===t&&(e.blockedOn=null,Lh||(Lh=!0,Fn.unstable_scheduleCallback(Fn.unstable_NormalPriority,pj)))}function Ps(e){function t(a){return rs(a,e)}if(0<Dl.length){rs(Dl[0],e);for(var n=1;n<Dl.length;n++){var r=Dl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Ea!==null&&rs(Ea,e),_a!==null&&rs(_a,e),Ra!==null&&rs(Ra,e),Ds.forEach(t),Ts.forEach(t),n=0;n<xa.length;n++)r=xa[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<xa.length&&(n=xa[0],n.blockedOn===null);)ab(n),n.blockedOn===null&&xa.shift()}var ci=na.ReactCurrentBatchConfig,Ru=!0;function mj(e,t,n,r){var a=qe,o=ci.transition;ci.transition=null;try{qe=1,cp(e,t,n,r)}finally{qe=a,ci.transition=o}}function vj(e,t,n,r){var a=qe,o=ci.transition;ci.transition=null;try{qe=4,cp(e,t,n,r)}finally{qe=a,ci.transition=o}}function cp(e,t,n,r){if(Ru){var a=Bh(e,t,n,r);if(a===null)Id(e,t,r,Iu,n),k0(e,r);else if(fj(a,e,t,n,r))r.stopPropagation();else if(k0(e,r),t&4&&-1<hj.indexOf(e)){for(;a!==null;){var o=ol(a);if(o!==null&&eb(o),o=Bh(e,t,n,r),o===null&&Id(e,t,r,Iu,n),o===a)break;a=o}a!==null&&r.stopPropagation()}else Id(e,t,r,null,n)}}var Iu=null;function Bh(e,t,n,r){if(Iu=null,e=ip(r),e=lo(e),e!==null)if(t=Do(e),t===null)e=null;else if(n=t.tag,n===13){if(e=G1(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Iu=e,null}function ob(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(rj()){case sp:return 1;case Y1:return 4;case Eu:case aj:return 16;case Q1:return 536870912;default:return 16}default:return 16}}var wa=null,dp=null,uu=null;function ib(){if(uu)return uu;var e,t=dp,n=t.length,r,a="value"in wa?wa.value:wa.textContent,o=a.length;for(e=0;e<n&&t[e]===a[e];e++);var i=n-e;for(r=1;r<=i&&t[n-r]===a[o-r];r++);return uu=a.slice(e,1<r?1-r:void 0)}function cu(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Tl(){return!0}function S0(){return!1}function On(e){function t(n,r,a,o,i){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(n=e[s],this[s]=n?n(o):o[s]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Tl:S0,this.isPropagationStopped=S0,this}return ut(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Tl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Tl)},persist:function(){},isPersistent:Tl}),t}var Wi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hp=On(Wi),al=ut({},Wi,{view:0,detail:0}),gj=On(al),wd,Nd,as,Ec=ut({},al,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fp,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==as&&(as&&e.type==="mousemove"?(wd=e.screenX-as.screenX,Nd=e.screenY-as.screenY):Nd=wd=0,as=e),wd)},movementY:function(e){return"movementY"in e?e.movementY:Nd}}),E0=On(Ec),xj=ut({},Ec,{dataTransfer:0}),yj=On(xj),bj=ut({},al,{relatedTarget:0}),Cd=On(bj),wj=ut({},Wi,{animationName:0,elapsedTime:0,pseudoElement:0}),Nj=On(wj),Cj=ut({},Wi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),kj=On(Cj),jj=ut({},Wi,{data:0}),_0=On(jj),Sj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ej={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_j={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rj(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=_j[e])?!!t[e]:!1}function fp(){return Rj}var Ij=ut({},al,{key:function(e){if(e.key){var t=Sj[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=cu(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Ej[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fp,charCode:function(e){return e.type==="keypress"?cu(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?cu(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Aj=On(Ij),Dj=ut({},Ec,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),R0=On(Dj),Tj=ut({},al,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fp}),Pj=On(Tj),Fj=ut({},Wi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Mj=On(Fj),Oj=ut({},Ec,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Lj=On(Oj),Bj=[9,13,27,32],pp=Xr&&"CompositionEvent"in window,ys=null;Xr&&"documentMode"in document&&(ys=document.documentMode);var zj=Xr&&"TextEvent"in window&&!ys,sb=Xr&&(!pp||ys&&8<ys&&11>=ys),I0=" ",A0=!1;function lb(e,t){switch(e){case"keyup":return Bj.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ub(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Qo=!1;function $j(e,t){switch(e){case"compositionend":return ub(t);case"keypress":return t.which!==32?null:(A0=!0,I0);case"textInput":return e=t.data,e===I0&&A0?null:e;default:return null}}function Uj(e,t){if(Qo)return e==="compositionend"||!pp&&lb(e,t)?(e=ib(),uu=dp=wa=null,Qo=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return sb&&t.locale!=="ko"?null:t.data;default:return null}}var Wj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function D0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Wj[e.type]:t==="textarea"}function cb(e,t,n,r){$1(r),t=Au(t,"onChange"),0<t.length&&(n=new hp("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var bs=null,Fs=null;function Vj(e){wb(e,0)}function _c(e){var t=ei(e);if(P1(t))return e}function Hj(e,t){if(e==="change")return t}var db=!1;if(Xr){var kd;if(Xr){var jd="oninput"in document;if(!jd){var T0=document.createElement("div");T0.setAttribute("oninput","return;"),jd=typeof T0.oninput=="function"}kd=jd}else kd=!1;db=kd&&(!document.documentMode||9<document.documentMode)}function P0(){bs&&(bs.detachEvent("onpropertychange",hb),Fs=bs=null)}function hb(e){if(e.propertyName==="value"&&_c(Fs)){var t=[];cb(t,Fs,e,ip(e)),H1(Vj,t)}}function Gj(e,t,n){e==="focusin"?(P0(),bs=t,Fs=n,bs.attachEvent("onpropertychange",hb)):e==="focusout"&&P0()}function qj(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return _c(Fs)}function Kj(e,t){if(e==="click")return _c(t)}function Xj(e,t){if(e==="input"||e==="change")return _c(t)}function Yj(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ir=typeof Object.is=="function"?Object.is:Yj;function Ms(e,t){if(ir(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!wh.call(t,a)||!ir(e[a],t[a]))return!1}return!0}function F0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function M0(e,t){var n=F0(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=F0(n)}}function fb(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?fb(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function pb(){for(var e=window,t=ku();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=ku(e.document)}return t}function mp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Qj(e){var t=pb(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&fb(n.ownerDocument.documentElement,n)){if(r!==null&&mp(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,o=Math.min(r.start,a);r=r.end===void 0?o:Math.min(r.end,a),!e.extend&&o>r&&(a=r,r=o,o=a),a=M0(n,o);var i=M0(n,r);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Jj=Xr&&"documentMode"in document&&11>=document.documentMode,Jo=null,zh=null,ws=null,$h=!1;function O0(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;$h||Jo==null||Jo!==ku(r)||(r=Jo,"selectionStart"in r&&mp(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ws&&Ms(ws,r)||(ws=r,r=Au(zh,"onSelect"),0<r.length&&(t=new hp("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Jo)))}function Pl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Zo={animationend:Pl("Animation","AnimationEnd"),animationiteration:Pl("Animation","AnimationIteration"),animationstart:Pl("Animation","AnimationStart"),transitionend:Pl("Transition","TransitionEnd")},Sd={},mb={};Xr&&(mb=document.createElement("div").style,"AnimationEvent"in window||(delete Zo.animationend.animation,delete Zo.animationiteration.animation,delete Zo.animationstart.animation),"TransitionEvent"in window||delete Zo.transitionend.transition);function Rc(e){if(Sd[e])return Sd[e];if(!Zo[e])return e;var t=Zo[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in mb)return Sd[e]=t[n];return e}var vb=Rc("animationend"),gb=Rc("animationiteration"),xb=Rc("animationstart"),yb=Rc("transitionend"),bb=new Map,L0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ha(e,t){bb.set(e,t),Ao(t,[e])}for(var Ed=0;Ed<L0.length;Ed++){var _d=L0[Ed],Zj=_d.toLowerCase(),eS=_d[0].toUpperCase()+_d.slice(1);Ha(Zj,"on"+eS)}Ha(vb,"onAnimationEnd");Ha(gb,"onAnimationIteration");Ha(xb,"onAnimationStart");Ha("dblclick","onDoubleClick");Ha("focusin","onFocus");Ha("focusout","onBlur");Ha(yb,"onTransitionEnd");Ci("onMouseEnter",["mouseout","mouseover"]);Ci("onMouseLeave",["mouseout","mouseover"]);Ci("onPointerEnter",["pointerout","pointerover"]);Ci("onPointerLeave",["pointerout","pointerover"]);Ao("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ao("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ao("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ao("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ao("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ao("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tS=new Set("cancel close invalid load scroll toggle".split(" ").concat(vs));function B0(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Zk(r,t,void 0,e),e.currentTarget=null}function wb(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var i=r.length-1;0<=i;i--){var s=r[i],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==o&&a.isPropagationStopped())break e;B0(a,s,c),o=l}else for(i=0;i<r.length;i++){if(s=r[i],l=s.instance,c=s.currentTarget,s=s.listener,l!==o&&a.isPropagationStopped())break e;B0(a,s,c),o=l}}}if(Su)throw e=Mh,Su=!1,Mh=null,e}function Ze(e,t){var n=t[Gh];n===void 0&&(n=t[Gh]=new Set);var r=e+"__bubble";n.has(r)||(Nb(t,e,2,!1),n.add(r))}function Rd(e,t,n){var r=0;t&&(r|=4),Nb(n,e,r,t)}var Fl="_reactListening"+Math.random().toString(36).slice(2);function Os(e){if(!e[Fl]){e[Fl]=!0,R1.forEach(function(n){n!=="selectionchange"&&(tS.has(n)||Rd(n,!1,e),Rd(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Fl]||(t[Fl]=!0,Rd("selectionchange",!1,t))}}function Nb(e,t,n,r){switch(ob(t)){case 1:var a=mj;break;case 4:a=vj;break;default:a=cp}n=a.bind(null,t,n,e),a=void 0,!Fh||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),r?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Id(e,t,n,r,a){var o=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var s=r.stateNode.containerInfo;if(s===a||s.nodeType===8&&s.parentNode===a)break;if(i===4)for(i=r.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;i=i.return}for(;s!==null;){if(i=lo(s),i===null)return;if(l=i.tag,l===5||l===6){r=o=i;continue e}s=s.parentNode}}r=r.return}H1(function(){var c=o,d=ip(n),h=[];e:{var f=bb.get(e);if(f!==void 0){var p=hp,v=e;switch(e){case"keypress":if(cu(n)===0)break e;case"keydown":case"keyup":p=Aj;break;case"focusin":v="focus",p=Cd;break;case"focusout":v="blur",p=Cd;break;case"beforeblur":case"afterblur":p=Cd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=E0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=yj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=Pj;break;case vb:case gb:case xb:p=Nj;break;case yb:p=Mj;break;case"scroll":p=gj;break;case"wheel":p=Lj;break;case"copy":case"cut":case"paste":p=kj;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=R0}var g=(t&4)!==0,y=!g&&e==="scroll",m=g?f!==null?f+"Capture":null:f;g=[];for(var x=c,b;x!==null;){b=x;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,m!==null&&(w=As(x,m),w!=null&&g.push(Ls(x,w,b)))),y)break;x=x.return}0<g.length&&(f=new p(f,v,null,n,d),h.push({event:f,listeners:g}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",f&&n!==Th&&(v=n.relatedTarget||n.fromElement)&&(lo(v)||v[Yr]))break e;if((p||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,p?(v=n.relatedTarget||n.toElement,p=c,v=v?lo(v):null,v!==null&&(y=Do(v),v!==y||v.tag!==5&&v.tag!==6)&&(v=null)):(p=null,v=c),p!==v)){if(g=E0,w="onMouseLeave",m="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(g=R0,w="onPointerLeave",m="onPointerEnter",x="pointer"),y=p==null?f:ei(p),b=v==null?f:ei(v),f=new g(w,x+"leave",p,n,d),f.target=y,f.relatedTarget=b,w=null,lo(d)===c&&(g=new g(m,x+"enter",v,n,d),g.target=b,g.relatedTarget=y,w=g),y=w,p&&v)t:{for(g=p,m=v,x=0,b=g;b;b=zo(b))x++;for(b=0,w=m;w;w=zo(w))b++;for(;0<x-b;)g=zo(g),x--;for(;0<b-x;)m=zo(m),b--;for(;x--;){if(g===m||m!==null&&g===m.alternate)break t;g=zo(g),m=zo(m)}g=null}else g=null;p!==null&&z0(h,f,p,g,!1),v!==null&&y!==null&&z0(h,y,v,g,!0)}}e:{if(f=c?ei(c):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var N=Hj;else if(D0(f))if(db)N=Xj;else{N=qj;var C=Gj}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(N=Kj);if(N&&(N=N(e,c))){cb(h,N,n,d);break e}C&&C(e,f,c),e==="focusout"&&(C=f._wrapperState)&&C.controlled&&f.type==="number"&&_h(f,"number",f.value)}switch(C=c?ei(c):window,e){case"focusin":(D0(C)||C.contentEditable==="true")&&(Jo=C,zh=c,ws=null);break;case"focusout":ws=zh=Jo=null;break;case"mousedown":$h=!0;break;case"contextmenu":case"mouseup":case"dragend":$h=!1,O0(h,n,d);break;case"selectionchange":if(Jj)break;case"keydown":case"keyup":O0(h,n,d)}var S;if(pp)e:{switch(e){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Qo?lb(e,n)&&(k="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(sb&&n.locale!=="ko"&&(Qo||k!=="onCompositionStart"?k==="onCompositionEnd"&&Qo&&(S=ib()):(wa=d,dp="value"in wa?wa.value:wa.textContent,Qo=!0)),C=Au(c,k),0<C.length&&(k=new _0(k,e,null,n,d),h.push({event:k,listeners:C}),S?k.data=S:(S=ub(n),S!==null&&(k.data=S)))),(S=zj?$j(e,n):Uj(e,n))&&(c=Au(c,"onBeforeInput"),0<c.length&&(d=new _0("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:c}),d.data=S))}wb(h,t)})}function Ls(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Au(e,t){for(var n=t+"Capture",r=[];e!==null;){var a=e,o=a.stateNode;a.tag===5&&o!==null&&(a=o,o=As(e,n),o!=null&&r.unshift(Ls(e,o,a)),o=As(e,t),o!=null&&r.push(Ls(e,o,a))),e=e.return}return r}function zo(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function z0(e,t,n,r,a){for(var o=t._reactName,i=[];n!==null&&n!==r;){var s=n,l=s.alternate,c=s.stateNode;if(l!==null&&l===r)break;s.tag===5&&c!==null&&(s=c,a?(l=As(n,o),l!=null&&i.unshift(Ls(n,l,s))):a||(l=As(n,o),l!=null&&i.push(Ls(n,l,s)))),n=n.return}i.length!==0&&e.push({event:t,listeners:i})}var nS=/\r\n?/g,rS=/\u0000|\uFFFD/g;function $0(e){return(typeof e=="string"?e:""+e).replace(nS,`
`).replace(rS,"")}function Ml(e,t,n){if(t=$0(t),$0(e)!==t&&n)throw Error(re(425))}function Du(){}var Uh=null,Wh=null;function Vh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Hh=typeof setTimeout=="function"?setTimeout:void 0,aS=typeof clearTimeout=="function"?clearTimeout:void 0,U0=typeof Promise=="function"?Promise:void 0,oS=typeof queueMicrotask=="function"?queueMicrotask:typeof U0<"u"?function(e){return U0.resolve(null).then(e).catch(iS)}:Hh;function iS(e){setTimeout(function(){throw e})}function Ad(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){e.removeChild(a),Ps(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);Ps(t)}function Ia(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function W0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Vi=Math.random().toString(36).slice(2),yr="__reactFiber$"+Vi,Bs="__reactProps$"+Vi,Yr="__reactContainer$"+Vi,Gh="__reactEvents$"+Vi,sS="__reactListeners$"+Vi,lS="__reactHandles$"+Vi;function lo(e){var t=e[yr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Yr]||n[yr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=W0(e);e!==null;){if(n=e[yr])return n;e=W0(e)}return t}e=n,n=e.parentNode}return null}function ol(e){return e=e[yr]||e[Yr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ei(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(re(33))}function Ic(e){return e[Bs]||null}var qh=[],ti=-1;function Ga(e){return{current:e}}function tt(e){0>ti||(e.current=qh[ti],qh[ti]=null,ti--)}function Qe(e,t){ti++,qh[ti]=e.current,e.current=t}var $a={},rn=Ga($a),gn=Ga(!1),yo=$a;function ki(e,t){var n=e.type.contextTypes;if(!n)return $a;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a={},o;for(o in n)a[o]=t[o];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function xn(e){return e=e.childContextTypes,e!=null}function Tu(){tt(gn),tt(rn)}function V0(e,t,n){if(rn.current!==$a)throw Error(re(168));Qe(rn,t),Qe(gn,n)}function Cb(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in t))throw Error(re(108,Gk(e)||"Unknown",a));return ut({},n,r)}function Pu(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||$a,yo=rn.current,Qe(rn,e),Qe(gn,gn.current),!0}function H0(e,t,n){var r=e.stateNode;if(!r)throw Error(re(169));n?(e=Cb(e,t,yo),r.__reactInternalMemoizedMergedChildContext=e,tt(gn),tt(rn),Qe(rn,e)):tt(gn),Qe(gn,n)}var Wr=null,Ac=!1,Dd=!1;function kb(e){Wr===null?Wr=[e]:Wr.push(e)}function uS(e){Ac=!0,kb(e)}function qa(){if(!Dd&&Wr!==null){Dd=!0;var e=0,t=qe;try{var n=Wr;for(qe=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Wr=null,Ac=!1}catch(a){throw Wr!==null&&(Wr=Wr.slice(e+1)),X1(sp,qa),a}finally{qe=t,Dd=!1}}return null}var ni=[],ri=0,Fu=null,Mu=0,zn=[],$n=0,bo=null,Hr=1,Gr="";function ro(e,t){ni[ri++]=Mu,ni[ri++]=Fu,Fu=e,Mu=t}function jb(e,t,n){zn[$n++]=Hr,zn[$n++]=Gr,zn[$n++]=bo,bo=e;var r=Hr;e=Gr;var a=32-rr(r)-1;r&=~(1<<a),n+=1;var o=32-rr(t)+a;if(30<o){var i=a-a%5;o=(r&(1<<i)-1).toString(32),r>>=i,a-=i,Hr=1<<32-rr(t)+a|n<<a|r,Gr=o+e}else Hr=1<<o|n<<a|r,Gr=e}function vp(e){e.return!==null&&(ro(e,1),jb(e,1,0))}function gp(e){for(;e===Fu;)Fu=ni[--ri],ni[ri]=null,Mu=ni[--ri],ni[ri]=null;for(;e===bo;)bo=zn[--$n],zn[$n]=null,Gr=zn[--$n],zn[$n]=null,Hr=zn[--$n],zn[$n]=null}var Dn=null,_n=null,rt=!1,er=null;function Sb(e,t){var n=Vn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function G0(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Dn=e,_n=Ia(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Dn=e,_n=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=bo!==null?{id:Hr,overflow:Gr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Vn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Dn=e,_n=null,!0):!1;default:return!1}}function Kh(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Xh(e){if(rt){var t=_n;if(t){var n=t;if(!G0(e,t)){if(Kh(e))throw Error(re(418));t=Ia(n.nextSibling);var r=Dn;t&&G0(e,t)?Sb(r,n):(e.flags=e.flags&-4097|2,rt=!1,Dn=e)}}else{if(Kh(e))throw Error(re(418));e.flags=e.flags&-4097|2,rt=!1,Dn=e}}}function q0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Dn=e}function Ol(e){if(e!==Dn)return!1;if(!rt)return q0(e),rt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Vh(e.type,e.memoizedProps)),t&&(t=_n)){if(Kh(e))throw Eb(),Error(re(418));for(;t;)Sb(e,t),t=Ia(t.nextSibling)}if(q0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(re(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){_n=Ia(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}_n=null}}else _n=Dn?Ia(e.stateNode.nextSibling):null;return!0}function Eb(){for(var e=_n;e;)e=Ia(e.nextSibling)}function ji(){_n=Dn=null,rt=!1}function xp(e){er===null?er=[e]:er.push(e)}var cS=na.ReactCurrentBatchConfig;function os(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(re(309));var r=n.stateNode}if(!r)throw Error(re(147,e));var a=r,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(i){var s=a.refs;i===null?delete s[o]:s[o]=i},t._stringRef=o,t)}if(typeof e!="string")throw Error(re(284));if(!n._owner)throw Error(re(290,e))}return e}function Ll(e,t){throw e=Object.prototype.toString.call(t),Error(re(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function K0(e){var t=e._init;return t(e._payload)}function _b(e){function t(m,x){if(e){var b=m.deletions;b===null?(m.deletions=[x],m.flags|=16):b.push(x)}}function n(m,x){if(!e)return null;for(;x!==null;)t(m,x),x=x.sibling;return null}function r(m,x){for(m=new Map;x!==null;)x.key!==null?m.set(x.key,x):m.set(x.index,x),x=x.sibling;return m}function a(m,x){return m=Pa(m,x),m.index=0,m.sibling=null,m}function o(m,x,b){return m.index=b,e?(b=m.alternate,b!==null?(b=b.index,b<x?(m.flags|=2,x):b):(m.flags|=2,x)):(m.flags|=1048576,x)}function i(m){return e&&m.alternate===null&&(m.flags|=2),m}function s(m,x,b,w){return x===null||x.tag!==6?(x=Bd(b,m.mode,w),x.return=m,x):(x=a(x,b),x.return=m,x)}function l(m,x,b,w){var N=b.type;return N===Yo?d(m,x,b.props.children,w,b.key):x!==null&&(x.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===va&&K0(N)===x.type)?(w=a(x,b.props),w.ref=os(m,x,b),w.return=m,w):(w=gu(b.type,b.key,b.props,null,m.mode,w),w.ref=os(m,x,b),w.return=m,w)}function c(m,x,b,w){return x===null||x.tag!==4||x.stateNode.containerInfo!==b.containerInfo||x.stateNode.implementation!==b.implementation?(x=zd(b,m.mode,w),x.return=m,x):(x=a(x,b.children||[]),x.return=m,x)}function d(m,x,b,w,N){return x===null||x.tag!==7?(x=vo(b,m.mode,w,N),x.return=m,x):(x=a(x,b),x.return=m,x)}function h(m,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Bd(""+x,m.mode,b),x.return=m,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case El:return b=gu(x.type,x.key,x.props,null,m.mode,b),b.ref=os(m,null,x),b.return=m,b;case Xo:return x=zd(x,m.mode,b),x.return=m,x;case va:var w=x._init;return h(m,w(x._payload),b)}if(ps(x)||es(x))return x=vo(x,m.mode,b,null),x.return=m,x;Ll(m,x)}return null}function f(m,x,b,w){var N=x!==null?x.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return N!==null?null:s(m,x,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case El:return b.key===N?l(m,x,b,w):null;case Xo:return b.key===N?c(m,x,b,w):null;case va:return N=b._init,f(m,x,N(b._payload),w)}if(ps(b)||es(b))return N!==null?null:d(m,x,b,w,null);Ll(m,b)}return null}function p(m,x,b,w,N){if(typeof w=="string"&&w!==""||typeof w=="number")return m=m.get(b)||null,s(x,m,""+w,N);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case El:return m=m.get(w.key===null?b:w.key)||null,l(x,m,w,N);case Xo:return m=m.get(w.key===null?b:w.key)||null,c(x,m,w,N);case va:var C=w._init;return p(m,x,b,C(w._payload),N)}if(ps(w)||es(w))return m=m.get(b)||null,d(x,m,w,N,null);Ll(x,w)}return null}function v(m,x,b,w){for(var N=null,C=null,S=x,k=x=0,_=null;S!==null&&k<b.length;k++){S.index>k?(_=S,S=null):_=S.sibling;var E=f(m,S,b[k],w);if(E===null){S===null&&(S=_);break}e&&S&&E.alternate===null&&t(m,S),x=o(E,x,k),C===null?N=E:C.sibling=E,C=E,S=_}if(k===b.length)return n(m,S),rt&&ro(m,k),N;if(S===null){for(;k<b.length;k++)S=h(m,b[k],w),S!==null&&(x=o(S,x,k),C===null?N=S:C.sibling=S,C=S);return rt&&ro(m,k),N}for(S=r(m,S);k<b.length;k++)_=p(S,m,k,b[k],w),_!==null&&(e&&_.alternate!==null&&S.delete(_.key===null?k:_.key),x=o(_,x,k),C===null?N=_:C.sibling=_,C=_);return e&&S.forEach(function(j){return t(m,j)}),rt&&ro(m,k),N}function g(m,x,b,w){var N=es(b);if(typeof N!="function")throw Error(re(150));if(b=N.call(b),b==null)throw Error(re(151));for(var C=N=null,S=x,k=x=0,_=null,E=b.next();S!==null&&!E.done;k++,E=b.next()){S.index>k?(_=S,S=null):_=S.sibling;var j=f(m,S,E.value,w);if(j===null){S===null&&(S=_);break}e&&S&&j.alternate===null&&t(m,S),x=o(j,x,k),C===null?N=j:C.sibling=j,C=j,S=_}if(E.done)return n(m,S),rt&&ro(m,k),N;if(S===null){for(;!E.done;k++,E=b.next())E=h(m,E.value,w),E!==null&&(x=o(E,x,k),C===null?N=E:C.sibling=E,C=E);return rt&&ro(m,k),N}for(S=r(m,S);!E.done;k++,E=b.next())E=p(S,m,k,E.value,w),E!==null&&(e&&E.alternate!==null&&S.delete(E.key===null?k:E.key),x=o(E,x,k),C===null?N=E:C.sibling=E,C=E);return e&&S.forEach(function(T){return t(m,T)}),rt&&ro(m,k),N}function y(m,x,b,w){if(typeof b=="object"&&b!==null&&b.type===Yo&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case El:e:{for(var N=b.key,C=x;C!==null;){if(C.key===N){if(N=b.type,N===Yo){if(C.tag===7){n(m,C.sibling),x=a(C,b.props.children),x.return=m,m=x;break e}}else if(C.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===va&&K0(N)===C.type){n(m,C.sibling),x=a(C,b.props),x.ref=os(m,C,b),x.return=m,m=x;break e}n(m,C);break}else t(m,C);C=C.sibling}b.type===Yo?(x=vo(b.props.children,m.mode,w,b.key),x.return=m,m=x):(w=gu(b.type,b.key,b.props,null,m.mode,w),w.ref=os(m,x,b),w.return=m,m=w)}return i(m);case Xo:e:{for(C=b.key;x!==null;){if(x.key===C)if(x.tag===4&&x.stateNode.containerInfo===b.containerInfo&&x.stateNode.implementation===b.implementation){n(m,x.sibling),x=a(x,b.children||[]),x.return=m,m=x;break e}else{n(m,x);break}else t(m,x);x=x.sibling}x=zd(b,m.mode,w),x.return=m,m=x}return i(m);case va:return C=b._init,y(m,x,C(b._payload),w)}if(ps(b))return v(m,x,b,w);if(es(b))return g(m,x,b,w);Ll(m,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,x!==null&&x.tag===6?(n(m,x.sibling),x=a(x,b),x.return=m,m=x):(n(m,x),x=Bd(b,m.mode,w),x.return=m,m=x),i(m)):n(m,x)}return y}var Si=_b(!0),Rb=_b(!1),Ou=Ga(null),Lu=null,ai=null,yp=null;function bp(){yp=ai=Lu=null}function wp(e){var t=Ou.current;tt(Ou),e._currentValue=t}function Yh(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function di(e,t){Lu=e,yp=ai=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(vn=!0),e.firstContext=null)}function qn(e){var t=e._currentValue;if(yp!==e)if(e={context:e,memoizedValue:t,next:null},ai===null){if(Lu===null)throw Error(re(308));ai=e,Lu.dependencies={lanes:0,firstContext:e}}else ai=ai.next=e;return t}var uo=null;function Np(e){uo===null?uo=[e]:uo.push(e)}function Ib(e,t,n,r){var a=t.interleaved;return a===null?(n.next=n,Np(t)):(n.next=a.next,a.next=n),t.interleaved=n,Qr(e,r)}function Qr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var ga=!1;function Cp(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ab(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function qr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Aa(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,We&2){var a=r.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Qr(e,n)}return a=r.interleaved,a===null?(t.next=t,Np(r)):(t.next=a.next,a.next=t),r.interleaved=t,Qr(e,n)}function du(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,lp(e,n)}}function X0(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?a=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?a=o=t:o=o.next=t}else a=o=t;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:o,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Bu(e,t,n,r){var a=e.updateQueue;ga=!1;var o=a.firstBaseUpdate,i=a.lastBaseUpdate,s=a.shared.pending;if(s!==null){a.shared.pending=null;var l=s,c=l.next;l.next=null,i===null?o=c:i.next=c,i=l;var d=e.alternate;d!==null&&(d=d.updateQueue,s=d.lastBaseUpdate,s!==i&&(s===null?d.firstBaseUpdate=c:s.next=c,d.lastBaseUpdate=l))}if(o!==null){var h=a.baseState;i=0,d=c=l=null,s=o;do{var f=s.lane,p=s.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var v=e,g=s;switch(f=t,p=n,g.tag){case 1:if(v=g.payload,typeof v=="function"){h=v.call(p,h,f);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=g.payload,f=typeof v=="function"?v.call(p,h,f):v,f==null)break e;h=ut({},h,f);break e;case 2:ga=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,f=a.effects,f===null?a.effects=[s]:f.push(s))}else p={eventTime:p,lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},d===null?(c=d=p,l=h):d=d.next=p,i|=f;if(s=s.next,s===null){if(s=a.shared.pending,s===null)break;f=s,s=f.next,f.next=null,a.lastBaseUpdate=f,a.shared.pending=null}}while(!0);if(d===null&&(l=h),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=d,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else o===null&&(a.shared.lanes=0);No|=i,e.lanes=i,e.memoizedState=h}}function Y0(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(re(191,a));a.call(r)}}}var il={},Sr=Ga(il),zs=Ga(il),$s=Ga(il);function co(e){if(e===il)throw Error(re(174));return e}function kp(e,t){switch(Qe($s,t),Qe(zs,e),Qe(Sr,il),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ih(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ih(t,e)}tt(Sr),Qe(Sr,t)}function Ei(){tt(Sr),tt(zs),tt($s)}function Db(e){co($s.current);var t=co(Sr.current),n=Ih(t,e.type);t!==n&&(Qe(zs,e),Qe(Sr,n))}function jp(e){zs.current===e&&(tt(Sr),tt(zs))}var ot=Ga(0);function zu(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Td=[];function Sp(){for(var e=0;e<Td.length;e++)Td[e]._workInProgressVersionPrimary=null;Td.length=0}var hu=na.ReactCurrentDispatcher,Pd=na.ReactCurrentBatchConfig,wo=0,lt=null,jt=null,Ft=null,$u=!1,Ns=!1,Us=0,dS=0;function Kt(){throw Error(re(321))}function Ep(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ir(e[n],t[n]))return!1;return!0}function _p(e,t,n,r,a,o){if(wo=o,lt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,hu.current=e===null||e.memoizedState===null?mS:vS,e=n(r,a),Ns){o=0;do{if(Ns=!1,Us=0,25<=o)throw Error(re(301));o+=1,Ft=jt=null,t.updateQueue=null,hu.current=gS,e=n(r,a)}while(Ns)}if(hu.current=Uu,t=jt!==null&&jt.next!==null,wo=0,Ft=jt=lt=null,$u=!1,t)throw Error(re(300));return e}function Rp(){var e=Us!==0;return Us=0,e}function vr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ft===null?lt.memoizedState=Ft=e:Ft=Ft.next=e,Ft}function Kn(){if(jt===null){var e=lt.alternate;e=e!==null?e.memoizedState:null}else e=jt.next;var t=Ft===null?lt.memoizedState:Ft.next;if(t!==null)Ft=t,jt=e;else{if(e===null)throw Error(re(310));jt=e,e={memoizedState:jt.memoizedState,baseState:jt.baseState,baseQueue:jt.baseQueue,queue:jt.queue,next:null},Ft===null?lt.memoizedState=Ft=e:Ft=Ft.next=e}return Ft}function Ws(e,t){return typeof t=="function"?t(e):t}function Fd(e){var t=Kn(),n=t.queue;if(n===null)throw Error(re(311));n.lastRenderedReducer=e;var r=jt,a=r.baseQueue,o=n.pending;if(o!==null){if(a!==null){var i=a.next;a.next=o.next,o.next=i}r.baseQueue=a=o,n.pending=null}if(a!==null){o=a.next,r=r.baseState;var s=i=null,l=null,c=o;do{var d=c.lane;if((wo&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(s=l=h,i=r):l=l.next=h,lt.lanes|=d,No|=d}c=c.next}while(c!==null&&c!==o);l===null?i=r:l.next=s,ir(r,t.memoizedState)||(vn=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=l,n.lastRenderedState=r}if(e=n.interleaved,e!==null){a=e;do o=a.lane,lt.lanes|=o,No|=o,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Md(e){var t=Kn(),n=t.queue;if(n===null)throw Error(re(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(a!==null){n.pending=null;var i=a=a.next;do o=e(o,i.action),i=i.next;while(i!==a);ir(o,t.memoizedState)||(vn=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Tb(){}function Pb(e,t){var n=lt,r=Kn(),a=t(),o=!ir(r.memoizedState,a);if(o&&(r.memoizedState=a,vn=!0),r=r.queue,Ip(Ob.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||Ft!==null&&Ft.memoizedState.tag&1){if(n.flags|=2048,Vs(9,Mb.bind(null,n,r,a,t),void 0,null),Ot===null)throw Error(re(349));wo&30||Fb(n,t,a)}return a}function Fb(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=lt.updateQueue,t===null?(t={lastEffect:null,stores:null},lt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Mb(e,t,n,r){t.value=n,t.getSnapshot=r,Lb(t)&&Bb(e)}function Ob(e,t,n){return n(function(){Lb(t)&&Bb(e)})}function Lb(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ir(e,n)}catch{return!0}}function Bb(e){var t=Qr(e,1);t!==null&&ar(t,e,1,-1)}function Q0(e){var t=vr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ws,lastRenderedState:e},t.queue=e,e=e.dispatch=pS.bind(null,lt,e),[t.memoizedState,e]}function Vs(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=lt.updateQueue,t===null?(t={lastEffect:null,stores:null},lt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function zb(){return Kn().memoizedState}function fu(e,t,n,r){var a=vr();lt.flags|=e,a.memoizedState=Vs(1|t,n,void 0,r===void 0?null:r)}function Dc(e,t,n,r){var a=Kn();r=r===void 0?null:r;var o=void 0;if(jt!==null){var i=jt.memoizedState;if(o=i.destroy,r!==null&&Ep(r,i.deps)){a.memoizedState=Vs(t,n,o,r);return}}lt.flags|=e,a.memoizedState=Vs(1|t,n,o,r)}function J0(e,t){return fu(8390656,8,e,t)}function Ip(e,t){return Dc(2048,8,e,t)}function $b(e,t){return Dc(4,2,e,t)}function Ub(e,t){return Dc(4,4,e,t)}function Wb(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Vb(e,t,n){return n=n!=null?n.concat([e]):null,Dc(4,4,Wb.bind(null,t,e),n)}function Ap(){}function Hb(e,t){var n=Kn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Ep(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Gb(e,t){var n=Kn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Ep(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function qb(e,t,n){return wo&21?(ir(n,t)||(n=J1(),lt.lanes|=n,No|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,vn=!0),e.memoizedState=n)}function hS(e,t){var n=qe;qe=n!==0&&4>n?n:4,e(!0);var r=Pd.transition;Pd.transition={};try{e(!1),t()}finally{qe=n,Pd.transition=r}}function Kb(){return Kn().memoizedState}function fS(e,t,n){var r=Ta(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Xb(e))Yb(t,n);else if(n=Ib(e,t,n,r),n!==null){var a=ln();ar(n,e,r,a),Qb(n,t,r)}}function pS(e,t,n){var r=Ta(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Xb(e))Yb(t,a);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var i=t.lastRenderedState,s=o(i,n);if(a.hasEagerState=!0,a.eagerState=s,ir(s,i)){var l=t.interleaved;l===null?(a.next=a,Np(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}n=Ib(e,t,a,r),n!==null&&(a=ln(),ar(n,e,r,a),Qb(n,t,r))}}function Xb(e){var t=e.alternate;return e===lt||t!==null&&t===lt}function Yb(e,t){Ns=$u=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Qb(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,lp(e,n)}}var Uu={readContext:qn,useCallback:Kt,useContext:Kt,useEffect:Kt,useImperativeHandle:Kt,useInsertionEffect:Kt,useLayoutEffect:Kt,useMemo:Kt,useReducer:Kt,useRef:Kt,useState:Kt,useDebugValue:Kt,useDeferredValue:Kt,useTransition:Kt,useMutableSource:Kt,useSyncExternalStore:Kt,useId:Kt,unstable_isNewReconciler:!1},mS={readContext:qn,useCallback:function(e,t){return vr().memoizedState=[e,t===void 0?null:t],e},useContext:qn,useEffect:J0,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,fu(4194308,4,Wb.bind(null,t,e),n)},useLayoutEffect:function(e,t){return fu(4194308,4,e,t)},useInsertionEffect:function(e,t){return fu(4,2,e,t)},useMemo:function(e,t){var n=vr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=vr();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=fS.bind(null,lt,e),[r.memoizedState,e]},useRef:function(e){var t=vr();return e={current:e},t.memoizedState=e},useState:Q0,useDebugValue:Ap,useDeferredValue:function(e){return vr().memoizedState=e},useTransition:function(){var e=Q0(!1),t=e[0];return e=hS.bind(null,e[1]),vr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=lt,a=vr();if(rt){if(n===void 0)throw Error(re(407));n=n()}else{if(n=t(),Ot===null)throw Error(re(349));wo&30||Fb(r,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,J0(Ob.bind(null,r,o,e),[e]),r.flags|=2048,Vs(9,Mb.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=vr(),t=Ot.identifierPrefix;if(rt){var n=Gr,r=Hr;n=(r&~(1<<32-rr(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Us++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=dS++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},vS={readContext:qn,useCallback:Hb,useContext:qn,useEffect:Ip,useImperativeHandle:Vb,useInsertionEffect:$b,useLayoutEffect:Ub,useMemo:Gb,useReducer:Fd,useRef:zb,useState:function(){return Fd(Ws)},useDebugValue:Ap,useDeferredValue:function(e){var t=Kn();return qb(t,jt.memoizedState,e)},useTransition:function(){var e=Fd(Ws)[0],t=Kn().memoizedState;return[e,t]},useMutableSource:Tb,useSyncExternalStore:Pb,useId:Kb,unstable_isNewReconciler:!1},gS={readContext:qn,useCallback:Hb,useContext:qn,useEffect:Ip,useImperativeHandle:Vb,useInsertionEffect:$b,useLayoutEffect:Ub,useMemo:Gb,useReducer:Md,useRef:zb,useState:function(){return Md(Ws)},useDebugValue:Ap,useDeferredValue:function(e){var t=Kn();return jt===null?t.memoizedState=e:qb(t,jt.memoizedState,e)},useTransition:function(){var e=Md(Ws)[0],t=Kn().memoizedState;return[e,t]},useMutableSource:Tb,useSyncExternalStore:Pb,useId:Kb,unstable_isNewReconciler:!1};function Jn(e,t){if(e&&e.defaultProps){t=ut({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Qh(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:ut({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Tc={isMounted:function(e){return(e=e._reactInternals)?Do(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ln(),a=Ta(e),o=qr(r,a);o.payload=t,n!=null&&(o.callback=n),t=Aa(e,o,a),t!==null&&(ar(t,e,a,r),du(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ln(),a=Ta(e),o=qr(r,a);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=Aa(e,o,a),t!==null&&(ar(t,e,a,r),du(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ln(),r=Ta(e),a=qr(n,r);a.tag=2,t!=null&&(a.callback=t),t=Aa(e,a,r),t!==null&&(ar(t,e,r,n),du(t,e,r))}};function Z0(e,t,n,r,a,o,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,i):t.prototype&&t.prototype.isPureReactComponent?!Ms(n,r)||!Ms(a,o):!0}function Jb(e,t,n){var r=!1,a=$a,o=t.contextType;return typeof o=="object"&&o!==null?o=qn(o):(a=xn(t)?yo:rn.current,r=t.contextTypes,o=(r=r!=null)?ki(e,a):$a),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Tc,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=o),t}function ex(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Tc.enqueueReplaceState(t,t.state,null)}function Jh(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},Cp(e);var o=t.contextType;typeof o=="object"&&o!==null?a.context=qn(o):(o=xn(t)?yo:rn.current,a.context=ki(e,o)),a.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(Qh(e,t,o,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Tc.enqueueReplaceState(a,a.state,null),Bu(e,n,a,r),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function _i(e,t){try{var n="",r=t;do n+=Hk(r),r=r.return;while(r);var a=n}catch(o){a=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:a,digest:null}}function Od(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Zh(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var xS=typeof WeakMap=="function"?WeakMap:Map;function Zb(e,t,n){n=qr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Vu||(Vu=!0,cf=r),Zh(e,t)},n}function e2(e,t,n){n=qr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){Zh(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Zh(e,t),typeof r!="function"&&(Da===null?Da=new Set([this]):Da.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),n}function tx(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new xS;var a=new Set;r.set(t,a)}else a=r.get(t),a===void 0&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=DS.bind(null,e,t,n),t.then(e,e))}function nx(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function rx(e,t,n,r,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=qr(-1,1),t.tag=2,Aa(n,t,1))),n.lanes|=1),e)}var yS=na.ReactCurrentOwner,vn=!1;function sn(e,t,n,r){t.child=e===null?Rb(t,null,n,r):Si(t,e.child,n,r)}function ax(e,t,n,r,a){n=n.render;var o=t.ref;return di(t,a),r=_p(e,t,n,r,o,a),n=Rp(),e!==null&&!vn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Jr(e,t,a)):(rt&&n&&vp(t),t.flags|=1,sn(e,t,r,a),t.child)}function ox(e,t,n,r,a){if(e===null){var o=n.type;return typeof o=="function"&&!Bp(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,t2(e,t,o,r,a)):(e=gu(n.type,null,r,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&a)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:Ms,n(i,r)&&e.ref===t.ref)return Jr(e,t,a)}return t.flags|=1,e=Pa(o,r),e.ref=t.ref,e.return=t,t.child=e}function t2(e,t,n,r,a){if(e!==null){var o=e.memoizedProps;if(Ms(o,r)&&e.ref===t.ref)if(vn=!1,t.pendingProps=r=o,(e.lanes&a)!==0)e.flags&131072&&(vn=!0);else return t.lanes=e.lanes,Jr(e,t,a)}return ef(e,t,n,r,a)}function n2(e,t,n){var r=t.pendingProps,a=r.children,o=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qe(ii,jn),jn|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Qe(ii,jn),jn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,Qe(ii,jn),jn|=r}else o!==null?(r=o.baseLanes|n,t.memoizedState=null):r=n,Qe(ii,jn),jn|=r;return sn(e,t,a,n),t.child}function r2(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function ef(e,t,n,r,a){var o=xn(n)?yo:rn.current;return o=ki(t,o),di(t,a),n=_p(e,t,n,r,o,a),r=Rp(),e!==null&&!vn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Jr(e,t,a)):(rt&&r&&vp(t),t.flags|=1,sn(e,t,n,a),t.child)}function ix(e,t,n,r,a){if(xn(n)){var o=!0;Pu(t)}else o=!1;if(di(t,a),t.stateNode===null)pu(e,t),Jb(t,n,r),Jh(t,n,r,a),r=!0;else if(e===null){var i=t.stateNode,s=t.memoizedProps;i.props=s;var l=i.context,c=n.contextType;typeof c=="object"&&c!==null?c=qn(c):(c=xn(n)?yo:rn.current,c=ki(t,c));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(s!==r||l!==c)&&ex(t,i,r,c),ga=!1;var f=t.memoizedState;i.state=f,Bu(t,r,i,a),l=t.memoizedState,s!==r||f!==l||gn.current||ga?(typeof d=="function"&&(Qh(t,n,d,r),l=t.memoizedState),(s=ga||Z0(t,n,s,r,f,l,c))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),i.props=r,i.state=l,i.context=c,r=s):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,Ab(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:Jn(t.type,s),i.props=c,h=t.pendingProps,f=i.context,l=n.contextType,typeof l=="object"&&l!==null?l=qn(l):(l=xn(n)?yo:rn.current,l=ki(t,l));var p=n.getDerivedStateFromProps;(d=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(s!==h||f!==l)&&ex(t,i,r,l),ga=!1,f=t.memoizedState,i.state=f,Bu(t,r,i,a);var v=t.memoizedState;s!==h||f!==v||gn.current||ga?(typeof p=="function"&&(Qh(t,n,p,r),v=t.memoizedState),(c=ga||Z0(t,n,c,r,f,v,l)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,v,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,v,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=v),i.props=r,i.state=v,i.context=l,r=c):(typeof i.componentDidUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return tf(e,t,n,r,o,a)}function tf(e,t,n,r,a,o){r2(e,t);var i=(t.flags&128)!==0;if(!r&&!i)return a&&H0(t,n,!1),Jr(e,t,o);r=t.stateNode,yS.current=t;var s=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&i?(t.child=Si(t,e.child,null,o),t.child=Si(t,null,s,o)):sn(e,t,s,o),t.memoizedState=r.state,a&&H0(t,n,!0),t.child}function a2(e){var t=e.stateNode;t.pendingContext?V0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&V0(e,t.context,!1),kp(e,t.containerInfo)}function sx(e,t,n,r,a){return ji(),xp(a),t.flags|=256,sn(e,t,n,r),t.child}var nf={dehydrated:null,treeContext:null,retryLane:0};function rf(e){return{baseLanes:e,cachePool:null,transitions:null}}function o2(e,t,n){var r=t.pendingProps,a=ot.current,o=!1,i=(t.flags&128)!==0,s;if((s=i)||(s=e!==null&&e.memoizedState===null?!1:(a&2)!==0),s?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Qe(ot,a&1),e===null)return Xh(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=r.children,e=r.fallback,o?(r=t.mode,o=t.child,i={mode:"hidden",children:i},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=Mc(i,r,0,null),e=vo(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=rf(n),t.memoizedState=nf,e):Dp(t,i));if(a=e.memoizedState,a!==null&&(s=a.dehydrated,s!==null))return bS(e,t,i,r,s,a,n);if(o){o=r.fallback,i=t.mode,a=e.child,s=a.sibling;var l={mode:"hidden",children:r.children};return!(i&1)&&t.child!==a?(r=t.child,r.childLanes=0,r.pendingProps=l,t.deletions=null):(r=Pa(a,l),r.subtreeFlags=a.subtreeFlags&14680064),s!==null?o=Pa(s,o):(o=vo(o,i,n,null),o.flags|=2),o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,i=e.child.memoizedState,i=i===null?rf(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=e.childLanes&~n,t.memoizedState=nf,r}return o=e.child,e=o.sibling,r=Pa(o,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Dp(e,t){return t=Mc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Bl(e,t,n,r){return r!==null&&xp(r),Si(t,e.child,null,n),e=Dp(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function bS(e,t,n,r,a,o,i){if(n)return t.flags&256?(t.flags&=-257,r=Od(Error(re(422))),Bl(e,t,i,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=r.fallback,a=t.mode,r=Mc({mode:"visible",children:r.children},a,0,null),o=vo(o,a,i,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,t.mode&1&&Si(t,e.child,null,i),t.child.memoizedState=rf(i),t.memoizedState=nf,o);if(!(t.mode&1))return Bl(e,t,i,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var s=r.dgst;return r=s,o=Error(re(419)),r=Od(o,r,void 0),Bl(e,t,i,r)}if(s=(i&e.childLanes)!==0,vn||s){if(r=Ot,r!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|i)?0:a,a!==0&&a!==o.retryLane&&(o.retryLane=a,Qr(e,a),ar(r,e,a,-1))}return Lp(),r=Od(Error(re(421))),Bl(e,t,i,r)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=TS.bind(null,e),a._reactRetry=t,null):(e=o.treeContext,_n=Ia(a.nextSibling),Dn=t,rt=!0,er=null,e!==null&&(zn[$n++]=Hr,zn[$n++]=Gr,zn[$n++]=bo,Hr=e.id,Gr=e.overflow,bo=t),t=Dp(t,r.children),t.flags|=4096,t)}function lx(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Yh(e.return,t,n)}function Ld(e,t,n,r,a){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=a)}function i2(e,t,n){var r=t.pendingProps,a=r.revealOrder,o=r.tail;if(sn(e,t,r.children,n),r=ot.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&lx(e,n,t);else if(e.tag===19)lx(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Qe(ot,r),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&zu(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Ld(t,!1,a,n,o);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&zu(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Ld(t,!0,n,null,o);break;case"together":Ld(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function pu(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Jr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),No|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(re(153));if(t.child!==null){for(e=t.child,n=Pa(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Pa(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function wS(e,t,n){switch(t.tag){case 3:a2(t),ji();break;case 5:Db(t);break;case 1:xn(t.type)&&Pu(t);break;case 4:kp(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Qe(Ou,r._currentValue),r._currentValue=a;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Qe(ot,ot.current&1),t.flags|=128,null):n&t.child.childLanes?o2(e,t,n):(Qe(ot,ot.current&1),e=Jr(e,t,n),e!==null?e.sibling:null);Qe(ot,ot.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return i2(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Qe(ot,ot.current),r)break;return null;case 22:case 23:return t.lanes=0,n2(e,t,n)}return Jr(e,t,n)}var s2,af,l2,u2;s2=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};af=function(){};l2=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,co(Sr.current);var o=null;switch(n){case"input":a=Sh(e,a),r=Sh(e,r),o=[];break;case"select":a=ut({},a,{value:void 0}),r=ut({},r,{value:void 0}),o=[];break;case"textarea":a=Rh(e,a),r=Rh(e,r),o=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Du)}Ah(n,r);var i;n=null;for(c in a)if(!r.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var s=a[c];for(i in s)s.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Rs.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var l=r[c];if(s=a!=null?a[c]:void 0,r.hasOwnProperty(c)&&l!==s&&(l!=null||s!=null))if(c==="style")if(s){for(i in s)!s.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&s[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(o||(o=[]),o.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,s=s?s.__html:void 0,l!=null&&s!==l&&(o=o||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Rs.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ze("scroll",e),o||s===l||(o=[])):(o=o||[]).push(c,l))}n&&(o=o||[]).push("style",n);var c=o;(t.updateQueue=c)&&(t.flags|=4)}};u2=function(e,t,n,r){n!==r&&(t.flags|=4)};function is(e,t){if(!rt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Xt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function NS(e,t,n){var r=t.pendingProps;switch(gp(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xt(t),null;case 1:return xn(t.type)&&Tu(),Xt(t),null;case 3:return r=t.stateNode,Ei(),tt(gn),tt(rn),Sp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Ol(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,er!==null&&(ff(er),er=null))),af(e,t),Xt(t),null;case 5:jp(t);var a=co($s.current);if(n=t.type,e!==null&&t.stateNode!=null)l2(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(re(166));return Xt(t),null}if(e=co(Sr.current),Ol(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[yr]=t,r[Bs]=o,e=(t.mode&1)!==0,n){case"dialog":Ze("cancel",r),Ze("close",r);break;case"iframe":case"object":case"embed":Ze("load",r);break;case"video":case"audio":for(a=0;a<vs.length;a++)Ze(vs[a],r);break;case"source":Ze("error",r);break;case"img":case"image":case"link":Ze("error",r),Ze("load",r);break;case"details":Ze("toggle",r);break;case"input":g0(r,o),Ze("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Ze("invalid",r);break;case"textarea":y0(r,o),Ze("invalid",r)}Ah(n,o),a=null;for(var i in o)if(o.hasOwnProperty(i)){var s=o[i];i==="children"?typeof s=="string"?r.textContent!==s&&(o.suppressHydrationWarning!==!0&&Ml(r.textContent,s,e),a=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(o.suppressHydrationWarning!==!0&&Ml(r.textContent,s,e),a=["children",""+s]):Rs.hasOwnProperty(i)&&s!=null&&i==="onScroll"&&Ze("scroll",r)}switch(n){case"input":_l(r),x0(r,o,!0);break;case"textarea":_l(r),b0(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Du)}r=a,t.updateQueue=r,r!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=O1(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=i.createElement(n,{is:r.is}):(e=i.createElement(n),n==="select"&&(i=e,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):e=i.createElementNS(e,n),e[yr]=t,e[Bs]=r,s2(e,t,!1,!1),t.stateNode=e;e:{switch(i=Dh(n,r),n){case"dialog":Ze("cancel",e),Ze("close",e),a=r;break;case"iframe":case"object":case"embed":Ze("load",e),a=r;break;case"video":case"audio":for(a=0;a<vs.length;a++)Ze(vs[a],e);a=r;break;case"source":Ze("error",e),a=r;break;case"img":case"image":case"link":Ze("error",e),Ze("load",e),a=r;break;case"details":Ze("toggle",e),a=r;break;case"input":g0(e,r),a=Sh(e,r),Ze("invalid",e);break;case"option":a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=ut({},r,{value:void 0}),Ze("invalid",e);break;case"textarea":y0(e,r),a=Rh(e,r),Ze("invalid",e);break;default:a=r}Ah(n,a),s=a;for(o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="style"?z1(e,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&L1(e,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Is(e,l):typeof l=="number"&&Is(e,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Rs.hasOwnProperty(o)?l!=null&&o==="onScroll"&&Ze("scroll",e):l!=null&&np(e,o,l,i))}switch(n){case"input":_l(e),x0(e,r,!1);break;case"textarea":_l(e),b0(e);break;case"option":r.value!=null&&e.setAttribute("value",""+za(r.value));break;case"select":e.multiple=!!r.multiple,o=r.value,o!=null?si(e,!!r.multiple,o,!1):r.defaultValue!=null&&si(e,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Du)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Xt(t),null;case 6:if(e&&t.stateNode!=null)u2(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(re(166));if(n=co($s.current),co(Sr.current),Ol(t)){if(r=t.stateNode,n=t.memoizedProps,r[yr]=t,(o=r.nodeValue!==n)&&(e=Dn,e!==null))switch(e.tag){case 3:Ml(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ml(r.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[yr]=t,t.stateNode=r}return Xt(t),null;case 13:if(tt(ot),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(rt&&_n!==null&&t.mode&1&&!(t.flags&128))Eb(),ji(),t.flags|=98560,o=!1;else if(o=Ol(t),r!==null&&r.dehydrated!==null){if(e===null){if(!o)throw Error(re(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(re(317));o[yr]=t}else ji(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Xt(t),o=!1}else er!==null&&(ff(er),er=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||ot.current&1?Et===0&&(Et=3):Lp())),t.updateQueue!==null&&(t.flags|=4),Xt(t),null);case 4:return Ei(),af(e,t),e===null&&Os(t.stateNode.containerInfo),Xt(t),null;case 10:return wp(t.type._context),Xt(t),null;case 17:return xn(t.type)&&Tu(),Xt(t),null;case 19:if(tt(ot),o=t.memoizedState,o===null)return Xt(t),null;if(r=(t.flags&128)!==0,i=o.rendering,i===null)if(r)is(o,!1);else{if(Et!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=zu(e),i!==null){for(t.flags|=128,is(o,!1),r=i.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)o=n,e=r,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,e=i.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Qe(ot,ot.current&1|2),t.child}e=e.sibling}o.tail!==null&&vt()>Ri&&(t.flags|=128,r=!0,is(o,!1),t.lanes=4194304)}else{if(!r)if(e=zu(i),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),is(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!rt)return Xt(t),null}else 2*vt()-o.renderingStartTime>Ri&&n!==1073741824&&(t.flags|=128,r=!0,is(o,!1),t.lanes=4194304);o.isBackwards?(i.sibling=t.child,t.child=i):(n=o.last,n!==null?n.sibling=i:t.child=i,o.last=i)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=vt(),t.sibling=null,n=ot.current,Qe(ot,r?n&1|2:n&1),t):(Xt(t),null);case 22:case 23:return Op(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?jn&1073741824&&(Xt(t),t.subtreeFlags&6&&(t.flags|=8192)):Xt(t),null;case 24:return null;case 25:return null}throw Error(re(156,t.tag))}function CS(e,t){switch(gp(t),t.tag){case 1:return xn(t.type)&&Tu(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ei(),tt(gn),tt(rn),Sp(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return jp(t),null;case 13:if(tt(ot),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(re(340));ji()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return tt(ot),null;case 4:return Ei(),null;case 10:return wp(t.type._context),null;case 22:case 23:return Op(),null;case 24:return null;default:return null}}var zl=!1,Qt=!1,kS=typeof WeakSet=="function"?WeakSet:Set,de=null;function oi(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ft(e,t,r)}else n.current=null}function of(e,t,n){try{n()}catch(r){ft(e,t,r)}}var ux=!1;function jS(e,t){if(Uh=Ru,e=pb(),mp(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,s=-1,l=-1,c=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||a!==0&&h.nodeType!==3||(s=i+a),h!==o||r!==0&&h.nodeType!==3||(l=i+r),h.nodeType===3&&(i+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++c===a&&(s=i),f===o&&++d===r&&(l=i),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}n=s===-1||l===-1?null:{start:s,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Wh={focusedElem:e,selectionRange:n},Ru=!1,de=t;de!==null;)if(t=de,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,de=e;else for(;de!==null;){t=de;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var g=v.memoizedProps,y=v.memoizedState,m=t.stateNode,x=m.getSnapshotBeforeUpdate(t.elementType===t.type?g:Jn(t.type,g),y);m.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(re(163))}}catch(w){ft(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,de=e;break}de=t.return}return v=ux,ux=!1,v}function Cs(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&e)===e){var o=a.destroy;a.destroy=void 0,o!==void 0&&of(t,n,o)}a=a.next}while(a!==r)}}function Pc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function sf(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function c2(e){var t=e.alternate;t!==null&&(e.alternate=null,c2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[yr],delete t[Bs],delete t[Gh],delete t[sS],delete t[lS])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function d2(e){return e.tag===5||e.tag===3||e.tag===4}function cx(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||d2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function lf(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Du));else if(r!==4&&(e=e.child,e!==null))for(lf(e,t,n),e=e.sibling;e!==null;)lf(e,t,n),e=e.sibling}function uf(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(uf(e,t,n),e=e.sibling;e!==null;)uf(e,t,n),e=e.sibling}var Ut=null,Zn=!1;function fa(e,t,n){for(n=n.child;n!==null;)h2(e,t,n),n=n.sibling}function h2(e,t,n){if(jr&&typeof jr.onCommitFiberUnmount=="function")try{jr.onCommitFiberUnmount(Sc,n)}catch{}switch(n.tag){case 5:Qt||oi(n,t);case 6:var r=Ut,a=Zn;Ut=null,fa(e,t,n),Ut=r,Zn=a,Ut!==null&&(Zn?(e=Ut,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Ut.removeChild(n.stateNode));break;case 18:Ut!==null&&(Zn?(e=Ut,n=n.stateNode,e.nodeType===8?Ad(e.parentNode,n):e.nodeType===1&&Ad(e,n),Ps(e)):Ad(Ut,n.stateNode));break;case 4:r=Ut,a=Zn,Ut=n.stateNode.containerInfo,Zn=!0,fa(e,t,n),Ut=r,Zn=a;break;case 0:case 11:case 14:case 15:if(!Qt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var o=a,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&of(n,t,i),a=a.next}while(a!==r)}fa(e,t,n);break;case 1:if(!Qt&&(oi(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){ft(n,t,s)}fa(e,t,n);break;case 21:fa(e,t,n);break;case 22:n.mode&1?(Qt=(r=Qt)||n.memoizedState!==null,fa(e,t,n),Qt=r):fa(e,t,n);break;default:fa(e,t,n)}}function dx(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new kS),t.forEach(function(r){var a=PS.bind(null,e,r);n.has(r)||(n.add(r),r.then(a,a))})}}function Yn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var o=e,i=t,s=i;e:for(;s!==null;){switch(s.tag){case 5:Ut=s.stateNode,Zn=!1;break e;case 3:Ut=s.stateNode.containerInfo,Zn=!0;break e;case 4:Ut=s.stateNode.containerInfo,Zn=!0;break e}s=s.return}if(Ut===null)throw Error(re(160));h2(o,i,a),Ut=null,Zn=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){ft(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)f2(t,e),t=t.sibling}function f2(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Yn(t,e),fr(e),r&4){try{Cs(3,e,e.return),Pc(3,e)}catch(g){ft(e,e.return,g)}try{Cs(5,e,e.return)}catch(g){ft(e,e.return,g)}}break;case 1:Yn(t,e),fr(e),r&512&&n!==null&&oi(n,n.return);break;case 5:if(Yn(t,e),fr(e),r&512&&n!==null&&oi(n,n.return),e.flags&32){var a=e.stateNode;try{Is(a,"")}catch(g){ft(e,e.return,g)}}if(r&4&&(a=e.stateNode,a!=null)){var o=e.memoizedProps,i=n!==null?n.memoizedProps:o,s=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{s==="input"&&o.type==="radio"&&o.name!=null&&F1(a,o),Dh(s,i);var c=Dh(s,o);for(i=0;i<l.length;i+=2){var d=l[i],h=l[i+1];d==="style"?z1(a,h):d==="dangerouslySetInnerHTML"?L1(a,h):d==="children"?Is(a,h):np(a,d,h,c)}switch(s){case"input":Eh(a,o);break;case"textarea":M1(a,o);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var p=o.value;p!=null?si(a,!!o.multiple,p,!1):f!==!!o.multiple&&(o.defaultValue!=null?si(a,!!o.multiple,o.defaultValue,!0):si(a,!!o.multiple,o.multiple?[]:"",!1))}a[Bs]=o}catch(g){ft(e,e.return,g)}}break;case 6:if(Yn(t,e),fr(e),r&4){if(e.stateNode===null)throw Error(re(162));a=e.stateNode,o=e.memoizedProps;try{a.nodeValue=o}catch(g){ft(e,e.return,g)}}break;case 3:if(Yn(t,e),fr(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ps(t.containerInfo)}catch(g){ft(e,e.return,g)}break;case 4:Yn(t,e),fr(e);break;case 13:Yn(t,e),fr(e),a=e.child,a.flags&8192&&(o=a.memoizedState!==null,a.stateNode.isHidden=o,!o||a.alternate!==null&&a.alternate.memoizedState!==null||(Fp=vt())),r&4&&dx(e);break;case 22:if(d=n!==null&&n.memoizedState!==null,e.mode&1?(Qt=(c=Qt)||d,Yn(t,e),Qt=c):Yn(t,e),fr(e),r&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!d&&e.mode&1)for(de=e,d=e.child;d!==null;){for(h=de=d;de!==null;){switch(f=de,p=f.child,f.tag){case 0:case 11:case 14:case 15:Cs(4,f,f.return);break;case 1:oi(f,f.return);var v=f.stateNode;if(typeof v.componentWillUnmount=="function"){r=f,n=f.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(g){ft(r,n,g)}}break;case 5:oi(f,f.return);break;case 22:if(f.memoizedState!==null){fx(h);continue}}p!==null?(p.return=f,de=p):fx(h)}d=d.sibling}e:for(d=null,h=e;;){if(h.tag===5){if(d===null){d=h;try{a=h.stateNode,c?(o=a.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(s=h.stateNode,l=h.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,s.style.display=B1("display",i))}catch(g){ft(e,e.return,g)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(g){ft(e,e.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Yn(t,e),fr(e),r&4&&dx(e);break;case 21:break;default:Yn(t,e),fr(e)}}function fr(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(d2(n)){var r=n;break e}n=n.return}throw Error(re(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(Is(a,""),r.flags&=-33);var o=cx(e);uf(e,o,a);break;case 3:case 4:var i=r.stateNode.containerInfo,s=cx(e);lf(e,s,i);break;default:throw Error(re(161))}}catch(l){ft(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function SS(e,t,n){de=e,p2(e)}function p2(e,t,n){for(var r=(e.mode&1)!==0;de!==null;){var a=de,o=a.child;if(a.tag===22&&r){var i=a.memoizedState!==null||zl;if(!i){var s=a.alternate,l=s!==null&&s.memoizedState!==null||Qt;s=zl;var c=Qt;if(zl=i,(Qt=l)&&!c)for(de=a;de!==null;)i=de,l=i.child,i.tag===22&&i.memoizedState!==null?px(a):l!==null?(l.return=i,de=l):px(a);for(;o!==null;)de=o,p2(o),o=o.sibling;de=a,zl=s,Qt=c}hx(e)}else a.subtreeFlags&8772&&o!==null?(o.return=a,de=o):hx(e)}}function hx(e){for(;de!==null;){var t=de;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Qt||Pc(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Qt)if(n===null)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:Jn(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&Y0(t,o,r);break;case 3:var i=t.updateQueue;if(i!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Y0(t,i,n)}break;case 5:var s=t.stateNode;if(n===null&&t.flags&4){n=s;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Ps(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(re(163))}Qt||t.flags&512&&sf(t)}catch(f){ft(t,t.return,f)}}if(t===e){de=null;break}if(n=t.sibling,n!==null){n.return=t.return,de=n;break}de=t.return}}function fx(e){for(;de!==null;){var t=de;if(t===e){de=null;break}var n=t.sibling;if(n!==null){n.return=t.return,de=n;break}de=t.return}}function px(e){for(;de!==null;){var t=de;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Pc(4,t)}catch(l){ft(t,n,l)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var a=t.return;try{r.componentDidMount()}catch(l){ft(t,a,l)}}var o=t.return;try{sf(t)}catch(l){ft(t,o,l)}break;case 5:var i=t.return;try{sf(t)}catch(l){ft(t,i,l)}}}catch(l){ft(t,t.return,l)}if(t===e){de=null;break}var s=t.sibling;if(s!==null){s.return=t.return,de=s;break}de=t.return}}var ES=Math.ceil,Wu=na.ReactCurrentDispatcher,Tp=na.ReactCurrentOwner,Gn=na.ReactCurrentBatchConfig,We=0,Ot=null,bt=null,Gt=0,jn=0,ii=Ga(0),Et=0,Hs=null,No=0,Fc=0,Pp=0,ks=null,hn=null,Fp=0,Ri=1/0,Ur=null,Vu=!1,cf=null,Da=null,$l=!1,Na=null,Hu=0,js=0,df=null,mu=-1,vu=0;function ln(){return We&6?vt():mu!==-1?mu:mu=vt()}function Ta(e){return e.mode&1?We&2&&Gt!==0?Gt&-Gt:cS.transition!==null?(vu===0&&(vu=J1()),vu):(e=qe,e!==0||(e=window.event,e=e===void 0?16:ob(e.type)),e):1}function ar(e,t,n,r){if(50<js)throw js=0,df=null,Error(re(185));rl(e,n,r),(!(We&2)||e!==Ot)&&(e===Ot&&(!(We&2)&&(Fc|=n),Et===4&&ya(e,Gt)),yn(e,r),n===1&&We===0&&!(t.mode&1)&&(Ri=vt()+500,Ac&&qa()))}function yn(e,t){var n=e.callbackNode;cj(e,t);var r=_u(e,e===Ot?Gt:0);if(r===0)n!==null&&C0(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&C0(n),t===1)e.tag===0?uS(mx.bind(null,e)):kb(mx.bind(null,e)),oS(function(){!(We&6)&&qa()}),n=null;else{switch(Z1(r)){case 1:n=sp;break;case 4:n=Y1;break;case 16:n=Eu;break;case 536870912:n=Q1;break;default:n=Eu}n=N2(n,m2.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function m2(e,t){if(mu=-1,vu=0,We&6)throw Error(re(327));var n=e.callbackNode;if(hi()&&e.callbackNode!==n)return null;var r=_u(e,e===Ot?Gt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Gu(e,r);else{t=r;var a=We;We|=2;var o=g2();(Ot!==e||Gt!==t)&&(Ur=null,Ri=vt()+500,mo(e,t));do try{IS();break}catch(s){v2(e,s)}while(!0);bp(),Wu.current=o,We=a,bt!==null?t=0:(Ot=null,Gt=0,t=Et)}if(t!==0){if(t===2&&(a=Oh(e),a!==0&&(r=a,t=hf(e,a))),t===1)throw n=Hs,mo(e,0),ya(e,r),yn(e,vt()),n;if(t===6)ya(e,r);else{if(a=e.current.alternate,!(r&30)&&!_S(a)&&(t=Gu(e,r),t===2&&(o=Oh(e),o!==0&&(r=o,t=hf(e,o))),t===1))throw n=Hs,mo(e,0),ya(e,r),yn(e,vt()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(re(345));case 2:ao(e,hn,Ur);break;case 3:if(ya(e,r),(r&130023424)===r&&(t=Fp+500-vt(),10<t)){if(_u(e,0)!==0)break;if(a=e.suspendedLanes,(a&r)!==r){ln(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Hh(ao.bind(null,e,hn,Ur),t);break}ao(e,hn,Ur);break;case 4:if(ya(e,r),(r&4194240)===r)break;for(t=e.eventTimes,a=-1;0<r;){var i=31-rr(r);o=1<<i,i=t[i],i>a&&(a=i),r&=~o}if(r=a,r=vt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ES(r/1960))-r,10<r){e.timeoutHandle=Hh(ao.bind(null,e,hn,Ur),r);break}ao(e,hn,Ur);break;case 5:ao(e,hn,Ur);break;default:throw Error(re(329))}}}return yn(e,vt()),e.callbackNode===n?m2.bind(null,e):null}function hf(e,t){var n=ks;return e.current.memoizedState.isDehydrated&&(mo(e,t).flags|=256),e=Gu(e,t),e!==2&&(t=hn,hn=n,t!==null&&ff(t)),e}function ff(e){hn===null?hn=e:hn.push.apply(hn,e)}function _S(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],o=a.getSnapshot;a=a.value;try{if(!ir(o(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ya(e,t){for(t&=~Pp,t&=~Fc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-rr(t),r=1<<n;e[n]=-1,t&=~r}}function mx(e){if(We&6)throw Error(re(327));hi();var t=_u(e,0);if(!(t&1))return yn(e,vt()),null;var n=Gu(e,t);if(e.tag!==0&&n===2){var r=Oh(e);r!==0&&(t=r,n=hf(e,r))}if(n===1)throw n=Hs,mo(e,0),ya(e,t),yn(e,vt()),n;if(n===6)throw Error(re(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ao(e,hn,Ur),yn(e,vt()),null}function Mp(e,t){var n=We;We|=1;try{return e(t)}finally{We=n,We===0&&(Ri=vt()+500,Ac&&qa())}}function Co(e){Na!==null&&Na.tag===0&&!(We&6)&&hi();var t=We;We|=1;var n=Gn.transition,r=qe;try{if(Gn.transition=null,qe=1,e)return e()}finally{qe=r,Gn.transition=n,We=t,!(We&6)&&qa()}}function Op(){jn=ii.current,tt(ii)}function mo(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,aS(n)),bt!==null)for(n=bt.return;n!==null;){var r=n;switch(gp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Tu();break;case 3:Ei(),tt(gn),tt(rn),Sp();break;case 5:jp(r);break;case 4:Ei();break;case 13:tt(ot);break;case 19:tt(ot);break;case 10:wp(r.type._context);break;case 22:case 23:Op()}n=n.return}if(Ot=e,bt=e=Pa(e.current,null),Gt=jn=t,Et=0,Hs=null,Pp=Fc=No=0,hn=ks=null,uo!==null){for(t=0;t<uo.length;t++)if(n=uo[t],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,o=n.pending;if(o!==null){var i=o.next;o.next=a,r.next=i}n.pending=r}uo=null}return e}function v2(e,t){do{var n=bt;try{if(bp(),hu.current=Uu,$u){for(var r=lt.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}$u=!1}if(wo=0,Ft=jt=lt=null,Ns=!1,Us=0,Tp.current=null,n===null||n.return===null){Et=1,Hs=t,bt=null;break}e:{var o=e,i=n.return,s=n,l=t;if(t=Gt,s.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=s,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=nx(i);if(p!==null){p.flags&=-257,rx(p,i,s,o,t),p.mode&1&&tx(o,c,t),t=p,l=c;var v=t.updateQueue;if(v===null){var g=new Set;g.add(l),t.updateQueue=g}else v.add(l);break e}else{if(!(t&1)){tx(o,c,t),Lp();break e}l=Error(re(426))}}else if(rt&&s.mode&1){var y=nx(i);if(y!==null){!(y.flags&65536)&&(y.flags|=256),rx(y,i,s,o,t),xp(_i(l,s));break e}}o=l=_i(l,s),Et!==4&&(Et=2),ks===null?ks=[o]:ks.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var m=Zb(o,l,t);X0(o,m);break e;case 1:s=l;var x=o.type,b=o.stateNode;if(!(o.flags&128)&&(typeof x.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Da===null||!Da.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t;var w=e2(o,s,t);X0(o,w);break e}}o=o.return}while(o!==null)}y2(n)}catch(N){t=N,bt===n&&n!==null&&(bt=n=n.return);continue}break}while(!0)}function g2(){var e=Wu.current;return Wu.current=Uu,e===null?Uu:e}function Lp(){(Et===0||Et===3||Et===2)&&(Et=4),Ot===null||!(No&268435455)&&!(Fc&268435455)||ya(Ot,Gt)}function Gu(e,t){var n=We;We|=2;var r=g2();(Ot!==e||Gt!==t)&&(Ur=null,mo(e,t));do try{RS();break}catch(a){v2(e,a)}while(!0);if(bp(),We=n,Wu.current=r,bt!==null)throw Error(re(261));return Ot=null,Gt=0,Et}function RS(){for(;bt!==null;)x2(bt)}function IS(){for(;bt!==null&&!tj();)x2(bt)}function x2(e){var t=w2(e.alternate,e,jn);e.memoizedProps=e.pendingProps,t===null?y2(e):bt=t,Tp.current=null}function y2(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=CS(n,t),n!==null){n.flags&=32767,bt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Et=6,bt=null;return}}else if(n=NS(n,t,jn),n!==null){bt=n;return}if(t=t.sibling,t!==null){bt=t;return}bt=t=e}while(t!==null);Et===0&&(Et=5)}function ao(e,t,n){var r=qe,a=Gn.transition;try{Gn.transition=null,qe=1,AS(e,t,n,r)}finally{Gn.transition=a,qe=r}return null}function AS(e,t,n,r){do hi();while(Na!==null);if(We&6)throw Error(re(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(re(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(dj(e,o),e===Ot&&(bt=Ot=null,Gt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||$l||($l=!0,N2(Eu,function(){return hi(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Gn.transition,Gn.transition=null;var i=qe;qe=1;var s=We;We|=4,Tp.current=null,jS(e,n),f2(n,e),Qj(Wh),Ru=!!Uh,Wh=Uh=null,e.current=n,SS(n),nj(),We=s,qe=i,Gn.transition=o}else e.current=n;if($l&&($l=!1,Na=e,Hu=a),o=e.pendingLanes,o===0&&(Da=null),oj(n.stateNode),yn(e,vt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Vu)throw Vu=!1,e=cf,cf=null,e;return Hu&1&&e.tag!==0&&hi(),o=e.pendingLanes,o&1?e===df?js++:(js=0,df=e):js=0,qa(),null}function hi(){if(Na!==null){var e=Z1(Hu),t=Gn.transition,n=qe;try{if(Gn.transition=null,qe=16>e?16:e,Na===null)var r=!1;else{if(e=Na,Na=null,Hu=0,We&6)throw Error(re(331));var a=We;for(We|=4,de=e.current;de!==null;){var o=de,i=o.child;if(de.flags&16){var s=o.deletions;if(s!==null){for(var l=0;l<s.length;l++){var c=s[l];for(de=c;de!==null;){var d=de;switch(d.tag){case 0:case 11:case 15:Cs(8,d,o)}var h=d.child;if(h!==null)h.return=d,de=h;else for(;de!==null;){d=de;var f=d.sibling,p=d.return;if(c2(d),d===c){de=null;break}if(f!==null){f.return=p,de=f;break}de=p}}}var v=o.alternate;if(v!==null){var g=v.child;if(g!==null){v.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}de=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,de=i;else e:for(;de!==null;){if(o=de,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Cs(9,o,o.return)}var m=o.sibling;if(m!==null){m.return=o.return,de=m;break e}de=o.return}}var x=e.current;for(de=x;de!==null;){i=de;var b=i.child;if(i.subtreeFlags&2064&&b!==null)b.return=i,de=b;else e:for(i=x;de!==null;){if(s=de,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:Pc(9,s)}}catch(N){ft(s,s.return,N)}if(s===i){de=null;break e}var w=s.sibling;if(w!==null){w.return=s.return,de=w;break e}de=s.return}}if(We=a,qa(),jr&&typeof jr.onPostCommitFiberRoot=="function")try{jr.onPostCommitFiberRoot(Sc,e)}catch{}r=!0}return r}finally{qe=n,Gn.transition=t}}return!1}function vx(e,t,n){t=_i(n,t),t=Zb(e,t,1),e=Aa(e,t,1),t=ln(),e!==null&&(rl(e,1,t),yn(e,t))}function ft(e,t,n){if(e.tag===3)vx(e,e,n);else for(;t!==null;){if(t.tag===3){vx(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Da===null||!Da.has(r))){e=_i(n,e),e=e2(t,e,1),t=Aa(t,e,1),e=ln(),t!==null&&(rl(t,1,e),yn(t,e));break}}t=t.return}}function DS(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=ln(),e.pingedLanes|=e.suspendedLanes&n,Ot===e&&(Gt&n)===n&&(Et===4||Et===3&&(Gt&130023424)===Gt&&500>vt()-Fp?mo(e,0):Pp|=n),yn(e,t)}function b2(e,t){t===0&&(e.mode&1?(t=Al,Al<<=1,!(Al&130023424)&&(Al=4194304)):t=1);var n=ln();e=Qr(e,t),e!==null&&(rl(e,t,n),yn(e,n))}function TS(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),b2(e,n)}function PS(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(re(314))}r!==null&&r.delete(t),b2(e,n)}var w2;w2=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||gn.current)vn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return vn=!1,wS(e,t,n);vn=!!(e.flags&131072)}else vn=!1,rt&&t.flags&1048576&&jb(t,Mu,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;pu(e,t),e=t.pendingProps;var a=ki(t,rn.current);di(t,n),a=_p(null,t,r,e,a,n);var o=Rp();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,xn(r)?(o=!0,Pu(t)):o=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Cp(t),a.updater=Tc,t.stateNode=a,a._reactInternals=t,Jh(t,r,e,n),t=tf(null,t,r,!0,o,n)):(t.tag=0,rt&&o&&vp(t),sn(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(pu(e,t),e=t.pendingProps,a=r._init,r=a(r._payload),t.type=r,a=t.tag=MS(r),e=Jn(r,e),a){case 0:t=ef(null,t,r,e,n);break e;case 1:t=ix(null,t,r,e,n);break e;case 11:t=ax(null,t,r,e,n);break e;case 14:t=ox(null,t,r,Jn(r.type,e),n);break e}throw Error(re(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Jn(r,a),ef(e,t,r,a,n);case 1:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Jn(r,a),ix(e,t,r,a,n);case 3:e:{if(a2(t),e===null)throw Error(re(387));r=t.pendingProps,o=t.memoizedState,a=o.element,Ab(e,t),Bu(t,r,null,n);var i=t.memoizedState;if(r=i.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){a=_i(Error(re(423)),t),t=sx(e,t,r,n,a);break e}else if(r!==a){a=_i(Error(re(424)),t),t=sx(e,t,r,n,a);break e}else for(_n=Ia(t.stateNode.containerInfo.firstChild),Dn=t,rt=!0,er=null,n=Rb(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ji(),r===a){t=Jr(e,t,n);break e}sn(e,t,r,n)}t=t.child}return t;case 5:return Db(t),e===null&&Xh(t),r=t.type,a=t.pendingProps,o=e!==null?e.memoizedProps:null,i=a.children,Vh(r,a)?i=null:o!==null&&Vh(r,o)&&(t.flags|=32),r2(e,t),sn(e,t,i,n),t.child;case 6:return e===null&&Xh(t),null;case 13:return o2(e,t,n);case 4:return kp(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Si(t,null,r,n):sn(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Jn(r,a),ax(e,t,r,a,n);case 7:return sn(e,t,t.pendingProps,n),t.child;case 8:return sn(e,t,t.pendingProps.children,n),t.child;case 12:return sn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,o=t.memoizedProps,i=a.value,Qe(Ou,r._currentValue),r._currentValue=i,o!==null)if(ir(o.value,i)){if(o.children===a.children&&!gn.current){t=Jr(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var s=o.dependencies;if(s!==null){i=o.child;for(var l=s.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=qr(-1,n&-n),l.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Yh(o.return,n,t),s.lanes|=n;break}l=l.next}}else if(o.tag===10)i=o.type===t.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(re(341));i.lanes|=n,s=i.alternate,s!==null&&(s.lanes|=n),Yh(i,n,t),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===t){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}sn(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,di(t,n),a=qn(a),r=r(a),t.flags|=1,sn(e,t,r,n),t.child;case 14:return r=t.type,a=Jn(r,t.pendingProps),a=Jn(r.type,a),ox(e,t,r,a,n);case 15:return t2(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Jn(r,a),pu(e,t),t.tag=1,xn(r)?(e=!0,Pu(t)):e=!1,di(t,n),Jb(t,r,a),Jh(t,r,a,n),tf(null,t,r,!0,e,n);case 19:return i2(e,t,n);case 22:return n2(e,t,n)}throw Error(re(156,t.tag))};function N2(e,t){return X1(e,t)}function FS(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vn(e,t,n,r){return new FS(e,t,n,r)}function Bp(e){return e=e.prototype,!(!e||!e.isReactComponent)}function MS(e){if(typeof e=="function")return Bp(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ap)return 11;if(e===op)return 14}return 2}function Pa(e,t){var n=e.alternate;return n===null?(n=Vn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function gu(e,t,n,r,a,o){var i=2;if(r=e,typeof e=="function")Bp(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Yo:return vo(n.children,a,o,t);case rp:i=8,a|=8;break;case Nh:return e=Vn(12,n,t,a|2),e.elementType=Nh,e.lanes=o,e;case Ch:return e=Vn(13,n,t,a),e.elementType=Ch,e.lanes=o,e;case kh:return e=Vn(19,n,t,a),e.elementType=kh,e.lanes=o,e;case D1:return Mc(n,a,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case I1:i=10;break e;case A1:i=9;break e;case ap:i=11;break e;case op:i=14;break e;case va:i=16,r=null;break e}throw Error(re(130,e==null?e:typeof e,""))}return t=Vn(i,n,t,a),t.elementType=e,t.type=r,t.lanes=o,t}function vo(e,t,n,r){return e=Vn(7,e,r,t),e.lanes=n,e}function Mc(e,t,n,r){return e=Vn(22,e,r,t),e.elementType=D1,e.lanes=n,e.stateNode={isHidden:!1},e}function Bd(e,t,n){return e=Vn(6,e,null,t),e.lanes=n,e}function zd(e,t,n){return t=Vn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function OS(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=bd(0),this.expirationTimes=bd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bd(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function zp(e,t,n,r,a,o,i,s,l){return e=new OS(e,t,n,s,l),t===1?(t=1,o===!0&&(t|=8)):t=0,o=Vn(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Cp(o),e}function LS(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Xo,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function C2(e){if(!e)return $a;e=e._reactInternals;e:{if(Do(e)!==e||e.tag!==1)throw Error(re(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(xn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(re(171))}if(e.tag===1){var n=e.type;if(xn(n))return Cb(e,n,t)}return t}function k2(e,t,n,r,a,o,i,s,l){return e=zp(n,r,!0,e,a,o,i,s,l),e.context=C2(null),n=e.current,r=ln(),a=Ta(n),o=qr(r,a),o.callback=t??null,Aa(n,o,a),e.current.lanes=a,rl(e,a,r),yn(e,r),e}function Oc(e,t,n,r){var a=t.current,o=ln(),i=Ta(a);return n=C2(n),t.context===null?t.context=n:t.pendingContext=n,t=qr(o,i),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Aa(a,t,i),e!==null&&(ar(e,a,i,o),du(e,a,i)),i}function qu(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function gx(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function $p(e,t){gx(e,t),(e=e.alternate)&&gx(e,t)}function BS(){return null}var j2=typeof reportError=="function"?reportError:function(e){console.error(e)};function Up(e){this._internalRoot=e}Lc.prototype.render=Up.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(re(409));Oc(e,t,null,null)};Lc.prototype.unmount=Up.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Co(function(){Oc(null,e,null,null)}),t[Yr]=null}};function Lc(e){this._internalRoot=e}Lc.prototype.unstable_scheduleHydration=function(e){if(e){var t=nb();e={blockedOn:null,target:e,priority:t};for(var n=0;n<xa.length&&t!==0&&t<xa[n].priority;n++);xa.splice(n,0,e),n===0&&ab(e)}};function Wp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Bc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function xx(){}function zS(e,t,n,r,a){if(a){if(typeof r=="function"){var o=r;r=function(){var c=qu(i);o.call(c)}}var i=k2(t,r,e,0,null,!1,!1,"",xx);return e._reactRootContainer=i,e[Yr]=i.current,Os(e.nodeType===8?e.parentNode:e),Co(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof r=="function"){var s=r;r=function(){var c=qu(l);s.call(c)}}var l=zp(e,0,!1,null,null,!1,!1,"",xx);return e._reactRootContainer=l,e[Yr]=l.current,Os(e.nodeType===8?e.parentNode:e),Co(function(){Oc(t,l,n,r)}),l}function zc(e,t,n,r,a){var o=n._reactRootContainer;if(o){var i=o;if(typeof a=="function"){var s=a;a=function(){var l=qu(i);s.call(l)}}Oc(t,i,e,a)}else i=zS(n,t,e,a,r);return qu(i)}eb=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ms(t.pendingLanes);n!==0&&(lp(t,n|1),yn(t,vt()),!(We&6)&&(Ri=vt()+500,qa()))}break;case 13:Co(function(){var r=Qr(e,1);if(r!==null){var a=ln();ar(r,e,1,a)}}),$p(e,1)}};up=function(e){if(e.tag===13){var t=Qr(e,134217728);if(t!==null){var n=ln();ar(t,e,134217728,n)}$p(e,134217728)}};tb=function(e){if(e.tag===13){var t=Ta(e),n=Qr(e,t);if(n!==null){var r=ln();ar(n,e,t,r)}$p(e,t)}};nb=function(){return qe};rb=function(e,t){var n=qe;try{return qe=e,t()}finally{qe=n}};Ph=function(e,t,n){switch(t){case"input":if(Eh(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=Ic(r);if(!a)throw Error(re(90));P1(r),Eh(r,a)}}}break;case"textarea":M1(e,n);break;case"select":t=n.value,t!=null&&si(e,!!n.multiple,t,!1)}};W1=Mp;V1=Co;var $S={usingClientEntryPoint:!1,Events:[ol,ei,Ic,$1,U1,Mp]},ss={findFiberByHostInstance:lo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},US={bundleType:ss.bundleType,version:ss.version,rendererPackageName:ss.rendererPackageName,rendererConfig:ss.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:na.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=q1(e),e===null?null:e.stateNode},findFiberByHostInstance:ss.findFiberByHostInstance||BS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ul=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ul.isDisabled&&Ul.supportsFiber)try{Sc=Ul.inject(US),jr=Ul}catch{}}Mn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$S;Mn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Wp(t))throw Error(re(200));return LS(e,t,null,n)};Mn.createRoot=function(e,t){if(!Wp(e))throw Error(re(299));var n=!1,r="",a=j2;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=zp(e,1,!1,null,null,n,!1,r,a),e[Yr]=t.current,Os(e.nodeType===8?e.parentNode:e),new Up(t)};Mn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(re(188)):(e=Object.keys(e).join(","),Error(re(268,e)));return e=q1(t),e=e===null?null:e.stateNode,e};Mn.flushSync=function(e){return Co(e)};Mn.hydrate=function(e,t,n){if(!Bc(t))throw Error(re(200));return zc(null,e,t,!0,n)};Mn.hydrateRoot=function(e,t,n){if(!Wp(e))throw Error(re(405));var r=n!=null&&n.hydratedSources||null,a=!1,o="",i=j2;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),t=k2(t,null,e,1,n??null,a,!1,o,i),e[Yr]=t.current,Os(e),r)for(e=0;e<r.length;e++)n=r[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Lc(t)};Mn.render=function(e,t,n){if(!Bc(t))throw Error(re(200));return zc(null,e,t,!1,n)};Mn.unmountComponentAtNode=function(e){if(!Bc(e))throw Error(re(40));return e._reactRootContainer?(Co(function(){zc(null,null,e,!1,function(){e._reactRootContainer=null,e[Yr]=null})}),!0):!1};Mn.unstable_batchedUpdates=Mp;Mn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Bc(n))throw Error(re(200));if(e==null||e._reactInternals===void 0)throw Error(re(38));return zc(e,t,n,!1,r)};Mn.version="18.3.1-next-f1338f8080-20240426";function S2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(S2)}catch(e){console.error(e)}}S2(),S1.exports=Mn;var WS=S1.exports,yx=WS;bh.createRoot=yx.createRoot,bh.hydrateRoot=yx.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Gs(){return Gs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Gs.apply(this,arguments)}var Ca;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Ca||(Ca={}));const bx="popstate";function VS(e){e===void 0&&(e={});function t(r,a){let{pathname:o,search:i,hash:s}=r.location;return pf("",{pathname:o,search:i,hash:s},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:Ku(a)}return GS(t,n,null,e)}function gt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Vp(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function HS(){return Math.random().toString(36).substr(2,8)}function wx(e,t){return{usr:e.state,key:e.key,idx:t}}function pf(e,t,n,r){return n===void 0&&(n=null),Gs({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Hi(t):t,{state:n,key:t&&t.key||r||HS()})}function Ku(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function Hi(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function GS(e,t,n,r){r===void 0&&(r={});let{window:a=document.defaultView,v5Compat:o=!1}=r,i=a.history,s=Ca.Pop,l=null,c=d();c==null&&(c=0,i.replaceState(Gs({},i.state,{idx:c}),""));function d(){return(i.state||{idx:null}).idx}function h(){s=Ca.Pop;let y=d(),m=y==null?null:y-c;c=y,l&&l({action:s,location:g.location,delta:m})}function f(y,m){s=Ca.Push;let x=pf(g.location,y,m);c=d()+1;let b=wx(x,c),w=g.createHref(x);try{i.pushState(b,"",w)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;a.location.assign(w)}o&&l&&l({action:s,location:g.location,delta:1})}function p(y,m){s=Ca.Replace;let x=pf(g.location,y,m);c=d();let b=wx(x,c),w=g.createHref(x);i.replaceState(b,"",w),o&&l&&l({action:s,location:g.location,delta:0})}function v(y){let m=a.location.origin!=="null"?a.location.origin:a.location.href,x=typeof y=="string"?y:Ku(y);return x=x.replace(/ $/,"%20"),gt(m,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,m)}let g={get action(){return s},get location(){return e(a,i)},listen(y){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(bx,h),l=y,()=>{a.removeEventListener(bx,h),l=null}},createHref(y){return t(a,y)},createURL:v,encodeLocation(y){let m=v(y);return{pathname:m.pathname,search:m.search,hash:m.hash}},push:f,replace:p,go(y){return i.go(y)}};return g}var Nx;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Nx||(Nx={}));function qS(e,t,n){return n===void 0&&(n="/"),KS(e,t,n)}function KS(e,t,n,r){let a=typeof t=="string"?Hi(t):t,o=Hp(a.pathname||"/",n);if(o==null)return null;let i=E2(e);XS(i);let s=null;for(let l=0;s==null&&l<i.length;++l){let c=sE(o);s=aE(i[l],c)}return s}function E2(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let a=(o,i,s)=>{let l={relativePath:s===void 0?o.path||"":s,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};l.relativePath.startsWith("/")&&(gt(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=Fa([r,l.relativePath]),d=n.concat(l);o.children&&o.children.length>0&&(gt(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),E2(o.children,t,d,c)),!(o.path==null&&!o.index)&&t.push({path:c,score:nE(c,o.index),routesMeta:d})};return e.forEach((o,i)=>{var s;if(o.path===""||!((s=o.path)!=null&&s.includes("?")))a(o,i);else for(let l of _2(o.path))a(o,i,l)}),t}function _2(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,a=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return a?[o,""]:[o];let i=_2(r.join("/")),s=[];return s.push(...i.map(l=>l===""?o:[o,l].join("/"))),a&&s.push(...i),s.map(l=>e.startsWith("/")&&l===""?"/":l)}function XS(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:rE(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const YS=/^:[\w-]+$/,QS=3,JS=2,ZS=1,eE=10,tE=-2,Cx=e=>e==="*";function nE(e,t){let n=e.split("/"),r=n.length;return n.some(Cx)&&(r+=tE),t&&(r+=JS),n.filter(a=>!Cx(a)).reduce((a,o)=>a+(YS.test(o)?QS:o===""?ZS:eE),r)}function rE(e,t){return e.length===t.length&&e.slice(0,-1).every((r,a)=>r===t[a])?e[e.length-1]-t[t.length-1]:0}function aE(e,t,n){let{routesMeta:r}=e,a={},o="/",i=[];for(let s=0;s<r.length;++s){let l=r[s],c=s===r.length-1,d=o==="/"?t:t.slice(o.length)||"/",h=oE({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},d),f=l.route;if(!h)return null;Object.assign(a,h.params),i.push({params:a,pathname:Fa([o,h.pathname]),pathnameBase:hE(Fa([o,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(o=Fa([o,h.pathnameBase]))}return i}function oE(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=iE(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let o=a[0],i=o.replace(/(.)\/+$/,"$1"),s=a.slice(1);return{params:r.reduce((c,d,h)=>{let{paramName:f,isOptional:p}=d;if(f==="*"){let g=s[h]||"";i=o.slice(0,o.length-g.length).replace(/(.)\/+$/,"$1")}const v=s[h];return p&&!v?c[f]=void 0:c[f]=(v||"").replace(/%2F/g,"/"),c},{}),pathname:o,pathnameBase:i,pattern:e}}function iE(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),Vp(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,s,l)=>(r.push({paramName:s,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function sE(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Vp(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Hp(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}const lE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,uE=e=>lE.test(e);function cE(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:a=""}=typeof e=="string"?Hi(e):e,o;if(n)if(uE(n))o=n;else{if(n.includes("//")){let i=n;n=n.replace(/\/\/+/g,"/"),Vp(!1,"Pathnames cannot have embedded double slashes - normalizing "+(i+" -> "+n))}n.startsWith("/")?o=kx(n.substring(1),"/"):o=kx(n,t)}else o=t;return{pathname:o,search:fE(r),hash:pE(a)}}function kx(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function $d(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function dE(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function Gp(e,t){let n=dE(e);return t?n.map((r,a)=>a===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function qp(e,t,n,r){r===void 0&&(r=!1);let a;typeof e=="string"?a=Hi(e):(a=Gs({},e),gt(!a.pathname||!a.pathname.includes("?"),$d("?","pathname","search",a)),gt(!a.pathname||!a.pathname.includes("#"),$d("#","pathname","hash",a)),gt(!a.search||!a.search.includes("#"),$d("#","search","hash",a)));let o=e===""||a.pathname==="",i=o?"/":a.pathname,s;if(i==null)s=n;else{let h=t.length-1;if(!r&&i.startsWith("..")){let f=i.split("/");for(;f[0]==="..";)f.shift(),h-=1;a.pathname=f.join("/")}s=h>=0?t[h]:"/"}let l=cE(a,s),c=i&&i!=="/"&&i.endsWith("/"),d=(o||i===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||d)&&(l.pathname+="/"),l}const Fa=e=>e.join("/").replace(/\/\/+/g,"/"),hE=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),fE=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,pE=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function mE(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const R2=["post","put","patch","delete"];new Set(R2);const vE=["get",...R2];new Set(vE);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function qs(){return qs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qs.apply(this,arguments)}const Kp=I.createContext(null),gE=I.createContext(null),Ka=I.createContext(null),$c=I.createContext(null),ra=I.createContext({outlet:null,matches:[],isDataRoute:!1}),I2=I.createContext(null);function xE(e,t){let{relative:n}=t===void 0?{}:t;Gi()||gt(!1);let{basename:r,navigator:a}=I.useContext(Ka),{hash:o,pathname:i,search:s}=D2(e,{relative:n}),l=i;return r!=="/"&&(l=i==="/"?r:Fa([r,i])),a.createHref({pathname:l,search:s,hash:o})}function Gi(){return I.useContext($c)!=null}function Xa(){return Gi()||gt(!1),I.useContext($c).location}function A2(e){I.useContext(Ka).static||I.useLayoutEffect(e)}function sr(){let{isDataRoute:e}=I.useContext(ra);return e?AE():yE()}function yE(){Gi()||gt(!1);let e=I.useContext(Kp),{basename:t,future:n,navigator:r}=I.useContext(Ka),{matches:a}=I.useContext(ra),{pathname:o}=Xa(),i=JSON.stringify(Gp(a,n.v7_relativeSplatPath)),s=I.useRef(!1);return A2(()=>{s.current=!0}),I.useCallback(function(c,d){if(d===void 0&&(d={}),!s.current)return;if(typeof c=="number"){r.go(c);return}let h=qp(c,JSON.parse(i),o,d.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:Fa([t,h.pathname])),(d.replace?r.replace:r.push)(h,d.state,d)},[t,r,i,o,e])}function aa(){let{matches:e}=I.useContext(ra),t=e[e.length-1];return t?t.params:{}}function D2(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=I.useContext(Ka),{matches:a}=I.useContext(ra),{pathname:o}=Xa(),i=JSON.stringify(Gp(a,r.v7_relativeSplatPath));return I.useMemo(()=>qp(e,JSON.parse(i),o,n==="path"),[e,i,o,n])}function bE(e,t){return wE(e,t)}function wE(e,t,n,r){Gi()||gt(!1);let{navigator:a}=I.useContext(Ka),{matches:o}=I.useContext(ra),i=o[o.length-1],s=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let c=Xa(),d;if(t){var h;let y=typeof t=="string"?Hi(t):t;l==="/"||(h=y.pathname)!=null&&h.startsWith(l)||gt(!1),d=y}else d=c;let f=d.pathname||"/",p=f;if(l!=="/"){let y=l.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(y.length).join("/")}let v=qS(e,{pathname:p}),g=SE(v&&v.map(y=>Object.assign({},y,{params:Object.assign({},s,y.params),pathname:Fa([l,a.encodeLocation?a.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?l:Fa([l,a.encodeLocation?a.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),o,n,r);return t&&g?I.createElement($c.Provider,{value:{location:qs({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Ca.Pop}},g):g}function NE(){let e=IE(),t=mE(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return I.createElement(I.Fragment,null,I.createElement("h2",null,"Unexpected Application Error!"),I.createElement("h3",{style:{fontStyle:"italic"}},t),n?I.createElement("pre",{style:a},n):null,null)}const CE=I.createElement(NE,null);class kE extends I.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?I.createElement(ra.Provider,{value:this.props.routeContext},I.createElement(I2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function jE(e){let{routeContext:t,match:n,children:r}=e,a=I.useContext(Kp);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),I.createElement(ra.Provider,{value:t},r)}function SE(e,t,n,r){var a;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var o;if(!n)return null;if(n.errors)e=n.matches;else if((o=r)!=null&&o.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let i=e,s=(a=n)==null?void 0:a.errors;if(s!=null){let d=i.findIndex(h=>h.route.id&&(s==null?void 0:s[h.route.id])!==void 0);d>=0||gt(!1),i=i.slice(0,Math.min(i.length,d+1))}let l=!1,c=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<i.length;d++){let h=i[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=d),h.route.id){let{loaderData:f,errors:p}=n,v=h.route.loader&&f[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||v){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}return i.reduceRight((d,h,f)=>{let p,v=!1,g=null,y=null;n&&(p=s&&h.route.id?s[h.route.id]:void 0,g=h.route.errorElement||CE,l&&(c<0&&f===0?(DE("route-fallback"),v=!0,y=null):c===f&&(v=!0,y=h.route.hydrateFallbackElement||null)));let m=t.concat(i.slice(0,f+1)),x=()=>{let b;return p?b=g:v?b=y:h.route.Component?b=I.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=d,I.createElement(jE,{match:h,routeContext:{outlet:d,matches:m,isDataRoute:n!=null},children:b})};return n&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?I.createElement(kE,{location:n.location,revalidation:n.revalidation,component:g,error:p,children:x(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):x()},null)}var T2=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(T2||{}),P2=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(P2||{});function EE(e){let t=I.useContext(Kp);return t||gt(!1),t}function _E(e){let t=I.useContext(gE);return t||gt(!1),t}function RE(e){let t=I.useContext(ra);return t||gt(!1),t}function F2(e){let t=RE(),n=t.matches[t.matches.length-1];return n.route.id||gt(!1),n.route.id}function IE(){var e;let t=I.useContext(I2),n=_E(),r=F2();return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function AE(){let{router:e}=EE(T2.UseNavigateStable),t=F2(P2.UseNavigateStable),n=I.useRef(!1);return A2(()=>{n.current=!0}),I.useCallback(function(a,o){o===void 0&&(o={}),n.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,qs({fromRouteId:t},o)))},[e,t])}const jx={};function DE(e,t,n){jx[e]||(jx[e]=!0)}function TE(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function M2(e){let{to:t,replace:n,state:r,relative:a}=e;Gi()||gt(!1);let{future:o,static:i}=I.useContext(Ka),{matches:s}=I.useContext(ra),{pathname:l}=Xa(),c=sr(),d=qp(t,Gp(s,o.v7_relativeSplatPath),l,a==="path"),h=JSON.stringify(d);return I.useEffect(()=>c(JSON.parse(h),{replace:n,state:r,relative:a}),[c,h,a,n,r]),null}function nt(e){gt(!1)}function PE(e){let{basename:t="/",children:n=null,location:r,navigationType:a=Ca.Pop,navigator:o,static:i=!1,future:s}=e;Gi()&&gt(!1);let l=t.replace(/^\/*/,"/"),c=I.useMemo(()=>({basename:l,navigator:o,static:i,future:qs({v7_relativeSplatPath:!1},s)}),[l,s,o,i]);typeof r=="string"&&(r=Hi(r));let{pathname:d="/",search:h="",hash:f="",state:p=null,key:v="default"}=r,g=I.useMemo(()=>{let y=Hp(d,l);return y==null?null:{location:{pathname:y,search:h,hash:f,state:p,key:v},navigationType:a}},[l,d,h,f,p,v,a]);return g==null?null:I.createElement(Ka.Provider,{value:c},I.createElement($c.Provider,{children:n,value:g}))}function FE(e){let{children:t,location:n}=e;return bE(mf(t),n)}new Promise(()=>{});function mf(e,t){t===void 0&&(t=[]);let n=[];return I.Children.forEach(e,(r,a)=>{if(!I.isValidElement(r))return;let o=[...t,a];if(r.type===I.Fragment){n.push.apply(n,mf(r.props.children,o));return}r.type!==nt&&gt(!1),!r.props.index||!r.props.children||gt(!1);let i={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(i.children=mf(r.props.children,o)),n.push(i)}),n}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vf(){return vf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vf.apply(this,arguments)}function ME(e,t){if(e==null)return{};var n={},r=Object.keys(e),a,o;for(o=0;o<r.length;o++)a=r[o],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function OE(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function LE(e,t){return e.button===0&&(!t||t==="_self")&&!OE(e)}function gf(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(a=>[n,a]):[[n,r]])},[]))}function BE(e,t){let n=gf(e);return t&&t.forEach((r,a)=>{n.has(a)||t.getAll(a).forEach(o=>{n.append(a,o)})}),n}const zE=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],$E="6";try{window.__reactRouterVersion=$E}catch{}const UE="startTransition",Sx=Dk[UE];function WE(e){let{basename:t,children:n,future:r,window:a}=e,o=I.useRef();o.current==null&&(o.current=VS({window:a,v5Compat:!0}));let i=o.current,[s,l]=I.useState({action:i.action,location:i.location}),{v7_startTransition:c}=r||{},d=I.useCallback(h=>{c&&Sx?Sx(()=>l(h)):l(h)},[l,c]);return I.useLayoutEffect(()=>i.listen(d),[i,d]),I.useEffect(()=>TE(r),[r]),I.createElement(PE,{basename:t,children:n,location:s.location,navigationType:s.action,navigator:i,future:r})}const VE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",HE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Fe=I.forwardRef(function(t,n){let{onClick:r,relative:a,reloadDocument:o,replace:i,state:s,target:l,to:c,preventScrollReset:d,viewTransition:h}=t,f=ME(t,zE),{basename:p}=I.useContext(Ka),v,g=!1;if(typeof c=="string"&&HE.test(c)&&(v=c,VE))try{let b=new URL(window.location.href),w=c.startsWith("//")?new URL(b.protocol+c):new URL(c),N=Hp(w.pathname,p);w.origin===b.origin&&N!=null?c=N+w.search+w.hash:g=!0}catch{}let y=xE(c,{relative:a}),m=GE(c,{replace:i,state:s,target:l,preventScrollReset:d,relative:a,viewTransition:h});function x(b){r&&r(b),b.defaultPrevented||m(b)}return I.createElement("a",vf({},f,{href:v||y,onClick:g||o?r:x,ref:n,target:l}))});var Ex;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Ex||(Ex={}));var _x;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(_x||(_x={}));function GE(e,t){let{target:n,replace:r,state:a,preventScrollReset:o,relative:i,viewTransition:s}=t===void 0?{}:t,l=sr(),c=Xa(),d=D2(e,{relative:i});return I.useCallback(h=>{if(LE(h,n)){h.preventDefault();let f=r!==void 0?r:Ku(c)===Ku(d);l(e,{replace:f,state:a,preventScrollReset:o,relative:i,viewTransition:s})}},[c,l,d,r,a,n,e,o,i,s])}function qE(e){let t=I.useRef(gf(e)),n=I.useRef(!1),r=Xa(),a=I.useMemo(()=>BE(r.search,n.current?null:t.current),[r.search]),o=sr(),i=I.useCallback((s,l)=>{const c=gf(typeof s=="function"?s(a):s);n.current=!0,o("?"+c,l)},[o,a]);return[a,i]}let KE={data:""},XE=e=>{if(typeof window=="object"){let t=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return t.nonce=window.__nonce__,t.parentNode||(e||document.head).appendChild(t),t.firstChild}return e||KE},YE=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,QE=/\/\*[^]*?\*\/|  +/g,Rx=/\n+/g,ba=(e,t)=>{let n="",r="",a="";for(let o in e){let i=e[o];o[0]=="@"?o[1]=="i"?n=o+" "+i+";":r+=o[1]=="f"?ba(i,o):o+"{"+ba(i,o[1]=="k"?"":t)+"}":typeof i=="object"?r+=ba(i,t?t.replace(/([^,])+/g,s=>o.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,s):s?s+" "+l:l)):o):i!=null&&(o=/^--/.test(o)?o:o.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=ba.p?ba.p(o,i):o+":"+i+";")}return n+(t&&a?t+"{"+a+"}":a)+r},Br={},O2=e=>{if(typeof e=="object"){let t="";for(let n in e)t+=n+O2(e[n]);return t}return e},JE=(e,t,n,r,a)=>{let o=O2(e),i=Br[o]||(Br[o]=(l=>{let c=0,d=11;for(;c<l.length;)d=101*d+l.charCodeAt(c++)>>>0;return"go"+d})(o));if(!Br[i]){let l=o!==e?e:(c=>{let d,h,f=[{}];for(;d=YE.exec(c.replace(QE,""));)d[4]?f.shift():d[3]?(h=d[3].replace(Rx," ").trim(),f.unshift(f[0][h]=f[0][h]||{})):f[0][d[1]]=d[2].replace(Rx," ").trim();return f[0]})(e);Br[i]=ba(a?{["@keyframes "+i]:l}:l,n?"":"."+i)}let s=n&&Br.g?Br.g:null;return n&&(Br.g=Br[i]),((l,c,d,h)=>{h?c.data=c.data.replace(h,l):c.data.indexOf(l)===-1&&(c.data=d?l+c.data:c.data+l)})(Br[i],t,r,s),i},ZE=(e,t,n)=>e.reduce((r,a,o)=>{let i=t[o];if(i&&i.call){let s=i(n),l=s&&s.props&&s.props.className||/^go/.test(s)&&s;i=l?"."+l:s&&typeof s=="object"?s.props?"":ba(s,""):s===!1?"":s}return r+a+(i??"")},"");function Uc(e){let t=this||{},n=e.call?e(t.p):e;return JE(n.unshift?n.raw?ZE(n,[].slice.call(arguments,1),t.p):n.reduce((r,a)=>Object.assign(r,a&&a.call?a(t.p):a),{}):n,XE(t.target),t.g,t.o,t.k)}let L2,xf,yf;Uc.bind({g:1});let Zr=Uc.bind({k:1});function e4(e,t,n,r){ba.p=t,L2=e,xf=n,yf=r}function Ya(e,t){let n=this||{};return function(){let r=arguments;function a(o,i){let s=Object.assign({},o),l=s.className||a.className;n.p=Object.assign({theme:xf&&xf()},s),n.o=/ *go\d+/.test(l),s.className=Uc.apply(n,r)+(l?" "+l:"");let c=e;return e[0]&&(c=s.as||e,delete s.as),yf&&c[0]&&yf(s),L2(c,s)}return a}}var t4=e=>typeof e=="function",Xu=(e,t)=>t4(e)?e(t):e,n4=(()=>{let e=0;return()=>(++e).toString()})(),B2=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),r4=20,Xp="default",z2=(e,t)=>{let{toastLimit:n}=e.settings;switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,n)};case 1:return{...e,toasts:e.toasts.map(i=>i.id===t.toast.id?{...i,...t.toast}:i)};case 2:let{toast:r}=t;return z2(e,{type:e.toasts.find(i=>i.id===r.id)?1:0,toast:r});case 3:let{toastId:a}=t;return{...e,toasts:e.toasts.map(i=>i.id===a||a===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(i=>i.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let o=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+o}))}}},xu=[],$2={toasts:[],pausedAt:void 0,settings:{toastLimit:r4}},Nr={},U2=(e,t=Xp)=>{Nr[t]=z2(Nr[t]||$2,e),xu.forEach(([n,r])=>{n===t&&r(Nr[t])})},W2=e=>Object.keys(Nr).forEach(t=>U2(e,t)),a4=e=>Object.keys(Nr).find(t=>Nr[t].toasts.some(n=>n.id===e)),Wc=(e=Xp)=>t=>{U2(t,e)},o4={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},i4=(e={},t=Xp)=>{let[n,r]=I.useState(Nr[t]||$2),a=I.useRef(Nr[t]);I.useEffect(()=>(a.current!==Nr[t]&&r(Nr[t]),xu.push([t,r]),()=>{let i=xu.findIndex(([s])=>s===t);i>-1&&xu.splice(i,1)}),[t]);let o=n.toasts.map(i=>{var s,l,c;return{...e,...e[i.type],...i,removeDelay:i.removeDelay||((s=e[i.type])==null?void 0:s.removeDelay)||(e==null?void 0:e.removeDelay),duration:i.duration||((l=e[i.type])==null?void 0:l.duration)||(e==null?void 0:e.duration)||o4[i.type],style:{...e.style,...(c=e[i.type])==null?void 0:c.style,...i.style}}});return{...n,toasts:o}},s4=(e,t="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...n,id:(n==null?void 0:n.id)||n4()}),sl=e=>(t,n)=>{let r=s4(t,e,n);return Wc(r.toasterId||a4(r.id))({type:2,toast:r}),r.id},St=(e,t)=>sl("blank")(e,t);St.error=sl("error");St.success=sl("success");St.loading=sl("loading");St.custom=sl("custom");St.dismiss=(e,t)=>{let n={type:3,toastId:e};t?Wc(t)(n):W2(n)};St.dismissAll=e=>St.dismiss(void 0,e);St.remove=(e,t)=>{let n={type:4,toastId:e};t?Wc(t)(n):W2(n)};St.removeAll=e=>St.remove(void 0,e);St.promise=(e,t,n)=>{let r=St.loading(t.loading,{...n,...n==null?void 0:n.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let o=t.success?Xu(t.success,a):void 0;return o?St.success(o,{id:r,...n,...n==null?void 0:n.success}):St.dismiss(r),a}).catch(a=>{let o=t.error?Xu(t.error,a):void 0;o?St.error(o,{id:r,...n,...n==null?void 0:n.error}):St.dismiss(r)}),e};var l4=1e3,u4=(e,t="default")=>{let{toasts:n,pausedAt:r}=i4(e,t),a=I.useRef(new Map).current,o=I.useCallback((h,f=l4)=>{if(a.has(h))return;let p=setTimeout(()=>{a.delete(h),i({type:4,toastId:h})},f);a.set(h,p)},[]);I.useEffect(()=>{if(r)return;let h=Date.now(),f=n.map(p=>{if(p.duration===1/0)return;let v=(p.duration||0)+p.pauseDuration-(h-p.createdAt);if(v<0){p.visible&&St.dismiss(p.id);return}return setTimeout(()=>St.dismiss(p.id,t),v)});return()=>{f.forEach(p=>p&&clearTimeout(p))}},[n,r,t]);let i=I.useCallback(Wc(t),[t]),s=I.useCallback(()=>{i({type:5,time:Date.now()})},[i]),l=I.useCallback((h,f)=>{i({type:1,toast:{id:h,height:f}})},[i]),c=I.useCallback(()=>{r&&i({type:6,time:Date.now()})},[r,i]),d=I.useCallback((h,f)=>{let{reverseOrder:p=!1,gutter:v=8,defaultPosition:g}=f||{},y=n.filter(b=>(b.position||g)===(h.position||g)&&b.height),m=y.findIndex(b=>b.id===h.id),x=y.filter((b,w)=>w<m&&b.visible).length;return y.filter(b=>b.visible).slice(...p?[x+1]:[0,x]).reduce((b,w)=>b+(w.height||0)+v,0)},[n]);return I.useEffect(()=>{n.forEach(h=>{if(h.dismissed)o(h.id,h.removeDelay);else{let f=a.get(h.id);f&&(clearTimeout(f),a.delete(h.id))}})},[n,o]),{toasts:n,handlers:{updateHeight:l,startPause:s,endPause:c,calculateOffset:d}}},c4=Zr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,d4=Zr`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,h4=Zr`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,f4=Ya("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${c4} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${d4} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${h4} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,p4=Zr`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,m4=Ya("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${p4} 1s linear infinite;
`,v4=Zr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,g4=Zr`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,x4=Ya("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${v4} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${g4} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,y4=Ya("div")`
  position: absolute;
`,b4=Ya("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,w4=Zr`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,N4=Ya("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${w4} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,C4=({toast:e})=>{let{icon:t,type:n,iconTheme:r}=e;return t!==void 0?typeof t=="string"?I.createElement(N4,null,t):t:n==="blank"?null:I.createElement(b4,null,I.createElement(m4,{...r}),n!=="loading"&&I.createElement(y4,null,n==="error"?I.createElement(f4,{...r}):I.createElement(x4,{...r})))},k4=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,j4=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,S4="0%{opacity:0;} 100%{opacity:1;}",E4="0%{opacity:1;} 100%{opacity:0;}",_4=Ya("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,R4=Ya("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,I4=(e,t)=>{let n=e.includes("top")?1:-1,[r,a]=B2()?[S4,E4]:[k4(n),j4(n)];return{animation:t?`${Zr(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Zr(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},A4=I.memo(({toast:e,position:t,style:n,children:r})=>{let a=e.height?I4(e.position||t||"top-center",e.visible):{opacity:0},o=I.createElement(C4,{toast:e}),i=I.createElement(R4,{...e.ariaProps},Xu(e.message,e));return I.createElement(_4,{className:e.className,style:{...a,...n,...e.style}},typeof r=="function"?r({icon:o,message:i}):I.createElement(I.Fragment,null,o,i))});e4(I.createElement);var D4=({id:e,className:t,style:n,onHeightUpdate:r,children:a})=>{let o=I.useCallback(i=>{if(i){let s=()=>{let l=i.getBoundingClientRect().height;r(e,l)};s(),new MutationObserver(s).observe(i,{subtree:!0,childList:!0,characterData:!0})}},[e,r]);return I.createElement("div",{ref:o,className:t,style:n},a)},T4=(e,t)=>{let n=e.includes("top"),r=n?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:B2()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(n?1:-1)}px)`,...r,...a}},P4=Uc`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Wl=16,F4=({reverseOrder:e,position:t="top-center",toastOptions:n,gutter:r,children:a,toasterId:o,containerStyle:i,containerClassName:s})=>{let{toasts:l,handlers:c}=u4(n,o);return I.createElement("div",{"data-rht-toaster":o||"",style:{position:"fixed",zIndex:9999,top:Wl,left:Wl,right:Wl,bottom:Wl,pointerEvents:"none",...i},className:s,onMouseEnter:c.startPause,onMouseLeave:c.endPause},l.map(d=>{let h=d.position||t,f=c.calculateOffset(d,{reverseOrder:e,gutter:r,defaultPosition:t}),p=T4(h,f);return I.createElement(D4,{id:d.id,key:d.id,onHeightUpdate:c.updateHeight,className:d.visible?P4:"",style:p},d.type==="custom"?Xu(d.message,d):a?a(d):I.createElement(A4,{toast:d,position:h}))}))},V=St;const M4={},Ix=e=>{let t;const n=new Set,r=(d,h)=>{const f=typeof d=="function"?d(t):d;if(!Object.is(f,t)){const p=t;t=h??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(v=>v(t,p))}},a=()=>t,l={setState:r,getState:a,getInitialState:()=>c,subscribe:d=>(n.add(d),()=>n.delete(d)),destroy:()=>{(M4?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=t=e(r,a,l);return l},O4=e=>e?Ix(e):Ix;var V2={exports:{}},H2={},G2={exports:{}},q2={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ii=I;function L4(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var B4=typeof Object.is=="function"?Object.is:L4,z4=Ii.useState,$4=Ii.useEffect,U4=Ii.useLayoutEffect,W4=Ii.useDebugValue;function V4(e,t){var n=t(),r=z4({inst:{value:n,getSnapshot:t}}),a=r[0].inst,o=r[1];return U4(function(){a.value=n,a.getSnapshot=t,Ud(a)&&o({inst:a})},[e,n,t]),$4(function(){return Ud(a)&&o({inst:a}),e(function(){Ud(a)&&o({inst:a})})},[e]),W4(n),n}function Ud(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!B4(e,n)}catch{return!0}}function H4(e,t){return t()}var G4=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?H4:V4;q2.useSyncExternalStore=Ii.useSyncExternalStore!==void 0?Ii.useSyncExternalStore:G4;G2.exports=q2;var q4=G2.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vc=I,K4=q4;function X4(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Y4=typeof Object.is=="function"?Object.is:X4,Q4=K4.useSyncExternalStore,J4=Vc.useRef,Z4=Vc.useEffect,e3=Vc.useMemo,t3=Vc.useDebugValue;H2.useSyncExternalStoreWithSelector=function(e,t,n,r,a){var o=J4(null);if(o.current===null){var i={hasValue:!1,value:null};o.current=i}else i=o.current;o=e3(function(){function l(p){if(!c){if(c=!0,d=p,p=r(p),a!==void 0&&i.hasValue){var v=i.value;if(a(v,p))return h=v}return h=p}if(v=h,Y4(d,p))return v;var g=r(p);return a!==void 0&&a(v,g)?(d=p,v):(d=p,h=g)}var c=!1,d,h,f=n===void 0?null:n;return[function(){return l(t())},f===null?void 0:function(){return l(f())}]},[t,n,r,a]);var s=Q4(e,o[0],o[1]);return Z4(function(){i.hasValue=!0,i.value=s},[s]),t3(s),s};V2.exports=H2;var n3=V2.exports;const r3=p1(n3),K2={},{useDebugValue:a3}=jc,{useSyncExternalStoreWithSelector:o3}=r3;let Ax=!1;const i3=e=>e;function s3(e,t=i3,n){(K2?"production":void 0)!=="production"&&n&&!Ax&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Ax=!0);const r=o3(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return a3(r),r}const Dx=e=>{(K2?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?O4(e):e,n=(r,a)=>s3(t,r,a);return Object.assign(n,t),n},l3=e=>e?Dx(e):Dx,u3={};function c3(e,t){let n;try{n=e()}catch{return}return{getItem:a=>{var o;const i=l=>l===null?null:JSON.parse(l,void 0),s=(o=n.getItem(a))!=null?o:null;return s instanceof Promise?s.then(i):i(s)},setItem:(a,o)=>n.setItem(a,JSON.stringify(o,void 0)),removeItem:a=>n.removeItem(a)}}const Ks=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then(r){return Ks(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return Ks(r)(n)}}}},d3=(e,t)=>(n,r,a)=>{let o={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:y=>y,version:0,merge:(y,m)=>({...m,...y}),...t},i=!1;const s=new Set,l=new Set;let c;try{c=o.getStorage()}catch{}if(!c)return e((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),n(...y)},r,a);const d=Ks(o.serialize),h=()=>{const y=o.partialize({...r()});let m;const x=d({state:y,version:o.version}).then(b=>c.setItem(o.name,b)).catch(b=>{m=b});if(m)throw m;return x},f=a.setState;a.setState=(y,m)=>{f(y,m),h()};const p=e((...y)=>{n(...y),h()},r,a);let v;const g=()=>{var y;if(!c)return;i=!1,s.forEach(x=>x(r()));const m=((y=o.onRehydrateStorage)==null?void 0:y.call(o,r()))||void 0;return Ks(c.getItem.bind(c))(o.name).then(x=>{if(x)return o.deserialize(x)}).then(x=>{if(x)if(typeof x.version=="number"&&x.version!==o.version){if(o.migrate)return o.migrate(x.state,x.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return x.state}).then(x=>{var b;return v=o.merge(x,(b=r())!=null?b:p),n(v,!0),h()}).then(()=>{m==null||m(v,void 0),i=!0,l.forEach(x=>x(v))}).catch(x=>{m==null||m(void 0,x)})};return a.persist={setOptions:y=>{o={...o,...y},y.getStorage&&(c=y.getStorage())},clearStorage:()=>{c==null||c.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>g(),hasHydrated:()=>i,onHydrate:y=>(s.add(y),()=>{s.delete(y)}),onFinishHydration:y=>(l.add(y),()=>{l.delete(y)})},g(),v||p},h3=(e,t)=>(n,r,a)=>{let o={storage:c3(()=>localStorage),partialize:g=>g,version:0,merge:(g,y)=>({...y,...g}),...t},i=!1;const s=new Set,l=new Set;let c=o.storage;if(!c)return e((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),n(...g)},r,a);const d=()=>{const g=o.partialize({...r()});return c.setItem(o.name,{state:g,version:o.version})},h=a.setState;a.setState=(g,y)=>{h(g,y),d()};const f=e((...g)=>{n(...g),d()},r,a);a.getInitialState=()=>f;let p;const v=()=>{var g,y;if(!c)return;i=!1,s.forEach(x=>{var b;return x((b=r())!=null?b:f)});const m=((y=o.onRehydrateStorage)==null?void 0:y.call(o,(g=r())!=null?g:f))||void 0;return Ks(c.getItem.bind(c))(o.name).then(x=>{if(x)if(typeof x.version=="number"&&x.version!==o.version){if(o.migrate)return[!0,o.migrate(x.state,x.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,x.state];return[!1,void 0]}).then(x=>{var b;const[w,N]=x;if(p=o.merge(N,(b=r())!=null?b:f),n(p,!0),w)return d()}).then(()=>{m==null||m(p,void 0),p=r(),i=!0,l.forEach(x=>x(p))}).catch(x=>{m==null||m(void 0,x)})};return a.persist={setOptions:g=>{o={...o,...g},g.storage&&(c=g.storage)},clearStorage:()=>{c==null||c.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>v(),hasHydrated:()=>i,onHydrate:g=>(s.add(g),()=>{s.delete(g)}),onFinishHydration:g=>(l.add(g),()=>{l.delete(g)})},o.skipHydration||v(),p||f},f3=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((u3?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),d3(e,t)):h3(e,t),p3=f3;function X2(e,t){return function(){return e.apply(t,arguments)}}const{toString:m3}=Object.prototype,{getPrototypeOf:Yp}=Object,{iterator:Hc,toStringTag:Y2}=Symbol,Gc=(e=>t=>{const n=m3.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),lr=e=>(e=e.toLowerCase(),t=>Gc(t)===e),qc=e=>t=>typeof t===e,{isArray:qi}=Array,Ai=qc("undefined");function ll(e){return e!==null&&!Ai(e)&&e.constructor!==null&&!Ai(e.constructor)&&bn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Q2=lr("ArrayBuffer");function v3(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Q2(e.buffer),t}const g3=qc("string"),bn=qc("function"),J2=qc("number"),ul=e=>e!==null&&typeof e=="object",x3=e=>e===!0||e===!1,yu=e=>{if(Gc(e)!=="object")return!1;const t=Yp(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Y2 in e)&&!(Hc in e)},y3=e=>{if(!ul(e)||ll(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},b3=lr("Date"),w3=lr("File"),N3=lr("Blob"),C3=lr("FileList"),k3=e=>ul(e)&&bn(e.pipe),j3=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||bn(e.append)&&((t=Gc(e))==="formdata"||t==="object"&&bn(e.toString)&&e.toString()==="[object FormData]"))},S3=lr("URLSearchParams"),[E3,_3,R3,I3]=["ReadableStream","Request","Response","Headers"].map(lr),A3=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function cl(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,a;if(typeof e!="object"&&(e=[e]),qi(e))for(r=0,a=e.length;r<a;r++)t.call(null,e[r],r,e);else{if(ll(e))return;const o=n?Object.getOwnPropertyNames(e):Object.keys(e),i=o.length;let s;for(r=0;r<i;r++)s=o[r],t.call(null,e[s],s,e)}}function Z2(e,t){if(ll(e))return null;t=t.toLowerCase();const n=Object.keys(e);let r=n.length,a;for(;r-- >0;)if(a=n[r],t===a.toLowerCase())return a;return null}const ho=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ew=e=>!Ai(e)&&e!==ho;function bf(){const{caseless:e,skipUndefined:t}=ew(this)&&this||{},n={},r=(a,o)=>{const i=e&&Z2(n,o)||o;yu(n[i])&&yu(a)?n[i]=bf(n[i],a):yu(a)?n[i]=bf({},a):qi(a)?n[i]=a.slice():(!t||!Ai(a))&&(n[i]=a)};for(let a=0,o=arguments.length;a<o;a++)arguments[a]&&cl(arguments[a],r);return n}const D3=(e,t,n,{allOwnKeys:r}={})=>(cl(t,(a,o)=>{n&&bn(a)?Object.defineProperty(e,o,{value:X2(a,n),writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(e,o,{value:a,writable:!0,enumerable:!0,configurable:!0})},{allOwnKeys:r}),e),T3=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),P3=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},F3=(e,t,n,r)=>{let a,o,i;const s={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),o=a.length;o-- >0;)i=a[o],(!r||r(i,e,t))&&!s[i]&&(t[i]=e[i],s[i]=!0);e=n!==!1&&Yp(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},M3=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},O3=e=>{if(!e)return null;if(qi(e))return e;let t=e.length;if(!J2(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},L3=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Yp(Uint8Array)),B3=(e,t)=>{const r=(e&&e[Hc]).call(e);let a;for(;(a=r.next())&&!a.done;){const o=a.value;t.call(e,o[0],o[1])}},z3=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},$3=lr("HTMLFormElement"),U3=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,a){return r.toUpperCase()+a}),Tx=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),W3=lr("RegExp"),tw=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};cl(n,(a,o)=>{let i;(i=t(a,o,e))!==!1&&(r[o]=i||a)}),Object.defineProperties(e,r)},V3=e=>{tw(e,(t,n)=>{if(bn(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(bn(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},H3=(e,t)=>{const n={},r=a=>{a.forEach(o=>{n[o]=!0})};return qi(e)?r(e):r(String(e).split(t)),n},G3=()=>{},q3=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function K3(e){return!!(e&&bn(e.append)&&e[Y2]==="FormData"&&e[Hc])}const X3=e=>{const t=new Array(10),n=(r,a)=>{if(ul(r)){if(t.indexOf(r)>=0)return;if(ll(r))return r;if(!("toJSON"in r)){t[a]=r;const o=qi(r)?[]:{};return cl(r,(i,s)=>{const l=n(i,a+1);!Ai(l)&&(o[s]=l)}),t[a]=void 0,o}}return r};return n(e,0)},Y3=lr("AsyncFunction"),Q3=e=>e&&(ul(e)||bn(e))&&bn(e.then)&&bn(e.catch),nw=((e,t)=>e?setImmediate:t?((n,r)=>(ho.addEventListener("message",({source:a,data:o})=>{a===ho&&o===n&&r.length&&r.shift()()},!1),a=>{r.push(a),ho.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",bn(ho.postMessage)),J3=typeof queueMicrotask<"u"?queueMicrotask.bind(ho):typeof process<"u"&&process.nextTick||nw,Z3=e=>e!=null&&bn(e[Hc]),G={isArray:qi,isArrayBuffer:Q2,isBuffer:ll,isFormData:j3,isArrayBufferView:v3,isString:g3,isNumber:J2,isBoolean:x3,isObject:ul,isPlainObject:yu,isEmptyObject:y3,isReadableStream:E3,isRequest:_3,isResponse:R3,isHeaders:I3,isUndefined:Ai,isDate:b3,isFile:w3,isBlob:N3,isRegExp:W3,isFunction:bn,isStream:k3,isURLSearchParams:S3,isTypedArray:L3,isFileList:C3,forEach:cl,merge:bf,extend:D3,trim:A3,stripBOM:T3,inherits:P3,toFlatObject:F3,kindOf:Gc,kindOfTest:lr,endsWith:M3,toArray:O3,forEachEntry:B3,matchAll:z3,isHTMLForm:$3,hasOwnProperty:Tx,hasOwnProp:Tx,reduceDescriptors:tw,freezeMethods:V3,toObjectSet:H3,toCamelCase:U3,noop:G3,toFiniteNumber:q3,findKey:Z2,global:ho,isContextDefined:ew,isSpecCompliantForm:K3,toJSONObject:X3,isAsyncFn:Y3,isThenable:Q3,setImmediate:nw,asap:J3,isIterable:Z3};let je=class rw extends Error{static from(t,n,r,a,o,i){const s=new rw(t.message,n||t.code,r,a,o);return s.cause=t,s.name=t.name,i&&Object.assign(s,i),s}constructor(t,n,r,a,o){super(t),this.name="AxiosError",this.isAxiosError=!0,n&&(this.code=n),r&&(this.config=r),a&&(this.request=a),o&&(this.response=o,this.status=o.status)}toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:G.toJSONObject(this.config),code:this.code,status:this.status}}};je.ERR_BAD_OPTION_VALUE="ERR_BAD_OPTION_VALUE";je.ERR_BAD_OPTION="ERR_BAD_OPTION";je.ECONNABORTED="ECONNABORTED";je.ETIMEDOUT="ETIMEDOUT";je.ERR_NETWORK="ERR_NETWORK";je.ERR_FR_TOO_MANY_REDIRECTS="ERR_FR_TOO_MANY_REDIRECTS";je.ERR_DEPRECATED="ERR_DEPRECATED";je.ERR_BAD_RESPONSE="ERR_BAD_RESPONSE";je.ERR_BAD_REQUEST="ERR_BAD_REQUEST";je.ERR_CANCELED="ERR_CANCELED";je.ERR_NOT_SUPPORT="ERR_NOT_SUPPORT";je.ERR_INVALID_URL="ERR_INVALID_URL";const e_=null;function wf(e){return G.isPlainObject(e)||G.isArray(e)}function aw(e){return G.endsWith(e,"[]")?e.slice(0,-2):e}function Px(e,t,n){return e?e.concat(t).map(function(a,o){return a=aw(a),!n&&o?"["+a+"]":a}).join(n?".":""):t}function t_(e){return G.isArray(e)&&!e.some(wf)}const n_=G.toFlatObject(G,{},null,function(t){return/^is[A-Z]/.test(t)});function Kc(e,t,n){if(!G.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=G.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,y){return!G.isUndefined(y[g])});const r=n.metaTokens,a=n.visitor||d,o=n.dots,i=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&G.isSpecCompliantForm(t);if(!G.isFunction(a))throw new TypeError("visitor must be a function");function c(v){if(v===null)return"";if(G.isDate(v))return v.toISOString();if(G.isBoolean(v))return v.toString();if(!l&&G.isBlob(v))throw new je("Blob is not supported. Use a Buffer instead.");return G.isArrayBuffer(v)||G.isTypedArray(v)?l&&typeof Blob=="function"?new Blob([v]):Buffer.from(v):v}function d(v,g,y){let m=v;if(v&&!y&&typeof v=="object"){if(G.endsWith(g,"{}"))g=r?g:g.slice(0,-2),v=JSON.stringify(v);else if(G.isArray(v)&&t_(v)||(G.isFileList(v)||G.endsWith(g,"[]"))&&(m=G.toArray(v)))return g=aw(g),m.forEach(function(b,w){!(G.isUndefined(b)||b===null)&&t.append(i===!0?Px([g],w,o):i===null?g:g+"[]",c(b))}),!1}return wf(v)?!0:(t.append(Px(y,g,o),c(v)),!1)}const h=[],f=Object.assign(n_,{defaultVisitor:d,convertValue:c,isVisitable:wf});function p(v,g){if(!G.isUndefined(v)){if(h.indexOf(v)!==-1)throw Error("Circular reference detected in "+g.join("."));h.push(v),G.forEach(v,function(m,x){(!(G.isUndefined(m)||m===null)&&a.call(t,m,G.isString(x)?x.trim():x,g,f))===!0&&p(m,g?g.concat(x):[x])}),h.pop()}}if(!G.isObject(e))throw new TypeError("data must be an object");return p(e),t}function Fx(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function Qp(e,t){this._pairs=[],e&&Kc(e,this,t)}const ow=Qp.prototype;ow.append=function(t,n){this._pairs.push([t,n])};ow.toString=function(t){const n=t?function(r){return t.call(this,r,Fx)}:Fx;return this._pairs.map(function(a){return n(a[0])+"="+n(a[1])},"").join("&")};function r_(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function iw(e,t,n){if(!t)return e;const r=n&&n.encode||r_,a=G.isFunction(n)?{serialize:n}:n,o=a&&a.serialize;let i;if(o?i=o(t,a):i=G.isURLSearchParams(t)?t.toString():new Qp(t,a).toString(r),i){const s=e.indexOf("#");s!==-1&&(e=e.slice(0,s)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class Mx{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){G.forEach(this.handlers,function(r){r!==null&&t(r)})}}const sw={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},a_=typeof URLSearchParams<"u"?URLSearchParams:Qp,o_=typeof FormData<"u"?FormData:null,i_=typeof Blob<"u"?Blob:null,s_={isBrowser:!0,classes:{URLSearchParams:a_,FormData:o_,Blob:i_},protocols:["http","https","file","blob","url","data"]},Jp=typeof window<"u"&&typeof document<"u",Nf=typeof navigator=="object"&&navigator||void 0,l_=Jp&&(!Nf||["ReactNative","NativeScript","NS"].indexOf(Nf.product)<0),u_=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",c_=Jp&&window.location.href||"http://localhost",d_=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Jp,hasStandardBrowserEnv:l_,hasStandardBrowserWebWorkerEnv:u_,navigator:Nf,origin:c_},Symbol.toStringTag,{value:"Module"})),Zt={...d_,...s_};function h_(e,t){return Kc(e,new Zt.classes.URLSearchParams,{visitor:function(n,r,a,o){return Zt.isNode&&G.isBuffer(n)?(this.append(r,n.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)},...t})}function f_(e){return G.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function p_(e){const t={},n=Object.keys(e);let r;const a=n.length;let o;for(r=0;r<a;r++)o=n[r],t[o]=e[o];return t}function lw(e){function t(n,r,a,o){let i=n[o++];if(i==="__proto__")return!0;const s=Number.isFinite(+i),l=o>=n.length;return i=!i&&G.isArray(a)?a.length:i,l?(G.hasOwnProp(a,i)?a[i]=[a[i],r]:a[i]=r,!s):((!a[i]||!G.isObject(a[i]))&&(a[i]=[]),t(n,r,a[i],o)&&G.isArray(a[i])&&(a[i]=p_(a[i])),!s)}if(G.isFormData(e)&&G.isFunction(e.entries)){const n={};return G.forEachEntry(e,(r,a)=>{t(f_(r),a,n,0)}),n}return null}function m_(e,t,n){if(G.isString(e))try{return(t||JSON.parse)(e),G.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const dl={transitional:sw,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",a=r.indexOf("application/json")>-1,o=G.isObject(t);if(o&&G.isHTMLForm(t)&&(t=new FormData(t)),G.isFormData(t))return a?JSON.stringify(lw(t)):t;if(G.isArrayBuffer(t)||G.isBuffer(t)||G.isStream(t)||G.isFile(t)||G.isBlob(t)||G.isReadableStream(t))return t;if(G.isArrayBufferView(t))return t.buffer;if(G.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let s;if(o){if(r.indexOf("application/x-www-form-urlencoded")>-1)return h_(t,this.formSerializer).toString();if((s=G.isFileList(t))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Kc(s?{"files[]":t}:t,l&&new l,this.formSerializer)}}return o||a?(n.setContentType("application/json",!1),m_(t)):t}],transformResponse:[function(t){const n=this.transitional||dl.transitional,r=n&&n.forcedJSONParsing,a=this.responseType==="json";if(G.isResponse(t)||G.isReadableStream(t))return t;if(t&&G.isString(t)&&(r&&!this.responseType||a)){const i=!(n&&n.silentJSONParsing)&&a;try{return JSON.parse(t,this.parseReviver)}catch(s){if(i)throw s.name==="SyntaxError"?je.from(s,je.ERR_BAD_RESPONSE,this,null,this.response):s}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Zt.classes.FormData,Blob:Zt.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};G.forEach(["delete","get","head","post","put","patch"],e=>{dl.headers[e]={}});const v_=G.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),g_=e=>{const t={};let n,r,a;return e&&e.split(`
`).forEach(function(i){a=i.indexOf(":"),n=i.substring(0,a).trim().toLowerCase(),r=i.substring(a+1).trim(),!(!n||t[n]&&v_[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},Ox=Symbol("internals");function ls(e){return e&&String(e).trim().toLowerCase()}function bu(e){return e===!1||e==null?e:G.isArray(e)?e.map(bu):String(e)}function x_(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const y_=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Wd(e,t,n,r,a){if(G.isFunction(r))return r.call(this,t,n);if(a&&(t=n),!!G.isString(t)){if(G.isString(r))return t.indexOf(r)!==-1;if(G.isRegExp(r))return r.test(t)}}function b_(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function w_(e,t){const n=G.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(a,o,i){return this[r].call(this,t,a,o,i)},configurable:!0})})}let wn=class{constructor(t){t&&this.set(t)}set(t,n,r){const a=this;function o(s,l,c){const d=ls(l);if(!d)throw new Error("header name must be a non-empty string");const h=G.findKey(a,d);(!h||a[h]===void 0||c===!0||c===void 0&&a[h]!==!1)&&(a[h||l]=bu(s))}const i=(s,l)=>G.forEach(s,(c,d)=>o(c,d,l));if(G.isPlainObject(t)||t instanceof this.constructor)i(t,n);else if(G.isString(t)&&(t=t.trim())&&!y_(t))i(g_(t),n);else if(G.isObject(t)&&G.isIterable(t)){let s={},l,c;for(const d of t){if(!G.isArray(d))throw TypeError("Object iterator must return a key-value pair");s[c=d[0]]=(l=s[c])?G.isArray(l)?[...l,d[1]]:[l,d[1]]:d[1]}i(s,n)}else t!=null&&o(n,t,r);return this}get(t,n){if(t=ls(t),t){const r=G.findKey(this,t);if(r){const a=this[r];if(!n)return a;if(n===!0)return x_(a);if(G.isFunction(n))return n.call(this,a,r);if(G.isRegExp(n))return n.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=ls(t),t){const r=G.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||Wd(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let a=!1;function o(i){if(i=ls(i),i){const s=G.findKey(r,i);s&&(!n||Wd(r,r[s],s,n))&&(delete r[s],a=!0)}}return G.isArray(t)?t.forEach(o):o(t),a}clear(t){const n=Object.keys(this);let r=n.length,a=!1;for(;r--;){const o=n[r];(!t||Wd(this,this[o],o,t,!0))&&(delete this[o],a=!0)}return a}normalize(t){const n=this,r={};return G.forEach(this,(a,o)=>{const i=G.findKey(r,o);if(i){n[i]=bu(a),delete n[o];return}const s=t?b_(o):String(o).trim();s!==o&&delete n[o],n[s]=bu(a),r[s]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return G.forEach(this,(r,a)=>{r!=null&&r!==!1&&(n[a]=t&&G.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(a=>r.set(a)),r}static accessor(t){const r=(this[Ox]=this[Ox]={accessors:{}}).accessors,a=this.prototype;function o(i){const s=ls(i);r[s]||(w_(a,i),r[s]=!0)}return G.isArray(t)?t.forEach(o):o(t),this}};wn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);G.reduceDescriptors(wn.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});G.freezeMethods(wn);function Vd(e,t){const n=this||dl,r=t||n,a=wn.from(r.headers);let o=r.data;return G.forEach(e,function(s){o=s.call(n,o,a.normalize(),t?t.status:void 0)}),a.normalize(),o}function uw(e){return!!(e&&e.__CANCEL__)}let hl=class extends je{constructor(t,n,r){super(t??"canceled",je.ERR_CANCELED,n,r),this.name="CanceledError",this.__CANCEL__=!0}};function cw(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new je("Request failed with status code "+n.status,[je.ERR_BAD_REQUEST,je.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function N_(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function C_(e,t){e=e||10;const n=new Array(e),r=new Array(e);let a=0,o=0,i;return t=t!==void 0?t:1e3,function(l){const c=Date.now(),d=r[o];i||(i=c),n[a]=l,r[a]=c;let h=o,f=0;for(;h!==a;)f+=n[h++],h=h%e;if(a=(a+1)%e,a===o&&(o=(o+1)%e),c-i<t)return;const p=d&&c-d;return p?Math.round(f*1e3/p):void 0}}function k_(e,t){let n=0,r=1e3/t,a,o;const i=(c,d=Date.now())=>{n=d,a=null,o&&(clearTimeout(o),o=null),e(...c)};return[(...c)=>{const d=Date.now(),h=d-n;h>=r?i(c,d):(a=c,o||(o=setTimeout(()=>{o=null,i(a)},r-h)))},()=>a&&i(a)]}const Yu=(e,t,n=3)=>{let r=0;const a=C_(50,250);return k_(o=>{const i=o.loaded,s=o.lengthComputable?o.total:void 0,l=i-r,c=a(l),d=i<=s;r=i;const h={loaded:i,total:s,progress:s?i/s:void 0,bytes:l,rate:c||void 0,estimated:c&&s&&d?(s-i)/c:void 0,event:o,lengthComputable:s!=null,[t?"download":"upload"]:!0};e(h)},n)},Lx=(e,t)=>{const n=e!=null;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},Bx=e=>(...t)=>G.asap(()=>e(...t)),j_=Zt.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,Zt.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(Zt.origin),Zt.navigator&&/(msie|trident)/i.test(Zt.navigator.userAgent)):()=>!0,S_=Zt.hasStandardBrowserEnv?{write(e,t,n,r,a,o,i){if(typeof document>"u")return;const s=[`${e}=${encodeURIComponent(t)}`];G.isNumber(n)&&s.push(`expires=${new Date(n).toUTCString()}`),G.isString(r)&&s.push(`path=${r}`),G.isString(a)&&s.push(`domain=${a}`),o===!0&&s.push("secure"),G.isString(i)&&s.push(`SameSite=${i}`),document.cookie=s.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function E_(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function __(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function dw(e,t,n){let r=!E_(t);return e&&(r||n==!1)?__(e,t):t}const zx=e=>e instanceof wn?{...e}:e;function ko(e,t){t=t||{};const n={};function r(c,d,h,f){return G.isPlainObject(c)&&G.isPlainObject(d)?G.merge.call({caseless:f},c,d):G.isPlainObject(d)?G.merge({},d):G.isArray(d)?d.slice():d}function a(c,d,h,f){if(G.isUndefined(d)){if(!G.isUndefined(c))return r(void 0,c,h,f)}else return r(c,d,h,f)}function o(c,d){if(!G.isUndefined(d))return r(void 0,d)}function i(c,d){if(G.isUndefined(d)){if(!G.isUndefined(c))return r(void 0,c)}else return r(void 0,d)}function s(c,d,h){if(h in t)return r(c,d);if(h in e)return r(void 0,c)}const l={url:o,method:o,data:o,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:s,headers:(c,d,h)=>a(zx(c),zx(d),h,!0)};return G.forEach(Object.keys({...e,...t}),function(d){const h=l[d]||a,f=h(e[d],t[d],d);G.isUndefined(f)&&h!==s||(n[d]=f)}),n}const hw=e=>{const t=ko({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:a,xsrfCookieName:o,headers:i,auth:s}=t;if(t.headers=i=wn.from(i),t.url=iw(dw(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),s&&i.set("Authorization","Basic "+btoa((s.username||"")+":"+(s.password?unescape(encodeURIComponent(s.password)):""))),G.isFormData(n)){if(Zt.hasStandardBrowserEnv||Zt.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(G.isFunction(n.getHeaders)){const l=n.getHeaders(),c=["content-type","content-length"];Object.entries(l).forEach(([d,h])=>{c.includes(d.toLowerCase())&&i.set(d,h)})}}if(Zt.hasStandardBrowserEnv&&(r&&G.isFunction(r)&&(r=r(t)),r||r!==!1&&j_(t.url))){const l=a&&o&&S_.read(o);l&&i.set(a,l)}return t},R_=typeof XMLHttpRequest<"u",I_=R_&&function(e){return new Promise(function(n,r){const a=hw(e);let o=a.data;const i=wn.from(a.headers).normalize();let{responseType:s,onUploadProgress:l,onDownloadProgress:c}=a,d,h,f,p,v;function g(){p&&p(),v&&v(),a.cancelToken&&a.cancelToken.unsubscribe(d),a.signal&&a.signal.removeEventListener("abort",d)}let y=new XMLHttpRequest;y.open(a.method.toUpperCase(),a.url,!0),y.timeout=a.timeout;function m(){if(!y)return;const b=wn.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),N={data:!s||s==="text"||s==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:b,config:e,request:y};cw(function(S){n(S),g()},function(S){r(S),g()},N),y=null}"onloadend"in y?y.onloadend=m:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(m)},y.onabort=function(){y&&(r(new je("Request aborted",je.ECONNABORTED,e,y)),y=null)},y.onerror=function(w){const N=w&&w.message?w.message:"Network Error",C=new je(N,je.ERR_NETWORK,e,y);C.event=w||null,r(C),y=null},y.ontimeout=function(){let w=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const N=a.transitional||sw;a.timeoutErrorMessage&&(w=a.timeoutErrorMessage),r(new je(w,N.clarifyTimeoutError?je.ETIMEDOUT:je.ECONNABORTED,e,y)),y=null},o===void 0&&i.setContentType(null),"setRequestHeader"in y&&G.forEach(i.toJSON(),function(w,N){y.setRequestHeader(N,w)}),G.isUndefined(a.withCredentials)||(y.withCredentials=!!a.withCredentials),s&&s!=="json"&&(y.responseType=a.responseType),c&&([f,v]=Yu(c,!0),y.addEventListener("progress",f)),l&&y.upload&&([h,p]=Yu(l),y.upload.addEventListener("progress",h),y.upload.addEventListener("loadend",p)),(a.cancelToken||a.signal)&&(d=b=>{y&&(r(!b||b.type?new hl(null,e,y):b),y.abort(),y=null)},a.cancelToken&&a.cancelToken.subscribe(d),a.signal&&(a.signal.aborted?d():a.signal.addEventListener("abort",d)));const x=N_(a.url);if(x&&Zt.protocols.indexOf(x)===-1){r(new je("Unsupported protocol "+x+":",je.ERR_BAD_REQUEST,e));return}y.send(o||null)})},A_=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let r=new AbortController,a;const o=function(c){if(!a){a=!0,s();const d=c instanceof Error?c:this.reason;r.abort(d instanceof je?d:new hl(d instanceof Error?d.message:d))}};let i=t&&setTimeout(()=>{i=null,o(new je(`timeout of ${t}ms exceeded`,je.ETIMEDOUT))},t);const s=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(c=>{c.unsubscribe?c.unsubscribe(o):c.removeEventListener("abort",o)}),e=null)};e.forEach(c=>c.addEventListener("abort",o));const{signal:l}=r;return l.unsubscribe=()=>G.asap(s),l}},D_=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let r=0,a;for(;r<n;)a=r+t,yield e.slice(r,a),r=a},T_=async function*(e,t){for await(const n of P_(e))yield*D_(n,t)},P_=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:r}=await t.read();if(n)break;yield r}}finally{await t.cancel()}},$x=(e,t,n,r)=>{const a=T_(e,t);let o=0,i,s=l=>{i||(i=!0,r&&r(l))};return new ReadableStream({async pull(l){try{const{done:c,value:d}=await a.next();if(c){s(),l.close();return}let h=d.byteLength;if(n){let f=o+=h;n(f)}l.enqueue(new Uint8Array(d))}catch(c){throw s(c),c}},cancel(l){return s(l),a.return()}},{highWaterMark:2})},Ux=64*1024,{isFunction:Vl}=G,F_=(({Request:e,Response:t})=>({Request:e,Response:t}))(G.global),{ReadableStream:Wx,TextEncoder:Vx}=G.global,Hx=(e,...t)=>{try{return!!e(...t)}catch{return!1}},M_=e=>{e=G.merge.call({skipUndefined:!0},F_,e);const{fetch:t,Request:n,Response:r}=e,a=t?Vl(t):typeof fetch=="function",o=Vl(n),i=Vl(r);if(!a)return!1;const s=a&&Vl(Wx),l=a&&(typeof Vx=="function"?(v=>g=>v.encode(g))(new Vx):async v=>new Uint8Array(await new n(v).arrayBuffer())),c=o&&s&&Hx(()=>{let v=!1;const g=new n(Zt.origin,{body:new Wx,method:"POST",get duplex(){return v=!0,"half"}}).headers.has("Content-Type");return v&&!g}),d=i&&s&&Hx(()=>G.isReadableStream(new r("").body)),h={stream:d&&(v=>v.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(v=>{!h[v]&&(h[v]=(g,y)=>{let m=g&&g[v];if(m)return m.call(g);throw new je(`Response type '${v}' is not supported`,je.ERR_NOT_SUPPORT,y)})});const f=async v=>{if(v==null)return 0;if(G.isBlob(v))return v.size;if(G.isSpecCompliantForm(v))return(await new n(Zt.origin,{method:"POST",body:v}).arrayBuffer()).byteLength;if(G.isArrayBufferView(v)||G.isArrayBuffer(v))return v.byteLength;if(G.isURLSearchParams(v)&&(v=v+""),G.isString(v))return(await l(v)).byteLength},p=async(v,g)=>{const y=G.toFiniteNumber(v.getContentLength());return y??f(g)};return async v=>{let{url:g,method:y,data:m,signal:x,cancelToken:b,timeout:w,onDownloadProgress:N,onUploadProgress:C,responseType:S,headers:k,withCredentials:_="same-origin",fetchOptions:E}=hw(v),j=t||fetch;S=S?(S+"").toLowerCase():"text";let T=A_([x,b&&b.toAbortSignal()],w),L=null;const P=T&&T.unsubscribe&&(()=>{T.unsubscribe()});let B;try{if(C&&c&&y!=="get"&&y!=="head"&&(B=await p(k,m))!==0){let Z=new n(g,{method:"POST",body:m,duplex:"half"}),ne;if(G.isFormData(m)&&(ne=Z.headers.get("content-type"))&&k.setContentType(ne),Z.body){const[ue,he]=Lx(B,Yu(Bx(C)));m=$x(Z.body,Ux,ue,he)}}G.isString(_)||(_=_?"include":"omit");const K=o&&"credentials"in n.prototype,z={...E,signal:T,method:y.toUpperCase(),headers:k.normalize().toJSON(),body:m,duplex:"half",credentials:K?_:void 0};L=o&&new n(g,z);let M=await(o?j(L,E):j(g,z));const U=d&&(S==="stream"||S==="response");if(d&&(N||U&&P)){const Z={};["status","statusText","headers"].forEach(ye=>{Z[ye]=M[ye]});const ne=G.toFiniteNumber(M.headers.get("content-length")),[ue,he]=N&&Lx(ne,Yu(Bx(N),!0))||[];M=new r($x(M.body,Ux,ue,()=>{he&&he(),P&&P()}),Z)}S=S||"text";let H=await h[G.findKey(h,S)||"text"](M,v);return!U&&P&&P(),await new Promise((Z,ne)=>{cw(Z,ne,{data:H,headers:wn.from(M.headers),status:M.status,statusText:M.statusText,config:v,request:L})})}catch(K){throw P&&P(),K&&K.name==="TypeError"&&/Load failed|fetch/i.test(K.message)?Object.assign(new je("Network Error",je.ERR_NETWORK,v,L),{cause:K.cause||K}):je.from(K,K&&K.code,v,L)}}},O_=new Map,fw=e=>{let t=e&&e.env||{};const{fetch:n,Request:r,Response:a}=t,o=[r,a,n];let i=o.length,s=i,l,c,d=O_;for(;s--;)l=o[s],c=d.get(l),c===void 0&&d.set(l,c=s?new Map:M_(t)),d=c;return c};fw();const Zp={http:e_,xhr:I_,fetch:{get:fw}};G.forEach(Zp,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Gx=e=>`- ${e}`,L_=e=>G.isFunction(e)||e===null||e===!1;function B_(e,t){e=G.isArray(e)?e:[e];const{length:n}=e;let r,a;const o={};for(let i=0;i<n;i++){r=e[i];let s;if(a=r,!L_(r)&&(a=Zp[(s=String(r)).toLowerCase()],a===void 0))throw new je(`Unknown adapter '${s}'`);if(a&&(G.isFunction(a)||(a=a.get(t))))break;o[s||"#"+i]=a}if(!a){const i=Object.entries(o).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let s=n?i.length>1?`since :
`+i.map(Gx).join(`
`):" "+Gx(i[0]):"as no adapter specified";throw new je("There is no suitable adapter to dispatch the request "+s,"ERR_NOT_SUPPORT")}return a}const pw={getAdapter:B_,adapters:Zp};function Hd(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new hl(null,e)}function qx(e){return Hd(e),e.headers=wn.from(e.headers),e.data=Vd.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),pw.getAdapter(e.adapter||dl.adapter,e)(e).then(function(r){return Hd(e),r.data=Vd.call(e,e.transformResponse,r),r.headers=wn.from(r.headers),r},function(r){return uw(r)||(Hd(e),r&&r.response&&(r.response.data=Vd.call(e,e.transformResponse,r.response),r.response.headers=wn.from(r.response.headers))),Promise.reject(r)})}const mw="1.13.4",Xc={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Xc[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const Kx={};Xc.transitional=function(t,n,r){function a(o,i){return"[Axios v"+mw+"] Transitional option '"+o+"'"+i+(r?". "+r:"")}return(o,i,s)=>{if(t===!1)throw new je(a(i," has been removed"+(n?" in "+n:"")),je.ERR_DEPRECATED);return n&&!Kx[i]&&(Kx[i]=!0,console.warn(a(i," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(o,i,s):!0}};Xc.spelling=function(t){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function z_(e,t,n){if(typeof e!="object")throw new je("options must be an object",je.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let a=r.length;for(;a-- >0;){const o=r[a],i=t[o];if(i){const s=e[o],l=s===void 0||i(s,o,e);if(l!==!0)throw new je("option "+o+" must be "+l,je.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new je("Unknown option "+o,je.ERR_BAD_OPTION)}}const wu={assertOptions:z_,validators:Xc},pr=wu.validators;let go=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Mx,response:new Mx}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const o=a.stack?a.stack.replace(/^.+\n/,""):"";try{r.stack?o&&!String(r.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+o):r.stack=o}catch{}}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=ko(this.defaults,n);const{transitional:r,paramsSerializer:a,headers:o}=n;r!==void 0&&wu.assertOptions(r,{silentJSONParsing:pr.transitional(pr.boolean),forcedJSONParsing:pr.transitional(pr.boolean),clarifyTimeoutError:pr.transitional(pr.boolean)},!1),a!=null&&(G.isFunction(a)?n.paramsSerializer={serialize:a}:wu.assertOptions(a,{encode:pr.function,serialize:pr.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),wu.assertOptions(n,{baseUrl:pr.spelling("baseURL"),withXsrfToken:pr.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let i=o&&G.merge(o.common,o[n.method]);o&&G.forEach(["delete","get","head","post","put","patch","common"],v=>{delete o[v]}),n.headers=wn.concat(i,o);const s=[];let l=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(n)===!1||(l=l&&g.synchronous,s.unshift(g.fulfilled,g.rejected))});const c=[];this.interceptors.response.forEach(function(g){c.push(g.fulfilled,g.rejected)});let d,h=0,f;if(!l){const v=[qx.bind(this),void 0];for(v.unshift(...s),v.push(...c),f=v.length,d=Promise.resolve(n);h<f;)d=d.then(v[h++],v[h++]);return d}f=s.length;let p=n;for(;h<f;){const v=s[h++],g=s[h++];try{p=v(p)}catch(y){g.call(this,y);break}}try{d=qx.call(this,p)}catch(v){return Promise.reject(v)}for(h=0,f=c.length;h<f;)d=d.then(c[h++],c[h++]);return d}getUri(t){t=ko(this.defaults,t);const n=dw(t.baseURL,t.url,t.allowAbsoluteUrls);return iw(n,t.params,t.paramsSerializer)}};G.forEach(["delete","get","head","options"],function(t){go.prototype[t]=function(n,r){return this.request(ko(r||{},{method:t,url:n,data:(r||{}).data}))}});G.forEach(["post","put","patch"],function(t){function n(r){return function(o,i,s){return this.request(ko(s||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:o,data:i}))}}go.prototype[t]=n(),go.prototype[t+"Form"]=n(!0)});let $_=class vw{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(o){n=o});const r=this;this.promise.then(a=>{if(!r._listeners)return;let o=r._listeners.length;for(;o-- >0;)r._listeners[o](a);r._listeners=null}),this.promise.then=a=>{let o;const i=new Promise(s=>{r.subscribe(s),o=s}).then(a);return i.cancel=function(){r.unsubscribe(o)},i},t(function(o,i,s){r.reason||(r.reason=new hl(o,i,s),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=r=>{t.abort(r)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new vw(function(a){t=a}),cancel:t}}};function U_(e){return function(n){return e.apply(null,n)}}function W_(e){return G.isObject(e)&&e.isAxiosError===!0}const Cf={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Cf).forEach(([e,t])=>{Cf[t]=e});function gw(e){const t=new go(e),n=X2(go.prototype.request,t);return G.extend(n,go.prototype,t,{allOwnKeys:!0}),G.extend(n,t,null,{allOwnKeys:!0}),n.create=function(a){return gw(ko(e,a))},n}const ct=gw(dl);ct.Axios=go;ct.CanceledError=hl;ct.CancelToken=$_;ct.isCancel=uw;ct.VERSION=mw;ct.toFormData=Kc;ct.AxiosError=je;ct.Cancel=ct.CanceledError;ct.all=function(t){return Promise.all(t)};ct.spread=U_;ct.isAxiosError=W_;ct.mergeConfig=ko;ct.AxiosHeaders=wn;ct.formToJSON=e=>lw(G.isHTMLForm(e)?new FormData(e):e);ct.getAdapter=pw.getAdapter;ct.HttpStatusCode=Cf;ct.default=ct;const{Axios:V6,AxiosError:H6,CanceledError:G6,isCancel:q6,CancelToken:K6,VERSION:X6,all:Y6,Cancel:Q6,isAxiosError:J6,spread:Z6,toFormData:eO,AxiosHeaders:tO,HttpStatusCode:nO,formToJSON:rO,getAdapter:aO,mergeConfig:oO}=ct,ie=ct.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});ie.interceptors.request.use(e=>{const t=localStorage.getItem("auth-storage");if(t){const{state:n}=JSON.parse(t);n!=null&&n.token&&(e.headers.Authorization=`Bearer ${n.token}`)}return e},e=>Promise.reject(e));ie.interceptors.response.use(e=>e,e=>{var t;return((t=e.response)==null?void 0:t.status)===401&&(localStorage.removeItem("auth-storage"),window.location.href="/login"),Promise.reject(e)});const ur=l3(p3((e,t)=>({user:null,token:null,isAuthenticated:!1,isLoading:!1,login:async(n,r)=>{var a,o;e({isLoading:!0});try{const i=await ie.post("/auth/login",{email:n,password:r}),{token:s,user:l}=i.data;return e({user:l,token:s,isAuthenticated:!0,isLoading:!1}),{success:!0}}catch(i){return e({isLoading:!1}),{success:!1,error:((o=(a=i.response)==null?void 0:a.data)==null?void 0:o.message)||"Erreur de connexion"}}},register:async n=>{var r,a;e({isLoading:!0});try{const o=await ie.post("/auth/register",n),{token:i,user:s}=o.data;return e({user:s,token:i,isAuthenticated:!0,isLoading:!1}),{success:!0}}catch(o){return e({isLoading:!1}),{success:!1,error:((a=(r=o.response)==null?void 0:r.data)==null?void 0:a.message)||"Erreur d'inscription"}}},setAuth:(n,r)=>{e({token:n,user:r,isAuthenticated:!0})},logout:()=>{e({user:null,token:null,isAuthenticated:!1})},updateUser:n=>{e({user:{...t().user,...n}})},fetchUser:async()=>{var n;try{const r=await ie.get("/auth/me");e({user:r.data.user})}catch(r){((n=r.response)==null?void 0:n.status)===401&&t().logout()}}}),{name:"auth-storage",partialize:e=>({token:e.token,user:e.user,isAuthenticated:e.isAuthenticated})}));/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var V_={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H_=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Y=(e,t)=>{const n=I.forwardRef(({color:r="currentColor",size:a=24,strokeWidth:o=2,absoluteStrokeWidth:i,className:s="",children:l,...c},d)=>I.createElement("svg",{ref:d,...V_,width:a,height:a,stroke:r,strokeWidth:i?Number(o)*24/Number(a):o,className:["lucide",`lucide-${H_(e)}`,s].join(" "),...c},[...t.map(([h,f])=>I.createElement(h,f)),...Array.isArray(l)?l:[l]]));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xw=Y("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G_=Y("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xx=Y("AlignCenter",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"17",x2:"7",y1:"12",y2:"12",key:"rsh8ii"}],["line",{x1:"19",x2:"5",y1:"18",y2:"18",key:"1t0tuv"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yx=Y("AlignLeft",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}],["line",{x1:"17",x2:"3",y1:"18",y2:"18",key:"1awlsn"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qx=Y("AlignRight",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}],["line",{x1:"21",x2:"7",y1:"18",y2:"18",key:"1g9eri"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q_=Y("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ir=Y("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jo=Y("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K_=Y("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yw=Y("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X_=Y("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y_=Y("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kf=Y("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jx=Y("Bold",[["path",{d:"M14 12a4 4 0 0 0 0-8H6v8",key:"v2sylx"}],["path",{d:"M15 20a4 4 0 0 0 0-8H6v8Z",key:"1ef5ya"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q_=Y("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J_=Y("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z_=Y("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zx=Y("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const em=Y("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bw=Y("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qu=Y("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eR=Y("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tn=Y("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tm=Y("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Di=Y("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ti=Y("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tR=Y("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pi=Y("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nR=Y("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rR=Y("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ey=Y("Cpu",[["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"9",y:"9",width:"6",height:"6",key:"o3kz5p"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const So=Y("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jf=Y("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aR=Y("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oR=Y("Diamond",[["path",{d:"M2.7 10.3a2.41 2.41 0 0 0 0 3.41l7.59 7.59a2.41 2.41 0 0 0 3.41 0l7.59-7.59a2.41 2.41 0 0 0 0-3.41l-7.59-7.59a2.41 2.41 0 0 0-3.41 0Z",key:"1f1r0c"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nm=Y("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iR=Y("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rm=Y("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eo=Y("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ww=Y("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nw=Y("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cw=Y("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fi=Y("FolderKanban",[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M12 10v2",key:"hh53o1"}],["path",{d:"M16 10v6",key:"1d6xys"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fi=Y("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sR=Y("Gem",[["path",{d:"M6 3h12l4 6-10 13L2 9Z",key:"1pcd5k"}],["path",{d:"M11 3 8 9l4 13 4-13-3-6",key:"1fcu3u"}],["path",{d:"M2 9h20",key:"16fsjt"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lR=Y("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uR=Y("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cR=Y("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dR=Y("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hR=Y("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kw=Y("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fR=Y("Hexagon",[["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pR=Y("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jw=Y("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mR=Y("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ty=Y("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vR=Y("Laptop",[["path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16",key:"tarvll"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gR=Y("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sw=Y("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=Y("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xR=Y("LineChart",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yR=Y("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bR=Y("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wR=Y("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=Y("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _o=Y("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ew=Y("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=Y("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NR=Y("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ny=Y("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CR=Y("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kR=Y("Octagon",[["polygon",{points:"7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2",key:"h1p8hx"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ju=Y("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jR=Y("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const am=Y("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SR=Y("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ER=Y("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ua=Y("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zu=Y("Presentation",[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _R=Y("Redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RR=Y("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=Y("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ki=Y("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gd=Y("Scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const om=Y("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IR=Y("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AR=Y("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mi=Y("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DR=Y("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TR=Y("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pi=Y("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const im=Y("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ry=Y("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PR=Y("StarOff",[["path",{d:"M8.34 8.34 2 9.27l5 4.87L5.82 21 12 17.77 18.18 21l-.59-3.43",key:"16m0ql"}],["path",{d:"M18.42 12.76 22 9.27l-6.91-1L12 2l-1.44 2.91",key:"1vt8nq"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ka=Y("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sm=Y("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FR=Y("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22h0a3.13 3.13 0 0 1-3-3.88Z",key:"s6e0r"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ay=Y("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qa=Y("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MR=Y("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oi=Y("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OR=Y("Triangle",[["path",{d:"M13.73 4a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"14u9p9"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LR=Y("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BR=Y("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _w=Y("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oy=Y("Underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zR=Y("Undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iy=Y("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rw=Y("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iw=Y("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=Y("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const un=Y("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nu=Y("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sy=Y("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $R=Y("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aw=Y("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cr=Y("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dw=Y("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),UR=()=>{const e=[{icon:Kr,title:"Gnrateur d'ides",description:"Trouvez l'ide de startup parfaite grce  notre gnrateur intelligent bas sur vos intrts et le march tunisien."},{icon:Sw,title:"Business Model Canvas",description:"Crez votre modle conomique avec des templates prts  l'emploi et personnalisables."},{icon:Ju,title:"Branding Complet",description:"Gnrez le nom, le slogan et l'identit visuelle de votre startup en quelques clics."},{icon:ww,title:"Business Plan PDF",description:"Crez un business plan professionnel et exportez-le en PDF pour vos investisseurs."},{icon:Zu,title:"Pitch Deck",description:"Construisez un pitch deck impactant avec nos templates optimiss pour les leves de fonds."},{icon:un,title:"Gestion de Projet",description:"Grez vos tches et votre quipe avec un tableau Kanban intgr."}],t=[{name:"Ahmed Ben Ali",role:"Fondateur, TechStartup",content:"StartUpLab m'a permis de structurer mon ide et de crer un business plan en quelques heures seulement.",rating:5},{name:"Sarah Trabelsi",role:"CEO, EcoSolutions",content:"Un outil indispensable pour tout entrepreneur tunisien. Le gnrateur d'ides est incroyable !",rating:5},{name:"Mohamed Karim",role:"Co-fondateur, FinApp",content:"Grce au pitch deck gnr, j'ai pu lever 100K TND auprs d'investisseurs locaux.",rating:5}];return u.jsxs("div",{className:"min-h-screen bg-white",children:[u.jsx("nav",{className:"fixed top-0 w-full bg-white/80 backdrop-blur-md z-50 border-b border-gray-100",children:u.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:u.jsxs("div",{className:"flex justify-between items-center h-16",children:[u.jsxs(Fe,{to:"/",className:"flex items-center gap-2",children:[u.jsx(Ar,{className:"w-8 h-8 text-primary-600"}),u.jsx("span",{className:"text-xl font-bold gradient-text",children:"StartUpLab"})]}),u.jsxs("div",{className:"hidden md:flex items-center gap-8",children:[u.jsx("a",{href:"#features",className:"text-gray-600 hover:text-gray-900",children:"Fonctionnalits"}),u.jsx("a",{href:"#testimonials",className:"text-gray-600 hover:text-gray-900",children:"Tmoignages"}),u.jsx(Fe,{to:"/pricing",className:"text-gray-600 hover:text-gray-900",children:"Tarifs"})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(Fe,{to:"/login",className:"text-gray-700 hover:text-gray-900 font-medium",children:"Connexion"}),u.jsx(Fe,{to:"/register",className:"btn-primary",children:"Commencer gratuitement"})]})]})})}),u.jsx("section",{className:"pt-32 pb-20 px-4",children:u.jsxs("div",{className:"max-w-7xl mx-auto text-center",children:[u.jsxs("div",{className:"inline-flex items-center gap-2 bg-primary-50 text-primary-700 px-4 py-2 rounded-full text-sm font-medium mb-6",children:[u.jsx(ka,{className:"w-4 h-4"}),"La plateforme #1 pour les startups en Tunisie"]}),u.jsxs("h1",{className:"text-4xl md:text-6xl font-bold text-gray-900 mb-6 leading-tight",children:["Crez votre ",u.jsx("span",{className:"gradient-text",children:"startup"}),u.jsx("br",{}),"de l'ide au lancement"]}),u.jsx("p",{className:"text-xl text-gray-600 mb-10 max-w-2xl mx-auto",children:"Tous les outils dont vous avez besoin pour transformer votre ide en une startup russie. Gnrateur d'ides, business model, branding, business plan et plus encore."}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[u.jsxs(Fe,{to:"/register",className:"btn-primary text-lg px-8 py-3 flex items-center justify-center gap-2",children:["Dmarrer gratuitement",u.jsx(jo,{className:"w-5 h-5"})]}),u.jsx("a",{href:"#features",className:"btn-secondary text-lg px-8 py-3",children:"Dcouvrir les fonctionnalits"})]}),u.jsxs("div",{className:"mt-12 flex items-center justify-center gap-8 text-sm text-gray-500",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Tn,{className:"w-5 h-5 text-green-500"}),u.jsx("span",{children:"Gratuit pour commencer"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Tn,{className:"w-5 h-5 text-green-500"}),u.jsx("span",{children:"Pas de carte bancaire"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Tn,{className:"w-5 h-5 text-green-500"}),u.jsx("span",{children:"Support en franais"})]})]})]})}),u.jsx("section",{id:"features",className:"py-20 bg-gray-50",children:u.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[u.jsxs("div",{className:"text-center mb-16",children:[u.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"Tout ce qu'il faut pour lancer votre startup"}),u.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Des outils puissants et intuitifs pour chaque tape de la cration de votre entreprise."})]}),u.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:e.map((n,r)=>u.jsxs("div",{className:"card-hover",children:[u.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-lg flex items-center justify-center mb-4",children:u.jsx(n.icon,{className:"w-6 h-6 text-primary-600"})}),u.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:n.title}),u.jsx("p",{className:"text-gray-600",children:n.description})]},r))})]})}),u.jsx("section",{id:"testimonials",className:"py-20",children:u.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[u.jsxs("div",{className:"text-center mb-16",children:[u.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"Ils ont lanc leur startup avec nous"}),u.jsx("p",{className:"text-lg text-gray-600",children:"Dcouvrez les tmoignages de nos utilisateurs satisfaits."})]}),u.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:t.map((n,r)=>u.jsxs("div",{className:"card",children:[u.jsx("div",{className:"flex gap-1 mb-4",children:[...Array(n.rating)].map((a,o)=>u.jsx(ka,{className:"w-5 h-5 text-yellow-400 fill-yellow-400"},o))}),u.jsxs("p",{className:"text-gray-700 mb-6",children:['"',n.content,'"']}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 rounded-full bg-primary-100 flex items-center justify-center",children:u.jsx("span",{className:"text-primary-700 font-semibold",children:n.name.split(" ").map(a=>a[0]).join("")})}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900",children:n.name}),u.jsx("p",{className:"text-sm text-gray-500",children:n.role})]})]})]},r))})]})}),u.jsx("section",{className:"py-20 gradient-bg",children:u.jsxs("div",{className:"max-w-4xl mx-auto px-4 text-center",children:[u.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-white mb-6",children:"Prt  lancer votre startup ?"}),u.jsx("p",{className:"text-xl text-white/90 mb-10",children:"Rejoignez des centaines d'entrepreneurs tunisiens qui utilisent StartUpLab pour concrtiser leurs ides."}),u.jsxs(Fe,{to:"/register",className:"inline-flex items-center gap-2 bg-white text-primary-600 font-semibold px-8 py-4 rounded-lg hover:bg-gray-100 transition-colors",children:["Crer mon compte gratuitement",u.jsx(jo,{className:"w-5 h-5"})]})]})}),u.jsx("footer",{className:"bg-gray-900 text-gray-400 py-12",children:u.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[u.jsxs("div",{className:"grid md:grid-cols-4 gap-8",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx(Ar,{className:"w-8 h-8 text-primary-400"}),u.jsx("span",{className:"text-xl font-bold text-white",children:"StartUpLab"})]}),u.jsx("p",{className:"text-sm",children:"La plateforme tout-en-un pour crer votre startup en Tunisie."})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-white mb-4",children:"Produit"}),u.jsxs("ul",{className:"space-y-2 text-sm",children:[u.jsx("li",{children:u.jsx("a",{href:"#features",className:"hover:text-white",children:"Fonctionnalits"})}),u.jsx("li",{children:u.jsx(Fe,{to:"/pricing",className:"hover:text-white",children:"Tarifs"})})]})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-white mb-4",children:"Support"}),u.jsxs("ul",{className:"space-y-2 text-sm",children:[u.jsx("li",{children:u.jsx("a",{href:"#",className:"hover:text-white",children:"Centre d'aide"})}),u.jsx("li",{children:u.jsx("a",{href:"#",className:"hover:text-white",children:"Contact"})})]})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-white mb-4",children:"Lgal"}),u.jsxs("ul",{className:"space-y-2 text-sm",children:[u.jsx("li",{children:u.jsx("a",{href:"#",className:"hover:text-white",children:"Conditions d'utilisation"})}),u.jsx("li",{children:u.jsx("a",{href:"#",className:"hover:text-white",children:"Politique de confidentialit"})})]})]})]}),u.jsx("div",{className:"border-t border-gray-800 mt-12 pt-8 text-sm text-center",children:u.jsxs("p",{children:[" ",new Date().getFullYear()," StartUpLab. Tous droits rservs."]})})]})})]})};function WR(e={}){const{nonce:t,locale:n,onScriptLoadSuccess:r,onScriptLoadError:a}=e,[o,i]=I.useState(!1),s=I.useRef(r);s.current=r;const l=I.useRef(a);return l.current=a,I.useEffect(()=>{const c=document.createElement("script");return c.src="https://accounts.google.com/gsi/client",n&&(c.src+=`?hl=${n}`),c.async=!0,c.defer=!0,c.nonce=t,c.onload=()=>{var d;i(!0),(d=s.current)===null||d===void 0||d.call(s)},c.onerror=()=>{var d;i(!1),(d=l.current)===null||d===void 0||d.call(l)},document.body.appendChild(c),()=>{document.body.removeChild(c)}},[t]),o}const VR=I.createContext(null);function Tw({clientId:e,nonce:t,locale:n,onScriptLoadSuccess:r,onScriptLoadError:a,children:o}){const i=WR({nonce:t,onScriptLoadSuccess:r,onScriptLoadError:a,locale:n}),s=I.useMemo(()=>({locale:n,clientId:e,scriptLoadedSuccessfully:i}),[e,i]);return jc.createElement(VR.Provider,{value:s},o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Pw=function(e,t){return(Pw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var a in r)r.hasOwnProperty(a)&&(n[a]=r[a])})(e,t)};function cr(e,t){function n(){this.constructor=e}Pw(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function fe(e,t,n,r){return new(n||(n=Promise))(function(a,o){function i(c){try{l(r.next(c))}catch(d){o(d)}}function s(c){try{l(r.throw(c))}catch(d){o(d)}}function l(c){c.done?a(c.value):new n(function(d){d(c.value)}).then(i,s)}l((r=r.apply(e,[])).next())})}function pe(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(c){return function(d){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&d[0]?r.return:d[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,d[1])).done)return a;switch(r=0,a&&(d=[2&d[0],a.value]),d[0]){case 0:case 1:a=d;break;case 4:return i.label++,{value:d[1],done:!1};case 5:i.label++,r=d[1],d=[0];continue;case 7:d=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){i=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){i.label=d[1];break}if(d[0]===6&&i.label<a[1]){i.label=a[1],a=d;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(d);break}a[2]&&i.ops.pop(),i.trys.pop();continue}d=t.call(e,i)}catch(h){d=[6,h],r=0}finally{n=a=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}([l,c])}}}var HR=function(){function e(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(t,n){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+n+"."),this.platformName=t,this.platform=n},e.prototype.registerFlag=function(t,n,r){if(this.flagRegistry[t]={evaluationFn:n,setHook:r},this.urlFlags[t]!=null){var a=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+a+"."),this.set(t,a)}},e.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},e.prototype.getNumber=function(t){return this.get(t)},e.prototype.getBool=function(t){return this.get(t)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(t,n){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)},e.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},e.prototype.setFlags=function(t){this.flags=Object.assign({},t)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var n,r,a=(n=this.global.location.search,r={},n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(o){for(var i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];return GR(r,i[0],i[1]),i.join("=")}),r);"tfjsflags"in a&&a.tfjsflags.split(",").forEach(function(o){var i=o.split(":"),s=i[0],l=i[1];t.urlFlags[s]=function(c,d){if((d=d.toLowerCase())==="true"||d==="false")return d==="true";if(""+ +d===d)return+d;throw new Error("Could not parse value flag value "+d+" for flag "+c+".")}(s,l)})}},e}();function GR(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function X(){return Fw}var Fw=null,ec=new Map,Sf=new Map;function Mw(e,t){var n=Lw(e,t);return ec.get(n)}function qR(e){return Sf.get(e)}function ly(e){for(var t=ec.entries(),n=[];;){var r=t.next(),a=r.done,o=r.value;if(a)break;var i=o[0],s=o[1];i.split("_")[0]===e&&n.push(s)}return n}function Ow(e){var t=e.kernelName,n=e.backendName,r=Lw(t,n);if(ec.has(r))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");ec.set(r,e)}function KR(e){var t=e.kernelName;Sf.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),Sf.set(t,e)}function Lw(e,t){return t+"_"+e}function Ef(e,t,n){return Math.max(e,Math.min(t,n))}function Bw(e){return e%2==0?e:e+1}function XR(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function D(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function Ge(e,t,n){n===void 0&&(n=""),D(Lt(e,t),function(){return n+" Shapes "+e+" and "+t+" must match"})}function Xi(e){D(e!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function Li(e,t,n){if(t===void 0&&(t=[]),n===void 0&&(n=!1),t==null&&(t=[]),Array.isArray(e)||Er(e)&&!n)for(var r=0;r<e.length;++r)Li(e[r],t,n);else t.push(e);return t}function me(e){if(e.length===0)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function Lt(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function xt(e){return e%1==0}function YR(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function _f(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function mi(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function uy(e,t,n){return t===void 0&&(t=function(r){return 0}),new Promise(function(r,a){var o=0,i=function(){if(e())r();else{o++;var s=t(o);n!=null&&o>=n?a():setTimeout(i,s)}};i()})}function QR(e,t){for(var n=1,r=-1,a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(e[a]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+a);r=a}else if(e[a]<0)throw Error("Shapes can not be < 0. Found "+e[a]+" at dim "+a);if(r===-1){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(n===0)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var o=e.slice();return o[r]=t/n,o}function Dt(e,t){var n=t.length;return D((e=e==null?t.map(function(r,a){return a}):[].concat(e)).every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e}),D(e.every(function(r){return xt(r)}),function(){return"All values in axis param must be integers but got axis "+e}),e.map(function(r){return r<0?n+r:r})}function so(e,t){for(var n=[],r=[],a=t!=null&&Array.isArray(t)&&t.length===0,o=t==null||a?null:Dt(t,e).sort(),i=0,s=0;s<e.length;++s){if(o!=null){if(o[i]===s&&e[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(o[i]==null||o[i]>s)&&e[s]===1&&(n.push(e[s]),r.push(s)),o[i]<=s&&i++}e[s]!==1&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function Xs(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else{if(e!=="bool")throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function tc(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else{if(e!=="string")throw new Error("Unknown data type "+e);n=new Array(t)}return n}function JR(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function ZR(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function eI(e,t){return t!=="complex64"&&(t!=="float32"||e==="complex64")&&(t!=="int32"||e==="float32"||e==="complex64")&&(t!=="bool"||e!=="bool")}function Er(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function zw(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype "+e)}function tI(e){if(e==null)return 0;var t=0;return e.forEach(function(n){return t+=n.length}),t}function lm(e){return typeof e=="string"||e instanceof String}function nI(e){return typeof e=="boolean"}function rI(e){return typeof e=="number"}function fl(e){return Array.isArray(e)?fl(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":rI(e)?"float32":lm(e)?"string":nI(e)?"bool":"float32"}function Rf(e){return!!(e&&e.constructor&&e.call&&e.apply)}function If(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function _r(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function $w(e,t,n){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Li(e)),n&&JR(e,t),function(o,i){return o instanceof Float32Array&&i==="float32"||o instanceof Int32Array&&i==="int32"||o instanceof Uint8Array&&i==="bool"}(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){for(var r=new Uint8Array(e.length),a=0;a<r.length;++a)Math.round(e[a])!==0&&(r[a]=1);return r}throw new Error("Unknown data type "+t)}function cy(e,t){if(e.length===0)return t[0];var n=e.reduce(function(r,a){return r*a});if(n===0)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function r(a,o,i){var s=new Array;if(o.length===1)for(var l=o[0],c=0;c<l;c++)s[c]=i[a+c];else{l=o[0];var d=o.slice(1),h=d.reduce(function(f,p){return f*p});for(c=0;c<l;c++)s[c]=r(a+c*h,d,i)}return s}(0,e,t)}function Uw(e,t){for(var n=pl(e,t),r=0;r<n.length;r++)n[r]=1;return n}function pl(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type "+t)}function xr(){return X().platform.now()}function Ww(e){e.forEach(function(t){D(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."})})}function aI(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",X().platform.encode(e,t)}function nc(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",X().platform.decode(e,t)}function dy(e,t,n){if(t===0)return 0;if(t===1)return e[0];for(var r=e[e.length-1],a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function oI(e,t,n){if(t===0)return[];if(t===1)return[e];for(var r=new Array(t),a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}var iI=function(){function e(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new sI)}return e.prototype.profileKernel=function(t,n,r){var a,o=this,i=this.backendTimer.time(function(){a=r()});return a.forEach(function(s){s.data().then(function(l){(function(c,d,h){if(d!=="float32")return!1;for(var f=0;f<c.length;f++){var p=c[f];if(isNaN(p)||!isFinite(p))return console.warn("Found "+p+" in the result of '"+h+"'"),!0}})(l,s.dtype,t),i.then(function(c){var d="";c.getExtraProfileInfo!=null&&(d=c.getExtraProfileInfo()),o.logger.logKernelProfile(t,s,l,c.kernelMs,n,d)})})}),a},e}(),sI=function(){function e(){}return e.prototype.logKernelProfile=function(t,n,r,a,o,i){var s=typeof a=="number"?mi(a+"ms",9):a.error,l=mi(t,25),c=n.rank,d=n.size,h=mi(n.shape.toString(),14),f="";for(var p in o){var v=o[p].shape||n.shape,g=v.length;f+=p+": "+g+"D "+(g>0?v:"")+" "}console.log("%c"+l+"	%c"+s+"	%c"+c+"D "+h+"	%c"+d+"	%c"+f+"	%c"+i,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}(),hy=20,us=3,qd=7;function lI(e,t,n,r){var a=_r(t),o=function(c,d,h,f){var p=me(d),v=f[f.length-1],g=new Array(v).fill(0),y=d.length,m=h==="complex64"?ds(c):c;if(y>1)for(var x=0;x<p/v;x++)for(var b=x*v,w=0;w<v;w++)g[w]=Math.max(g[w],cs(m[b+w],0,h).length);return g}(e,t,n,a),i=t.length,s=function c(d,h,f,p,v,g){g===void 0&&(g=!0);var y=f==="complex64"?2:1,m=h[0],x=h.length;if(x===0)return f==="complex64"?[cs(ds(d)[0],0,f)]:f==="bool"?[Vw(d[0])]:[d[0].toString()];if(x===1){if(m>hy){var b=us*y,w=Array.from(d.slice(0,b)),N=Array.from(d.slice((m-us)*y,m*y));return f==="complex64"&&(w=ds(w),N=ds(N)),["["+w.map(function(B,K){return cs(B,v[K],f)}).join(", ")+", ..., "+N.map(function(B,K){return cs(B,v[m-us+K],f)}).join(", ")+"]"]}return["["+(f==="complex64"?ds(d):Array.from(d)).map(function(B,K){return cs(B,v[K],f)}).join(", ")+"]"]}var C=h.slice(1),S=p.slice(1),k=p[0]*y,_=[];if(m>hy){for(var E=0;E<us;E++){var j=(T=E*k)+k;_.push.apply(_,c(d.slice(T,j),C,f,S,v,!1))}for(_.push("..."),E=m-us;E<m;E++)j=(T=E*k)+k,_.push.apply(_,c(d.slice(T,j),C,f,S,v,E===m-1))}else for(E=0;E<m;E++){var T;j=(T=E*k)+k,_.push.apply(_,c(d.slice(T,j),C,f,S,v,E===m-1))}var L=x===2?",":"";for(_[0]="["+_[0]+L,E=1;E<_.length-1;E++)_[E]=" "+_[E]+L;var P=`,
`;for(E=2;E<x;E++)P+=`
`;return _[_.length-1]=" "+_[_.length-1]+"]"+(g?"":P),_}(e,t,n,a,o),l=["Tensor"];return r&&(l.push("  dtype: "+n),l.push("  rank: "+i),l.push("  shape: ["+t+"]"),l.push("  values:")),l.push(s.map(function(c){return"    "+c}).join(`
`)),l.join(`
`)}function cs(e,t,n){return mi(Array.isArray(e)?parseFloat(e[0].toFixed(qd))+" + "+parseFloat(e[1].toFixed(qd))+"j":lm(e)?"'"+e+"'":n==="bool"?Vw(e):parseFloat(e.toFixed(qd)).toString(),t)}function Vw(e){return e===0?"false":"true"}function ds(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var Ys=function(){function e(t,n,r){var a=this;if(this.dtype=n,this.shape=t.slice(),this.size=me(t),r!=null){var o=r.length;D(o===this.size,function(){return"Length of values '"+o+"' does not match the size inferred by the shape '"+a.size+"'."})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||tc(n,this.size),this.strides=_r(t)}return e.prototype.set=function(t){for(var n=this,r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];r.length===0&&(r=[0]),D(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+n.rank+")"});var o=this.locToIndex(r);this.values[o]=t},e.prototype.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.length===0&&(t=[0]);for(var r=0,a=0,o=t;a<o.length;a++){var i=o[a];if(i<0||i>=this.shape[r]){var s="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(s)}r++}for(var l=t[t.length-1],c=0;c<t.length-1;++c)l+=this.strides[c]*t[c];return this.values[l]},e.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var n=t[t.length-1],r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n},e.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return br().makeTensor(this.values,this.shape,this.dtype)},e}(),br=null,q=null,Hw=null,it=function(){function e(t,n,r,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=me(t),this.strides=_r(t),this.dataId=r,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),D(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,n){return this.throwIfDisposed(),this.reshape([t,n])},e.prototype.as3D=function(t,n,r){return this.throwIfDisposed(),this.reshape([t,n,r])},e.prototype.as4D=function(t,n,r,a){return this.throwIfDisposed(),this.reshape([t,n,r,a])},e.prototype.as5D=function(t,n,r,a,o){return this.throwIfDisposed(),this.reshape([t,n,r,a,o])},e.prototype.asType=function(t){return this.throwIfDisposed(),q.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return fe(this,void 0,void 0,function(){var t;return pe(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,q.buffer(this.shape,this.dtype,t)]}})})},e.prototype.bufferSync=function(){return q.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return fe(this,void 0,void 0,function(){var t;return pe(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,cy(this.shape,t)]}})})},e.prototype.arraySync=function(){return cy(this.shape,this.dataSync())},e.prototype.data=function(){return fe(this,void 0,void 0,function(){var t,n;return pe(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=br().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:n=r.sent();try{return[2,n.map(function(a){return nc(a)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var t=br().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(n){return nc(n)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},e.prototype.bytes=function(){return fe(this,void 0,void 0,function(){var t;return pe(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,br().read(this.dataId)];case 1:return t=n.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(br().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return t===void 0&&(t=!1),q.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),q.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return t===void 0&&(t=0),q.expandDims(this,t)},e.prototype.cumsum=function(t,n,r){return t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1),q.cumsum(this,t,n,r)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),q.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),q.clone(this)},e.prototype.oneHot=function(t,n,r){return this.throwIfDisposed(),q.oneHot(this,t,n,r)},e.prototype.toString=function(t){return t===void 0&&(t=!1),lI(this.dataSync(),this.shape,this.dtype,t)},e.prototype.tile=function(t){return this.throwIfDisposed(),q.tile(this,t)},e.prototype.gather=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),q.gather(this,t,n)},e.prototype.matMul=function(t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),q.matMul(this,t,n,r)},e.prototype.dot=function(t){return this.throwIfDisposed(),q.dot(this,t)},e.prototype.norm=function(t,n,r){return t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),q.norm(this,t,n,r)},e.prototype.slice=function(t,n){return this.throwIfDisposed(),q.slice(this,t,n)},e.prototype.reverse=function(t){return this.throwIfDisposed(),q.reverse(this,t)},e.prototype.concat=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),q.concat([this].concat(t),n)},e.prototype.split=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),q.split(this,t,n)},e.prototype.stack=function(t,n){return n===void 0&&(n=0),q.stack([this,t],n)},e.prototype.unstack=function(t){return t===void 0&&(t=0),q.unstack(this,t)},e.prototype.pad=function(t,n){return n===void 0&&(n=0),q.pad(this,t,n)},e.prototype.batchNormalization=function(t,n,r,a,o){return r===void 0&&(r=.001),Hw("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,n,o,a,r)},e.prototype.batchNorm=function(t,n,r,a,o){return o===void 0&&(o=.001),this.throwIfDisposed(),q.batchNorm(this,t,n,r,a,o)},e.prototype.all=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.all(this,t,n)},e.prototype.any=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.any(this,t,n)},e.prototype.logSumExp=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.logSumExp(this,t,n)},e.prototype.sum=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.sum(this,t,n)},e.prototype.prod=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.prod(this,t,n)},e.prototype.mean=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.mean(this,t,n)},e.prototype.min=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.min(this,t,n)},e.prototype.max=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.max(this,t,n)},e.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),q.argMin(this,t)},e.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),q.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),q.cast(this,t)},e.prototype.add=function(t){return this.throwIfDisposed(),q.add(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),q.addStrict(this,t)},e.prototype.atan2=function(t){return this.throwIfDisposed(),q.atan2(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),q.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),q.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),q.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),q.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),q.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),q.mulStrict(this,t)},e.prototype.div=function(t){return this.throwIfDisposed(),q.div(this,t)},e.prototype.divNoNan=function(t){return this.throwIfDisposed(),q.divNoNan(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),q.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),q.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),q.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),q.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),q.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),q.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),q.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),q.modStrict(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),q.squaredDifferenceStrict(this,t)},e.prototype.transpose=function(t){return this.throwIfDisposed(),q.transpose(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),q.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),q.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),q.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),q.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),q.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),q.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),q.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),q.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),q.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),q.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),q.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),q.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),q.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),q.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),q.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),q.logicalXor(this,t)},e.prototype.where=function(t,n){return this.throwIfDisposed(),q.where(t,this,n)},e.prototype.neg=function(){return this.throwIfDisposed(),q.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),q.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),q.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),q.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),q.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),q.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),q.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),q.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),q.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),q.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),q.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),q.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),q.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),q.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),q.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),q.abs(this)},e.prototype.clipByValue=function(t,n){return this.throwIfDisposed(),q.clipByValue(this,t,n)},e.prototype.relu=function(){return this.throwIfDisposed(),q.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),q.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),q.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),q.selu(this)},e.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),q.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),q.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),q.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),q.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),q.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),q.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),q.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),q.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),q.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),q.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),q.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),q.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),q.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),q.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),q.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),q.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),q.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),q.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),q.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),q.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),q.round(this)},e.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),q.step(this,t)},e.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),q.softmax(this,t)},e.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),q.logSoftmax(this,t)},e.prototype.resizeBilinear=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),q.image.resizeBilinear(this,t,n)},e.prototype.resizeNearestNeighbor=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),q.image.resizeNearestNeighbor(this,t,n)},e.prototype.conv1d=function(t,n,r,a,o,i){return a===void 0&&(a="NWC"),o===void 0&&(o=1),this.throwIfDisposed(),q.conv1d(this,t,n,r,a,o,i)},e.prototype.conv2d=function(t,n,r,a,o,i){return a===void 0&&(a="NHWC"),o===void 0&&(o=[1,1]),this.throwIfDisposed(),q.conv2d(this,t,n,r,a,o,i)},e.prototype.conv2dTranspose=function(t,n,r,a,o){return this.throwIfDisposed(),q.conv2dTranspose(this,t,n,r,a,o)},e.prototype.depthwiseConv2D=function(t,n,r,a,o,i){return a===void 0&&(a="NHWC"),o===void 0&&(o=[1,1]),this.throwIfDisposed(),q.depthwiseConv2d(this,t,n,r,a,o,i)},e.prototype.separableConv2d=function(t,n,r,a,o,i){return o===void 0&&(o=[1,1]),i===void 0&&(i="NHWC"),this.throwIfDisposed(),q.separableConv2d(this,t,n,r,a,o,i)},e.prototype.avgPool=function(t,n,r,a){return this.throwIfDisposed(),q.avgPool(this,t,n,r,a)},e.prototype.maxPool=function(t,n,r,a){return this.throwIfDisposed(),q.maxPool(this,t,n,r,a)},e.prototype.localResponseNormalization=function(t,n,r,a){return t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),a===void 0&&(a=.5),q.localResponseNormalization(this,t,n,r,a)},e.prototype.pool=function(t,n,r,a,o){return this.throwIfDisposed(),q.pool(this,t,n,r,a,o)},e.prototype.variable=function(t,n,r){return t===void 0&&(t=!0),this.throwIfDisposed(),br().makeVariable(this,t,n,r)},e.prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),q.unsortedSegmentSum(this,t,n)},e.prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),q.batchToSpaceND(this,t,n)},e.prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),q.spaceToBatchND(this,t,n)},e.prototype.topk=function(t,n){return t===void 0&&(t=1),n===void 0&&(n=!0),this.throwIfDisposed(),q.topk(this,t,n)},e.prototype.stridedSlice=function(t,n,r,a,o,i,s,l){return a===void 0&&(a=0),o===void 0&&(o=0),i===void 0&&(i=0),s===void 0&&(s=0),l===void 0&&(l=0),this.throwIfDisposed(),q.stridedSlice(this,t,n,r,a,o,i,s,l)},e.prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),q.depthToSpace(this,t,n)},e.prototype.fft=function(){return this.throwIfDisposed(),q.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),q.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),q.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),q.spectral.irfft(this)},e}();Object.defineProperty(it,Symbol.hasInstance,{value:function(e){return!!e&&e.dataId!=null&&e.shape!=null&&e.dtype!=null}});var fy,Af,Df,Tf,Pf,Bi=function(e){function t(n,r,a,o){var i=e.call(this,n.shape,n.dtype,n.dataId,o)||this;return i.trainable=r,i.name=a,i}return cr(t,e),t.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and previous value ("+this.dtype+") must match");if(!Lt(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and previous value ("+this.shape+") must match");br().disposeTensor(this),this.dataId=n.dataId,br().incRef(this,null)},t.prototype.dispose=function(){br().disposeVariable(this),this.isDisposedInternal=!0},t}(it);Object.defineProperty(Bi,Symbol.hasInstance,{value:function(e){return e instanceof it&&e.assign!=null&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(fy||(fy={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(Af||(Af={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(Df||(Df={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(Tf||(Tf={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(Pf||(Pf={}));var uI={float32:Tf,int32:Af,bool:Df,complex64:Pf};function Vt(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error("Can not upcast "+e+" with "+t)}return uI[e][t]}function Kd(e){return Vt(e,"int32")}function dt(e,t){if(e.dtype===t.dtype)return[e,t];var n=Vt(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function cI(e,t){D(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"})}function Gw(e){var t=[];return function n(r,a,o){if(r!=null){if(r instanceof it)return void a.push(r);if(i=r,!(!Array.isArray(i)&&typeof i!="object")){var i,s=r;for(var l in s){var c=s[l];o.has(c)||(o.add(c),n(c,a,o))}}}}(e,t,new Set),t}var Xd,py=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},e}(),dI=function(){function e(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new py}return e.prototype.ready=function(){return fe(this,void 0,void 0,function(){var t,n,r;return pe(this,function(a){switch(a.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),n=0,a.label=1;case 1:return n<t.length?(r=t[n],[4,this.initializeBackend(r).success]):[3,5];case 2:return a.sent()?[4,this.setBackend(r)]:[3,4];case 3:return a.sent(),[2];case 4:return n++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(e.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),n=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+n+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(n)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},e.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},e.prototype.registerBackend=function(t,n,r){return r===void 0&&(r=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:n,priority:r},!0)},e.prototype.setBackend=function(t){return fe(this,void 0,void 0,function(){var n,r,a;return pe(this,function(o){switch(o.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,n.asyncInit?[4,r]:[3,2]);case 1:return a=o.sent(),[3,3];case 2:a=r,o.label=3;case 3:if(!a)return[2,!1];o.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new iI(this.backendInstance),[2,!0]}})})},e.prototype.setupRegisteredKernels=function(){var t=this;ly(this.backendName).forEach(function(n){n.setupFunc!=null&&n.setupFunc(t.backendInstance)})},e.prototype.disposeRegisteredKernels=function(t){var n=this;ly(t).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(n.registry[t])})},e.prototype.initializeBackend=function(t){var n=this,r=this.registryFactory[t];if(r==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var a=r.factory();if(Promise.resolve(a)===a){var o=++this.pendingBackendInitId,i=a.then(function(s){return!(o<n.pendingBackendInitId)&&(n.registry[t]=s,n.pendingBackendInit=null,!0)}).catch(function(s){return!(o<n.pendingBackendInitId)&&(n.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),!1)});return this.pendingBackendInit=i,{success:i,asyncInit:!0}}return this.registry[t]=a,{success:!0,asyncInit:!1}}catch(s){return console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(n,r){return t.registryFactory[r].priority-t.registryFactory[n].priority})},e.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),n=0;n<t.length;n++){var r=t[n],a=this.initializeBackend(r),o=a.success,i=a.asyncInit;if(i||o)return{name:r,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(t,n){var r=this.state.tensorInfo.get(n),a=r.backend,o=this.readSync(n);a.disposeData(n),r.backend=t,t.move(n,o,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(t,n){var r,a=this,o=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");o=t}return this.scopedRun(function(){return a.startScope(o)},function(){return a.endScope(r)},function(){return(r=n())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},e.prototype.scopedRun=function(t,n,r){t();try{var a=r();return n(),a}catch(o){throw n(),o}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(t){var n=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),r={x:t};return this.addTapeNode(this.state.activeScope.name,r,[n],function(a){return{x:function(){return a.toFloat()}}},[]),n},e.prototype.runKernel=function(t,n,r,a,o){return this.runKernelFunc(null,n,null,t,r,a,o)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(t,n,r){var a=this.backend.numDataIds(),o=0;r.forEach(function(l){o+=l.dtype==="complex64"?3:1});var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=a-n-o-i;if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+s+" data ids) after running '"+t+"'")},e.prototype.runKernelFunc=function(t,n,r,a,o,i,s){var l,c=this;i===void 0&&(i=[]),s===void 0&&(s=[]);var d=[],h=this.isTapeOn();a==null&&(a=this.state.activeScope!=null?this.state.activeScope.name:"");var f,p=function(x){h&&(d=x.map(function(b){return c.keep(c.clone(b))}))},v=this.state.numBytes,g=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var y,m=Mw(a,this.backendName);return f=m!=null?function(){var x=c.backend.numDataIds();y=m.kernelFunc({inputs:n,attrs:o,backend:c.backend});var b=Array.isArray(y)?y:[y];c.shouldCheckForMemLeaks()&&c.checkKernelForMemLeak(a,x,b);var w=b.map(function(C){var S=C.dataId,k=C.shape,_=C.dtype;return c.makeTensorFromDataId(S,k,_)}),N=w.filter(function(C,S){return s[S]});return p((i||[]).slice().concat(N)),w}:function(){var x=c.backend.numDataIds();y=c.tidy(function(){return t(c.backend,p)});var b=Array.isArray(y)?y:[y];return c.shouldCheckForMemLeaks()&&c.checkKernelForMemLeak(a,x,b),b},this.scopedRun(function(){return c.state.kernelDepth++},function(){return c.state.kernelDepth--},function(){l=c.ENV.getBool("DEBUG")?c.profiler.profileKernel(a,n,function(){return f()}):f()}),h&&this.addTapeNode(a,n,l,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:a,bytesAdded:this.state.numBytes-v,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-g,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(function(x){return n[x].shape}),outputShapes:l.map(function(x){return x.shape})}),Array.isArray(y)?l:l[0]},e.prototype.makeTensor=function(t,n,r,a){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",a=a||this.backend;var o=t;r==="string"&&lm(t[0])&&(o=t.map(function(d){return aI(d)}));var i=a.write(o,n,r),s=new it(n,r,i,this.nextTensorId());if(this.incRef(s,a),r==="string"){var l=this.state.tensorInfo.get(i),c=tI(o);this.state.numBytes+=c-l.bytes,l.bytes=c}return s},e.prototype.makeTensorFromDataId=function(t,n,r,a){var o=new it(n,r=r||"float32",t,this.nextTensorId());return this.incRef(o,a),o},e.prototype.makeVariable=function(t,n,r,a){n===void 0&&(n=!0),r=r||this.nextVariableId().toString(),a!=null&&a!==t.dtype&&(t=t.asType(a));var o=new Bi(t,n,r,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error("Variable with name "+o.name+" was already registered");return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o},e.prototype.incRef=function(t,n){var r=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var a=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(a=t.size*zw(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:a,refCount:0}),this.state.numBytes+=a}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Bi||this.track(t)},e.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var n=this.state.tensorInfo.get(t.dataId);n.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var n=this.state.registeredVariables[t];this.disposeVariable(n)}},e.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},e.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},e.prototype.profile=function(t){return fe(this,void 0,void 0,function(){var n,r;return pe(this,function(a){return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(o){return o.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},e.prototype.addTapeNode=function(t,n,r,a,o){var i=this,s={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:r,saved:o},l=qR(t);l!=null&&(a=l.gradFunc),a!=null&&(s.gradient=function(c){return c=c.map(function(d,h){if(d==null){var f=r[h],p=pl(f.size,f.dtype);return i.makeTensor(p,f.shape,f.dtype)}return d}),a(c.length>1?c:c[0],o)}),this.state.activeTape.push(s)},e.prototype.keep=function(t){return t.kept=!0,t},e.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(t){var n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n},e.prototype.endScope=function(t){for(var n=this,r=Gw(t),a=new Set(r.map(function(l){return l.id})),o=0;o<this.state.activeScope.track.length;o++){var i=this.state.activeScope.track[o];i.kept||a.has(i.id)||i.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(l){l.kept||l.scopeId!==s.id||n.track(l)})},e.prototype.gradients=function(t,n,r,a){var o=this;if(a===void 0&&(a=!1),D(n.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var i=this.scopedRun(function(){return o.startTape()},function(){return o.endTape()},function(){return o.tidy("forward",t)});D(i instanceof it,function(){return"The result y returned by f() must be a tensor."});var s=function(l,c,d){for(var h={},f={},p=0;p<c.length;p++)h[c[p].id]=!0;for(p=0;p<l.length;p++){var v=(C=l[p]).inputs;for(var g in v){for(var y=v[g],m=!1,x=0;x<c.length;x++)if(h[y.id]){C.outputs.forEach(function(E){return h[E.id]=!0}),m=!0,f[C.id]=!0;break}if(m)break}}var b={};b[d.id]=!0;var w={};for(p=l.length-1;p>=0;p--)for(v=(C=l[p]).inputs,x=0;x<C.outputs.length;x++)if(b[C.outputs[x].id]){for(var g in v)b[v[g].id]=!0,w[C.id]=!0;break}var N=[];for(p=0;p<l.length;p++){var C;if(f[(C=l[p]).id]&&w[C.id]){var S={};for(var g in C.inputs){var k=C.inputs[g];h[k.id]&&(S[g]=k)}var _=Object.assign({},C);_.inputs=S,_.outputs=C.outputs,N.push(_)}}return N}(this.state.activeTape,n,i);if(!a&&s.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var l,c,d={};d[i.id]=r??(l=i.shape,c=Uw(me(l),"float32"),O.makeTensor(c,l,"float32")),function(f,p,v){for(var g=function(m){var x=p[m],b=[];if(x.outputs.forEach(function(S){var k=f[S.id];k!=null?b.push(k):b.push(null)}),x.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+x.kernelName+".");var w=x.gradient(b),N=function(S){if(!(S in w))throw new Error("Cannot backprop through input "+S+". Available gradients found: "+Object.keys(w)+".");var k=v(function(){return w[S]()});if(k.dtype!=="float32")throw new Error("Error in gradient for op "+x.kernelName+". The gradient of input "+S+" must have 'float32' dtype, but has '"+k.dtype+"'");var _=x.inputs[S];if(!Lt(k.shape,_.shape))throw new Error("Error in gradient for op "+x.kernelName+". The gradient of input '"+S+"' has shape '"+k.shape+"', which does not match the shape of the input '"+_.shape+"'");if(f[_.id]==null)f[_.id]=k;else{var E=f[_.id];f[_.id]=E.add(k),E.dispose()}};for(var C in x.inputs)N(C)},y=p.length-1;y>=0;y--)g(y)}(d,s,function(f){return o.tidy(f)});var h=n.map(function(f){return d[f.id]});return o.state.gradientDepth===0&&(o.state.activeTape.forEach(function(f){for(var p=0,v=f.saved;p<v.length;p++)v[p].dispose()}),o.state.activeTape=null),{value:i,grads:h}})},e.prototype.customGrad=function(t){var n=this;return D(Rf(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];D(a.every(function(s){return s instanceof it}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var i={};return a.forEach(function(s,l){i[l]=s}),n.runKernelFunc(function(s,l){return D((r=t.apply(void 0,a.concat([l]))).value instanceof it,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),D(Rf(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},i,function(s,l){var c=r.gradFunc(s,l),d=Array.isArray(c)?c:[c];D(d.length===a.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),D(d.every(function(f){return f instanceof it}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var h={};return d.forEach(function(f,p){h[p]=function(){return f}}),h})}},e.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},e.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},e.prototype.time=function(t){return fe(this,void 0,void 0,function(){var n,r;return pe(this,function(a){switch(a.label){case 0:return n=xr(),[4,this.backend.time(t)];case 1:return(r=a.sent()).wallMs=xr()-n,[2,r]}})})},e.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new py,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),O=function(){var e=function(){if(Xd==null){var n=void 0;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else{if(typeof self>"u")throw new Error("Could not find a global object");n=self}Xd=n}return Xd}();if(e._tfengine==null){var t=new HR(e);e._tfengine=new dI(t)}return function(n){Fw=n}(e._tfengine.ENV),br=function(){return e._tfengine},e._tfengine}();function qw(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var zr=X();zr.registerFlag("DEBUG",function(){return!1},function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),zr.registerFlag("IS_BROWSER",function(){return qw()}),zr.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),zr.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),zr.registerFlag("PROD",function(){return!1}),zr.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return zr.getBool("DEBUG")}),zr.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),zr.registerFlag("IS_TEST",function(){return!1});var Qs,Rn,En,oo={},Yd={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function hI(e,t){oo[e]=t}function Tr(e){e in oo||(oo[e]=function(n){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(a){if(typeof OffscreenCanvas<"u"&&a===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n);return r.addEventListener("webglcontextlost",function(a){a.preventDefault(),delete oo[n]},!1),n===1?r.getContext("webgl",Yd)||r.getContext("experimental-webgl",Yd):r.getContext("webgl2",Yd)}(e));var t=oo[e];return t.isContextLost()?(delete oo[e],Tr(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),oo[e])}function Yc(e,t){return[t,e]}function Ss(e){var t=me(e);return _f(Math.ceil(t/4))}function ml(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function um(e,t){var n,r,a,o,i,s,l,c,d,h=e;return X().getNumber("WEBGL_VERSION")===2?(n=h.R32F,r=h.R16F,a=h.RGBA16F,o=h.RGBA32F,i=h.RED,s=4,l=1,c=h.HALF_FLOAT,d=h.FLOAT):(n=e.RGBA,r=e.RGBA,a=e.RGBA,o=h.RGBA,i=e.RGBA,s=4,l=4,c=t!=null?t.HALF_FLOAT_OES:null,d=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:o,textureFormatFloat:i,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:l,textureTypeHalfFloat:c,textureTypeFloat:d}}function ve(e,t,n){var r=n();return t&&function(a){var o=a.getError();if(o!==a.NO_ERROR)throw new Error("WebGL Error: "+vI(a,o))}(e),r}(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(Qs||(Qs={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(Rn||(Rn={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(En||(En={}));var fI=596e-10,pI=65504;function mI(e){return!!(X().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||fI<Math.abs(e)&&Math.abs(e)<pI)}function vI(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function Hl(e,t,n){return oa(e,t,function(){return e.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function gI(e,t,n){var r=oa(e,t,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(ve(e,t,function(){return e.shaderSource(r,n)}),ve(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function xI(e,t,n){var r=oa(e,t,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(ve(e,t,function(){return e.shaderSource(r,n)}),ve(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw function(a,o){var i=yI.exec(o);if(i==null)return console.log("Couldn't parse line number in error: "+o),void console.log(a);for(var s=+i[1],l=a.split(`
`),c=l.length.toString().length+2,d=l.map(function(y,m){return mi((m+1).toString(),c)+y}),h=0,f=0;f<d.length;f++)h=Math.max(d[f].length,h);var p=d.slice(0,s-1),v=d.slice(s-1,s),g=d.slice(s);console.log(p.join(`
`)),console.log(o.split(`
`)[0]),console.log("%c "+mi(v[0],h),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(g.join(`
`))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var Qd,Jd,yI=/ERROR: [0-9]+:([0-9]+):/g;function bI(e,t){return oa(e,t,function(){return e.createProgram()},"Unable to create WebGLProgram.")}function wI(e,t,n){if(ve(e,t,function(){return e.linkProgram(n)}),e.getProgramParameter(n,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function Zd(e,t,n){if(ve(e,t,function(){return e.validateProgram(n)}),e.getProgramParameter(n,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function NI(e,t,n){var r=oa(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return ve(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),ve(e,t,function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function CI(e,t,n){var r=oa(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return ve(e,t,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)}),ve(e,t,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function kI(e,t){return oa(e,t,function(){return e.createTexture()},"Unable to create WebGLTexture.")}function jI(e,t){var n=X().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+n+"x"+n+"]")+".")}function SI(e,t){return oa(e,t,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function my(e,t,n,r,a,o,i,s){var l=e.getAttribLocation(n,r);return l!==-1&&(ve(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,a)}),ve(e,t,function(){return e.vertexAttribPointer(l,o,e.FLOAT,!1,i,s)}),ve(e,t,function(){return e.enableVertexAttribArray(l)}),!0)}function EI(e,t,n,r){DI(e,r),ve(e,t,function(){return e.activeTexture(e.TEXTURE0+r)}),ve(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)})}function _I(e,t,n,r){return oa(e,t,function(){return e.getUniformLocation(n,r)},'uniform "'+r+'" not present in program.')}function RI(e,t,n){return e.getUniformLocation(t,n)}function II(e,t,n,r,a,o){ve(e,t,function(){return EI(e,t,r,o)}),ve(e,t,function(){return e.uniform1i(a,o)})}function eh(e,t,n,r){ve(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)}),ve(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)})}function vy(e,t,n){ve(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),ve(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})}function Gl(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+AI(e,t))}function AI(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function oa(e,t,n,r){var a=ve(e,t,function(){return n()});if(a==null)throw new Error(r);return a}function DI(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+n+"]")+".")}function rc(e,t){return t===void 0&&(t=2),me(e.slice(0,e.length-t))}function ac(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function th(e){var t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[rc(e)].concat(ac(e))),t}function TI(e,t){var n;t===void 0&&(t=!1);var r=X().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,(e=e.map(function(c,d){return d>=e.length-2?Bw(e[d]):e[d]})).length===1&&(e=[2,e[0]])),e.length!==2){var a=so(e);e=a.newShape}var o=me(e);if(e.length<=1&&o<=r)return[1,o];if(e.length===2&&e[0]<=r&&e[1]<=r)return e;if(e.length===3&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(e.length===3&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(e.length===4&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(e.length===4&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var i=rc(e),s=2,l=2;return e.length&&(s=(n=ac(e))[0],l=n[1]),_f(o=i*(s/2)*(l/2)).map(function(c){return 2*c})}return _f(o)}function ql(e){return e%2==0}function Kl(e,t){if(Lt(e=e.slice(-2),t=t.slice(-2))||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r||ql(n)&&ql(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&ql(e[0])&&ql(t[0])}function PI(e){if(Qd==null){var t=Tr(e);Qd=t.getParameter(t.MAX_TEXTURE_SIZE)}return Qd}function FI(e){if(Jd==null){var t=Tr(e);Jd=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Jd)}function MI(e){if(e===0)return 0;var t=Tr(e);return Hn(t,"EXT_disjoint_timer_query_webgl2")&&e===2?2:Hn(t,"EXT_disjoint_timer_query")?1:0}function Hn(e,t){return e.getExtension(t)!=null}function gy(e){try{if(Tr(e)!=null)return!0}catch{return!1}return!1}function OI(e){if(e===0)return!1;var t=Tr(e);if(e===1){if(!Hn(t,"OES_texture_float"))return!1}else if(!Hn(t,"EXT_color_buffer_float"))return!1;return Ff(t)}function LI(e){if(e===0)return!1;var t=Tr(e);if(e!==1){if(Hn(t,"EXT_color_buffer_float"))return Ff(t);if(Hn(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(r,a){var o=um(r,a),i=r.createTexture();r.bindTexture(r.TEXTURE_2D,i),r.texImage2D(r.TEXTURE_2D,0,o.internalFormatHalfFloat,1,1,0,o.textureFormatFloat,o.textureTypeHalfFloat,null);var s=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,s),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,i,0);var l=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(i),r.deleteFramebuffer(s),l}(t,n)}return!1}return!!Hn(t,"OES_texture_float")&&!!Hn(t,"WEBGL_color_buffer_float")&&Ff(t)}function Ff(e){var t=um(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function BI(e){return e===2&&Tr(e).fenceSync!=null}var Se=X();function Kw(e){X().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function ce(e,t){return O.tidy(e,t)}function Nn(e){Gw(e).forEach(function(t){return t.dispose()})}function zI(e){return O.keep(e)}function oc(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];X().getBool("IS_TEST")||console.warn.apply(console,e)}function Ja(e,t){var n=e;if(Er(e))return t==="string"?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||Er(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&X().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function a(o,i,s){if(s=s||[],!Array.isArray(o)&&!Er(o))return void D(i.length===0,function(){return"Element arr["+s.join("][")+"] is a primitive, but should be an array/TypedArray of "+i[0]+" elements"});D(i.length>0,function(){return"Element arr["+s.join("][")+"] should be a primitive, but is an array of "+o.length+" elements"}),D(o.length===i[0],function(){return"Element arr["+s.join("][")+"] should have "+i[0]+" elements, but has "+o.length+" elements"});for(var l=i.slice(1),c=0;c<o.length;++c)a(o[c],l,s.concat(c))}(e,r,[]),r}function xy(e,t,n,r){if(e!=null&&(e!=="numeric"&&e!==t||e==="numeric"&&t==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function R(e,t,n,r){if(r===void 0&&(r="numeric"),e instanceof it)return xy(r,e.dtype,t,n),e;var a=fl(e);if(a!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),xy(r,a,t,n),e==null||!Er(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){var o=e==null?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+o+"'")}var i=Ja(e,a);Er(e)||Array.isArray(e)||(e=[e]);var s=a!=="string"?$w(e,a,X().getBool("DEBUG")):Li(e,[],!0);return O.makeTensor(s,i,a)}function ic(e,t,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map(function(a,o){return R(a,t+"["+o+"]",n)},r)}function Xw(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function $I(e,t,n){for(var r=e.length+t.length,a=[],o=0,i=0,s=0;s<r;s++)n.indexOf(s)===-1?a.push(e[o++]):a.push(t[i++]);return a}function Yt(e,t){for(var n=[],r=e.length,a=0;a<r;a++)t.indexOf(a)===-1&&n.push(e[a]);return[n,t.map(function(o){return e[o]})]}function Cn(e,t){return $I(e,t.map(function(n){return 1}),t)}function Sn(e,t,n){D(Xw(t,n),function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."})}function Pr(e,t){if(Xw(e,t))return null;for(var n=[],r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(function(a){return n.push(a)}),n}function cm(e){return e.map(function(t,n){return[n,t]}).sort(function(t,n){return t[1]-n[1]}).map(function(t){return t[0]})}function Fr(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function UI(e,t){var n=e[0].length;e.forEach(function(a,o){D(a.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+o+"] must be the same as the rank of the rest ("+n+")"})}),D(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=e[0];e.forEach(function(a,o){for(var i=0;i<n;i++)D(i===t||a[i]===r[i],function(){return"Error in concat"+n+"D: Shape of tensors["+o+"] ("+a+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+o+"."})})}function zi(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function F(e){var t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var a=function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];O.startScope(n);try{var s=r.apply(void 0,o);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),O.endScope(s),s}catch(l){throw O.endScope(null),l}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}Se.registerFlag("HAS_WEBGL",function(){return Se.getNumber("WEBGL_VERSION")>0}),Se.registerFlag("WEBGL_VERSION",function(){return gy(2)?2:gy(1)?1:0}),Se.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return Se.get("WEBGL_VERSION")===2}),Se.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),Se.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),Se.registerFlag("WEBGL_PACK",function(){return Se.getBool("HAS_WEBGL")}),Se.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return Se.getBool("WEBGL_PACK")}),Se.registerFlag("WEBGL_PACK_CLIP",function(){return Se.getBool("WEBGL_PACK")}),Se.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),Se.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return Se.getBool("WEBGL_PACK")}),Se.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return Se.getBool("WEBGL_PACK")}),Se.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return Se.getBool("WEBGL_PACK")}),Se.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return Se.getBool("WEBGL_PACK")}),Se.registerFlag("WEBGL_PACK_REDUCE",function(){return Se.getBool("WEBGL_PACK")}),Se.registerFlag("WEBGL_LAZILY_UNPACK",function(){return Se.getBool("WEBGL_PACK")}),Se.registerFlag("WEBGL_CONV_IM2COL",function(){return Se.getBool("WEBGL_PACK")}),Se.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return PI(Se.getNumber("WEBGL_VERSION"))}),Se.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return FI(Se.getNumber("WEBGL_VERSION"))}),Se.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var e=Se.getNumber("WEBGL_VERSION");return e===0?0:MI(e)}),Se.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return Se.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e}),Se.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return OI(Se.getNumber("WEBGL_VERSION"))}),Se.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!Se.getBool("WEBGL_FORCE_F16_TEXTURES")&&Se.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),Se.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return LI(Se.getNumber("WEBGL_VERSION"))}),Se.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return BI(Se.getNumber("WEBGL_VERSION"))}),Se.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return Se.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),Hw=Kw;var Wt=F({complex_:function(e,t){var n=R(e,"real","complex"),r=R(t,"imag","complex");return Ge(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),O.runKernelFunc(function(a){return a.complex(n,r)},{$real:n,$imag:r})}}),Wn=F({real_:function(e){var t=R(e,"input","real");return O.runKernelFunc(function(n){return n.real(t)},{$input:t})}}),wr=F({imag_:function(e){var t=R(e,"input","imag");return O.runKernelFunc(function(n){return n.imag(t)},{$input:t})}});function Ht(e,t,n){return Za(e,t,Ja(e,n),n)}function Za(e,t,n,r){if(r==null&&(r=fl(e)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Er(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){Ww(t);var a=me(t),o=me(n);D(a===o,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+a+" values but has "+o});for(var i=0;i<n.length;++i){var s=n[i],l=i!==n.length-1||s!==me(t.slice(i));D(n[i]===t[i]||!l,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "})}}return Er(e)||Array.isArray(e)||(e=[e]),t=t||n,e=r!=="string"?$w(e,r,X().getBool("DEBUG")):Li(e,[],!0),O.makeTensor(e,t,r)}function le(e,t){if((Er(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Er(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Za(e,[],[],t)}function wt(e,t){Xi(e);var n=Ja(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Za(e,null,n,t)}function Oa(e,t,n){if(Xi(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=Ja(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Za(e,t,r,n)}function dm(e,t,n){if(Xi(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=Ja(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Za(e,t,r,n)}function fn(e,t,n){if(Xi(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=Ja(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Za(e,t,r,n)}function WI(e,t,n){if(Xi(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=Ja(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Za(e,t,r,n)}function VI(e,t,n){if(Xi(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=Ja(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Za(e,t=t||r,r,n)}function HI(e,t,n,r){return t===void 0&&(t=!0),O.makeVariable(e,t,n,r)}function Yi(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=Yi(e,"float32"),r=et(e,"float32");return Wt(n,r)}var a=Uw(me(e),t);return O.makeTensor(a,e,t)}function et(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=et(e,"float32"),r=et(e,"float32");return Wt(n,r)}var a=pl(me(e),t);return O.makeTensor(a,e,t)}function Rr(e,t,n){return O.runKernelFunc(function(r){return r.fill(e,t,n)},{})}function GI(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return O.runKernelFunc(function(r){return r.linspace(e,t,n)},{})}function sc(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n===0)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return et([0],r);var a=pl(Math.abs(Math.ceil((t-e)/n)),r);t<e&&n===1&&(n=-1),a[0]=e;for(var o=1;o<a.length;o++)a[o]=a[o-1]+n;return wt(a,r)}var Yw=F({onesLike_:function(e){var t=R(e,"x","onesLike");if(t.dtype==="complex64"){var n=Yw(Wn(t)),r=Ue(wr(t));return Wt(n,r)}return O.runKernelFunc(function(a){return a.onesLike(t)},{$x:t},function(a,o){return{$x:function(){return Ue(a)}}})}}),Ue=F({zerosLike_:function(e){var t=R(e,"x","zerosLike");return O.runKernelFunc(function(n){return n.zerosLike(t)},{$x:t},function(n,r){return{$x:function(){return Ue(n)}}})}}),_t=F({concat_:function(e,t){t===void 0&&(t=0),D(e.length>=1,function(){return"Pass at least one tensor to concat"});var n=ic(e,"tensors","concat");n[0].dtype==="complex64"&&n.forEach(function(s){if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+s.dtype+". ")}),t=Dt(t,n[0].shape)[0];var r=zi(n.map(function(s){return s.shape}),t);if(me(r)===0)return Ht([],r);if((n=n.filter(function(s){return s.size>0})).length===1)return n[0];var a=n.map(function(s){return s.shape});UI(a,t);var o=n,i={axis:t};return O.runKernelFunc(function(s){return s.concat(n,t)},o,function(s){var l=a.map(function(c){return c[t]});return hm(s,l,t).map(function(c){return function(){return c}})},"Concat",i)}}),qI=F({concat1d_:function(e){return _t(e,0)}}),KI=F({concat2d_:function(e,t){return _t(e,t)}}),XI=F({concat3d_:function(e,t){return _t(e,t)}}),YI=F({concat4d_:function(e,t){return _t(e,t)}}),hm=F({split_:function(e,t,n){n===void 0&&(n=0);var r,a=R(e,"x","split");return n=Dt(n,a.shape)[0],typeof t=="number"?(D(a.shape[n]%t==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(t).fill(a.shape[n]/t)):(D(a.shape[n]===t.reduce(function(o,i){return o+i}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=t),O.runKernelFunc(function(o){return o.split(a,r,n)},{$x:a},function(o){return{$x:function(){return _t(o,n)}}})}});function To(e,t){return e(t={exports:{}},t.exports),t.exports}var QI=To(function(e){(function(t,n,r){function a(s){var l,c=this,d=(l=4022871197,function(h){h=h.toString();for(var f=0;f<h.length;f++){var p=.02519603282416938*(l+=h.charCodeAt(f));p-=l=p>>>0,l=(p*=l)>>>0,l+=4294967296*(p-=l)}return 23283064365386963e-26*(l>>>0)});c.next=function(){var h=2091639*c.s0+23283064365386963e-26*c.c;return c.s0=c.s1,c.s1=c.s2,c.s2=h-(c.c=0|h)},c.c=1,c.s0=d(" "),c.s1=d(" "),c.s2=d(" "),c.s0-=d(s),c.s0<0&&(c.s0+=1),c.s1-=d(s),c.s1<0&&(c.s1+=1),c.s2-=d(s),c.s2<0&&(c.s2+=1),d=null}function o(s,l){return l.c=s.c,l.s0=s.s0,l.s1=s.s1,l.s2=s.s2,l}function i(s,l){var c=new a(s),d=l&&l.state,h=c.next;return h.int32=function(){return 4294967296*c.next()|0},h.double=function(){return h()+11102230246251565e-32*(2097152*h()|0)},h.quick=h,d&&(typeof d=="object"&&o(d,c),h.state=function(){return o(c,{})}),h}n&&n.exports?n.exports=i:this.alea=i})(0,e)}),JI=To(function(e){(function(t,n,r){function a(s){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var h=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^h^h>>>8},s===(0|s)?l.x=s:c+=s;for(var d=0;d<c.length+64;d++)l.x^=0|c.charCodeAt(d),l.next()}function o(s,l){return l.x=s.x,l.y=s.y,l.z=s.z,l.w=s.w,l}function i(s,l){var c=new a(s),d=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(f===0);return f},h.int32=c.next,h.quick=h,d&&(typeof d=="object"&&o(d,c),h.state=function(){return o(c,{})}),h}n&&n.exports?n.exports=i:this.xor128=i})(0,e)}),ZI=To(function(e){(function(t,n,r){function a(s){var l=this,c="";l.next=function(){var h=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^h^h<<1)|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,s===(0|s)?l.x=s:c+=s;for(var d=0;d<c.length+64;d++)l.x^=0|c.charCodeAt(d),d==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function o(s,l){return l.x=s.x,l.y=s.y,l.z=s.z,l.w=s.w,l.v=s.v,l.d=s.d,l}function i(s,l){var c=new a(s),d=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(f===0);return f},h.int32=c.next,h.quick=h,d&&(typeof d=="object"&&o(d,c),h.state=function(){return o(c,{})}),h}n&&n.exports?n.exports=i:this.xorwow=i})(0,e)}),e5=To(function(e){(function(t,n,r){function a(s){var l=this;l.next=function(){var c,d,h=l.x,f=l.i;return c=h[f],d=(c^=c>>>7)^c<<24,d^=(c=h[f+1&7])^c>>>10,d^=(c=h[f+3&7])^c>>>3,d^=(c=h[f+4&7])^c<<7,c=h[f+7&7],d^=(c^=c<<13)^c<<9,h[f]=d,l.i=f+1&7,d},function(c,d){var h,f=[];if(d===(0|d))f[0]=d;else for(d=""+d,h=0;h<d.length;++h)f[7&h]=f[7&h]<<15^d.charCodeAt(h)+f[h+1&7]<<13;for(;f.length<8;)f.push(0);for(h=0;h<8&&f[h]===0;++h);for(h==8?f[7]=-1:f[h],c.x=f,c.i=0,h=256;h>0;--h)c.next()}(l,s)}function o(s,l){return l.x=s.x.slice(),l.i=s.i,l}function i(s,l){s==null&&(s=+new Date);var c=new a(s),d=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(f===0);return f},h.int32=c.next,h.quick=h,d&&(d.x&&o(d,c),h.state=function(){return o(c,{})}),h}n&&n.exports?n.exports=i:this.xorshift7=i})(0,e)}),t5=To(function(e){(function(t,n,r){function a(s){var l=this;l.next=function(){var c,d,h=l.w,f=l.X,p=l.i;return l.w=h=h+1640531527|0,d=f[p+34&127],c=f[p=p+1&127],d^=d<<13,c^=c<<17,d^=d>>>15,c^=c>>>12,d=f[p]=d^c,l.i=p,d+(h^h>>>16)|0},function(c,d){var h,f,p,v,g,y=[],m=128;for(d===(0|d)?(f=d,d=null):(d+="\0",f=0,m=Math.max(m,d.length)),p=0,v=-32;v<m;++v)d&&(f^=d.charCodeAt((v+32)%d.length)),v===0&&(g=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,v>=0&&(g=g+1640531527|0,p=(h=y[127&v]^=f+g)==0?p+1:0);for(p>=128&&(y[127&(d&&d.length||0)]=-1),p=127,v=512;v>0;--v)f=y[p+34&127],h=y[p=p+1&127],f^=f<<13,h^=h<<17,f^=f>>>15,h^=h>>>12,y[p]=f^h;c.w=g,c.X=y,c.i=p}(l,s)}function o(s,l){return l.i=s.i,l.w=s.w,l.X=s.X.slice(),l}function i(s,l){s==null&&(s=+new Date);var c=new a(s),d=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(f===0);return f},h.int32=c.next,h.quick=h,d&&(d.X&&o(d,c),h.state=function(){return o(c,{})}),h}n&&n.exports?n.exports=i:this.xor4096=i})(0,e)}),n5=To(function(e){(function(t,n,r){function a(s){var l=this,c="";l.next=function(){var h=l.b,f=l.c,p=l.d,v=l.a;return h=h<<25^h>>>7^f,f=f-p|0,p=p<<24^p>>>8^v,v=v-h|0,l.b=h=h<<20^h>>>12^f,l.c=f=f-p|0,l.d=p<<16^f>>>16^v,l.a=v-h|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,s===Math.floor(s)?(l.a=s/4294967296|0,l.b=0|s):c+=s;for(var d=0;d<c.length+20;d++)l.b^=0|c.charCodeAt(d),l.next()}function o(s,l){return l.a=s.a,l.b=s.b,l.c=s.c,l.d=s.d,l}function i(s,l){var c=new a(s),d=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(f===0);return f},h.int32=c.next,h.quick=h,d&&(typeof d=="object"&&o(d,c),h.state=function(){return o(c,{})}),h}n&&n.exports?n.exports=i:this.tychei=i})(0,e)}),io=To(function(e){(function(t,n){var r,a=this,o=256,i=6,s="random",l=n.pow(o,i),c=n.pow(2,52),d=2*c,h=o-1;function f(m,x,b){var w=[],N=g(function k(_,E){var j,T=[],L=typeof _;if(E&&L=="object")for(j in _)try{T.push(k(_[j],E-1))}catch{}return T.length?T:L=="string"?_:_+"\0"}((x=x==1?{entropy:!0}:x||{}).entropy?[m,y(t)]:m??function(){try{var k;return r&&(k=r.randomBytes)?k=k(o):(k=new Uint8Array(o),(a.crypto||a.msCrypto).getRandomValues(k)),y(k)}catch{var _=a.navigator,E=_&&_.plugins;return[+new Date,a,E,a.screen,y(t)]}}(),3),w),C=new p(w),S=function(){for(var k=C.g(i),_=l,E=0;k<c;)k=(k+E)*o,_*=o,E=C.g(1);for(;k>=d;)k/=2,_/=2,E>>>=1;return(k+E)/_};return S.int32=function(){return 0|C.g(4)},S.quick=function(){return C.g(4)/4294967296},S.double=S,g(y(C.S),t),(x.pass||b||function(k,_,E,j){return j&&(j.S&&v(j,C),k.state=function(){return v(C,{})}),E?(n[s]=k,_):k})(S,N,"global"in x?x.global:this==n,x.state)}function p(m){var x,b=m.length,w=this,N=0,C=w.i=w.j=0,S=w.S=[];for(b||(m=[b++]);N<o;)S[N]=N++;for(N=0;N<o;N++)S[N]=S[C=h&C+m[N%b]+(x=S[N])],S[C]=x;(w.g=function(k){for(var _,E=0,j=w.i,T=w.j,L=w.S;k--;)_=L[j=h&j+1],E=E*o+L[h&(L[j]=L[T=h&T+_])+(L[T]=_)];return w.i=j,w.j=T,E})(o)}function v(m,x){return x.i=m.i,x.j=m.j,x.S=m.S.slice(),x}function g(m,x){for(var b,w=m+"",N=0;N<w.length;)x[h&N]=h&(b^=19*x[h&N])+w.charCodeAt(N++);return y(x)}function y(m){return String.fromCharCode.apply(0,m)}if(n["seed"+s]=f,g(n.random(),t),e.exports){e.exports=f;try{r=require("crypto")}catch{}}})([],Math)});io.alea=QI,io.xor128=JI,io.xorwow=ZI,io.xorshift7=e5,io.xor4096=t5,io.tychei=n5;var Qc=io.alea,fm=function(){function e(t,n,r,a,o){this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var i=o||Math.random();this.random=Qc(i.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var n,r,a=!1;!a;){var o=void 0,i=void 0,s=void 0;do s=(o=2*this.random()-1)*o+(i=2*this.random()-1)*i;while(s>=1||s===0);var l=Math.sqrt(-2*Math.log(s)/s);n=this.mean+this.stdDev*o*l,r=this.mean+this.stdDev*i*l,this.truncated&&!this.isValidTruncated(n)||(a=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(n)},e.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},e.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},e}(),r5=function(){function e(t,n,r,a){this.alpha=t,this.beta=1/n,this.dtype=r;var o=a||Math.random();this.randu=Qc(o.toString()),this.randn=new fm(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var t,n,r,a,o,i;;){do a=this.randn.nextValue(),i=1+this.c*a;while(i<=0);if(i*=i*i,n=1-.331*(t=a*a)*t,r=.5*t+this.d*(1-i+Math.log(i)),(o=this.randu())<n||Math.log(o)<r)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)},e.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},e}(),a5=function(){function e(t,n,r,a){var o=this;if(t===void 0&&(t=0),n===void 0&&(n=1),this.canReturnFloat=function(){return o.dtype==null||o.dtype==="float32"},this.min=t,this.range=n-t,this.dtype=r,a==null&&(a=Math.random()),typeof a=="number"&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+n+" <= 1 and dtype is not float");this.random=Qc(a)}return e.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}();function De(e,t,n){return t===void 0&&(t="float32"),t=t||"float32",Ww(e),new Ys(e,t,n)}function o5(e,t){t===void 0&&(t=!1),console.log(e.toString(t))}var Qw=F({batchToSpaceND_:function(e,t,n){var r=R(e,"x","batchToSpaceND"),a=t.reduce(function(o,i){return o*i});return D(r.rank>=1+t.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length}),D(n.length===t.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length}),D(r.shape[0]%a==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+a}),O.runKernelFunc(function(o){return o.batchToSpaceND(r,t,n)},{$x:r},function(o){return{$x:function(){return o.spaceToBatchND(t,n)}}})}}),i5=F({broadcastTo_:function(e,t){var n=R(e,"broadcastTo","x"),r=n.shape;if(t.some(function(l){return!(l>0)||l%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var a=n.shape.slice();a.length<t.length;)a.unshift(1);n=n.reshape(a)}for(var o=Array.from(t),i=t.length-1;i>=0;i--)if(n.shape[i]===t[i])o[i]=1;else if(n.shape[i]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var s=o.map(function(l,c){return l>1?c:-1}).filter(function(l){return l>=0});return s.length===0?n.clone():O.runKernelFunc(function(l){return l.tile(n,o)},{input:n},function(l){return{input:function(){return l.sum(s,!0)}}})}}),s5=F({cast_:function(e,t){var n=R(e,"x","cast");if(!ZR(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:t};return O.runKernelFunc(function(a){return a.cast(n,t)},{x:n},function(a){return{x:function(){return a.clone()}}},"Cast",r)}}),l5=F({clone_:function(e){var t=R(e,"x","clone",null);return O.runKernelFunc(function(){return O.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(n){return{$x:function(){return n.toFloat()}}})}}),u5=F({cumsum_:function(e,t,n,r){t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1);var a=R(e,"x","cumsum"),o=Pr([t|=0],a.rank),i=a;o!=null&&(i=a.transpose(o));var s=Fr(1,a.rank)[0],l=O.runKernelFunc(function(c){return c.cumsum(i,s,n,r)},{permutedX:i},function(c){return{permutedX:function(){return c.cumsum(t,n,!r)}}});return o!=null&&(l=l.transpose(o)),l}}),c5=F({depthToSpace_:function(e,t,n){n===void 0&&(n="NHWC");var r=R(e,"x","depthToSpace"),a=n==="NHWC"?r.shape[1]:r.shape[2],o=n==="NHWC"?r.shape[2]:r.shape[3],i=n==="NHWC"?r.shape[3]:r.shape[1];return D(a*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+a+" and "+t+`  for depthToSpace with input shape
      `+r.shape}),D(o*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+o+" and "+t+` for depthToSpace with input shape
          `+r.shape}),D(i%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+i+" for depthToSpace with input shape "+r.shape}),O.runKernelFunc(function(s){return s.depthToSpace(r,t,n)},{$x:r})}}),Un=F({expandDims_:function(e,t){t===void 0&&(t=0);var n=R(e,"x","expandDims",null);D(t<=n.rank,function(){return"Axis must be <= rank of the tensor"});var r=n.shape.slice();return t<0&&(D(-(n.rank+1)<=t,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),t=n.rank+t+1),r.splice(t,0,1),nr(n,r)}}),Jw=F({eye_:function(e,t,n,r){r===void 0&&(r="float32"),t==null&&(t=e);for(var a=De([e,t],r),o=e<=t?e:t,i=0;i<o;++i)a.set(1,i,i);var s=a.toTensor().as2D(e,t);if(n==null)return s;if(n.length===1)return vi(Un(s,0),[n[0],1,1]);if(n.length===2)return vi(Un(Un(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return vi(Un(Un(Un(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),d5=F({multinomial_:function(e,t,n,r){r===void 0&&(r=!1);var a=R(e,"logits","multinomial"),o=a.size,i=a.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+o+".");if(i>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+i);n=n||Math.random();var s=i===1?a.as2D(1,-1):a,l=O.runKernelFunc(function(c){return c.multinomial(s,r,t,n)},{logits2D:s});return i===1?l.as1D():l}}),Mf=F({oneHot_:function(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var a=R(e,"indices","oneHot","int32"),o=a.shape.concat([t]);return a=a.flatten(),O.runKernelFunc(function(i){return i.oneHot(a,t,n,r)},{$indices:a},function(i){return{$indices:function(){return et(a.shape,"float32")}}}).reshape(o)}}),Po=F({pad_:function(e,t,n){n===void 0&&(n=0);var r=R(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a={paddings:t,constantValue:n};return O.runKernelFunc(function(o){return o.pad(r,t,n)},{x:r},function(o){var i=t.map(function(s){return s[0]});return{x:function(){return o.slice(i,r.shape)}}},"PadV2",a)}}),h5=F({pad1d_:function(e,t,n){return n===void 0&&(n=0),D(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),Po(e,[t],n)}}),f5=F({pad2d_:function(e,t,n){return n===void 0&&(n=0),D(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Po(e,t,n)}}),p5=F({pad3d_:function(e,t,n){return n===void 0&&(n=0),D(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Po(e,t,n)}}),m5=F({pad4d_:function(e,t,n){return n===void 0&&(n=0),D(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Po(e,t,n)}}),v5=F({rand_:function(e,t,n){var r=me(e),a=null;if(n==null||n==="float32")a=new Float32Array(r);else if(n==="int32")a=new Int32Array(r);else{if(n!=="bool")throw new Error("Unknown data type "+n);a=new Uint8Array(r)}for(var o=0;o<r;o++)a[o]=t();return O.makeTensor(a,e,n)}}),g5=F({randomNormal_:function(e,t,n,r,a){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var o=new fm(t,n,r,!1,a),i=De(e,r),s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}}),x5=F({randomGamma_:function(e,t,n,r,a){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var o=new r5(t,n,r,a),i=De(e,r),s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}}),Zw=F({randomUniform_:function(e,t,n,r,a){t===void 0&&(t=0),n===void 0&&(n=1),r===void 0&&(r="float32");for(var o=De(e,r),i=new a5(t,n,null,a),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),nr=F({reshape_:function(e,t){var n=R(e,"x","reshape",null);t=QR(t,n.size),D(n.size===me(t),function(){return"new shape and old shape must have the same number of elements."});var r={shape:t};return O.runKernelFunc(function(a){return a.reshape(n,t)},{x:n},function(a){return{x:function(){return a.reshape(n.shape)}}},"Reshape",r)}}),eN=F({spaceToBatchND_:function(e,t,n){var r=R(e,"x","spaceToBatchND");return D(r.rank>=1+t.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length}),D(n.length===t.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length}),D(r.shape.reduce(function(a,o,i){return i>0&&i<=t.length?a&&(o+n[i-1][0]+n[i-1][1])%t[i-1]==0:a},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()}),O.runKernelFunc(function(a){return a.spaceToBatchND(r,t,n)},{$x:r},function(a){return{$x:function(){return a.batchToSpaceND(t,n)}}})}}),tN=F({squeeze_:function(e,t){var n=R(e,"x","squeeze");return nr(n,so(n.shape,t).newShape)}}),Pn=F({stack_:function(e,t){t===void 0&&(t=0);var n=ic(e,"tensors","stack");if(D(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),n.length===1)return n[0].expandDims(t);var r=n[0].rank,a=n[0].shape,o=n[0].dtype;D(t<=r,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(s){Ge(a,s.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(s){D(o===s.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var i=n.map(function(s){return s.expandDims(t)});return _t(i,t)}}),vi=F({tile_:function(e,t){var n=R(e,"x","tile",null);D(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."});var r=[n],a={reps:t};return O.runKernelFunc(function(o,i){var s=o.tile(n,t);return i([n]),s},{x:n},function(o,i){var s=i[0];return{x:function(){var l=Ue(s);if(s.rank===1)for(var c=0;c<t[0];++c)l=l.add(o.slice([c*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(c=0;c<t[0];++c)for(var d=0;d<t[1];++d)l=l.add(o.slice([c*s.shape[0],d*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(c=0;c<t[0];++c)for(d=0;d<t[1];++d)for(var h=0;h<t[2];++h)l=l.add(o.slice([c*s.shape[0],d*s.shape[1],h*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else{if(s.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+s.rank+" tensors yet.");for(c=0;c<t[0];++c)for(d=0;d<t[1];++d)for(h=0;h<t[2];++h)for(var f=0;f<t[3];++f)l=l.add(o.slice([c*s.shape[0],d*s.shape[1],h*s.shape[2],f*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]))}return l}}},"Tile",a,r)}}),y5=F({truncatedNormal_:function(e,t,n,r,a){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var o=new fm(t,n,r,!0,a),i=De(e,r),s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}}),Rt=F({unstack_:function(e,t){t===void 0&&(t=0),t=t||0;var n=R(e,"x","unstack");D(t>=-n.shape.length&&t<n.shape.length,function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),t<0&&(t+=n.shape.length);var r={axis:t};return O.runKernelFunc(function(a){return a.unstack(n,t)},{x:n},function(a){return{x:function(){return Pn(a,t)}}},"Unpack",r)}}),b5=function(e,t){return fe(this,void 0,void 0,function(){var n,r,a,o,i,s,l,c,d,h;return pe(this,function(f){switch(f.label){case 0:return n=R(e,"x","setdiff1d"),r=R(t,"y","setdiff1d"),D(n.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."}),D(n.rank===1,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),D(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,n.data()];case 1:return a=f.sent(),[4,r.data()];case 2:for(o=f.sent(),i=new Set(o),s=0,d=0;d<a.length;d++)i.has(a[d])||s++;for(l=new Ys([s],n.dtype),c=new Ys([s],"int32"),d=0,h=0;d<a.length;d++)i.has(a[d])||(l.values[h]=a[d],c.values[h]=d,h++);return[2,[l.toTensor(),c.toTensor()]]}})})};function lc(e,t,n,r){r===void 0&&(r=!0);var a=[];if(r)(a=a.concat(t.slice(0))).push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);for(var o=t.length,i=0;i<o;++i)a=a.concat([e[i+1]/t[i],t[i]]);a=a.concat(e.slice(o+1))}return a}function uc(e,t,n){n===void 0&&(n=!0);var r=[];if(n){r.push(t);for(var a=t+1;a<e;++a)a<=2*t?(r.push(a),r.push(a-(t+1))):r.push(a)}else{var o=[],i=[];for(a=1;a<e;++a)a>=2*t+1||a%2==1?i.push(a):o.push(a);r.push.apply(r,o),r.push(0),r.push.apply(r,i)}return r}function cc(e,t,n,r){r===void 0&&(r=!0);var a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(var o=1;o<e.length;++o)o<=t.length?r?a.push(t[o-1]*e[o]):a.push(e[o]/t[o-1]):a.push(e[o]);return a}function nN(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function rN(e,t,n){for(var r=e.slice(0,1),a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}function aN(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(e.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],a=1,o=0;o<n.length-1;++o)a*=n[o];var i=e.shape,s=n.slice();s.pop();var l=1;for(o=r;o<e.rank;++o)l*=i[o],s.push(i[o]);var c=_r(e.shape).map(function(d){return d/l}).concat([1]).slice(0,r);return[s,a,l,c]}var oN=30;function nh(e){return e<=oN?e:If(e,Math.floor(Math.sqrt(e)))}function w5(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,o="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+a+".";if(n.rank<a)throw new Error(o+" update.rank < "+a+". ");if(e.length<r+(n.rank-a))throw new Error(o+" Output shape length < "+(r+(n.rank-a)));if(n.rank!==a+e.length-r)throw new Error(o+" update.rank != "+(a+e.length-r));for(var i=0;i<a;++i)if(n.shape[i]!==t.shape[i])throw new Error(o+" updates.shape["+i+"] ("+n.shape[i]+") != indices.shape["+i+"] ("+t.shape[i]+").");for(i=0;i<n.rank-a;++i)if(n.shape[i+a]!==e[i+r])throw new Error(o+" updates.shape["+(i+a)+"] ("+n.shape[i+a]+") != shape["+(i+a)+"] ("+e[i+a]+")")}function N5(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(n.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(e.size===0)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}w5(n,t,e)}function dc(e,t,n){for(var r=t.shape.length,a=r>1?t.shape[r-1]:1,o=n.length,i=1,s=a;s<o;++s)i*=n[s];var l=a<1?1:a;return{sliceRank:a,numUpdates:me(t.shape)/l,sliceSize:i,strides:_r(n.slice(0,a)).concat([1]),outputSize:me(n)}}function C5(e,t,n){D(e.rank===t.length,function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."}),D(e.rank===n.length,function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."});for(var r=function(o){D(t[o]+n[o]<=e.shape[o],function(){return"Error in slice"+e.rank+"D: begin["+o+"] + size["+o+"] ("+(t[o]+n[o])+") would overflow input.shape["+o+"] ("+e.shape[o]+")"})},a=0;a<e.rank;++a)r(a)}function yy(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function pm(e,t,n){for(var r=[],a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function k5(e,t,n,r,a){var o=t[a],i=n[a]||1;(e&1<<a||o==null)&&(o=i>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[a];return o<0&&(o+=s),o=Ef(0,o,s-1)}function j5(e,t,n,r,a){var o=t[a],i=n[a]||1;(e&1<<a||o==null)&&(o=i>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[a];return o<0&&(o+=s),o=i>0?Ef(0,o,s):Ef(-1,o,s-1)}function iN(e,t,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(a=r+1;a<n.length;a++)if(t[a]>0||n[a]!==e[a])return!1;return!0}function sN(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function S5(e,t){D(Rf(e),function(){return"The f passed in variableGrads(f) must be a function"}),D(t==null||Array.isArray(t)&&t.every(function(d){return d instanceof Bi}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=t!=null;if(!n)for(var r in t=[],O.registeredVariables)t.push(O.registeredVariables[r]);var a=n?t.filter(function(d){return!d.trainable}):null,o=t.length;D((t=t.filter(function(d){return d.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+o+" variables is trainable."});var i=O.gradients(e,t,null,!0),s=i.value,l=i.grads;D(l.some(function(d){return d!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),D(s.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var c={};return t.forEach(function(d,h){l[h]!=null&&(c[d.name]=l[h])}),a!=null&&a.forEach(function(d){return c[d.name]=null}),{value:s,grads:c}}function Jc(e){return O.customGrad(e)}var ia=F({softmax_:function(e,t){t===void 0&&(t=-1);var n=R(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return O.runKernelFunc(function(r,a){var o=r.softmax(n,t);return a([o]),o},{logits:n},function(r,a){var o=a[0],i=r.mul(o);return{logits:function(){return i.sub(i.sum([t],!0).mul(o))}}},"Softmax",{dim:t},[],[!0])}}),E5=F({logSoftmax_:function(e,t){t===void 0&&(t=-1);var n=R(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return Jc(function(r,a){var o=r.max(t,!0),i=r.sub(o),s=i.toFloat().sub(i.exp().sum(t,!0).log());return a([s]),{value:s,gradFunc:function(l,c){var d=c[0].exp();return l.sub(l.sum(t,!0).mul(d))}}})(n)}}),lN=function(){function e(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},e.prototype.set=function(t,n){this.dataIdsCount++,this.data.set(t,n)},e.prototype.has=function(t){return this.data.has(t)},e.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),uN=function(){function e(){}return e.prototype.time=function(t){return W("time")},e.prototype.read=function(t){return W("read")},e.prototype.readSync=function(t){return W("readSync")},e.prototype.numDataIds=function(){return W("numDataIds")},e.prototype.disposeData=function(t){return W("disposeData")},e.prototype.write=function(t,n,r){return W("write")},e.prototype.move=function(t,n,r,a){return W("move")},e.prototype.memory=function(){return W("memory")},e.prototype.floatPrecision=function(){return W("floatPrecision")},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.batchMatMul=function(t,n,r,a){return W("batchMatMul")},e.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,W("fusedBatchMatMul")},e.prototype.slice=function(t,n,r){return W("slice")},e.prototype.stridedSlice=function(t,n,r,a){return W("stridedSlice")},e.prototype.unstack=function(t,n){return W("unstack")},e.prototype.reverse=function(t,n){return W("reverse")},e.prototype.concat=function(t,n){return W("concat")},e.prototype.neg=function(t){return W("neg")},e.prototype.add=function(t,n){return W("add")},e.prototype.addN=function(t){return W("addN")},e.prototype.subtract=function(t,n){return W("subtract")},e.prototype.multiply=function(t,n){return W("multiply")},e.prototype.realDivide=function(t,n){return W("realDivide")},e.prototype.floorDiv=function(t,n){return W("floorDiv")},e.prototype.sum=function(t,n){return W("sum")},e.prototype.prod=function(t,n){return W("prod")},e.prototype.unsortedSegmentSum=function(t,n,r){return W("unsortedSegmentSum")},e.prototype.argMin=function(t,n){return W("argMin")},e.prototype.argMax=function(t,n){return W("argMax")},e.prototype.equal=function(t,n){return W("equal")},e.prototype.notEqual=function(t,n){return W("notEqual")},e.prototype.less=function(t,n){return W("less")},e.prototype.lessEqual=function(t,n){return W("lessEqual")},e.prototype.greater=function(t,n){return W("greater")},e.prototype.greaterEqual=function(t,n){return W("greaterEqual")},e.prototype.logicalNot=function(t){return W("logicalNot")},e.prototype.logicalAnd=function(t,n){return W("logicalAnd")},e.prototype.logicalOr=function(t,n){return W("logicalOr")},e.prototype.where=function(t){return W("where")},e.prototype.select=function(t,n,r){return W("select")},e.prototype.topk=function(t,n,r){return W("topk")},e.prototype.min=function(t,n){return W("min")},e.prototype.minimum=function(t,n){return W("minimum")},e.prototype.mod=function(t,n){return W("mod")},e.prototype.max=function(t,n){return W("max")},e.prototype.maximum=function(t,n){return W("maximum")},e.prototype.all=function(t,n){return W("all")},e.prototype.any=function(t,n){return W("any")},e.prototype.squaredDifference=function(t,n){return W("squaredDifference")},e.prototype.ceil=function(t){return W("ceil")},e.prototype.floor=function(t){return W("floor")},e.prototype.round=function(t){return W("round")},e.prototype.sign=function(t){return W("sign")},e.prototype.isNaN=function(t){return W("isNaN")},e.prototype.isInf=function(t){return W("isInf")},e.prototype.isFinite=function(t){return W("isFinite")},e.prototype.pow=function(t,n){return W("pow")},e.prototype.exp=function(t){return W("exp")},e.prototype.expm1=function(t){return W("expm1")},e.prototype.softmax=function(t,n){return W("softmax")},e.prototype.log=function(t){return W("log")},e.prototype.log1p=function(t){return W("log1p")},e.prototype.sqrt=function(t){return W("sqrt")},e.prototype.rsqrt=function(t){return W("rsqrt")},e.prototype.square=function(t){return W("square")},e.prototype.reciprocal=function(t){return W("reciprocal")},e.prototype.relu=function(t){return W("relu")},e.prototype.relu6=function(t){return W("relu6")},e.prototype.prelu=function(t,n){return W("prelu")},e.prototype.elu=function(t){return W("elu")},e.prototype.eluDer=function(t,n){return W("eluDer")},e.prototype.selu=function(t){return W("selu")},e.prototype.int=function(t){return W("int")},e.prototype.clip=function(t,n,r){return W("clip")},e.prototype.abs=function(t){return W("abs")},e.prototype.complexAbs=function(t){return W("complexAbs")},e.prototype.sigmoid=function(t){return W("sigmoid")},e.prototype.softplus=function(t){return W("softplus")},e.prototype.sin=function(t){return W("sin")},e.prototype.cos=function(t){return W("cos")},e.prototype.tan=function(t){return W("tan")},e.prototype.asin=function(t){return W("asin")},e.prototype.acos=function(t){return W("acos")},e.prototype.atan=function(t){return W("atan")},e.prototype.atan2=function(t,n){return W("atan2")},e.prototype.sinh=function(t){return W("sinh")},e.prototype.cosh=function(t){return W("cosh")},e.prototype.tanh=function(t){return W("tanh")},e.prototype.asinh=function(t){return W("asinh")},e.prototype.acosh=function(t){return W("acosh")},e.prototype.atanh=function(t){return W("atanh")},e.prototype.erf=function(t){return W("erf")},e.prototype.step=function(t,n){return W("step")},e.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,W("fusedConv2d")},e.prototype.conv2d=function(t,n,r){return W("conv2d")},e.prototype.conv2dDerInput=function(t,n,r){return W("conv2dDerInput")},e.prototype.conv2dDerFilter=function(t,n,r){return W("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,W("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(t,n,r){return W("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(t,n,r){return W("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(t,n,r){return W("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(t,n,r){return W("conv3d")},e.prototype.conv3dDerInput=function(t,n,r){return W("conv3dDerInput")},e.prototype.conv3dDerFilter=function(t,n,r){return W("conv3dDerFilter")},e.prototype.maxPool=function(t,n){return W("maxPool")},e.prototype.maxPoolBackprop=function(t,n,r,a){return W("maxPoolBackprop")},e.prototype.avgPool=function(t,n){return W("avgPool")},e.prototype.avgPoolBackprop=function(t,n,r){return W("avgPoolBackprop")},e.prototype.avgPool3d=function(t,n){return W("avgPool3d")},e.prototype.avgPool3dBackprop=function(t,n,r){return W("avgPool3dBackprop")},e.prototype.maxPool3d=function(t,n){return W("maxPool3d")},e.prototype.maxPool3dBackprop=function(t,n,r,a){return W("maxPool3dBackprop")},e.prototype.reshape=function(t,n){return W("reshape")},e.prototype.cast=function(t,n){return W("cast")},e.prototype.tile=function(t,n){return W("tile")},e.prototype.pad=function(t,n,r){return W("pad")},e.prototype.transpose=function(t,n){return W("transpose")},e.prototype.gather=function(t,n,r){return W("gather")},e.prototype.gatherND=function(t,n){return W("gatherND")},e.prototype.scatterND=function(t,n,r){return W("scatterND")},e.prototype.batchToSpaceND=function(t,n,r){return W("batchToSpaceND")},e.prototype.spaceToBatchND=function(t,n,r){return W("spaceToBatchND")},e.prototype.resizeBilinear=function(t,n,r,a){return W("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(t,n,r){return W("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(t,n,r,a){return W("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(t,n,r){return W("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(t,n,r,a,o,i){return W("batchNormalization")},e.prototype.localResponseNormalization4D=function(t,n,r,a,o){return W("localResponseNormalization4D")},e.prototype.LRNGrad=function(t,n,r,a,o,i,s){return W("LRNGrad")},e.prototype.multinomial=function(t,n,r,a){return W("multinomial")},e.prototype.oneHot=function(t,n,r,a){return W("oneHot")},e.prototype.cumsum=function(t,n,r,a){return W("cumsum")},e.prototype.nonMaxSuppression=function(t,n,r,a,o){return W("nonMaxSuppression")},e.prototype.fft=function(t){return W("fft")},e.prototype.ifft=function(t){return W("ifft")},e.prototype.complex=function(t,n){return W("complex")},e.prototype.real=function(t){return W("real")},e.prototype.imag=function(t){return W("imag")},e.prototype.cropAndResize=function(t,n,r,a,o,i){return W("cropAndResize")},e.prototype.depthToSpace=function(t,n,r){return W("depthToSpace")},e.prototype.split=function(t,n,r){return W("split")},e.prototype.sparseToDense=function(t,n,r,a){return W("sparseToDense")},e.prototype.diag=function(t){return W("diag")},e.prototype.fill=function(t,n,r){return W("fill")},e.prototype.onesLike=function(t){return W("onesLike")},e.prototype.zerosLike=function(t){return W("zerosLike")},e.prototype.linspace=function(t,n,r){return W("linspace")},e.prototype.dispose=function(){return W("dispose")},e}();function W(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function ja(e,t){for(var n=e.length,r=[],a=0;a<n;a++){var o=n-1-a,i=e[o]||1;(t[t.length-1-a]||1)>1&&i===1&&r.unshift(o)}return r}function It(e,t){for(var n=[],r=0;r<t.length;r++){var a=e[e.length-r-1],o=t.length-r-1,i=t[o];(a==null||a===1&&i>1)&&n.unshift(o)}return n}function ze(e,t){for(var n=[],r=Math.max(e.length,t.length),a=0;a<r;a++){var o=e[e.length-a-1];o==null&&(o=1);var i=t[t.length-a-1];if(i==null&&(i=1),o===1)n.unshift(i);else if(i===1)n.unshift(o);else{if(o!==i)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(o)}}return n}function Js(e,t,n,r,a,o,i){i===void 0&&(i="channelsLast");var s,l=pc(t),c=l[0],d=l[1];if(i==="channelsLast")s=[c,d,e[3],e[3]];else{if(i!=="channelsFirst")throw new Error("Unknown dataFormat "+i);s=[c,d,e[1],e[1]]}return Fo(e,s,n,r,a,o,!1,i)}function hc(e,t,n,r,a,o,i){i===void 0&&(i="NDHWC");var s,l,c=Of(t),d=c[0],h=c[1],f=c[2];if(i==="NDHWC")l="channelsLast",s=[d,h,f,e[4],e[4]];else{if(i!=="NCDHW")throw new Error("Unknown dataFormat "+i);l="channelsFirst",s=[d,h,f,e[1],e[1]]}return fc(e,s,n,r,a,!1,l,o)}function Fo(e,t,n,r,a,o,i,s){i===void 0&&(i=!1),s===void 0&&(s="channelsLast");var l=[-1,-1,-1,-1],c=l[0],d=l[1],h=l[2],f=l[3];if(s==="channelsLast")c=e[0],d=e[1],h=e[2],f=e[3];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);c=e[0],f=e[1],d=e[2],h=e[3]}var p,v=t[0],g=t[1],y=t[3],m=pc(n),x=m[0],b=m[1],w=pc(r),N=w[0],C=w[1],S=gi(v,N),k=gi(g,C),_=function(P,B,K,z,M,U,H,Z){var ne,ue,he;if(typeof P=="number"){ne={top:P,bottom:P,left:P,right:P,type:P===0?"VALID":"NUMBER"};var ye=function(Te,Ae,Q,Ce,_e){Ce==null&&(Ce=cN(Te,Ae,Q));var Le=Te[0],Ye=Te[1],pt=Es((Le-Ae+2*Ce)/Q+1,_e);D(xt(pt),function(){return"The output # of rows ("+pt+") must be an integer. Change the stride and/or zero pad parameters"});var mt=Es((Ye-Ae+2*Ce)/Q+1,_e);return D(xt(mt),function(){return"The output # of columns ("+mt+") must be an integer. Change the stride and/or zero pad parameters"}),[pt,mt]}([B,K],U,z,P,Z);ue=ye[0],he=ye[1]}else if(P==="same"){ue=Math.ceil(B/z),he=Math.ceil(K/M);var we=Math.max(0,(ue-1)*z+U-B),ke=Math.max(0,(he-1)*M+H-K),Ie=Math.floor(we/2),Ee=we-Ie,Ke=Math.floor(ke/2);ne={top:Ie,bottom:Ee,left:Ke,right:ke-Ke,type:"SAME"}}else{if(P!=="valid")throw Error("Unknown padding parameter: "+P);ne={top:0,bottom:0,left:0,right:0,type:"VALID"},ue=Math.ceil((B-U+1)/z),he=Math.ceil((K-H+1)/M)}return{padInfo:ne,outHeight:ue,outWidth:he}}(a,d,h,x,b,S,k,o),E=_.padInfo,j=_.outHeight,T=_.outWidth,L=i?y*f:y;return s==="channelsFirst"?p=[c,L,j,T]:s==="channelsLast"&&(p=[c,j,T,L]),{batchSize:c,dataFormat:s,inHeight:d,inWidth:h,inChannels:f,outHeight:j,outWidth:T,outChannels:L,padInfo:E,strideHeight:x,strideWidth:b,filterHeight:v,filterWidth:g,effectiveFilterHeight:S,effectiveFilterWidth:k,dilationHeight:N,dilationWidth:C,inShape:e,outShape:p,filterShape:t}}function fc(e,t,n,r,a,o,i,s){o===void 0&&(o=!1),i===void 0&&(i="channelsLast");var l=[-1,-1,-1,-1,-1],c=l[0],d=l[1],h=l[2],f=l[3],p=l[4];if(i==="channelsLast")c=e[0],d=e[1],h=e[2],f=e[3],p=e[4];else{if(i!=="channelsFirst")throw new Error("Unknown dataFormat "+i);c=e[0],p=e[1],d=e[2],h=e[3],f=e[4]}var v,g=t[0],y=t[1],m=t[2],x=t[4],b=Of(n),w=b[0],N=b[1],C=b[2],S=Of(r),k=S[0],_=S[1],E=S[2],j=gi(g,k),T=gi(y,_),L=gi(m,E),P=function(H,Z,ne,ue,he,ye,we,ke,Ie,Ee,Ke){var Te,Ae,Q,Ce;if(typeof H=="number"){Te={top:H,bottom:H,left:H,right:H,front:H,back:H,type:H===0?"VALID":"NUMBER"};var _e=function(Ne,Oe,yt,Tt,Nt,Ln){Nt==null&&(Nt=cN(Ne,Oe,Tt));var on=Ne[0],da=Ne[1],Qi=Ne[2],ha=Es((on-Oe+2*Nt)/Tt+1,Ln);D(xt(ha),function(){return"The output # of depths ("+ha+") must be an integer. Change the stride and/or zero pad parameters"});var Ji=Es((da-Oe+2*Nt)/Tt+1,Ln);D(xt(Ji),function(){return"The output # of rows ("+Ji+") must be an integer. Change the stride and/or zero pad parameters"});var Lo=Es((Qi-Oe+2*Nt)/Tt+1,Ln);return D(xt(Lo),function(){return"The output # of columns ("+Lo+") must be an integer. Change the stride and/or zero pad parameters"}),[ha,Ji,Lo,yt]}([Z,ne,ue,1],ke,1,he,H,Ke);Ae=_e[0],Q=_e[1],Ce=_e[2]}else if(H==="same"){Ae=Math.ceil(Z/he),Q=Math.ceil(ne/ye),Ce=Math.ceil(ue/we);var Le=(Ae-1)*he+ke-Z,Ye=(Q-1)*ye+Ie-ne,pt=(Ce-1)*we+Ee-ue,mt=Math.floor(Le/2),zt=Le-mt,$t=Math.floor(Ye/2),te=Ye-$t,oe=Math.floor(pt/2);Te={top:$t,bottom:te,left:oe,right:pt-oe,front:mt,back:zt,type:"SAME"}}else{if(H!=="valid")throw Error("Unknown padding parameter: "+H);Te={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},Ae=Math.ceil((Z-ke+1)/he),Q=Math.ceil((ne-Ie+1)/ye),Ce=Math.ceil((ue-Ee+1)/we)}return{padInfo:Te,outDepth:Ae,outHeight:Q,outWidth:Ce}}(a,d,h,f,w,N,C,j,T,L,s),B=P.padInfo,K=P.outDepth,z=P.outHeight,M=P.outWidth,U=o?x*p:x;return i==="channelsFirst"?v=[c,U,K,z,M]:i==="channelsLast"&&(v=[c,K,z,M,U]),{batchSize:c,dataFormat:i,inDepth:d,inHeight:h,inWidth:f,inChannels:p,outDepth:K,outHeight:z,outWidth:M,outChannels:U,padInfo:B,strideDepth:w,strideHeight:N,strideWidth:C,filterDepth:g,filterHeight:y,filterWidth:m,effectiveFilterDepth:j,effectiveFilterHeight:T,effectiveFilterWidth:L,dilationDepth:k,dilationHeight:_,dilationWidth:E,inShape:e,outShape:v,filterShape:t}}function cN(e,t,n,r){r===void 0&&(r=1);var a=gi(t,r);return Math.floor((e[0]*(n-1)-n+a)/2)}function pc(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function Of(e){return typeof e=="number"?[e,e,e]:e}function gi(e,t){return t<=1?e:e+(e-1)*(t-1)}function Es(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function $i(e){var t=pc(e),n=t[0],r=t[1],a=t[2];return n===1&&r===1&&a===1}function kn(e,t){return $i(e)||$i(t)}function mm(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function dN(e,t,n){if(t==="complex64"){if(e.dtype==="complex64")return e.clone();var r=et(e.shape),a=e.toFloat(),o=n.complex(a,r);return r.dispose(),a.dispose(),o}if(!eI(e.dtype,t))return O.makeTensorFromDataId(e.dataId,e.shape,t);if(e.dtype==="complex64"){var i=n.real(e);return o=i.cast(t),i.dispose(),o}if(t==="int32")return n.int(e);if(t==="bool"){var s=le(0,e.dtype);return o=n.notEqual(e,s),s.dispose(),o}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function Lf(e,t){return O.makeTensorFromDataId(e.dataId,t,e.dtype)}function hN(e,t,n){var r=(t-e)/(n-1),a=pl(n,"float32");a[0]=e;for(var o=1;o<a.length;o++)a[o]=a[o-1]+r;return wt(a,"float32")}function Bf(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function by(e,t){return{real:e[2*t],imag:e[2*t+1]}}function _5(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function R5(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function I5(e,t,n){var r=function(o,i,s){return function(l,c,d){for(var h=0,f=l.length,p=0,v=!1;h<f;){var g=d(c,l[p=h+(f-h>>>1)]);g>0?h=p+1:(f=p,v=!g)}return v?h:-h-1}(o,i,s||A5)}(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function A5(e,t){return e>t?1:e<t?-1:0}function vm(e,t,n,r,a){return fN(e,t,n,r,a,0).selectedIndices}function gm(e,t,n,r,a,o){var i=fN(e,t,n,r,a,o);return i.numValidOutputs.dispose(),{selectedIndices:i.selectedIndices,selectedScores:i.selectedScores}}function fN(e,t,n,r,a,o,i,s){s===void 0&&(s=!1);for(var l=Array.from(t).map(function(w,N){return{score:w,boxIndex:N,suppressBeginIndex:0}}).filter(function(w){return w.score>a}).sort(wy),c=o>0?-.5/o:0,d=[],h=[];d.length<n&&l.length>0;){var f=l.pop(),p=f.score,v=f.boxIndex,g=f.suppressBeginIndex;if(p<a)break;for(var y=!1,m=d.length-1;m>=g;--m){var x=D5(e,v,d[m]);if(x>=r){y=!0;break}if(f.score=f.score*T5(r,c,x),f.score<=a)break}f.suppressBeginIndex=d.length,y||(f.score===p?(d.push(v),h.push(f.score)):f.score>a&&I5(l,f,wy))}var b=d.length;return s&&(d.fill(0,b),h.fill(0,b)),{selectedIndices:wt(d,"int32"),selectedScores:wt(h,"float32"),numValidOutputs:le(b,"int32")}}function D5(e,t,n){var r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),o=Math.min(r[0],r[2]),i=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),d=Math.min(a[1],a[3]),h=Math.max(a[0],a[2]),f=Math.max(a[1],a[3]),p=(s-o)*(l-i),v=(h-c)*(f-d);if(p<=0||v<=0)return 0;var g=Math.max(o,c),y=Math.max(i,d),m=Math.min(s,h),x=Math.min(l,f),b=Math.max(m-g,0)*Math.max(x-y,0);return b/(p+v-b)}function T5(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function wy(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function pN(e,t,n){var r=new Array(e.rank).fill(0),a=e.shape.slice();return t.map(function(o){a[n]=o;var i=e.slice(r,a);return r[n]+=o,i})}function mN(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var a=De(n,e.dtype);for(r=0;r<a.values.length;++r){for(var o=a.indexToLoc(r),i=new Array(e.rank),s=0;s<i.length;s++)i[s]=o[s]%e.shape[s];var l=e.locToIndex(i);a.values[r]=e.values[l]}return a.toTensor()}function vN(e,t,n,r,a){for(var o=t[t.length-1],i=[e.length/o,o],s=i[0],l=i[1],c=Xs(n,s*r),d=Xs("int32",s*r),h=0;h<s;h++){for(var f=h*l,p=e.subarray(f,f+l),v=[],g=0;g<p.length;g++)v.push({value:p[g],index:g});v.sort(function(w,N){return N.value-w.value});var y=h*r,m=c.subarray(y,y+r),x=d.subarray(y,y+r);for(g=0;g<r;g++)m[g]=v[g].value,x[g]=v[g].index}var b=t.slice();return b[b.length-1]=r,[Ht(c,b,n),Ht(d,b,"int32")]}function xm(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var a=De(e,"int32"),o=De([n.length,e.length],"int32");for(r=0;r<n.length;r++){var i=a.indexToLoc(n[r]),s=r*e.length;o.values.set(i,s)}return o.toTensor()}var P5=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(function(a,o){return"T"+o});var n=[];this.variableNames.forEach(function(a){n.push("float v"+a+" = get"+a+"AtOutCoords();")});var r=this.variableNames.map(function(a){return"v"+a}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},F5=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(function(a,o){return"T"+o});var n=[];this.variableNames.forEach(function(a){n.push("vec4 v"+a+" = get"+a+"AtOutCoords();")});var r=this.variableNames.map(function(a){return"v"+a}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},M5=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,a=e.batchSize,o=e.inSize,i=Math.ceil(o/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[a,i];var s=t==="max"?">":"<",l=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+l+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+s+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function gN(e,t){return["x","y","z","w","u","v"].slice(0,t).map(function(n){return e+"."+n})}function pn(e,t){return t===1?[e]:gN(e,t)}function en(){var e,t,n,r,a,o,i,s,l,c;return X().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",a="texture",o="outputColor",i="out vec4 outputColor;",s=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",a="texture2D",o="gl_FragColor",i="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:o,defineOutput:i,defineSpecialNaN:s,defineSpecialInf:l,defineRound:c}}function fo(e,t,n){n===void 0&&(n="index");var r=_r(t);return r.map(function(a,o){return"int "+e[o]+" = "+n+" / "+a+"; "+(o===r.length-1?"int "+e[o+1]+" = "+n+" - "+e[o]+" * "+a:"index -= "+e[o]+" * "+a)+";"}).join("")}function ym(e){var t=_r(e).map(function(n){return n.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var xN=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function O5(e,t,n,r){var a=[];e.forEach(function(p){var v=me(p.shapeInfo.logicalShape);p.shapeInfo.isUniform?a.push("uniform float "+p.name+(v>1?"["+v+"]":"")+";"):(a.push("uniform sampler2D "+p.name+";"),a.push("uniform int offset"+p.name+";"))});var o,i,s=a.join(`
`),l=e.map(function(p){return function(v,g,y){y===void 0&&(y=!1);var m="";m+=y?yN(v):Ho(v);var x=v.shapeInfo.logicalShape,b=g.logicalShape;return x.length<=b.length&&(m+=y?function(w,N){var C,S=w.name,k=S.charAt(0).toUpperCase()+S.slice(1),_="get"+k+"AtOutCoords",E=w.shapeInfo.logicalShape.length,j=N.logicalShape.length,T=ja(w.shapeInfo.logicalShape,N.logicalShape),L=Je(j),P=j-E,B=["x","y","z","w","u","v"];C=E===0?"":j<2&&T.length>=1?"coords = 0;":T.map(function(ne){return"coords."+B[ne+P]+" = 0;"}).join(`
`);var K="";K=j<2&&E>0?"coords":w.shapeInfo.logicalShape.map(function(ne,ue){return"coords."+B[ue+P]}).join(", ");var z="return outputValue;",M=me(w.shapeInfo.logicalShape)===1,U=me(N.logicalShape)===1;if(E!==1||M||U){if(M&&!U)z=j===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(T.length){var H=E-2,Z=E-1;T.indexOf(H)>-1&&T.indexOf(Z)>-1?z="return vec4(outputValue.x);":T.indexOf(H)>-1?z="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":T.indexOf(Z)>-1&&(z="return vec4(outputValue.xx, outputValue.zz);")}}else z=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+_+`() {
      `+L+` coords = getOutputCoords();
      `+C+`
      vec4 outputValue = get`+k+"("+K+`);
      `+z+`
    }
  `}(v,g):function(w,N){var C=w.name,S=C.charAt(0).toUpperCase()+C.slice(1),k="get"+S+"AtOutCoords",_=N.texShape,E=w.shapeInfo.texShape,j=w.shapeInfo.logicalShape.length,T=N.logicalShape.length;if(!w.shapeInfo.isUniform&&j===T&&w.shapeInfo.flatOffset==null&&Lt(E,_))return`
      float `+k+`() {
        return sampleTexture(`+C+`, resultUV);
      }
    `;var L,P=Je(T),B=ja(w.shapeInfo.logicalShape,N.logicalShape),K=T-j,z=["x","y","z","w","u","v"];L=j===0?"":T<2&&B.length>=1?"coords = 0;":B.map(function(U){return"coords."+z[U+K]+" = 0;"}).join(`
`);var M="";return M=T<2&&j>0?"coords":w.shapeInfo.logicalShape.map(function(U,H){return"coords."+z[H+K]}).join(", "),`
    float `+k+`() {
      `+P+` coords = getOutputCoords();
      `+L+`
      return get`+S+"("+M+`);
    }
  `}(v,g)),m}(p,t,r)}).join(`
`),c=t.texShape,d=en(),h=function(p){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+p.texture2D+`(textureSampler, uv).r;
    }
  `}(d),f=function(p){return p.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+p.varyingFs+` vec2 resultUV;
    `+p.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+p.defineSpecialNaN+`
    `+p.defineSpecialInf+`
    `+p.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+L5+`
    `+B5+`
    `+z5+`
  `}(d);return t.isPacked?(o=function(p,v){switch(p.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(w,N){var C=[Math.ceil(N[0]/2),Math.ceil(N[1]/2)];return C[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+C[1]+`.0);
      }
    `:C[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+C[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+C[0]+", "+C[1]+`));
      return 2 * (resTexRC.x * `+C[1]+` + resTexRC.y);
    }
  `}(0,v);case 2:return function(w,N){var C=[Math.ceil(N[0]/2),Math.ceil(N[1]/2)];if(Lt(w,N))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+C[0]+", "+C[1]+`));
      }
    `;var S=Math.ceil(w[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+C[0]+", "+C[1]+`));

      int index = resTexRC.x * `+C[1]+` + resTexRC.y;
      int r = 2 * (index / `+S+`);
      int c = imod(index, `+S+`) * 2;

      return ivec2(r, c);
    }
  `}(p,v);case 3:return g=p,y=v,m=[Math.ceil(y[0]/2),Math.ceil(y[1]/2)],x=Math.ceil(g[2]/2),b=x*Math.ceil(g[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+m[0]+", "+m[1]+`));
      int index = resTexRC.x * `+m[1]+` + resTexRC.y;

      int b = index / `+b+`;
      index -= b * `+b+`;

      int r = 2 * (index / `+x+`);
      int c = imod(index, `+x+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(w,N){for(var C=[Math.ceil(N[0]/2),Math.ceil(N[1]/2)],S=Math.ceil(w[w.length-1]/2),k=S*Math.ceil(w[w.length-2]/2),_=k,E="",j="b, r, c",T=2;T<w.length-1;T++)_*=w[w.length-T-1],E=`
      int b`+T+" = index / "+_+`;
      index -= b`+T+" * "+_+`;
    `+E,j="b"+T+", "+j;return`
    ivec`+w.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+C[0]+", "+C[1]+`));
      int index = resTexRC.x * `+C[1]+` + resTexRC.y;

      `+E+`

      int b = index / `+k+`;
      index -= b * `+k+`;

      int r = 2 * (index / `+S+`);
      int c = imod(index, `+S+`) * 2;

      return ivec`+w.length+"("+j+`);
    }
  `}(p,v)}var g,y,m,x,b}(t.logicalShape,c),i=function(p){return`
    void setOutput(vec4 val) {
      `+p.output+` = val;
    }
  `}(d)):(o=function(p,v){switch(p.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(m,x){return x[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+x[1]+`.0);
      }
    `:x[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+x[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+x[0]+", "+x[1]+`));
      return resTexRC.x * `+x[1]+` + resTexRC.y;
    }
  `}(0,v);case 2:return function(m,x){return Lt(m,x)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+x[0]+", "+x[1]+`));
      }
    `:m[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+x[0]+", "+x[1]+`));
        int index = resTexRC.x * `+x[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:m[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+x[0]+", "+x[1]+`));
        int index = resTexRC.x * `+x[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+x[0]+", "+x[1]+`));
      int index = resTexRC.x * `+x[1]+` + resTexRC.y;
      int r = index / `+m[1]+`;
      int c = index - r * `+m[1]+`;
      return ivec2(r, c);
    }
  `}(p,v);case 3:return g=v,y=fo(["r","c","d"],p),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+g[0]+", "+g[1]+`));
      int index = resTexRC.x * `+g[1]+` + resTexRC.y;
      `+y+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(m,x){var b=fo(["r","c","d","d2"],m);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+x[0]+", "+x[1]+`));
      int index = resTexRC.x * `+x[1]+` + resTexRC.y;
      `+b+`
      return ivec4(r, c, d, d2);
    }
  `}(p,v);case 5:return function(m,x){var b=fo(["r","c","d","d2","d3"],m);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+x[0]+`,
                             `+x[1]+`));

      int index = resTexRC.x * `+x[1]+` + resTexRC.y;

      `+b+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(p,v);case 6:return function(m,x){var b=fo(["r","c","d","d2","d3","d4"],m);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+x[0]+", "+x[1]+`));
      int index = resTexRC.x * `+x[1]+` + resTexRC.y;

      `+b+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(p,v);default:throw new Error(p.length+"-D output sampling is not yet supported")}var g,y}(t.logicalShape,c),i=function(p){return`
    void setOutput(float val) {
      `+p.output+` = vec4(val, 0, 0, 0);
    }
  `}(d)),r&&(f+=$5),[f,h,i,s,o,l,n].join(`
`)}function Ho(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(n){var r=n.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return"float "+a+"() {return "+r+";}";var o=n.shapeInfo.texShape,i=o[0],s=o[1];if(i===1&&s===1)return`
      float `+a+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var l=n.shapeInfo.texShape,c=l[0],d=l[1],h=no(r);return`
    float `+a+`() {
      vec2 uv = uvFromFlat(`+c+", "+d+", "+h+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 1:return function(n){var r=n.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return`
      float `+a+`(int index) {
        `+$o(n)+`
      }
    `;var o=n.shapeInfo.texShape,i=o[0],s=o[1];if(s===1&&i===1)return`
      float `+a+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var l=no(r);return s===1?`
      float `+a+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+l+") + 0.5) / "+i+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:i===1?`
      float `+a+`(int index) {
        vec2 uv = vec2((float(index + `+l+") + 0.5) / "+s+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+a+`(int index) {
      vec2 uv = uvFromFlat(`+i+", "+s+", index + "+l+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 2:return function(n){var r=n.shapeInfo.logicalShape,a=n.name,o="get"+a.charAt(0).toUpperCase()+a.slice(1),i=n.shapeInfo.texShape;if(i!=null&&Lt(r,i)){var s=i[0],l=i[1];return`
    float `+o+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+l+".0, "+s+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `}var c=so(r),d=c.newShape,h=c.keptDims,f=d;if(f.length<r.length){var p=Go(n,f);return`
      `+Ho(p)+`
      float `+o+`(int row, int col) {
        return `+o+"("+qo(["row","col"],h)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+o+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+$o(n)+`
      }
    `;var v=i[0],g=i[1],y=no(a);return g===1?`
    float `+o+`(int row, int col) {
      float index = dot(vec3(row, col, `+y+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+v+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `:v===1?`
    float `+o+`(int row, int col) {
      float index = dot(vec3(row, col, `+y+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+g+`.0, 0.5);
      return sampleTexture(`+a+`, uv);
    }
  `:`
  float `+o+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+y+`;
    vec2 uv = uvFromFlat(`+v+", "+g+`, index);
    return sampleTexture(`+a+`, uv);
  }
`}(e);case 3:return function(n){var r=n.shapeInfo.logicalShape,a=n.name,o="get"+a.charAt(0).toUpperCase()+a.slice(1),i=r[1]*r[2],s=r[2],l=so(r),c=l.newShape,d=l.keptDims,h=c;if(h.length<r.length){var f=Go(n,h);return`
        `+Ho(f)+`
        float `+o+`(int row, int col, int depth) {
          return `+o+"("+qo(["row","col","depth"],d)+`);
        }
      `}if(n.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+i+", "+s+`, 1)));
        `+$o(n)+`
      }
    `;var p=n.shapeInfo.texShape,v=p[0],g=p[1],y=n.shapeInfo.flatOffset;if(g===i&&y==null)return`
        float `+o+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+s+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+g+".0, "+v+`.0);
          return sampleTexture(`+a+`, uv);
        }
      `;if(g===s&&y==null)return`
    float `+o+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+g+".0, "+v+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `;var m=no(a);return`
      float `+o+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+i+" + col * "+s+" + depth + "+m+`;
        vec2 uv = uvFromFlat(`+v+", "+g+`, index);
        return sampleTexture(`+a+`, uv);
      }
  `}(e);case 4:return function(n){var r=n.shapeInfo.logicalShape,a=n.name,o="get"+a.charAt(0).toUpperCase()+a.slice(1),i=r[3],s=r[2]*i,l=r[1]*s,c=so(r),d=c.newShape,h=c.keptDims;if(d.length<r.length){var f=Go(n,d);return`
      `+Ho(f)+`
      float `+o+`(int row, int col, int depth, int depth2) {
        return `+o+"("+qo(["row","col","depth","depth2"],h)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+l+", "+s+", "+i+`, 1)));
        `+$o(n)+`
      }
    `;var p=n.shapeInfo.flatOffset,v=n.shapeInfo.texShape,g=v[0],y=v[1];if(y===l&&p==null)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+s+", "+i+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+y+".0, "+g+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(y===i&&p==null)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+y+".0, "+g+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var m=no(a);return`
    float `+o+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+l+" + col * "+s+` +
          depth * `+i+` + depth2;
      vec2 uv = uvFromFlat(`+g+", "+y+", index + "+m+`);
      return sampleTexture(`+a+`, uv);
    }
  `}(e);case 5:return function(n){var r=n.shapeInfo.logicalShape,a=n.name,o="get"+a.charAt(0).toUpperCase()+a.slice(1),i=r[4],s=r[3]*i,l=r[2]*s,c=r[1]*l,d=so(r),h=d.newShape,f=d.keptDims;if(h.length<r.length){var p=Go(n,h);return`
      `+Ho(p)+`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        return `+o+"("+qo(["row","col","depth","depth2","depth3"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+c+", "+l+", "+s+", "+i+`)) +
          depth3;
        `+$o(n)+`
      }
    `;var v=n.shapeInfo.flatOffset,g=n.shapeInfo.texShape,y=g[0],m=g[1];if(m===c&&v==null)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+l+", "+s+", "+i+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+m+".0, "+y+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(m===i&&v==null)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+m+".0, "+y+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var x=no(a);return`
    float `+o+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+c+" + col * "+l+" + depth * "+s+` +
          depth2 * `+i+" + depth3 + "+x+`;
      vec2 uv = uvFromFlat(`+y+", "+m+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `}(e);case 6:return function(n){var r=n.shapeInfo.logicalShape,a=n.name,o="get"+a.charAt(0).toUpperCase()+a.slice(1),i=so(r),s=i.newShape,l=i.keptDims;if(s.length<r.length){var c=Go(n,s);return`
      `+Ho(c)+`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+o+"("+qo(["row","col","depth","depth2","depth3","depth4"],l)+`);
      }
    `}var d=r[5],h=r[4]*d,f=r[3]*h,p=r[2]*f,v=r[1]*p;if(n.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+v+", "+p+", "+f+", "+h+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+d+`, 1)));
        `+$o(n)+`
      }
    `;var g=n.shapeInfo.flatOffset,y=n.shapeInfo.texShape,m=y[0],x=y[1];if(x===v&&g==null)return`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+p+", "+f+", "+h+", "+d+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+x+".0, "+m+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(x===d&&g==null)return`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+x+".0, "+m+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var b=no(a);return`
    float `+o+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+v+" + col * "+p+" + depth * "+f+` +
          depth2 * `+h+" + depth3 * "+d+" + depth4 + "+b+`;
      vec2 uv = uvFromFlat(`+m+", "+x+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function yN(e){var t,n,r;switch(e.shapeInfo.logicalShape.length){case 0:return t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=en(),`
    vec4 `+n+`() {
      return `+r.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(a){var o=a.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),s=a.shapeInfo.texShape,l=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],c=en();return`
    vec4 `+i+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+l[0]+", "+l[1]+`, index);
      return `+c.texture2D+"("+o+`, uv);
    }
  `}(e);case 2:return function(a){var o=a.shapeInfo.logicalShape,i=a.name,s="get"+i.charAt(0).toUpperCase()+i.slice(1),l=a.shapeInfo.texShape,c=l[0],d=l[1],h=en();if(l!=null&&Lt(o,l))return`
      vec4 `+s+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+d+".0, "+c+`.0);

        return `+h.texture2D+"("+i+`, uv);
      }
    `;var f=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],p=Math.ceil(o[1]/2);return`
    vec4 `+s+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+p+", "+f[0]+", "+f[1]+`, row, col);
      return `+h.texture2D+"("+i+`, uv);
    }
  `}(e);case 3:return function(a){var o=a.shapeInfo.logicalShape,i=a.name,s="get"+i.charAt(0).toUpperCase()+i.slice(1),l=a.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];if(o[0]===1){var d=o.slice(1),h=Go(a,d);return`
        `+yN(h)+`
        vec4 `+s+`(int b, int row, int col) {
          return `+s+"("+qo(["b","row","col"],[1,2])+`);
        }
      `}var f=c[0],p=c[1],v=Math.ceil(o[2]/2),g=v*Math.ceil(o[1]/2),y=en();return`
    vec4 `+s+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+f+", "+p+", "+g+", "+v+`, b, row, col);
      return `+y.texture2D+"("+i+`, uv);
    }
  `}(e);default:return function(a){for(var o=a.shapeInfo.logicalShape,i=o.length,s=a.name,l="get"+s.charAt(0).toUpperCase()+s.slice(1),c=a.shapeInfo.texShape,d=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)],h=d[0],f=d[1],p=Math.ceil(o[i-1]/2),v=p*Math.ceil(o[i-2]/2),g="int b, int row, int col",y="b * "+v+" + (row / 2) * "+p+" + (col / 2)",m=2;m<i-1;m++)g="int b"+m+", "+g,v*=o[i-m-1],y="b"+m+" * "+v+" + "+y;var x=en();return`
    vec4 `+l+"("+g+`) {
      int index = `+y+`;
      int texR = index / `+f+`;
      int texC = index - texR * `+f+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+f+", "+h+`);
      return `+x.texture2D+"("+s+`, uv);
    }
  `}(e)}}var L5=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,B5=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,z5=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,$5=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function no(e){return"offset"+e}function $o(e){var t=e.name,n=me(e.shapeInfo.logicalShape);return n<2?"return "+t+";":`
    for (int i = 0; i < `+n+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function Je(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function Go(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function qo(e,t){return t.map(function(n){return e[n]}).join(", ")}var U5=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,D(e.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var a=e[e.length-1],o=Math.ceil(a/t);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");var i,s,l=this.outputShape,c=l.length,d=Je(c),h=pn("coords",c);if(o===1){var f=Je(s=c+1);i=`
        `+f+" sourceLocR = "+f+"("+h.join()+`, 0);
        ++`+h[c-1]+`;
        `+f+" sourceLocG = "+f+"("+h.join()+`, 0);
        ++`+h[c-2]+`;
        `+f+" sourceLocA = "+f+"("+h.join()+`, 0);
        --`+h[c-1]+`;
        `+f+" sourceLocB = "+f+"("+h.join()+`, 0);
        --`+h[c-2]+";"}else s=c,i=`
        `+d+` sourceLocR = coords;
        ++`+h[c-1]+`;
        `+d+` sourceLocG = coords;
        ++`+h[c-2]+`;
        `+d+` sourceLocA = coords;
        --`+h[c-1]+`;
        `+d+` sourceLocB = coords;
        --`+h[c-2]+";";var p=["x","y","z","w","u","v"].slice(0,s),v="."+p[s-1],g=p.map(function(k){return"int "+k}),y=pn("sourceLocR",s-1).concat("inIdx.r"),m=pn("sourceLocG",s-1).concat("inIdx.g"),x=pn("sourceLocB",s-1).concat("inIdx.b"),b=pn("sourceLocA",s-1).concat("inIdx.a"),w=n==="max"?"greaterThan":"lessThan",N=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+y.join()+`),
                             getBestIndicesAChannel(`+m.join()+`),
                             getBestIndicesAChannel(`+x.join()+`),
                             getBestIndicesAChannel(`+b.join()+")));",C=`vec4(
            getAChannel(`+y.join()+`),
            hasNextCol ? getAChannel(`+m.join()+`) : 0.,
            hasNextRow ? getAChannel(`+x.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+b.join()+") : 0.)",S=r?"":`
      float getBestIndicesAChannel(`+g.join()+`) {
        return getChannel(getBestIndicesA(`+p.join()+`),
                                          vec2(`+p.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+g.join()+`) {
        return getChannel(getA(`+p.join()+`),
                               vec2(`+p.slice(-2).join()+`));
      }
      `+S+`
      void main() {
        `+d+` coords = getOutputCoords();
        bool hasNextCol = `+h[c-1]+" < "+(l[c-1]-1)+`;
        bool hasNextRow = `+h[c-2]+" < "+(l[c-2]-1)+`;
        `+i+`
        ivec4 srcIdx = ivec4(sourceLocR`+v+", sourceLocG"+v+`,
          sourceLocB`+v+", sourceLocA"+v+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+C+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+N+`
          vec4 candidate = `+C+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+w+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},W5=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,o=e.dilationHeight,i=e.dilationWidth,s=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=s-1-e.padInfo.top,d=l-1-e.padInfo.left,h=1/(t*n);this.userCode=`
      const ivec2 pads = ivec2(`+c+", "+d+`);
      const float avgMultiplier = float(`+h+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+s+`;
            wR += `+o+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+l+`;
            wC+= `+i+`) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},V5=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,o=e.strideHeight,i=e.strideWidth,s=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=d-1-e.padInfo.front,v=h-1-e.padInfo.top,g=f-1-e.padInfo.left,y=1/(t*n*r);this.userCode=`
      const ivec3 pads = ivec3(`+p+", "+v+", "+g+`);
      const float avgMultiplier = float(`+y+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+s+`) {
          float dyD = float(dyDCorner + wD) / `+a+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+h+`;
              wR += `+l+`) {
            float dyR = float(dyRCorner + wR) / `+o+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+f+`;
                wC += `+c+`) {
              float dyC = float(dyCCorner + wC) / `+i+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},H5=function(e,t,n,r,a,o){this.outputShape=[],this.variableNames=["x","mean","variance"],ze(e,t),ze(e,n);var i="0.0";r!=null&&(ze(e,r),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");var s="1.0";a!=null&&(ze(e,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+i+`;
        float scale = `+s+`;
        float inv = scale * inversesqrt(variance + float(`+o+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},G5=function(e,t,n,r,a,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],ze(e,t),ze(e,n);var i="vec4(0.0)";r!=null&&(ze(e,r),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");var s="vec4(1.0)";a!=null&&(ze(e,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = `+i+`;
        vec4 scale = `+s+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+o+`));

        setOutput((x - mean) * inv + offset);
      }
    `},q5="return areal * breal - aimag * bimag;",K5="return areal * bimag + aimag * breal;",Ny=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=ze(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+e+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},rh="return a + b;",ah="return a - b;",Cy="return a * b;",bN="return (a < 0.) ? b * a : a;",ht=function(e,t,n){this.variableNames=["A","B"],this.outputShape=ze(t,n),this.userCode=`
      float binaryOperation(float a, float b) {
        `+e+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},wN=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,$r=function(e,t,n,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=ze(t,n);var a=this.outputShape.length,o="";if(r)if(a===0||me(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          `+Je(a)+` coords = getOutputCoords();
        `,a===1)o+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var i=pn("coords",a);o+=`
            bool nextRowOutOfBounds =
              (`+i[a-2]+" + 1) >= "+this.outputShape[a-2]+`;
            bool nextColOutOfBounds =
              (`+i[a-1]+" + 1) >= "+this.outputShape[a-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+e+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+o+`

        setOutput(result);
      }
    `},X5=function(){function e(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(a,o){r.minLoc==null&&(r.minLoc=a.getUniformLocationNoThrow(o,"minVal"),r.maxLoc=a.getUniformLocationNoThrow(o,"maxVal")),a.gl.uniform1f(r.minLoc,t),a.gl.uniform1f(r.maxLoc,n)}},e}(),Y5=function(){function e(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(a,o){r.minLoc==null&&(r.minLoc=a.getUniformLocationNoThrow(o,"minVal"),r.maxLoc=a.getUniformLocationNoThrow(o,"maxVal")),a.gl.uniform1f(r.minLoc,t),a.gl.uniform1f(r.maxLoc,n)}},e}(),Q5=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},J5=function(e){this.outputShape=[],this.outputShape=zi(e,1),this.variableNames=e.map(function(s,l){return"T"+l});var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var a=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+a+"));")}var o=t.length,i=t[t.length-1];r.push("else setOutput(getT"+o+"(yR, yC-"+i+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},Z5=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=zi(e,t);var n=this.outputShape,r=n.length,a=Je(r),o=pn("coords",r),i=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(function(y,m){return"T"+m});var s=new Array(e.length-1);s[0]=e[0][t];for(var l=1;l<s.length;l++)s[l]=s[l-1]+e[l][t];var c=i[t],d=i.slice(-2),h=i.join(),f="if ("+c+" < "+s[0]+`) {
        return getChannel(
            getT0(`+h+"), vec2("+d.join()+`));
        }`;for(l=1;l<s.length;l++){var p=s[l-1];f+=`
        if (`+c+" < "+s[l]+"  && "+c+" >= "+s[l-1]+`) {
          return getChannel(
            getT`+l+"("+Xl(i,c,p)+`),
            vec2(`+Xl(d,c,p)+`));
        }`}var v=s.length,g=s[s.length-1];f+=`
        return getChannel(
          getT`+v+"("+Xl(i,c,g)+`),
          vec2(`+Xl(d,c,g)+"));",this.userCode=`
      float getValue(`+i.map(function(y){return"int "+y})+`) {
        `+f+`
      }

      void main() {
        `+a+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+o+`), 0., 0., 0.);

        `+o[r-1]+" = "+o[r-1]+` + 1;
        if (`+o[r-1]+" < "+n[r-1]+`) {
          result.g = getValue(`+o+`);
        }

        `+o[r-2]+" = "+o[r-2]+` + 1;
        if (`+o[r-2]+" < "+n[r-2]+`) {
          result.a = getValue(`+o+`);
        }

        `+o[r-1]+" = "+o[r-1]+` - 1;
        if (`+o[r-2]+" < "+n[r-2]+` &&
            `+o[r-1]+" < "+n[r-1]+`) {
          result.b = getValue(`+o+`);
        }
        setOutput(result);
      }
    `};function Xl(e,t,n){var r=e.indexOf(t);return e.map(function(a,o){return o===r?a+" - "+n:a}).join()}var eA=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+a+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              if (`+o+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},tA=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,o=e.dataFormat==="channelsLast",i=t-1-e.padInfo.top,s=n-1-e.padInfo.left,l=o?1:2,c=o?2:3,d=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+d+`];

        ivec2 dyCorner = ivec2(coords[`+l+"], coords["+c+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {

              if (`+o+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},nA=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.padInfo.front,o=e.padInfo.top,i=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yF = 0; yF < `+e.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+a+`;

            if (xF < 0 || xF >= `+e.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+e.outHeight+`; yR++) {
              int xR = wR + yR * `+n+" - "+o+`;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+e.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+i+`;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},rA=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,o=e.strideHeight,i=e.strideWidth,s=t-1-e.padInfo.front,l=n-1-e.padInfo.top,c=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+s+", "+l+", "+c+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+a+`.0;

          if (dyF < 0.0 || dyF >= `+e.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+n+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+o+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+n+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+i+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},aA=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+o+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+a+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},oA=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,o=t-1-e.padInfo.top,i=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+s+`; dm++) {
              int d2 = d1 * `+s+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},ky=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var a=e.padInfo.top,o=e.padInfo.left,i=e.strideHeight,s=e.strideWidth,l=e.dilationHeight,c=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,f=4*Math.floor(e.inChannels/4),p=e.inChannels%4,v=e.dataFormat==="channelsLast",g=v?1:2,y=v?2:3,m=v?3:1,x="",b="";n&&(x=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,b="result = activation(result);");var w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+x+`

      const ivec2 strides = ivec2(`+i+", "+s+`);
      const ivec2 pads = ivec2(`+a+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+m+`];

        ivec2 xRCCorner =
            ivec2(coords[`+g+"], coords["+y+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+d+`; wR++) {
          int xR = xRCorner + wR * `+l+`;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+h+`; wC++) {
            int xC = xCCorner + wC * `+c+`;

            if (xC < 0 || xC >= `+e.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+f+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+v+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(p===1)+`) {

              if (`+v+`) {
                dotProd +=
                    getX(batch, xR, xC, `+f+`) *
                    getW(wR, wC, `+f+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+f+`, xR, xC) *
                    getW(wR, wC, `+f+`, d2);
              }

            } else if (`+(p===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2)
              );

              if (`+v+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(p===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2),
                getW(wR, wC, `+f+` + 2, d2)
              );

              if (`+v+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1),
                  getX(batch, xR, xC, `+f+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC),
                  getX(batch, `+f+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+w+`
        `+b+`
        setOutput(result);
      }
    `},iA=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,a=e.strideDepth,o=e.strideHeight,i=e.strideWidth,s=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,d=e.filterDepth,h=e.filterHeight,f=e.filterWidth,p=4*Math.floor(e.inChannels/4),v=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+a+", "+o+", "+i+`);
      const ivec3 pads = ivec3(`+t+", "+n+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+d+`; wF++) {
          int xF = xFCorner + wF * `+s+`;

          if (xF < 0 || xF >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+h+`; wR++) {
            int xR = xRCorner + wR * `+l+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`; wC++) {
              int xC = xCCorner + wC * `+c+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+p+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(v===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+p+`) *
                  getW(wF, wR, wC, `+p+`, d2);
              } else if (`+(v===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+p+`),
                  getX(batch, xF, xR, xC, `+p+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+p+`, d2),
                  getW(wF, wR, wC, `+p+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(v===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+p+`),
                  getX(batch, xF, xR, xC, `+p+` + 1),
                  getX(batch, xF, xR, xC, `+p+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+p+`, d2),
                  getW(wF, wR, wC, `+p+` + 1, d2),
                  getW(wF, wR, wC, `+p+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},jy=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var a=e.inHeight,o=e.inWidth,i=e.padInfo.top,s=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,d=e.dilationHeight,h=e.dilationWidth,f=e.filterHeight,p=e.filterWidth,v=e.outChannels/e.inChannels,g="",y="";n&&(g=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,y="result = activation(result);");var m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+g+`

      const ivec2 strides = ivec2(`+l+", "+c+`);
      const ivec2 pads = ivec2(`+i+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+v+`;
        int q = d2 - d1 * `+v+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+f+`; wR++) {
          int xR = xRCorner + wR * `+d+`;

          if (xR < 0 || xR >= `+a+`) {
            continue;
          }

          for (int wC = 0; wC < `+p+`; wC++) {
            int xC = xCCorner + wC * `+h+`;

            if (xC < 0 || xC >= `+o+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+m+`
        `+y+`
        setOutput(result);
      }
    `},Sy=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var a=e.inHeight,o=e.inWidth,i=e.padInfo.top,s=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,d=e.dilationHeight,h=e.dilationWidth,f=e.filterHeight,p=e.filterWidth,v=p,g="int xR; int xC; int xCOffset;",y=0;y<f;y++)for(var m=0;m<p;m++)g+=`
          vec4 xTexelR`+y+"C"+2*m+` = vec4(0.);
          vec4 wR`+y+"C"+m+` = vec4(0.);
          vec4 xR`+y+"C"+m+" = vec4(0.);";for(y=0;y<f;y++)for(var x=0;x<v;x++){if(g+=`
          xR = xRCorner + `+y*d+`;
          xC = xCCorner + `+(m=2*x)*h+`;
        `,c===1){if(m<p&&(g+=s%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+o+`) {
                  xTexelR`+y+"C"+m+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+o+`) {
                    xTexelR`+y+"C"+m+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+y+"C"+m+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+o+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+o+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+y+"C"+m+" = vec4(previous.zw, xTexelR"+y+"C"+m+`.xy);
                } else {
                  xR`+y+"C"+m+" = vec4(0, 0, xTexelR"+y+"C"+m+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+a+" && xC >= 0 && xC < "+o+`) {
                  xTexelR`+y+"C"+m+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+y+"C"+m+` = vec4(0.);
                }

                xR`+y+"C"+m+" = xTexelR"+y+"C"+m+`;
              `,m+1<p)){var b=s%2==0?Bw(h):h;h%2==0&&s%2==1||h%2!=0&&s%2!=1?(g+=`
                  xCOffset = xC + `+s%2+" + "+b+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+o+`) {
                    xTexelR`+y+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,h>1&&(g+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+a+` &&
                      xCOffset >= 0 && xCOffset < `+o+`) {
                      xTexelR`+y+"C"+m+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+y+"C"+m+` = vec4(0.);
                    }
                  `),g+=`
                  xR`+y+"C"+(m+1)+` = vec4(
                    xTexelR`+y+"C"+m+".zw, xTexelR"+y+"C"+(m+2)+`.xy);
                `):g+=`
                  xCOffset = xC + `+b+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+o+`) {
                    xTexelR`+y+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+y+"C"+(m+1)+" = xTexelR"+y+"C"+(m+2)+`;
                `}}else m<p&&(g+=`
              if(xR >= 0 && xR < `+a+`) {
            `,s%2==1?(g+=`
                xCOffset = xC + 1 - `+c+`;
                if(xCOffset >= 0 && xCOffset < `+o+`) {
                  xTexelR`+y+"C"+m+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+y+"C"+m+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+o+`) {
                  xTexelR`+y+"C"+(m+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+y+"C"+(m+2)+` = vec4(0.);
                }

                xR`+y+"C"+m+` = vec4(
                  xTexelR`+y+"C"+m+".zw, xTexelR"+y+"C"+(m+2)+`.zw);
              `,m+1<p&&(g+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+c+`;
                  if(xCOffset >= 0 && xCOffset < `+o+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+y+"C"+(m+1)+" = vec4(xTexelR"+y+"C"+(m+2)+`.xy, final.xy);
                `)):(g+=`
                if(xC >= 0 && xC < `+o+`) {
                  xTexelR`+y+"C"+m+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+y+"C"+m+` = vec4(0.);
                }

                xCOffset = xC + `+c+`;
                if(xCOffset >= 0 && xCOffset < `+o+`) {
                  xTexelR`+y+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+y+"C"+(m+2)+` = vec4(0.);
                }

                xR`+y+"C"+m+` = vec4(
                  xTexelR`+y+"C"+m+".xy, xTexelR"+y+"C"+(m+2)+`.xy);
              `,m+1<p&&(g+=`
                  xR`+y+"C"+(m+1)+` = vec4(
                    xTexelR`+y+"C"+m+".zw, xTexelR"+y+"C"+(m+2)+`.zw);
                `)),g+="}");m<p&&(g+=`
            vec4 wTexelR`+y+"C"+m+" = getW("+y+", "+m+`, d1, q);
            wR`+y+"C"+m+" = vec4(wTexelR"+y+"C"+m+".xz, wTexelR"+y+"C"+m+`.xz);
          `,m+1<p&&(g+=`
              vec4 wTexelR`+y+"C"+(m+1)+" = getW("+y+", "+(m+1)+`, d1, q);
              wR`+y+"C"+(m+1)+` =
                vec4(wTexelR`+y+"C"+(m+1)+".xz, wTexelR"+y+"C"+(m+1)+".xz);"))}for(y=0;y<f;y++)for(m=0;m<p;m++)g+="dotProd += xR"+y+"C"+m+" * wR"+y+"C"+m+";";var w="",N="";n&&(w=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`vec4 activation(vec4 x) {
          `+n+`
        }`,N="result = activation(result);");var C=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+w+`

      const ivec2 strides = ivec2(`+l+", "+c+`);
      const ivec2 pads = ivec2(`+i+", "+s+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+g+`

        vec4 result = dotProd;
        `+C+`
        `+N+`
        setOutput(result);
      }
    `},sA=function(e,t,n,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=e[0],i=e[1],s=e[2],l=e[3],c=t[0],d=n[0],h=n[1];this.outputShape=[c,d,h,l];var f=r==="bilinear"?1:0,p=[i-1+".0",s-1+".0"],v=p[0],g=p[1],y=d>1?[""+(i-1)/(d-1),"(y2-y1) * height_ratio","y1*"+v+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+v],m=y[0],x=y[1],b=y[2],w=h>1?[""+(s-1)/(h-1),"(x2-x1) * width_ratio","x1*"+g+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+g],N=w[0],C=w[1],S=w[2];this.userCode=`
      const float height_ratio = float(`+m+`);
      const float width_ratio = float(`+N+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+o+`) {
          return;
        }

        float height_scale = `+x+`;
        float width_scale = `+C+`;

        float in_y = `+b+`;
        if( in_y < 0.0 || in_y > `+v+` ) {
          setOutput(float(`+a+`));
          return;
        }
        float in_x = `+S+`;
        if( in_x < 0.0 || in_x > `+g+` ) {
          setOutput(float(`+a+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+f+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},lA=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,a=e[e.length-1],o=n?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(n?"return "+a+" -i - 1;":"return i;")+`
      }

      void main() {
        `+Je(r)+` coords = getOutputCoords();
        int end = `+Ey(r,"coords")+`;
        float val = 0.0;
        for (int i = `+a+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+o+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+Ey(r,"coords")+` = idx;
          val += getX(`+function(i,s){if(i===1)return""+s;if(i===2)return s+".x, "+s+".y";if(i===3)return s+".x, "+s+".y, "+s+".z";if(i===4)return s+".x, "+s+".y, "+s+".z, "+s+".w";throw Error("Cumulative sum for rank "+i+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function Ey(e,t){if(e===1)return""+t;if(e===2)return t+".y";if(e===3)return t+".z";if(e===4)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var uA=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Qs.DENSE;var t=Ss(e),n=en();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+fo(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+n.output+` = result;
      }
    `},cA=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Qs.DENSE;var t=Ss(e),n=en();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+fo(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+n.output+` = result;
      }
    `},dA=function(){function e(t,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+n+`;
      int offset_h = imod(h, `+n+`);
      int in_w = w / `+n+`;
      int offset_w = imod(w, `+n+`);
      int offset_d = (offset_h * `+n+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return e.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),hA=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},fA=function(e){this.variableNames=["A"],this.outTexUsage=Rn.DOWNLOAD;var t=en();this.outputShape=e,this.userCode=`
      `+xN+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},pA=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Rn.DOWNLOAD;var t=en();this.outputShape=e,this.userCode=`
      `+xN+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},mA=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"];var r=en(),a=t[0],o=t[1];this.outputShape=e;var i="result";n&&(i="floor(result * 255. + 0.5)"),this.userCode=`
      `+ym(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+o+`;
        int c = imod(flatIndex, `+o+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+o+".0, "+a+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+i+`, 0., 0., 0.);
      }
    `},vA=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=en(),a=t[0],o=t[1];this.outputShape=e;var i="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var l=0;l<=1;l++)for(var c=0;c<=1;c++){var d=2*l+c;i+=`
          localCoords = coords;
          if(localCoords[2] + `+c+" < "+e[2]+`) {
            localCoords[2] += `+c+`;
            if(localCoords[1] + `+l+" < "+e[1]+`) {
              localCoords[1] += `+l+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+o+`;
              c = imod(flatIndex, `+o+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+o+".0, "+a+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+d+`] = values[0];
              } else if(offset == 1) {
                result[`+d+`] = values[1];
              } else if(offset == 2) {
                result[`+d+`] = values[2];
              } else {
                result[`+d+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+ym(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+i+`

        `+r.output+" = "+s+`;
      }
    `},gA="return real * expR - imag * expI;",xA="return real * expI + imag * expR;",_y=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var a=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,o=n?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+a+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+e+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+o+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},yA=function(){function e(t,n){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,a){n.valueLoc==null&&(n.valueLoc=r.getUniformLocationNoThrow(a,"value")),r.gl.uniform1f(n.valueLoc,t)}},e}(),bA=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var a=Je(this.rank),o=function(i,s){var l=i.length;if(l>4)throw Error("Gather for rank "+l+" is not yet supported");if(l===1)return"int(getIndices(resRC))";for(var c=["resRC.x","resRC.y","resRC.z","resRC.w"],d=[],h=0;h<i.length;h++)h===s?d.push("int(getIndices("+c[h]+"))"):d.push(""+c[h]);return d.join()}(e,n);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+o+`));
      }
    `},wA=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=Je(t.length),a=Je(n.length),o=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+a+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+o+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function NA(e,t){var n=en();return gI(e,t,n.version+`
    precision highp float;
    `+n.attribute+` vec3 clipSpacePos;
    `+n.attribute+` vec2 uv;
    `+n.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function CA(e,t){return NI(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function kA(e,t){return CI(e,t,new Uint16Array([0,1,2,2,1,3]))}function vl(e,t,n,r,a,o,i){jI(n,r);var s=kI(e,t),l=e.TEXTURE_2D;return ve(e,t,function(){return e.bindTexture(l,s)}),ve(e,t,function(){return e.texParameteri(l,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),ve(e,t,function(){return e.texParameteri(l,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),ve(e,t,function(){return e.texParameteri(l,e.TEXTURE_MIN_FILTER,e.NEAREST)}),ve(e,t,function(){return e.texParameteri(l,e.TEXTURE_MAG_FILTER,e.NEAREST)}),ve(e,t,function(){return e.texImage2D(l,0,a,n,r,0,o,i,null)}),ve(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)}),s}function jA(e,t,n,r,a){var o=Yc(n,r);return vl(e,t,o[0],o[1],a.internalFormatFloat,a.textureFormatFloat,e.FLOAT)}function SA(e,t,n,r,a){var o=Yc(n,r);return vl(e,t,o[0],o[1],a.internalFormatHalfFloat,a.textureFormatFloat,a.textureTypeHalfFloat)}function EA(e,t,n,r,a){var o=Yc(n,r);return vl(e,t,o[0],o[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function _A(e,t,n,r,a){var o=ml(n,r);return vl(e,t,o[0],o[1],a.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function RA(e,t,n,r,a){var o=ml(n,r);return vl(e,t,o[0],o[1],a.internalFormatPackedHalfFloat,e.RGBA,a.textureTypeHalfFloat)}function IA(e,t,n,r){return ve(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),my(e,t,n,"clipSpacePos",r,3,20,0)&&my(e,t,n,"uv",r,2,20,12)}function AA(e,t,n,r,a,o,i){var s,l,c;ve(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),o instanceof Uint8Array?(s=new Uint8Array(r*a*4),l=e.UNSIGNED_BYTE,c=e.RGBA):(s=new Float32Array(r*a*4),l=e.FLOAT,c=i.internalFormatPackedFloat),s.set(o),ve(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,c,r,a,0,e.RGBA,l,s)}),ve(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function DA(e,t,n,r){ve(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),r.data instanceof Uint8Array?ve(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)}):ve(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}),ve(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function TA(e,t,n,r,a){var o=e.createBuffer();ve(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,o)});var i=16*n*r;return ve(e,t,function(){return e.bufferData(e.PIXEL_PACK_BUFFER,i,e.STREAM_READ)}),ve(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)}),ve(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}),o}function PA(e,t,n){var r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}function FA(e,t,n,r,a){var o=Yc(n,r),i=o[0],s=o[1],l=new Uint8Array(n*r*4);return ve(e,t,function(){return e.readPixels(0,0,i,s,a.downloadTextureFormat,e.UNSIGNED_BYTE,l)}),new Float32Array(l.buffer)}function MA(e,t,n,r,a,o,i,s){var l=e,c=new Float32Array(function(d,h){var f=ml(d,h);return f[0]*f[1]*4}(o,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function OA(e,t,n,r){var a=new Float32Array(n*r*4);return ve(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,a)}),a}var LA=function(){function e(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=X().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,hI(n,t)):this.gl=Tr(n);var r="WEBGL_color_buffer_float";if(X().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=Hl(this.gl,this.debug,"OES_texture_float"),Hn(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=Hl(this.gl,this.debug,"OES_texture_half_float");else if(X().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Hn(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=Hl(this.gl,this.debug,"EXT_color_buffer_half_float");else if(X().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Hn(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!Hn(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=CA(this.gl,this.debug),this.indexBuffer=kA(this.gl,this.debug),this.framebuffer=SI(this.gl,this.debug),this.textureConfig=um(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return X().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var n=this.gl;ve(n,this.debug,function(){return n.finish()}),ve(n,this.debug,function(){return n.bindFramebuffer(n.FRAMEBUFFER,null)}),ve(n,this.debug,function(){return n.deleteFramebuffer(t.framebuffer)}),ve(n,this.debug,function(){return n.bindBuffer(n.ARRAY_BUFFER,null)}),ve(n,this.debug,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}),ve(n,this.debug,function(){return n.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(t,n){return this.throwIfDisposed(),jA(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(t,n){return this.throwIfDisposed(),SA(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(t,n){return this.throwIfDisposed(),EA(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(t,n){this.throwIfDisposed(),DA(this.gl,this.debug,t,n)},e.prototype.uploadDenseMatrixToTexture=function(t,n,r,a){this.throwIfDisposed(),AA(this.gl,this.debug,t,n,r,a,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(t,n){return this.throwIfDisposed(),RA(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(t,n){return this.throwIfDisposed(),_A(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.deleteMatrixTexture=function(t){var n=this;this.throwIfDisposed(),this.outputTexture===t&&(vy(this.gl,this.debug,this.framebuffer),this.outputTexture=null),ve(this.gl,this.debug,function(){return n.gl.deleteTexture(t)})},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,n,r){var a=this;return this.downloadMatrixDriver(t,function(){return FA(a.gl,a.debug,n,r,a.textureConfig)})},e.prototype.downloadPackedMatrixFromBuffer=function(t,n,r,a,o,i){return MA(this.gl,t,0,0,0,o,i,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(t,n){return PA(this.gl,t,n)},e.prototype.createBufferFromTexture=function(t,n,r){this.bindTextureToFrameBuffer(t);var a=TA(this.gl,this.debug,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),a},e.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},e.prototype.createFence=function(t){var n,r,a=this;if(X().getBool("WEBGL_FENCE_API_ENABLED")){var o=t,i=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=function(){var s=o.clientWaitSync(i,0,0);return s===o.ALREADY_SIGNALED||s===o.CONDITION_SATISFIED},n=i}else X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=function(){return a.isQueryAvailable(n,X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:n,isFencePassed:r}},e.prototype.downloadMatrixFromPackedTexture=function(t,n,r){var a=this;return this.downloadMatrixDriver(t,function(){return OA(a.gl,a.debug,n,r)})},e.prototype.createProgram=function(t){this.throwIfDisposed();var n=this.gl,r=xI(n,this.debug,t),a=NA(n,this.debug),o=bI(n,this.debug);return ve(n,this.debug,function(){return n.attachShader(o,a)}),ve(n,this.debug,function(){return n.attachShader(o,r)}),wI(n,this.debug,o),this.debug&&Zd(n,this.debug,o),this.vertexAttrsAreBound||(this.setProgram(o),this.vertexAttrsAreBound=IA(n,this.debug,this.program,this.vertexBuffer)),o},e.prototype.deleteProgram=function(t){var n=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&ve(this.gl,this.debug,function(){return n.gl.deleteProgram(t)})},e.prototype.setProgram=function(t){var n=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&Zd(this.gl,this.debug,this.program),ve(this.gl,this.debug,function(){return n.gl.useProgram(t)})},e.prototype.getUniformLocation=function(t,n,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?_I(this.gl,this.debug,t,n):RI(this.gl,t,n)},e.prototype.getAttributeLocation=function(t,n){var r=this;return this.throwIfDisposed(),ve(this.gl,this.debug,function(){return r.gl.getAttribLocation(t,n)})},e.prototype.getUniformLocationNoThrow=function(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)},e.prototype.setInputMatrixTexture=function(t,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),II(this.gl,this.debug,this.program,t,n,r)},e.prototype.setOutputMatrixTexture=function(t,n,r){this.setOutputMatrixTextureDriver(t,r,n)},e.prototype.setOutputPackedMatrixTexture=function(t,n,r){this.throwIfDisposed();var a=ml(n,r),o=a[0],i=a[1];this.setOutputMatrixTextureDriver(t,o,i)},e.prototype.setOutputMatrixWriteRegion=function(t,n,r,a){this.setOutputMatrixWriteRegionDriver(r,t,a,n)},e.prototype.setOutputPackedMatrixWriteRegion=function(t,n,r,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){this.program!=null&&Zd(this.gl,this.debug,this.program),Gl(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),ve(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),ve(this.gl,this.debug,function(){return t.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Hl(this.gl,this.debug,X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.createQuery();return t.beginQuery(n.TIME_ELAPSED_EXT,r),r}var a=this.getQueryTimerExtensionWebGL1(),o=a.createQueryEXT();return a.beginQueryEXT(a.TIME_ELAPSED_EXT,o),o},e.prototype.endQuery=function(){if(X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(t){return fe(this,void 0,void 0,function(){var n=this;return pe(this,function(r){switch(r.label){case 0:return[4,uy(function(){return n.disposed||n.isQueryAvailable(t,X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(t,X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},e.prototype.getQueryTime=function(t,n){if(n===0)return null;if(n===2){var r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}var a=this.getQueryTimerExtensionWebGL1();return a.getQueryObjectEXT(t,a.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(t,n){if(n===0)return!0;if(n===2){var r=this.gl,a=this.getQueryTimerExtensionWebGL2(),o=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),o&&!this.disjoint}return o=(a=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,a.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),o&&!this.disjoint},e.prototype.pollFence=function(t){var n=this;return new Promise(function(r){n.addItemToPoll(function(){return t.isFencePassed()},function(){return r()})})},e.prototype.pollItems=function(){for(var t=function(r){for(var a=0;a<r.length&&r[a]();++a);return a-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),n=0;n<=t;++n)(0,this.itemsToPoll[n].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},e.prototype.addItemToPoll=function(t,n){var r=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1||uy(function(){return r.pollItems(),r.itemsToPoll.length===0})},e.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),eh(this.gl,this.debug,t,this.framebuffer),this.debug&&Gl(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(eh(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Gl(this.gl)):vy(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(t,n){this.bindTextureToFrameBuffer(t);var r=n();return this.unbindTextureToFrameBuffer(),r},e.prototype.setOutputMatrixTextureDriver=function(t,n,r){this.throwIfDisposed();var a=this.gl;eh(a,this.debug,t,this.framebuffer),this.debug&&Gl(a),this.outputTexture=t,ve(a,this.debug,function(){return a.viewport(0,0,n,r)}),ve(a,this.debug,function(){return a.scissor(0,0,n,r)})},e.prototype.setOutputMatrixWriteRegionDriver=function(t,n,r,a){var o=this;this.throwIfDisposed(),ve(this.gl,this.debug,function(){return o.gl.scissor(t,n,r,a)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},e}();function Ry(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach(function(n,r){var a=n.logicalShape,o=t[r],i=o.shape;if(!Lt(a,i))throw Error("Binary was compiled with different shapes than the current args. Shapes "+a+" and "+i+" must match");if(!n.isUniform||!o.isUniform){var s=n.texShape,l=o.isUniform?null:o.texData.texShape;if(!Lt(s,l))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+l+" must match")}})}var BA=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r=n.filterWidth,a=n.inChannels,o=n.strideWidth,i=n.strideHeight,s=n.padInfo,l=n.outWidth,c=n.dilationWidth,d=n.dilationHeight,h=n.dataFormat,f=s.left,p=s.top,v=a*r,g=en(),y=h==="channelsLast",m=y?0:1,x=y?1:2,b="",w=0;w<=1;w++)for(var N=0;N<=1;N++)b+=`
          blockIndex = rc.y + `+N+`;
          pos = rc.x + `+w+`;

          if(blockIndex < `+e[1]+" && pos < "+e[0]+`) {
            offsetY = int(blockIndex / (`+l+")) * "+i+" - "+p+`;
            d0 = offsetY + `+d+" * (pos / "+v+`);

            if(d0 < `+t[m]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+l+".) * "+o+". - "+f+`.);
              d1 = offsetX + `+c+" * (int(mod(float(pos), "+v+".) / "+a+`.));

              if(d1 < `+t[x]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+a+`.));

                if (`+y+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*w+N)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*w+N)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+b+`

        `+g.output+` = result;
      }
    `},zA=function(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[];var o,i=t,s=e[3]-1;this.outputShape=e;var l="float("+n+") + float("+r+") * sum";o=a===.5?"inversesqrt("+l+")":a===1?"1.0/("+l+")":"exp(log("+l+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+i+"; j <= "+i+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+s+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+o+`;
        setOutput(val);
      }
    `},$A=function(e,t,n,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+n+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+a+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+a+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},UA=function(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,i=t,s=e[3]-1;this.outputShape=e;var l="float("+n+") + float("+r+") * sum";o=a===.5?"inversesqrt("+l+")":a===1?"1.0/("+l+")":"exp(log("+l+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+i+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+i+"; j <= "+i+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+s+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+o+`;
        setOutput(result);
      }
    `},WA=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,a=e.effectiveFilterHeight,o=e.effectiveFilterWidth,i=a-1-e.padInfo.top,s=o-1-e.padInfo.left,l=a*o-1;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+a+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+o+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+n+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+l+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+o+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},VA=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.dilationDepth,o=e.dilationHeight,i=e.dilationWidth,s=e.effectiveFilterDepth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=s-1-e.padInfo.front,h=l-1-e.padInfo.top,f=c-1-e.padInfo.left,p=s*l*c-1;this.userCode=`
      const ivec3 pads = ivec3(`+d+", "+h+", "+f+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+s+`;
           wD += `+a+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+l+`;
              wR += `+o+`) {
            float dyR = float(dyRCorner + wR) / `+n+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+c+`;
                wC += `+i+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+p+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+l+" * "+c+` +
                  wR * `+c+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},oh=function(e,t,n,r,a,o,i){n===void 0&&(n=!1),r===void 0&&(r=!1),a===void 0&&(a=!1),o===void 0&&(o=null),i===void 0&&(i=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var s=n?e[1]:e[2],l=Math.ceil(s/2),c=n?"i * 2, rc.y":"rc.y, i * 2",d=r?"rc.z, i * 2":"i * 2, rc.z",h=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],p="",v="";o&&(p=i?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+o+`
        }`:`vec4 activation(vec4 x) {
          `+o+`
        }`,v="result = activation(result);");var g=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+p+`

      const float sharedDimension = `+l+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+l+`; i++) {
          vec4 a = getMatrixA(rc.x, `+c+`);
          vec4 b = getMatrixB(rc.x, `+d+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+h[0]+" * "+f[0]+`);
          result += (`+h[1]+" * "+f[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+g+`

        `+v+`

        setOutput(result);
      }
    `},HA=function(){function e(t,n,r){this.variableNames=["probs"],this.outputShape=[t,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(n-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(n-1)+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,a){n.seedLoc==null&&(n.seedLoc=r.getUniformLocation(a,"seed")),r.gl.uniform1f(n.seedLoc,t)}},e}(),GA=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+n+`),
                      float(index == coords.y)));
      }
    `},qA=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var n=pn("rc",t),r=Je(t),a=function(s,l,c){if(s===1)return"rc > "+l[0];for(var d="",h=s-2;h<s;h++)d+=c[h]+" >= "+l[h],h<s-1&&(d+="||");return d}(t,e,n),o=function(s,l,c,d){if(s===1)return"";var h=d.slice(-2);return`
    int r = `+h[0]+`;
    int c = `+h[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+l+`;
    bool rEdge = rp1 >= `+c+`;
  `}(t,e[e.length-1],e[e.length-2],n),i=function(s,l){var c=s.length,d=function(h,f){for(var p=[],v=0;v<=1;v++)for(var g=0;g<=1;g++){for(var y=(v===0?"r":"rp1")+", "+(g===0?"c":"cp1"),m=2;m<h;m++)y=f[f.length-1-m]+","+y;p.push(y)}return p}(c,l);return c===1?`getA(rc),
            rc + 1 >= `+s[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+d[0]+`),
          cEdge ? 0. : getA(`+d[1]+`),
          rEdge ? 0. : getA(`+d[2]+`),
          rEdge || cEdge ? 0. : getA(`+d[3]+")"}(e,n);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+a+`) {
            setOutput(vec4(0));
          } else {
            `+o+`

            setOutput(vec4(`+i+`));
          }
        }
      `}},KA=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map(function(l,c){return l[0]+e[c]+l[1]});var r=e.length,a=Je(r),o=t.map(function(l){return l[0]}).join(","),i=t.map(function(l,c){return l[0]+e[c]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+a+" start = "+a+"("+o+`);
      `+a+" end = "+a+"("+i+`);

      void main() {
        `+a+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+n+`));
        } else {
          `+a+` coords = outC - start;
          setOutput(getX(`+s+`));
        }
      }
    `:`
        int start = `+o+`;
        int end = `+i+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+n+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},XA=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(y,m){return y[0]+e[m]+y[1]});for(var r=e.length,a=Je(r),o=t.map(function(y){return y[0]}).join(","),i=t.map(function(y,m){return y[0]+e[m]}).join(","),s=pn("rc",r),l=pn("source",r),c=s[r-1]+" < "+this.outputShape[r-1],d=r===1?"source":"vec2("+l.slice(-2).join()+")",h=[a+" rc = outputLoc;",s[r-1]+` += 1;
       if(`+c+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+s[r-2]+` += 1;
       if(`+s[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+s[r-1]+` += 1;
         if(`+c+") {"],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",p="",v=0,g=r===1?2:4;v<g;v++)p+=`
        `+h[v]+`
        if (`+f+`) {
          result[`+v+"] = float("+n+`);
        } else {
          `+a+` source = rc - start;
          result[`+v+"] = getChannel(getX("+l.join()+"), "+d+`);
        }
      `;p+=r===1?"} ":"}}",this.userCode=`
      const `+a+" start = "+a+"("+o+`);
      const `+a+" end = "+a+"("+i+`);

      void main() {
        `+a+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+p+`
        setOutput(result);
      }
    `},ih=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,a=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,s=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=e.padInfo.top,h=e.padInfo.left;this.outputShape=e.outShape;var f=t==="avg",p="0.0";if(f||(p="-1.0 / 1e-20"),n)this.userCode=`
        const ivec2 strides = ivec2(`+a+", "+o+`);
        const ivec2 pads = ivec2(`+d+", "+h+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+l+`;
              wR += `+i+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+c+`;
                wC += `+s+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+c+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var v=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(v="avgValue / count");var g=4*Math.floor(r/4),y=r%4,m=`
      if (`+f+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+a+", "+o+`);
      const ivec2 pads = ivec2(`+d+", "+h+`);
      const float initializationValue = `+p+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+p+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+l+`;
            wR += `+i+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+g+`; wC += 4) {
            int xC = xCCorner + wC * `+s+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              getValue(batch, xR, xC + 3 * `+s+`, d)
            );

            `+m+`
          }

          int xC = xCCorner + `+g+`;
          if (`+(y===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+m+`
          } else if (`+(y===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              initializationValue,
              initializationValue
            );

            `+m+`
          } else if (`+(y===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              initializationValue
            );

            `+m+`
          }
        }
        setOutput(`+v+`);
      }
    `}},sh=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,a=e.strideDepth,o=e.strideHeight,i=e.strideWidth,s=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=e.padInfo.front,v=e.padInfo.top,g=e.padInfo.left;this.outputShape=e.outShape;var y=t==="avg",m="0.0";if(y||(m="-1.0 / 1e-20"),n)this.userCode=`
        const ivec3 strides =
            ivec3(`+a+", "+o+", "+i+`);
        const ivec3 pads = ivec3(`+p+", "+v+", "+g+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+d+`;
              wD += `+s+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+e.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+h+`;
                wR += `+l+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+f+`;
                  wC += `+c+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+h+" * "+f+` +
                      wR * `+f+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var x=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(x="avgValue / count");var b=4*Math.floor(r/4),w=r%4,N=`
      if (`+y+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+a+", "+o+", "+i+`);
      const ivec3 pads = ivec3(`+p+", "+v+", "+g+`);
      const float initializationValue = `+m+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+m+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+s+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+h+`;
            wR += `+l+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+b+`; wC += 4) {
              int xC = xCCorner + wC * `+c+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+c+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+c+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+c+`, ch)
              );

              `+N+`
            }

            int xC = xCCorner + `+b+`;
            if (`+(w===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+N+`
            } else if (`+(w===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+c+`, ch),
                initializationValue,
                initializationValue
              );

              `+N+`
            } else if (`+(w===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+c+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+c+`, ch),
                initializationValue
              );

              `+N+`
            }
          }
          setOutput(`+x+`);
        }
      }
    `}},YA=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,a=e.inSize,o=Math.ceil(a/n);this.outputShape=[r,o];var i="0.0",s="";t==="prod"?i="1.0":t==="min"?(i="1.0 / 1e-20",s="min"):t==="max"&&(i="-1.0 / 1e-20",s="max");var l=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?l="sumValue":t==="prod"?l="prodValue":t==="all"?l="allValue":t==="any"&&(l="anyValue");var c=4*Math.floor(n/4),d=n%4,h=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+s+`(values, minMaxValue);
      }
    `,f="vec4";t==="all"?(i="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):t==="any"&&(i="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");var p="";a%n>0&&(p=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+i+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+p+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        vec4 minMaxValue = vec4(`+i+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+c+`; i += 4) {
          int inIdx = inOffset + i;
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+h+`
        }

        int inIdx = inOffset + `+c+`;
        if (`+(d===1)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+h+`
        } else if (`+(d===2)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+h+`
        } else if (`+(d===3)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+h+`
        }
        setOutput(`+l+`);
      }
    `},QA=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var a="thisRC = rc;";r%2==1&&(a+="thisRC.z += 1;"),r>1&&(a+="thisRC.y += 1;"),n+=`
        `+a+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+fo(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+ym(e)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+e[1]+`;
        int cols = `+e[2]+`;

        `+n+`

        setOutput(result);
      }
    `},JA=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,a=r[1],o=r[2],i=e.shape,s=i[1],l=i[2],c=[n&&s>1?a-1:a,n&&l>1?o-1:o],d=[n&&s>1?s-1:s,n&&l>1?l-1:l],h=c[0]/d[0],f=c[1]/d[1],p=1/h,v=1/f,g=2*Math.ceil(p)+2,y=2*Math.ceil(v)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+h+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+p+`);
        const float invWidthScale = float(`+v+`);

        const int winHeight = int(`+g+`);
        const int winWidth = int(`+y+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+l+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(a-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(o-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},ZA=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var a=e[0],o=e[1],i=e[2],s=e[3];this.outputShape=[a,t,n,s];var l=[r&&t>1?o-1:o,r&&n>1?i-1:i],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+l[0]/c[0]+`,
          `+l[1]/c[1]+`);
      const vec2 inputShapeRC = vec2(`+o+".0, "+i+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},eD=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var a=e[0],o=e[1],i=e[2],s=e[3];this.outputShape=[a,t,n,s];var l=[r&&t>1?o-1:o,r&&n>1?i-1:i],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+l[0]/c[0]+`,
          `+l[1]/c[1]+`,
          `+l[1]/c[1]+`);
      const vec3 inputShapeRC = vec3(`+o+".0, "+i+`.0,
                                     `+i+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(s-1)+`;
        bool hasNextRow = coords.z < `+(n-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},tD=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,a=r[1],o=r[2],i=e.shape,s=i[1],l=i[2],c=[n&&s>1?a-1:a,n&&l>1?o-1:o],d=[n&&s>1?s-1:s,n&&l>1?l-1:l],h=c[0]/d[0],f=c[1]/d[1],p=1/h,v=1/f,g=2*Math.ceil(p)+2,y=2*Math.ceil(v)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+h+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+p+`);
        const float invWidthScale = float(`+v+`);

        const int winHeight = int(`+g+`);
        const int winWidth = int(`+y+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+l+`) {
              continue;
            }

            float sourceFracRow =
              float(`+c[0]+`) *
                (float(dyR) / float(`+d[0]+`));

            float sourceFracCol =
                float(`+c[1]+`) *
                  (float(dyC) / float(`+d[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+a+`) - 1),
                `+n+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+o+`) - 1),
                `+n+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},nD=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var a=e[0],o=e[1],i=e[2],s=e[3];this.outputShape=[a,t,n,s];var l=[r&&t>1?o-1:o,r&&n>1?i-1:i],c=[r&&t>1?t-1:t,r&&n>1?n-1:n],d=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+l[0]/c[0]+`,
          `+l[1]/c[1]+`);
      const vec2 inputShapeRC = vec2(`+o+".0, "+i+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+d+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},rD=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,n!==1){var r=e.map(function(o,i){return function(s){return t.indexOf(s)!==-1&&e[s]!==1?e[s]+" - coords["+s+"] - 1":"coords["+s+"]"}(i)}).join(","),a=Je(n);this.userCode=`
      void main() {
        `+a+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+e[0]+` - coord - 1));
        }
      `},aD=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=pn("rc",n),a=r[n-1]+" + 1 < "+this.outputShape[n-1],o=r[n-2]+" + 1 < "+this.outputShape[n-2],i=Je(n);function s(l){var c=e.map(function(d,h){return function(f,p){return t.indexOf(f)!==-1&&e[f]!==1?e[f]+" - "+p[f]+" - 1":""+p[f]}(h,l)});return"getChannel(getX("+c.join(",")+"), vec2("+c.slice(-2).join(",")+"))"}this.userCode=n===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+e[0]+` - rc - 1),
            `+e[0]+` - rc - 1);
          if(`+a+`){
              result.g = getChannel(getX(`+e[0]+` - (rc  + 1) - 1),
                `+e[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+i+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(l){return s(l)}(r.slice())+`;
          if(`+a+`){
            result.g = `+function(l){return l[n-1]="("+l[n-1]+" + 1)",s(l)}(r.slice())+`;
          }
          if(`+o+`) {
            result.b = `+function(l){return l[n-2]="("+l[n-2]+" + 1)",s(l)}(r.slice())+`;
            if(`+a+`) {
              result.a = `+function(l){return l[n-1]="("+l[n-1]+" + 1)",l[n-2]="("+l[n-2]+" + 1)",s(l)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},Iy=function(e,t,n,r,a,o,i){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var s=Je(a.length),l=Je(o.length),c="";n===1?c="i":n===2&&(c="i, j");var d="getIndices("+c+")",h="";r===1?h="i":r===2&&(h="i, coords[1]");var f="getUpdates("+h+")",p=t>1?"strides[j]":"strides";this.userCode=`
        `+s+" strides = "+s+"("+a+`);

        void main() {
          `+l+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+e+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+d+`);
              flattenedIndex += index * `+p+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+f+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},oD=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,a=e.inSize,o=e.numSegments,i=o*Math.ceil(a/n);this.outputShape=[r,i];var s=4*Math.floor(n/4),l=n%4,c=`
        sumValue += dot(values, segFilter);
    `,d="";a%n>0&&(d=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `);var h="";a%n>0&&(h=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+d+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+h+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+o+")) * float("+n+`));
        int currentSeg = int(mod(float(outIdx), float(`+o+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+s+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+c+`
        }

        int inIdx = inOffset + `+s+`;
        if (`+(l===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+c+`
        } else if (`+(l===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+c+`
        } else if (`+(l===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+c+`
        }
        setOutput(sumValue);
      }
    `},iD=function(e,t,n){var r,a;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(n===1)a="resRC",r="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],s=[],l=0;l<t.length;l++)s.push(""+o[l]),l<e&&i.push(""+o[l]);r=i.join(),a=s.join()}var c=Je(n);this.userCode=`
      void main() {
        `+c+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+a+`));
        } else {
          setOutput(getB(`+a+`));
        }
      }
    `},sD=function(){function e(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=Je(this.rank),a="uniform int start["+this.rank+"];",o=function(i){if(i===1)return"sourceLoc";if(i<=6)return lh.slice(0,i).map(function(s){return"sourceLoc."+s}).join(",");throw Error("Slicing for rank "+i+" is not yet supported")}(this.rank);n=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+t.map(function(i,s){return"sourceLoc."+lh[s]+" = start["+s+"] + coords."+lh[s]+";"}).join(`
`)+`
      `,this.userCode=`
      `+a+`
      void main() {
        `+n+`
        setOutput(getSource(`+o+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,a){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(a,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),lh=["x","y","z","w","u","v"],lD=function(){function e(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=Je(this.rank),r=pn("coords",this.rank),a=pn("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":"vec2("+a.slice(-2).join()+")",i="getChannel(getSource("+a.join()+"), "+o+")",s=`
      result.x = `+i+`;
      if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+a[this.rank-1]+`;
        result.y = `+i+`;
        --`+a[this.rank-1]+`;
      }
    `,l=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+a[this.rank-2]+`;
        result.z = `+i+`;
        if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+a[this.rank-1]+`;
          result.w = `+i+`;
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            `+n+"("+t.map(function(d,h){return"start["+h+"]"}).join()+");":t.map(function(d,h){return a[h]+" = "+r[h]+" + start["+h+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+n+` coords = getOutputCoords();
        `+n+` sourceLoc;
        `+c+`
        vec4 result = vec4(0.);
        `+s+`
        `+l+`
        setOutput(result);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,a){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(a,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),uD=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,a=Je(n.length),o=Je(n.length),i="";if(r===1)i="coords * strides + begin";else{var s=0;i=n.map(function(l,c){return s++,n.length===1?"coords * strides["+c+"] + begin["+c+"]":"coords["+(s-1)+"] * strides["+c+"] + begin["+c+"]"}).join(",")}this.userCode=`
      `+a+" begin = "+a+"("+e+`);
      `+a+" strides = "+a+"("+t+`);

      void main() {
        `+o+` coords = getOutputCoords();
        setOutput(getX(`+i+`));
      }
    `},cD=function(){function e(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(t,n,r){var a,o=Ay(n,r),i=Dy(t,o,r);if(i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]),this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[i].shift();return this.usedTextures[i].push(s),s}return this.numUsedTextures++,this.log(),o===En.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):o===En.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):o===En.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):o===En.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):o===En.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[i].push(a),a},e.prototype.releaseTexture=function(t,n,r,a){if(this.freeTextures!=null){var o=Dy(n,Ay(r,a),a);o in this.freeTextures||(this.freeTextures[o]=[]),this.freeTextures[o].push(t),this.numFreeTextures++,this.numUsedTextures--;var i=this.usedTextures[o],s=i.indexOf(t);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");i.splice(s,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var n in this.freeTextures)this.freeTextures[n].forEach(function(r){t.gpgpu.deleteMatrixTexture(r)});for(var n in this.usedTextures)this.usedTextures[n].forEach(function(a){t.gpgpu.deleteMatrixTexture(a)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function Ay(e,t){if(e===Rn.UPLOAD)return En.PACKED_2X2_FLOAT32;if(e===Rn.RENDER||e==null)return function(n){return X().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?En.PACKED_2X2_FLOAT32:En.UNPACKED_FLOAT32:n?En.PACKED_2X2_FLOAT16:En.UNPACKED_FLOAT16}(t);if(e===Rn.DOWNLOAD||e===Rn.PIXELS)return En.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function Dy(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var dD=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var a=Je(this.rank),o=function(i){var s=i.length;if(s>5)throw Error("Tile for rank "+s+" is not yet supported");if(s===1)return"imod(resRC, "+i[0]+")";for(var l=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],c=[],d=0;d<i.length;d++)c.push("imod("+l[d]+", "+i[d]+")");return c.join()}(e);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+o+`));
      }
    `},hD=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var a=Je(this.rank),o=function(i){var s=i.length;if(s>6)throw Error("Transpose for rank "+s+" is not yet supported");for(var l=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],c=new Array(s),d=0;d<i.length;d++)c[i[d]]=l[d];return c.join()}(t);this.userCode=`
    void main() {
      `+a+` resRC = getOutputCoords();
      setOutput(getA(`+o+`));
    }
    `},fD=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var a=Je(this.rank),o=gN("rc",this.rank),i=new Array(this.rank);for(r=0;r<t.length;r++)i[t[r]]=o[r];var s="vec2("+i.slice(-2).join()+")",l="++"+o[this.rank-1]+" < "+n[this.rank-1],c="getChannel(getA("+i.join()+"), "+s+")";this.userCode=`
    void main() {
      `+a+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+c+`;
      if(`+l+`) {
        result[1] = `+c+`;
      }
      --`+o[this.rank-1]+`;
      if(++`+o[this.rank-2]+" < "+n[this.rank-2]+`) {
        result[2] = `+c+`;
        if(`+l+`) {
          result[3] = `+c+`;
        }
      }
      setOutput(result);
    }
    `},bm=1.7580993408473768,wm=1.0507009873554805,Me=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},dr="if (isnan(x)) return x;",pD="return x;",Ty="return abs(x);",NN=dr+`
  return (x < 0.0) ? 0.0 : x;
`,CN=dr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,kN="return (x >= 0.0) ? x : (exp(x) - 1.0);",mD=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+bm+`;
  float scale = `+wm+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,Py="return -x;",Fy="return ceil(x);",My="return floor(x);",Oy="return exp(x);",Ly="return exp(x) - 1.0;",vD=dr+`
  return sin(x);
`,gD=dr+`
  return cos(x);
`,xD=dr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,yD=dr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,bD=dr+`
  return atan(x);
`,wD=dr+"return log(x + sqrt(x * x + 1.0));",ND=dr+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,CD=dr+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Yl="return x;",kD="return x;",jN=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,SN=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,EN=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,hs=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},jD=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=pn("rc",t),r=Je(t),a=function(s,l){if(s===1)return"rc";for(var c="",d=0;d<s;d++)c+=l[d],d<s-1&&(c+=",");return c}(t,n),o=n.slice(-2),i=t<=1?"rc":"vec2("+o.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+a+`);

        setOutput(getChannel(packedInput, `+i+`));
      }
    `},Ql={};function Jl(e,t){if(t===void 0&&(t=!1),e==="linear")return t?kD:pD;if(e==="relu")return t?jN:NN;if(e==="elu")return t?EN:kN;if(e==="relu6")return t?SN:CN;if(e==="prelu")return t?wN:bN;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var SD=600,ED=function(e){function t(n){var r,a=e.call(this)||this;if(a.pendingRead=new WeakMap,a.pendingDisposal=new WeakSet,a.dataRefCount=new WeakMap,a.numBytesInGPU=0,a.uploadWaitMs=0,a.downloadWaitMs=0,a.warnedAboutMemory=!1,a.pendingDeletes=0,a.disposed=!1,!X().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(n==null){var o=Tr(X().getNumber("WEBGL_VERSION"));a.binaryCache=((r=X().getNumber("WEBGL_VERSION"))in Ql||(Ql[r]={}),Ql[r]),a.gpgpu=new LA(o),a.canvas=o.canvas,a.gpgpuCreatedLocally=!0}else a.gpgpu=n,a.binaryCache={},a.gpgpuCreatedLocally=!1,a.canvas=n.gl.canvas;return a.textureManager=new cD(a.gpgpu),a.numMBBeforeWarning=X().global.screen==null?1024:X().global.screen.height*X().global.screen.width*window.devicePixelRatio*SD/1024/1024,a.texData=new lN(a,O),a}return cr(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(n,r,a){if(X().getBool("DEBUG")&&this.checkNumericalProblems(n),a==="complex64"&&n!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var o={};return this.texData.set(o,{shape:r,dtype:a,values:n,usage:Rn.UPLOAD}),o},t.prototype.move=function(n,r,a,o){if(X().getBool("DEBUG")&&this.checkNumericalProblems(r),o==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(n,{shape:a,dtype:o,values:r,usage:Rn.UPLOAD})},t.prototype.readSync=function(n){var r=this.texData.get(n),a=r.values,o=r.dtype,i=r.complexTensors,s=r.slice,l=r.shape,c=r.isPacked;if(s!=null){var d=void 0;d=c?new hs(l,Yl):new Me(l,Yl);var h=this.runWebGLProgram(d,[{dataId:n,shape:l,dtype:o}],o),f=this.readSync(h.dataId);return this.disposeData(h.dataId),f}if(a!=null)return this.convertAndCacheOnCPU(n);if(o==="string")return a;var p,v,g=this.activeTimers!=null;return g&&(p=xr()),o==="complex64"?v=Bf(i.real.dataSync(),i.imag.dataSync()):v=this.getValuesFromTexture(n),g&&(this.downloadWaitMs+=xr()-p),this.convertAndCacheOnCPU(n,v)},t.prototype.read=function(n){return fe(this,void 0,void 0,function(){var r,a,o,i,s,l,c,d,h,f,p,v,g,y,m,x,b,w,N,C,S,k;return pe(this,function(_){switch(_.label){case 0:if(this.pendingRead.has(n))return r=this.pendingRead.get(n),[2,new Promise(function(E){return r.push(E)})];if(a=this.texData.get(n),o=a.values,i=a.shape,s=a.slice,l=a.dtype,c=a.complexTensors,d=a.isPacked,s!=null)return h=void 0,h=d?new hs(i,Yl):new Me(i,Yl),f=this.runWebGLProgram(h,[{dataId:n,shape:i,dtype:l}],l),p=this.read(f.dataId),this.disposeData(f.dataId),[2,p];if(o!=null)return[2,this.convertAndCacheOnCPU(n)];if(!X().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&X().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return v=null,l!=="complex64"&&X().get("WEBGL_BUFFER_SUPPORTED")&&(g=this.decode(n),y=this.texData.get(g.dataId),v=(k=this.gpgpu).createBufferFromTexture.apply(k,[y.texture].concat(Ss(i)))),this.pendingRead.set(n,[]),l==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:_.sent(),_.label=2;case 2:return l!=="complex64"?[3,4]:[4,Promise.all([c.real.data(),c.imag.data()])];case 3:return x=_.sent(),b=x[0],w=x[1],m=Bf(b,w),[3,5];case 4:v==null?m=this.getValuesFromTexture(n):(N=me(i),m=this.gpgpu.downloadFloat32MatrixFromBuffer(v,N)),_.label=5;case 5:return g!=null&&this.disposeData(g.dataId),C=this.convertAndCacheOnCPU(n,m),S=this.pendingRead.get(n),this.pendingRead.delete(n),S.forEach(function(E){return E(C)}),this.pendingDisposal.has(n)&&(this.pendingDisposal.delete(n),this.disposeData(n),this.pendingDeletes--),[2,C]}})})},t.prototype.checkNumericalProblems=function(n){if(n!=null)for(var r=0;r<n.length;r++){var a=n[r];if(!mI(a))throw X().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+a+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+a+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(n){var r,a=this.texData.get(n),o=a.shape,i=a.dtype,s=a.isPacked,l=me(o);if(X().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var c=this.decode(n),d=this.texData.get(c.dataId),h=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[d.texture].concat(Ss(o))).subarray(0,l);return this.disposeData(c.dataId),h}var f=X().getBool("WEBGL_PACK")&&s===!0,p=f?th(o):o,v=f?new pA(p):new fA(p),g=this.runWebGLProgram(v,[{shape:p,dtype:i,dataId:n}],"float32"),y=this.texData.get(g.dataId),m=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(y.texture,y.texShape[0],y.texShape[1]).subarray(0,l);return this.disposeData(g.dataId),m},t.prototype.time=function(n){return fe(this,void 0,void 0,function(){var r,a,o,i,s,l,c;return pe(this,function(d){switch(d.label){case 0:return r=this.activeTimers,a=[],o=!1,this.programTimersStack==null?(this.programTimersStack=a,o=!0):this.activeTimers.push(a),this.activeTimers=a,n(),i=Li(this.activeTimers.map(function(h){return h.query})).filter(function(h){return h!=null}),s=Li(this.activeTimers.map(function(h){return h.name})).filter(function(h){return h!=null}),this.activeTimers=r,o&&(this.programTimersStack=null),l={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(i)]:[3,2];case 1:return c=d.sent(),l.kernelMs=XR(c),l.getExtraProfileInfo=function(){return c.map(function(h,f){return{name:s[f],ms:h}}).map(function(h){return h.name+": "+h.ms}).join(", ")},[3,3];case 2:l.kernelMs={error:"WebGL query timers are not supported in this environment."},d.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,l]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:xr(),endMs:null}},t.prototype.endTimer=function(n){return X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),n):(n.endMs=xr(),n)},t.prototype.getQueryTime=function(n){return fe(this,void 0,void 0,function(){var r;return pe(this,function(a){return X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(n)]:[2,(r=n).endMs-r.startMs]})})},t.prototype.disposeData=function(n){if(!this.pendingDisposal.has(n)){if(this.pendingRead.has(n))return this.pendingDisposal.add(n),void this.pendingDeletes++;if(this.texData.has(n)){this.releaseGPUData(n);var r=this.texData.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(n)}}},t.prototype.releaseGPUData=function(n){var r=this.texData.get(n),a=r.texture,o=r.dtype,i=r.texShape,s=r.usage,l=r.isPacked,c=r.slice,d=c&&c.origDataId||n,h=this.dataRefCount.get(d);h>1?this.dataRefCount.set(d,h-1):(this.dataRefCount.delete(d),a!=null&&(this.numBytesInGPU-=this.computeBytes(i,o),this.textureManager.releaseTexture(a,i,s,l)));var f=this.texData.get(n);f.texture=null,f.texShape=null,f.isPacked=!1,f.slice=null},t.prototype.getTexture=function(n){return this.uploadToGPU(n),this.texData.get(n).texture},t.prototype.getDataInfo=function(n){return this.texData.get(n)},t.prototype.getCPUBackend=function(){return X().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=O.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(n,r){var a=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&n.every(function(o){return a.texData.get(o.dataId).texture==null&&o.size<r})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(n,r){var a=this.makeOutput(n.shape,"complex64");return this.texData.get(a.dataId).complexTensors={real:O.keep(n.clone()),imag:O.keep(r.clone())},a},t.prototype.real=function(n){return this.texData.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.texData.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,a){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.slice(n,r,a);if(me(a)===0)return Ht([],a,n.dtype);var o=this.texData.get(n.dataId).isPacked,i=iN(n.shape,r,a);if(o||!i){var s=X().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new lD(a):new sD(a),l=s.getCustomSetupFunc(r);return this.compileAndRun(s,[n],null,l)}return this.uploadToGPU(n.dataId),this.shallowSlice(n,r,a)},t.prototype.shallowSlice=function(n,r,a){var o=this.texData.get(n.dataId),i=this.makeOutput(a,n.dtype),s=this.texData.get(i.dataId);Object.assign(s,o),s.shape=a,s.dtype=n.dtype;var l=sN(r,n.strides);o.slice&&(l+=o.slice.flatOffset),s.slice={flatOffset:l,origDataId:o.slice&&o.slice.origDataId||n.dataId};var c=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,c+1),i},t.prototype.stridedSlice=function(n,r,a,o){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.stridedSlice(n,r,a,o);var i=pm(r,a,o);if(i.some(function(l){return l===0}))return Ht([],i);var s=new uD(r,o,i);return this.compileAndRun(s,[n])},t.prototype.reverse=function(n,r){var a=X().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new aD(n.shape,r):new rD(n.shape,r);return this.compileAndRun(a,[n])},t.prototype.concat=function(n,r){if(n[0].dtype==="complex64"){var a=n.map(function(p){return Wn(p)}),o=n.map(function(p){return wr(p)});return Wt(this.concat(a,r),this.concat(o,r))}if(this.shouldExecuteOnCPU(n))return this.cpuBackend.concat(n,r);if(n.length===1)return n[0];if(n.length>X().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var i=Math.floor(n.length/2),s=this.concat(n.slice(0,i),r),l=this.concat(n.slice(i),r);return this.concat([s,l],r)}if(X().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].rank>1){var c=new Z5(n.map(function(p){return p.shape}),r);return this.compileAndRun(c,n)}var d=zi(n.map(function(p){return p.shape}),r),h=n.map(function(p){return p.as2D(-1,me(p.shape.slice(r)))}),f=new J5(h.map(function(p){return p.shape}));return this.compileAndRun(f,h).reshape(d)},t.prototype.neg=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.neg(n);if(X().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,Py,n.dtype);var r=new Me(n.shape,Py);return this.compileAndRun(r,[n])},t.prototype.batchMatMul=function(n,r,a,o){var i=a?n.shape[2]:n.shape[1],s=o?r.shape[1]:r.shape[2],l=a?n.shape[1]:n.shape[2],c=n.shape[0];if((i===1||s===1)&&l>1e3){a&&(n=n.transpose([0,2,1])),o&&(r=r.transpose([0,2,1]));var d=s===1?n:n.as3D(c,l,1),h=s===1?2:1,f=s===1?r.as3D(c,1,l):r;return this.multiply(d,f).sum(h,!0)}var p=Vt(n.dtype,r.dtype),v=new oh(n.shape,[c,i,s],a,o);return this.compileAndRun(v,[n,r],p)},t.prototype.fusedBatchMatMul=function(n){var r=n.a,a=n.b,o=n.transposeA,i=n.transposeB,s=n.bias,l=n.activation,c=n.preluActivationWeights,d=o?r.shape[2]:r.shape[1],h=i?a.shape[1]:a.shape[2],f=r.shape[0],p=Vt(r.dtype,a.dtype),v=s!=null,g=c!=null,y=l?Jl(l,!0):null,m=new oh(r.shape,[f,d,h],o,i,v,y,g),x=[r,a];return s&&x.push(s),c&&x.push(c),this.compileAndRun(m,x,p)},t.prototype.multiply=function(n,r){if(n.dtype==="complex64"){var a=this.texData.get(n.dataId),o=this.texData.get(r.dataId),i=new Ny(q5,n.shape,r.shape),s=new Ny(K5,n.shape,r.shape),l=[this.makeComplexComponentTensorInfo(n,a.complexTensors.real),this.makeComplexComponentTensorInfo(n,a.complexTensors.imag),this.makeComplexComponentTensorInfo(r,o.complexTensors.real),this.makeComplexComponentTensorInfo(r,o.complexTensors.imag)],c=this.compileAndRun(i,l),d=this.compileAndRun(s,l),h=this.complex(c,d);return c.dispose(),d.dispose(),h}if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.multiply(n,r);if(X().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,Cy,n.dtype);var f=new ht(Cy,n.shape,r.shape);return this.compileAndRun(f,[n,r],n.dtype)},t.prototype.batchNormalization=function(n,r,a,o,i,s){var l=[n,r,a],c=null;s!=null&&(c=s.shape,l.push(s));var d=null;if(i!=null&&(d=i.shape,l.push(i)),X().getBool("WEBGL_PACK_NORMALIZATION")){var h=new G5(n.shape,r.shape,a.shape,c,d,o);return this.compileAndRun(h,l)}var f=new H5(n.shape,r.shape,a.shape,c,d,o);return this.compileAndRun(f,l)},t.prototype.localResponseNormalization4D=function(n,r,a,o,i){var s=X().getBool("WEBGL_PACK_NORMALIZATION")?new UA(n.shape,r,a,o,i):new zA(n.shape,r,a,o,i);return this.compileAndRun(s,[n])},t.prototype.LRNGrad=function(n,r,a,o,i,s,l){var c=new $A(r.shape,o,i,s,l);return this.compileAndRun(c,[r,a,n])},t.prototype.tile=function(n,r){if(n.dtype==="string"){var a=this.readSync(n.dataId).map(function(i){return nc(i)});return mN(De(n.shape,n.dtype,a),r)}var o=new dD(n.shape,r);return this.compileAndRun(o,[n])},t.prototype.pad=function(n,r,a){var o=X().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new XA(n.shape,r,a):new KA(n.shape,r,a);return this.compileAndRun(o,[n])},t.prototype.transpose=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.transpose(n,r);var a=X().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new fD(n.shape,r):new hD(n.shape,r);return this.compileAndRun(a,[n])},t.prototype.gather=function(n,r,a){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.gather(n,r,a);var o=new bA(n.shape,r.size,a);return this.compileAndRun(o,[n,r])},t.prototype.batchToSpaceND=function(n,r,a){D(n.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var o=r.reduce(function(h,f){return h*f}),i=lc(n.shape,r,o),s=uc(i.length,r.length),l=cc(n.shape,r,o),c=nN(a,r.length),d=rN(l,a,r.length);return n.reshape(i).transpose(s).reshape(l).slice(c,d)},t.prototype.spaceToBatchND=function(n,r,a){D(n.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var o=r.reduce(function(f,p){return f*p}),i=[[0,0]];i.push.apply(i,a);for(var s=1+r.length;s<n.shape.length;++s)i.push([0,0]);var l=n.pad(i),c=lc(l.shape,r,o,!1),d=uc(c.length,r.length,!1),h=cc(l.shape,r,o,!1);return l.reshape(c).transpose(d).reshape(h)},t.prototype.reduce=function(n,r,a){var o=n.shape[0],i=n.shape[1],s=nh(i),l=new YA({windowSize:s,inSize:i,batchSize:o},r),c=this.compileAndRun(l,[n],a);return c.shape[1]===1?c:this.reduce(c,r,a)},t.prototype.argReduce=function(n,r,a){a===void 0&&(a=null);var o=n.shape[0],i=n.shape[1];a!=null&&(o=a.shape[0],i=a.shape[1]);var s=nh(i),l=new M5({windowSize:s,inSize:i,batchSize:o},r,a==null),c=[n];a!=null&&c.push(a);var d=this.compileAndRun(l,c,"int32");return d.shape[1]===1?d:this.argReduce(n,r,d)},t.prototype.argReducePacked=function(n,r,a){a===void 0&&(a=null);var o=a!=null?a.shape:n.shape,i=nh(o[o.length-1]),s=new U5(o,i,r,a==null),l=a==null?[n]:[n,a],c=this.compileAndRun(s,l,"int32");return c.rank===n.rank?this.argReducePacked(n,r,c):c},t.prototype.sum=function(n,r){Sn("sum",r,n.rank);var a=Yt(n.shape,r),o=a[0],i=me(a[1]),s=n.as2D(-1,i),l=Kd(n.dtype);return this.reduce(s,"sum",l).reshape(o)},t.prototype.prod=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.prod(n,r);var a=Yt(n.shape,r),o=a[0],i=me(a[1]),s=n.as2D(-1,i),l=Kd(n.dtype);return this.reduce(s,"prod",l).reshape(o)},t.prototype.unsortedSegmentSum=function(n,r,a){var o=0,i=Pr([o],n.rank),s=n;i!=null&&(s=n.transpose(i),o=Fr(1,n.rank)[0]);var l=function(p,v,g){for(var y=[],m=p.length,x=0;x<m;x++)x!==v?y.push(p[x]):y.push(g);return y}(s.shape,o,a),c=me([s.shape[o]]),d=s.as2D(-1,c),h=Kd(n.dtype),f=this.segOpCompute(d,"unsortedSegmentSum",r,h,a).reshape(l);return i!=null&&(f=f.transpose(cm(i))),f},t.prototype.segOpCompute=function(n,r,a,o,i){var s=n.shape[0],l=n.shape[1],c=function(f,p){var v,g=!1;for(f<=oN?(v=f,g=!0):v=If(f,Math.floor(Math.sqrt(f)));!g;)v>p||v===f?g=!0:v=If(f,v+1);return v}(l,i),d=new oD({windowSize:c,inSize:l,batchSize:s,numSegments:i}),h=this.compileAndRun(d,[n,a],o);return h.shape[1]===i?h:(a=sc(0,i).tile([l/c]),this.segOpCompute(h,r,a,o,i))},t.prototype.argMinMaxReduce=function(n,r,a){var o=[r];if(Sn("arg"+a.charAt(0).toUpperCase()+a.slice(1),o,n.rank),!X().getBool("WEBGL_PACK_REDUCE")||n.rank<=2){var i=Yt(n.shape,o),s=i[0],l=me(i[1]),c=n.as2D(-1,l);return this.argReduce(c,a).reshape(s)}return this.argReducePacked(n,a)},t.prototype.argMin=function(n,r){return this.argMinMaxReduce(n,r,"min")},t.prototype.argMax=function(n,r){return this.argMinMaxReduce(n,r,"max")},t.prototype.cumsum=function(n,r,a,o){if(r!==n.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(n.rank-1)+" but got axis="+r);var i=new lA(n.shape,a,o);return this.compileAndRun(i,[n])},t.prototype.equal=function(n,r){if(X().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(equal(a, b));
`,"bool");var a=new ht("return float(a == b);",n.shape,r.shape);return this.compileAndRun(a,[n,r],"bool")},t.prototype.notEqual=function(n,r){if(X().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(notEqual(a, b));
`,"bool");var a=new ht("return float(a != b);",n.shape,r.shape);return this.compileAndRun(a,[n,r],"bool")},t.prototype.less=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.less(n,r);if(X().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThan(a, b));
`,"bool");var a=new ht("return float(a < b);",n.shape,r.shape);return this.compileAndRun(a,[n,r],"bool")},t.prototype.lessEqual=function(n,r){if(X().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var a=new ht("return float(a <= b);",n.shape,r.shape);return this.compileAndRun(a,[n,r],"bool")},t.prototype.greater=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.greater(n,r);if(X().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThan(a, b));
`,"bool");var a=new ht("return float(a > b);",n.shape,r.shape);return this.compileAndRun(a,[n,r],"bool")},t.prototype.greaterEqual=function(n,r){if(X().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var a=new ht("return float(a >= b);",n.shape,r.shape);return this.compileAndRun(a,[n,r],"bool")},t.prototype.logicalNot=function(n){var r=new Me(n.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[n])},t.prototype.logicalAnd=function(n,r){if(X().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var a=new ht("return float(a >= 1.0 && b >= 1.0);",n.shape,r.shape);return this.compileAndRun(a,[n,r],"bool")},t.prototype.logicalOr=function(n,r){if(X().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var a=new ht("return float(a >= 1.0 || b >= 1.0);",n.shape,r.shape);return this.compileAndRun(a,[n,r],"bool")},t.prototype.select=function(n,r,a){var o=new iD(n.rank,r.shape,r.rank);return this.compileAndRun(o,[n,r,a],Vt(r.dtype,a.dtype))},t.prototype.where=function(n){oc("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=n.dataSync();return xm(n.shape,r)},t.prototype.topk=function(n,r,a){return vN(n.dataSync(),n.shape,n.dtype,r)},t.prototype.min=function(n,r){Sn("min",r,n.rank);var a=Yt(n.shape,r),o=a[0],i=me(a[1]),s=n.as2D(-1,i);return this.reduce(s,"min",s.dtype).reshape(o)},t.prototype.minimum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.minimum(n,r);var a=X().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $r(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new ht(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,n.shape,r.shape);return this.compileAndRun(a,[n,r])},t.prototype.mod=function(n,r){var a=X().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $r(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new ht(`if (b == 0.0) return NAN;
  return mod(a, b);`,n.shape,r.shape);return this.compileAndRun(a,[n,r])},t.prototype.max=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.max(n,r);Sn("max",r,n.rank);var a=Yt(n.shape,r),o=a[0],i=me(a[1]),s=n.as2D(-1,i);return this.reduce(s,"max",s.dtype).reshape(o)},t.prototype.maximum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.maximum(n,r);var a=X().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $r(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new ht(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,n.shape,r.shape);return this.compileAndRun(a,[n,r])},t.prototype.all=function(n,r){Sn("all",r,n.rank);var a=Yt(n.shape,r),o=a[0],i=me(a[1]),s=n.as2D(-1,i);return this.reduce(s,"all",s.dtype).reshape(o)},t.prototype.any=function(n,r){Sn("any",r,n.rank);var a=Yt(n.shape,r),o=a[0],i=me(a[1]),s=n.as2D(-1,i);return this.reduce(s,"any",s.dtype).reshape(o)},t.prototype.realDivide=function(n,r){if(X().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var a=new ht(`
if (a == b) {
  return 1.0;
};
return a / b;`,n.shape,r.shape);return this.compileAndRun(a,[n,r],"float32")},t.prototype.floorDiv=function(n,r){if(X().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var a=new ht(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,n.shape,r.shape);return this.compileAndRun(a,[n,r],"int32")},t.prototype.add=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,rh);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.add(n,r);var a=Vt(n.dtype,r.dtype);if(X().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,rh,a);var o=new ht(rh,n.shape,r.shape);return this.compileAndRun(o,[n,r],a)},t.prototype.packedUnaryOp=function(n,r,a){var o=new hs(n.shape,r);return this.compileAndRun(o,[n],a)},t.prototype.packedBinaryOp=function(n,r,a,o,i){i===void 0&&(i=!1);var s=new $r(a,n.shape,r.shape,i);return this.compileAndRun(s,[n,r],o)},t.prototype.complexSeparableBinaryOp=function(n,r,a){var o=this,i=this.texData.get(n.dataId),s=this.texData.get(r.dataId),l=[[i.complexTensors.real,s.complexTensors.real],[i.complexTensors.imag,s.complexTensors.imag]].map(function(f){var p=f[0],v=f[1],g=o.makeComplexComponentTensorInfo(n,p),y=o.makeComplexComponentTensorInfo(r,v),m=new ht(a,n.shape,r.shape);return o.compileAndRun(m,[g,y],Vt(p.dtype,v.dtype))}),c=l[0],d=l[1],h=this.complex(c,d);return c.dispose(),d.dispose(),h},t.prototype.makeComplexComponentTensorInfo=function(n,r){return{dataId:r.dataId,dtype:r.dtype,shape:n.shape}},t.prototype.addN=function(n){if(n.length===1)return n[0];if(n.length>X().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(n.length/2),a=this.addN(n.slice(0,r)),o=this.addN(n.slice(r));return this.addN([a,o])}var i=n.map(function(c){return c.dtype}).reduce(function(c,d){return Vt(c,d)}),s=n.map(function(c){return c.shape}),l=X().getBool("WEBGL_PACK")?new F5(n[0].shape,s):new P5(n[0].shape,s);return this.compileAndRun(l,n,i)},t.prototype.subtract=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,ah);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.subtract(n,r);var a=Vt(n.dtype,r.dtype);if(X().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,ah,n.dtype);var o=new ht(ah,n.shape,r.shape);return this.compileAndRun(o,[n,r],a)},t.prototype.pow=function(n,r){var a=X().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $r(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new ht(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,n.shape,r.shape),o=Vt(n.dtype,r.dtype);return this.compileAndRun(a,[n,r],o)},t.prototype.ceil=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.ceil(n);if(X().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,Fy,n.dtype);var r=new Me(n.shape,Fy);return this.compileAndRun(r,[n])},t.prototype.floor=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.floor(n);if(X().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,My,n.dtype);var r=new Me(n.shape,My);return this.compileAndRun(r,[n])},t.prototype.sign=function(n){var r=new Me(n.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[n])},t.prototype.isNaN=function(n){var r=new Me(n.shape,"return float(isnan(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isInf=function(n){var r=new Me(n.shape,"return float(isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isFinite=function(n){var r=new Me(n.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.round=function(n){var r=new Me(n.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[n])},t.prototype.exp=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.exp(n);if(X().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,Oy,n.dtype);var r=new Me(n.shape,Oy);return this.compileAndRun(r,[n])},t.prototype.expm1=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.expm1(n);if(X().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,Ly,n.dtype);var r=new Me(n.shape,Ly);return this.compileAndRun(r,[n])},t.prototype.softmax=function(n,r){var a=Dt([r],n.shape),o=this.max(n,a),i=Cn(o.shape,a),s=this.subtract(n,o.reshape(i)),l=this.exp(s),c=this.sum(l,a).reshape(i);return this.realDivide(l,c)},t.prototype.log=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.log(n);if(X().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,n.dtype);var r=new Me(n.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[n])},t.prototype.log1p=function(n){var r=new Me(n.shape,"return log(1.0 + x);");return this.compileAndRun(r,[n])},t.prototype.sqrt=function(n){var r=new Me(n.shape,"return sqrt(x);");return this.compileAndRun(r,[n])},t.prototype.rsqrt=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.rsqrt(n);var r=new Me(n.shape,"return inversesqrt(x);");return this.compileAndRun(r,[n])},t.prototype.reciprocal=function(n){var r=new Me(n.shape,"return 1.0 / x;");return this.compileAndRun(r,[n])},t.prototype.relu=function(n){var r;return r=X().getBool("WEBGL_PACK")?new hs(n.shape,jN):new Me(n.shape,NN),this.compileAndRun(r,[n])},t.prototype.relu6=function(n){var r;return r=X().getBool("WEBGL_PACK")?new hs(n.shape,SN):new Me(n.shape,CN),this.compileAndRun(r,[n])},t.prototype.prelu=function(n,r){var a=X().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $r(wN,n.shape,r.shape):new ht(bN,n.shape,r.shape);return this.compileAndRun(a,[n,r])},t.prototype.elu=function(n){if(X().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,EN,n.dtype);var r=new Me(n.shape,kN);return this.compileAndRun(r,[n])},t.prototype.eluDer=function(n,r){var a=X().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $r(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,n.shape,r.shape):new ht("return (b >= 1.0) ? a : a * (b + 1.0);",n.shape,r.shape);return this.compileAndRun(a,[n,r])},t.prototype.selu=function(n){var r=new Me(n.shape,mD);return this.compileAndRun(r,[n])},t.prototype.int=function(n){var r=new Me(n.shape,"return float(int(x));");return this.compileAndRun(r,[n],"int32")},t.prototype.clip=function(n,r,a){var o,i=(o=X().getBool("WEBGL_PACK_CLIP")?new Y5(n.shape):new X5(n.shape)).getCustomSetupFunc(r,a);return this.compileAndRun(o,[n],null,i)},t.prototype.abs=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.abs(n);if(X().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,Ty,n.dtype);var r=new Me(n.shape,Ty);return this.compileAndRun(r,[n])},t.prototype.complexAbs=function(n){var r=this.texData.get(n.dataId),a=new Q5(n.shape),o=[this.makeComplexComponentTensorInfo(n,r.complexTensors.real),this.makeComplexComponentTensorInfo(n,r.complexTensors.imag)];return this.compileAndRun(a,o)},t.prototype.sigmoid=function(n){var r=new Me(n.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[n])},t.prototype.softplus=function(n){var r=new Me(n.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[n])},t.prototype.sin=function(n){var r=new Me(n.shape,vD);return this.compileAndRun(r,[n])},t.prototype.cos=function(n){var r=new Me(n.shape,gD);return this.compileAndRun(r,[n])},t.prototype.tan=function(n){var r=new Me(n.shape,"return tan(x);");return this.compileAndRun(r,[n])},t.prototype.asin=function(n){var r=new Me(n.shape,xD);return this.compileAndRun(r,[n])},t.prototype.acos=function(n){var r=new Me(n.shape,yD);return this.compileAndRun(r,[n])},t.prototype.atan=function(n){var r=new Me(n.shape,bD);return this.compileAndRun(r,[n])},t.prototype.atan2=function(n,r){var a=X().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $r(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new ht(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,n.shape,r.shape);return this.compileAndRun(a,[n,r])},t.prototype.sinh=function(n){var r=new Me(n.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.cosh=function(n){var r=new Me(n.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.tanh=function(n){var r=new Me(n.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[n])},t.prototype.asinh=function(n){var r=new Me(n.shape,wD);return this.compileAndRun(r,[n])},t.prototype.acosh=function(n){var r=new Me(n.shape,ND);return this.compileAndRun(r,[n])},t.prototype.atanh=function(n){var r=new Me(n.shape,CD);return this.compileAndRun(r,[n])},t.prototype.erf=function(n){var r=new Me(n.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[n])},t.prototype.step=function(n,r){var a=new Me(n.shape,function(o){return o===void 0&&(o=0),dr+`
    return x > 0.0 ? 1.0 : float(`+o+`);
  `}(r));return this.compileAndRun(a,[n])},t.prototype.conv2dByMatMul=function(n,r,a,o,i,s){var l=n.shape,c=this.texData.get(n.dataId),d=a.inChannels,h=l[0]*l[1]*l[2],f=a.outChannels,p=a.dataFormat==="channelsLast",v=(h===1||f===1)&&d>1e3,g=l[2]%2!=0&&!!c.isPacked;if(v||!X().getBool("WEBGL_LAZILY_UNPACK")||!X().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!g){var y=p?l[0]*l[1]*l[2]:l[0]*l[2]*l[3],m=this.reshape(n,[1,y,a.inChannels]),x=this.reshape(r,[1,a.inChannels,a.outChannels]);return this.reshape(this.fusedBatchMatMul({a:m,b:x,transposeA:!1,transposeB:!1,bias:o,activation:i,preluActivationWeights:s}),a.outShape)}var b=p?l[0]*l[1]*(l[2]+1):l[0]*l[2]*(l[3]+1),w={dataId:n.dataId,shape:[1,b,a.inChannels],dtype:n.dtype},N=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,D(Kl(c.shape,w.shape),function(){return"packed reshape "+c.shape+" to "+w.shape+" isn't free"});var C=this.reshape(r,[1,a.inChannels,a.outChannels]),S=this.fusedBatchMatMul({a:w,b:C,transposeA:!1,transposeB:!1,bias:o,activation:i,preluActivationWeights:s}),k=this.texData.get(S.dataId);return D(k.isPacked,function(){return"batchMatMul result is expected to be packed"}),c.shape=N,k.shape=a.outShape,O.makeTensorFromDataId(S.dataId,a.outShape,S.dtype)},t.prototype.conv2dWithIm2Row=function(n,r,a,o,i,s){var l=a.filterWidth,c=a.filterHeight,d=a.inChannels,h=a.outWidth,f=a.outHeight,p=a.dataFormat==="channelsLast",v=l*c*d,g=f*h,y=[v,g],m=n.squeeze([0]),x=r.reshape([1,v,-1]),b=new BA(y,m.shape,a),w=this.compileAndRun(b,[m]).reshape([1,y[0],y[1]]),N=o!=null,C=s!=null,S=i?Jl(i,!0):null,k=new oh(w.shape,[1,g,a.outChannels],!0,!1,N,S,C),_=[w,x];o&&_.push(o),C&&_.push(s);var E=this.compileAndRun(k,_);return p?E.reshape([1,f,h,a.outChannels]):E.reshape([1,a.outChannels,f,h])},t.prototype.fusedConv2d=function(n){var r=n.input,a=n.filter,o=n.convInfo,i=n.bias,s=n.activation,l=n.preluActivationWeights;if(o.filterHeight===1&&o.filterWidth===1&&o.dilationHeight===1&&o.dilationWidth===1&&o.strideHeight===1&&o.strideWidth===1&&(o.padInfo.type==="SAME"||o.padInfo.type==="VALID"))return this.conv2dByMatMul(r,a,o,i,s,l);if(X().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,a,o,i,s,l);var c=i!=null,d=l!=null,h=s?Jl(s,!1):null,f=new ky(o,c,h,d),p=[r,a];return i&&p.push(i),l&&p.push(l),this.compileAndRun(f,p)},t.prototype.conv2d=function(n,r,a){if(a.filterHeight===1&&a.filterWidth===1&&a.dilationHeight===1&&a.dilationWidth===1&&a.strideHeight===1&&a.strideWidth===1&&(a.padInfo.type==="SAME"||a.padInfo.type==="VALID"))return this.conv2dByMatMul(n,r,a);if(X().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,r,a);var o=new ky(a);return this.compileAndRun(o,[n,r])},t.prototype.conv2dDerInput=function(n,r,a){var o=new tA(a);return this.compileAndRun(o,[n,r])},t.prototype.conv2dDerFilter=function(n,r,a){var o=new eA(a);return this.compileAndRun(o,[n,r])},t.prototype.fusedDepthwiseConv2D=function(n){var r,a=n.input,o=n.filter,i=n.convInfo,s=n.bias,l=n.activation,c=n.preluActivationWeights,d=X().getBool("WEBGL_PACK_DEPTHWISECONV")&&i.strideWidth<=2&&i.outChannels/i.inChannels==1,h=l?Jl(l,d):null,f=[a,o],p=s!=null,v=c!=null;return p&&f.push(s),v&&f.push(c),d?(r=new Sy(i,p,h,v),this.compileAndRun(r,f)):(r=new jy(i,p,h,v),this.compileAndRun(r,f))},t.prototype.depthwiseConv2D=function(n,r,a){var o;return X().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1?(o=new Sy(a),this.compileAndRun(o,[n,r])):(o=new jy(a),this.compileAndRun(o,[n,r]))},t.prototype.depthwiseConv2DDerInput=function(n,r,a){var o=new oA(a);return this.compileAndRun(o,[n,r])},t.prototype.depthwiseConv2DDerFilter=function(n,r,a){var o=new aA(a);return this.compileAndRun(o,[n,r])},t.prototype.conv3d=function(n,r,a){var o=new iA(a);return this.compileAndRun(o,[n,r])},t.prototype.conv3dDerInput=function(n,r,a){var o=new rA(a);return this.compileAndRun(o,[n,r])},t.prototype.conv3dDerFilter=function(n,r,a){var o=new nA(a);return this.compileAndRun(o,[n,r])},t.prototype.maxPool=function(n,r){var a=new ih(r,"max",!1);return this.compileAndRun(a,[n])},t.prototype.avgPool=function(n,r){var a=new ih(r,"avg",!1);return this.compileAndRun(a,[n],"float32")},t.prototype.maxPoolBackprop=function(n,r,a,o){var i=new ih(o,"max",!0),s=this.compileAndRun(i,[r]),l=new WA(o),c=this.compileAndRun(l,[n,s],r.dtype);return s.dispose(),c},t.prototype.avgPoolBackprop=function(n,r,a){var o=new W5(a);return this.compileAndRun(o,[n],r.dtype)},t.prototype.cast=function(n,r){return dN(n,r,this)},t.prototype.unstack=function(n,r){for(var a=n.shape[r],o=new Array(n.rank-1),i=0,s=0;s<n.rank;s++)s!==r&&(o[i++]=n.shape[s]);var l=new Array(n.rank).fill(0),c=n.shape.slice();c[r]=1;var d=new Array(a);for(s=0;s<d.length;s++)l[r]=s,d[s]=this.slice(n,l,c).reshape(o);return d},t.prototype.avgPool3d=function(n,r){var a=new sh(r,"avg",!1);return this.compileAndRun(a,[n],"float32")},t.prototype.avgPool3dBackprop=function(n,r,a){var o=new V5(a);return this.compileAndRun(o,[n],r.dtype)},t.prototype.maxPool3d=function(n,r){var a=new sh(r,"max",!1);return this.compileAndRun(a,[n],"float32")},t.prototype.maxPool3dBackprop=function(n,r,a,o){var i=new sh(o,"max",!0),s=this.compileAndRun(i,[r]),l=new VA(o),c=this.compileAndRun(l,[n,s],r.dtype);return s.dispose(),c},t.prototype.reshape=function(n,r){var a=this.texData.get(n.dataId);if(a.isPacked&&!Kl(n.shape,r)&&(a.texture===null||!Kl(a.shape,r))){var o=this.packedReshape(n,r);return O.makeTensorFromDataId(o.dataId,o.shape,o.dtype)}return Lf(n,r)},t.prototype.resizeBilinear=function(n,r,a,o){var i=X().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new eD(n.shape,r,a,o):new ZA(n.shape,r,a,o);return this.compileAndRun(i,[n],"float32")},t.prototype.resizeBilinearBackprop=function(n,r,a){var o=new JA(n,r,a);return this.compileAndRun(o,[n])},t.prototype.resizeNearestNeighbor=function(n,r,a,o){var i=new nD(n.shape,r,a,o);return this.compileAndRun(i,[n])},t.prototype.resizeNearestNeighborBackprop=function(n,r,a){var o=new tD(n,r,a);return this.compileAndRun(o,[n])},t.prototype.multinomial=function(n,r,a,o){var i=r?n:ia(n),s=i.shape[0],l=i.shape[1],c=new HA(s,l,a),d=c.getCustomSetupFunc(o);return this.compileAndRun(c,[i],"int32",d)},t.prototype.oneHot=function(n,r,a,o){var i=new GA(n.size,r,a,o);return this.compileAndRun(i,[n])},t.prototype.diag=function(n){var r=new hA(n.size);return this.compileAndRun(r,[n])},t.prototype.nonMaxSuppression=function(n,r,a,o,i){return oc("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),vm(n.dataSync(),r.dataSync(),a,o,i)},t.prototype.cropAndResize=function(n,r,a,o,i,s){var l=new sA(n.shape,r.shape,o,i,s);return this.compileAndRun(l,[n,r,a],"float32")},t.prototype.depthToSpace=function(n,r,a){D(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var o=n.shape[0],i=a==="NHWC"?n.shape[1]:n.shape[2],s=a==="NHWC"?n.shape[2]:n.shape[3],l=a==="NHWC"?n.shape[3]:n.shape[1],c=i*r,d=s*r,h=l/(r*r),f=new dA(a==="NHWC"?[o,c,d,h]:[o,h,c,d],r,a);return this.compileAndRun(f,[n])},t.prototype.split=function(n,r,a){return pN(n,r,a)},t.prototype.scatterND=function(n,r,a){var o=dc(0,n,a),i=o.sliceRank,s=o.numUpdates,l=o.sliceSize,c=o.strides,d=o.outputSize,h=[d/l,l],f=n.reshape([s,i]),p=r.reshape([s,l]);if(d===0)return Lf(Ht([]),a);var v=le(0),g=new Iy(s,i,f.rank,p.rank,c,h);return this.compileAndRun(g,[p,f,v]).reshape(a)},t.prototype.sparseToDense=function(n,r,a,o){var i=dc(0,n,a),s=i.sliceRank,l=i.numUpdates,c=i.strides,d=i.outputSize,h=new Iy(l,s,n.rank,r.rank,c,[d,1]);return this.compileAndRun(h,[r,n,o]).reshape(a)},t.prototype.fft=function(n){return this.fftImpl(n,!1)},t.prototype.ifft=function(n){return this.fftImpl(n,!0)},t.prototype.fftImpl=function(n,r){var a=this.texData.get(n.dataId),o=new _y(gA,n.shape,r),i=new _y(xA,n.shape,r),s=[this.makeComplexComponentTensorInfo(n,a.complexTensors.real),this.makeComplexComponentTensorInfo(n,a.complexTensors.imag)],l=this.compileAndRun(o,s),c=this.compileAndRun(i,s),d=this.complex(l,c).as2D(n.shape[0],n.shape[1]);return l.dispose(),c.dispose(),d},t.prototype.gatherND=function(n,r){var a=r.shape,o=a[a.length-1],i=aN(n,r),s=i[0],l=i[1],c=i[2],d=i[3],h=r.reshape([l,o]),f=n.reshape([n.size/c,c]),p=new wA(o,d,[l,c]);return this.compileAndRun(p,[f,h]).reshape(s)},t.prototype.fill=function(n,r,a){if((a=a||fl(r))==="string"){var o=tc(a,me(n));return o.fill(r),O.makeTensor(o,n,a,this)}var i=new yA(n,r),s=i.getCustomSetupFunc(r);return this.compileAndRun(i,[],a,s)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){return this.fill(n.shape,n.dtype==="string"?"":0,n.dtype)},t.prototype.linspace=function(n,r,a){return hN(n,r,a)},t.prototype.makeTensorInfo=function(n,r){var a=this.write(null,n,r);return this.texData.get(a).usage=null,{dataId:a,shape:n,dtype:r}},t.prototype.makeOutput=function(n,r){var a=this.makeTensorInfo(n,r).dataId;return O.makeTensorFromDataId(a,n,r,this)},t.prototype.unpackTensor=function(n){var r=new jD(n.shape);return this.runWebGLProgram(r,[n],n.dtype)},t.prototype.packTensor=function(n){var r=new qA(n.shape);return this.runWebGLProgram(r,[n],n.dtype,null,!0)},t.prototype.packedReshape=function(n,r){var a=[rc(n.shape)].concat(ac(n.shape)),o={dtype:n.dtype,shape:a,dataId:n.dataId},i=[rc(r)].concat(ac(r)),s=new QA(i,a),l=this.runWebGLProgram(s,[o],n.dtype,null,!0);return{dataId:l.dataId,shape:r,dtype:l.dtype}},t.prototype.decode=function(n){var r,a=this.texData.get(n),o=a.isPacked,i=a.shape,s=a.dtype,l=th(i);return r=o?new cA(l):new uA(l),{dtype:s,shape:i,dataId:this.runWebGLProgram(r,[{shape:l,dtype:s,dataId:n}],s,null,!0).dataId}},t.prototype.runWebGLProgram=function(n,r,a,o,i){var s=this;i===void 0&&(i=!1);var l=this.makeTensorInfo(n.outputShape,a),c=this.texData.get(l.dataId);if(n.packedOutput&&(c.isPacked=!0),n.outPackingScheme===Qs.DENSE){var d=Ss(n.outputShape);c.texShape=d.map(function(b){return 2*b})}if(n.outTexUsage!=null&&(c.usage=n.outTexUsage),me(l.shape)===0)return c.values=Xs(l.dtype,0),l;var h=[],f=r.map(function(b){if(b.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var w=s.texData.get(b.dataId);if(w.texture==null){if(!n.packedInputs&&me(b.shape)<=X().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:b.shape,texData:null,isUniform:!0,uniformValues:w.values};n.packedInputs&&(w.isPacked=!0,w.shape=b.shape)}else if(!!w.isPacked!=!!n.packedInputs)b=w.isPacked?s.unpackTensor(b):s.packTensor(b),h.push(b),w=s.texData.get(b.dataId);else if(w.isPacked&&!Kl(w.shape,b.shape)){var N=b,C=b.shape;b.shape=w.shape,b=s.packedReshape(b,C),h.push(b),w=s.texData.get(b.dataId),N.shape=C}return s.uploadToGPU(b.dataId),{shape:b.shape,texData:w,isUniform:!1}});this.uploadToGPU(l.dataId);var p,v={shape:l.shape,texData:c,isUniform:!1},g=function(b,w,N){var C="";w.concat(N).forEach(function(_){var E=_.texData!=null&&_.texData.slice!=null&&_.texData.slice.flatOffset>0,j=_.isUniform?"uniform":_.texData.texShape;C+=_.shape+"_"+j+"_"+E});var S=b.userCode,k=b.constructor.name;return k+="_"+C+"_"+S}(n,f,v),y=this.getAndSaveBinary(g,function(){return function(b,w,N,C){var S=w.userCode,k=N.map(function(M,U){var H={logicalShape:M.shape,texShape:M.isUniform?null:M.texData.texShape,isUniform:M.isUniform,isPacked:!M.isUniform&&M.texData.isPacked,flatOffset:null};return M.texData!=null&&M.texData.slice!=null&&M.texData.slice.flatOffset>0&&(H.flatOffset=M.texData.slice.flatOffset),{name:w.variableNames[U],shapeInfo:H}}),_=k.map(function(M){return M.shapeInfo}),E={logicalShape:C.shape,texShape:C.texData.texShape,isUniform:!1,isPacked:C.texData.isPacked,flatOffset:null},j=O5(k,E,S,w.packedInputs),T=b.createProgram(j),L=null,P=b.getUniformLocation(T,"NAN",!1);X().getNumber("WEBGL_VERSION")===1&&(L=b.getUniformLocation(T,"INFINITY",!1));for(var B={},K=0;K<w.variableNames.length;K++){var z=w.variableNames[K];B[z]=b.getUniformLocation(T,z,!1),B["offset"+z]=b.getUniformLocation(T,"offset"+z,!1)}return{program:w,source:j,webGLProgram:T,uniformLocations:B,inShapeInfos:_,outShapeInfo:E,infLoc:L,nanLoc:P}}(s.gpgpu,n,f,v)}),m=this.activeTimers!=null;if(m&&(p=this.startTimer()),function(b,w,N,C,S){Ry(w.inShapeInfos,N),Ry([w.outShapeInfo],[C]);var k=C.texData.texture,_=C.texData.texShape;C.texData.isPacked?b.setOutputPackedMatrixTexture(k,_[0],_[1]):b.setOutputMatrixTexture(k,_[0],_[1]),b.setProgram(w.webGLProgram),X().getNumber("WEBGL_VERSION")===1&&w.infLoc!==null&&b.gl.uniform1f(w.infLoc,1/0),w.nanLoc!==null&&b.gl.uniform1f(w.nanLoc,NaN),N.forEach(function(E,j){var T=w.program.variableNames[j],L=w.uniformLocations[T],P=w.uniformLocations["offset"+T];if(L!=null)if(E.isUniform)if(me(E.shape)<2)b.gl.uniform1f(L,E.uniformValues[0]);else{var B=E.uniformValues;B instanceof Float32Array||(B=new Float32Array(B)),b.gl.uniform1fv(L,B)}else E.texData.slice!=null&&P!=null&&b.gl.uniform1i(P,E.texData.slice.flatOffset),b.setInputMatrixTexture(E.texData.texture,L,j)}),S!=null&&S(b,w.webGLProgram),b.executeProgram()}(this.gpgpu,y,f,v,o),h.forEach(function(b){return s.disposeData(b.dataId)}),m&&(p=this.endTimer(p),this.activeTimers.push({name:n.constructor.name,query:this.getQueryTime(p)})),!X().getBool("WEBGL_LAZILY_UNPACK")&&c.isPacked&&i===!1){var x=this.unpackTensor(l);return this.disposeData(l.dataId),x}return l},t.prototype.compileAndRun=function(n,r,a,o,i){i===void 0&&(i=!1),a=a||r[0].dtype;var s=this.runWebGLProgram(n,r,a,o,i);return O.makeTensorFromDataId(s.dataId,s.shape,s.dtype)},t.prototype.getAndSaveBinary=function(n,r){return n in this.binaryCache||(this.binaryCache[n]=r()),this.binaryCache[n]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var n=this;this.disposed||(X().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){n.gpgpu.deleteProgram(n.binaryCache[r].webGLProgram),delete n.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var n=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ce(function(){if(!X().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=X().getBool("DEBUG");X().set("DEBUG",!1);var a=n.abs(le(1e-8)).dataSync()[0];if(X().set("DEBUG",r),a>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(n){var r,a=this.texData.get(n),o=a.shape,i=a.dtype,s=a.values,l=a.texture,c=a.usage,d=a.isPacked;if(l==null){var h,f=this.activeTimers!=null;f&&(h=xr());var p=a.texShape;if(p==null&&(p=TI(o,d),a.texShape=p),s!=null){var v=th(o),g=void 0,y=p[1],m=p[0],x=s instanceof Uint8Array;d?(y=(r=ml(p[0],p[1]))[0],m=r[1],g=new vA(v,[m,y],x)):g=new mA(v,[m,y],x);var b=this.makeTensorInfo([m,y],i);this.texData.get(b.dataId).usage=x?Rn.PIXELS:Rn.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),y,m,s);var w=this.runWebGLProgram(g,[b],i,null,!0),N=this.texData.get(w.dataId);a.texture=N.texture,a.texShape=N.texShape,a.isPacked=N.isPacked,a.usage=N.usage,this.disposeData(b.dataId),this.texData.delete(w.dataId),a.values=null,f&&(this.uploadWaitMs+=xr()-h)}else{var C=this.acquireTexture(p,c,i,d);a.texture=C}}},t.prototype.convertAndCacheOnCPU=function(n,r){var a=this.texData.get(n),o=a.dtype;return this.releaseGPUData(n),r!=null&&(a.values=function(i,s){if(s==="float32"||s==="complex64")return i;if(s==="int32"||s==="bool"){for(var l=s==="int32"?new Int32Array(i.length):new Uint8Array(i.length),c=0;c<l.length;++c)l[c]=Math.round(i[c]);return l}throw new Error("Unknown dtype "+s)}(r,o)),a.values},t.prototype.acquireTexture=function(n,r,a,o){if(this.numBytesInGPU+=this.computeBytes(n,a),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+i+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(n,r,o)},t.prototype.computeBytes=function(n,r){return n[0]*n[1]*zw(r)},t}(uN);qw()&&O.registerBackend("webgl",function(){return new ED},2);var _D=F({square_:function(e){var t=R(e,"x","square"),n=[t];return O.runKernelFunc(function(r,a){return a([t]),r.square(t)},{x:t},null,"Square",{},n,[])}}),Zs="SquaredDifference",_N=F({squaredDifference_:function(e,t){var n,r=R(e,"a","squaredDifference"),a=R(t,"b","squaredDifference");n=dt(r,a),r=n[0],a=n[1],ze(r.shape,a.shape);var o={a:r,b:a},i=[r,a];return O.runKernelFunc(function(s,l){var c=s.squaredDifference(r,a);return l([r,a]),c},o,function(s,l){var c=l[0],d=l[1],h=le(2);return{a:function(){return s.mul(c.sub(d).mul(h))},b:function(){return s.mul(d.sub(c).mul(h))}}},Zs,{},i,[])}}),RD=F({abs_:function(e){var t=R(e,"x","abs");return t.dtype==="complex64"?O.runKernelFunc(function(n){return n.complexAbs(t)},{$x:t}):O.runKernelFunc(function(n,r){var a=n.abs(t);return r([t]),a},{x:t},function(n,r){var a=r[0];return{x:function(){return n.mul(a.toFloat().step(-1))}}},"Abs")}}),ID=F({acos_:function(e){var t=R(e,"x","acos");return O.runKernelFunc(function(n,r){var a=n.acos(t);return r([t]),a},{$x:t},function(n,r){var a=r[0];return{$x:function(){return n.divStrict(le(1).sub(a.toFloat().square()).sqrt()).neg()}}})}}),AD=F({acosh_:function(e){var t=R(e,"x","acosh");return O.runKernelFunc(function(n,r){var a=n.acosh(t);return r([t]),a},{$x:t},function(n,r){var a=r[0];return{$x:function(){return n.divStrict(a.toFloat().square().sub(1).sqrt())}}})}}),DD=F({asin_:function(e){var t=R(e,"x","asin");return O.runKernelFunc(function(n,r){var a=n.asin(t);return r([t]),a},{$x:t},function(n,r){var a=r[0];return{$x:function(){return n.divStrict(le(1).sub(a.toFloat().square()).sqrt())}}})}}),TD=F({asinh_:function(e){var t=R(e,"x","asinh");return O.runKernelFunc(function(n,r){var a=n.asinh(t);return r([t]),a},{$x:t},function(n,r){var a=r[0];return{$x:function(){return n.divStrict(le(1).add(a.toFloat().square()).sqrt())}}})}}),PD=F({atan_:function(e){var t=R(e,"x","atan");return O.runKernelFunc(function(n,r){var a=n.atan(t);return r([t]),a},{$x:t},function(n,r){var a=r[0];return{$x:function(){return n.div(a.toFloat().square().add(1))}}})}}),FD=F({atanh_:function(e){var t=R(e,"x","atanh");return O.runKernelFunc(function(n,r){var a=n.atanh(t);return r([t]),a},{$x:t},function(n,r){var a=r[0];return{$x:function(){return n.div(le(1).sub(a.toFloat().square()))}}})}}),MD=F({ceil_:function(e){var t=R(e,"x","ceil");return O.runKernelFunc(function(n){return n.ceil(t)},{$x:t},function(n){return{$x:function(){return Ue(n)}}})}}),Nm=F({clipByValue_:function(e,t,n){var r=R(e,"x","clipByValue");D(t<=n,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."});var a=[r],o={min:t,max:n};return O.runKernelFunc(function(i,s){var l=i.clip(r,t,n);return s([r]),l},{x:r},function(i,s){var l=s[0];return{x:function(){return i.where(l.greaterEqual(t).logicalAnd(l.lessEqual(n)),Ue(i))}}},"ClipByValue",o,a)}}),OD=F({cos_:function(e){var t=R(e,"x","cos"),n=[t];return O.runKernelFunc(function(r,a){var o=r.cos(t);return a([t]),o},{x:t},function(r,a){var o=a[0];return{x:function(){return o.toFloat().sin().neg().mul(r)}}},"Cos",{},n)}}),LD=F({cosh_:function(e){var t=R(e,"x","cosh");return O.runKernelFunc(function(n,r){var a=n.cosh(t);return r([t]),a},{$x:t},function(n,r){var a=r[0];return{$x:function(){return a.toFloat().sinh().mulStrict(n)}}})}}),BD=F({erf_:function(e){var t=R(e,"x","erf");return D(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),O.runKernelFunc(function(n,r){var a=n.erf(t);return r([t]),a},{$x:t},function(n,r){var a=r[0];return{$x:function(){return n.mul(a.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),zf=F({exp_:function(e){var t=R(e,"x","exp");return O.runKernelFunc(function(n,r){var a=n.exp(t);return r([a]),a},{x:t},function(n,r){return{x:function(){return n.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),zD=F({expm1_:function(e){var t=R(e,"x","expm1");return O.runKernelFunc(function(n,r){var a=n.expm1(t);return r([t]),a},{$x:t},function(n,r){var a=r[0];return{$x:function(){return n.mul(a.exp())}}})}}),$D=F({floor_:function(e){var t=R(e,"x","floor");return O.runKernelFunc(function(n){return n.floor(t)},{$x:t},function(n){return{$x:function(){return Ue(n)}}})}}),UD=F({log_:function(e){var t=R(e,"x","log"),n=[t];return O.runKernelFunc(function(r,a){var o=r.log(t);return a([t]),o},{x:t},function(r,a){var o=a[0];return{x:function(){return r.div(o.toFloat())}}},"Log",{},n)}}),WD=F({log1p_:function(e){var t=R(e,"x","log1p");return O.runKernelFunc(function(n,r){var a=n.log1p(t);return r([t]),a},{$x:t},function(n,r){var a=r[0];return{$x:function(){return n.div(a.add(1))}}})}}),VD=F({logSigmoid_:function(e){var t=R(e,"x","logSigmoid");return O.runKernelFunc(function(n,r){var a=n.softplus(t.neg()).neg();return r([t]),a},{$x:t},function(n,r){var a=r[0];return{$x:function(){return n.mul(a.neg().sigmoid())}}})}}),mc=F({neg_:function(e){var t=R(e,"x","neg"),n=[t];return O.runKernelFunc(function(r){return r.neg(t)},{x:t},function(r){return{x:function(){return r.neg()}}},"Neg",{},n)}}),HD=F({reciprocal_:function(e){var t=R(e,"x","reciprocal");return O.runKernelFunc(function(n,r){var a=n.reciprocal(t);return r([t]),a},{$x:t},function(n,r){var a=r[0];return{$x:function(){return n.div(a.square().neg())}}})}}),GD=F({round_:function(e){var t=R(e,"x","round");return O.runKernelFunc(function(n){return n.round(t)},{$x:t},function(n){return{$x:function(){return Ue(n)}}})}}),RN=F({rsqrt_:function(e){var t=R(e,"x","rsqrt"),n=[t];return O.runKernelFunc(function(r,a){var o=r.rsqrt(t);return a([t]),o},{x:t},function(r,a){var o=a[0];return{x:function(){return r.div(o.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),IN=F({sigmoid_:function(e){var t=R(e,"x","sigmoid");return O.runKernelFunc(function(n,r){var a=n.sigmoid(t);return r([a]),a},{x:t},function(n,r){var a=r[0];return{x:function(){return n.mul(a.mul(le(1).sub(a)))}}},"Sigmoid")}}),qD=F({sign_:function(e){var t=R(e,"x","sign");return O.runKernelFunc(function(n){return n.sign(t)},{$x:t},function(n){return{$x:function(){return Ue(n)}}})}}),KD=F({isNaN_:function(e){var t=R(e,"x","isNaN");return O.runKernelFunc(function(n){return n.isNaN(t)},{$x:t},function(n){return{$x:function(){return Ue(n)}}})}}),XD=F({isInf_:function(e){var t=R(e,"x","isInf");return O.runKernelFunc(function(n){return n.isInf(t)},{$x:t},function(n){return{$x:function(){return Ue(n)}}})}}),YD=F({isFinite_:function(e){var t=R(e,"x","isFinite");return O.runKernelFunc(function(n){return n.isFinite(t)},{$x:t},function(n){return{$x:function(){return Ue(n)}}})}}),QD=F({sin_:function(e){var t=R(e,"x","sin"),n=[t];return O.runKernelFunc(function(r,a){var o=r.sin(t);return a([t]),o},{x:t},function(r,a){var o=a[0];return{x:function(){return o.toFloat().cos().mul(r)}}},"Sin",{},n)}}),JD=F({sinh_:function(e){var t=R(e,"x","sinh");return O.runKernelFunc(function(n,r){var a=n.sinh(t);return r([t]),a},{$x:t},function(n,r){var a=r[0];return{$x:function(){return a.toFloat().cosh().mulStrict(n)}}})}}),ZD=F({softplus_:function(e){var t=R(e,"x","softplus");return O.runKernelFunc(function(n,r){var a=n.softplus(t);return r([t]),a},{$x:t},function(n,r){var a=r[0];return{$x:function(){return n.mul(a.sigmoid())}}})}}),eT=F({sqrt_:function(e){var t=R(e,"x","sqrt");return O.runKernelFunc(function(n,r){var a=n.sqrt(t);return r([t]),a},{$x:t},function(n,r){var a=r[0];return{$x:function(){return n.div(a.toFloat().sqrt().mul(2))}}})}}),tT=F({step_:function(e,t){t===void 0&&(t=0);var n=R(e,"x","step");return O.runKernelFunc(function(r){return r.step(n,t)},{$x:n},function(r){return{$x:function(){return Ue(r)}}})}}),nT=F({tan_:function(e){var t=R(e,"x","tan");return O.runKernelFunc(function(n,r){var a=n.tan(t);return r([t]),a},{$x:t},function(n,r){var a=r[0];return{$x:function(){return n.div(a.cos().square())}}})}}),rT=F({tanh_:function(e){var t=R(e,"x","tanh");return O.runKernelFunc(function(n,r){var a=n.tanh(t);return r([a]),a},{x:t},function(n,r){var a=r[0];return{x:function(){return le(1).sub(a.square()).mulStrict(n)}}},"Tanh",{},null,[!0])}});function AN(e,t,n,r,a,o){var i,s,l=R(e,"x","batchNorm"),c=R(t,"mean","batchNorm"),d=R(n,"variance","batchNorm");return a!=null&&(i=R(a,"scale","batchNorm")),r!=null&&(s=R(r,"offset","batchNorm")),D(l.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+l.rank+"."}),D(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+c.rank+"."}),D(d.rank===2||d.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+d.rank+"."}),i!=null&&D(i.rank===2||i.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+i.rank+"."}),s!=null&&D(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),gl(l,c,d,s,i,o)}function DN(e,t,n,r,a,o){var i,s,l=R(e,"x","batchNorm"),c=R(t,"mean","batchNorm"),d=R(n,"variance","batchNorm");return a!=null&&(i=R(a,"scale","batchNorm")),r!=null&&(s=R(r,"offset","batchNorm")),D(l.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+l.rank+"."}),D(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+c.rank+"."}),D(d.rank===3||d.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+d.rank+"."}),i!=null&&D(i.rank===3||i.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+i.rank+"."}),s!=null&&D(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),gl(l,c,d,s,i,o)}function TN(e,t,n,r,a,o){var i,s,l=R(e,"x","batchNorm"),c=R(t,"mean","batchNorm"),d=R(n,"variance","batchNorm");return a!=null&&(i=R(a,"scale","batchNorm")),r!=null&&(s=R(r,"offset","batchNorm")),D(l.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+l.rank+"."}),D(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+c.rank+"."}),D(d.rank===4||d.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+d.rank+"."}),i!=null&&D(i.rank===4||i.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+i.rank+"."}),s!=null&&D(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),gl(l,c,d,s,i,o)}function gl(e,t,n,r,a,o){o==null&&(o=.001);var i,s,l,c=R(e,"x","batchNorm"),d=R(t,"mean","batchNorm"),h=R(n,"variance","batchNorm");a!=null&&(i=R(a,"scale","batchNorm")),r!=null&&(s=R(r,"offset","batchNorm")),D(d.rank===h.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),D(s==null||d.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),D(i==null||d.rank===i.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),l=c.rank===0||c.rank===1?c.as4D(1,1,1,c.size):c.rank===2?c.as4D(1,1,c.shape[0],c.shape[1]):c.rank===3?c.as4D(1,c.shape[0],c.shape[1],c.shape[2]):c;var f=[c,d,h,i];return O.runKernelFunc(function(p,v){var g=p.batchNormalization(l,Zl(d),Zl(h),o,Zl(i),Zl(s));return v([c,d,h,i]),g},{x:c,mean:d,variance:h,scale:i,offset:s},function(p,v){var g=v,y=g[0],m=g[1],x=g[2],b=g[3],w=b??le(1),N=It(m.shape,l.shape),C=[];if(m.rank===1){for(var S=0;S<l.shape.length-1;++S)C.push(l.shape[S]);C.push(1)}var k=y.sub(m),_=p.mul(w),E=RN(x.add(le(o))),j=E.mul(E).mul(E).mul(le(-.5));return{x:function(){return m.rank===1?p.mul(vi(E.as4D(1,1,1,m.shape[0]),C)).mul(w).reshape(y.shape):p.mul(E).mul(w).reshape(y.shape)},mean:function(){var T=E.mul(le(-1)).mul(_);return m.rank===1&&(T=T.sum(N)),T.reshape(m.shape)},variance:function(){var T=j.mul(k).mul(_);return m.rank===1&&(T=T.sum(N)),T.reshape(m.shape)},scale:function(){var T=k.mul(E),L=p.mul(T);return m.rank===1&&(L=L.sum(N)),L.reshape(m.shape)},offset:function(){var T=p;return m.rank===1&&(T=T.sum(N)),T.reshape(m.shape)}}},"BatchNormalization",{varianceEpsilon:o},f).reshape(c.shape)}function Zl(e){return e==null?null:e.rank===0?e.as1D():e.rank===1?e:e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function Zc(){Kw("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var aT=F({batchNormalization2d_:function(e,t,n,r,a,o){return r===void 0&&(r=.001),Zc(),AN(e,t,n,o,a,r)}}),oT=F({batchNormalization3d_:function(e,t,n,r,a,o){return r===void 0&&(r=.001),Zc(),DN(e,t,n,o,a,r)}}),iT=F({batchNormalization4d_:function(e,t,n,r,a,o){return r===void 0&&(r=.001),Zc(),TN(e,t,n,o,a,r)}}),sT=F({batchNormalization_:function(e,t,n,r,a,o){return r===void 0&&(r=.001),Zc(),gl(e,t,n,o,a,r)}}),PN=F({batchNorm_:gl}),lT=F({batchNorm2d_:AN}),uT=F({batchNorm3d_:DN}),cT=F({batchNorm4d_:TN}),ed=F({logicalAnd_:function(e,t){var n=R(e,"a","logicalAnd","bool"),r=R(t,"b","logicalAnd","bool");return ze(n.shape,r.shape),O.runKernelFunc(function(a){return a.logicalAnd(n,r)},{a:n,b:r},null,"LogicalAnd")}}),dT=F({logicalNot_:function(e){var t=R(e,"x","logicalNot","bool");return O.runKernelFunc(function(n){return n.logicalNot(t)},{$x:t})}}),FN=F({logicalOr_:function(e,t){var n=R(e,"a","logicalOr","bool"),r=R(t,"b","logicalOr","bool");return ze(n.shape,r.shape),O.runKernelFunc(function(a){return a.logicalOr(n,r)},{$a:n,$b:r})}}),hT=F({logicalXor_:function(e,t){var n=R(e,"a","logicalXor","bool"),r=R(t,"b","logicalXor","bool");return ze(n.shape,r.shape),FN(e,t).logicalAnd(ed(e,t).logicalNot())}}),Ro=F({where_:function(e,t,n){var r=R(t,"a","where"),a=R(n,"b","where"),o=R(e,"condition","where","bool");return Ge(r.shape,a.shape,"Error in where: "),o.rank===1?D(o.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):Ge(o.shape,a.shape,"Error in where: "),O.runKernelFunc(function(i,s){var l=i.select(o,r,a);return s([o]),l},{$condition:o,$a:r,$b:a},function(i,s){var l=s[0];return{$condition:function(){return Ue(l).toFloat()},$a:function(){return i.mul(l.cast(i.dtype))},$b:function(){return i.mul(l.logicalNot().cast(i.dtype))}}})}}),MN=function(e){return fe(this,void 0,void 0,function(){var t,n,r;return pe(this,function(a){switch(a.label){case 0:return[4,(t=R(e,"condition","whereAsync","bool")).data()];case 1:return n=a.sent(),r=xm(t.shape,n),e!==t&&t.dispose(),[2,r]}})})},Be=F({add_:function(e,t){var n,r=R(e,"a","add"),a=R(t,"b","add");n=dt(r,a),r=n[0],a=n[1];var o=ze(r.shape,a.shape);return O.runKernelFunc(function(i){return i.add(r,a)},{a:r,b:a},function(i){return{a:function(){var s=i,l=It(r.shape,o);return l.length>0&&(s=s.sum(l)),s.reshape(r.shape)},b:function(){var s=i,l=It(a.shape,o);return l.length>0&&(s=s.sum(l)),s.reshape(a.shape)}}},"Add")}}),fT=F({addN_:function(e){D(Array.isArray(e),function(){return"The argument passed to tf.addN() must be a list of tensors"}),D(e.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length});var t=e.map(function(a,o){return R(a,"tensors"+o,"addN")}),n=t[0];t.forEach(function(a){if(a.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(a){if(!Lt(a.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=t;return O.runKernelFunc(function(a){return a.addN(t)},r,function(a){var o={};return t.forEach(function(i,s){o[s]=function(){return a.clone()}}),o},"AddN")}}),pT=F({addStrict_:function(e,t){var n=R(e,"a","addStrict"),r=R(t,"b","addStrict");return Ge(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),mT=F({atan2_:function(e,t){var n,r=R(e,"a","atan2"),a=R(t,"b","atan2");n=dt(r,a),r=n[0],a=n[1];var o=ze(r.shape,a.shape);return O.runKernelFunc(function(i,s){var l=i.atan2(r,a);return s([r,a]),l},{$a:r,$b:a},function(i,s){var l=s[0],c=s[1];return{$a:function(){var d=Be(l.square(),c.square()),h=i.mul(c.div(d)),f=It(l.shape,o);return f.length>0&&(h=h.sum(f)),h.reshape(l.shape)},$b:function(){var d=Be(l.square(),c.square()),h=mc(i.mul(l.div(d))),f=It(c.shape,o);return f.length>0&&(h=h.sum(f)),h.reshape(c.shape)}}})}}),tr=F({div_:function(e,t){var n,r=R(e,"a","div"),a=R(t,"b","div");if(n=dt(r,a),r=n[0],a=n[1],r.dtype==="int32"&&a.dtype==="int32")return ON(r,a);var o=ze(r.shape,a.shape);return O.runKernelFunc(function(i,s){var l=i.realDivide(r,a);return s([r,a]),l},{a:r,b:a},function(i,s){var l=s[0],c=s[1];return{a:function(){var d=i.div(c.toFloat()),h=It(l.shape,o);return h.length>0?d.sum(h).reshape(l.shape):d},b:function(){var d=i.mul(l.toFloat()),h=It(c.shape,o);h.length>0&&(d=d.sum(h).reshape(c.shape));var f=c.square();return d.div(f.toFloat()).neg()}}},"Div")}}),vT=F({divNoNan_:function(e,t){var n,r=R(e,"a","div"),a=R(t,"b","div");r=(n=dt(r,a))[0],a=n[1];var o=tr(r,a),i=Ue(o),s=a.equal(i);return Ro(s,i,o)}}),gT=F({divStrict_:function(e,t){var n=R(e,"a","div"),r=R(t,"b","div");return Ge(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),ON=F({floorDiv_:function(e,t){var n,r=R(e,"a","floorDiv"),a=R(t,"b","floorDiv");n=dt(r,a),r=n[0],a=n[1];var o=ze(r.shape,a.shape);return O.runKernelFunc(function(i,s){var l=i.floorDiv(r,a);return s([r,a]),l},{a:r,b:a},function(i,s){var l=s[0],c=s[1];return{a:function(){var d=i.div(c.toFloat()),h=It(l.shape,o);return h.length>0?d.sum(h).reshape(l.shape):d},b:function(){var d=i.mul(l.toFloat()),h=It(c.shape,o);h.length>0&&(d=d.sum(h).reshape(c.shape));var f=c.square();return d.div(f.toFloat()).neg()}}},"FloorDiv")}}),Cm=F({maximum_:function(e,t){var n,r=R(e,"a","maximum"),a=R(t,"b","maximum");return n=dt(r,a),r=n[0],a=n[1],r.dtype==="bool"&&(r=r.toInt(),a=a.toInt()),ze(r.shape,a.shape),O.runKernelFunc(function(o,i){var s=o.maximum(r,a);return i([r,a]),s},{a:r,b:a},function(o,i){var s=i[0],l=i[1];return{a:function(){return o.mul(s.greaterEqual(l).toFloat())},b:function(){return o.mul(s.less(l).toFloat())}}},"Maximum")}}),xT=F({maximumStrict_:function(e,t){var n=R(e,"a","maximumStrict"),r=R(t,"b","maximumStrict");return Ge(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),LN=F({minimum_:function(e,t){var n,r=R(e,"a","minimum"),a=R(t,"b","minimum");return n=dt(r,a),r=n[0],a=n[1],r.dtype==="bool"&&(r=r.toInt(),a=a.toInt()),ze(r.shape,a.shape),O.runKernelFunc(function(o,i){var s=o.minimum(r,a);return i([r,a]),s},{a:r,b:a},function(o,i){var s=i[0],l=i[1];return{a:function(){return o.mul(s.lessEqual(l).toFloat())},b:function(){return o.mul(s.greater(l).toFloat())}}},"Minimum")}}),yT=F({minimumStrict_:function(e,t){var n=R(e,"a","minimumStrict"),r=R(t,"b","minimumStrict");return Ge(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),bT=F({mod_:function(e,t){var n,r=R(e,"a","mod"),a=R(t,"b","mod");n=dt(r,a),r=n[0],a=n[1];var o=ze(r.shape,a.shape);return O.runKernelFunc(function(i,s){var l=i.mod(r,a);return s([r,a]),l},{$a:r,$b:a},function(i,s){var l=s[0],c=s[1];return{$a:function(){var d=It(l.shape,o);return d.length>0?i.sum(d).reshape(l.shape):i},$b:function(){var d=i.mul(l.div(c).floor().neg()),h=It(c.shape,o);return h.length>0?d.sum(h).reshape(c.shape):d}}})}}),wT=F({modStrict_:function(e,t){var n=R(e,"a","modStrict"),r=R(t,"b","modStrict");return Ge(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),nn=F({mul_:function(e,t){var n,r=R(e,"a","mul"),a=R(t,"b","mul");n=dt(r,a),r=n[0],a=n[1];var o=ze(r.shape,a.shape);return O.runKernelFunc(function(i,s){var l=i.multiply(r,a);return s([r,a]),l},{a:r,b:a},function(i,s){var l=s[0],c=s[1];return{a:function(){var d=i.mul(c.toFloat()),h=It(l.shape,o);return h.length>0?d.sum(h).reshape(l.shape):d},b:function(){var d=i.mul(l.toFloat()),h=It(c.shape,o);return h.length>0?d.sum(h).reshape(c.shape):d}}},"Mul")}}),NT=F({mulStrict_:function(e,t){var n=R(e,"a","mul"),r=R(t,"b","mul");return Ge(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),vc=F({pow_:function(e,t){var n,r=R(e,"base","pow"),a=R(t,"exp","pow");n=dt(r,a),r=n[0],a=n[1];var o=ze(r.shape,a.shape),i=[r,a];return O.runKernelFunc(function(s,l){var c=s.pow(r,a);return l([r,a,c]),c},{a:r,b:a},function(s,l){var c=l[0],d=l[1],h=l[2];return{a:function(){var f=d.toFloat(),p=s.mul(f.mul(c.pow(f.sub(le(1))))),v=It(c.shape,o);return v.length>0&&(p=p.sum(v)),p.reshape(c.shape)},b:function(){var f=c.greater(0),p=c.log().where(f,Ue(c)),v=s.mul(h.mul(p)),g=It(d.shape,o);return g.length>0&&(v=v.sum(g)),v.reshape(d.shape)}}},"Pow",{},i,[!0])}}),CT=F({powStrict_:function(e,t){return Ge(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),kT=F({squaredDifferenceStrict_:function(e,t){var n=R(e,"a","squaredDifferenceStrict"),r=R(t,"b","squaredDifferenceStrict");return Ge(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),At=F({sub_:function(e,t){var n,r=R(e,"a","sub"),a=R(t,"b","sub");n=dt(r,a),r=n[0],a=n[1];var o=ze(r.shape,a.shape);return O.runKernelFunc(function(i){return i.subtract(r,a)},{a:r,b:a},function(i){return{a:function(){var s=i,l=It(r.shape,o);return l.length>0&&(s=s.sum(l)),s.reshape(r.shape)},b:function(){var s=i,l=It(a.shape,o);return l.length>0&&(s=s.sum(l)),s.neg().reshape(a.shape)}}},"Sub")}}),jT=F({subStrict_:function(e,t){var n=R(e,"a","subStrict"),r=R(t,"b","subStrict");return Ge(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),BN=F({equal_:function(e,t){var n,r=R(e,"a","equal"),a=R(t,"b","equal");return n=dt(r,a),r=n[0],a=n[1],ze(r.shape,a.shape),O.runKernelFunc(function(o){return o.equal(r,a)},{$a:r,$b:a})}}),ST=F({equalStrict_:function(e,t){var n=R(e,"a","equalStrict"),r=R(t,"b","equalStrict");return Ge(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),ET=F({greater_:function(e,t){var n,r=R(e,"a","greater"),a=R(t,"b","greater");return n=dt(r,a),r=n[0],a=n[1],ze(r.shape,a.shape),O.runKernelFunc(function(o){return o.greater(r,a)},{a:r,b:a},null,"Greater")}}),zN=F({greaterEqual_:function(e,t){var n,r=R(e,"a","greaterEqual"),a=R(t,"b","greaterEqual");return n=dt(r,a),r=n[0],a=n[1],ze(r.shape,a.shape),O.runKernelFunc(function(o,i){var s=o.greaterEqual(r,a);return i([r,a]),s},{a:r,b:a},function(o,i){var s=i[0],l=i[1];return{a:function(){return Ue(s)},b:function(){return Ue(l)}}},"GreaterEqual")}}),_T=F({greaterEqualStrict_:function(e,t){var n=R(e,"a","greaterEqualStrict"),r=R(t,"b","greaterEqualStrict");return Ge(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),RT=F({greaterStrict_:function(e,t){var n=R(e,"a","greaterStrict"),r=R(t,"b","greaterStrict");return Ge(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),IT=F({less_:function(e,t){var n,r=R(e,"a","less"),a=R(t,"b","less");return n=dt(r,a),r=n[0],a=n[1],ze(r.shape,a.shape),O.runKernelFunc(function(o){return o.less(r,a)},{a:r,b:a},null,"Less")}}),AT=F({lessEqual_:function(e,t){var n,r=R(e,"a","lessEqual"),a=R(t,"b","lessEqual");return n=dt(r,a),r=n[0],a=n[1],ze(r.shape,a.shape),O.runKernelFunc(function(o,i){var s=o.lessEqual(r,a);return i([r,a]),s},{a:r,b:a},null,"LessEqual")}}),DT=F({lessEqualStrict_:function(e,t){var n=R(e,"a","lessEqualStrict"),r=R(t,"b","lessEqualStrict");return Ge(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),TT=F({lessStrict_:function(e,t){var n=R(e,"a","lessStrict"),r=R(t,"b","lessStrict");return Ge(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),PT=F({notEqual_:function(e,t){var n,r=R(e,"a","notEqual"),a=R(t,"b","notEqual");return n=dt(r,a),r=n[0],a=n[1],ze(r.shape,a.shape),O.runKernelFunc(function(o){return o.notEqual(r,a)},{a:r,b:a},null,"NotEqual")}}),FT=F({notEqualStrict_:function(e,t){var n=R(e,"a","notEqualStrict"),r=R(t,"b","notEqualStrict");return Ge(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function By(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function zy(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var km=F({gather_:function(e,t,n){n===void 0&&(n=0);var r=R(e,"x","gather"),a=R(t,"indices","gather","int32");n=Dt(n,r.shape)[0];var o=function(i,s,l){for(var c=i.shape[l],d=[],h=1,f=1,p=0;p<l;p++)d.push(i.shape[p]),h*=i.shape[p];for(p=0;p<s.rank;p++)d.push(s.shape[p]);for(p=l+1;p<i.rank;p++)d.push(i.shape[p]),f*=i.shape[p];return{batchSize:h,sliceSize:f,dimSize:c,outputShape:d}}(r,a,n);return O.runKernelFunc(function(i,s){var l=i.gather(r,a.flatten(),n);return s([a]),l},{x:r,indices:a},function(i,s){var l=s[0];return{x:function(){var c=r.shape,d=l.size,h=c.slice(0,n),f=h.length,p=c.slice(n,c.length).slice(1),v=p.length,g=By(0,f),y=By(f+1,f+1+v),m=zy([h,[d],p]),x=i.reshape(m),b=l.reshape([d]),w=zy([[f],g,y]),N=x.transpose(w),C=$N(N,b,r.shape[n]),S=cm(w);return C=C.transpose(S)},indices:function(){return l}}},"Gather",{axis:n}).reshape(o.outputShape)}}),$N=F({unsortedSegmentSum_:function(e,t,n){var r=R(e,"x","unsortedSegmentSum"),a=R(t,"segmentIds","unsortedSegmentSum","int32");return D(xt(n),function(){return"numSegments must be of dtype int"}),O.runKernelFunc(function(o,i){var s=o.unsortedSegmentSum(r,a,n);return i([a]),s},{$x:r},function(o,i){var s=i[0];return{$x:function(){return function(l,c){for(var d=Cm(c,Ue(c)),h=km(l,d),f=zN(c,le(0,"int32")),p=h.rank-f.rank,v=0;v<p;++v)f=Un(f,v+1);f=ed(f,Yi(h.shape,"bool"));var g=Ue(h);return Ro(f,h,g)}(o,s)}}})}}),MT=function(e,t,n){return fe(this,void 0,void 0,function(){var r,a,o,i,s,l,c,d,h,f,p,v,g;return pe(this,function(y){switch(y.label){case 0:for(r=R(e,"tensor","boolMask"),a=R(t,"mask","boolMask","bool"),o=n??0,i=a.rank,s=r.shape,D(i>0,function(){return"mask cannot be scalar"}),Ge(s.slice(o,o+i),a.shape,"mask's shape must match the first K dimensions of tensor's shape,"),l=1,c=o;c<o+i;c++)l*=s[c];return d=s.slice(0,o).concat([l],s.slice(o+i)),h=r.reshape(d),f=a.reshape([-1]),[4,MN(f)];case 1:return p=y.sent(),v=p.squeeze([1]),g=km(h,v,o),e!==r&&r.dispose(),t!==a&&a.dispose(),v.dispose(),h.dispose(),f.dispose(),p.dispose(),[2,g]}})})};function UN(e,t,n,r,a,o,i){o===void 0&&(o="NHWC"),D(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var s=e,l=t,c=!1;t.rank===3&&(c=!0,l=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),s=[1,e[0],e[1],e[2]]),D(s.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),D(l.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+l.rank}),D(n.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var d=o==="NHWC"?s[3]:s[1],h=o==="NHWC"?l.shape[3]:l.shape[1];D(d===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+d+") must match input depth for filter "+n.shape[2]+"."}),D(h===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+h+") must match output depth for filter "+n.shape[3]+"."}),i!=null&&D(xt(a),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."});var f=mm(o),p=Fo(s,n.shape,r,1,a,i,!1,f),v=O.runKernelFunc(function(g,y){var m=g.conv2dDerInput(l,n,p);return y([n,l]),m},{dy4D:l,filter:n},function(g,y){var m=y[0],x=y[1];return{dy4D:function(){return Xn(g,m,r,a,o,1,i)},filter:function(){return jm(g,x,m.shape,r,a,o,i)}}});return c?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}function uh(e){var t=function(o){return typeof o=="number"?[o,o,o]:o.length===2?[o[0],o[1],1]:o}(e),n=t[0],r=t[1],a=t[2];return n===1&&r===1&&a===1}function WN(e,t,n,r,a){D(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var o=e,i=t,s=!1;t.rank===4&&(s=!0,i=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),o=[1,e[0],e[1],e[2],e[3]]);var l=o[4],c=i.shape[4];D(o.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+o.length+"."}),D(i.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+i.rank}),D(n.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),D(l===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+l+") must match input depth for filter "+n.shape[3]+"."}),D(c===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+c+") must match output depth for filter "+n.shape[4]+"."});var d=fc(o,n.shape,r,1,a),h=O.runKernelFunc(function(f){return f.conv3dDerInput(i,n,d)},{dy5D:i});return s?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}var OT=F({conv1d_:function(e,t,n,r,a,o,i){a===void 0&&(a="NWC"),o===void 0&&(o=1);var s=R(e,"x","conv1d"),l=R(t,"filter","conv1d"),c=s,d=!1;s.rank===2&&(d=!0,c=s.as3D(1,s.shape[0],s.shape[1])),D(c.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+c.rank+"."}),D(l.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+l.rank+"."}),i!=null&&D(xt(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."}),D(c.shape[2]===l.shape[1],function(){return"Error in conv1d: depth of input ("+c.shape[2]+") must match input depth for filter "+l.shape[1]+"."}),D(kn(n,o),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+o+"'"}),D(a==="NWC",function(){return"Error in conv1d: got dataFormat of "+a+" but only NWC is currently supported."});var h=l.as4D(1,l.shape[0],l.shape[1],l.shape[2]),f=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),p=Xn(f,h,[1,n],r,"NHWC",[1,o],i);return d?p.as2D(p.shape[2],p.shape[3]):p.as3D(p.shape[0],p.shape[2],p.shape[3])}}),Xn=F({conv2d_:function(e,t,n,r,a,o,i){a===void 0&&(a="NHWC"),o===void 0&&(o=[1,1]);var s=R(e,"x","conv2d"),l=R(t,"filter","conv2d"),c=s,d=!1;s.rank===3&&(d=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),D(c.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+c.rank+"."}),D(l.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+l.rank+"."}),i!=null&&D(xt(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var h=a==="NHWC"?c.shape[3]:c.shape[1];D(h===l.shape[2],function(){return"Error in conv2d: depth of input ("+h+") must match input depth for filter "+l.shape[2]+"."}),D(kn(n,o),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"});var f=mm(a),p=Fo(c.shape,l.shape,n,o,r,i,!1,f),v=[l,c],g=O.runKernelFunc(function(y,m){var x=y.conv2d(c,l,p);return m([l,c]),x},{x:c,filter:l},function(y,m){var x=m,b=x[0],w=x[1];return D($i(o),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"}),{x:function(){return VN(w.shape,y,b,n,r,a)},filter:function(){return jm(w,y,b.shape,n,r,a)}}},"Conv2D",p,v);return d?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),LT=F({conv3d_:function(e,t,n,r,a,o){a===void 0&&(a="NDHWC"),o===void 0&&(o=[1,1,1]);var i=R(e,"x","conv3d"),s=R(t,"filter","conv3d"),l=i,c=!1;i.rank===4&&(c=!0,l=i.as5D(1,i.shape[0],i.shape[1],i.shape[2],i.shape[3])),D(l.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+l.rank+"."}),D(s.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),D(l.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+l.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),D(function(f,p){return uh(f)||uh(p)}(n,o),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),D(a==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+a+" but only NDHWC is currently supported."});var d=fc(l.shape,s.shape,n,o,r),h=O.runKernelFunc(function(f,p){var v=f.conv3d(l,s,d);return p([l,s]),v},{x:l,$filter:s},function(f,p){D(uh(o),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"});var v=p[0],g=p[1];return{x:function(){return WN(v.shape,f,g,n,r)},$filter:function(){return function(y,m,x,b,w){var N=y;y.rank===4&&(N=y.as5D(1,y.shape[0],y.shape[1],y.shape[2],y.shape[3]));var C=m;C.rank===4&&(C=m.as5D(1,m.shape[0],m.shape[1],m.shape[2],m.shape[3])),D(N.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+N.shape+"."}),D(C.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+C.shape+"."}),D(x.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+x+"."}),D(N.shape[4]===x[3],function(){return"Error in conv3dDerFilter: depth of input "+N.shape[4]+") must match input depth in filter ("+x[3]+"."}),D(C.shape[4]===x[4],function(){return"Error in conv3dDerFilter: depth of dy ("+C.shape[4]+") must match output depth for filter ("+x[4]+")."});var S=fc(N.shape,x,b,1,w);return O.runKernelFunc(function(k){return k.conv3dDerFilter(N,C,S)},{x5D:N,dy5D:C})}(v,f,g.shape,n,r)}}});return c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),jm=F({conv2dDerFilter_:function(e,t,n,r,a,o,i){o===void 0&&(o="NHWC");var s=e;e.rank===3&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var l=t;l.rank===3&&(l=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),D(s.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),D(l.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+l.shape+"."}),D(n.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var c=o==="NHWC"?s.shape[3]:s.shape[1],d=o==="NHWC"?l.shape[3]:l.shape[1];D(c===n[2],function(){return"Error in conv2dDerFilter: depth of input "+c+") must match input depth in filter ("+n[2]+"."}),D(d===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+d+") must match output depth for filter ("+n[3]+")."}),i!=null&&D(xt(a),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."});var h=mm(o),f=Fo(s.shape,n,r,1,a,i,!1,h);return O.runKernelFunc(function(p){return p.conv2dDerFilter(s,l,f)},{x4D:s,dy4D:l})}}),VN=F({conv2dDerInput_:UN}),td=F({depthwiseConv2d_:function(e,t,n,r,a,o,i){o===void 0&&(o=[1,1]);var s=R(e,"x","depthwiseConv2d"),l=R(t,"filter","depthwiseConv2d"),c=s,d=!1;s.rank===3&&(d=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),D(c.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+c.rank+"."}),D(l.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+l.rank+"."}),D(c.shape[3]===l.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+c.shape[3]+") must match the inChannels dimension in filter "+l.shape[2]+"."}),o==null&&(o=[1,1]),D(kn(n,o),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),i!=null&&D(xt(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var h=Fo(c.shape,l.shape,n,o,r,i,!0),f=[c,l],p=O.runKernelFunc(function(v,g){var y=v.depthwiseConv2D(c,l,h);return g([c,l]),y},{x:c,filter:l},function(v,g){D($i(o),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+o+"'"});var y=g[0],m=g[1];return{x:function(){return HN(y.shape,v,m,h)},filter:function(){return GN(y,v,m.shape,h)}}},"DepthwiseConv2dNative",h,f);return d?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),HN=F({depthwiseConv2dDerInput_:function(e,t,n,r){var a=t,o=!1;t.rank===3&&(o=!0,a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var i=O.runKernelFunc(function(s){return s.depthwiseConv2DDerInput(a,n,r)},{dy4D:a});return o?i.as3D(i.shape[1],i.shape[2],i.shape[3]):i}}),GN=F({depthwiseConv2dDerFilter_:function(e,t,n,r){var a=e;e.rank===3&&(a=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var o=t;return o.rank===3&&(o=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),O.runKernelFunc(function(i){return i.depthwiseConv2DDerFilter(a,o,r)},{x4D:a,dy4D:o})}}),Sm=F({separableConv2d_:function(e,t,n,r,a,o,i){o===void 0&&(o=[1,1]),i===void 0&&(i="NHWC");var s=R(e,"x","separableConv2d"),l=R(t,"depthwiseFilter","separableConv2d"),c=R(n,"pointwiseFilter","separableConv2d"),d=s,h=!1;if(s.rank===3&&(h=!0,d=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");D(d.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+d.rank+"."}),D(l.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+l.rank+"."}),D(c.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+l.rank+"."}),D(c.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+c.shape[0]+"."}),D(c.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+c.shape[1]+"."});var f=l.shape[2],p=l.shape[3];D(c.shape[2]===f*p,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+f*p+", but got "+c.shape[2]+"."});var v=td(d,l,r,a,i,o),g=Xn(v,c,1,"valid",i);return h?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),BT=F({conv2dTranspose_:function(e,t,n,r,a,o){return UN(n,R(e,"x","conv2dTranspose"),R(t,"filter","conv2dTranspose"),r,a,"NHWC",o)}}),zT=F({conv3dTranspose_:function(e,t,n,r,a){return WN(n,R(e,"x","conv3dTranspose"),R(t,"filter","conv3dTranspose"),r,a)}}),nd=F({matMul_:function(e,t,n,r){var a;n===void 0&&(n=!1),r===void 0&&(r=!1);var o=R(e,"a","matMul"),i=R(t,"b","matMul");a=dt(o,i),o=a[0],i=a[1];var s=n?o.shape[o.rank-2]:o.shape[o.rank-1],l=r?i.shape[i.rank-1]:i.shape[i.rank-2],c=n?o.shape[o.rank-1]:o.shape[o.rank-2],d=r?i.shape[i.rank-2]:i.shape[i.rank-1],h=o.shape.slice(0,-2),f=i.shape.slice(0,-2),p=me(h),v=me(f);D(o.rank>=2&&i.rank>=2&&o.rank===i.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+o.rank+" and "+i.rank+"."}),D(Lt(h,f),function(){return"Error in matMul: outer dimensions ("+h+") and ("+f+") of Tensors with shapes "+o.shape+" and "+i.shape+" must match."}),D(s===l,function(){return"Error in matMul: inner shapes ("+s+") and ("+l+") of Tensors with shapes "+o.shape+" and "+i.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var g=o.shape.slice(0,-2).concat([c,d]),y=n?o.as3D(p,s,c):o.as3D(p,c,s),m=r?i.as3D(v,d,l):i.as3D(v,l,d),x={transposeA:n,transposeB:r};return O.runKernelFunc(function(b,w){var N=b.batchMatMul(y,m,n,r);return w([y,m]),N},{a:y,b:m},function(b,w){var N=w,C=N[0],S=N[1];return n||r?!n&&r?{a:function(){return b.matMul(S,!1,!1)},b:function(){return b.matMul(C,!0,!1)}}:n&&!r?{a:function(){return S.matMul(b,!1,!0)},b:function(){return C.matMul(b,!1,!1)}}:{a:function(){return S.matMul(b,!0,!0)},b:function(){return b.matMul(C,!0,!0)}}:{a:function(){return b.matMul(S,!1,!0)},b:function(){return C.matMul(b,!0,!1)}}},"BatchMatMul",x).reshape(g)}}),$T=F({dot_:function(e,t){var n=R(e,"t1","dot"),r=R(t,"t2","dot");D(!(n.rank!==1&&n.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."});var a=n.rank===1?n.size:n.shape[1],o=r.rank===1?r.size:r.shape[0];return D(a===o,function(){return"Error in dot: inner dimensions of inputs must match, but got "+a+" and "+o+"."}),n.rank===1&&r.rank===1?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():n.rank===1&&r.rank===2?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():n.rank===2&&r.rank===1?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),UT=F({outerProduct_:function(e,t){var n=R(e,"v1","outerProduct"),r=R(t,"v2","outerProduct");return D(n.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."}),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),xl=F({reverse_:function(e,t){var n=R(e,"x","reverse");if(n.rank===0)return n.clone();var r=Dt(t,n.shape);return O.runKernelFunc(function(a){return a.reverse(n,r)},{$x:n},function(a){return{$x:function(){return a.reverse(r)}}}).reshapeAs(n)}}),WT=F({reverse1d_:function(e){var t=R(e,"x","reverse");return D(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),xl(t,0)}}),VT=F({reverse2d_:function(e,t){var n=R(e,"x","reverse");return D(n.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),xl(n,t)}}),HT=F({reverse3d_:function(e,t){var n=R(e,"x","reverse");return D(n.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),xl(n,t)}}),GT=F({reverse4d_:function(e,t){var n=R(e,"x","reverse");return D(n.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),xl(n,t)}});function qN(e,t,n,r,a,o){var i=R(e,"x","maxPool"),s=i,l=!1;i.rank===3&&(l=!0,s=i.as4D(1,i.shape[0],i.shape[1],i.shape[2])),D(s.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),D(kn(n,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}),o!=null&&D(xt(a),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."});var c=Js(s.shape,t,n,r,a,o);if(c.filterWidth===1&&c.filterHeight===1&&Lt(c.inShape,c.outShape))return i.clone();var d=[s],h=O.runKernelFunc(function(f,p){var v=f.maxPool(s,c);return p([s,v]),v},{x:s},function(f,p){var v=p[0],g=p[1];return{x:function(){return function(y,m,x,b,w,N,C,S){var k=R(y,"dy","maxPoolBackprop"),_=R(m,"input","maxPoolBackprop"),E=R(x,"output","maxPoolBackprop");D(_.rank===k.rank,function(){return"Rank of input ("+_.rank+") does not match rank of dy ("+k.rank+")"}),D(kn(w,N),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+N+"'"}),D(k.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+k.rank+"."}),D(_.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+_.rank+"."});var j=Js(_.shape,b,w,N,C,S);return O.runKernelFunc(function(T){return T.maxPoolBackprop(k,_,E,j)},{$dy:k,$input:_})}(f,v,g,t,n,r,a)}}},"MaxPool",c,d);return l?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}function KN(e,t,n,r,a,o){var i=R(e,"x","avgPool","float32");D(kn(n,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"});var s=i,l=!1;i.rank===3&&(l=!0,s=i.as4D(1,i.shape[0],i.shape[1],i.shape[2])),D(s.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),o!=null&&D(xt(a),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."});var c=Js(s.shape,t,n,r,a,o);if(c.filterWidth===1&&c.filterHeight===1&&Lt(c.inShape,c.outShape))return i.clone();var d=O.runKernelFunc(function(h){return h.avgPool(s,c)},{x:s},function(h){return{x:function(){return function(f,p,v,g,y,m){var x=R(f,"dy","avgPoolBackprop"),b=R(p,"input","avgPoolBackprop");D(b.rank===x.rank,function(){return"Rank of input ("+b.rank+") does not match rank of dy ("+x.rank+")"}),D(kn(g,y),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+g+" and dilations '"+y+"'"});var w=b,N=x,C=!1;b.rank===3&&(C=!0,w=b.as4D(1,b.shape[0],b.shape[1],b.shape[2]),N=x.as4D(1,x.shape[0],x.shape[1],x.shape[2])),D(N.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+N.rank+"."}),D(w.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+w.rank+"."});var S=Js(w.shape,v,g,y,m),k=O.runKernelFunc(function(_){return _.avgPoolBackprop(N,w,S)},{dy4D:N,input4D:w});return C?k.as3D(k.shape[1],k.shape[2],k.shape[3]):k}(h,s,t,n,r,a)}}},"AvgPool",c);return d=d.cast(i.dtype),l?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}var Pt=F({maxPool_:function(e,t,n,r,a){return qN(e,t,n,1,r,a)}}),yl=F({avgPool_:function(e,t,n,r,a){return KN(e,t,n,1,r,a)}}),qT=F({pool_:function(e,t,n,r,a,o){a==null&&(a=[1,1]),o==null&&(o=1),r===0&&(r="valid");var i=R(e,"x","maxPool"),s=i,l=!1;i.rank===3&&(l=!0,s=i.as4D(1,i.shape[0],i.shape[1],i.shape[2])),D(kn(o,a),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+a+"'"});var c,d=Js(s.shape,t,o,a,r),h=[d.dilationHeight,d.dilationWidth];c=r==="same"?function(w,N){var C=w.map(function(_,E){return _+(_-1)*(N[E]-1)}).map(function(_){return _-1}),S=C.map(function(_){return Math.floor(_/2)}),k=C.map(function(_,E){return _-S[E]});return C.map(function(_,E){return[S[E],k[E]]})}([d.filterHeight,d.filterWidth],h):[[0,0],[0,0]];var f=h[0]===1&&h[1]===1,p=function(w,N,C){var S=C.map(function(P){return P[0]}),k=C.map(function(P){return P[1]}),_=w.concat(S,k),E=N.map(function(P,B){return(P-_[B]%P)%P}),j=k.map(function(P,B){return P+E[B]}),T=N.map(function(P,B){return[S[B],j[B]]}),L=N.map(function(P,B){return[0,E[B]]});return[T,L]}([d.inHeight,d.inWidth],h,c),v=p[0],g=p[1],y=f?r:"valid",m=f?s:eN(s,h,v),x=(n==="avg"?function(){return KN(m,t,o,1,y)}:function(){return qN(m,t,o,1,y)})(),b=f?x:Qw(x,h,g);return l?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),KT=F({maxPool3d_:function(e,t,n,r,a,o,i){o===void 0&&(o="NDHWC");var s=R(e,"x","maxPool3d"),l=s,c=!1;s.rank===4&&(c=!0,l=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),i==null&&(i=[1,1,1]),D(l.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+l.rank+"."}),D(o==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+o}),D(kn(n,i),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),a!=null&&D(xt(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=hc(l.shape,t,n,i,r,a,o),h=O.runKernelFunc(function(f,p){var v=f.maxPool3d(l,d);return p([l,v]),v},{x:l},function(f,p){var v=p[0],g=p[1];return{x:function(){return function(y,m,x,b,w,N,C,S){var k=R(y,"dy","maxPool3dBackprop"),_=R(m,"input","maxPool3dBackprop"),E=R(x,"output","maxPool3dBackprop"),j=k,T=_,L=E,P=!1;_.rank===4&&(P=!0,j=k.as5D(1,k.shape[0],k.shape[1],k.shape[2],k.shape[3]),T=_.as5D(1,_.shape[0],_.shape[1],_.shape[2],_.shape[3]),L=E.as5D(1,E.shape[0],E.shape[1],E.shape[2],E.shape[3])),D(j.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+j.rank+"."}),D(T.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+T.rank+"."}),D(L.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+L.rank+"."}),N==null&&(N=[1,1,1]),D(kn(w,N),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+N+"'"}),S!=null&&D(xt(C),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+S+" but got pad "+C+"."});var B=hc(T.shape,b,w,N,C,S),K=O.runKernelFunc(function(z){return z.maxPool3dBackprop(j,T,L,B)},{dy5D:j,input5D:T});return P?K.as4D(K.shape[1],K.shape[2],K.shape[3],K.shape[4]):K}(f,v,g,t,n,i,r,a)}}});return c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),XT=F({avgPool3d_:function(e,t,n,r,a,o,i){o===void 0&&(o="NDHWC");var s=R(e,"x","avgPool3d","float32"),l=s,c=!1;s.rank===4&&(c=!0,l=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),i==null&&(i=[1,1,1]),D(l.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+l.rank+"."}),D(o==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+o}),D(kn(n,i),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),a!=null&&D(xt(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=hc(l.shape,t,n,i,r,a,o),h=O.runKernelFunc(function(f){return f.avgPool3d(l,d)},{x:l},function(f){return{x:function(){return function(p,v,g,y,m,x,b){var w=R(p,"dy","avgPool3dBackprop"),N=R(v,"input","avgPool3dBackprop"),C=w,S=N,k=!1;N.rank===4&&(k=!0,C=w.as5D(1,w.shape[0],w.shape[1],w.shape[2],w.shape[3]),S=N.as5D(1,N.shape[0],N.shape[1],N.shape[2],N.shape[3])),D(C.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+C.rank+"."}),D(S.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+S.rank+"."}),m==null&&(m=[1,1,1]),D(kn(y,m),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+y+" and dilations '"+m+"'"}),b!=null&&D(xt(x),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+b+" but got pad "+x+"."});var _=hc(S.shape,g,y,m,x,b),E=O.runKernelFunc(function(j){return j.avgPool3dBackprop(C,S,_)},{dy5D:C,input5D:S});return k?E.as4D(E.shape[1],E.shape[2],E.shape[3],E.shape[4]):E}(f,l,t,n,i,r,a)}}});return h=h.cast(l.dtype),c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),Dr=F({slice_:function(e,t,n){var r,a,o=R(e,"x","slice");if(o.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof t=="number"?[t].concat(new Array(o.rank-1).fill(0)):t.length<o.rank?t.concat(new Array(o.rank-t.length).fill(0)):t.slice()).forEach(function(l){D(l!==-1,function(){return"slice() does not support negative begin indexing."})}),a=(a=n==null?new Array(o.rank).fill(-1):typeof n=="number"?[n].concat(new Array(o.rank-1).fill(-1)):n.length<o.rank?n.concat(new Array(o.rank-n.length).fill(-1)):n).map(function(l,c){return l>=0?l:(D(l===-1,function(){return"Negative size values should be exactly -1 but got "+l+" for the slice() size at index "+c+"."}),o.shape[c]-r[c])}),C5(o,r,a);var i=o.shape,s={begin:r,size:a};return O.runKernelFunc(function(l){return l.slice(o,r,a)},{x:o},function(l){for(var c=[],d=0;d<l.rank;d++)c.push([r[d],i[d]-r[d]-a[d]]);return{x:function(){return l.pad(c)}}},"Slice",s)}}),YT=F({slice1d_:function(e,t,n){var r=R(e,"x","slice1d");return D(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),Dr(r,[t],[n])}}),QT=F({slice2d_:function(e,t,n){var r=R(e,"x","slice2d");return D(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),Dr(r,t,n)}}),XN=F({slice3d_:function(e,t,n){var r=R(e,"x","slice3d");return D(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),Dr(r,t,n)}}),JT=F({slice4d_:function(e,t,n){var r=R(e,"x","slice4d");return D(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),Dr(r,t,n)}});function YN(e,t,n,r,a){return t.rank<n.rank&&(t=t.reshape(Cn(t.shape,r))),e.rank<n.rank&&(e=e.reshape(Cn(e.shape,r))),{x:function(){var o=e.mul(n.equal(t).cast(e.dtype));return a==null?o:o.transpose(a)}}}var ZT=F({all_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=R(e,"x","all","bool"),a=Dt(t,r.shape),o=a,i=Pr(o,r.rank);i!=null&&(r=r.transpose(i),o=Fr(o.length,r.rank));var s=O.runKernelFunc(function(c){return c.all(r,o)},{$x:r});if(n){var l=Cn(s.shape,a);return s.reshape(l)}return s}}),eP=F({any_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=R(e,"x","any","bool"),a=Dt(t,r.shape),o=a,i=Pr(o,r.rank);i!=null&&(r=r.transpose(i),o=Fr(o.length,r.rank));var s=O.runKernelFunc(function(c){return c.any(r,o)},{$x:r});if(n){var l=Cn(s.shape,a);return s.reshape(l)}return s}}),tP=F({argMax_:function(e,t){t===void 0&&(t=0);var n=R(e,"x","argMax");t==null&&(t=0);var r=Dt(t,n.shape),a=Pr(r,n.rank);a!=null&&(n=n.transpose(a),r=Fr(r.length,n.rank));var o={axis:r[0]},i=[n];return O.runKernelFunc(function(s,l){var c=s.argMax(n,r[0]);return l([n]),c},{x:n},function(s,l){var c=l[0];return{x:function(){return Ue(c)}}},"ArgMax",o,i)}}),nP=F({argMin_:function(e,t){t===void 0&&(t=0);var n=R(e,"x","argMin");t==null&&(t=0);var r=Dt(t,n.shape),a=Pr(r,n.rank);return a!=null&&(n=n.transpose(a),r=Fr(r.length,n.rank)),O.runKernelFunc(function(o,i){var s=o.argMin(n,r[0]);return i([n]),s},{$x:n},function(o,i){var s=i[0];return{$x:function(){return Ue(s)}}})}}),rP=F({logSumExp_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=R(e,"x","logSumExp"),a=Dt(t,r.shape),o=r.max(a,!0),i=r.sub(o).exp().sum(a).log(),s=o.reshape(i.shape).add(i);if(n){var l=Cn(s.shape,a);return s.reshape(l)}return s}}),rd=F({max_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=R(e,"x","max"),a=r,o=Dt(t,r.shape),i=o,s=Pr(i,r.rank);s!=null&&(r=r.transpose(s),i=Fr(i.length,r.rank));var l=[r],c=O.runKernelFunc(function(h,f){var p=h.max(r,i);return f([a,p]),p},{x:r},function(h,f){return YN(h,f[1],f[0],o,s)},"Max",{axes:i},l,[!0]);if(n){var d=Cn(c.shape,o);c=c.reshape(d)}return c}}),aP=F({mean_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=R(e,"x","mean"),a=Dt(t,r.shape),o=me(Yt(r.shape,a)[1]);return Jc(function(i){var s=le(o);return{value:(s.dtype===i.dtype?i:i.cast(s.dtype)).div(s).sum(t,n),gradFunc:function(l){var c=i.shape.slice();return a.forEach(function(d){c[d]=1}),l.reshape(c).mul(Yi(i.shape,"float32")).div(o)}}})(r)}}),oP=F({min_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=R(e,"x","min"),a=r,o=Dt(t,r.shape),i=o,s=Pr(i,r.rank);s!=null&&(r=r.transpose(s),i=Fr(i.length,r.rank));var l=[r],c=O.runKernelFunc(function(h,f){var p=h.min(r,i);return f([a,p]),p},{x:r},function(h,f){return YN(h,f[1],f[0],o,s)},"Min",{axes:i},l,[!0]);if(n){var d=Cn(c.shape,o);c=c.reshape(d)}return c}}),iP=F({moments_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=Dt(t,(e=R(e,"x","moments")).shape),a=e.mean(r,n),o=a.shape;n||(o=Cn(a.shape,r));var i=e.toFloat().sub(a.reshape(o)).square();return{mean:a,variance:i.mean(r,n)}}}),QN=F({sum_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=R(e,"x","sum");r.dtype==="bool"&&(r=r.toInt());var a=Dt(t,r.shape);return Jc(function(o){var i=Pr(a,o.rank),s=a,l=o;i!=null&&(l=o.transpose(i),s=Fr(s.length,o.rank));var c=function(p){var v=o.shape.slice();return a.forEach(function(g){v[g]=1}),p.reshape(v).mul(Yi(o.shape,"float32"))},d={axes:s},h=O.runKernelFunc(function(p){return p.sum(l,s)},{x:l},function(p){return{x:function(){return c(p)}}},"Sum",d);if(n){var f=Cn(h.shape,a);h=h.reshape(f)}return{value:h,gradFunc:c}})(r)}}),sP=F({prod_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=R(e,"x","prod");r.dtype==="bool"&&(r=r.toInt());var a=Dt(t,r.shape),o=Pr(a,r.rank),i=a,s=r;o!=null&&(s=r.transpose(o),i=Fr(i.length,r.rank));var l=O.runKernelFunc(function(d){return d.prod(s,i)},{permutedX:s});if(n){var c=Cn(l.shape,a);l=l.reshape(c)}return l}}),JN=F({elu_:function(e){var t=R(e,"x","elu");return O.runKernelFunc(function(n,r){var a=n.elu(t);return r([a]),a},{$x:t},function(n,r){var a=r[0];return{$x:function(){return O.runKernelFunc(function(o){return o.eluDer(n,a)},{dy:n,y:a})}}})}}),lP=F({leakyRelu_:function(e,t){t===void 0&&(t=.2);var n=R(e,"x","leakyRelu");return Cm(le(t).mul(n),n)}}),ZN=F({prelu_:function(e,t){var n=R(e,"x","prelu"),r=R(t,"alpha","prelu");return O.runKernelFunc(function(a,o){var i=a.prelu(n,r);return o([n,r]),i},{x:n,alpha:r},function(a,o){var i=o[0],s=o[1],l=i.greater(0);return{x:function(){return Ro(l,a,a.mul(s))},alpha:function(){var c=Ro(l,Ue(a),a.mul(i)),d=It(s.shape,a.shape);return d.length>0&&(c=c.sum(d)),c.reshape(s.shape)}}},"Prelu")}}),st=F({relu_:function(e){var t=R(e,"x","relu");return t.dtype==="bool"?t.toInt():O.runKernelFunc(function(n,r){var a=n.relu(t);return r([t]),a},{x:t},function(n,r){var a=r[0];return{x:function(){return n.mulStrict(a.step().toFloat())}}},"Relu")}}),eC=F({relu6_:function(e){var t=R(e,"x","relu6");return t.dtype==="bool"?t.toInt():O.runKernelFunc(function(n,r){var a=n.relu6(t);return r([t]),a},{x:t},function(n,r){var a=r[0],o=a.lessEqual(6).mul(a.step());return{x:function(){return n.mulStrict(o.toFloat())}}},"Relu6")}}),uP=F({selu_:function(e){var t=R(e,"x","selu");return O.runKernelFunc(function(n,r){var a=n.selu(t);return r([t]),a},{$x:t},function(n,r){var a=r[0];return{$x:function(){var o=a.greater(le(0)),i=le(bm),s=le(wm),l=n.mul(s),c=n.mul(i).mul(a.toFloat().exp());return Ro(o,l,c)}}})}}),Wa=F({transpose_:function(e,t){var n=R(e,"x","transpose");if(t==null&&(t=n.shape.map(function(a,o){return o}).reverse()),D(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."}),t.forEach(function(a){D(a>=0&&a<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t})}),n.rank<=1)return n.clone();var r={perm:t};return O.runKernelFunc(function(a){return a.transpose(n,t)},{x:n},function(a){var o=cm(t);return{x:function(){return a.transpose(o)}}},"Transpose",r)}}),cP=F({localResponseNormalization_:function(e,t,n,r,a){t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),a===void 0&&(a=.5);var o=R(e,"x","localResponseNormalization");D(o.rank===4||o.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+o.rank+"."}),D(xt(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var i=o,s=!1;o.rank===3&&(s=!0,i=o.as4D(1,o.shape[0],o.shape[1],o.shape[2]));var l=O.runKernelFunc(function(c,d){var h=c.localResponseNormalization4D(i,t,n,r,a);return d([i,h]),h},{x4D:i},function(c,d){var h=d[0],f=d[1];return{x4D:function(){return O.runKernelFunc(function(p){return p.LRNGrad(c,h,f,t,n,r,a)},{})}}});return s?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}}),tC=F({norm_:function(e,t,n,r){t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1);var a=function s(l,c,d){if(d===void 0&&(d=null),l.rank===0)return l.abs();if(l.rank!==1&&d===null)return s(l.reshape([-1]),c,d);if(l.rank===1||typeof d=="number"||Array.isArray(d)&&d.length===1){if(c===1)return l.abs().sum(d);if(c===1/0)return l.abs().max(d);if(c===-1/0)return l.abs().min(d);if(c==="euclidean"||c===2)return l.abs().pow(le(2,"int32")).sum(d).sqrt();throw new Error("Error in norm: invalid ord value: "+c)}if(Array.isArray(d)&&d.length===2){if(c===1)return l.abs().sum(d[0]).max(d[1]-1);if(c===1/0)return l.abs().sum(d[1]).max(d[0]);if(c===-1/0)return l.abs().sum(d[1]).min(d[0]);if(c==="fro"||c==="euclidean")return l.square().sum(d).sqrt();throw new Error("Error in norm: invalid ord value: "+c)}throw new Error("Error in norm: invalid axis: "+d)}(e=R(e,"x","norm"),t,n),o=a.shape;if(r){var i=Dt(n,e.shape);o=Cn(a.shape,i)}return a.reshape(o)}}),dP=F({basicLSTMCell_:function(e,t,n,r,a,o){var i=R(e,"forgetBias","basicLSTMCell"),s=R(t,"lstmKernel","basicLSTMCell"),l=R(n,"lstmBias","basicLSTMCell"),c=R(r,"data","basicLSTMCell"),d=R(a,"c","basicLSTMCell"),h=R(o,"h","basicLSTMCell"),f=c.concat(h,1).matMul(s).add(l),p=f.shape[0],v=f.shape[1]/4,g=[p,v],y=f.slice([0,0],g),m=f.slice([0,v],g),x=f.slice([0,2*v],g),b=f.slice([0,3*v],g),w=y.sigmoid().mulStrict(m.tanh()).addStrict(d.mulStrict(i.add(x).sigmoid())),N=w.tanh().mulStrict(b.sigmoid());return[w,N]}}),hP=F({multiRNNCell_:function(e,t,n,r){for(var a=R(t,"data","multiRNNCell"),o=ic(n,"c","multiRNNCell"),i=ic(r,"h","multiRNNCell"),s=a,l=[],c=0;c<e.length;c++){var d=e[c](s,o[c],i[c]);l.push(d[0]),l.push(d[1]),s=d[1]}var h=[],f=[];for(c=0;c<l.length;c+=2)h.push(l[c]),f.push(l[c+1]);return[h,f]}}),fP=F({movingAverage_:function(e,t,n,r,a){a===void 0&&(a=!0);var o=R(e,"v","movingAverage"),i=R(t,"x","movingAverage"),s=R(n,"decay","movingAverage");cI(o,i),D(Lt(o.shape,i.shape),function(){return"Shape mismatch in v and x"});var l=le(1),c=l.sub(s),d=i.sub(o).mul(c);if(a){D(r!=null,function(){return"When using zeroDebias: true, step is required."});var h=R(r,"step","movingAverage");d=d.div(l.sub(vc(s,h)))}return o.add(d)}}),pP=F({stridedSlice_:function(e,t,n,r,a,o,i,s,l){if(a===void 0&&(a=0),o===void 0&&(o=0),i===void 0&&(i=0),s===void 0&&(s=0),l===void 0&&(l=0),r==null&&(r=new Array(t.length)),i!==0)throw new Error("ellipsis mask is not yet supported");var c=R(e,"x","stridedSlice"),d=yy(s),h=c.shape.slice();d.forEach(function(y){t[y]=0,n[y]=1,h.splice(y,0,1)}),c=c.reshape(h);for(var f=0;f<c.rank;f++)t[f]=k5(a,t,r,c.shape,f),n[f]=j5(o,n,r,c.shape,f),r[f]=r[f]||1;var p=yy(l);p.forEach(function(y){n[y]=t[y]+1,r[y]=1});var v=pm(t,n,r),g=v.filter(function(y,m){return p.indexOf(m)===-1});return r.every(function(y){return y===1})?Dr(c,t,v).reshape(g):O.runKernelFunc(function(y){return y.stridedSlice(c,t,n,r)},{$x:c}).reshape(g)}}),mP=F({topk_:function(e,t,n){t===void 0&&(t=1),n===void 0&&(n=!0);var r=R(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var a=r.shape[r.shape.length-1];if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension ("+a+") but got "+t);var o=O.runKernelFunc(function(i){return i.topk(r,t,n)},{$x:r});return{values:o[0],indices:o[1]}}}),vP=F({scatterND_:function(e,t,n){var r=R(e,"indices","scatterND","int32"),a=R(t,"updates","scatterND");return N5(a,r,n),O.runKernelFunc(function(o){return o.scatterND(r,a,n)},{indices:r,updates:a},null,"ScatterNd",{shape:n})}}),Em=F({fft_:function(e){D(e.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return O.runKernelFunc(function(a){return a.fft(r)},{input:e}).reshape(e.shape)}}),gc=F({ifft_:function(e){D(e.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return O.runKernelFunc(function(a){return a.ifft(r)},{input:e}).reshape(e.shape)}}),_m=F({rfft_:function(e,t){D(e.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+e.dtype});var n,r=e.shape[e.shape.length-1],a=e.size/r;if(t!=null&&t<r){var o=e.shape.map(function(m){return 0}),i=e.shape.map(function(m){return m});i[e.shape.length-1]=t,n=e.slice(o,i),r=t}else if(t!=null&&t>r){var s=e.shape.map(function(m){return m});s[e.shape.length-1]=t-r,n=e.concat(et(s),e.shape.length-1),r=t}else n=e;var l=n.zerosLike(),c=Wt(n,l).as2D(a,r),d=Em(c),h=Math.floor(r/2)+1,f=Wn(d),p=wr(d),v=f.split([h,r-h],f.shape.length-1),g=p.split([h,r-h],p.shape.length-1),y=n.shape.slice();return y[n.shape.length-1]=h,Wt(v[0],g[0]).reshape(y)}}),nC=F({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),a=gc(r);return Wn(a)}var o=[n,2*(t-1)],i=Wn(e).as2D(n,t),s=wr(e).as2D(n,t),l=i.slice([0,1],[n,t-2]).reverse(1),c=s.slice([0,1],[n,t-2]).reverse(1).mul(le(-1)),d=i.concat(l,1),h=s.concat(c,1);return r=Wt(d,h).as2D(o[0],o[1]),a=gc(r),Wn(a)}}),gP=Object.freeze({fft:Em,ifft:gc,rfft:_m,irfft:nC}),xP=F({sparseToDense_:function(e,t,n,r){r===void 0&&(r=0);var a=R(e,"sparseIndices","sparseToDense","int32"),o=R(t,"sparseValues","sparseToDense"),i=R(r,"defaultValue","sparseToDense",o.dtype);return function(s,l,c,d){if(s.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+s.dtype+".");if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+s.shape+".");var h=s.rank>0?s.shape[0]:1,f=s.rank>1?s.shape[1]:1;if(c.length!==f)throw new Error("outputShape has incorrect number of elements:, "+c.length+", should be: "+f+".");var p=l.size;if(l.rank!==0&&(l.rank!==1||p!==h))throw new Error("sparseValues has incorrect shape "+l.shape+", should be [] or ["+h+"]");if(l.dtype!==d.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(a,o,n,i),O.runKernelFunc(function(s){return s.sparseToDense(a,o,n,i)},{$sparseIndices:a,$sparseValues:o,$defaultValue:i})}}),yP=F({gatherND_:function(e,t){var n=R(t,"indices","gatherND","int32"),r=R(e,"x","gatherND");return O.runKernelFunc(function(a){return a.gatherND(r,n)},{x:r,indices:n},null,"GatherNd")}}),bP=F({diag_:function(e){var t=R(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return O.runKernelFunc(function(r){return r.diag(t)},{$x:t}).reshape(n)}}),wP=F({dropout_:function(e,t,n,r){var a=R(e,"x","dropout");if(D(a.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+a.dtype+" tensor instead."}),D(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return e instanceof it?a.clone():a;var o=function(l,c){if(c==null)return l.shape.slice();if(Lt(l.shape,c))return c;if(l.shape.length===c.length){for(var d=[],h=0;h<l.shape.length;h++)c[h]==null&&l.shape[h]!=null?d.push(l.shape[h]):d.push(c[h]);return d}return c}(a,n),i=1-t,s=Zw(o,0,1,"float32",r).add(i).floor().div(i);return a.mul(s)}});function rC(e,t,n){for(var r=1-e%2,a=new Float32Array(e),o=0;o<e;++o){var i=2*Math.PI*o/(e+r-1);a[o]=t-n*Math.cos(i)}return wt(a,"float32")}var Rm=F({hannWindow_:function(e){return rC(e,.5,.5)}}),aC=F({hammingWindow_:function(e){return rC(e,.54,.46)}}),Im=F({frame_:function(e,t,n,r,a){r===void 0&&(r=!1),a===void 0&&(a=0);for(var o=0,i=[];o+t<=e.size;)i.push(Dr(e,o,t)),o+=n;if(r)for(;o<e.size;){var s=o+t-e.size,l=_t([Dr(e,o,t-s),Rr([s],a)]);i.push(l),o+=n}return i.length===0?Oa([],[0,t]):_t(i).as2D(i.length,t)}}),oC=F({stft_:function(e,t,n,r,a){var o;a===void 0&&(a=Rm),r==null&&(o=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(o)/Math.log(2)))));for(var i=Im(e,t,n),s=nn(i,a(t)),l=[],c=0;c<i.shape[0];c++)l.push(_m(s.slice([c,0],[1,t]),r));return _t(l)}}),NP=Object.freeze({hannWindow:Rm,hammingWindow:aC,frame:Im,stft:oC}),tn,CP=function(e,t,n){return n===void 0&&(n=1),fe(this,void 0,void 0,function(){var r,a,o,i,s,l,c,d,h,f,p,v,g,y;return pe(this,function(m){switch(m.label){case 0:return r=R(e,"predictions","inTopK"),a=R(t,"targets","inTopK"),D(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),D(r.rank-1===a.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+a.rank}),Ge(r.shape.slice(0,r.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=r.shape[r.shape.length-1],D(n>0&&n<=o,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+o+"), but got "+n}),[4,r.data()];case 1:return i=m.sent(),[4,a.data()];case 2:for(s=m.sent(),l=[i.length/o,o],d=l[1],h=Xs("bool",c=l[0]),f=0;f<c;f++){for(p=f*d,v=i.subarray(p,p+d),g=[],y=0;y<v.length;y++)g.push({value:v[y],index:y});for(g.sort(function(x,b){return b.value-x.value}),h[f]=0,y=0;y<n;y++)if(g[y].index===s[f]){h[f]=1;break}}return e!==r&&r.dispose(),t!==a&&a.dispose(),[2,Ht(h,a.shape,"bool")]}})})};(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(tn||(tn={}));var kP=F({absoluteDifference_:function(e,t,n,r){r===void 0&&(r=tn.SUM_BY_NONZERO_WEIGHTS);var a=R(e,"labels","absoluteDifference"),o=R(t,"predictions","absoluteDifference"),i=null;n!=null&&(i=R(n,"weights","absoluteDifference")),Ge(a.shape,o.shape,"Error in absoluteDifference: ");var s=a.sub(o).abs();return sa(s,i,r)}}),sa=F({computeWeightedLoss_:function(e,t,n){n===void 0&&(n=tn.SUM_BY_NONZERO_WEIGHTS);var r=R(e,"losses","computeWeightedLoss"),a=null;t!=null&&(a=R(t,"weights","computeWeightedLoss"));var o=a==null?r:r.mul(a);if(n===tn.NONE)return o;if(n===tn.SUM)return o.sum();if(n===tn.MEAN){if(a==null)return o.mean();var i=r.size/a.size,s=o.sum().div(a.sum());return i>1?s.div(le(i)):s}if(n===tn.SUM_BY_NONZERO_WEIGHTS){if(a==null)return o.sum().div(le(r.size));var l=a.mul(Yi(r.shape)).notEqual(le(0)).sum().toFloat();return o.sum().div(l)}throw Error("Unknown reduction: "+n)}}),jP=F({cosineDistance_:function(e,t,n,r,a){a===void 0&&(a=tn.SUM_BY_NONZERO_WEIGHTS);var o=R(e,"labels","cosineDistance"),i=R(t,"predictions","cosineDistance"),s=null;r!=null&&(s=R(r,"weights","cosineDistance")),Ge(o.shape,i.shape,"Error in cosineDistance: ");var l=le(1).sub(o.mul(i).sum(n,!0));return sa(l,s,a)}}),SP=F({hingeLoss_:function(e,t,n,r){r===void 0&&(r=tn.SUM_BY_NONZERO_WEIGHTS);var a=R(e,"labels","hingeLoss"),o=R(t,"predictions","hingeLoss"),i=null;n!=null&&(i=R(n,"weights","hingeLoss")),Ge(a.shape,o.shape,"Error in hingeLoss: ");var s=le(1);a=le(2).mul(a).sub(s);var l=s.sub(a.mul(o)).relu();return sa(l,i,r)}}),EP=F({huberLoss_:function(e,t,n,r,a){r===void 0&&(r=1),a===void 0&&(a=tn.SUM_BY_NONZERO_WEIGHTS);var o=R(e,"labels","huberLoss"),i=R(t,"predictions","huberLoss"),s=null;n!=null&&(s=R(n,"weights","huberLoss")),Ge(o.shape,i.shape,"Error in huberLoss: ");var l=le(r),c=i.sub(o).abs(),d=LN(c,l),h=c.sub(d),f=le(.5).mul(d.square()).add(l.mul(h));return sa(f,s,a)}}),_P=F({logLoss_:function(e,t,n,r,a){r===void 0&&(r=1e-7),a===void 0&&(a=tn.SUM_BY_NONZERO_WEIGHTS);var o=R(e,"labels","logLoss"),i=R(t,"predictions","logLoss"),s=null;n!=null&&(s=R(n,"weights","logLoss")),Ge(o.shape,i.shape,"Error in logLoss: ");var l=le(1),c=le(r),d=o.mul(i.add(c).log()).neg().sub(l.sub(o).mul(l.sub(i).add(c).log()));return sa(d,s,a)}}),RP=F({meanSquaredError_:function(e,t,n,r){r===void 0&&(r=tn.SUM_BY_NONZERO_WEIGHTS);var a=R(e,"labels","meanSquaredError"),o=R(t,"predictions","meanSquaredError"),i=null;n!=null&&(i=R(n,"weights","meanSquaredError")),Ge(a.shape,o.shape,"Error in meanSquaredError: ");var s=a.squaredDifference(o);return sa(s,i,r)}}),IP=F({sigmoidCrossEntropy_:function(e,t,n,r,a){r===void 0&&(r=0),a===void 0&&(a=tn.SUM_BY_NONZERO_WEIGHTS);var o=R(e,"multiClassLabels","sigmoidCrossEntropy"),i=R(t,"logits","sigmoidCrossEntropy"),s=null;if(n!=null&&(s=R(n,"weights","sigmoidCrossEntropy")),Ge(o.shape,i.shape,"Error in sigmoidCrossEntropy: "),r>0){var l=le(r),c=le(1),d=le(.5);o=o.mul(c.sub(l)).add(d.mul(l))}var h=function(f,p){var v=R(f,"labels","sigmoidCrossEntropyWithLogits"),g=R(p,"logits","sigmoidCrossEntropyWithLogits");Ge(v.shape,g.shape,"Error in sigmoidCrossEntropyWithLogits: ");var y=g.relu(),m=g.mul(v),x=g.abs().neg().exp().log1p();return y.sub(m).add(x)}(o,i);return sa(h,s,a)}}),AP=F({softmaxCrossEntropy_:function(e,t,n,r,a){r===void 0&&(r=0),a===void 0&&(a=tn.SUM_BY_NONZERO_WEIGHTS);var o=R(e,"onehotLabels","softmaxCrossEntropy"),i=R(t,"logits","softmaxCrossEntropy"),s=null;if(n!=null&&(s=R(n,"weights","softmaxCrossEntropy")),Ge(o.shape,i.shape,"Error in softmaxCrossEntropy: "),r>0){var l=le(r),c=le(1),d=le(o.shape[1]);o=o.mul(c.sub(l)).add(l.div(d))}var h=function(f,p,v){if(v===void 0&&(v=-1),v===-1&&(v=p.rank-1),v!==p.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+p.rank+" and dim was "+v);return Jc(function(g,y,m){var x=y.logSumExp([v],!0),b=y.toFloat().sub(x);return m([g,b]),{value:b.mul(g).neg().sum([v]),gradFunc:function(w,N){var C=N[0],S=N[1],k=Cn(w.shape,[v]);return[w.reshape(k).mul(C.toFloat().sub(S.exp())),w.reshape(k).mul(S.exp().sub(C.toFloat()))]}}})(f,p)}(o,i);return sa(h,s,a)}}),DP=Object.freeze({get Reduction(){return tn},absoluteDifference:kP,computeWeightedLoss:sa,cosineDistance:jP,hingeLoss:SP,huberLoss:EP,logLoss:_P,meanSquaredError:RP,sigmoidCrossEntropy:IP,softmaxCrossEntropy:AP});function $y(e,t){return t===void 0&&(t=!1),O.tidy(function(){if(e.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],a=Jw(n),o=e.clone(),i=Oa([[1]],[1,1]),s=i.clone(),l=n>=r?r:n,c=function(h){var f,p=o,v=s,g=a;f=O.tidy(function(){var y=o.slice([h,h],[n-h,1]),m=y.norm(),x=o.slice([h,h],[1,1]),b=Oa([[-1]]).where(x.greater(0),Oa([[1]])),w=x.sub(b.mul(m)),N=y.div(w);s=N.shape[0]===1?i.clone():i.concat(N.slice([1,0],[N.shape[0]-1,N.shape[1]]),0);var C=b.matMul(w).div(m).neg(),S=o.slice([h,0],[n-h,r]),k=C.mul(s);if(h===0)o=S.sub(k.matMul(s.transpose().matMul(S)));else{var _=S.sub(k.matMul(s.transpose().matMul(S)));o=o.slice([0,0],[h,r]).concat(_,0)}var E=a.slice([0,h],[n,a.shape[1]-h]);if(h===0)a=E.sub(E.matMul(s).matMul(k.transpose()));else{var j=E.sub(E.matMul(s).matMul(k.transpose()));a=a.slice([0,0],[n,h]).concat(j,1)}return[s,o,a]}),s=f[0],o=f[1],a=f[2],Nn([p,v,g])},d=0;d<l;++d)c(d);return!t&&n>r&&(a=a.slice([0,0],[n,r]),o=o.slice([0,0],[r,r])),[a,o]})}var TP=F({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=R(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var a=r.shape,o=r.shape.slice(-2),i=o[0],s=o[1];if(!(t<=i))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+i+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");t<0&&(t=i),n<0&&(n=s);var l=sc(0,i,1,"int32").reshape([-1,1]),c=sc(0,s,1,"int32"),d=At(l,c),h=ed(d.lessEqual(le(+t,"int32")),d.greaterEqual(le(-n,"int32"))),f=et([i,s],r.dtype);return Pn(Rt(r.reshape([-1,i,s])).map(function(p){return Ro(h,p,f)})).reshape(a)}}),PP=F({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,D(e!=null&&e.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=e[0].shape[0],r=function(l){D(e[l].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[l].shape[0]+" vs. "+n+")"})},a=1;a<e.length;++a)r(a)}else t=!0,e=hm(e,e.shape[0],0).map(function(l){return tN(l,[0])});D(e.length<=e[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."});var o=[],i=e,s=function(l){o.push(O.tidy(function(){var c=i[l];if(l>0)for(var d=0;d<l;++d){var h=QN(o[d].mulStrict(c)).mul(o[d]);c=c.sub(h)}return c.div(tC(c,"euclidean"))}))};for(a=0;a<e.length;++a)s(a);return t?Pn(o,0):o}}),FP=F({qr_:function(e,t){if(t===void 0&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(e.rank===2)return $y(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce(function(i,s){return i*s}),r=Rt(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],o=[];return r.forEach(function(i){var s=$y(i,t),l=s[0],c=s[1];a.push(l),o.push(c)}),[Pn(a,0).reshape(e.shape),Pn(o,0).reshape(e.shape)]}}),MP=Object.freeze({bandPart:TP,gramSchmidt:PP,qr:FP});function ad(e,t,n,r,a,o){r==null&&(r=.5),a==null&&(a=Number.NEGATIVE_INFINITY),o==null&&(o=0);var i=e.shape[0];return n=Math.min(n,i),D(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),D(e.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"}),D(e.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]}),D(t.rank===1,function(){return"scores must be a 1D tensor"}),D(t.shape[0]===i,function(){return"scores has incompatible shape with boxes. Expected "+i+", but was "+t.shape[0]}),D(0<=o&&o<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+o+"'"}),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:o}}var OP=F({resizeBilinear_:function(e,t,n){n===void 0&&(n=!1);var r=R(e,"images","resizeBilinear");D(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),D(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var a=r,o=!1;r.rank===3&&(o=!0,a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var i=t[0],s=t[1],l=O.runKernelFunc(function(c,d){return d([a]),c.resizeBilinear(a,i,s,n)},{x:a},function(c,d){return{x:function(){return O.runKernelFunc(function(h){return h.resizeBilinearBackprop(c,d[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:i,newWidth:s});return o?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}}),LP=F({resizeNearestNeighbor_:function(e,t,n){n===void 0&&(n=!1);var r=R(e,"images","resizeNearestNeighbor");D(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),D(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),D(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var a=r,o=!1;r.rank===3&&(o=!0,a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var i=t[0],s=t[1],l=O.runKernelFunc(function(c,d){return d([a]),c.resizeNearestNeighbor(a,i,s,n)},{batchImages:a},function(c,d){return{batchImages:function(){return O.runKernelFunc(function(h){return h.resizeNearestNeighborBackprop(c,d[0],n)},{})}}});return o?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}}),BP=F({nonMaxSuppression_:function(e,t,n,r,a){r===void 0&&(r=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY);var o=R(e,"boxes","nonMaxSuppression"),i=R(t,"scores","nonMaxSuppression"),s=ad(o,i,n,r,a);n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold;var l={maxOutputSize:n,iouThreshold:r,scoreThreshold:a};return O.runKernelFunc(function(c){return c.nonMaxSuppression(o,i,n,r,a)},{boxes:o,scores:i},null,"NonMaxSuppressionV3",l)}}),zP=function(e,t,n,r,a){return r===void 0&&(r=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),fe(this,void 0,void 0,function(){var o,i,s,l,c,d,h;return pe(this,function(f){switch(f.label){case 0:return o=R(e,"boxes","nonMaxSuppressionAsync"),i=R(t,"scores","nonMaxSuppressionAsync"),s=ad(o,i,n,r,a),n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold,[4,Promise.all([o.data(),i.data()])];case 1:return l=f.sent(),c=l[0],d=l[1],h=vm(c,d,n,r,a),o!==e&&o.dispose(),i!==t&&i.dispose(),[2,h]}})})},$P=F({nonMaxSuppressionWithScore_:function(e,t,n,r,a,o){r===void 0&&(r=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),o===void 0&&(o=0);var i=R(e,"boxes","nonMaxSuppression"),s=R(t,"scores","nonMaxSuppression"),l=ad(i,s,n,r,a,o),c={maxOutputSize:n=l.maxOutputSize,iouThreshold:r=l.iouThreshold,scoreThreshold:a=l.scoreThreshold,softNmsSigma:o=l.softNmsSigma},d=O.runKernel("NonMaxSuppressionV5",{boxes:i,scores:s},c);return{selectedIndices:d[0],selectedScores:d[1]}}}),UP=function(e,t,n,r,a,o){return r===void 0&&(r=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),o===void 0&&(o=0),fe(this,void 0,void 0,function(){var i,s,l,c,d,h,f;return pe(this,function(p){switch(p.label){case 0:return i=R(e,"boxes","nonMaxSuppressionAsync"),s=R(t,"scores","nonMaxSuppressionAsync"),l=ad(i,s,n,r,a,o),n=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold,o=l.softNmsSigma,[4,Promise.all([i.data(),s.data()])];case 1:return c=p.sent(),d=c[0],h=c[1],f=gm(d,h,n,r,a,o),i!==e&&i.dispose(),s!==t&&s.dispose(),[2,f]}})})},WP=F({cropAndResize_:function(e,t,n,r,a,o){var i=R(e,"image","cropAndResize"),s=R(t,"boxes","cropAndResize","float32"),l=R(n,"boxInd","cropAndResize","int32");a=a||"bilinear",o=o||0;var c=s.shape[0];return D(i.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+i.rank+"."}),D(s.rank===2&&s.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+c+",4] but had shape "+s.shape+"."}),D(l.rank===1&&l.shape[0]===c,function(){return"Error in cropAndResize: boxInd must be have size ["+c+"] but had shape "+s.shape+"."}),D(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),D(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),D(a==="bilinear"||a==="nearest",function(){return"method must be bilinear or nearest, but was "+a}),O.runKernelFunc(function(d,h){return d.cropAndResize(i,s,l,r,a,o)},{images:i,boxes:s,boxInd:l},null,"CropAndResize",{method:a,extrapolationValue:o,cropSize:r})}}),Am=Object.freeze({resizeBilinear:OP,resizeNearestNeighbor:LP,nonMaxSuppression:BP,nonMaxSuppressionAsync:zP,nonMaxSuppressionWithScore:$P,nonMaxSuppressionWithScoreAsync:UP,cropAndResize:WP}),Dm=function(e,t){return!(e>0)||t==="linear"},Tm=function(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},Pm=function(e,t){var n=t,r=It(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},Fm=function(e,t,n){if(t==="linear")return e;if(t==="relu")return st(e);if(t==="elu")return JN(e);if(t==="relu6")return eC(e);if(t==="prelu")return ZN(e,n);throw new Error("Unknown fused activation "+t+".")},VP=F({fusedMatMul_:function(e){var t,n=e.a,r=e.b,a=e.transposeA,o=a!==void 0&&a,i=e.transposeB,s=i!==void 0&&i,l=e.bias,c=e.activation,d=c===void 0?"linear":c,h=e.preluActivationWeights;if(Dm(O.state.gradientDepth,d)===!1){var f=nd(n,r,o,s);return l!=null&&(f=Be(f,l)),Fm(f,d,h)}var p=R(n,"a","fused matMul"),v=R(r,"b","fused matMul");t=dt(p,v),p=t[0],v=t[1];var g=o?p.shape[p.rank-2]:p.shape[p.rank-1],y=s?v.shape[v.rank-1]:v.shape[v.rank-2],m=o?p.shape[p.rank-1]:p.shape[p.rank-2],x=s?v.shape[v.rank-2]:v.shape[v.rank-1],b=p.shape.slice(0,-2),w=v.shape.slice(0,-2),N=me(b),C=me(w);D(p.rank>=2&&v.rank>=2&&p.rank===v.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+p.rank+" and "+v.rank+"."}),D(Lt(b,w),function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+w+") of Tensors with shapes "+p.shape+" and "+v.shape+" must match."}),D(g===y,function(){return"Error in fused matMul: inner shapes ("+g+") and ("+y+") of Tensors with shapes "+p.shape+" and "+v.shape+" and transposeA="+o+" and transposeB="+s+" must match."});var S,k,_=p.shape.slice(0,-2).concat([m,x]),E=o?p.as3D(N,g,m):p.as3D(N,m,g),j=s?v.as3D(C,x,y):v.as3D(C,y,x);l!=null&&ze(_,(S=dt(S=R(l,"bias","fused matMul"),p)[0]).shape),h!=null&&(k=R(h,"prelu weights","fused matMul"));var T={a:E,b:j};l!=null&&(T.bias=S),h!=null&&(T.preluActivationWeights=k);var L=[E,j];return O.runKernelFunc(function(P,B){var K=P.fusedBatchMatMul({a:E,b:j,transposeA:o,transposeB:s,bias:S,activation:d,preluActivationWeights:k});return B([E,j,K]),K},T,function(P,B){var K=B[0],z=B[1],M=B[2],U=Tm(P,M,d),H={};return l!=null&&(H={bias:function(){return Pm(S,U)}}),Object.assign(o||s?!o&&s?{a:function(){return U.matMul(z,!1,!1)},b:function(){return U.matMul(K,!0,!1)}}:o&&!s?{a:function(){return z.matMul(U,!1,!0)},b:function(){return K.matMul(U,!1,!1)}}:{a:function(){return z.matMul(U,!0,!0)},b:function(){return U.matMul(K,!0,!0)}}:{a:function(){return U.matMul(z,!1,!0)},b:function(){return K.matMul(U,!0,!1)}},H)},"_FusedMatMul",{transposeA:o,transposeB:s,activation:d},L,[!0]).reshape(_)}}),HP=F({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,o=e.dataFormat,i=o===void 0?"NHWC":o,s=e.dilations,l=s===void 0?[1,1]:s,c=e.dimRoundingMode,d=e.bias,h=e.activation,f=h===void 0?"linear":h,p=e.preluActivationWeights;if(f=f||"linear",Dm(O.state.gradientDepth,f)===!1){var v=Xn(t,n,r,a,i,l,c);return d!=null&&(v=Be(v,d)),Fm(v,f,p)}var g=R(t,"x","conv2d"),y=R(n,"filter","conv2d"),m=g,x=!1;g.rank===3&&(x=!0,m=g.as4D(1,g.shape[0],g.shape[1],g.shape[2])),D(m.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+m.rank+"."}),D(y.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+y.rank+"."}),c!=null&&D(xt(a),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+a+"."}),D(m.shape[3]===y.shape[2],function(){return"Error in conv2d: depth of input ("+m.shape[3]+") must match input depth for filter "+y.shape[2]+"."}),D(kn(r,l),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+l+"'"}),D(i==="NHWC",function(){return"Error in conv2d: got dataFormat of "+i+" but only NHWC is currently supported."});var b,w,N=Fo(m.shape,y.shape,r,l,a,c);d!=null&&(b=dt(b=R(d,"bias","fused conv2d"),g)[0],ze(N.outShape,b.shape)),p!=null&&(w=R(p,"prelu weights","fused conv2d"));var C={x:m,filter:y};d!=null&&(C.bias=b),p!=null&&(C.preluActivationWeights=w);var S=[y,m],k=O.runKernelFunc(function(_,E){var j=_.fusedConv2d({input:m,filter:y,convInfo:N,bias:b,activation:f,preluActivationWeights:w});return E([y,m,j]),j},C,function(_,E){var j=E,T=j[0],L=j[1],P=j[2],B=Tm(_,P,f);D($i(l),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+l+"'"});var K={};return d!=null&&(K={bias:function(){return Pm(b,B)}}),Object.assign({x:function(){return VN(L.shape,B,T,r,a)},filter:function(){return jm(L,B,T.shape,r,a)}},K)},"FusedConv2D",{convInfo:N,activation:f},S,[!0]);return x?k.as3D(k.shape[1],k.shape[2],k.shape[3]):k}}),GP=F({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,o=e.dataFormat,i=o===void 0?"NHWC":o,s=e.dilations,l=s===void 0?[1,1]:s,c=e.dimRoundingMode,d=e.bias,h=e.activation,f=h===void 0?"linear":h,p=e.preluActivationWeights;if(Dm(O.state.gradientDepth,f)===!1){var v=td(t,n,r,a,i,l,c);return d!=null&&(v=Be(v,d)),Fm(v,f,p)}var g=R(t,"x","depthwiseConv2d"),y=R(n,"filter","depthwiseConv2d"),m=g,x=!1;g.rank===3&&(x=!0,m=g.as4D(1,g.shape[0],g.shape[1],g.shape[2])),D(m.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+m.rank+"."}),D(y.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+y.rank+"."}),D(m.shape[3]===y.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+m.shape[3]+") must match the inChannels dimension in filter "+y.shape[2]+"."}),l==null&&(l=[1,1]),D(kn(r,l),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+l+"'"}),c!=null&&D(xt(a),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+c+" but got pad "+a+"."});var b,w,N=Fo(m.shape,y.shape,r,l,a,c,!0);d!=null&&(b=dt(b=R(d,"bias","fused conv2d"),g)[0],ze(N.outShape,b.shape)),p!=null&&(w=R(p,"prelu weights","fused depthwiseConv2d"));var C={x:m,filter:y};d!=null&&(C.bias=b),p!=null&&(C.preluActivationWeights=w);var S=[y,m],k=O.runKernelFunc(function(_,E){var j=_.fusedDepthwiseConv2D({input:m,filter:y,convInfo:N,bias:b,activation:f,preluActivationWeights:w});return E([y,m,j]),j},C,function(_,E){D($i(l),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+l+"'"});var j=E[0],T=E[1],L=E[2],P=Tm(_,L,f),B={};return d!=null&&(B={bias:function(){return Pm(b,P)}}),Object.assign({x:function(){return HN(T.shape,P,j,N)},filter:function(){return GN(T,P,j.shape,N)}},B)},"FusedDepthwiseConv2D",{convInfo:N,activation:f},S,[!0]);return x?k.as3D(k.shape[1],k.shape[2],k.shape[3]):k}}),qP=Object.freeze({matMul:VP,conv2d:HP,depthwiseConv2d:GP}),KP=Object.freeze({image:Am,linalg:MP,losses:DP,spectral:gP,fused:qP,signal:NP,square:_D,squaredDifference:_N,conv1d:OT,conv2d:Xn,conv3d:LT,depthwiseConv2d:td,separableConv2d:Sm,conv2dTranspose:BT,conv3dTranspose:zT,op:F,batchNormalization2d:aT,batchNormalization3d:oT,batchNormalization4d:iT,batchNormalization:sT,batchNorm:PN,batchNorm2d:lT,batchNorm3d:uT,batchNorm4d:cT,booleanMaskAsync:MT,complex:Wt,real:Wn,imag:wr,concat:_t,concat1d:qI,concat2d:KI,concat3d:XI,concat4d:YI,split:hm,matMul:nd,dot:$T,outerProduct:UT,reverse:xl,reverse1d:WT,reverse2d:VT,reverse3d:HT,reverse4d:GT,maxPool:Pt,avgPool:yl,pool:qT,maxPool3d:KT,avgPool3d:XT,slice:Dr,slice1d:YT,slice2d:QT,slice3d:XN,slice4d:JT,abs:RD,acos:ID,acosh:AD,asin:DD,asinh:TD,atan:PD,atanh:FD,ceil:MD,clipByValue:Nm,cos:OD,cosh:LD,erf:BD,exp:zf,expm1:zD,floor:$D,log:UD,log1p:WD,logSigmoid:VD,neg:mc,reciprocal:HD,round:GD,rsqrt:RN,sigmoid:IN,sign:qD,isNaN:KD,isInf:XD,isFinite:YD,sin:QD,sinh:JD,softplus:ZD,sqrt:eT,step:tT,tan:nT,tanh:rT,all:ZT,any:eP,argMax:tP,argMin:nP,logSumExp:rP,max:rd,mean:aP,min:oP,moments:iP,sum:QN,prod:sP,equal:BN,equalStrict:ST,greater:ET,greaterEqual:zN,greaterEqualStrict:_T,greaterStrict:RT,less:IT,lessEqual:AT,lessEqualStrict:DT,lessStrict:TT,notEqual:PT,notEqualStrict:FT,add:Be,addN:fT,addStrict:pT,atan2:mT,div:tr,divNoNan:vT,divStrict:gT,floorDiv:ON,maximum:Cm,maximumStrict:xT,minimum:LN,minimumStrict:yT,mod:bT,modStrict:wT,mul:nn,mulStrict:NT,pow:vc,powStrict:CT,squaredDifferenceStrict:kT,sub:At,subStrict:jT,elu:JN,leakyRelu:lP,prelu:ZN,relu:st,relu6:eC,selu:uP,logicalAnd:ed,logicalNot:dT,logicalOr:FN,logicalXor:hT,where:Ro,whereAsync:MN,buffer:De,print:o5,batchToSpaceND:Qw,broadcastTo:i5,cast:s5,clone:l5,cumsum:u5,depthToSpace:c5,expandDims:Un,eye:Jw,multinomial:d5,oneHot:Mf,pad:Po,pad1d:h5,pad2d:f5,pad3d:p5,pad4d:m5,rand:v5,randomNormal:g5,randomGamma:x5,randomUniform:Zw,reshape:nr,spaceToBatchND:eN,squeeze:tN,stack:Pn,tile:vi,truncatedNormal:y5,unstack:Rt,setdiff1dAsync:b5,fill:Rr,linspace:GI,ones:Yi,range:sc,scalar:le,tensor:Ht,tensor1d:wt,tensor2d:Oa,tensor3d:dm,tensor4d:fn,tensor5d:WI,tensor6d:VI,variable:HI,zeros:et,onesLike:Yw,zerosLike:Ue,transpose:Wa,softmax:ia,logSoftmax:E5,localResponseNormalization:cP,norm:tC,gather:km,unsortedSegmentSum:$N,basicLSTMCell:dP,multiRNNCell:hP,movingAverage:fP,stridedSlice:pP,topk:mP,scatterND:vP,fft:Em,ifft:gc,rfft:_m,irfft:nC,sparseToDense:xP,gatherND:yP,diag:bP,dropout:wP,hannWindow:Rm,hammingWindow:aC,frame:Im,stft:oC,inTopKAsync:CP});function J(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(n){n!=null&&D(n.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function ch(e,t,n,r){if(n==="linear")return e.linear(t);if(n==="relu")return e.relu(t);if(n==="elu")return e.elu(t);if(n==="relu6")return e.relu6(t);if(n==="prelu")return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var XP=function(e){function t(){var n=e.call(this)||this;return n.blockSize=48,n.firstUse=!0,n.data=new lN(n,O),n}return cr(t,e),t.prototype.write=function(n,r,a){this.firstUse&&(this.firstUse=!1,X().get("IS_NODE")&&oc(`
============================
Hi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var o={};return this.data.set(o,{values:n,dtype:a}),o},t.prototype.move=function(n,r,a,o){this.data.set(n,{values:r,dtype:o})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(n){return fe(this,void 0,void 0,function(){return pe(this,function(r){return[2,this.readSync(n)]})})},t.prototype.readSync=function(n){var r=this.data.get(n),a=r.dtype,o=r.complexTensors;return a==="complex64"?Bf(this.readSync(o.real.dataId),this.readSync(o.imag.dataId)):this.data.get(n).values},t.prototype.bufferSync=function(n){var r=this.readSync(n.dataId),a=r;if(n.dtype==="string")try{a=r.map(function(o){return nc(o)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return De(n.shape,n.dtype,a)},t.prototype.makeOutput=function(n,r,a){var o=this.write(n,r,a);return O.makeTensorFromDataId(o,r,a,this)},t.prototype.disposeData=function(n){if(this.data.has(n)){var r=this.data.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(n)}},t.prototype.time=function(n){return fe(this,void 0,void 0,function(){var r;return pe(this,function(a){return r=xr(),n(),[2,{kernelMs:xr()-r}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(n,r){var a=this.makeOutput(null,n.shape,"complex64");return this.data.get(a.dataId).complexTensors={real:O.keep(n.clone()),imag:O.keep(r.clone())},a},t.prototype.real=function(n){return this.data.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.data.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,a){if(J(n,"slice"),iN(n.shape,r,a)){var o=sN(r,n.strides),i=me(a);return Ht(this.readSync(n.dataId).subarray(o,o+i),a,n.dtype)}for(var s=De(a,n.dtype),l=this.bufferSync(n),c=0;c<s.size;++c){var d=s.indexToLoc(c).map(function(h,f){return h+r[f]});s.values[c]=l.get.apply(l,d)}return s.toTensor()},t.prototype.stridedSlice=function(n,r,a,o){J(n,"stridedSlice");var i=pm(r,a,o);if(i.some(function(p){return p===0}))return Ht([],i);for(var s=De(i,n.dtype),l=this.bufferSync(n),c=0;c<s.size;c++){for(var d=s.indexToLoc(c),h=new Array(d.length),f=0;f<h.length;f++)h[f]=d[f]*o[f]+r[f];s.set.apply(s,[l.get.apply(l,h)].concat(d))}return s.toTensor()},t.prototype.diag=function(n){for(var r=this.readSync(n.dataId),a=De([n.size,n.size],n.dtype),o=a.values,i=0;i<r.length;i++)o[i*n.size+i]=r[i];return a.toTensor()},t.prototype.unstack=function(n,r){for(var a=n.shape[r],o=new Array(n.rank-1),i=0,s=0;s<n.rank;s++)s!==r&&(o[i++]=n.shape[s]);var l=new Array(n.rank).fill(0),c=n.shape.slice();c[r]=1;var d=new Array(a);for(s=0;s<d.length;s++)l[r]=s,d[s]=this.slice(n,l,c).reshape(o);return d},t.prototype.reverse=function(n,r){J(n,"reverse");for(var a=De(n.shape,n.dtype),o=this.bufferSync(n),i=function(l){var c=a.indexToLoc(l),d=c.slice();r.forEach(function(h){return d[h]=n.shape[h]-1-d[h]}),a.set.apply(a,[o.get.apply(o,d)].concat(c))},s=0;s<a.size;s++)i(s);return a.toTensor()},t.prototype.concat=function(n,r){var a=this;if(n[0].dtype==="complex64"){var o=n.map(function(p){return Wn(p)}),i=n.map(function(p){return wr(p)});return Wt(this.concat(o,r),this.concat(i,r))}var s=n.map(function(p){var v=me(p.shape.slice(r));return p.as2D(-1,v)}),l=zi(s.map(function(p){return p.shape}),1),c=De(l,n[0].dtype).values;if(s[0].shape[0]===1){var d=0;s.forEach(function(p){c.set(a.readSync(p.dataId),d),d+=p.size})}else{var h=0;s.forEach(function(p){for(var v=a.readSync(p.dataId),g=0,y=0;y<p.shape[0];++y)for(var m=y*l[1]+h,x=0;x<p.shape[1];++x)c[m+x]=v[g++];h+=p.shape[1]})}var f=zi(n.map(function(p){return p.shape}),r);return Ht(c,f,n[0].dtype)},t.prototype.neg=function(n){return J(n,"neg"),this.multiply(le(-1),n)},t.prototype.add=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(a,o,i,s){return{real:a+i,imag:o+s}}):this.broadcastedBinaryOp(n,r,Vt(n.dtype,r.dtype),function(a,o){return a+o})},t.prototype.addN=function(n){var r=this;J(n,"addN");for(var a=n.map(function(d){return r.readSync(d.dataId)}),o=De(n[0].shape,n[0].dtype),i=o.values,s=0;s<n.length;s++)for(var l=a[s],c=0;c<i.length;c++)i[c]+=l[c];return o.toTensor()},t.prototype.softmax=function(n,r){var a=Dt([r],n.shape),o=this.max(n,a),i=Cn(o.shape,a),s=this.subtract(n,o.reshape(i)),l=this.exp(s),c=this.sum(l,a).reshape(i);return this.realDivide(l,c)},t.prototype.subtract=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(a,o,i,s){return{real:a-i,imag:o-s}}):this.broadcastedBinaryOp(n,r,Vt(n.dtype,r.dtype),function(a,o){return a-o})},t.prototype.pow=function(n,r){return J([n,r],"pow"),this.broadcastedBinaryOp(n,r,n.dtype,function(a,o){return Math.pow(a,o)})},t.prototype.batchMatMul=function(n,r,a,o){J([n,r],"matMul");for(var i=a?n.shape[1]:n.shape[2],s=a?n.shape[2]:n.shape[1],l=o?r.shape[1]:r.shape[2],c=n.shape[0],d=this.readSync(n.dataId),h=this.readSync(r.dataId),f=a?[n.strides[0],1,n.strides[1]]:[n.strides[0],n.strides[1],1],p=f[0],v=f[1],g=f[2],y=o?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],m=y[0],x=y[1],b=y[2],w=s*l,N=De([c,s,l],n.dtype),C=N.values,S=this.blockSize,k=0;k<c;k++)for(var _=0;_<s;_+=S)for(var E=0;E<l;E+=S)for(var j=0;j<i;j+=S)for(var T=Math.min(_+S,s),L=Math.min(E+S,l),P=Math.min(j+S,i),B=_;B<T;B++)for(var K=E;K<L;K++){for(var z=0,M=j;M<P;M++)z+=d[k*p+B*v+M*g]*h[M*m+K*x+k*b];C[k*w+(B*l+K)]+=z}return N.toTensor()},t.prototype.fusedBatchMatMul=function(n){var r=n.a,a=n.b,o=n.transposeA,i=n.transposeB,s=n.bias,l=n.activation,c=n.preluActivationWeights,d=this.batchMatMul(r,a,o,i);return s&&(d=this.add(d,s)),l&&(d=ch(this,d,l,c)),d},t.prototype.multiply=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(a,o,i,s){return{real:a*i-o*s,imag:a*s+o*i}}):this.broadcastedBinaryOp(n,r,Vt(n.dtype,r.dtype),function(a,o){return a*o})},t.prototype.realDivide=function(n,r){return J([n,r],"realDivide"),this.broadcastedBinaryOp(n,r,"float32",function(a,o){return a/o})},t.prototype.floorDiv=function(n,r){return J([n,r],"floorDiv"),this.broadcastedBinaryOp(n,r,"int32",function(a,o){return Math.floor(a/o)})},t.prototype.sum=function(n,r){J(n,"sum"),Sn("sum",r,n.rank);for(var a=Yt(n.shape,r),o=a[0],i=a[1],s=et(o,Vt(n.dtype,"int32")),l=me(i),c=this.readSync(s.dataId),d=this.readSync(n.dataId),h=0;h<c.length;++h){for(var f=h*l,p=0,v=0;v<l;++v)p+=d[f+v];c[h]=p}return s},t.prototype.prod=function(n,r){J(n,"sum");for(var a=Yt(n.shape,r),o=a[0],i=a[1],s=et(o,Vt(n.dtype,"int32")),l=me(i),c=this.readSync(s.dataId),d=this.readSync(n.dataId),h=0;h<c.length;++h){for(var f=h*l,p=1,v=0;v<l;++v)p*=d[f+v];c[h]=p}return s},t.prototype.unsortedSegmentSum=function(n,r,a){J(n,"unsortedSegmentSum");for(var o=[],i=n.rank-r.rank,s=0;s<i;++s)r=r.expandDims(s+1);for(s=0;s<a;++s){var l=le(s,"int32"),c=BN(l,r).asType("float32").mul(n).sum(0);o.push(c)}return Pn(o)},t.prototype.argMin=function(n,r){J(n,"argMin");var a=[r];Sn("argMin",a,n.rank);for(var o=Yt(n.shape,a),i=o[0],s=o[1],l=et(i,"int32"),c=me(s),d=this.readSync(l.dataId),h=this.readSync(n.dataId),f=0;f<d.length;++f){for(var p=f*c,v=h[p],g=0,y=0;y<c;++y){var m=h[p+y];m<v&&(v=m,g=y)}d[f]=g}return l},t.prototype.argMax=function(n,r){J(n,"argMax");var a=[r];Sn("argMax",a,n.rank);for(var o=Yt(n.shape,a),i=o[0],s=o[1],l=et(i,"int32"),c=me(s),d=this.readSync(l.dataId),h=this.readSync(n.dataId),f=0;f<d.length;++f){for(var p=f*c,v=h[p],g=0,y=0;y<c;++y){var m=h[p+y];m>v&&(v=m,g=y)}d[f]=g}return l},t.prototype.cumsum=function(n,r,a,o){if(J(n,"cumsum"),r!==n.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(n.rank-1)+" but got axis="+r);for(var i=Vt(n.dtype,"int32"),s=et(n.shape,i),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=n.shape[n.rank-1],h=o?function(y,m){return y+d-m-1}:function(y,m){return y+m},f=0;f<c.length;f+=d)for(var p=0;p<d;p++){var v=h(f,p);if(p===0)l[v]=a?0:c[v];else{var g=h(f,p-1);l[v]=a?c[g]+l[g]:c[v]+l[g]}}return s},t.prototype.equal=function(n,r){return J([n,r],"equal"),this.broadcastedBinaryOp(n,r,"bool",function(a,o){return a===o?1:0})},t.prototype.notEqual=function(n,r){return J([n,r],"notEqual"),this.broadcastedBinaryOp(n,r,"bool",function(a,o){return a!==o?1:0})},t.prototype.less=function(n,r){return J([n,r],"less"),this.broadcastedBinaryOp(n,r,"bool",function(a,o){return a<o?1:0})},t.prototype.lessEqual=function(n,r){return J([n,r],"lessEqual"),this.broadcastedBinaryOp(n,r,"bool",function(a,o){return a<=o?1:0})},t.prototype.greater=function(n,r){return J([n,r],"greater"),this.broadcastedBinaryOp(n,r,"bool",function(a,o){return a>o?1:0})},t.prototype.greaterEqual=function(n,r){return J([n,r],"greaterEqual"),this.broadcastedBinaryOp(n,r,"bool",function(a,o){return a>=o?1:0})},t.prototype.logicalNot=function(n){J(n,"logicalNot");for(var r=this.readSync(n.dataId),a=new Uint8Array(r.length),o=0;o<r.length;++o)a[o]=r[o]?0:1;return this.makeOutput(a,n.shape,"bool")},t.prototype.logicalAnd=function(n,r){return J([n,r],"logicalAnd"),this.broadcastedBinaryOp(n,r,"bool",function(a,o){return a&&o})},t.prototype.logicalOr=function(n,r){return J([n,r],"logicalOr"),this.broadcastedBinaryOp(n,r,"bool",function(a,o){return a||o})},t.prototype.select=function(n,r,a){J([n,r,a],"select");for(var o=this.readSync(n.dataId),i=this.readSync(r.dataId),s=this.readSync(a.dataId),l=et(r.shape,Vt(r.dtype,a.dtype)),c=this.readSync(l.dataId),d=0,h=n.rank===0||n.rank>1||r.rank===1?1:me(r.shape.slice(1)),f=0;f<o.length;f++)for(var p=0;p<h;p++)o[f]===1?c[d++]=i[f]:c[d++]=s[f];return l},t.prototype.where=function(n){J([n],"where");var r=this.readSync(n.dataId);return xm(n.shape,r)},t.prototype.topk=function(n,r,a){return J(n,"topk"),vN(this.readSync(n.dataId),n.shape,n.dtype,r)},t.prototype.min=function(n,r){J(n,"min"),Sn("min",r,n.rank);for(var a=Yt(n.shape,r),o=a[0],i=a[1],s=et(o,n.dtype),l=me(i),c=this.readSync(s.dataId),d=this.readSync(n.dataId),h=0;h<c.length;++h){for(var f=h*l,p=d[f],v=0;v<l;++v){var g=d[f+v];g<p&&(p=g)}c[h]=p}return s},t.prototype.minimum=function(n,r){return J([n,r],"minimum"),this.broadcastedBinaryOp(n,r,n.dtype,function(a,o){return Math.min(a,o)})},t.prototype.mod=function(n,r){return J([n,r],"mod"),this.broadcastedBinaryOp(n,r,n.dtype,function(a,o){var i=a%o;return a<0&&o<0||a>=0&&o>=0?i:(i+o)%o})},t.prototype.max=function(n,r){J(n,"max"),Sn("max",r,n.rank);for(var a=Yt(n.shape,r),o=a[0],i=a[1],s=et(o,n.dtype),l=me(i),c=this.readSync(s.dataId),d=this.readSync(n.dataId),h=0;h<c.length;++h){for(var f=h*l,p=d[f],v=0;v<l;++v){var g=d[f+v];g>p&&(p=g)}c[h]=p}return s},t.prototype.maximum=function(n,r){return J([n,r],"maximum"),this.broadcastedBinaryOp(n,r,n.dtype,function(a,o){return Math.max(a,o)})},t.prototype.all=function(n,r){J(n,"all"),Sn("all",r,n.rank);for(var a=Yt(n.shape,r),o=a[0],i=a[1],s=et(o,n.dtype),l=me(i),c=this.readSync(s.dataId),d=this.readSync(n.dataId),h=0;h<c.length;++h){for(var f=h*l,p=d[f],v=0;v<l;++v){var g=d[f+v];p=p&&g}c[h]=p}return s},t.prototype.any=function(n,r){J(n,"any"),Sn("any",r,n.rank);for(var a=Yt(n.shape,r),o=a[0],i=a[1],s=et(o,n.dtype),l=me(i),c=this.readSync(s.dataId),d=this.readSync(n.dataId),h=0;h<c.length;++h){for(var f=h*l,p=d[f],v=0;v<l;++v){var g=d[f+v];p=p||g}c[h]=p}return s},t.prototype.squaredDifference=function(n,r){return J([n,r],"squaredDifference"),this.broadcastedBinaryOp(n,r,n.dtype,function(a,o){var i=a-o;return i*i})},t.prototype.ceil=function(n){J(n,"ceil");for(var r=this.readSync(n.dataId),a=new Float32Array(r.length),o=0;o<r.length;++o)a[o]=Math.ceil(r[o]);return this.makeOutput(a,n.shape,"float32")},t.prototype.floor=function(n){J(n,"floor");for(var r=this.readSync(n.dataId),a=new Float32Array(r.length),o=0;o<r.length;++o)a[o]=Math.floor(r[o]);return this.makeOutput(a,n.shape,"float32")},t.prototype.sign=function(n){J(n,"x");for(var r=this.readSync(n.dataId),a=new Float32Array(r.length),o=0;o<r.length;++o)r[o]<0?a[o]=-1:r[o]>0?a[o]=1:a[o]=0;return this.makeOutput(a,n.shape,"float32")},t.prototype.isNaN=function(n){J(n,"x");for(var r=this.readSync(n.dataId),a=new Uint8Array(r.length),o=0;o<r.length;++o)Number.isNaN(r[o])&&(a[o]=1);return this.makeOutput(a,n.shape,"bool")},t.prototype.isInf=function(n){J(n,"x");for(var r=this.readSync(n.dataId),a=new Uint8Array(r.length),o=0;o<r.length;++o)Math.abs(r[o])===1/0&&(a[o]=1);return this.makeOutput(a,n.shape,"bool")},t.prototype.isFinite=function(n){J(n,"x");for(var r=this.readSync(n.dataId),a=new Uint8Array(r.length),o=0;o<r.length;++o)Number.isFinite(r[o])&&(a[o]=1);return this.makeOutput(a,n.shape,"bool")},t.prototype.round=function(n){J(n,"round");for(var r=this.readSync(n.dataId),a=new Float32Array(r.length),o=0;o<r.length;++o){var i=Math.floor(r[o]);r[o]-i<.5?a[o]=Math.floor(r[o]):r[o]-i>.5?a[o]=Math.ceil(r[o]):a[o]=i%2==0?i:i+1}return this.makeOutput(a,n.shape,"float32")},t.prototype.exp=function(n){J(n,"exp");for(var r=this.readSync(n.dataId),a=new Float32Array(r.length),o=0;o<r.length;++o)a[o]=Math.exp(r[o]);return this.makeOutput(a,n.shape,"float32")},t.prototype.expm1=function(n){J(n,"expm1");for(var r=this.readSync(n.dataId),a=new Float32Array(r.length),o=0;o<r.length;++o)a[o]=Math.expm1(r[o]);return this.makeOutput(a,n.shape,"float32")},t.prototype.log=function(n){J(n,"log");for(var r=this.readSync(n.dataId),a=new Float32Array(r.length),o=0;o<r.length;++o){var i=r[o];a[o]=Math.log(i)}return this.makeOutput(a,n.shape,"float32")},t.prototype.log1p=function(n){J(n,"log1p");for(var r=this.readSync(n.dataId),a=new Float32Array(r.length),o=0;o<r.length;++o){var i=r[o];a[o]=Math.log1p(i)}return this.makeOutput(a,n.shape,"float32")},t.prototype.sqrt=function(n){J(n,"sqrt");for(var r=this.readSync(n.dataId),a=new Float32Array(r.length),o=0;o<r.length;++o){var i=r[o];a[o]=Math.sqrt(i)}return this.makeOutput(a,n.shape,"float32")},t.prototype.rsqrt=function(n){J(n,"rsqrt");for(var r=this.readSync(n.dataId),a=new Float32Array(r.length),o=0;o<r.length;++o){var i=r[o];a[o]=1/Math.sqrt(i)}return this.makeOutput(a,n.shape,"float32")},t.prototype.reciprocal=function(n){J(n,"reciprocal");for(var r=this.readSync(n.dataId),a=new Float32Array(r.length),o=0;o<r.length;++o)a[o]=1/r[o];return this.makeOutput(a,n.shape,"float32")},t.prototype.linear=function(n){return n},t.prototype.relu=function(n){J(n,"relu");for(var r=et(n.shape,n.dtype),a=this.readSync(r.dataId),o=this.readSync(n.dataId),i=0;i<o.length;++i)a[i]=Math.max(0,o[i]);return r},t.prototype.relu6=function(n){J(n,"relu");for(var r=et(n.shape,n.dtype),a=this.readSync(r.dataId),o=this.readSync(n.dataId),i=0;i<o.length;++i)a[i]=Math.min(Math.max(0,o[i]),6);return r},t.prototype.prelu=function(n,r){return J([n,r],"prelu"),this.broadcastedBinaryOp(n,r,n.dtype,function(a,o){return a<0?o*a:a})},t.prototype.elu=function(n){J(n,"elu");for(var r=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o){var i=a[o];r[o]=i>=0?i:Math.exp(i)-1}return this.makeOutput(r,n.shape,"float32")},t.prototype.eluDer=function(n,r){J([n,r],"eluDer");for(var a=new Float32Array(r.size),o=this.readSync(r.dataId),i=this.readSync(n.dataId),s=0;s<o.length;++s){var l=o[s];a[s]=l>=1?i[s]:i[s]*(l+1)}return this.makeOutput(a,r.shape,"float32")},t.prototype.selu=function(n){J(n,"selu");for(var r=bm,a=wm,o=new Float32Array(n.size),i=this.readSync(n.dataId),s=0;s<i.length;++s){var l=i[s];o[s]=l>=0?a*l:r*(Math.exp(l)-1)}return this.makeOutput(o,n.shape,"float32")},t.prototype.clip=function(n,r,a){J(n,"clip");for(var o=new Float32Array(n.size),i=this.readSync(n.dataId),s=0;s<i.length;++s){var l=i[s];o[s]=l>a?a:l<r?r:l}return this.makeOutput(o,n.shape,"float32")},t.prototype.abs=function(n){for(var r=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o)r[o]=Math.abs(a[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.complexAbs=function(n){for(var r=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<n.size;++o){var i=a[2*o],s=a[2*o+1];r[o]=Math.hypot(i,s)}return this.makeOutput(r,n.shape,"float32")},t.prototype.int=function(n){J(n,"int");for(var r=new Int32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o)r[o]=a[o];return this.makeOutput(r,n.shape,"int32")},t.prototype.sigmoid=function(n){J(n,"sigmoid");for(var r=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o)r[o]=1/(1+Math.exp(-a[o]));return this.makeOutput(r,n.shape,"float32")},t.prototype.softplus=function(n){J(n,"softplus");for(var r=Math.log(11920928955078125e-23)+2,a=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i){var s=o[i]>-r,l=o[i]<r,c=Math.exp(o[i]),d=void 0;d=l?c:s?o[i]:Math.log(1+c),a[i]=d}return this.makeOutput(a,n.shape,"float32")},t.prototype.sin=function(n){J(n,"sin");for(var r=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o)r[o]=Math.sin(a[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cos=function(n){J(n,"cos");for(var r=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o)r[o]=Math.cos(a[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tan=function(n){J(n,"tan");for(var r=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o)r[o]=Math.tan(a[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asin=function(n){J(n,"asin");for(var r=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o)r[o]=Math.asin(a[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acos=function(n){J(n,"acos");for(var r=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o)r[o]=Math.acos(a[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan=function(n){J(n,"atan");for(var r=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o)r[o]=Math.atan(a[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan2=function(n,r){return J([n,r],"atan2"),this.broadcastedBinaryOp(n,r,n.dtype,function(a,o){return Math.atan2(a,o)})},t.prototype.sinh=function(n){J(n,"sinh");for(var r=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o)r[o]=Math.sinh(a[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cosh=function(n){J(n,"cosh");for(var r=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o)r[o]=Math.cosh(a[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tanh=function(n){J(n,"tanh");for(var r=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o)r[o]=YR(a[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asinh=function(n){J(n,"asinh");for(var r=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o)r[o]=Math.asinh(a[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acosh=function(n){J(n,"acosh");for(var r=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o)r[o]=Math.acosh(a[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atanh=function(n){J(n,"atanh");for(var r=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o)r[o]=Math.atanh(a[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.erf=function(n){J(n,"erf");for(var r=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o){var i=Math.sign(a[o]),s=Math.abs(a[o]),l=1/(1+.3275911*s);r[o]=i*(1-((((1.061405429*l-1.453152027)*l+1.421413741)*l-.284496736)*l+.254829592)*l*Math.exp(-s*s))}return this.makeOutput(r,n.shape,"float32")},t.prototype.step=function(n,r){r===void 0&&(r=0),J(n,"step");for(var a=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i){var s=o[i];isNaN(s)?a[i]=NaN:a[i]=s>0?1:r}return this.makeOutput(a,n.shape,"float32")},t.prototype.fusedConv2d=function(n){var r=n.input,a=n.filter,o=n.convInfo,i=n.bias,s=n.activation,l=n.preluActivationWeights,c=this.conv2d(r,a,o);return i&&(c=this.add(c,i)),s&&(c=ch(this,c,s,l)),c},t.prototype.conv2d=function(n,r,a){J([n,r],"conv2d");for(var o=a.filterHeight,i=a.filterWidth,s=a.dilationHeight,l=a.dilationWidth,c=a.padInfo.left,d=a.padInfo.top,h=a.dataFormat==="channelsLast",f=De(a.outShape,n.dtype),p=n.strides[0],v=h?n.strides[1]:n.strides[2],g=h?n.strides[2]:1,y=h?1:n.strides[1],m=f.strides[0],x=h?f.strides[1]:f.strides[2],b=h?f.strides[2]:1,w=h?1:f.strides[1],N=this.readSync(n.dataId),C=this.readSync(r.dataId),S=f.values,k=0;k<a.batchSize;++k)for(var _=k*p,E=k*m,j=0;j<a.outHeight;++j)for(var T=E+j*x,L=j*a.strideHeight-d,P=0;P<o;P++){var B=L+P*s;if(!(B<0||B>=a.inHeight))for(var K=P*r.strides[0],z=_+B*v,M=0;M<a.outWidth;++M)for(var U=T+M*b,H=M*a.strideWidth-c,Z=0;Z<i;Z++){var ne=H+Z*l;if(!(ne<0||ne>=a.inWidth))for(var ue=z+ne*g,he=K+Z*r.strides[1],ye=0;ye<a.inChannels;++ye){for(var we=N[ue+ye*y],ke=0;ke<a.outChannels;++ke)S[U+ke*w]+=we*C[he+ke];he+=a.outChannels}}}return f.toTensor()},t.prototype.conv3d=function(n,r,a){for(var o=a.filterDepth,i=a.filterHeight,s=a.filterWidth,l=a.dilationDepth,c=a.dilationHeight,d=a.dilationWidth,h=a.padInfo.front,f=a.padInfo.left,p=a.padInfo.top,v=De(a.outShape,n.dtype),g=this.readSync(n.dataId),y=this.readSync(r.dataId),m=v.values,x=0;x<a.batchSize;++x)for(var b=x*n.strides[0],w=x*v.strides[0],N=0;N<a.outDepth;++N)for(var C=w+N*v.strides[1],S=N*a.strideDepth-h,k=0;k<o;k++){var _=S+k*l;if(!(_<0||_>=a.inDepth))for(var E=k*r.strides[0],j=b+_*n.strides[1],T=0;T<a.outHeight;++T)for(var L=C+T*v.strides[2],P=T*a.strideHeight-p,B=0;B<i;B++){var K=P+B*c;if(!(K<0||K>=a.inHeight))for(var z=E+B*r.strides[1],M=j+K*n.strides[2],U=0;U<a.outWidth;++U)for(var H=L+U*a.outChannels,Z=U*a.strideWidth-f,ne=0;ne<s;ne++){var ue=Z+ne*d;if(!(ue<0||ue>=a.inWidth))for(var he=z+ne*r.strides[2],ye=M+ue*a.inChannels,we=he,ke=0;ke<a.inChannels;++ke){for(var Ie=g[ye+ke],Ee=0;Ee<a.outChannels;++Ee)m[H+Ee]+=Ie*y[we+Ee];we+=a.outChannels}}}}return v.toTensor()},t.prototype.conv2dDerInput=function(n,r,a){J([n,r],"conv2dDerInput");for(var o=De(a.inShape,"float32"),i=o.values,s=this.readSync(n.dataId),l=this.readSync(r.dataId),c=r.strides,d=c[0],h=c[1],f=c[2],p=a.batchSize,v=a.filterHeight,g=a.filterWidth,y=a.inChannels,m=a.inHeight,x=a.inWidth,b=a.outChannels,w=a.outHeight,N=a.outWidth,C=a.strideHeight,S=a.strideWidth,k=a.dataFormat,_=v-1-a.padInfo.top,E=g-1-a.padInfo.left,j=k==="channelsLast",T=o.strides[0],L=j?o.strides[1]:o.strides[2],P=j?o.strides[2]:1,B=j?1:o.strides[1],K=n.strides[0],z=j?n.strides[1]:n.strides[2],M=j?n.strides[2]:1,U=j?1:n.strides[1],H=0;H<p;++H)for(var Z=0;Z<y;++Z)for(var ne=0;ne<m;++ne)for(var ue=ne-_,he=Math.max(0,Math.ceil(ue/C)),ye=Math.min(w,(v+ue)/C),we=0;we<x;++we){for(var ke=we-E,Ie=Math.max(0,Math.ceil(ke/S)),Ee=Math.min(N,(g+ke)/S),Ke=0,Te=he;Te<ye;++Te)for(var Ae=Te*C-ue,Q=Ie;Q<Ee;++Q)for(var Ce=K*H+z*Te+M*Q,_e=d*(v-1-Ae)+h*(g-1-(Q*S-ke))+f*Z,Le=0;Le<b;++Le)Ke+=s[Ce+U*Le]*l[_e+Le];i[T*H+L*ne+P*we+B*Z]=Ke}return o.toTensor()},t.prototype.conv3dDerInput=function(n,r,a){for(var o=De(a.inShape,"float32"),i=o.values,s=o.strides,l=s[0],c=s[1],d=s[2],h=s[3],f=this.readSync(n.dataId),p=n.strides,v=p[0],g=p[1],y=p[2],m=p[3],x=this.readSync(r.dataId),b=r.strides,w=b[0],N=b[1],C=b[2],S=b[3],k=a.batchSize,_=a.filterDepth,E=a.filterHeight,j=a.filterWidth,T=a.inChannels,L=a.inDepth,P=a.inHeight,B=a.inWidth,K=a.outChannels,z=a.outDepth,M=a.outHeight,U=a.outWidth,H=a.strideDepth,Z=a.strideHeight,ne=a.strideWidth,ue=_-1-a.padInfo.front,he=E-1-a.padInfo.top,ye=j-1-a.padInfo.left,we=0;we<k;++we)for(var ke=0;ke<T;++ke)for(var Ie=0;Ie<L;++Ie)for(var Ee=Ie-ue,Ke=Math.max(0,Math.ceil(Ee/H)),Te=Math.min(z,(_+Ee)/H),Ae=0;Ae<P;++Ae)for(var Q=Ae-he,Ce=Math.max(0,Math.ceil(Q/Z)),_e=Math.min(M,(E+Q)/Z),Le=0;Le<B;++Le){for(var Ye=Le-ye,pt=Math.max(0,Math.ceil(Ye/ne)),mt=Math.min(U,(j+Ye)/ne),zt=0,$t=Ke;$t<Te;++$t)for(var te=$t*H-Ee,oe=Ce;oe<_e;++oe)for(var Ne=oe*Z-Q,Oe=pt;Oe<mt;++Oe)for(var yt=v*we+g*$t+y*oe+m*Oe,Tt=w*(_-1-te)+N*(E-1-Ne)+C*(j-1-(Oe*ne-Ye))+S*ke,Nt=0;Nt<K;++Nt)zt+=f[yt+Nt]*x[Tt+Nt];i[l*we+c*Ie+d*Ae+h*Le+ke]=zt}return o.toTensor()},t.prototype.conv2dDerFilter=function(n,r,a){J([n,r],"conv2dDerFilter");for(var o=a.strideHeight,i=a.strideWidth,s=a.filterHeight,l=a.filterWidth,c=a.dataFormat==="channelsLast",d=De(a.filterShape,"float32"),h=a.padInfo.left,f=a.padInfo.top,p=this.bufferSync(n),v=this.bufferSync(r),g=0;g<s;++g)for(var y=Math.max(0,Math.ceil((f-g)/o)),m=Math.min(a.outHeight,(a.inHeight+f-g)/o),x=0;x<l;++x)for(var b=Math.max(0,Math.ceil((h-x)/i)),w=Math.min(a.outWidth,(a.inWidth+h-x)/i),N=0;N<a.inChannels;++N)for(var C=0;C<a.outChannels;++C){for(var S=0,k=0;k<a.batchSize;++k)for(var _=y;_<m;++_)for(var E=g+_*o-f,j=b;j<w;++j){var T=x+j*i-h;S+=c?p.get(k,E,T,N)*v.get(k,_,j,C):p.get(k,N,E,T)*v.get(k,C,_,j)}d.set(S,g,x,N,C)}return d.toTensor()},t.prototype.conv3dDerFilter=function(n,r,a){for(var o=a.strideDepth,i=a.strideHeight,s=a.strideWidth,l=a.filterDepth,c=a.filterHeight,d=a.filterWidth,h=De(a.filterShape,"float32"),f=h.values,p=h.strides,v=p[0],g=p[1],y=p[2],m=p[3],x=this.readSync(r.dataId),b=r.strides,w=b[0],N=b[1],C=b[2],S=b[3],k=this.readSync(n.dataId),_=n.strides,E=_[0],j=_[1],T=_[2],L=_[3],P=a.padInfo.front,B=a.padInfo.left,K=a.padInfo.top,z=0;z<l;++z)for(var M=Math.max(0,Math.ceil((P-z)/o)),U=Math.min(a.outDepth,(a.inDepth+P-z)/o),H=z*v,Z=0;Z<c;++Z)for(var ne=Math.max(0,Math.ceil((K-Z)/i)),ue=Math.min(a.outHeight,(a.inHeight+K-Z)/i),he=Z*g+H,ye=0;ye<d;++ye)for(var we=Math.max(0,Math.ceil((B-ye)/s)),ke=Math.min(a.outWidth,(a.inWidth+B-ye)/s),Ie=ye*y+he,Ee=0;Ee<a.inChannels;++Ee)for(var Ke=Ee*m+Ie,Te=0;Te<a.outChannels;++Te){for(var Ae=0,Q=0;Q<a.batchSize;++Q)for(var Ce=Q*E,_e=Q*w,Le=M;Le<U;++Le)for(var Ye=(z+Le*o-P)*j+Ce,pt=Le*N+_e,mt=ne;mt<ue;++mt)for(var zt=(Z+mt*i-K)*T+Ye,$t=mt*C+pt,te=we;te<ke;++te){var oe=te*S+$t;Ae+=k[(ye+te*s-B)*L+zt+Ee]*x[oe+Te]}f[Ke+Te]=Ae}return h.toTensor()},t.prototype.fusedDepthwiseConv2D=function(n){var r=n.input,a=n.filter,o=n.convInfo,i=n.bias,s=n.activation,l=n.preluActivationWeights,c=this.depthwiseConv2D(r,a,o);return i&&(c=this.add(c,i)),s&&(c=ch(this,c,s,l)),c},t.prototype.depthwiseConv2D=function(n,r,a){J([n,r],"depthwiseConv2D");for(var o=a.filterHeight,i=a.filterWidth,s=a.dilationHeight,l=a.dilationWidth,c=a.padInfo.left,d=a.padInfo.top,h=a.outChannels/a.inChannels,f=De(a.outShape,n.dtype),p=this.readSync(n.dataId),v=this.readSync(r.dataId),g=f.values,y=0;y<a.batchSize;++y)for(var m=y*n.strides[0],x=y*f.strides[0],b=0;b<a.outHeight;++b)for(var w=x+b*f.strides[1],N=b*a.strideHeight-c,C=0;C<o;++C){var S=N+C*s;if(!(S<0||S>=a.inHeight))for(var k=C*r.strides[0],_=m+S*n.strides[1],E=0;E<a.outWidth;++E)for(var j=w+E*f.strides[2],T=E*a.strideWidth-d,L=0;L<i;++L){var P=T+L*l;if(!(P<0||P>=a.inWidth))for(var B=k+L*r.strides[1],K=_+P*a.inChannels,z=j,M=B,U=0;U<a.inChannels;++U){for(var H=p[K+U],Z=0;Z<h;++Z)g[z+Z]+=H*v[M+Z];z+=h,M+=h}}}return f.toTensor()},t.prototype.depthwiseConv2DDerInput=function(n,r,a){J([n,r],"depthwiseConv2DDerInput");for(var o=De(a.inShape,"float32"),i=o.values,s=o.strides,l=s[0],c=s[1],d=s[2],h=this.readSync(n.dataId),f=n.strides,p=f[0],v=f[1],g=f[2],y=this.readSync(r.dataId),m=r.strides,x=m[0],b=m[1],w=m[2],N=a.batchSize,C=a.filterHeight,S=a.filterWidth,k=a.inChannels,_=a.inHeight,E=a.inWidth,j=a.outChannels,T=a.outHeight,L=a.outWidth,P=a.strideHeight,B=a.strideWidth,K=C-1-a.padInfo.top,z=S-1-a.padInfo.left,M=j/k,U=0;U<N;++U)for(var H=0;H<k;++H)for(var Z=0;Z<_;++Z)for(var ne=Z-K,ue=Math.max(0,Math.ceil(ne/P)),he=Math.min(T,(C+ne)/P),ye=0;ye<E;++ye){for(var we=ye-z,ke=Math.max(0,Math.ceil(we/B)),Ie=Math.min(L,(S+we)/B),Ee=0,Ke=ue;Ke<he;++Ke)for(var Te=Ke*P-ne,Ae=ke;Ae<Ie;++Ae)for(var Q=p*U+v*Ke+g*Ae,Ce=x*(C-1-Te)+b*(S-1-(Ae*B-we))+w*H,_e=0;_e<M;++_e)Ee+=h[Q+(H*M+_e)]*y[Ce+_e];i[l*U+c*Z+d*ye+H]=Ee}return o.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(n,r,a){J([n,r],"depthwiseConv2DDerFilter");for(var o=a.strideHeight,i=a.strideWidth,s=a.filterHeight,l=a.filterWidth,c=De(a.filterShape,"float32"),d=a.padInfo.left,h=a.padInfo.top,f=a.outChannels/a.inChannels,p=this.bufferSync(n),v=this.bufferSync(r),g=0;g<s;++g)for(var y=Math.max(0,Math.ceil((h-g)/o)),m=Math.min(a.outHeight,(a.inHeight+h-g)/o),x=0;x<l;++x)for(var b=Math.max(0,Math.ceil((d-x)/i)),w=Math.min(a.outWidth,(a.inWidth+d-x)/i),N=0;N<a.outChannels;++N){for(var C=Math.trunc(N/f),S=N%f,k=0,_=0;_<a.batchSize;++_)for(var E=y;E<m;++E)for(var j=g+E*o-h,T=b;T<w;++T){var L=x+T*i-d;k+=p.get(_,j,L,C)*v.get(_,E,T,N)}c.set(k,g,x,C,S)}return c.toTensor()},t.prototype.tile=function(n,r){return J(n,"tile"),mN(this.bufferSync(n),r)},t.prototype.pad=function(n,r,a){J(n,"pad");var o=r.map(function(f,p){return f[0]+n.shape[p]+f[1]}),i=r.map(function(f){return f[0]}),s=this.bufferSync(n),l=De(o,n.dtype);a!==0&&l.values.fill(a);for(var c=0;c<n.size;c++){var d=s.indexToLoc(c),h=d.map(function(f,p){return f+i[p]});l.set.apply(l,[s.get.apply(s,d)].concat(h))}return l.toTensor()},t.prototype.transpose=function(n,r){J(n,"transpose");for(var a=new Array(n.rank),o=0;o<a.length;o++)a[o]=n.shape[r[o]];var i=this.readSync(n.dataId),s=De(a,n.dtype),l=this.bufferSync(n);for(o=0;o<n.size;++o){for(var c=l.indexToLoc(o),d=new Array(c.length),h=0;h<d.length;h++)d[h]=c[r[h]];var f=s.locToIndex(d);s.values[f]=i[o]}return s.toTensor()},t.prototype.gather=function(n,r,a){J([n,r],"gather");var o=n.shape.slice(),i=this.readSync(r.dataId);o[a]=i.length;for(var s=De(o,n.dtype),l=this.bufferSync(n),c=0;c<s.size;++c){var d=s.indexToLoc(c),h=d.slice();h[a]=i[d[a]];var f=l.locToIndex(h);s.values[c]=l.values[f]}return s.toTensor()},t.prototype.batchToSpaceND=function(n,r,a){J([n],"batchToSpaceND");var o=r.reduce(function(h,f){return h*f}),i=lc(n.shape,r,o),s=uc(i.length,r.length),l=cc(n.shape,r,o),c=nN(a,r.length),d=rN(l,a,r.length);return n.reshape(i).transpose(s).reshape(l).slice(c,d)},t.prototype.spaceToBatchND=function(n,r,a){J([n],"spaceToBatchND");var o=r.reduce(function(f,p){return f*p}),i=[[0,0]];i.push.apply(i,a);for(var s=1+r.length;s<n.shape.length;++s)i.push([0,0]);var l=n.pad(i),c=lc(l.shape,r,o,!1),d=uc(c.length,r.length,!1),h=cc(l.shape,r,o,!1);return l.reshape(c).transpose(d).reshape(h)},t.prototype.pool=function(n,r,a){J(n,"pool");for(var o=r.strideHeight,i=r.strideWidth,s=r.dilationHeight,l=r.dilationWidth,c=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,f=r.padInfo.left,p=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=this.readSync(n.dataId),g=De(r.outShape,n.dtype),y=g.values,m=r.outShape[1]*r.outShape[2]*r.outShape[3],x=r.outShape[2]*r.outShape[3],b=r.outShape[3],w=0;w<r.batchSize;++w)for(var N=w*m,C=w*n.strides[0],S=0;S<r.inChannels;++S)for(var k=0;k<r.outHeight;++k)for(var _=k*o-h,E=Math.max(0,_),j=Math.min(r.inHeight,c+_),T=N+k*x,L=0;L<r.outWidth;++L){for(var P=L*i-f,B=Math.max(0,P),K=Math.min(r.inWidth,d+P),z=p,M=0,U=0,H=E;H<j;H+=s){for(var Z=C+H*n.strides[1],ne=B;ne<K;ne+=l){var ue=v[Z+ne*n.strides[2]+S];a==="max"&&ue>z?z=ue:a==="avg"&&(M+=ue,U++)}if(isNaN(z))break}y[T+L*b+S]=a==="avg"?M/U:z}return g.toTensor()},t.prototype.maxPool=function(n,r){return this.pool(n,r,"max")},t.prototype.maxPoolPositions=function(n,r){for(var a=De(r.outShape,"int32"),o=r.strideHeight,i=r.strideWidth,s=r.dilationHeight,l=r.dilationWidth,c=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,f=r.padInfo.left,p=this.bufferSync(n),v=0;v<r.batchSize;++v)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.outHeight;++y){for(var m=y*o-h,x=m;x<0;)x+=s;for(var b=Math.min(r.inHeight,c+m),w=0;w<r.outWidth;++w){for(var N=w*i-f,C=N;C<0;)C+=l;for(var S=Math.min(r.inWidth,d+N),k=Number.NEGATIVE_INFINITY,_=-1,E=x;E<b;E+=s)for(var j=E-m,T=C;T<S;T+=l){var L=T-N,P=p.get(v,E,T,g);P>k&&(k=P,_=j*d+L)}a.set(_,v,y,w,g)}}return a.toTensor()},t.prototype.maxPoolBackprop=function(n,r,a,o){J([r,a],"maxPoolBackprop");for(var i=this.maxPoolPositions(r,o),s=o.strideHeight,l=o.strideWidth,c=o.dilationHeight,d=o.dilationWidth,h=o.effectiveFilterHeight,f=o.effectiveFilterWidth,p=f-1-o.padInfo.left,v=h-1-o.padInfo.top,g=De(r.shape,"float32"),y=this.bufferSync(i),m=this.bufferSync(n),x=0;x<o.batchSize;++x)for(var b=0;b<o.inChannels;++b)for(var w=0;w<o.inHeight;++w)for(var N=0;N<o.inWidth;++N){for(var C=w-v,S=N-p,k=0,_=0;_<h;_+=c){var E=(C+_)/s;if(!(E<0||E>=o.outHeight||Math.floor(E)!==E))for(var j=0;j<f;j+=d){var T=(S+j)/l;if(!(T<0||T>=o.outWidth||Math.floor(T)!==T)){var L=h*f-1-y.get(x,E,T,b)===_*f+j?1:0;L!==0&&(k+=m.get(x,E,T,b)*L)}}}g.set(k,x,w,N,b)}return g.toTensor()},t.prototype.avgPoolBackprop=function(n,r,a){J([n,r],"avgPoolBackprop");for(var o=a.strideHeight,i=a.strideWidth,s=a.filterHeight,l=a.filterWidth,c=a.dilationHeight,d=a.dilationWidth,h=a.effectiveFilterHeight,f=a.effectiveFilterWidth,p=f-1-a.padInfo.left,v=h-1-a.padInfo.top,g=De(r.shape,"float32"),y=1/(s*l),m=this.bufferSync(n),x=0;x<a.batchSize;++x)for(var b=0;b<a.inChannels;++b)for(var w=0;w<a.inHeight;++w)for(var N=0;N<a.inWidth;++N){for(var C=w-v,S=N-p,k=0,_=0;_<h;_+=c){var E=(C+_)/o;if(!(E<0||E>=a.outHeight||Math.floor(E)!==E))for(var j=0;j<f;j+=d){var T=(S+j)/i;T<0||T>=a.outWidth||Math.floor(T)!==T||(k+=m.get(x,E,T,b))}}g.set(k*y,x,w,N,b)}return g.toTensor()},t.prototype.pool3d=function(n,r,a){J(n,"pool3d");for(var o=r.strideDepth,i=r.strideHeight,s=r.strideWidth,l=r.dilationDepth,c=r.dilationHeight,d=r.dilationWidth,h=r.effectiveFilterDepth,f=r.effectiveFilterHeight,p=r.effectiveFilterWidth,v=r.padInfo.front,g=r.padInfo.top,y=r.padInfo.left,m=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=this.readSync(n.dataId),b=De(r.outShape,n.dtype),w=b.values,N=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],C=r.outShape[2]*r.outShape[3]*r.outShape[4],S=r.outShape[3]*r.outShape[4],k=r.outShape[4],_=0;_<r.batchSize;++_)for(var E=_*N,j=_*n.strides[0],T=0;T<r.inChannels;++T)for(var L=0;L<r.outDepth;++L){for(var P=L*o-v,B=P;B<0;)B+=l;for(var K=Math.min(r.inDepth,h+P),z=E+L*C,M=0;M<r.outHeight;++M){for(var U=M*i-g,H=U;H<0;)H+=c;for(var Z=Math.min(r.inHeight,f+U),ne=z+M*S,ue=0;ue<r.outWidth;++ue){for(var he=ue*s-y,ye=he;ye<0;)ye+=d;for(var we=Math.min(r.inWidth,p+he),ke=ne+ue*k,Ie=m,Ee=0,Ke=0,Te=B;Te<K;Te+=l){for(var Ae=j+Te*n.strides[1],Q=H;Q<Z;Q+=c){for(var Ce=Ae+Q*n.strides[2],_e=ye;_e<we;_e+=d){var Le=x[Ce+_e*n.strides[3]+T];if(a==="max"&&Le>Ie?Ie=Le:a==="avg"&&(Ee+=Le,Ke++),isNaN(Ie))break}if(isNaN(Ie))break}if(isNaN(Ie))break}w[ke+T]=a==="avg"?Ee/Ke:Ie}}}return b.toTensor()},t.prototype.avgPool3d=function(n,r){return J(n,"avgPool3d"),this.pool3d(n,r,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(n,r,a){J([n,r],"avgPool3dBackprop");for(var o=a.strideDepth,i=a.strideHeight,s=a.strideWidth,l=a.filterDepth,c=a.filterHeight,d=a.filterWidth,h=a.dilationDepth,f=a.dilationHeight,p=a.dilationWidth,v=a.effectiveFilterDepth,g=a.effectiveFilterHeight,y=a.effectiveFilterWidth,m=v-1-a.padInfo.front,x=y-1-a.padInfo.left,b=g-1-a.padInfo.top,w=De(r.shape,"float32"),N=1/(l*c*d),C=this.bufferSync(n),S=0;S<a.batchSize;++S)for(var k=0;k<a.inChannels;++k)for(var _=0;_<a.inDepth;++_)for(var E=0;E<a.inHeight;++E)for(var j=0;j<a.inWidth;++j){for(var T=_-m,L=E-b,P=j-x,B=0,K=0;K<v;K+=h){var z=(T+K)/o;if(!(z<0||z>=a.outDepth||Math.floor(z)!==z))for(var M=0;M<g;M+=f){var U=(L+M)/i;if(!(U<0||U>=a.outHeight||Math.floor(U)!==U))for(var H=0;H<y;H+=p){var Z=(P+H)/s;Z<0||Z>=a.outWidth||Math.floor(Z)!==Z||(B+=C.get(S,z,U,Z,k))}}}w.set(B*N,S,_,E,j,k)}return w.toTensor()},t.prototype.maxPool3d=function(n,r){return J(n,"maxPool3d"),this.pool3d(n,r,"max").toFloat()},t.prototype.maxPool3dPositions=function(n,r){for(var a=De(r.outShape,"int32"),o=r.strideDepth,i=r.strideHeight,s=r.strideWidth,l=r.dilationDepth,c=r.dilationHeight,d=r.dilationWidth,h=r.effectiveFilterDepth,f=r.effectiveFilterHeight,p=r.effectiveFilterWidth,v=r.padInfo.front,g=r.padInfo.top,y=r.padInfo.left,m=this.bufferSync(n),x=0;x<r.batchSize;++x)for(var b=0;b<r.inChannels;++b)for(var w=0;w<r.outDepth;++w){for(var N=w*o-v,C=N;C<0;)C+=l;for(var S=Math.min(r.inDepth,h+N),k=0;k<r.outHeight;++k){for(var _=k*i-g,E=_;E<0;)E+=c;for(var j=Math.min(r.inHeight,f+_),T=0;T<r.outWidth;++T){for(var L=T*s-y,P=L;P<0;)P+=d;for(var B=Math.min(r.inWidth,p+L),K=Number.NEGATIVE_INFINITY,z=-1,M=C;M<S;M+=l)for(var U=M-N,H=E;H<j;H+=c)for(var Z=H-_,ne=P;ne<B;ne+=d){var ue=ne-L,he=m.get(x,M,H,ne,b);he>=K&&(K=he,z=U*f*p+Z*f+ue)}a.set(z,x,w,k,T,b)}}}return a.toTensor()},t.prototype.maxPool3dBackprop=function(n,r,a,o){J([r,a],"maxPool3dBackprop");for(var i=this.maxPool3dPositions(r,o),s=o.strideDepth,l=o.strideHeight,c=o.strideWidth,d=o.dilationDepth,h=o.dilationHeight,f=o.dilationWidth,p=o.effectiveFilterDepth,v=o.effectiveFilterHeight,g=o.effectiveFilterWidth,y=p-1-o.padInfo.front,m=g-1-o.padInfo.left,x=v-1-o.padInfo.top,b=De(r.shape,"float32"),w=this.bufferSync(i),N=this.bufferSync(n),C=0;C<o.batchSize;++C)for(var S=0;S<o.inChannels;++S)for(var k=0;k<o.inDepth;++k)for(var _=0;_<o.inHeight;++_)for(var E=0;E<o.inWidth;++E){for(var j=k-y,T=_-x,L=E-m,P=0,B=0;B<p;B+=d){var K=(j+B)/s;if(!(K<0||K>=o.outDepth||Math.floor(K)!==K))for(var z=0;z<v;z+=h){var M=(T+z)/l;if(!(M<0||M>=o.outHeight||Math.floor(M)!==M))for(var U=0;U<g;U+=f){var H=(L+U)/c;if(!(H<0||H>=o.outWidth||Math.floor(H)!==H)){var Z=p*v*g-1-w.get(C,K,M,H,S)===B*v*g+z*g+U?1:0;Z!==0&&(P+=N.get(C,K,M,H,S)*Z)}}}}b.set(P,C,k,_,E,S)}return b.toTensor()},t.prototype.cast=function(n,r){return dN(n,r,this)},t.prototype.reshape=function(n,r){return Lf(n,r)},t.prototype.avgPool=function(n,r){return J(n,"avgPool"),this.pool(n,r,"avg").toFloat()},t.prototype.resizeBilinear=function(n,r,a,o){J(n,"resizeBilinear");for(var i=n.shape,s=i[0],l=i[1],c=i[2],d=i[3],h=this.readSync(n.dataId),f=new Float32Array(me([s,r,a,d])),p=[o&&r>1?l-1:l,o&&a>1?c-1:c],v=[o&&r>1?r-1:r,o&&a>1?a-1:a],g=0,y=p[0]/v[0],m=p[1]/v[1],x=0;x<s;x++)for(var b=0;b<r;b++)for(var w=y*b,N=Math.floor(w),C=w-N,S=Math.min(l-1,Math.ceil(w)),k=x*n.strides[0]+N*n.strides[1],_=x*n.strides[0]+S*n.strides[1],E=0;E<a;E++)for(var j=m*E,T=Math.floor(j),L=j-T,P=Math.min(c-1,Math.ceil(j)),B=k+T*n.strides[2],K=_+T*n.strides[2],z=k+P*n.strides[2],M=_+P*n.strides[2],U=0;U<d;U++){var H=h[B+U],Z=h[K+U],ne=H+(h[z+U]-H)*L,ue=ne+(Z+(h[M+U]-Z)*L-ne)*C;f[g++]=ue}return Ht(f,[s,r,a,d])},t.prototype.resizeBilinearBackprop=function(n,r,a){J([n,r],"resizeBilinearBackprop");for(var o=r.shape,i=o[0],s=o[1],l=o[2],c=o[3],d=n.shape,h=d[1],f=d[2],p=new Float32Array(i*s*l*c),v=[a&&h>1?s-1:s,a&&f>1?l-1:l],g=[a&&h>1?h-1:h,a&&f>1?f-1:f],y=v[0]/g[0],m=v[1]/g[1],x=this.readSync(n.dataId),b=0,w=0;w<i;w++)for(var N=w*r.strides[0],C=0;C<h;C++)for(var S=C*y,k=Math.floor(S),_=Math.min(Math.ceil(S),s-1),E=N+k*r.strides[1],j=N+_*r.strides[1],T=S-k,L=1-T,P=0;P<f;P++)for(var B=P*m,K=Math.floor(B),z=Math.min(Math.ceil(B),l-1),M=B-K,U=1-M,H=E+K*r.strides[2],Z=E+z*r.strides[2],ne=j+K*r.strides[2],ue=j+z*r.strides[2],he=L*U,ye=L*M,we=T*U,ke=T*M,Ie=0;Ie<c;Ie++){var Ee=x[b++];p[H+Ie]+=Ee*he,p[Z+Ie]+=Ee*ye,p[ne+Ie]+=Ee*we,p[ue+Ie]+=Ee*ke}return fn(p,[i,l,s,c],r.dtype)},t.prototype.resizeNearestNeighbor=function(n,r,a,o){J(n,"resizeNearestNeighbor");for(var i=n.shape,s=i[0],l=i[1],c=i[2],d=i[3],h=this.readSync(n.dataId),f=new Float32Array(s*r*a*d),p=[o&&r>1?l-1:l,o&&a>1?c-1:c],v=[o&&r>1?r-1:r,o&&a>1?a-1:a],g=p[0]/v[0],y=p[1]/v[1],m=0,x=0;x<s;x++)for(var b=x*n.strides[0],w=0;w<r;w++)for(var N=g*w,C=b+Math.min(l-1,o?Math.round(N):Math.floor(N))*n.strides[1],S=0;S<a;S++)for(var k=y*S,_=C+Math.min(c-1,o?Math.round(k):Math.floor(k))*n.strides[2],E=0;E<d;E++){var j=h[_+E];f[m++]=j}return Ht(f,[s,r,a,d],n.dtype)},t.prototype.resizeNearestNeighborBackprop=function(n,r,a){J([n,r],"resizeNearestNeighborBackprop");for(var o=r.shape,i=o[0],s=o[1],l=o[2],c=o[3],d=n.shape,h=d[1],f=d[2],p=new Float32Array(i*s*l*c),v=this.readSync(n.dataId),g=[a&&h>1?s-1:s,a&&f>1?l-1:l],y=[a&&h>1?h-1:h,a&&f>1?f-1:f],m=g[0]/y[0],x=g[1]/y[1],b=1/m,w=1/x,N=2*Math.ceil(b)+2,C=2*Math.ceil(w)+2,S=0;S<i;S++)for(var k=S*r.strides[0],_=0;_<s;_++)for(var E=k+_*r.strides[1],j=Math.floor(_*b),T=Math.floor(j-N/2),L=0;L<l;L++)for(var P=E+L*r.strides[2],B=Math.floor(L*w),K=Math.floor(B-C/2),z=0;z<c;z++){for(var M=0,U=0;U<N;U++){var H=U+T;if(!(H<0||H>=h)){var Z=k+H*n.strides[1],ne=H*m;if(_===Math.min(s-1,a?Math.round(ne):Math.floor(ne)))for(var ue=0;ue<C;ue++){var he=ue+K;if(!(he<0||he>=f)){var ye=Z+he*n.strides[2],we=he*x;L===Math.min(l-1,a?Math.round(we):Math.floor(we))&&(M+=v[ye+z])}}}}p[P+z]=M}return fn(p,r.shape,r.dtype)},t.prototype.batchNormalization=function(n,r,a,o,i,s){J([n,r,a,i,s],"batchNorm");for(var l=this.readSync(n.dataId),c=this.readSync(r.dataId),d=this.readSync(a.dataId),h=i?this.readSync(i.dataId):new Float32Array([1]),f=s?this.readSync(s.dataId):new Float32Array([0]),p=new Float32Array(l.length),v=f.length,g=h.length,y=d.length,m=c.length,x=0,b=0,w=0,N=0,C=0;C<l.length;++C)p[C]=f[x++]+(l[C]-c[b++])*h[w++]/Math.sqrt(d[N++]+o),x>=v&&(x=0),b>=m&&(b=0),w>=g&&(w=0),N>=y&&(N=0);return fn(p,n.shape)},t.prototype.localResponseNormalization4D=function(n,r,a,o,i){J(n,"localResponseNormalization4D");var s=n.shape[3],l=s-1,c=this.readSync(n.dataId),d=n.size,h=new Float32Array(d);function f(y){for(var m=y%s,x=y-m+Math.max(0,m-r),b=y-m+Math.min(m+r,l),w=0;x<=b;x++){var N=c[x];w+=N*N}return w}for(var p=0;p<d;p++){var v=f(p),g=c[p]*Math.pow(a+o*v,-i);h[p]=g}return fn(h,n.shape)},t.prototype.LRNGrad=function(n,r,a,o,i,s,l){J(n,"LRNGrad");for(var c=n.shape[3],d=this.readSync(n.dataId),h=this.readSync(r.dataId),f=this.readSync(a.dataId),p=new Float32Array(n.size),v=n.size,g=0;g<v;g++){for(var y=g%c,m=g-y+Math.max(0,y-o),x=g-y+Math.min(c,y+o+1),b=0,w=m;w<x;w++)b+=Math.pow(h[w],2);for(b=s*b+i,w=m;w<x;w++){var N=-2*s*l*h[w]*f[g]/b;g===w&&(N+=Math.pow(b,-l)),N*=d[g],p[w]+=N}}return fn(p,n.shape)},t.prototype.multinomial=function(n,r,a,o){J(n,"multinomial");for(var i=r?n:ia(n),s=i.shape[0],l=i.shape[1],c=et([s,a],"int32"),d=this.readSync(c.dataId),h=this.readSync(i.dataId),f=0;f<s;++f){var p=f*l,v=new Float32Array(l-1);v[0]=h[p];for(var g=1;g<v.length;++g)v[g]=v[g-1]+h[p+g];for(var y=Qc(o.toString()),m=f*a,x=0;x<a;++x){var b=y();d[m+x]=v.length;for(var w=0;w<v.length;w++)if(b<v[w]){d[m+x]=w;break}}}return c},t.prototype.oneHot=function(n,r,a,o){J(n,"oneHot");var i=new Float32Array(n.size*r);i.fill(o);for(var s=this.readSync(n.dataId),l=0;l<n.size;++l)s[l]>=0&&s[l]<r&&(i[l*r+s[l]]=a);return Oa(i,[n.size,r],"int32")},t.prototype.nonMaxSuppression=function(n,r,a,o,i){return J(n,"nonMaxSuppression"),vm(this.readSync(n.dataId),this.readSync(r.dataId),a,o,i)},t.prototype.fft=function(n){return this.fftBatch(n,!1)},t.prototype.ifft=function(n){return this.fftBatch(n,!0)},t.prototype.fftBatch=function(n,r){for(var a=n.shape[0],o=n.shape[1],i=De(n.shape,"float32"),s=De(n.shape,"float32"),l=Wn(n).as2D(a,o),c=wr(n).as2D(a,o),d=0;d<a;d++)for(var h=l.slice([d,0],[1,o]),f=c.slice([d,0],[1,o]),p=Wt(h,f),v=this.readSync(this.fftImpl(p,r).dataId),g=0;g<o;g++){var y=by(v,g);i.values[d*o+g]=y.real,s.values[d*o+g]=y.imag}return Wt(i.toTensor(),s.toTensor()).as2D(a,o)},t.prototype.fftImpl=function(n,r){var a=n.as1D(),o=a.size;if(this.isExponentOf2(o)){var i=this.fftRadix2(a,o,r).as2D(n.shape[0],n.shape[1]);return r&&(i=Wt(Wn(i).div(le(o)),wr(i).div(le(o)))),i}var s=this.readSync(n.dataId),l=function(c){for(var d=new Float32Array(c.length/2),h=new Float32Array(c.length/2),f=0;f<c.length;f+=2)d[f/2]=c[f],h[f/2]=c[f+1];return{real:d,imag:h}}(this.fourierTransformByMatmul(s,o,r));return Wt(l.real,l.imag).as2D(n.shape[0],n.shape[1])},t.prototype.isExponentOf2=function(n){return(n&n-1)==0},t.prototype.fftRadix2=function(n,r,a){if(r===1)return n;var o=this.readSync(n.dataId),i=r/2,s=function(m){for(var x=Math.ceil(m.length/4),b=new Float32Array(x),w=new Float32Array(x),N=0;N<m.length;N+=4)b[Math.floor(N/4)]=m[N],w[Math.floor(N/4)]=m[N+1];return{real:b,imag:w}}(o),l=Wt(s.real,s.imag).as1D(),c=function(m){for(var x=Math.floor(m.length/4),b=new Float32Array(x),w=new Float32Array(x),N=2;N<m.length;N+=4)b[Math.floor(N/4)]=m[N],w[Math.floor(N/4)]=m[N+1];return{real:b,imag:w}}(o),d=Wt(c.real,c.imag).as1D();l=this.fftRadix2(l,i,a),d=this.fftRadix2(d,i,a);var h=function(m,x){for(var b=new Float32Array(m/2),w=new Float32Array(m/2),N=0;N<Math.ceil(m/2);N++){var C=(x?2:-2)*Math.PI*(N/m);b[N]=Math.cos(C),w[N]=Math.sin(C)}return{real:b,imag:w}}(r,a),f=Wt(h.real,h.imag).mul(d),p=l.add(f),v=l.sub(f),g=Wn(p).concat(Wn(v)),y=wr(p).concat(wr(v));return Wt(g,y).as1D()},t.prototype.fourierTransformByMatmul=function(n,r,a){for(var o=new Float32Array(2*r),i=0;i<r;i++){for(var s=0,l=0,c=0;c<r;c++){var d=R5(i*c,r,a),h=by(n,c);s+=h.real*d.real-h.imag*d.imag,l+=h.real*d.imag+h.imag*d.real}a&&(s/=r,l/=r),_5(o,s,l,i)}return o},t.prototype.depthToSpace=function(n,r,a){D(a==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+a}),D(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var o=n.shape[0],i=n.shape[1],s=n.shape[2],l=n.shape[3],c=i*r,d=s*r,h=l/(r*r),f=this.readSync(n.dataId),p=new Float32Array(o*c*d*h),v=0,g=0;g<o;++g)for(var y=0;y<c;++y)for(var m=Math.floor(y/r),x=y%r,b=0;b<d;++b)for(var w=Math.floor(b/r),N=(x*r+b%r)*h,C=0;C<h;++C){var S=C+N+l*(w+s*(m+i*g));p[v++]=f[S]}return fn(p,[o,c,d,h])},t.prototype.broadcastedBinaryOp=function(n,r,a,o){var i=ze(n.shape,r.shape),s=De(i,a),l=this.readSync(n.dataId),c=this.readSync(r.dataId),d=ja(n.shape,i),h=ja(r.shape,i),f=s.values;if(d.length+h.length===0)for(var p=0;p<f.length;++p)f[p]=o(l[p%l.length],c[p%c.length]);else{var v=this.bufferSync(n),g=this.bufferSync(r),y=function(m){var x=s.indexToLoc(m),b=x.slice(-n.rank);d.forEach(function(S){return b[S]=0});var w=v.locToIndex(b),N=x.slice(-r.rank);h.forEach(function(S){return N[S]=0});var C=g.locToIndex(N);f[m]=o(l[w],c[C])};for(p=0;p<f.length;++p)y(p)}return s.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(n,r,a){var o=ze(n.shape,r.shape),i=De(o,"float32"),s=De(o,"float32"),l=this.readSync(n.dataId),c=this.readSync(r.dataId),d=ja(n.shape,o),h=ja(r.shape,o),f=i.values,p=s.values;if(d.length+h.length===0)for(var v=0;v<f.length;v++){var g=v%l.length,y=v%c.length,m=a(l[2*g],l[2*g+1],c[2*y],c[2*y+1]);f[v]=m.real,p[v]=m.imag}else{var x=this.bufferSync(this.data.get(n.dataId).complexTensors.real),b=this.bufferSync(this.data.get(r.dataId).complexTensors.real),w=function(N){var C=i.indexToLoc(N),S=C.slice(-n.rank);d.forEach(function(T){return S[T]=0});var k=x.locToIndex(S),_=C.slice(-r.rank);h.forEach(function(T){return _[T]=0});var E=b.locToIndex(_),j=a(l[2*k],l[2*k+1],c[2*E],c[2*E+1]);f[N]=j.real,p[N]=j.imag};for(v=0;v<f.length;v++)w(v)}return this.complex(i.toTensor(),s.toTensor())},t.prototype.split=function(n,r,a){return pN(n,r,a)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(n,r,a,o,i,s){for(var l=n.shape,c=l[0],d=l[1],h=l[2],f=l[3],p=r.shape[0],v=o[0],g=o[1],y=De([p,v,g,f],"float32"),m=this.readSync(r.dataId),x=this.readSync(a.dataId),b=this.readSync(n.dataId),w=n.strides,N=y.strides,C=0;C<p;C++){var S=4*C,k=m[S],_=m[S+1],E=m[S+2],j=m[S+3],T=x[C];if(!(T>=c))for(var L=v>1?(E-k)*(d-1)/(v-1):0,P=g>1?(j-_)*(h-1)/(g-1):0,B=0;B<v;B++){var K=v>1?k*(d-1)+B*L:.5*(k+E)*(d-1);if(K<0||K>d-1)for(var z=0;z<g;z++)for(var M=0;M<f;M++){var U=M+z*N[2]+B*N[1]+C*N[0];y.values[U]=s}else if(i==="bilinear"){var H=Math.floor(K),Z=Math.ceil(K),ne=K-H;for(z=0;z<g;z++)if((Te=g>1?_*(h-1)+z*P:.5*(_+j)*(h-1))<0||Te>h-1)for(M=0;M<f;M++)U=M+z*N[2]+B*N[1]+C*N[0],y.values[U]=s;else{var ue=Math.floor(Te),he=Math.ceil(Te),ye=Te-ue;for(M=0;M<f;M++){var we=b[U=M+ue*w[2]+H*w[1]+T*w[0]],ke=b[U=M+he*w[2]+H*w[1]+T*w[0]],Ie=b[U=M+ue*w[2]+Z*w[1]+T*w[0]],Ee=we+(ke-we)*ye,Ke=Ie+(b[U=M+he*w[2]+Z*w[1]+T*w[0]]-Ie)*ye;U=M+z*N[2]+B*N[1]+C*N[0],y.values[U]=Ee+(Ke-Ee)*ne}}}else for(z=0;z<g;++z){var Te;if((Te=g>1?_*(h-1)+z*P:.5*(_+j)*(h-1))<0||Te>h-1)for(M=0;M<f;M++)U=M+z*N[2]+B*N[1]+C*N[0],y.values[U]=s;else{var Ae=Math.round(Te),Q=Math.round(K);for(M=0;M<f;M++){var Ce=M+Ae*w[2]+Q*w[1]+T*w[0],_e=M+z*N[2]+B*N[1]+C*N[0];y.values[_e]=b[Ce]}}}}}return y.toTensor()},t.prototype.sparseToDense=function(n,r,a,o){var i=dc(0,n,a),s=i.sliceRank,l=i.numUpdates,c=i.sliceSize,d=i.strides,h=i.outputSize;return this.scatter(n,r,a,h,c,l,s,d,o,!1)},t.prototype.gatherND=function(n,r){var a=r.shape,o=a[a.length-1],i=aN(n,r),s=i[0],l=i[1],c=i[2],d=i[3];if(l===0)return Ht([],s,n.dtype);for(var h=new Ys([l,c],n.dtype),f=this.readSync(r.dataId),p=this.readSync(n.dataId),v=0;v<l;v++){for(var g=[],y=0,m=0;m<o;m++){var x=f[v*o+m];y+=x*d[m],g.push(x)}if(y<0||y>=n.size/c)throw new Error("Invalid indices: "+g+" does not index into "+n.shape);for(var b=0;b<c;b++)h.values[v*c+b]=p[y*c+b]}return h.toTensor().reshape(s)},t.prototype.scatterND=function(n,r,a){var o=dc(0,n,a),i=o.sliceRank,s=o.numUpdates,l=o.sliceSize,c=o.strides,d=o.outputSize,h=le(0);return this.scatter(n,r,a,d,l,s,i,c,h,!0)},t.prototype.fill=function(n,r,a){var o=tc(a=a||fl(r),me(n));return o.fill(r),O.makeTensor(o,n,a,this)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){var r=tc(n.dtype,me(n.shape));return this.makeOutput(r,n.shape,n.dtype)},t.prototype.linspace=function(n,r,a){return hN(n,r,a)},t.prototype.scatter=function(n,r,a,o,i,s,l,c,d,h){var f=[o/i,i],p=this.readSync(n.dataId),v=this.readSync(r.dataId);if(o===0)return Ht([],a,r.dtype);var g=new Ys(f,r.dtype);g.values.fill(this.readSync(d.dataId)[0]);for(var y=0;y<s;y++){for(var m=[],x=0,b=0;b<l;b++){var w=p[y*l+b];m.push(w),x+=w*c[b]}if(x<0||x>=o/i)throw new Error("Invalid indices: "+m+" does not index into "+a);for(var N=0;N<i;N++)h?g.values[x*i+N]+=v[y*i+N]:g.values[x*i+N]=r.rank===0?v[0]:v[y*i+N]}return g.toTensor().reshape(a)},t}(uN);O.registerBackend("cpu",function(){return new XP},1);for(var dh=0,Uy=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t,o=a.boxes,i=a.scores,s=r,l=s.maxOutputSize,c=s.iouThreshold,d=s.scoreThreshold,h=s.softNmsSigma,f=n;J(o,"NonMaxSuppressionWithScore");var p=gm(f.data.get(o.dataId).values,f.data.get(i.dataId).values,l,c,d,h);return[p.selectedIndices,p.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n;J(r,"square");for(var o=a.data.get(r.dataId).values,i=new Float32Array(o.length),s=0;s<o.length;++s){var l=o[s];i[s]=l*l}return{dataId:a.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:Zs,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,a=r.a,o=r.b,i=n;J([a,o],Zs);var s=i.data.get(a.dataId).values,l=i.data.get(o.dataId).values,c=function(f,p,v,g,y,m){var x=ze(f,p),b=x.length,w=_r(x),N=Xs(y,me(x)),C=f.length,S=p.length,k=_r(f),_=_r(p),E=ja(f,x),j=ja(p,x);if(E.length+j.length===0)for(var T=0;T<N.length;++T)N[T]=m(v[T%v.length],g[T%g.length]);else{var L=function(P){var B=oI(P,b,w),K=B.slice(-C);E.forEach(function(H){return K[H]=0});var z=dy(K,C,k),M=B.slice(-S);j.forEach(function(H){return M[H]=0});var U=dy(M,S,_);N[P]=m(v[z],g[U])};for(T=0;T<N.length;++T)L(T)}return[N,x]}(a.shape,o.shape,s,l,a.dtype,function(f,p){var v=f-p;return v*v}),d=c[0],h=c[1];return{dataId:i.write(d,h,a.dtype),shape:h,dtype:a.dtype}}}];dh<Uy.length;dh++)Ow(Uy[dh]);var Uo,YP=function(e){this.variableNames=["A"];var t=en(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+n+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},QP=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=en(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+n+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `};for(var hh=0,Wy=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.pixels,o=r.numChannels,i=typeof HTMLVideoElement<"u"&&a instanceof HTMLVideoElement,s=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,l=i?[a.videoWidth,a.videoHeight]:[a.width,a.height],c=l[0],d=l[1],h=[d,c],f=[d,c,o];(s||i)&&(Uo==null&&(Uo=document.createElement("canvas").getContext("2d")),Uo.canvas.width=c,Uo.canvas.height=d,Uo.drawImage(a,0,0,c,d),a=Uo.canvas);var p=n.makeTensorInfo(h,"int32");n.texData.get(p.dataId).usage=Rn.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),a);var v=X().getBool("WEBGL_PACK")?new QP(f):new YP(f),g=n.runWebGLProgram(v,[p],"int32");return n.disposeData(p.dataId),g}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;oc("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=t,o=a.boxes,i=a.scores,s=r,l=s.maxOutputSize,c=s.iouThreshold,d=s.scoreThreshold,h=s.softNmsSigma,f=n,p=gm(f.readSync(o.dataId),f.readSync(i.dataId),l,c,d,h);return[p.selectedIndices,p.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n,o=new Me(r.shape,"return x * x;");return a.runWebGLProgram(o,[r],r.dtype)}},{kernelName:Zs,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,a=r.a,o=r.b,i=n,s=X().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $r("return (a - b) * (a - b);",a.shape,o.shape):new ht("return (a - b) * (a - b);",a.shape,o.shape);return i.compileAndRun(s,[a,o])}}];hh<Wy.length;hh++)Ow(Wy[hh]);for(var fh=0,Vy=[{kernelName:"Square",gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:Zs,gradFunc:function(e,t){var n=t[0],r=t[1],a=le(2);return{a:function(){return nn(e,nn(a,At(n,r)))},b:function(){return nn(e,nn(a,At(r,n)))}}}}];fh<Vy.length;fh++)KR(Vy[fh]);var JP=function(){function e(){}return e.prototype.fetch=function(t,n){return fetch(t,n)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+n);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return new TextDecoder(n).decode(t)},e}();X().get("IS_BROWSER")&&X().setPlatform("browser",new JP);var ph,ZP=function(){return require("node-fetch")},eF=function(){function e(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(t,n){return X().global.fetch!=null?X().global.fetch(t,n):(ph==null&&(ph=ZP()),ph(t,n))},e.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+n);return this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)},e}();X().get("IS_NODE")&&X().setPlatform("node",new eF);var $f={float32:4,int32:4,uint16:2,uint8:1,bool:1},xc=4;function iC(e,t){for(var n={},r=0,a=function(s){var l=s.name,c=s.dtype,d=s.shape,h=me(d),f=void 0;if("quantization"in s){var p=s.quantization;if(p.dtype!=="uint8"&&p.dtype!=="uint16")throw new Error("Weight "+s.name+" has unknown quantization dtype "+p.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var v=$f[p.dtype],g=e.slice(r,r+h*v),y=p.dtype==="uint8"?new Uint8Array(g):new Uint16Array(g);if(c==="float32")f=Float32Array.from(y,function(C){return C*p.scale+p.min});else{if(c!=="int32")throw new Error("Unsupported dtype in weight '"+l+"': "+c);f=Int32Array.from(y,function(C){return Math.round(C*p.scale+p.min)})}r+=h*v}else if(c==="string"){var m=me(s.shape);f=[];for(var x=0;x<m;x++){var b=new Uint32Array(e.slice(r,r+xc))[0];r+=xc;var w=new Uint8Array(e.slice(r,r+b));f.push(w),r+=b}}else{var N=$f[c];if(g=e.slice(r,r+h*N),c==="float32")f=new Float32Array(g);else if(c==="int32")f=new Int32Array(g);else{if(c!=="bool")throw new Error("Unsupported dtype in weight '"+l+"': "+c);f=new Uint8Array(g)}r+=h*N}n[l]=Ht(f,d,c)},o=0,i=t;o<i.length;o++)a(i[o]);return n}function tF(e){if(e===null)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach(function(o){if(t+=o.byteLength,n.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+o.constructor.name)});var r=new Uint8Array(t),a=0;return n.forEach(function(o){r.set(new Uint8Array(o.buffer),a),a+=o.byteLength}),r.buffer}var Uf=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function Hy(e){return Uf?Buffer.byteLength(e):new Blob([e]).size}function Mm(e){var t=0;e.forEach(function(a){t+=a.byteLength});var n=new Uint8Array(t),r=0;return e.forEach(function(a){n.set(new Uint8Array(a),r),r+=a.byteLength}),n.buffer}function Gy(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function bl(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:Hy(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:Hy(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:e.weightData.byteLength}}var In=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var a=[];return(n==="load"?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(function(o){var i=o(t,r);i!==null&&a.push(i)}),a},e}(),xi="://",La=function(){function e(){this.managers={}}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerManager=function(t,n){D(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith(xi)&&(t=t.slice(0,t.indexOf(xi))),D(t.length>0,function(){return"scheme must not be an empty string."});var r=e.getInstance();D(r.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),r.managers[t]=n},e.getManager=function(t){var n=this.getInstance().managers[t];if(n==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return n},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function Cu(e){if(e.indexOf(xi)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+La.getSchemes().join(","));return{scheme:e.split(xi)[0],path:e.split(xi)[1]}}function qy(e,t,n){return n===void 0&&(n=!1),fe(this,void 0,void 0,function(){var r,a,o,i,s,l,c,d,h;return pe(this,function(f){switch(f.label){case 0:return D(e!==t,function(){return"Old path and new path are the same: '"+e+"'"}),D((r=In.getLoadHandlers(e)).length>0,function(){return"Copying failed because no load handler is found for source URL "+e+"."}),D(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."}),a=r[0],D((o=In.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),D(o.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."}),i=o[0],s=Cu(e).scheme,l=Cu(e).path,c=s===Cu(e).scheme,[4,a.load()];case 1:return d=f.sent(),n&&c?[4,La.getManager(s).removeModel(l)]:[3,3];case 2:f.sent(),f.label=3;case 3:return[4,i.save(d)];case 4:return h=f.sent(),!n||c?[3,6]:[4,La.getManager(s).removeModel(l)];case 5:f.sent(),f.label=6;case 6:return[2,h.modelArtifactsInfo]}})})}var po="models_store",Sa="model_info_store";function sC(){if(!X().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function Wf(e){var t=e.result;t.createObjectStore(po,{keyPath:"modelPath"}),t.createObjectStore(Sa,{keyPath:"modelPath"})}var yi=function(){function e(t){if(this.indexedDB=sC(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return e.prototype.save=function(t){return fe(this,void 0,void 0,function(){return pe(this,function(n){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},e.prototype.load=function(){return fe(this,void 0,void 0,function(){return pe(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},e.prototype.databaseAction=function(t,n){var r=this;return new Promise(function(a,o){var i=r.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return Wf(i)},i.onsuccess=function(){var s=i.result;if(n==null){var l=s.transaction(po,"readonly"),c=l.objectStore(po).get(r.modelPath);c.onsuccess=function(){if(c.result==null)return s.close(),o(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));a(c.result.modelArtifacts)},c.onerror=function(g){return s.close(),o(c.error)},l.oncomplete=function(){return s.close()}}else{var d,h=bl(n),f=s.transaction(Sa,"readwrite"),p=f.objectStore(Sa),v=p.put({modelPath:r.modelPath,modelArtifactsInfo:h});v.onsuccess=function(){var g=(d=s.transaction(po,"readwrite")).objectStore(po).put({modelPath:r.modelPath,modelArtifacts:n,modelArtifactsInfo:h});g.onsuccess=function(){return a({modelArtifactsInfo:h})},g.onerror=function(y){var m=(p=f.objectStore(Sa)).delete(r.modelPath);m.onsuccess=function(){return s.close(),o(g.error)},m.onerror=function(x){return s.close(),o(g.error)}}},v.onerror=function(g){return s.close(),o(v.error)},f.oncomplete=function(){d==null?s.close():d.oncomplete=function(){return s.close()}}}},i.onerror=function(s){return o(i.error)}})},e.URL_SCHEME="indexeddb://",e}(),Ky=function(e){return X().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(yi.URL_SCHEME)?(t=e.slice(yi.URL_SCHEME.length),new yi(t)):null;var t};In.registerSaveRouter(Ky),In.registerLoadRouter(Ky);var nF=function(){function e(){this.indexedDB=sC()}return e.prototype.listModels=function(){return fe(this,void 0,void 0,function(){var t=this;return pe(this,function(n){return[2,new Promise(function(r,a){var o=t.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return Wf(o)},o.onsuccess=function(){var i=o.result,s=i.transaction(Sa,"readonly"),l=s.objectStore(Sa).getAll();l.onsuccess=function(){for(var c={},d=0,h=l.result;d<h.length;d++){var f=h[d];c[f.modelPath]=f.modelArtifactsInfo}r(c)},l.onerror=function(c){return i.close(),a(l.error)},s.oncomplete=function(){return i.close()}},o.onerror=function(i){return a(o.error)}})]})})},e.prototype.removeModel=function(t){return fe(this,void 0,void 0,function(){var n=this;return pe(this,function(r){var a;return t=(a=t).startsWith(yi.URL_SCHEME)?a.slice(yi.URL_SCHEME.length):a,[2,new Promise(function(o,i){var s=n.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return Wf(s)},s.onsuccess=function(){var l,c=s.result,d=c.transaction(Sa,"readwrite"),h=d.objectStore(Sa),f=h.get(t);f.onsuccess=function(){if(f.result==null)return c.close(),i(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var p=h.delete(t),v=function(){var g=(l=c.transaction(po,"readwrite")).objectStore(po).delete(t);g.onsuccess=function(){return o(f.result.modelArtifactsInfo)},g.onerror=function(y){return i(f.error)}};p.onsuccess=v,p.onerror=function(g){return v(),c.close(),i(f.error)}},f.onerror=function(p){return c.close(),i(f.error)},d.oncomplete=function(){l==null?c.close():l.oncomplete=function(){return c.close()}}},s.onerror=function(l){return i(s.error)}})]})})},e}();if(X().getBool("IS_BROWSER"))try{La.registerManager(yi.URL_SCHEME,new nF)}catch{}var Vr="/",Ko="tensorflowjs_models",lC="info",rF="model_topology",aF="weight_specs",oF="weight_data",iF="model_metadata";function uC(e){return{info:[Ko,e,lC].join(Vr),topology:[Ko,e,rF].join(Vr),weightSpecs:[Ko,e,aF].join(Vr),weightData:[Ko,e,oF].join(Vr),modelMetadata:[Ko,e,iF].join(Vr)}}function sF(e){var t=e.split(Vr);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(Vr)}var bi=function(){function e(t){if(!X().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=uC(this.modelPath)}return e.prototype.save=function(t){return fe(this,void 0,void 0,function(){var n,r,a;return pe(this,function(o){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),a=bl(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(i){if(Uf)return Buffer.from(i).toString("base64");for(var s=new Uint8Array(i),l="",c=0,d=s.length;c<d;c++)l+=String.fromCharCode(s[c]);return btoa(l)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:a}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+a.modelTopologyBytes+", weightSpecsBytes="+a.weightSpecsBytes+", weightDataBytes="+a.weightDataBytes+".")}return[2]})})},e.prototype.load=function(){return fe(this,void 0,void 0,function(){var t,n,r,a,o,i,s;return pe(this,function(l){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(n={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(n.modelTopology=r,(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(n.weightSpecs=a,(o=this.LS.getItem(this.keys.modelMetadata))!=null&&(i=JSON.parse(o),n.format=i.format,n.generatedBy=i.generatedBy,n.convertedBy=i.convertedBy,n.userDefinedMetadata=i.userDefinedMetadata),(s=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return n.weightData=function(c){if(Uf){var d=Buffer.from(c,"base64");return d.buffer.slice(d.byteOffset,d.byteOffset+d.byteLength)}for(var h=atob(c),f=new Uint8Array(h.length),p=0;p<h.length;++p)f.set([h.charCodeAt(p)],p);return f.buffer}(s),[2,n]})})},e.URL_SCHEME="localstorage://",e}(),Xy=function(e){return X().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(bi.URL_SCHEME)?(t=e.slice(bi.URL_SCHEME.length),new bi(t)):null;var t};In.registerSaveRouter(Xy),In.registerLoadRouter(Xy);var lF=function(){function e(){D(X().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),D(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return e.prototype.listModels=function(){return fe(this,void 0,void 0,function(){var t,n,r,a,o,i;return pe(this,function(s){for(t={},n=Ko+Vr,r=Vr+lC,a=0;a<this.LS.length;++a)(o=this.LS.key(a)).startsWith(n)&&o.endsWith(r)&&(i=sF(o),t[i]=JSON.parse(this.LS.getItem(o)));return[2,t]})})},e.prototype.removeModel=function(t){return fe(this,void 0,void 0,function(){var n,r;return pe(this,function(a){var o;if(t=(o=t).startsWith(bi.URL_SCHEME)?o.slice(bi.URL_SCHEME.length):o,n=uC(t),this.LS.getItem(n.info)==null)throw new Error("Cannot find model at path '"+t+"'");return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),[2,r]})})},e}();if(X().getBool("IS_BROWSER"))try{La.registerManager(bi.URL_SCHEME,new lF)}catch{}var uF="model",cF=".json",dF=".weights.bin";function Yy(e){return new Promise(function(t){return setTimeout(t)}).then(e)}var mh=function(){function e(t){if(!X().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),t!=null&&t.length!==0||(t=uF),this.modelTopologyFileName=t+cF,this.weightDataFileName=t+dF}return e.prototype.save=function(t){return fe(this,void 0,void 0,function(){var n,r,a,o,i,s;return pe(this,function(l){switch(l.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},o=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),(i=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,i.href=o,[4,Yy(function(){return i.dispatchEvent(new MouseEvent("click"))})];case 2:return l.sent(),t.weightData==null?[3,4]:((s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,[4,Yy(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:l.sent(),l.label=4;case 4:return[2,{modelArtifactsInfo:bl(t)}]}})})},e.URL_SCHEME="downloads://",e}(),hF=function(){function e(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return e.prototype.load=function(){return fe(this,void 0,void 0,function(){var t,n,r=this;return pe(this,function(a){return t=this.files[0],n=this.files.slice(1),[2,new Promise(function(o,i){var s=new FileReader;s.onload=function(l){var c=JSON.parse(l.target.result),d=c.modelTopology;if(d!=null){n.length===0&&o({modelTopology:d});var h=c.weightsManifest;if(h!=null){var f;try{f=r.checkManifestAndWeightFiles(h,n)}catch(y){return void i(y)}var p=[],v=[],g=[];h.forEach(function(y){y.paths.forEach(function(m){v.push(m),g.push(null)}),p.push.apply(p,y.weights)}),h.forEach(function(y){y.paths.forEach(function(m){var x=new FileReader;x.onload=function(b){var w=b.target.result,N=v.indexOf(m);g[N]=w,g.indexOf(null)===-1&&o({modelTopology:d,weightSpecs:p,weightData:Mm(g),format:c.format,generatedBy:c.generatedBy,convertedBy:c.convertedBy,userDefinedMetadata:c.userDefinedMetadata})},x.onerror=function(b){return i("Failed to weights data from file of path '"+m+"'.")},x.readAsArrayBuffer(f[m])})})}else i(new Error("weightManifest field is missing from file "+t.name))}else i(new Error("modelTopology field is missing from file "+t.name))},s.onerror=function(l){return i("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},s.readAsText(t)})]})})},e.prototype.checkManifestAndWeightFiles=function(t,n){for(var r=[],a=n.map(function(l){return Gy(l.name)}),o={},i=0,s=t;i<s.length;i++)s[i].paths.forEach(function(l){var c=Gy(l);if(r.indexOf(c)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+c+"'");if(r.push(c),a.indexOf(c)===-1)throw new Error("Weight file with basename '"+c+"' is not provided.");o[l]=n[a.indexOf(c)]});if(r.length!==n.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+n.length+").");return o},e}();function Qy(e,t,n,r){(function(o){D(o!=null&&Array.isArray(o)&&o.length>0,function(){return"promises must be a none empty array"})})(e),function(o,i){D(o>=0&&o<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+o}),D(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+i}),D(i>=o,function(){return"startFraction must be no more than endFraction, but got startFraction "+o+" and endFraction "+i})}(n=n??0,r=r??1);var a=0;return Promise.all(e.map(function(o){return o.then(function(i){var s=n+ ++a/e.length*(r-n);return t(s),i}),o}))}function cC(e,t){return fe(this,void 0,void 0,function(){var n,r,a,o,i,s,l,c,d;return pe(this,function(h){switch(h.label){case 0:return t==null&&(t={}),n=t.fetchFunc==null?X().platform.fetch:t.fetchFunc,r=e.map(function(f){return n(f,t.requestInit,{isBinary:!0})}),a=0,o=.5,t.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return i=h.sent(),[3,4];case 2:return[4,Qy(r,t.onProgress,a,o)];case 3:i=h.sent(),h.label=4;case 4:return s=i.map(function(f){return f.arrayBuffer()}),l=.5,c=1,t.onProgress!=null?[3,6]:[4,Promise.all(s)];case 5:return d=h.sent(),[3,8];case 6:return[4,Qy(s,t.onProgress,l,c)];case 7:d=h.sent(),h.label=8;case 8:return[2,d]}})})}function Jy(e){var t=this;return function(n,r,a){return r===void 0&&(r=""),fe(t,void 0,void 0,function(){var o,i,s,l,c,d,h,f,p,v;return pe(this,function(g){switch(g.label){case 0:if(o=n.map(function(){return!1}),i={},s=a!=null?a.map(function(){return!1}):[],l=[],n.forEach(function(y,m){var x=0;y.weights.forEach(function(b){var w="quantization"in b?b.quantization.dtype:b.dtype,N=$f[w]*me(b.shape),C=function(){o[m]=!0,i[m]==null&&(i[m]=[]),i[m].push({manifestEntry:b,groupOffset:x,sizeBytes:N})};a!=null?a.forEach(function(S,k){S===b.name&&(C(),s[k]=!0)}):C(),l.push(b.name),x+=N})}),!s.every(function(y){return y}))throw c=a.filter(function(y,m){return!s[m]}),new Error("Could not find weights in manifest with names: "+c.join(", ")+`. 
Manifest JSON has weights with names: `+l.join(", ")+".");return d=o.reduce(function(y,m,x){return m&&y.push(x),y},[]),h=[],d.forEach(function(y){n[y].paths.forEach(function(m){var x=r+(r.endsWith("/")?"":"/")+m;h.push(x)})}),[4,e(h)];case 1:return f=g.sent(),p={},v=0,d.forEach(function(y){for(var m=n[y].paths.length,x=0,b=0;b<m;b++)x+=f[v+b].byteLength;for(var w=new ArrayBuffer(x),N=new Uint8Array(w),C=0,S=0;S<m;S++){var k=new Uint8Array(f[v+S]);N.set(k,C),C+=k.byteLength}i[y].forEach(function(_){var E=iC(w.slice(_.groupOffset,_.groupOffset+_.sizeBytes),[_.manifestEntry]);for(var j in E)p[j]=E[j]}),v+=m}),[2,p]}})})}}In.registerSaveRouter(function(e){return X().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(mh.URL_SCHEME)?function(t){return t===void 0&&(t="model"),new mh(t)}(e.slice(mh.URL_SCHEME.length)):null});var dC=function(){function e(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,n.fetchFunc!=null?(D(typeof n.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=n.fetchFunc):this.fetch=X().platform.fetch,D(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&D(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return e.prototype.save=function(t){return fe(this,void 0,void 0,function(){var n,r,a,o;return pe(this,function(i){switch(i.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:r},n.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),t.weightData!=null&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,n)];case 1:if((o=i.sent()).ok)return[2,{modelArtifactsInfo:bl(t),responses:[o]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+o.status+".")}})})},e.prototype.load=function(){return fe(this,void 0,void 0,function(){var t,n,r,a,o,i,s,l,c,d,h,f;return pe(this,function(p){switch(p.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=p.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");p.label=2;case 2:return p.trys.push([2,4,,5]),[4,t.json()];case 3:return n=p.sent(),[3,5];case 4:throw p.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(a=n.modelTopology,o=n.weightsManifest,i=n.generatedBy,s=n.convertedBy,l=n.format,c=n.userDefinedMetadata,a==null&&o==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return o==null?[3,7]:[4,this.loadWeights(o)];case 6:f=p.sent(),d=f[0],h=f[1],p.label=7;case 7:return[2,{modelTopology:a,weightSpecs:d,weightData:h,userDefinedMetadata:c,generatedBy:i,convertedBy:s,format:l}]}})})},e.prototype.loadWeights=function(t){return fe(this,void 0,void 0,function(){var n,r,a,o,i,s,l,c,d,h,f;return pe(this,function(p){switch(p.label){case 0:for(n=Array.isArray(this.path)?this.path[1]:this.path,r=function(v){var g=v.lastIndexOf("/"),y=v.lastIndexOf("?"),m=v.substring(0,g),x=y>g?v.substring(y):"";return[m+"/",x]}(n),a=r[0],o=r[1],i=this.weightPathPrefix||a,s=[],l=0,c=t;l<c.length;l++)d=c[l],s.push.apply(s,d.weights);return h=[],t.forEach(function(v){v.paths.forEach(function(g){h.push(i+g+o)})}),[4,cC(h,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return f=p.sent(),[2,[s,Mm(f)]]}})})},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function Vf(e){return e.match(dC.URL_SCHEME_REGEX)!=null}var Zy=function(e,t){return typeof fetch>"u"?null:(Array.isArray(e)?e.every(function(n){return Vf(n)}):Vf(e))?Hf(e,{onProgress:t}):null};function Hf(e,t){return new dC(e,t)}In.registerSaveRouter(Zy),In.registerLoadRouter(Zy);var vh=function(){function e(t){this.modelArtifacts=t}return e.prototype.load=function(){return fe(this,void 0,void 0,function(){return pe(this,function(t){return[2,this.modelArtifacts]})})},e}(),fF=function(){function e(t){this.saveHandler=t}return e.prototype.save=function(t){return fe(this,void 0,void 0,function(){return pe(this,function(n){return[2,this.saveHandler(t)]})})},e}(),hC=Object.freeze({browserFiles:function(e){return new hF(e)},browserHTTPRequest:function(e,t){return Hf(e,t)},concatenateArrayBuffers:Mm,decodeWeights:iC,encodeWeights:function(e,t){return fe(this,void 0,void 0,function(){var n,r,a,o,i,s=this;return pe(this,function(l){switch(l.label){case 0:for(n=[],r=[],a=Array.isArray(e)?e.map(function(c){return c.name}):Object.keys(e),o=function(c){var d=a[c],h=Array.isArray(e)?e[c].tensor:e[d];if(h.dtype!=="float32"&&h.dtype!=="int32"&&h.dtype!=="bool"&&h.dtype!=="string")throw new Error("Unsupported dtype in weight '"+d+"': "+h.dtype);var f={name:d,shape:h.shape,dtype:h.dtype};if(h.dtype==="string"){var p=new Promise(function(v){return fe(s,void 0,void 0,function(){var g,y,m,x,b,w,N;return pe(this,function(C){switch(C.label){case 0:return[4,h.bytes()];case 1:for(g=C.sent(),y=g.reduce(function(S,k){return S+k.length},0)+xc*g.length,m=new Uint8Array(y),x=0,b=0;b<g.length;b++)w=g[b],N=new Uint8Array(new Uint32Array([w.length]).buffer),m.set(N,x),x+=xc,m.set(w,x),x+=w.length;return v(m),[2]}})})});r.push(p)}else r.push(h.data());t!=null&&(f.group=t),n.push(f)},i=0;i<a.length;++i)o(i);return[4,Promise.all(r)];case 1:return[2,{data:tF(l.sent()),specs:n}]}})})},fromMemory:function(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new vh(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new vh({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new vh({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return In.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:bl,getSaveHandlers:function(e){return In.getSaveHandlers(e)},http:Hf,isHTTPScheme:Vf,loadWeights:function(e,t,n,r){return t===void 0&&(t=""),fe(this,void 0,void 0,function(){return pe(this,function(a){return[2,Jy(function(o){return cC(o,{requestInit:r})})(e,t,n)]})})},registerLoadRouter:function(e){return In.registerLoadRouter(e)},registerSaveRouter:function(e){return In.registerSaveRouter(e)},weightsLoaderFactory:Jy,withSaveHandler:function(e){return new fF(e)},copyModel:function(e,t){return fe(this,void 0,void 0,function(){return pe(this,function(n){return[2,qy(e,t,!1)]})})},listModels:function(){return fe(this,void 0,void 0,function(){var e,t,n,r,a,o,i;return pe(this,function(s){switch(s.label){case 0:e=La.getSchemes(),t={},n=0,r=e,s.label=1;case 1:return n<r.length?(a=r[n],[4,La.getManager(a).listModels()]):[3,4];case 2:for(i in o=s.sent())t[a+xi+i]=o[i];s.label=3;case 3:return n++,[3,1];case 4:return[2,t]}})})},moveModel:function(e,t){return fe(this,void 0,void 0,function(){return pe(this,function(n){return[2,qy(e,t,!0)]})})},removeModel:function(e){return fe(this,void 0,void 0,function(){var t;return pe(this,function(n){return t=Cu(e),[2,La.getManager(t.scheme).removeModel(t.path)]})})}}),Wo;F({confusionMatrix_:function(e,t,n){var r=R(e,"labels","confusionMatrix"),a=R(t,"predictions","confusionMatrix");D(n==null||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),D(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),D(a.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+a.rank}),D(r.shape[0]===a.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+a.shape[0]+". Labels and predictions should have the same number of elements."}),D(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var o=Mf(r.asType("int32"),n),i=Mf(a.asType("int32"),n);return o.transpose().matMul(i).asType("int32")}});var pF=F({fromPixels_:function(e,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,a=!1,o=!1,i=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)a=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)o=!0;else{if(e.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);i=!0}if(a&&a&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(Mw("FromPixels",O.backendName)!=null)return O.runKernel("FromPixels",{pixels:e},{numChannels:t});var s,l,c=a?[e.videoWidth,e.videoHeight]:[e.width,e.height],d=c[0],h=c[1];if(i?s=e.getContext("2d").getImageData(0,0,d,h).data:r||n?s=e.data:(o||a)&&(Wo==null&&(Wo=document.createElement("canvas").getContext("2d")),Wo.canvas.width=d,Wo.canvas.height=h,Wo.drawImage(e,0,0,d,h),s=Wo.getImageData(0,0,d,h).data),t===4)l=new Int32Array(s);else{var f=d*h;l=new Int32Array(f*t);for(var p=0;p<f;p++)for(var v=0;v<t;++v)l[p*t+v]=s[4*p+v]}return dm(l,[h,d,t],"int32")}}),Om=Object.freeze({toPixels:function(e,t){return fe(this,void 0,void 0,function(){var n,r,a,o,i,s,l,c,d,h,f,p,v,g,y,m,x,b,w,N,C,S,k;return pe(this,function(_){switch(_.label){case 0:if(n=R(e,"img","toPixels"),e instanceof it||(n=n.toInt()),n.rank!==2&&n.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),a=r[0],o=r[1],(i=n.rank===2?1:n.shape[2])>4||i===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+i);return[4,n.data()];case 1:return s=_.sent(),l=n.min(),c=n.max(),[4,Promise.all([l.data(),c.data()])];case 2:if(d=_.sent(),h=d[0],f=d[1],p=h[0],v=f[0],l.dispose(),c.dispose(),n.dtype==="float32"){if(p<0||v>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+p+" - "+v+"].")}else{if(n.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(p<0||v>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+p+" - "+v+"].")}for(g=n.dtype==="float32"?255:1,y=new Uint8ClampedArray(o*a*4),m=0;m<a*o;++m)x=void 0,b=void 0,w=void 0,N=void 0,i===1?(x=s[m]*g,b=s[m]*g,w=s[m]*g,N=255):i===3?(x=s[3*m]*g,b=s[3*m+1]*g,w=s[3*m+2]*g,N=255):i===4&&(x=s[4*m]*g,b=s[4*m+1]*g,w=s[4*m+2]*g,N=s[4*m+3]*g),y[(C=4*m)+0]=Math.round(x),y[C+1]=Math.round(b),y[C+2]=Math.round(w),y[C+3]=Math.round(N);return t!=null&&(t.width=o,t.height=a,S=t.getContext("2d"),k=new ImageData(y,o,a),S.putImageData(k,0,0)),n!==e&&n.dispose(),[2,y]}})})},fromPixels:pF}),mF=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(t,n){return new t(n)},e}(),vF=function(){function e(){this.classNameMap={}}return e.getMap=function(){return e.instance==null&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function Mo(e){D(e.className!=null,function(){return"Class being registered does not have the static className property defined."}),D(typeof e.className=="string",function(){return"className is required to be a string, but got type "+typeof e.className}),D(e.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),vF.register(e)}var Oo=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return cr(t,e),t.prototype.minimize=function(n,r,a){r===void 0&&(r=!1);var o=this.computeGradients(n,a),i=o.value,s=o.grads;if(a!=null){var l=a.map(function(c){return{name:c.name,tensor:s[c.name]}});this.applyGradients(l)}else this.applyGradients(s);return Nn(s),r?i:(i.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(n,r){return S5(n,r)},t.prototype.dispose=function(){this.iterations_!=null&&Nn(this.iterations_)},t.prototype.saveIterations=function(){return fe(this,void 0,void 0,function(){return pe(this,function(n){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:le(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return fe(this,void 0,void 0,function(){return pe(this,function(n){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(n){return fe(this,void 0,void 0,function(){return pe(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(n){return fe(this,void 0,void 0,function(){var r;return pe(this,function(a){switch(a.label){case 0:return r=this,[4,n[0].tensor.data()];case 1:return r.iterations_=a.sent()[0],[2,n.slice(1)]}})})},t}(mF);Object.defineProperty(Oo,Symbol.hasInstance,{value:function(e){return e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null}});var gF=function(e){function t(n,r,a){a===void 0&&(a=null);var o=e.call(this)||this;return o.learningRate=n,o.rho=r,o.epsilon=a,o.accumulatedGrads=[],o.accumulatedUpdates=[],a==null&&(o.epsilon=O.backend.epsilon()),o}return cr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(a){return a.name}):Object.keys(n)).forEach(function(a,o){var i=O.registeredVariables[a];r.accumulatedGrads[o]==null&&(r.accumulatedGrads[o]={originalName:a+"/accum_grad",variable:ce(function(){return Ue(i).variable(!1)})}),r.accumulatedUpdates[o]==null&&(r.accumulatedUpdates[o]={originalName:a+"/accum_var",variable:ce(function(){return Ue(i).variable(!1)})});var s=Array.isArray(n)?n[o].tensor:n[a];if(s!=null){var l=r.accumulatedGrads[o].variable,c=r.accumulatedUpdates[o].variable;ce(function(){var d=l.mul(r.rho).add(s.square().mul(1-r.rho)),h=c.add(r.epsilon).sqrt().div(l.add(r.epsilon).sqrt()).mul(s),f=c.mul(r.rho).add(h.square().mul(1-r.rho));l.assign(d),c.assign(f);var p=h.mul(-r.learningRate).add(i);i.assign(p)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(Nn(this.accumulatedGrads.map(function(n){return n.variable})),Nn(this.accumulatedUpdates.map(function(n){return n.variable})))},t.prototype.getWeights=function(){return fe(this,void 0,void 0,function(){var n;return pe(this,function(r){switch(r.label){case 0:return n=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(n){return fe(this,void 0,void 0,function(){var r;return pe(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(n)];case 1:return n=a.sent(),r=n.length/2,this.accumulatedGrads=n.slice(0,r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),this.accumulatedUpdates=n.slice(r,2*r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.rho,r.epsilon)},t.className="Adadelta",t}(Oo);Mo(gF);var xF=function(e){function t(n,r){r===void 0&&(r=.1);var a=e.call(this)||this;return a.learningRate=n,a.initialAccumulatorValue=r,a.accumulatedGrads=[],a}return cr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(a){return a.name}):Object.keys(n)).forEach(function(a,o){var i=O.registeredVariables[a];r.accumulatedGrads[o]==null&&(r.accumulatedGrads[o]={originalName:a+"/accumulator",variable:ce(function(){return Rr(i.shape,r.initialAccumulatorValue).variable(!1)})});var s=Array.isArray(n)?n[o].tensor:n[a];if(s!=null){var l=r.accumulatedGrads[o].variable;ce(function(){var c=l.add(s.square());l.assign(c);var d=s.div(c.add(O.backend.epsilon()).sqrt()).mul(-r.learningRate).add(i);i.assign(d)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&Nn(this.accumulatedGrads.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return fe(this,void 0,void 0,function(){return pe(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return fe(this,void 0,void 0,function(){return pe(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulatedGrads=n.map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(n,r){return new n(r.learningRate,r.initialAccumulatorValue)},t.className="Adagrad",t}(Oo);Mo(xF);var yF=function(e){function t(n,r,a,o){o===void 0&&(o=null);var i=e.call(this)||this;return i.learningRate=n,i.beta1=r,i.beta2=a,i.epsilon=o,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],ce(function(){i.accBeta1=le(r).variable(),i.accBeta2=le(a).variable()}),o==null&&(i.epsilon=O.backend.epsilon()),i}return cr(t,e),t.prototype.applyGradients=function(n){var r=this,a=Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n);ce(function(){var o=At(1,r.accBeta1),i=At(1,r.accBeta2);a.forEach(function(s,l){var c=O.registeredVariables[s];r.accumulatedFirstMoment[l]==null&&(r.accumulatedFirstMoment[l]={originalName:s+"/m",variable:ce(function(){return Ue(c).variable(!1)})}),r.accumulatedSecondMoment[l]==null&&(r.accumulatedSecondMoment[l]={originalName:s+"/v",variable:ce(function(){return Ue(c).variable(!1)})});var d=Array.isArray(n)?n[l].tensor:n[s];if(d!=null){var h=r.accumulatedFirstMoment[l].variable,f=r.accumulatedSecondMoment[l].variable,p=h.mul(r.beta1).add(d.mul(1-r.beta1)),v=f.mul(r.beta2).add(d.square().mul(1-r.beta2)),g=p.div(o),y=v.div(i);h.assign(p),f.assign(v);var m=g.div(y.sqrt().add(r.epsilon)).mul(-r.learningRate).add(c);c.assign(m)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Nn(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedSecondMoment!=null&&Nn(this.accumulatedSecondMoment.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return fe(this,void 0,void 0,function(){var n;return pe(this,function(r){switch(r.label){case 0:return n=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(n){return fe(this,void 0,void 0,function(){var r,a=this;return pe(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),ce(function(){a.accBeta1.assign(vc(a.beta1,a.iterations_+1)),a.accBeta2.assign(vc(a.beta2,a.iterations_+1))}),r=n.length/2,this.accumulatedFirstMoment=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedSecondMoment=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon)},t.className="Adam",t}(Oo);Mo(yF);var bF=function(e){function t(n,r,a,o,i){o===void 0&&(o=null),i===void 0&&(i=0);var s=e.call(this)||this;return s.learningRate=n,s.beta1=r,s.beta2=a,s.epsilon=o,s.decay=i,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],ce(function(){s.iteration=le(0).variable(),s.accBeta1=le(r).variable()}),o==null&&(s.epsilon=O.backend.epsilon()),s}return cr(t,e),t.prototype.applyGradients=function(n){var r=this,a=Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n);ce(function(){var o=At(1,r.accBeta1),i=tr(-r.learningRate,r.iteration.mul(r.decay).add(1));a.forEach(function(s,l){var c=O.registeredVariables[s];r.accumulatedFirstMoment[l]==null&&(r.accumulatedFirstMoment[l]={originalName:s+"/m",variable:Ue(c).variable(!1)}),r.accumulatedWeightedInfNorm[l]==null&&(r.accumulatedWeightedInfNorm[l]={originalName:s+"/v",variable:Ue(c).variable(!1)});var d=Array.isArray(n)?n[l].tensor:n[s];if(d!=null){var h=r.accumulatedFirstMoment[l].variable,f=r.accumulatedWeightedInfNorm[l].variable,p=h.mul(r.beta1).add(d.mul(1-r.beta1)),v=f.mul(r.beta2),g=d.abs(),y=v.maximum(g);h.assign(p),f.assign(y);var m=i.div(o).mul(p.div(y.add(r.epsilon))).add(c);c.assign(m)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Nn(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedWeightedInfNorm!=null&&Nn(this.accumulatedWeightedInfNorm.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return fe(this,void 0,void 0,function(){return pe(this,function(n){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(n){return fe(this,void 0,void 0,function(){return pe(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},t.className="Adamax",t}(Oo);Mo(bF);var fC=function(e){function t(n){var r=e.call(this)||this;return r.learningRate=n,r.setLearningRate(n),r}return cr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(a){return a.name}):Object.keys(n)).forEach(function(a,o){var i=Array.isArray(n)?n[o].tensor:n[a];if(i!=null){var s=O.registeredVariables[a];ce(function(){var l=r.c.mul(i).add(s);s.assign(l)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(n){this.learningRate=n,this.c!=null&&this.c.dispose(),this.c=zI(le(-n))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return fe(this,void 0,void 0,function(){return pe(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()]]}})})},t.prototype.setWeights=function(n){return fe(this,void 0,void 0,function(){return pe(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:if((n=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(n,r){return new n(r.learningRate)},t.className="SGD",t}(Oo);Mo(fC);var wF=function(e){function t(n,r,a){a===void 0&&(a=!1);var o=e.call(this,n)||this;return o.learningRate=n,o.momentum=r,o.useNesterov=a,o.accumulations=[],o.m=le(o.momentum),o}return cr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(a){return a.name}):Object.keys(n)).forEach(function(a,o){var i=O.registeredVariables[a];r.accumulations[o]==null&&(r.accumulations[o]={originalName:a+"/momentum",variable:ce(function(){return Ue(i).variable(!1)})});var s=r.accumulations[o].variable,l=Array.isArray(n)?n[o].tensor:n[a];l!=null&&ce(function(){var c,d=r.m.mul(s).add(l);c=r.useNesterov?r.c.mul(l.add(d.mul(r.m))).add(i):r.c.mul(d).add(i),s.assign(d),i.assign(c)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&Nn(this.accumulations.map(function(n){return n.variable}))},t.prototype.setMomentum=function(n){this.momentum=n},t.prototype.getWeights=function(){return fe(this,void 0,void 0,function(){return pe(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return fe(this,void 0,void 0,function(){return pe(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulations=n.map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(n,r){return new n(r.learningRate,r.momentum,r.useNesterov)},t.className="Momentum",t}(fC);Mo(wF);var NF=function(e){function t(n,r,a,o,i){r===void 0&&(r=.9),a===void 0&&(a=0),o===void 0&&(o=null),i===void 0&&(i=!1);var s=e.call(this)||this;if(s.learningRate=n,s.decay=r,s.momentum=a,s.epsilon=o,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=i,o==null&&(s.epsilon=O.backend.epsilon()),n==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return s}return cr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(a){return a.name}):Object.keys(n)).forEach(function(a,o){var i=O.registeredVariables[a];r.accumulatedMeanSquares[o]==null&&(r.accumulatedMeanSquares[o]={originalName:a+"/rms",variable:ce(function(){return Ue(i).variable(!1)})}),r.accumulatedMoments[o]==null&&(r.accumulatedMoments[o]={originalName:a+"/momentum",variable:ce(function(){return Ue(i).variable(!1)})}),r.accumulatedMeanGrads[o]==null&&r.centered&&(r.accumulatedMeanGrads[o]={originalName:a+"/mg",variable:ce(function(){return Ue(i).variable(!1)})});var s=Array.isArray(n)?n[o].tensor:n[a];if(s!=null){var l=r.accumulatedMeanSquares[o].variable,c=r.accumulatedMoments[o].variable;ce(function(){var d=l.mul(r.decay).add(s.square().mul(1-r.decay));if(r.centered){var h=r.accumulatedMeanGrads[o].variable,f=h.mul(r.decay).add(s.mul(1-r.decay)),p=c.mul(r.momentum).add(s.mul(r.learningRate).div(d.sub(f.square().add(r.epsilon)).sqrt()));l.assign(d),h.assign(f),c.assign(p);var v=i.sub(p);i.assign(v)}else{var g=l.mul(r.decay).add(s.square().mul(1-r.decay));p=c.mul(r.momentum).add(s.mul(r.learningRate).div(g.add(r.epsilon).sqrt())),l.assign(g),c.assign(p),v=i.sub(p),i.assign(v)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&Nn(this.accumulatedMeanSquares.map(function(n){return n.variable})),this.accumulatedMeanGrads!=null&&this.centered&&Nn(this.accumulatedMeanGrads.map(function(n){return n.variable})),this.accumulatedMoments!=null&&Nn(this.accumulatedMoments.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return fe(this,void 0,void 0,function(){var n;return pe(this,function(r){switch(r.label){case 0:return n=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&n.push.apply(n,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(n){return fe(this,void 0,void 0,function(){var r;return pe(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(n)];case 1:return n=a.sent(),r=this.centered?n.length/3:n.length/2,this.accumulatedMeanSquares=n.slice(0,r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),this.accumulatedMoments=n.slice(r,2*r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=n.slice(2*r,3*r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(n,r){return new n(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},t.className="RMSProp",t}(Oo);Mo(NF);it.prototype.squaredDifference=function(e){return _N(this,e)},q=KP;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Gf=function(e,t){return Gf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var a in r)r.hasOwnProperty(a)&&(n[a]=r[a])},Gf(e,t)};function Re(e,t){Gf(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var Jt=function(){return Jt=Object.assign||function(t){for(var n,r=1,a=arguments.length;r<a;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Jt.apply(this,arguments)};function ge(e,t,n,r){function a(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function s(d){try{c(r.next(d))}catch(h){i(h)}}function l(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?o(d.value):a(d.value).then(s,l)}c((r=r.apply(e,[])).next())})}function xe(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,a,o,i;return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(c){return function(d){return l([c,d])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,a&&(o=c[0]&2?a.return:c[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,c[1])).done)return o;switch(a=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,a=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){n.label=c[1];break}if(c[0]===6&&n.label<o[1]){n.label=o[1],o=c;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(c);break}o[2]&&n.ops.pop(),n.trys.pop();continue}c=t.call(e,n)}catch(d){c=[6,d],a=0}finally{r=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function _s(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),a=0,t=0;t<n;t++)for(var o=arguments[t],i=0,s=o.length;i<s;i++,a++)r[a]=o[i];return r}var wi=function(){function e(t,n){if(!xo(t)||!xo(n))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:n}));this._width=t,this._height=n}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.reverse=function(){return new e(1/this.width,1/this.height)},e}();function od(e,t){return e instanceof it&&e.shape.length===t}function CF(e){return od(e,2)}function id(e){return od(e,3)}function Ba(e){return od(e,4)}function kF(e){return e%1!==0}function e1(e){return e%2===0}function jF(e,t){t===void 0&&(t=2);var n=Math.pow(10,t);return Math.floor(e*n)/n}function t1(e){return e&&e.width&&e.height}function SF(e,t){var n=e.width,r=e.height,a=t/Math.max(r,n);return new wi(Math.round(n*a),Math.round(r*a))}function Lm(e){return e.reduce(function(t,n){return t.add(n)},new He(0,0)).div(new He(e.length,e.length))}function el(e,t,n){return Array(e).fill(0).map(function(r,a){return t+a*n})}function xo(e){return!!e&&e!==1/0&&e!==-1/0&&!isNaN(e)||e===0}function n1(e){return xo(e)&&0<=e&&e<=1}var He=function(){function e(t,n){this._x=t,this._y=n}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.mul=function(t){return new e(this.x*t.x,this.y*t.y)},e.prototype.div=function(t){return new e(this.x/t.x,this.y/t.y)},e.prototype.abs=function(){return new e(Math.abs(this.x),Math.abs(this.y))},e.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y))},e}(),Va=function(){function e(t,n){n===void 0&&(n=!0);var r=t||{},a=[r.left,r.top,r.right,r.bottom].every(xo),o=[r.x,r.y,r.width,r.height].every(xo);if(!o&&!a)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var i=o?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=i[0],l=i[1],c=i[2],d=i[3];e.assertIsValidBox({x:s,y:l,width:c,height:d},"Box.constructor",n),this._x=s,this._y=l,this._width=c,this._height=d}return e.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(xo)},e.assertIsValidBox=function(t,n,r){if(r===void 0&&(r=!1),!e.isRect(t))throw new Error(n+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!r&&(t.width<0||t.height<0))throw new Error(n+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topLeft",{get:function(){return new He(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topRight",{get:function(){return new He(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomLeft",{get:function(){return new He(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRight",{get:function(){return new He(this.right,this.bottom)},enumerable:!0,configurable:!0}),e.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(i){return Math.round(i)}),n=t[0],r=t[1],a=t[2],o=t[3];return new e({x:n,y:r,width:a,height:o})},e.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(i){return Math.floor(i)}),n=t[0],r=t[1],a=t[2],o=t[3];return new e({x:n,y:r,width:a,height:o})},e.prototype.toSquare=function(){var t=this,n=t.x,r=t.y,a=t.width,o=t.height,i=Math.abs(a-o);return a<o&&(n-=i/2,a+=i),o<a&&(r-=i/2,o+=i),new e({x:n,y:r,width:a,height:o})},e.prototype.rescale=function(t){var n=t1(t)?t.width:t,r=t1(t)?t.height:t;return new e({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},e.prototype.pad=function(t,n){var r=[this.x-t/2,this.y-n/2,this.width+t,this.height+n],a=r[0],o=r[1],i=r[2],s=r[3];return new e({x:a,y:o,width:i,height:s})},e.prototype.clipAtImageBorders=function(t,n){var r=this,a=r.x,o=r.y,i=r.right,s=r.bottom,l=Math.max(a,0),c=Math.max(o,0),d=i-l,h=s-c,f=Math.min(d,t-l),p=Math.min(h,n-c);return new e({x:l,y:c,width:f,height:p}).floor()},e.prototype.shift=function(t,n){var r=this,a=r.width,o=r.height,i=this.x+t,s=this.y+n;return new e({x:i,y:s,width:a,height:o})},e.prototype.padAtBorders=function(t,n){var r=this.width+1,a=this.height+1,o=1,i=1,s=r,l=a,c=this.left,d=this.top,h=this.right,f=this.bottom;return h>n&&(s=-h+n+r,h=n),f>t&&(l=-f+t+a,f=t),c<1&&(l=2-c,c=1),d<1&&(l=2-d,d=1),{dy:i,edy:l,dx:o,edx:s,y:d,ey:f,x:c,ex:h,w:r,h:a}},e.prototype.calibrate=function(t){return new e({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},e}(),sd=function(e){Re(t,e);function t(n,r,a,o,i){return i===void 0&&(i=!1),e.call(this,{left:n,top:r,right:a,bottom:o},i)||this}return t}(Va),pC=function(){function e(t,n,r,a,o){this._imageDims=new wi(o.width,o.height),this._score=t,this._classScore=n,this._className=r,this._box=new Va(a).rescale(this._imageDims)}return Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativeBox",{get:function(){return new Va(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new e(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:n})},e}(),Mr=function(e){Re(t,e);function t(n,r,a){return e.call(this,n,n,"",r,a)||this}return t.prototype.forSize=function(n,r){var a=e.prototype.forSize.call(this,n,r),o=a.score,i=a.relativeBox,s=a.imageDims;return new t(o,i,s)},t}(pC);function EF(e,t,n){n===void 0&&(n=!0);var r=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),a=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),o=r*a;return n?o/(e.area+t.area-o):o/Math.min(e.area,t.area)}function _F(e){var t=e.map(function(s){return s.x}),n=e.map(function(s){return s.y}),r=t.reduce(function(s,l){return l<s?l:s},1/0),a=n.reduce(function(s,l){return l<s?l:s},1/0),o=t.reduce(function(s,l){return s<l?l:s},0),i=n.reduce(function(s,l){return s<l?l:s},0);return new sd(r,a,o,i)}function tl(e,t,n,r){r===void 0&&(r=!0);for(var a=t.map(function(s,l){return{score:s,boxIndex:l}}).sort(function(s,l){return s.score-l.score}).map(function(s){return s.boxIndex}),o=[],i=function(){var s=a.pop();o.push(s);for(var l=a,c=[],d=0;d<l.length;d++){var h=l[d],f=e[s],p=e[h];c.push(EF(f,p,r))}a=a.filter(function(v,g){return c[g]<=n})};a.length>0;)i();return o}function wl(e,t){return ce(function(){var n=t[0],r=t[1],a=t[2],o=Rr(_s(e.shape.slice(0,3),[1]),n),i=Rr(_s(e.shape.slice(0,3),[1]),r),s=Rr(_s(e.shape.slice(0,3),[1]),a),l=_t([o,i,s],3);return At(e,l)})}function RF(e,t){return t===void 0&&(t=!1),ce(function(){var n=e.shape.slice(1),r=n[0],a=n[1];if(r===a)return e;var o=Math.abs(r-a),i=Math.round(o*(t?.5:1)),s=r>a?2:1,l=function(p){var v=e.shape.slice();return v[s]=p,Rr(v,0)},c=l(i),d=o-c.shape[s],h=t&&d?l(d):null,f=[h,e,c].filter(function(p){return!!p}).map(function(p){return p.toFloat()});return _t(f,s)})}function gh(e){return 1/(1+Math.exp(-e))}var Bm=function(e){Re(t,e);function t(n,r,a,o,i){return i===void 0&&(i=!1),e.call(this,{x:n,y:r,width:a,height:o},i)||this}return t}(Va),IF=.5,AF=.43,DF=.45,yc=function(){function e(t,n,r){r===void 0&&(r=new He(0,0));var a=n.width,o=n.height;this._imgDims=new wi(a,o),this._shift=r,this._positions=t.map(function(i){return i.mul(new He(a,o)).add(r)})}return Object.defineProperty(e.prototype,"shift",{get:function(){return new He(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map(function(n){return n.sub(t._shift).div(new He(t.imageWidth,t.imageHeight))})},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new this.constructor(this.relativePositions,{width:t,height:n})},e.prototype.shiftBy=function(t,n){return new this.constructor(this.relativePositions,this._imgDims,new He(t,n))},e.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},e.prototype.align=function(t,n){if(n===void 0&&(n={}),t){var r=t instanceof Mr?t.box.floor():new Va(t);return this.shiftBy(r.x,r.y).align(null,n)}var a=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},n),o=a.useDlibAlignment,i=a.minBoxPadding;return o?this.alignDlib():this.alignMinBbox(i)},e.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),n=t[0],r=t[1],a=t[2],o=function(h){return a.sub(h).magnitude()},i=(o(n)+o(r))/2,s=Math.floor(i/DF),l=Lm(t),c=Math.floor(Math.max(0,l.x-IF*s)),d=Math.floor(Math.max(0,l.y-AF*s));return new Bm(c,d,Math.min(s,this.imageWidth+c),Math.min(s,this.imageHeight+d))},e.prototype.alignMinBbox=function(t){var n=_F(this.positions);return n.pad(n.width*t,n.height*t)},e.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},e}(),TF=function(e){Re(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getRefPointsForAlignment=function(){var n=this.positions;return[n[0],n[1],Lm([n[3],n[4]])]},t}(yc),PF=function(e){Re(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(Lm)},t}(yc),r1=function(){function e(t,n){this._label=t,this._distance=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),e.prototype.toString=function(t){return t===void 0&&(t=!0),""+this.label+(t?" ("+jF(this.distance)+")":"")},e}(),a1=function(e){Re(t,e);function t(n,r){var a=e.call(this,n)||this;return a._label=r,a}return t.assertIsValidLabeledBox=function(n,r){if(Va.assertIsValidBox(n,r),!xo(n.label))throw new Error(r+" - expected property label ("+n.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(Va),eu=function(){function e(t,n){if(typeof t!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(n)||n.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(t){return Array.from(t)})}},e.fromJSON=function(t){var n=t.descriptors.map(function(r){return new Float32Array(r)});return new e(t.label,n)},e}();(function(e){Re(t,e);function t(n,r,a,o){var i=e.call(this,n,r)||this;return i._score=a,i._classScore=o,i}return t.assertIsValidPredictedBox=function(n,r){if(a1.assertIsValidLabeledBox(n,r),!n1(n.score)||!n1(n.classScore))throw new Error(r+" - expected properties score ("+n.score+") and ("+n.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),t})(a1);function FF(e){return e.detection instanceof Mr}function zm(e,t){var n={detection:t};return Object.assign({},e,n)}function mC(){var e=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},t=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:e,readFile:t}}function vC(e){var t="";if(!e)try{e=require("fs")}catch(r){t=r.toString()}var n=e?function(r){return new Promise(function(a,o){e.readFile(r,function(i,s){return i?o(i):a(s)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)};return{readFile:n}}function gC(){var e=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,n=function(){if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},r=function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},a=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},o=vC();return Jt({Canvas:e||function(){function i(){}return i}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function i(){}return i}(),Image:t||function(){function i(){}return i}(),ImageData:global.ImageData||function(){function i(){}return i}(),Video:global.HTMLVideoElement||function(){function i(){}return i}(),createCanvasElement:n,createImageElement:r,fetch:a},o)}function xC(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function yC(){return typeof global=="object"&&typeof require=="function"&&typeof QC<"u"&&typeof process<"u"&&!!process.version}var kt;function MF(){if(!kt)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return kt}function qf(e){kt=e}function $m(){xC()&&qf(mC()),yC()&&qf(gC())}function OF(e){if(kt||$m(),!kt)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=e.Canvas,n=t===void 0?kt.Canvas:t,r=e.Image,a=r===void 0?kt.Image:r;kt.Canvas=n,kt.Image=a,kt.createCanvasElement=e.createCanvasElement||function(){return new n},kt.createImageElement=e.createImageElement||function(){return new a},kt.ImageData=e.ImageData||kt.ImageData,kt.Video=e.Video||kt.Video,kt.fetch=e.fetch||kt.fetch,kt.readFile=e.readFile||kt.readFile}var an={getEnv:MF,setEnv:qf,initialize:$m,createBrowserEnv:mC,createFileSystem:vC,createNodejsEnv:gC,monkeyPatch:OF,isBrowser:xC,isNodejs:yC};$m();function bC(e){return!an.isNodejs()&&typeof e=="string"?document.getElementById(e):e}function Io(e){var t=an.getEnv(),n=t.Canvas,r=t.CanvasRenderingContext2D;if(e instanceof r)return e;var a=bC(e);if(!(a instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var o=a.getContext("2d");if(!o)throw new Error("resolveContext2d - canvas 2d context is null");return o}var o1;(function(e){e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT"})(o1||(o1={}));function wC(e){var t=an.getEnv(),n=t.Image,r=t.Video;return e instanceof n&&e.complete||e instanceof r&&e.readyState>=3}function LF(e){return new Promise(function(t,n){if(e instanceof an.getEnv().Canvas||wC(e))return t();function r(o){o.currentTarget&&(o.currentTarget.removeEventListener("load",r),o.currentTarget.removeEventListener("error",a),t(o))}function a(o){o.currentTarget&&(o.currentTarget.removeEventListener("load",r),o.currentTarget.removeEventListener("error",a),n(o))}e.addEventListener("load",r),e.addEventListener("error",a)})}function NC(e){var t=an.getEnv(),n=t.Image,r=t.Video;return e instanceof n?new wi(e.naturalWidth,e.naturalHeight):e instanceof r?new wi(e.videoWidth,e.videoHeight):new wi(e.width,e.height)}function ld(e){var t=e.width,n=e.height,r=an.getEnv().createCanvasElement,a=r();return a.width=t,a.height=n,a}function Um(e,t){var n=an.getEnv().ImageData;if(!(e instanceof n)&&!wC(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=NC(e),a=r.width,o=r.height,i=ld({width:a,height:o});return e instanceof n?Io(i).putImageData(e,0,0):Io(i).drawImage(e,0,0,a,o),i}function BF(e,t){return ge(this,void 0,void 0,function(){var n,r,a,o,i,s;return xe(this,function(l){switch(l.label){case 0:return n=an.getEnv().createCanvasElement(),r=e.shape.slice(Ba(e)?1:0),a=r[0],o=r[1],i=r[2],s=ce(function(){return e.as3D(a,o,i).toInt()}),[4,Om.toPixels(s,n)];case 1:return l.sent(),s.dispose(),[2,n]}})})}function i1(e){var t=an.getEnv(),n=t.Image,r=t.Canvas,a=t.Video;return e instanceof n||e instanceof r||e instanceof a}function zF(e,t,n){n===void 0&&(n=!1);var r=an.getEnv(),a=r.Image,o=r.Canvas;if(!(e instanceof a||e instanceof o))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var i=NC(e),s=t/Math.max(i.height,i.width),l=s*i.width,c=s*i.height,d=ld({width:t,height:t}),h=e instanceof o?e:Um(e),f=Math.abs(l-c)/2,p=n&&l<c?f:0,v=n&&c<l?f:0;return Io(d).drawImage(h,p,v,l,c),d}var bc=function(){function e(t,n){var r=this;if(n===void 0&&(n=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=n,this._batchSize=t.length,t.forEach(function(a,o){if(id(a)){r._imageTensors[o]=a,r._inputDimensions[o]=a.shape;return}if(Ba(a)){var i=a.shape[0];if(i!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+i+" passed, but not supported in input array");r._imageTensors[o]=a,r._inputDimensions[o]=a.shape.slice(1);return}var s=a instanceof an.getEnv().Canvas?a:Um(a);r._canvases[o]=s,r._inputDimensions[o]=[s.height,s.width,3]})}return Object.defineProperty(e.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reshapedInputDimensions",{get:function(){var t=this;return el(this.batchSize,0,1).map(function(n,r){return t.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),e.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},e.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},e.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},e.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},e.prototype.getReshapedInputDimensions=function(t){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var n=this.getInputWidth(t),r=this.getInputHeight(t);return SF({width:n,height:r},this.inputSize)},e.prototype.toBatchTensor=function(t,n){var r=this;return n===void 0&&(n=!0),this._inputSize=t,ce(function(){var a=el(r.batchSize,0,1).map(function(i){var s=r.getInput(i);if(s instanceof it){var l=Ba(s)?s:s.expandDims();return l=RF(l,n),(l.shape[1]!==t||l.shape[2]!==t)&&(l=Am.resizeBilinear(l,[t,t])),l.as3D(t,t,3)}if(s instanceof an.getEnv().Canvas)return Om.fromPixels(zF(s,t,n));throw new Error("toBatchTensor - at batchIdx "+i+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+s)}),o=Pn(a.map(function(i){return i.toFloat()})).as4D(r.batchSize,t,t,3);return o})},e}();function Bt(e){return ge(this,void 0,void 0,function(){var t,n,r;return xe(this,function(a){switch(a.label){case 0:if(e instanceof bc)return[2,e];if(t=Array.isArray(e)?e:[e],!t.length)throw new Error("toNetInput - empty array passed as input");return n=function(o){return Array.isArray(e)?" at input index "+o+":":""},r=t.map(bC),r.forEach(function(o,i){if(!i1(o)&&!id(o)&&!Ba(o))throw typeof t[i]=="string"?new Error("toNetInput -"+n(i)+" string passed, but could not resolve HTMLElement for element id "+t[i]):new Error("toNetInput -"+n(i)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(Ba(o)){var s=o.shape[0];if(s!==1)throw new Error("toNetInput -"+n(i)+" tf.Tensor4D with batchSize "+s+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(o){return i1(o)&&LF(o)}))];case 1:return a.sent(),[2,new bc(r,Array.isArray(e))]}})})}function Wm(e,t){return ge(this,void 0,void 0,function(){var n,r,a,o,i,s,l;return xe(this,function(c){switch(c.label){case 0:return n=an.getEnv().Canvas,r=e,e instanceof n?[3,5]:[4,Bt(e)];case 1:if(a=c.sent(),a.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return o=a.getInput(0),o instanceof n?(i=o,[3,4]):[3,2];case 2:return[4,BF(o)];case 3:i=c.sent(),c.label=4;case 4:r=i,c.label=5;case 5:return s=Io(r),l=t.map(function(d){return d instanceof Mr?d.forSize(r.width,r.height).box.floor():d}).map(function(d){return d.clipAtImageBorders(r.width,r.height)}),[2,l.map(function(d){var h=d.x,f=d.y,p=d.width,v=d.height,g=ld({width:p,height:v});return Io(g).putImageData(s.getImageData(h,f,p,v),0,0),g})]}})})}function Vm(e,t){return ge(this,void 0,void 0,function(){return xe(this,function(n){if(!id(e)&&!Ba(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Ba(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,ce(function(){var r=e.shape.slice(Ba(e)?1:0),a=r[0],o=r[1],i=r[2],s=t.map(function(c){return c instanceof Mr?c.forSize(o,a).box:c}).map(function(c){return c.clipAtImageBorders(o,a)}),l=s.map(function(c){var d=c.x,h=c.y,f=c.width,p=c.height;return XN(e.as3D(a,o,i),[h,d,0],[p,f,i])});return l})]})})}function $F(e,t){return ge(this,void 0,void 0,function(){var n,r;return xe(this,function(a){switch(a.label){case 0:return n=an.getEnv().fetch,[4,n(e,t)];case 1:if(r=a.sent(),!(r.status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function UF(e){return ge(this,void 0,void 0,function(){return xe(this,function(t){switch(t.label){case 0:return[4,$F(e)];case 1:return[2,t.sent().json()]}})})}function CC(e,t){var n=t+"-weights_manifest.json";if(!e)return{modelBaseUri:"",manifestUri:n};if(e==="/")return{modelBaseUri:"/",manifestUri:"/"+n};var r=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"";e=e.replace(r,"");var a=e.split("/").filter(function(s){return s}),o=e.endsWith(".json")?a[a.length-1]:n,i=r+(e.endsWith(".json")?a.slice(0,a.length-1):a).join("/");return i=e.startsWith("/")?"/"+i:i,{modelBaseUri:i,manifestUri:i==="/"?"/"+o:i+"/"+o}}function WF(e,t){return ge(this,void 0,void 0,function(){var n,r,a,o;return xe(this,function(i){switch(i.label){case 0:return n=CC(e,t),r=n.manifestUri,a=n.modelBaseUri,[4,UF(r)];case 1:return o=i.sent(),[2,hC.loadWeights(o,a)]}})})}var la=function(){function e(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(e.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),e.prototype.getParamFromPath=function(t){var n=this.traversePropertyPath(t),r=n.obj,a=n.objProp;return r[a]},e.prototype.reassignParamFromPath=function(t,n){var r=this.traversePropertyPath(t),a=r.obj,o=r.objProp;a[o].dispose(),a[o]=n},e.prototype.getParamList=function(){var t=this;return this._paramMappings.map(function(n){var r=n.paramPath;return{path:r,tensor:t.getParamFromPath(r)}})},e.prototype.getTrainableParams=function(){return this.getParamList().filter(function(t){return t.tensor instanceof Bi})},e.prototype.getFrozenParams=function(){return this.getParamList().filter(function(t){return!(t.tensor instanceof Bi)})},e.prototype.variable=function(){var t=this;this.getFrozenParams().forEach(function(n){var r=n.path,a=n.tensor;t.reassignParamFromPath(r,a.variable())})},e.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach(function(n){var r=n.path,a=n.tensor,o=Ht(a.dataSync());a.dispose(),t.reassignParamFromPath(r,o)})},e.prototype.dispose=function(t){t===void 0&&(t=!0),this.getParamList().forEach(function(n){if(t&&n.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+n.path);n.tensor.dispose()}),this._params=void 0},e.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(t){var n=t.tensor;return Array.from(n.dataSync())}).reduce(function(t,n){return t.concat(n)}))},e.prototype.load=function(t){return ge(this,void 0,void 0,function(){return xe(this,function(n){switch(n.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return n.sent(),[2]}})})},e.prototype.loadFromUri=function(t){return ge(this,void 0,void 0,function(){var n;return xe(this,function(r){switch(r.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,WF(t,this.getDefaultModelName())];case 1:return n=r.sent(),this.loadFromWeightMap(n),[2]}})})},e.prototype.loadFromDisk=function(t){return ge(this,void 0,void 0,function(){var n,r,a,o,i,s,l,c,d,h;return xe(this,function(f){switch(f.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return n=an.getEnv().readFile,r=CC(t,this.getDefaultModelName()),a=r.manifestUri,o=r.modelBaseUri,i=function(p){return Promise.all(p.map(function(v){return n(v).then(function(g){return g.buffer})}))},s=hC.weightsLoaderFactory(i),d=(c=JSON).parse,[4,n(a)];case 1:return l=d.apply(c,[f.sent().toString()]),[4,s(l,o)];case 2:return h=f.sent(),this.loadFromWeightMap(h),[2]}})})},e.prototype.loadFromWeightMap=function(t){var n=this.extractParamsFromWeigthMap(t),r=n.paramMappings,a=n.params;this._paramMappings=r,this._params=a},e.prototype.extractWeights=function(t){var n=this.extractParams(t),r=n.paramMappings,a=n.params;this._paramMappings=r,this._params=a},e.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var n=t.split("/").reduce(function(o,i){if(!o.nextObj.hasOwnProperty(i))throw new Error("traversePropertyPath - object does not have property "+i+", for path "+t);return{obj:o.nextObj,objProp:i,nextObj:o.nextObj[i]}},{nextObj:this.params}),r=n.obj,a=n.objProp;if(!r||!a||!(r[a]instanceof it))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:r,objProp:a}},e}();function An(e,t,n){return ce(function(){var r=Sm(e,t.depthwise_filter,t.pointwise_filter,n,"same");return r=Be(r,t.bias),r})}function xh(e,t,n){return n===void 0&&(n=!1),ce(function(){var r=st(n?Be(Xn(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):An(e,t.conv0,[2,2])),a=An(r,t.conv1,[1,1]),o=st(Be(r,a)),i=An(o,t.conv2,[1,1]);return st(Be(r,Be(a,i)))})}function tu(e,t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!0),ce(function(){var a=st(n?Be(Xn(e,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):An(e,t.conv0,r?[2,2]:[1,1])),o=An(a,t.conv1,[1,1]),i=st(Be(a,o)),s=An(i,t.conv2,[1,1]),l=st(Be(a,Be(o,s))),c=An(l,t.conv3,[1,1]);return st(Be(a,Be(o,Be(s,c))))})}function or(e,t,n,r){return n===void 0&&(n="same"),r===void 0&&(r=!1),ce(function(){var a=Be(Xn(e,t.filters,[1,1],n),t.bias);return r?st(a):a})}function ua(e,t){Object.keys(e).forEach(function(n){t.some(function(r){return r.originalPath===n})||e[n].dispose()})}function ud(e,t){return function(n,r,a,o){var i=fn(e(n*r*a*a),[a,a,n,r]),s=wt(e(r));return t.push({paramPath:o+"/filters"},{paramPath:o+"/bias"}),{filters:i,bias:s}}}function Hm(e,t){return function(n,r,a){var o=Oa(e(n*r),[n,r]),i=wt(e(r));return t.push({paramPath:a+"/weights"},{paramPath:a+"/bias"}),{weights:o,bias:i}}}var kC=function(){function e(t,n,r){this.depthwise_filter=t,this.pointwise_filter=n,this.bias=r}return e}();function Gm(e,t){return function(n,r,a){var o=fn(e(9*n),[3,3,n,1]),i=fn(e(n*r),[1,1,n,r]),s=wt(e(r));return t.push({paramPath:a+"/depthwise_filter"},{paramPath:a+"/pointwise_filter"},{paramPath:a+"/bias"}),new kC(o,i,s)}}function qm(e){return function(t){var n=e(t+"/depthwise_filter",4),r=e(t+"/pointwise_filter",4),a=e(t+"/bias",1);return new kC(n,r,a)}}function eo(e,t){return function(n,r,a){var o=e[n];if(!od(o,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+o);return t.push({originalPath:n,paramPath:a||n}),o}}function ca(e){var t=e;function n(a){var o=t.slice(0,a);return t=t.slice(a),o}function r(){return t}return{extractWeights:n,getRemainingWeights:r}}function jC(e,t){var n=ud(e,t),r=Gm(e,t);function a(i,s,l,c){c===void 0&&(c=!1);var d=c?n(i,s,3,l+"/conv0"):r(i,s,l+"/conv0"),h=r(s,s,l+"/conv1"),f=r(s,s,l+"/conv2");return{conv0:d,conv1:h,conv2:f}}function o(i,s,l,c){c===void 0&&(c=!1);var d=a(i,s,l,c),h=d.conv0,f=d.conv1,p=d.conv2,v=r(s,s,l+"/conv3");return{conv0:h,conv1:f,conv2:p,conv3:v}}return{extractDenseBlock3Params:a,extractDenseBlock4Params:o}}function VF(e){var t=[],n=ca(e),r=n.extractWeights,a=n.getRemainingWeights,o=jC(r,t).extractDenseBlock4Params,i=o(3,32,"dense0",!0),s=o(32,64,"dense1"),l=o(64,128,"dense2"),c=o(128,256,"dense3");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{dense0:i,dense1:s,dense2:l,dense3:c}}}function SC(e){return function(t){var n=e(t+"/filters",4),r=e(t+"/bias",1);return{filters:n,bias:r}}}function EC(e,t){var n=eo(e,t),r=SC(n),a=qm(n);function o(s,l){l===void 0&&(l=!1);var c=l?r(s+"/conv0"):a(s+"/conv0"),d=a(s+"/conv1"),h=a(s+"/conv2");return{conv0:c,conv1:d,conv2:h}}function i(s,l){l===void 0&&(l=!1);var c=l?r(s+"/conv0"):a(s+"/conv0"),d=a(s+"/conv1"),h=a(s+"/conv2"),f=a(s+"/conv3");return{conv0:c,conv1:d,conv2:h,conv3:f}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:i}}function HF(e){var t=[],n=EC(e,t).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return ua(e,t),{params:r,paramMappings:t}}var _C=function(e){Re(t,e);function t(){return e.call(this,"FaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return ce(function(){var a=n.toBatchTensor(112,!0),o=[122.782,117.001,104.298],i=wl(a,o).div(le(255)),s=tu(i,r.dense0,!0);return s=tu(s,r.dense1),s=tu(s,r.dense2),s=tu(s,r.dense3),s=yl(s,[7,7],[2,2],"valid"),s})},t.prototype.forward=function(n){return ge(this,void 0,void 0,function(){var r;return xe(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,Bt(n)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(n){return HF(n)},t.prototype.extractParams=function(n){return VF(n)},t}(la);function kr(e,t){return ce(function(){return Be(nd(e,t.weights),t.bias)})}function GF(e,t,n){var r=[],a=ca(e),o=a.extractWeights,i=a.getRemainingWeights,s=Hm(o,r),l=s(t,n,"fc");if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:r,params:{fc:l}}}function qF(e){var t=[],n=eo(e,t);function r(o){var i=n(o+"/weights",2),s=n(o+"/bias",1);return{weights:i,bias:s}}var a={fc:r("fc")};return ua(e,t),{params:a,paramMappings:t}}function RC(e){var t={},n={};return Object.keys(e).forEach(function(r){var a=r.startsWith("fc")?n:t;a[r]=e[r]}),{featureExtractorMap:t,classifierMap:n}}var IC=function(e){Re(t,e);function t(n,r){var a=e.call(this,n)||this;return a._faceFeatureExtractor=r,a}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var r=this,a=this.params;if(!a)throw new Error(this._name+" - load model before inference");return ce(function(){var o=n instanceof bc?r.faceFeatureExtractor.forwardInput(n):n;return kr(o.as2D(o.shape[0],-1),a.fc)})},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),a=r.params,o=r.paramMappings;this._params=a,this._paramMappings=o},t.prototype.extractClassifierParams=function(n){return GF(n,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(n){var r=RC(n),a=r.featureExtractorMap,o=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(a),qF(o)},t.prototype.extractParams=function(n){var r=this.getClassifierChannelsIn(),a=this.getClassifierChannelsOut(),o=a*r+a,i=n.slice(0,n.length-o),s=n.slice(n.length-o);return this.faceFeatureExtractor.extractWeights(i),this.extractClassifierParams(s)},t}(la),s1=["neutral","happy","sad","angry","fearful","disgusted","surprised"],KF=function(){function e(t){var n=this;if(t.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);s1.forEach(function(r,a){n[r]=t[a]})}return e.prototype.asSortedArray=function(){var t=this;return s1.map(function(n){return{expression:n,probability:t[n]}}).sort(function(n,r){return r.probability-n.probability})},e}(),XF=function(e){Re(t,e);function t(n){return n===void 0&&(n=new _C),e.call(this,"FaceExpressionNet",n)||this}return t.prototype.forwardInput=function(n){var r=this;return ce(function(){return ia(r.runNet(n))})},t.prototype.forward=function(n){return ge(this,void 0,void 0,function(){var r;return xe(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,Bt(n)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.predictExpressions=function(n){return ge(this,void 0,void 0,function(){var r,a,o,i,s=this;return xe(this,function(l){switch(l.label){case 0:return[4,Bt(n)];case 1:return r=l.sent(),[4,this.forwardInput(r)];case 2:return a=l.sent(),[4,Promise.all(Rt(a).map(function(c){return ge(s,void 0,void 0,function(){var d;return xe(this,function(h){switch(h.label){case 0:return[4,c.data()];case 1:return d=h.sent(),c.dispose(),[2,d]}})})}))];case 3:return o=l.sent(),a.dispose(),i=o.map(function(c){return new KF(c)}),[2,r.isBatchInput?i:i[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(IC);function AC(e,t){var n={expressions:t};return Object.assign({},e,n)}function YF(e){return FF(e)&&e.landmarks instanceof yc&&e.unshiftedLandmarks instanceof yc&&e.alignedRect instanceof Mr}function Km(e,t){var n=e.detection.box,r=t.shiftBy(n.x,n.y),a=r.align(),o=e.detection.imageDims,i=new Mr(e.detection.score,a.rescale(o.reverse()),o),s={landmarks:r,unshiftedLandmarks:t,alignedRect:i};return Object.assign({},e,s)}function QF(e,t){var n=ud(e,t),r=Gm(e,t);function a(i,s,l){var c=r(i,s,l+"/separable_conv0"),d=r(s,s,l+"/separable_conv1"),h=n(i,s,1,l+"/expansion_conv");return{separable_conv0:c,separable_conv1:d,expansion_conv:h}}function o(i,s){var l=r(i,i,s+"/separable_conv0"),c=r(i,i,s+"/separable_conv1"),d=r(i,i,s+"/separable_conv2");return{separable_conv0:l,separable_conv1:c,separable_conv2:d}}return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:a,extractMainBlockParams:o}}function JF(e,t){var n=[],r=ca(e),a=r.extractWeights,o=r.getRemainingWeights,i=QF(a,n),s=i.extractConvParams,l=i.extractSeparableConvParams,c=i.extractReductionBlockParams,d=i.extractMainBlockParams,h=s(3,32,3,"entry_flow/conv_in"),f=c(32,64,"entry_flow/reduction_block_0"),p=c(64,128,"entry_flow/reduction_block_1"),v={conv_in:h,reduction_block_0:f,reduction_block_1:p},g={};el(t,0,1).forEach(function(b){g["main_block_"+b]=d(128,"middle_flow/main_block_"+b)});var y=c(128,256,"exit_flow/reduction_block"),m=l(256,512,"exit_flow/separable_conv"),x={reduction_block:y,separable_conv:m};if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:n,params:{entry_flow:v,middle_flow:g,exit_flow:x}}}function ZF(e,t){var n=eo(e,t),r=SC(n),a=qm(n);function o(s){var l=a(s+"/separable_conv0"),c=a(s+"/separable_conv1"),d=r(s+"/expansion_conv");return{separable_conv0:l,separable_conv1:c,expansion_conv:d}}function i(s){var l=a(s+"/separable_conv0"),c=a(s+"/separable_conv1"),d=a(s+"/separable_conv2");return{separable_conv0:l,separable_conv1:c,separable_conv2:d}}return{extractConvParams:r,extractSeparableConvParams:a,extractReductionBlockParams:o,extractMainBlockParams:i}}function eM(e,t){var n=[],r=ZF(e,n),a=r.extractConvParams,o=r.extractSeparableConvParams,i=r.extractReductionBlockParams,s=r.extractMainBlockParams,l=a("entry_flow/conv_in"),c=i("entry_flow/reduction_block_0"),d=i("entry_flow/reduction_block_1"),h={conv_in:l,reduction_block_0:c,reduction_block_1:d},f={};el(t,0,1).forEach(function(y){f["main_block_"+y]=s("middle_flow/main_block_"+y)});var p=i("exit_flow/reduction_block"),v=o("exit_flow/separable_conv"),g={reduction_block:p,separable_conv:v};return ua(e,n),{params:{entry_flow:h,middle_flow:f,exit_flow:g},paramMappings:n}}function DC(e,t,n){return Be(Xn(e,t.filters,n,"same"),t.bias)}function yh(e,t,n){n===void 0&&(n=!0);var r=n?st(e):e;return r=An(r,t.separable_conv0,[1,1]),r=An(st(r),t.separable_conv1,[1,1]),r=Pt(r,[3,3],[2,2],"same"),r=Be(r,DC(e,t.expansion_conv,[2,2])),r}function tM(e,t){var n=An(st(e),t.separable_conv0,[1,1]);return n=An(st(n),t.separable_conv1,[1,1]),n=An(st(n),t.separable_conv2,[1,1]),n=Be(n,e),n}var nM=function(e){Re(t,e);function t(n){var r=e.call(this,"TinyXception")||this;return r._numMainBlocks=n,r}return t.prototype.forwardInput=function(n){var r=this,a=this.params;if(!a)throw new Error("TinyXception - load model before inference");return ce(function(){var o=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],s=wl(o,i).div(le(256)),l=st(DC(s,a.entry_flow.conv_in,[2,2]));return l=yh(l,a.entry_flow.reduction_block_0,!1),l=yh(l,a.entry_flow.reduction_block_1),el(r._numMainBlocks,0,1).forEach(function(c){l=tM(l,a.middle_flow["main_block_"+c])}),l=yh(l,a.exit_flow.reduction_block),l=st(An(l,a.exit_flow.separable_conv,[1,1])),l})},t.prototype.forward=function(n){return ge(this,void 0,void 0,function(){var r;return xe(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,Bt(n)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(n){return eM(n,this._numMainBlocks)},t.prototype.extractParams=function(n){return JF(n,this._numMainBlocks)},t}(la);function rM(e){var t=[],n=ca(e),r=n.extractWeights,a=n.getRemainingWeights,o=Hm(r,t),i=o(512,1,"fc/age"),s=o(512,2,"fc/gender");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{fc:{age:i,gender:s}}}}function aM(e){var t=[],n=eo(e,t);function r(o){var i=n(o+"/weights",2),s=n(o+"/bias",1);return{weights:i,bias:s}}var a={fc:{age:r("fc/age"),gender:r("fc/gender")}};return ua(e,t),{params:a,paramMappings:t}}var wc;(function(e){e.FEMALE="female",e.MALE="male"})(wc||(wc={}));var oM=function(e){Re(t,e);function t(n){n===void 0&&(n=new nM(2));var r=e.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=n,r}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var r=this,a=this.params;if(!a)throw new Error(this._name+" - load model before inference");return ce(function(){var o=n instanceof bc?r.faceFeatureExtractor.forwardInput(n):n,i=yl(o,[7,7],[2,2],"valid").as2D(o.shape[0],-1),s=kr(i,a.fc.age).as1D(),l=kr(i,a.fc.gender);return{age:s,gender:l}})},t.prototype.forwardInput=function(n){var r=this;return ce(function(){var a=r.runNet(n),o=a.age,i=a.gender;return{age:o,gender:ia(i)}})},t.prototype.forward=function(n){return ge(this,void 0,void 0,function(){var r;return xe(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,Bt(n)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.predictAgeAndGender=function(n){return ge(this,void 0,void 0,function(){var r,a,o,i,s,l,c=this;return xe(this,function(d){switch(d.label){case 0:return[4,Bt(n)];case 1:return r=d.sent(),[4,this.forwardInput(r)];case 2:return a=d.sent(),o=Rt(a.age),i=Rt(a.gender),s=o.map(function(h,f){return{ageTensor:h,genderTensor:i[f]}}),[4,Promise.all(s.map(function(h){var f=h.ageTensor,p=h.genderTensor;return ge(c,void 0,void 0,function(){var v,g,y,m,x;return xe(this,function(b){switch(b.label){case 0:return[4,f.data()];case 1:return v=b.sent()[0],[4,p.data()];case 2:return g=b.sent()[0],y=g>.5,m=y?wc.MALE:wc.FEMALE,x=y?g:1-g,f.dispose(),p.dispose(),[2,{age:v,gender:m,genderProbability:x}]}})})}))];case 3:return l=d.sent(),a.age.dispose(),a.gender.dispose(),[2,r.isBatchInput?l:l[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),a=r.params,o=r.paramMappings;this._params=a,this._paramMappings=o},t.prototype.extractClassifierParams=function(n){return rM(n)},t.prototype.extractParamsFromWeigthMap=function(n){var r=RC(n),a=r.featureExtractorMap,o=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(a),aM(o)},t.prototype.extractParams=function(n){var r=1539,a=n.slice(0,n.length-r),o=n.slice(n.length-r);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(o)},t}(la),TC=function(e){Re(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.postProcess=function(n,r,a){var o=a.map(function(s){var l=s.width,c=s.height,d=r/Math.max(c,l);return{width:l*d,height:c*d}}),i=o.length;return ce(function(){var s=function(f,p){return Pn([Rr([68],f),Rr([68],p)],1).as2D(1,136).as1D()},l=function(f,p){var v=o[f],g=v.width,y=v.height;return p(g,y)?Math.abs(g-y)/2:0},c=function(f){return l(f,function(p,v){return p<v})},d=function(f){return l(f,function(p,v){return v<p})},h=n.mul(Rr([i,136],r)).sub(Pn(Array.from(Array(i),function(f,p){return s(c(p),d(p))}))).div(Pn(Array.from(Array(i),function(f,p){return s(o[p].width,o[p].height)})));return h})},t.prototype.forwardInput=function(n){var r=this;return ce(function(){var a=r.runNet(n);return r.postProcess(a,n.inputSize,n.inputDimensions.map(function(o){var i=o[0],s=o[1];return{height:i,width:s}}))})},t.prototype.forward=function(n){return ge(this,void 0,void 0,function(){var r;return xe(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,Bt(n)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.detectLandmarks=function(n){return ge(this,void 0,void 0,function(){var r,a,o,i=this;return xe(this,function(s){switch(s.label){case 0:return[4,Bt(n)];case 1:return r=s.sent(),a=ce(function(){return Rt(i.forwardInput(r))}),[4,Promise.all(a.map(function(l,c){return ge(i,void 0,void 0,function(){var d,h,f,p,v;return xe(this,function(g){switch(g.label){case 0:return f=(h=Array).from,[4,l.data()];case 1:return d=f.apply(h,[g.sent()]),p=d.filter(function(y,m){return e1(m)}),v=d.filter(function(y,m){return!e1(m)}),[2,new PF(Array(68).fill(0).map(function(y,m){return new He(p[m],v[m])}),{height:r.getInputHeight(c),width:r.getInputWidth(c)})]}})})}))];case 2:return o=s.sent(),a.forEach(function(l){return l.dispose()}),[2,r.isBatchInput?o:o[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t}(IC),PC=function(e){Re(t,e);function t(n){return n===void 0&&(n=new _C),e.call(this,"FaceLandmark68Net",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(TC);function iM(e){var t=[],n=EC(e,t).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return ua(e,t),{params:r,paramMappings:t}}function sM(e){var t=[],n=ca(e),r=n.extractWeights,a=n.getRemainingWeights,o=jC(r,t).extractDenseBlock3Params,i=o(3,32,"dense0",!0),s=o(32,64,"dense1"),l=o(64,128,"dense2");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{dense0:i,dense1:s,dense2:l}}}var lM=function(e){Re(t,e);function t(){return e.call(this,"TinyFaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return ce(function(){var a=n.toBatchTensor(112,!0),o=[122.782,117.001,104.298],i=wl(a,o).div(le(255)),s=xh(i,r.dense0,!0);return s=xh(s,r.dense1),s=xh(s,r.dense2),s=yl(s,[14,14],[2,2],"valid"),s})},t.prototype.forward=function(n){return ge(this,void 0,void 0,function(){var r;return xe(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,Bt(n)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(n){return iM(n)},t.prototype.extractParams=function(n){return sM(n)},t}(la),uM=function(e){Re(t,e);function t(n){return n===void 0&&(n=new lM),e.call(this,"FaceLandmark68TinyNet",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(TC);(function(e){Re(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(PC);function cM(e,t){return Be(nn(e,t.weights),t.biases)}function Xm(e,t,n,r,a){a===void 0&&(a="same");var o=t.conv,i=o.filters,s=o.bias,l=Xn(e,i,n,a);return l=Be(l,s),l=cM(l,t.scale),r?st(l):l}function dM(e,t){return Xm(e,t,[1,1],!0)}function FC(e,t){return Xm(e,t,[1,1],!1)}function MC(e,t){return Xm(e,t,[2,2],!0,"valid")}function hM(e,t){function n(s,l,c){var d=e(s),h=d.length/(l*c*c);if(kF(h))throw new Error("depth has to be an integer: "+h+", weights.length: "+d.length+", numFilters: "+l+", filterSize: "+c);return ce(function(){return Wa(fn(d,[l,h,c,c]),[2,3,1,0])})}function r(s,l,c,d){var h=n(s,l,c),f=wt(e(l));return t.push({paramPath:d+"/filters"},{paramPath:d+"/bias"}),{filters:h,bias:f}}function a(s,l){var c=wt(e(s)),d=wt(e(s));return t.push({paramPath:l+"/weights"},{paramPath:l+"/biases"}),{weights:c,biases:d}}function o(s,l,c,d){var h=r(s,l,c,d+"/conv"),f=a(l,d+"/scale");return{conv:h,scale:f}}function i(s,l,c,d,h){h===void 0&&(h=!1);var f=o((h?.5:1)*s,l,c,d+"/conv1"),p=o(s,l,c,d+"/conv2");return{conv1:f,conv2:p}}return{extractConvLayerParams:o,extractResidualLayerParams:i}}function fM(e){var t=ca(e),n=t.extractWeights,r=t.getRemainingWeights,a=[],o=hM(n,a),i=o.extractConvLayerParams,s=o.extractResidualLayerParams,l=i(4704,32,7,"conv32_down"),c=s(9216,32,3,"conv32_1"),d=s(9216,32,3,"conv32_2"),h=s(9216,32,3,"conv32_3"),f=s(36864,64,3,"conv64_down",!0),p=s(36864,64,3,"conv64_1"),v=s(36864,64,3,"conv64_2"),g=s(36864,64,3,"conv64_3"),y=s(147456,128,3,"conv128_down",!0),m=s(147456,128,3,"conv128_1"),x=s(147456,128,3,"conv128_2"),b=s(589824,256,3,"conv256_down",!0),w=s(589824,256,3,"conv256_1"),N=s(589824,256,3,"conv256_2"),C=s(589824,256,3,"conv256_down_out"),S=ce(function(){return Wa(Oa(n(256*128),[128,256]),[1,0])});if(a.push({paramPath:"fc"}),r().length!==0)throw new Error("weights remaing after extract: "+r().length);var k={conv32_down:l,conv32_1:c,conv32_2:d,conv32_3:h,conv64_down:f,conv64_1:p,conv64_2:v,conv64_3:g,conv128_down:y,conv128_1:m,conv128_2:x,conv256_down:b,conv256_1:w,conv256_2:N,conv256_down_out:C,fc:S};return{params:k,paramMappings:a}}function pM(e,t){var n=eo(e,t);function r(i){var s=n(i+"/scale/weights",1),l=n(i+"/scale/biases",1);return{weights:s,biases:l}}function a(i){var s=n(i+"/conv/filters",4),l=n(i+"/conv/bias",1),c=r(i);return{conv:{filters:s,bias:l},scale:c}}function o(i){return{conv1:a(i+"/conv1"),conv2:a(i+"/conv2")}}return{extractConvLayerParams:a,extractResidualLayerParams:o}}function mM(e){var t=[],n=pM(e,t),r=n.extractConvLayerParams,a=n.extractResidualLayerParams,o=r("conv32_down"),i=a("conv32_1"),s=a("conv32_2"),l=a("conv32_3"),c=a("conv64_down"),d=a("conv64_1"),h=a("conv64_2"),f=a("conv64_3"),p=a("conv128_down"),v=a("conv128_1"),g=a("conv128_2"),y=a("conv256_down"),m=a("conv256_1"),x=a("conv256_2"),b=a("conv256_down_out"),w=e.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!CF(w))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+w);var N={conv32_down:o,conv32_1:i,conv32_2:s,conv32_3:l,conv64_down:c,conv64_1:d,conv64_2:h,conv64_3:f,conv128_down:p,conv128_1:v,conv128_2:g,conv256_down:y,conv256_1:m,conv256_2:x,conv256_down_out:b,fc:w};return ua(e,t),{params:N,paramMappings:t}}function mr(e,t){var n=dM(e,t.conv1);return n=FC(n,t.conv2),n=Be(n,e),n=st(n),n}function nu(e,t){var n=MC(e,t.conv1);n=FC(n,t.conv2);var r=yl(e,2,2,"valid"),a=et(r.shape),o=r.shape[3]!==n.shape[3],i=r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2];if(i){var s=_s(n.shape);s[1]=1;var l=et(s);n=_t([n,l],1);var c=_s(n.shape);c[2]=1;var d=et(c);n=_t([n,d],2)}return r=o?_t([r,a],3):r,n=Be(r,n),n=st(n),n}var vM=function(e){Re(t,e);function t(){return e.call(this,"FaceRecognitionNet")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return ce(function(){var a=n.toBatchTensor(150,!0).toFloat(),o=[122.782,117.001,104.298],i=wl(a,o).div(le(256)),s=MC(i,r.conv32_down);s=Pt(s,3,2,"valid"),s=mr(s,r.conv32_1),s=mr(s,r.conv32_2),s=mr(s,r.conv32_3),s=nu(s,r.conv64_down),s=mr(s,r.conv64_1),s=mr(s,r.conv64_2),s=mr(s,r.conv64_3),s=nu(s,r.conv128_down),s=mr(s,r.conv128_1),s=mr(s,r.conv128_2),s=nu(s,r.conv256_down),s=mr(s,r.conv256_1),s=mr(s,r.conv256_2),s=nu(s,r.conv256_down_out);var l=s.mean([1,2]),c=nd(l,r.fc);return c})},t.prototype.forward=function(n){return ge(this,void 0,void 0,function(){var r;return xe(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,Bt(n)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.computeFaceDescriptor=function(n){return ge(this,void 0,void 0,function(){var r,a,o,i=this;return xe(this,function(s){switch(s.label){case 0:return[4,Bt(n)];case 1:return r=s.sent(),a=ce(function(){return Rt(i.forwardInput(r))}),[4,Promise.all(a.map(function(l){return l.data()}))];case 2:return o=s.sent(),a.forEach(function(l){return l.dispose()}),[2,r.isBatchInput?o:o[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(n){return mM(n)},t.prototype.extractParams=function(n){return fM(n)},t}(la);function OC(e,t){var n={descriptor:t};return Object.assign({},e,n)}function LC(e,t){var n={age:t};return Object.assign({},e,n)}function BC(e,t,n){var r={gender:t,genderProbability:n};return Object.assign({},e,r)}var zC=function(){function e(t){var n=t===void 0?{}:t,r=n.minFaceSize,a=n.scaleFactor,o=n.maxNumScales,i=n.scoreThresholds,s=n.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=a||.709,this._maxNumScales=o||10,this._scoreThresholds=i||[.6,.7,.7],this._scaleSteps=s,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(l){return typeof l!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(l){return typeof l!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(e.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),e}();function gM(e,t){function n(l,c){var d=fn(e(9*l),[3,3,l,1]),h=wt(e(l)),f=wt(e(l)),p=wt(e(l)),v=wt(e(l));return t.push({paramPath:c+"/filters"},{paramPath:c+"/batch_norm_scale"},{paramPath:c+"/batch_norm_offset"},{paramPath:c+"/batch_norm_mean"},{paramPath:c+"/batch_norm_variance"}),{filters:d,batch_norm_scale:h,batch_norm_offset:f,batch_norm_mean:p,batch_norm_variance:v}}function r(l,c,d,h,f){var p=fn(e(l*c*d*d),[d,d,l,c]),v=wt(e(c));return t.push({paramPath:h+"/filters"},{paramPath:h+"/"+(f?"batch_norm_offset":"bias")}),{filters:p,bias:v}}function a(l,c,d,h){var f=r(l,c,d,h,!0),p=f.filters,v=f.bias;return{filters:p,batch_norm_offset:v}}function o(l,c,d){var h=n(l,d+"/depthwise_conv"),f=a(l,c,1,d+"/pointwise_conv");return{depthwise_conv:h,pointwise_conv:f}}function i(){var l=a(3,32,3,"mobilenetv1/conv_0"),c=o(32,64,"mobilenetv1/conv_1"),d=o(64,128,"mobilenetv1/conv_2"),h=o(128,128,"mobilenetv1/conv_3"),f=o(128,256,"mobilenetv1/conv_4"),p=o(256,256,"mobilenetv1/conv_5"),v=o(256,512,"mobilenetv1/conv_6"),g=o(512,512,"mobilenetv1/conv_7"),y=o(512,512,"mobilenetv1/conv_8"),m=o(512,512,"mobilenetv1/conv_9"),x=o(512,512,"mobilenetv1/conv_10"),b=o(512,512,"mobilenetv1/conv_11"),w=o(512,1024,"mobilenetv1/conv_12"),N=o(1024,1024,"mobilenetv1/conv_13");return{conv_0:l,conv_1:c,conv_2:d,conv_3:h,conv_4:f,conv_5:p,conv_6:v,conv_7:g,conv_8:y,conv_9:m,conv_10:x,conv_11:b,conv_12:w,conv_13:N}}function s(){var l=a(1024,256,1,"prediction_layer/conv_0"),c=a(256,512,3,"prediction_layer/conv_1"),d=a(512,128,1,"prediction_layer/conv_2"),h=a(128,256,3,"prediction_layer/conv_3"),f=a(256,128,1,"prediction_layer/conv_4"),p=a(128,256,3,"prediction_layer/conv_5"),v=a(256,64,1,"prediction_layer/conv_6"),g=a(64,128,3,"prediction_layer/conv_7"),y=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),m=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),x=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),b=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),w=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),N=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),C=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),S=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),k=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),_=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),E=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),j=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),T={box_encoding_predictor:y,class_predictor:m},L={box_encoding_predictor:x,class_predictor:b},P={box_encoding_predictor:w,class_predictor:N},B={box_encoding_predictor:C,class_predictor:S},K={box_encoding_predictor:k,class_predictor:_},z={box_encoding_predictor:E,class_predictor:j};return{conv_0:l,conv_1:c,conv_2:d,conv_3:h,conv_4:f,conv_5:p,conv_6:v,conv_7:g,box_predictor_0:T,box_predictor_1:L,box_predictor_2:P,box_predictor_3:B,box_predictor_4:K,box_predictor_5:z}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:s}}function xM(e){var t=[],n=ca(e),r=n.extractWeights,a=n.getRemainingWeights,o=gM(r,t),i=o.extractMobilenetV1Params,s=o.extractPredictionLayerParams,l=i(),c=s(),d=dm(r(5118*4),[1,5118,4]),h={extra_dim:d};if(t.push({paramPath:"output_layer/extra_dim"}),a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{params:{mobilenetv1:l,prediction_layer:c,output_layer:h},paramMappings:t}}function yM(e,t){var n=eo(e,t);function r(c,d,h){var f=n(c+"/Conv2d_"+d+"_pointwise/weights",4,h+"/filters"),p=n(c+"/Conv2d_"+d+"_pointwise/convolution_bn_offset",1,h+"/batch_norm_offset");return{filters:f,batch_norm_offset:p}}function a(c){var d="mobilenetv1/conv_"+c,h="MobilenetV1/Conv2d_"+c+"_depthwise",f=d+"/depthwise_conv",p=d+"/pointwise_conv",v=n(h+"/depthwise_weights",4,f+"/filters"),g=n(h+"/BatchNorm/gamma",1,f+"/batch_norm_scale"),y=n(h+"/BatchNorm/beta",1,f+"/batch_norm_offset"),m=n(h+"/BatchNorm/moving_mean",1,f+"/batch_norm_mean"),x=n(h+"/BatchNorm/moving_variance",1,f+"/batch_norm_variance");return{depthwise_conv:{filters:v,batch_norm_scale:g,batch_norm_offset:y,batch_norm_mean:m,batch_norm_variance:x},pointwise_conv:r("MobilenetV1",c,p)}}function o(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:a(1),conv_2:a(2),conv_3:a(3),conv_4:a(4),conv_5:a(5),conv_6:a(6),conv_7:a(7),conv_8:a(8),conv_9:a(9),conv_10:a(10),conv_11:a(11),conv_12:a(12),conv_13:a(13)}}function i(c,d){var h=n(c+"/weights",4,d+"/filters"),f=n(c+"/biases",1,d+"/bias");return{filters:h,bias:f}}function s(c){var d=i("Prediction/BoxPredictor_"+c+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+c+"/box_encoding_predictor"),h=i("Prediction/BoxPredictor_"+c+"/ClassPredictor","prediction_layer/box_predictor_"+c+"/class_predictor");return{box_encoding_predictor:d,class_predictor:h}}function l(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:s(0),box_predictor_1:s(1),box_predictor_2:s(2),box_predictor_3:s(3),box_predictor_4:s(4),box_predictor_5:s(5)}}return{extractMobilenetV1Params:o,extractPredictionLayerParams:l}}function bM(e){var t=[],n=yM(e,t),r=n.extractMobilenetV1Params,a=n.extractPredictionLayerParams,o=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!id(o))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+o);var i={mobilenetv1:r(),prediction_layer:a(),output_layer:{extra_dim:o}};return ua(e,t),{params:i,paramMappings:t}}function gr(e,t,n){return ce(function(){var r=Xn(e,t.filters,n,"same");return r=Be(r,t.batch_norm_offset),Nm(r,0,6)})}var wM=.0010000000474974513;function NM(e,t,n){return ce(function(){var r=td(e,t.filters,n,"same");return r=PN(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,wM),Nm(r,0,6)})}function CM(e){return[2,4,6,12].some(function(t){return t===e})?[2,2]:[1,1]}function kM(e,t){return ce(function(){var n=null,r=gr(e,t.conv_0,[2,2]),a=[t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13];if(a.forEach(function(o,i){var s=i+1,l=CM(s);r=NM(r,o.depthwise_conv,l),r=gr(r,o.pointwise_conv,[1,1]),s===11&&(n=r)}),n===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}})}function jM(e,t,n,r,a){var o=e.shape[0],i=Math.min(n,o),s=t.map(function(d,h){return{score:d,boxIndex:h}}).filter(function(d){return d.score>a}).sort(function(d,h){return h.score-d.score}),l=function(d){return d<=r?1:0},c=[];return s.forEach(function(d){if(!(c.length>=i)){for(var h=d.score,f=c.length-1;f>=0;--f){var p=SM(e,d.boxIndex,c[f]);if(p!==0&&(d.score*=l(p),d.score<=a))break}h===d.score&&c.push(d.boxIndex)}}),c}function SM(e,t,n){var r=e.arraySync(),a=Math.min(r[t][0],r[t][2]),o=Math.min(r[t][1],r[t][3]),i=Math.max(r[t][0],r[t][2]),s=Math.max(r[t][1],r[t][3]),l=Math.min(r[n][0],r[n][2]),c=Math.min(r[n][1],r[n][3]),d=Math.max(r[n][0],r[n][2]),h=Math.max(r[n][1],r[n][3]),f=(i-a)*(s-o),p=(d-l)*(h-c);if(f<=0||p<=0)return 0;var v=Math.max(a,l),g=Math.max(o,c),y=Math.min(i,d),m=Math.min(s,h),x=Math.max(y-v,0)*Math.max(m-g,0);return x/(f+p-x)}function EM(e){var t=Rt(Wa(e,[1,0])),n=[At(t[2],t[0]),At(t[3],t[1])],r=[Be(t[0],tr(n[0],le(2))),Be(t[1],tr(n[1],le(2)))];return{sizes:n,centers:r}}function _M(e,t){var n=EM(e),r=n.sizes,a=n.centers,o=Rt(Wa(t,[1,0])),i=tr(nn(zf(tr(o[2],le(5))),r[0]),le(2)),s=Be(nn(tr(o[0],le(10)),r[0]),a[0]),l=tr(nn(zf(tr(o[3],le(5))),r[1]),le(2)),c=Be(nn(tr(o[1],le(10)),r[1]),a[1]);return Wa(Pn([At(s,i),At(c,l),Be(s,i),Be(c,l)]),[1,0])}function RM(e,t,n){return ce(function(){var r=e.shape[0],a=_M(nr(vi(n.extra_dim,[r,1,1]),[-1,4]),nr(e,[-1,4]));a=nr(a,[r,a.shape[0]/r,4]);var o=IN(Dr(t,[0,0,1],[-1,-1,-1])),i=Dr(o,[0,0,0],[-1,-1,1]);i=nr(i,[r,i.shape[1]]);var s=Rt(a),l=Rt(i);return{boxes:s,scores:l}})}function Vo(e,t){return ce(function(){var n=e.shape[0],r=nr(or(e,t.box_encoding_predictor),[n,-1,1,4]),a=nr(or(e,t.class_predictor),[n,-1,3]);return{boxPredictionEncoding:r,classPrediction:a}})}function IM(e,t,n){return ce(function(){var r=gr(e,n.conv_0,[1,1]),a=gr(r,n.conv_1,[2,2]),o=gr(a,n.conv_2,[1,1]),i=gr(o,n.conv_3,[2,2]),s=gr(i,n.conv_4,[1,1]),l=gr(s,n.conv_5,[2,2]),c=gr(l,n.conv_6,[1,1]),d=gr(c,n.conv_7,[2,2]),h=Vo(t,n.box_predictor_0),f=Vo(e,n.box_predictor_1),p=Vo(a,n.box_predictor_2),v=Vo(i,n.box_predictor_3),g=Vo(l,n.box_predictor_4),y=Vo(d,n.box_predictor_5),m=_t([h.boxPredictionEncoding,f.boxPredictionEncoding,p.boxPredictionEncoding,v.boxPredictionEncoding,g.boxPredictionEncoding,y.boxPredictionEncoding],1),x=_t([h.classPrediction,f.classPrediction,p.classPrediction,v.classPrediction,g.classPrediction,y.classPrediction],1);return{boxPredictions:m,classPredictions:x}})}var cd=function(){function e(t){var n=t===void 0?{}:t,r=n.minConfidence,a=n.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=a||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(e.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),e}(),$C=function(e){Re(t,e);function t(){return e.call(this,"SsdMobilenetv1")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return ce(function(){var a=n.toBatchTensor(512,!1).toFloat(),o=At(nn(a,le(.007843137718737125)),le(1)),i=kM(o,r.mobilenetv1),s=IM(i.out,i.conv11,r.prediction_layer),l=s.boxPredictions,c=s.classPredictions;return RM(l,c,r.output_layer)})},t.prototype.forward=function(n){return ge(this,void 0,void 0,function(){var r;return xe(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,Bt(n)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.locateFaces=function(n,r){return r===void 0&&(r={}),ge(this,void 0,void 0,function(){var a,o,i,s,l,c,d,h,f,p,v,g,y,m,x,b,w,N,C,S,k;return xe(this,function(_){switch(_.label){case 0:return a=new cd(r),o=a.maxResults,i=a.minConfidence,[4,Bt(n)];case 1:for(s=_.sent(),l=this.forwardInput(s),c=l.boxes,d=l.scores,h=c[0],f=d[0],p=1;p<c.length;p++)c[p].dispose(),d[p].dispose();return y=(g=Array).from,[4,f.data()];case 2:return v=y.apply(g,[_.sent()]),m=.5,x=jM(h,v,o,m,i),b=s.getReshapedInputDimensions(0),w=s.inputSize,N=w/b.width,C=w/b.height,S=h.arraySync(),k=x.map(function(E){var j=[Math.max(0,S[E][0]),Math.min(1,S[E][2])].map(function(z){return z*C}),T=j[0],L=j[1],P=[Math.max(0,S[E][1]),Math.min(1,S[E][3])].map(function(z){return z*N}),B=P[0],K=P[1];return new Mr(v[E],new Bm(B,T,K-B,L-T),{height:s.getInputHeight(0),width:s.getInputWidth(0)})}),h.dispose(),f.dispose(),[2,k]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(n){return bM(n)},t.prototype.extractParams=function(n){return xM(n)},t}(la);(function(e){Re(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})($C);var AM=.4,DM=[new He(.738768,.874946),new He(2.42204,2.65704),new He(4.30971,7.04493),new He(10.246,4.59428),new He(12.6868,11.8741)],TM=[new He(1.603231,2.094468),new He(6.041143,7.080126),new He(2.882459,3.518061),new He(4.266906,5.178857),new He(9.041765,10.66308)],PM=[117.001,114.697,97.404],FM="tiny_yolov2_model",MM="tiny_yolov2_separable_conv_model",ru=function(e){return typeof e=="number"};function OM(e){if(!e)throw new Error("invalid config: "+e);if(typeof e.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+e.withSeparableConvs);if(!ru(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+e.iouThreshold);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(function(t){return typeof t=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(e.classes));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(function(t){return t||{}}).every(function(t){return ru(t.x)&&ru(t.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(e.anchors));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||e.meanRgb.length!==3||!e.meanRgb.every(ru)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(e.meanRgb))}function Ym(e){return ce(function(){var t=nn(e,le(.10000000149011612));return Be(st(At(e,t)),t)})}function pa(e,t){return ce(function(){var n=Po(e,[[0,0],[1,1],[1,1],[0,0]]);return n=Xn(n,t.conv.filters,[1,1],"valid"),n=At(n,t.bn.sub),n=nn(n,t.bn.truediv),n=Be(n,t.conv.bias),Ym(n)})}function ma(e,t){return ce(function(){var n=Po(e,[[0,0],[1,1],[1,1],[0,0]]);return n=Sm(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),n=Be(n,t.bias),Ym(n)})}function LM(e,t){var n=ud(e,t);function r(i,s){var l=wt(e(i)),c=wt(e(i));return t.push({paramPath:s+"/sub"},{paramPath:s+"/truediv"}),{sub:l,truediv:c}}function a(i,s,l){var c=n(i,s,3,l+"/conv"),d=r(s,l+"/bn");return{conv:c,bn:d}}var o=Gm(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:a,extractSeparableConvParams:o}}function BM(e,t,n,r){var a=ca(e),o=a.extractWeights,i=a.getRemainingWeights,s=[],l=LM(o,s),c=l.extractConvParams,d=l.extractConvWithBatchNormParams,h=l.extractSeparableConvParams,f;if(t.withSeparableConvs){var p=r[0],v=r[1],g=r[2],y=r[3],m=r[4],x=r[5],b=r[6],w=r[7],N=r[8],C=t.isFirstLayerConv2d?c(p,v,3,"conv0"):h(p,v,"conv0"),S=h(v,g,"conv1"),k=h(g,y,"conv2"),_=h(y,m,"conv3"),E=h(m,x,"conv4"),j=h(x,b,"conv5"),T=w?h(b,w,"conv6"):void 0,L=N?h(w,N,"conv7"):void 0,P=c(N||w||b,5*n,1,"conv8");f={conv0:C,conv1:S,conv2:k,conv3:_,conv4:E,conv5:j,conv6:T,conv7:L,conv8:P}}else{var p=r[0],v=r[1],g=r[2],y=r[3],m=r[4],x=r[5],b=r[6],w=r[7],N=r[8],C=d(p,v,"conv0"),S=d(v,g,"conv1"),k=d(g,y,"conv2"),_=d(y,m,"conv3"),E=d(m,x,"conv4"),j=d(x,b,"conv5"),T=d(b,w,"conv6"),L=d(w,N,"conv7"),P=c(N,5*n,1,"conv8");f={conv0:C,conv1:S,conv2:k,conv3:_,conv4:E,conv5:j,conv6:T,conv7:L,conv8:P}}if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{params:f,paramMappings:s}}function zM(e,t){var n=eo(e,t);function r(s){var l=n(s+"/sub",1),c=n(s+"/truediv",1);return{sub:l,truediv:c}}function a(s){var l=n(s+"/filters",4),c=n(s+"/bias",1);return{filters:l,bias:c}}function o(s){var l=a(s+"/conv"),c=r(s+"/bn");return{conv:l,bn:c}}var i=qm(n);return{extractConvParams:a,extractConvWithBatchNormParams:o,extractSeparableConvParams:i}}function $M(e,t){var n=[],r=zM(e,n),a=r.extractConvParams,o=r.extractConvWithBatchNormParams,i=r.extractSeparableConvParams,s;if(t.withSeparableConvs){var l=t.filterSizes&&t.filterSizes.length||9;s={conv0:t.isFirstLayerConv2d?a("conv0"):i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:l>7?i("conv6"):void 0,conv7:l>8?i("conv7"):void 0,conv8:a("conv8")}}else s={conv0:o("conv0"),conv1:o("conv1"),conv2:o("conv2"),conv3:o("conv3"),conv4:o("conv4"),conv5:o("conv5"),conv6:o("conv6"),conv7:o("conv7"),conv8:a("conv8")};return ua(e,n),{params:s,paramMappings:n}}var l1;(function(e){e[e.XS=224]="XS",e[e.SM=320]="SM",e[e.MD=416]="MD",e[e.LG=608]="LG"})(l1||(l1={}));var Qm=function(){function e(t){var n=t===void 0?{}:t,r=n.inputSize,a=n.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=a||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),e}(),UC=function(e){Re(t,e);function t(n){var r=e.call(this,"TinyYolov2")||this;return OM(n),r._config=n,r}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(n,r){var a=pa(n,r.conv0);return a=Pt(a,[2,2],[2,2],"same"),a=pa(a,r.conv1),a=Pt(a,[2,2],[2,2],"same"),a=pa(a,r.conv2),a=Pt(a,[2,2],[2,2],"same"),a=pa(a,r.conv3),a=Pt(a,[2,2],[2,2],"same"),a=pa(a,r.conv4),a=Pt(a,[2,2],[2,2],"same"),a=pa(a,r.conv5),a=Pt(a,[2,2],[1,1],"same"),a=pa(a,r.conv6),a=pa(a,r.conv7),or(a,r.conv8,"valid",!1)},t.prototype.runMobilenet=function(n,r){var a=this.config.isFirstLayerConv2d?Ym(or(n,r.conv0,"valid",!1)):ma(n,r.conv0);return a=Pt(a,[2,2],[2,2],"same"),a=ma(a,r.conv1),a=Pt(a,[2,2],[2,2],"same"),a=ma(a,r.conv2),a=Pt(a,[2,2],[2,2],"same"),a=ma(a,r.conv3),a=Pt(a,[2,2],[2,2],"same"),a=ma(a,r.conv4),a=Pt(a,[2,2],[2,2],"same"),a=ma(a,r.conv5),a=Pt(a,[2,2],[1,1],"same"),a=r.conv6?ma(a,r.conv6):a,a=r.conv7?ma(a,r.conv7):a,or(a,r.conv8,"valid",!1)},t.prototype.forwardInput=function(n,r){var a=this,o=this.params;if(!o)throw new Error("TinyYolov2 - load model before inference");return ce(function(){var i=n.toBatchTensor(r,!1).toFloat();return i=a.config.meanRgb?wl(i,a.config.meanRgb):i,i=i.div(le(256)),a.config.withSeparableConvs?a.runMobilenet(i,o):a.runTinyYolov2(i,o)})},t.prototype.forward=function(n,r){return ge(this,void 0,void 0,function(){var a;return xe(this,function(o){switch(o.label){case 0:return a=this.forwardInput,[4,Bt(n)];case 1:return[4,a.apply(this,[o.sent(),r])];case 2:return[2,o.sent()]}})})},t.prototype.detect=function(n,r){return r===void 0&&(r={}),ge(this,void 0,void 0,function(){var a,o,i,s,l,c,d,h,f,p,v,g,y,m,x=this;return xe(this,function(b){switch(b.label){case 0:return a=new Qm(r),o=a.inputSize,i=a.scoreThreshold,[4,Bt(n)];case 1:return s=b.sent(),[4,this.forwardInput(s,o)];case 2:return l=b.sent(),c=ce(function(){return Rt(l)[0].expandDims()}),d={width:s.getInputWidth(0),height:s.getInputHeight(0)},[4,this.extractBoxes(c,s.getReshapedInputDimensions(0),i)];case 3:return h=b.sent(),l.dispose(),c.dispose(),f=h.map(function(w){return w.box}),p=h.map(function(w){return w.score}),v=h.map(function(w){return w.classScore}),g=h.map(function(w){return x.config.classes[w.label]}),y=tl(f.map(function(w){return w.rescale(o)}),p,this.config.iouThreshold,!0),m=y.map(function(w){return new pC(p[w],v[w],g[w],f[w],d)}),[2,m]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(n){return $M(n,this.config)},t.prototype.extractParams=function(n){var r=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,a=r?r.length:void 0;if(a!==7&&a!==8&&a!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+a+" filterSizes in config");return BM(n,this.config,this.boxEncodingSize,r)},t.prototype.extractBoxes=function(n,r,a){return ge(this,void 0,void 0,function(){var o,i,s,l,c,d,h,f,p,v,g,y,m,x,b,w,N,C,S,k,_,E,j,T,L,P,B,K,z,M=this;return xe(this,function(U){switch(U.label){case 0:return o=r.width,i=r.height,s=Math.max(o,i),l=s/o,c=s/i,d=n.shape[1],h=this.config.anchors.length,f=ce(function(){var H=n.reshape([d,d,h,M.boxEncodingSize]),Z=H.slice([0,0,0,0],[d,d,h,4]),ne=H.slice([0,0,0,4],[d,d,h,1]),ue=M.withClassScores?ia(H.slice([0,0,0,5],[d,d,h,M.config.classes.length]),3):le(0);return[Z,ne,ue]}),p=f[0],v=f[1],g=f[2],y=[],[4,v.array()];case 1:return m=U.sent(),[4,p.array()];case 2:x=U.sent(),b=0,U.label=3;case 3:if(!(b<d))return[3,12];w=0,U.label=4;case 4:if(!(w<d))return[3,11];N=0,U.label=5;case 5:return N<h?(C=gh(m[b][w][N][0]),!a||C>a?(S=(w+gh(x[b][w][N][0]))/d*l,k=(b+gh(x[b][w][N][1]))/d*c,_=Math.exp(x[b][w][N][2])*this.config.anchors[N].x/d*l,E=Math.exp(x[b][w][N][3])*this.config.anchors[N].y/d*c,j=S-_/2,T=k-E/2,L={row:b,col:w,anchor:N},this.withClassScores?[4,this.extractPredictedClass(g,L)]:[3,7]):[3,9]):[3,10];case 6:return z=U.sent(),[3,8];case 7:z={classScore:1,label:0},U.label=8;case 8:P=z,B=P.classScore,K=P.label,y.push(Jt({box:new sd(j,T,j+_,T+E),score:C,classScore:C*B,label:K},L)),U.label=9;case 9:return N++,[3,5];case 10:return w++,[3,4];case 11:return b++,[3,3];case 12:return p.dispose(),v.dispose(),g.dispose(),[2,y]}})})},t.prototype.extractPredictedClass=function(n,r){return ge(this,void 0,void 0,function(){var a,o,i,s;return xe(this,function(l){switch(l.label){case 0:return a=r.row,o=r.col,i=r.anchor,[4,n.array()];case 1:return s=l.sent(),[2,Array(this.config.classes.length).fill(0).map(function(c,d){return s[a][o][i][d]}).map(function(c,d){return{classScore:c,label:d}}).reduce(function(c,d){return c.classScore>d.classScore?c:d})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(la),UM=function(e){Re(t,e);function t(n){n===void 0&&(n=!0);var r=this,a=Object.assign({},{withSeparableConvs:n,iouThreshold:AM,classes:["face"]},n?{anchors:TM,meanRgb:PM}:{anchors:DM,withClassScores:!0});return r=e.call(this,a)||this,r}return Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,r){return ge(this,void 0,void 0,function(){var a;return xe(this,function(o){switch(o.label){case 0:return[4,this.detect(n,r)];case 1:return a=o.sent(),[2,a.map(function(i){return new Mr(i.score,i.relativeBox,{width:i.imageWidth,height:i.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?MM:FM},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(UC),Nc=function(e){Re(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n._name="TinyFaceDetectorOptions",n}return t}(Qm),Nl=function(){function e(){}return e.prototype.then=function(t){return ge(this,void 0,void 0,function(){var n;return xe(this,function(r){switch(r.label){case 0:return n=t,[4,this.run()];case 1:return[2,n.apply(void 0,[r.sent()])]}})})},e.prototype.run=function(){return ge(this,void 0,void 0,function(){return xe(this,function(t){throw new Error("ComposableTask - run is not implemented")})})},e}();function dd(e,t,n,r,a){return a===void 0&&(a=function(o){var i=o.alignedRect;return i}),ge(this,void 0,void 0,function(){var o,i,s,l,c;return xe(this,function(d){switch(d.label){case 0:return o=e.map(function(h){return YF(h)?a(h):h.detection}),s=r,s?[3,5]:t instanceof it?[4,Vm(t,o)]:[3,2];case 1:return l=d.sent(),[3,4];case 2:return[4,Wm(t,o)];case 3:l=d.sent(),d.label=4;case 4:s=l,d.label=5;case 5:return i=s,[4,n(i)];case 6:return c=d.sent(),i.forEach(function(h){return h instanceof it&&h.dispose()}),[2,c]}})})}function Jm(e,t,n,r,a){return ge(this,void 0,void 0,function(){var o=this;return xe(this,function(i){return[2,dd([e],t,function(s){return ge(o,void 0,void 0,function(){return xe(this,function(l){return[2,n(s[0])]})})},r,a)]})})}function WM(e){return ce(function(){return Pn(Rt(e,3).reverse(),3)})}var au=2,Cc=12;function VM(e,t){var n=ud(e,t),r=Hm(e,t);function a(c,d){var h=wt(e(c));return t.push({paramPath:d}),h}function o(c,d,h){h===void 0&&(h=!1);var f=n(c[0],c[1],3,d+"/conv1"),p=a(c[1],d+"/prelu1_alpha"),v=n(c[1],c[2],3,d+"/conv2"),g=a(c[2],d+"/prelu2_alpha"),y=n(c[2],c[3],h?2:3,d+"/conv3"),m=a(c[3],d+"/prelu3_alpha");return{conv1:f,prelu1_alpha:p,conv2:v,prelu2_alpha:g,conv3:y,prelu3_alpha:m}}function i(){var c=o([3,10,16,32],"pnet"),d=n(32,2,1,"pnet/conv4_1"),h=n(32,4,1,"pnet/conv4_2");return Jt(Jt({},c),{conv4_1:d,conv4_2:h})}function s(){var c=o([3,28,48,64],"rnet",!0),d=r(576,128,"rnet/fc1"),h=a(128,"rnet/prelu4_alpha"),f=r(128,2,"rnet/fc2_1"),p=r(128,4,"rnet/fc2_2");return Jt(Jt({},c),{fc1:d,prelu4_alpha:h,fc2_1:f,fc2_2:p})}function l(){var c=o([3,32,64,64],"onet"),d=n(64,128,2,"onet/conv4"),h=a(128,"onet/prelu4_alpha"),f=r(1152,256,"onet/fc1"),p=a(256,"onet/prelu5_alpha"),v=r(256,2,"onet/fc2_1"),g=r(256,4,"onet/fc2_2"),y=r(256,10,"onet/fc2_3");return Jt(Jt({},c),{conv4:d,prelu4_alpha:h,fc1:f,prelu5_alpha:p,fc2_1:v,fc2_2:g,fc2_3:y})}return{extractPNetParams:i,extractRNetParams:s,extractONetParams:l}}function HM(e){var t=ca(e),n=t.extractWeights,r=t.getRemainingWeights,a=[],o=VM(n,a),i=o.extractPNetParams,s=o.extractRNetParams,l=o.extractONetParams,c=i(),d=s(),h=l();if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:c,rnet:d,onet:h},paramMappings:a}}function GM(e,t){var n=eo(e,t);function r(d){var h=n(d+"/weights",4,d+"/filters"),f=n(d+"/bias",1);return{filters:h,bias:f}}function a(d){var h=n(d+"/weights",2),f=n(d+"/bias",1);return{weights:h,bias:f}}function o(d){return n(d,1)}function i(d){var h=r(d+"/conv1"),f=o(d+"/prelu1_alpha"),p=r(d+"/conv2"),v=o(d+"/prelu2_alpha"),g=r(d+"/conv3"),y=o(d+"/prelu3_alpha");return{conv1:h,prelu1_alpha:f,conv2:p,prelu2_alpha:v,conv3:g,prelu3_alpha:y}}function s(){var d=i("pnet"),h=r("pnet/conv4_1"),f=r("pnet/conv4_2");return Jt(Jt({},d),{conv4_1:h,conv4_2:f})}function l(){var d=i("rnet"),h=a("rnet/fc1"),f=o("rnet/prelu4_alpha"),p=a("rnet/fc2_1"),v=a("rnet/fc2_2");return Jt(Jt({},d),{fc1:h,prelu4_alpha:f,fc2_1:p,fc2_2:v})}function c(){var d=i("onet"),h=r("onet/conv4"),f=o("onet/prelu4_alpha"),p=a("onet/fc1"),v=o("onet/prelu5_alpha"),g=a("onet/fc2_1"),y=a("onet/fc2_2"),m=a("onet/fc2_3");return Jt(Jt({},d),{conv4:h,prelu4_alpha:f,fc1:p,prelu5_alpha:v,fc2_1:g,fc2_2:y,fc2_3:m})}return{extractPNetParams:s,extractRNetParams:l,extractONetParams:c}}function qM(e){var t=[],n=GM(e,t),r=n.extractPNetParams,a=n.extractRNetParams,o=n.extractONetParams,i=r(),s=a(),l=o();return ua(e,t),{params:{pnet:i,rnet:s,onet:l},paramMappings:t}}function Kf(e,t){var n=t[0],r=t[1];return{height:Math.floor(n*e),width:Math.floor(r*e)}}function KM(e,t,n){for(var r=n[0],a=n[1],o=Cc/e,i=[],s=Math.min(r,a)*o,l=0;s>=12;)i.push(o*Math.pow(t,l)),s=s*t,l+=1;return i}var Zm=function(e){Re(t,e);function t(n,r,a,o){return e.call(this,{left:n,top:r,right:a,bottom:o},!0)||this}return t}(Va);function WC(e){return ce(function(){return nn(At(e,le(127.5)),le(.0078125))})}function Ni(e,t){return ce(function(){return Be(st(e),nn(t,mc(st(mc(e)))))})}function ev(e,t,n){return n===void 0&&(n=!1),ce(function(){var r=or(e,t.conv1,"valid");return r=Ni(r,t.prelu1_alpha),r=Pt(r,n?[2,2]:[3,3],[2,2],"same"),r=or(r,t.conv2,"valid"),r=Ni(r,t.prelu2_alpha),r=n?r:Pt(r,[3,3],[2,2],"valid"),r=or(r,t.conv3,"valid"),r=Ni(r,t.prelu3_alpha),r})}function XM(e,t){return ce(function(){var n=ev(e,t,!0),r=or(n,t.conv4_1,"valid"),a=Un(rd(r,3),3),o=ia(At(r,a),3),i=or(n,t.conv4_2,"valid");return{prob:o,regions:i}})}function YM(e,t){return ce(function(){var n=Kf(t,e.shape.slice(1)),r=n.height,a=n.width,o=Am.resizeBilinear(e,[r,a]),i=WC(o);return Wa(i,[0,2,1,3])})}function QM(e,t,n,r){for(var a=[],o=e.arraySync(),i=0;i<e.shape[0];i++)for(var s=0;s<e.shape[1];s++)o[i][s]>=r&&a.push(new He(s,i));var l=a.map(function(c){var d=new sd(Math.round((c.y*au+1)/n),Math.round((c.x*au+1)/n),Math.round((c.y*au+Cc)/n),Math.round((c.x*au+Cc)/n)),h=o[c.y][c.x],f=t.arraySync(),p=new Zm(f[c.y][c.x][0],f[c.y][c.x][1],f[c.y][c.x][2],f[c.y][c.x][3]);return{cell:d,score:h,region:p}});return l}function JM(e,t,n,r,a){a.stage1=[];var o=t.map(function(f){return ce(function(){var p={scale:f},v=YM(e,f),g=Date.now(),y=XM(v,r),m=y.prob,x=y.regions;p.pnet=Date.now()-g;var b=Rt(Rt(m,3)[1])[0],w=Rt(x)[0];return{scoresTensor:b,regionsTensor:w,scale:f,statsForScale:p}})}),i=o.map(function(f){var p=f.scoresTensor,v=f.regionsTensor,g=f.scale,y=f.statsForScale,m=QM(p,v,g,n);if(p.dispose(),v.dispose(),!m.length)return a.stage1.push(y),[];var x=Date.now(),b=tl(m.map(function(w){return w.cell}),m.map(function(w){return w.score}),.5);return y.nms=Date.now()-x,y.numBoxes=b.length,a.stage1.push(y),b.map(function(w){return m[w]})}),s=i.reduce(function(f,p){return f.concat(p)},[]),l=[],c=[];if(s.length>0){var d=Date.now(),h=tl(s.map(function(f){return f.cell}),s.map(function(f){return f.score}),.7);a.stage1_nms=Date.now()-d,c=h.map(function(f){return s[f].score}),l=h.map(function(f){return s[f]}).map(function(f){var p=f.cell,v=f.region;return new sd(p.left+v.left*p.width,p.top+v.top*p.height,p.right+v.right*p.width,p.bottom+v.bottom*p.height).toSquare().round()})}return{boxes:l,scores:c}}function VC(e,t,n){var r=n.width,a=n.height;return ge(this,void 0,void 0,function(){var o,i,s,l=this;return xe(this,function(c){switch(c.label){case 0:return o=Io(e),[4,Promise.all(t.map(function(d){return ge(l,void 0,void 0,function(){var h,f,p,v,g,y,m,x;return xe(this,function(b){return h=d.padAtBorders(e.height,e.width),f=h.y,p=h.ey,v=h.x,g=h.ex,y=v-1,m=f-1,x=o.getImageData(y,m,g-y,p-m),[2,an.isNodejs()?Um(x):createImageBitmap(x)]})})}))];case 1:return i=c.sent(),s=[],i.forEach(function(d){var h=ld({width:r,height:a}),f=Io(h);f.drawImage(d,0,0,r,a);for(var p=f.getImageData(0,0,r,a).data,v=[],g=0;g<p.length;g+=4)v.push(p[g+2]),v.push(p[g+1]),v.push(p[g]);s.push(v)}),[2,s.map(function(d){var h=ce(function(){var f=Wa(fn(d,[1,r,a,3]),[0,2,1,3]).toFloat();return WC(f)});return h})]}})})}function ZM(e,t){return ce(function(){var n=ev(e,t),r=nr(n,[n.shape[0],t.fc1.weights.shape[0]]),a=kr(r,t.fc1),o=Ni(a,t.prelu4_alpha),i=kr(o,t.fc2_1),s=Un(rd(i,1),1),l=ia(At(i,s),1),c=kr(o,t.fc2_2),d=Rt(l,1)[1];return{scores:d,regions:c}})}function e6(e,t,n,r,a){return ge(this,void 0,void 0,function(){var o,i,s,l,c,d,h,f,p,v,g,y,m,x;return xe(this,function(b){switch(b.label){case 0:return o=Date.now(),[4,VC(e,t,{width:24,height:24})];case 1:return i=b.sent(),a.stage2_extractImagePatches=Date.now()-o,o=Date.now(),s=i.map(function(w){var N=ZM(w,r);return w.dispose(),N}),a.stage2_rnet=Date.now()-o,l=s.length>1?_t(s.map(function(w){return w.scores})):s[0].scores,h=(d=Array).from,[4,l.data()];case 2:return c=h.apply(d,[b.sent()]),l.dispose(),f=c.map(function(w,N){return{score:w,idx:N}}).filter(function(w){return w.score>n}).map(function(w){var N=w.idx;return N}),p=f.map(function(w){return t[w]}),v=f.map(function(w){return c[w]}),g=[],y=[],p.length>0&&(o=Date.now(),m=tl(p,v,.7),a.stage2_nms=Date.now()-o,x=m.map(function(w){var N=s[f[w]].regions.arraySync();return new Zm(N[0][0],N[0][1],N[0][2],N[0][3])}),y=m.map(function(w){return v[w]}),g=m.map(function(w,N){return p[w].calibrate(x[N])})),s.forEach(function(w){w.regions.dispose(),w.scores.dispose()}),[2,{boxes:g,scores:y}]}})})}function t6(e,t){return ce(function(){var n=ev(e,t);n=Pt(n,[2,2],[2,2],"same"),n=or(n,t.conv4,"valid"),n=Ni(n,t.prelu4_alpha);var r=nr(n,[n.shape[0],t.fc1.weights.shape[0]]),a=kr(r,t.fc1),o=Ni(a,t.prelu5_alpha),i=kr(o,t.fc2_1),s=Un(rd(i,1),1),l=ia(At(i,s),1),c=kr(o,t.fc2_2),d=kr(o,t.fc2_3),h=Rt(l,1)[1];return{scores:h,regions:c,points:d}})}function n6(e,t,n,r,a){return ge(this,void 0,void 0,function(){var o,i,s,l,c,d,h,f,p,v,g,y,m,x,b;return xe(this,function(w){switch(w.label){case 0:return o=Date.now(),[4,VC(e,t,{width:48,height:48})];case 1:return i=w.sent(),a.stage3_extractImagePatches=Date.now()-o,o=Date.now(),s=i.map(function(N){var C=t6(N,r);return N.dispose(),C}),a.stage3_onet=Date.now()-o,l=s.length>1?_t(s.map(function(N){return N.scores})):s[0].scores,h=(d=Array).from,[4,l.data()];case 2:return c=h.apply(d,[w.sent()]),l.dispose(),f=c.map(function(N,C){return{score:N,idx:C}}).filter(function(N){return N.score>n}).map(function(N){var C=N.idx;return C}),p=f.map(function(N){var C=s[N].regions.arraySync();return new Zm(C[0][0],C[0][1],C[0][2],C[0][3])}),v=f.map(function(N,C){return t[N].calibrate(p[C])}),g=f.map(function(N){return c[N]}),y=[],m=[],x=[],v.length>0&&(o=Date.now(),b=tl(v,g,.7,!1),a.stage3_nms=Date.now()-o,y=b.map(function(N){return v[N]}),m=b.map(function(N){return g[N]}),x=b.map(function(N,C){return Array(5).fill(0).map(function(S,k){var _=s[N].points.arraySync();return new He(_[0][k]*(y[C].width+1)+y[C].left,_[0][k+5]*(y[C].height+1)+y[C].top)})})),s.forEach(function(N){N.regions.dispose(),N.scores.dispose(),N.points.dispose()}),[2,{boxes:y,scores:m,points:x}]}})})}var r6=function(e){Re(t,e);function t(){return e.call(this,"Mtcnn")||this}return t.prototype.load=function(n){return ge(this,void 0,void 0,function(){return xe(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.load.call(this,n)]})})},t.prototype.loadFromDisk=function(n){return ge(this,void 0,void 0,function(){return xe(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.loadFromDisk.call(this,n)]})})},t.prototype.forwardInput=function(n,r){return r===void 0&&(r={}),ge(this,void 0,void 0,function(){var a,o,i,s,l,c,d,h,f,p,v,g,y,m,x,b,w,N,C,S,k;return xe(this,function(_){switch(_.label){case 0:if(a=this.params,!a)throw new Error("Mtcnn - load model before inference");if(o=n.canvases[0],!o)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return i={},s=Date.now(),l=ce(function(){return WM(Un(Om.fromPixels(o)).toFloat())}),c=function(E){return l.dispose(),i.total=Date.now()-s,E},d=l.shape.slice(1),h=d[0],f=d[1],p=new zC(r),v=p.minFaceSize,g=p.scaleFactor,y=p.maxNumScales,m=p.scoreThresholds,x=p.scaleSteps,b=(x||KM(v,g,[h,f])).filter(function(E){var j=Kf(E,[h,f]);return Math.min(j.width,j.height)>Cc}).slice(0,y),i.scales=b,i.pyramid=b.map(function(E){return Kf(E,[h,f])}),w=Date.now(),[4,JM(l,b,m[0],a.pnet,i)];case 1:return N=_.sent(),i.total_stage1=Date.now()-w,N.boxes.length?(i.stage2_numInputBoxes=N.boxes.length,w=Date.now(),[4,e6(o,N.boxes,m[1],a.rnet,i)]):[2,c({results:[],stats:i})];case 2:return C=_.sent(),i.total_stage2=Date.now()-w,C.boxes.length?(i.stage3_numInputBoxes=C.boxes.length,w=Date.now(),[4,n6(o,C.boxes,m[2],a.onet,i)]):[2,c({results:[],stats:i})];case 3:return S=_.sent(),i.total_stage3=Date.now()-w,k=S.boxes.map(function(E,j){return Km(zm({},new Mr(S.scores[j],new Bm(E.left/f,E.top/h,E.width/f,E.height/h),{height:h,width:f})),new TF(S.points[j].map(function(T){return T.sub(new He(E.left,E.top)).div(new He(E.width,E.height))}),{width:E.width,height:E.height}))}),[2,c({results:k,stats:i})]}})})},t.prototype.forward=function(n,r){return r===void 0&&(r={}),ge(this,void 0,void 0,function(){var a;return xe(this,function(o){switch(o.label){case 0:return a=this.forwardInput,[4,Bt(n)];case 1:return[4,a.apply(this,[o.sent(),r])];case 2:return[2,o.sent().results]}})})},t.prototype.forwardWithStats=function(n,r){return r===void 0&&(r={}),ge(this,void 0,void 0,function(){var a;return xe(this,function(o){switch(o.label){case 0:return a=this.forwardInput,[4,Bt(n)];case 1:return[2,a.apply(this,[o.sent(),r])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(n){return qM(n)},t.prototype.extractParams=function(n){return HM(n)},t}(la),a6=.4,o6=[new He(1.603231,2.094468),new He(6.041143,7.080126),new He(2.882459,3.518061),new He(4.266906,5.178857),new He(9.041765,10.66308)],i6=[117.001,114.697,97.404],s6=function(e){Re(t,e);function t(){var n=this,r={withSeparableConvs:!0,iouThreshold:a6,classes:["face"],anchors:o6,meanRgb:i6,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return n=e.call(this,r)||this,n}return Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,r){return ge(this,void 0,void 0,function(){var a;return xe(this,function(o){switch(o.label){case 0:return[4,this.detect(n,r)];case 1:return a=o.sent(),[2,a.map(function(i){return new Mr(i.score,i.relativeBox,{width:i.imageWidth,height:i.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(UC),Mt={ssdMobilenetv1:new $C,tinyFaceDetector:new s6,tinyYolov2:new UM,mtcnn:new r6,faceLandmark68Net:new PC,faceLandmark68TinyNet:new uM,faceRecognitionNet:new vM,faceExpressionNet:new XF,ageGenderNet:new oM},HC=function(e){Re(t,e);function t(n,r,a){var o=e.call(this)||this;return o.parentTask=n,o.input=r,o.extractedFaces=a,o}return t}(Nl),tv=function(e){Re(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return ge(this,void 0,void 0,function(){var n,r,a=this;return xe(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),[4,dd(n,this.input,function(i){return ge(a,void 0,void 0,function(){return xe(this,function(s){switch(s.label){case 0:return[4,Promise.all(i.map(function(l){return Mt.faceExpressionNet.predictExpressions(l)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=o.sent(),[2,n.map(function(i,s){return AC(i,r[s])})]}})})},t.prototype.withAgeAndGender=function(){return new ov(this,this.input)},t}(HC),nv=function(e){Re(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return ge(this,void 0,void 0,function(){var n,r;return xe(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return n=a.sent(),n?[4,Jm(n,this.input,function(o){return Mt.faceExpressionNet.predictExpressions(o)},this.extractedFaces)]:[2];case 2:return r=a.sent(),[2,AC(n,r)]}})})},t.prototype.withAgeAndGender=function(){return new iv(this,this.input)},t}(HC),rv=function(e){Re(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new sv(this,this.input)},t.prototype.withFaceDescriptors=function(){return new uv(this,this.input)},t}(tv),av=function(e){Re(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new lv(this,this.input)},t.prototype.withFaceDescriptor=function(){return new cv(this,this.input)},t}(nv),GC=function(e){Re(t,e);function t(n,r,a){var o=e.call(this)||this;return o.parentTask=n,o.input=r,o.extractedFaces=a,o}return t}(Nl),ov=function(e){Re(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return ge(this,void 0,void 0,function(){var n,r,a=this;return xe(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),[4,dd(n,this.input,function(i){return ge(a,void 0,void 0,function(){return xe(this,function(s){switch(s.label){case 0:return[4,Promise.all(i.map(function(l){return Mt.ageGenderNet.predictAgeAndGender(l)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=o.sent(),[2,n.map(function(i,s){var l=r[s],c=l.age,d=l.gender,h=l.genderProbability;return LC(BC(i,d,h),c)})]}})})},t.prototype.withFaceExpressions=function(){return new tv(this,this.input)},t}(GC),iv=function(e){Re(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return ge(this,void 0,void 0,function(){var n,r,a,o,i;return xe(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?[4,Jm(n,this.input,function(l){return Mt.ageGenderNet.predictAgeAndGender(l)},this.extractedFaces)]:[2];case 2:return r=s.sent(),a=r.age,o=r.gender,i=r.genderProbability,[2,LC(BC(n,o,i),a)]}})})},t.prototype.withFaceExpressions=function(){return new nv(this,this.input)},t}(GC),sv=function(e){Re(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new rv(this,this.input)},t.prototype.withFaceDescriptors=function(){return new uv(this,this.input)},t}(ov),lv=function(e){Re(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new av(this,this.input)},t.prototype.withFaceDescriptor=function(){return new cv(this,this.input)},t}(iv),qC=function(e){Re(t,e);function t(n,r){var a=e.call(this)||this;return a.parentTask=n,a.input=r,a}return t}(Nl),uv=function(e){Re(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return ge(this,void 0,void 0,function(){var n,r;return xe(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return n=a.sent(),[4,dd(n,this.input,function(o){return Promise.all(o.map(function(i){return Mt.faceRecognitionNet.computeFaceDescriptor(i)}))},null,function(o){return o.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return r=a.sent(),[2,r.map(function(o,i){return OC(n[i],o)})]}})})},t.prototype.withFaceExpressions=function(){return new rv(this,this.input)},t.prototype.withAgeAndGender=function(){return new sv(this,this.input)},t}(qC),cv=function(e){Re(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return ge(this,void 0,void 0,function(){var n,r;return xe(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return n=a.sent(),n?[4,Jm(n,this.input,function(o){return Mt.faceRecognitionNet.computeFaceDescriptor(o)},null,function(o){return o.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=a.sent(),[2,OC(n,r)]}})})},t.prototype.withFaceExpressions=function(){return new av(this,this.input)},t.prototype.withAgeAndGender=function(){return new lv(this,this.input)},t}(qC),KC=function(e){Re(t,e);function t(n,r,a){var o=e.call(this)||this;return o.parentTask=n,o.input=r,o.useTinyLandmarkNet=a,o}return Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?Mt.faceLandmark68TinyNet:Mt.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(Nl),l6=function(e){Re(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return ge(this,void 0,void 0,function(){var n,r,a,o,i,s=this;return xe(this,function(l){switch(l.label){case 0:return[4,this.parentTask];case 1:return n=l.sent(),r=n.map(function(c){return c.detection}),this.input instanceof it?[4,Vm(this.input,r)]:[3,3];case 2:return o=l.sent(),[3,5];case 3:return[4,Wm(this.input,r)];case 4:o=l.sent(),l.label=5;case 5:return a=o,[4,Promise.all(a.map(function(c){return s.landmarkNet.detectLandmarks(c)}))];case 6:return i=l.sent(),a.forEach(function(c){return c instanceof it&&c.dispose()}),[2,n.map(function(c,d){return Km(c,i[d])})]}})})},t.prototype.withFaceExpressions=function(){return new rv(this,this.input)},t.prototype.withAgeAndGender=function(){return new sv(this,this.input)},t.prototype.withFaceDescriptors=function(){return new uv(this,this.input)},t}(KC),u6=function(e){Re(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return ge(this,void 0,void 0,function(){var n,r,a,o,i;return xe(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?(r=n.detection,this.input instanceof it?[4,Vm(this.input,[r])]:[3,3]):[2];case 2:return o=s.sent(),[3,5];case 3:return[4,Wm(this.input,[r])];case 4:o=s.sent(),s.label=5;case 5:return a=o,[4,this.landmarkNet.detectLandmarks(a[0])];case 6:return i=s.sent(),a.forEach(function(l){return l instanceof it&&l.dispose()}),[2,Km(n,i)]}})})},t.prototype.withFaceExpressions=function(){return new av(this,this.input)},t.prototype.withAgeAndGender=function(){return new lv(this,this.input)},t.prototype.withFaceDescriptor=function(){return new cv(this,this.input)},t}(KC),XC=function(e){Re(t,e);function t(n,r){r===void 0&&(r=new cd);var a=e.call(this)||this;return a.input=n,a.options=r,a}return t}(Nl),c6=function(e){Re(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return ge(this,void 0,void 0,function(){var n,r,a,o;return xe(this,function(i){switch(i.label){case 0:return n=this,r=n.input,a=n.options,a instanceof zC?[4,Mt.mtcnn.forward(r,a)]:[3,2];case 1:return[2,i.sent().map(function(s){return s.detection})];case 2:if(o=a instanceof Nc?function(s){return Mt.tinyFaceDetector.locateFaces(s,a)}:a instanceof cd?function(s){return Mt.ssdMobilenetv1.locateFaces(s,a)}:a instanceof Qm?function(s){return Mt.tinyYolov2.locateFaces(s,a)}:null,!o)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,o(r)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var n=this;return new Promise(function(r){return ge(n,void 0,void 0,function(){var a;return xe(this,function(o){switch(o.label){case 0:return[4,this.run()];case 1:return a=o.sent(),[2,r(a.map(function(i){return zm({},i)}))]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new l6(this.runAndExtendWithFaceDetections(),this.input,n)},t.prototype.withFaceExpressions=function(){return new tv(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new ov(this.runAndExtendWithFaceDetections(),this.input)},t}(XC),d6=function(e){Re(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return ge(this,void 0,void 0,function(){var n,r;return xe(this,function(a){switch(a.label){case 0:return[4,new c6(this.input,this.options)];case 1:return n=a.sent(),r=n[0],n.forEach(function(o){o.score>r.score&&(r=o)}),[2,r]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var n=this;return new Promise(function(r){return ge(n,void 0,void 0,function(){var a;return xe(this,function(o){switch(o.label){case 0:return[4,this.run()];case 1:return a=o.sent(),[2,r(a?zm({},a):void 0)]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new u6(this.runAndExtendWithFaceDetection(),this.input,n)},t.prototype.withFaceExpressions=function(){return new nv(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new iv(this.runAndExtendWithFaceDetection(),this.input)},t}(XC);function Xf(e,t){return t===void 0&&(t=new cd),new d6(e,t)}function h6(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(e),r=Array.from(t);return Math.sqrt(n.map(function(a,o){return a-r[o]}).reduce(function(a,o){return a+Math.pow(o,2)},0))}(function(){function e(t,n){n===void 0&&(n=.6),this._distanceThreshold=n;var r=Array.isArray(t)?t:[t];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var a=1,o=function(){return"person "+a++};this._labeledDescriptors=r.map(function(i){if(i instanceof eu)return i;if(i instanceof Float32Array)return new eu(o(),[i]);if(i.descriptor&&i.descriptor instanceof Float32Array)return new eu(o(),[i.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(e.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),e.prototype.computeMeanDistance=function(t,n){return n.map(function(r){return h6(r,t)}).reduce(function(r,a){return r+a},0)/(n.length||1)},e.prototype.matchDescriptor=function(t){var n=this;return this.labeledDescriptors.map(function(r){var a=r.descriptors,o=r.label;return new r1(o,n.computeMeanDistance(t,a))}).reduce(function(r,a){return r.distance<a.distance?r:a})},e.prototype.findBestMatch=function(t){var n=this.matchDescriptor(t);return n.distance<this.distanceThreshold?n:new r1("unknown",n.distance)},e.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(t){return t.toJSON()})}},e.fromJSON=function(t){var n=t.labeledDescriptors.map(function(r){return eu.fromJSON(r)});return new e(n,t.distanceThreshold)},e})();const u1="336620578429-9et3ddov717t2hcbabm90tfuupqne5ts.apps.googleusercontent.com",f6=()=>{const e=sr(),{login:t,setAuth:n,isLoading:r}=ur(),[a,o]=I.useState(!1),[i,s]=I.useState("email"),[l,c]=I.useState(!1),[d,h]=I.useState(!1),[f,p]=I.useState({email:"",password:""}),v=I.useRef(null),g=I.useRef(null);I.useEffect(()=>((async()=>{try{await Promise.all([Mt.tinyFaceDetector.loadFromUri("/models"),Mt.faceLandmark68Net.loadFromUri("/models"),Mt.faceRecognitionNet.loadFromUri("/models")]),c(!0)}catch{console.log("Face models not loaded - facial recognition unavailable")}})(),()=>m()),[]);const y=async()=>{try{const N=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}});g.current=N,setTimeout(()=>{v.current&&(v.current.srcObject=N)},100)}catch(N){console.error("Camera error:",N),V.error("Impossible d'accder  la camra")}},m=()=>{g.current&&(g.current.getTracks().forEach(N=>N.stop()),g.current=null)},x=async()=>{var N,C;if(!f.email){V.error("Veuillez entrer votre email");return}if(!l){V.error("Modles de reconnaissance non chargs");return}h(!0);try{await new Promise(E=>setTimeout(E,500));const S=new Nc({inputSize:320,scoreThreshold:.3});let k=null;for(let E=0;E<3&&(k=await Xf(v.current,S).withFaceLandmarks().withFaceDescriptor(),!k);E++)await new Promise(j=>setTimeout(j,300));if(!k){V.error("Aucun visage dtect. Assurez-vous que votre visage est bien visible."),h(!1);return}const _=await ie.post("/auth/face/login",{email:f.email,faceDescriptor:Array.from(k.descriptor)});n(_.data.token,_.data.user),V.success("Connexion russie !"),m(),e("/dashboard")}catch(S){V.error(((C=(N=S.response)==null?void 0:N.data)==null?void 0:C.message)||"Reconnaissance faciale choue")}finally{h(!1)}},b=N=>{p({...f,[N.target.name]:N.target.value})},w=async N=>{N.preventDefault();const C=await t(f.email,f.password);C.success?(V.success("Connexion russie !"),e("/dashboard")):V.error(C.error)};return u.jsx(Tw,{clientId:u1,children:u.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex",children:[u.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:u.jsxs("div",{className:"w-full max-w-md bg-white/10 backdrop-blur-xl rounded-3xl p-8 shadow-2xl border border-white/20",children:[u.jsxs(Fe,{to:"/",className:"flex items-center gap-2 mb-8",children:[u.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-cyan-500 to-purple-500 rounded-xl flex items-center justify-center",children:u.jsx(Ar,{className:"w-6 h-6 text-white"})}),u.jsx("span",{className:"text-2xl font-bold text-white",children:"StartUpLab"})]}),u.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Bon retour !"}),u.jsx("p",{className:"text-gray-300 mb-6",children:"Connectez-vous pour accder  votre espace."}),u.jsxs("div",{className:"flex gap-2 mb-6 p-1 bg-white/10 rounded-xl",children:[u.jsx("button",{onClick:()=>{s("email"),m()},className:`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-all ${i==="email"?"bg-white text-gray-900":"text-white hover:bg-white/10"}`,children:"Email"}),u.jsxs("button",{onClick:()=>{s("face"),y()},className:`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-all flex items-center justify-center gap-2 ${i==="face"?"bg-white text-gray-900":"text-white hover:bg-white/10"}`,children:[u.jsx(Qu,{className:"w-4 h-4"})," Visage"]})]}),i==="email"?u.jsxs("form",{onSubmit:w,className:"space-y-5",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:"Adresse email"}),u.jsxs("div",{className:"relative",children:[u.jsx(ea,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"email",name:"email",value:f.email,onChange:b,className:"w-full bg-white/10 border border-white/20 rounded-xl py-3 pl-10 pr-4 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"vous@exemple.com",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:"Mot de passe"}),u.jsxs("div",{className:"relative",children:[u.jsx(_o,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:a?"text":"password",name:"password",value:f.password,onChange:b,className:"w-full bg-white/10 border border-white/20 rounded-xl py-3 pl-10 pr-10 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"",required:!0}),u.jsx("button",{type:"button",onClick:()=>o(!a),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white",children:a?u.jsx(rm,{className:"w-5 h-5"}):u.jsx(Eo,{className:"w-5 h-5"})})]})]}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("label",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",className:"rounded bg-white/10 border-white/20 text-cyan-500"}),u.jsx("span",{className:"text-sm text-gray-300",children:"Se souvenir de moi"})]}),u.jsx("a",{href:"#",className:"text-sm text-cyan-400 hover:text-cyan-300",children:"Mot de passe oubli ?"})]}),u.jsx("button",{type:"submit",disabled:r,className:"w-full py-3 bg-gradient-to-r from-cyan-500 to-purple-500 text-white font-semibold rounded-xl hover:opacity-90 transition-opacity disabled:opacity-50",children:r?"Connexion...":"Se connecter"})]}):u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:"Adresse email"}),u.jsxs("div",{className:"relative",children:[u.jsx(ea,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"email",name:"email",value:f.email,onChange:b,className:"w-full bg-white/10 border border-white/20 rounded-xl py-3 pl-10 pr-4 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"vous@exemple.com",required:!0})]})]}),u.jsxs("div",{className:"relative aspect-video bg-black rounded-xl overflow-hidden",children:[u.jsx("video",{ref:v,autoPlay:!0,muted:!0,playsInline:!0,className:"w-full h-full object-cover"}),u.jsx("div",{className:"absolute inset-0 border-4 border-dashed border-cyan-500/50 rounded-xl pointer-events-none"})]}),u.jsx("button",{onClick:x,disabled:d||!f.email,className:"w-full py-3 bg-gradient-to-r from-cyan-500 to-purple-500 text-white font-semibold rounded-xl hover:opacity-90 transition-opacity disabled:opacity-50 flex items-center justify-center gap-2",children:d?u.jsxs(u.Fragment,{children:[u.jsx(Ma,{className:"w-5 h-5 animate-spin"})," Analyse du visage..."]}):u.jsxs(u.Fragment,{children:[u.jsx(Qu,{className:"w-5 h-5"})," Se connecter avec le visage"]})})]}),u.jsxs("div",{className:"flex items-center gap-4 my-6",children:[u.jsx("div",{className:"flex-1 h-px bg-white/20"}),u.jsx("span",{className:"text-sm text-gray-400",children:"ou continuer avec"}),u.jsx("div",{className:"flex-1 h-px bg-white/20"})]}),u.jsx("div",{className:"flex justify-center",children:u.jsxs("button",{onClick:()=>{const N=`https://accounts.google.com/o/oauth2/v2/auth?client_id=${u1}&redirect_uri=${encodeURIComponent(window.location.origin+"/auth/google/callback")}&response_type=code&scope=openid%20email%20profile&access_type=offline`;window.location.href=N},className:"flex items-center gap-3 px-6 py-3 bg-white text-gray-700 font-medium rounded-full hover:bg-gray-100 transition-colors shadow-lg",children:[u.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[u.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),u.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),u.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),u.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continuer avec Google"]})}),u.jsxs("p",{className:"text-center text-gray-300 mt-8",children:["Pas encore de compte ?"," ",u.jsx(Fe,{to:"/register",className:"text-cyan-400 hover:text-cyan-300 font-medium",children:"S'inscrire gratuitement"})]})]})}),u.jsx("div",{className:"hidden lg:flex flex-1 items-center justify-center p-12",children:u.jsxs("div",{className:"text-center text-white max-w-lg",children:[u.jsx("div",{className:"w-32 h-32 mx-auto mb-8 bg-gradient-to-r from-cyan-500 to-purple-500 rounded-full flex items-center justify-center",children:u.jsx(Ar,{className:"w-16 h-16"})}),u.jsx("h2",{className:"text-4xl font-bold mb-4 bg-gradient-to-r from-cyan-400 to-purple-400 bg-clip-text text-transparent",children:"Transformez vos ides en ralit"}),u.jsx("p",{className:"text-xl text-gray-300",children:"Rejoignez des centaines d'entrepreneurs qui utilisent StartUpLab pour crer et dvelopper leur startup."}),u.jsxs("div",{className:"mt-12 grid grid-cols-3 gap-6",children:[u.jsxs("div",{className:"p-4 bg-white/5 rounded-2xl border border-white/10",children:[u.jsx("div",{className:"text-3xl font-bold text-cyan-400",children:"500+"}),u.jsx("div",{className:"text-sm text-gray-400",children:"Startups cres"})]}),u.jsxs("div",{className:"p-4 bg-white/5 rounded-2xl border border-white/10",children:[u.jsx("div",{className:"text-3xl font-bold text-purple-400",children:"98%"}),u.jsx("div",{className:"text-sm text-gray-400",children:"Satisfaction"})]}),u.jsxs("div",{className:"p-4 bg-white/5 rounded-2xl border border-white/10",children:[u.jsx("div",{className:"text-3xl font-bold text-pink-400",children:"24/7"}),u.jsx("div",{className:"text-sm text-gray-400",children:"Support"})]})]})]})})]})})},c1="336620578429-9et3ddov717t2hcbabm90tfuupqne5ts.apps.googleusercontent.com",p6=()=>{const e=sr(),{register:t,setAuth:n,isLoading:r}=ur(),[a,o]=I.useState(!1),[i,s]=I.useState(!1),[l,c]=I.useState({firstName:"",lastName:"",email:"",password:"",phone:"",company:""}),d=f=>{c({...l,[f.target.name]:f.target.value})},h=async f=>{if(f.preventDefault(),!i){V.error("Veuillez accepter les conditions d'utilisation");return}if(l.password.length<6){V.error("Le mot de passe doit contenir au moins 6 caractres");return}const p=await t(l);p.success?(V.success("Compte cr avec succs !"),e("/dashboard")):V.error(p.error)};return u.jsx(Tw,{clientId:c1,children:u.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex",children:[u.jsx("div",{className:"hidden lg:flex flex-1 items-center justify-center p-12",children:u.jsxs("div",{className:"text-center text-white max-w-lg",children:[u.jsx("div",{className:"w-32 h-32 mx-auto mb-8 bg-gradient-to-r from-cyan-500 to-purple-500 rounded-full flex items-center justify-center animate-float",children:u.jsx(Ar,{className:"w-16 h-16"})}),u.jsx("h2",{className:"text-4xl font-bold mb-4 bg-gradient-to-r from-cyan-400 to-purple-400 bg-clip-text text-transparent",children:"Lancez votre startup"}),u.jsx("p",{className:"text-xl text-gray-300",children:"Tous les outils ncessaires pour passer de l'ide au lancement en un seul endroit."}),u.jsxs("div",{className:"mt-12 grid grid-cols-3 gap-6",children:[u.jsxs("div",{className:"p-4 bg-white/5 rounded-2xl border border-white/10",children:[u.jsx("div",{className:"text-3xl font-bold text-cyan-400",children:"100%"}),u.jsx("div",{className:"text-sm text-gray-400",children:"Gratuit"})]}),u.jsxs("div",{className:"p-4 bg-white/5 rounded-2xl border border-white/10",children:[u.jsx("div",{className:"text-3xl font-bold text-purple-400",children:"5 min"}),u.jsx("div",{className:"text-sm text-gray-400",children:"Pour commencer"})]}),u.jsxs("div",{className:"p-4 bg-white/5 rounded-2xl border border-white/10",children:[u.jsx("div",{className:"text-3xl font-bold text-pink-400",children:""}),u.jsx("div",{className:"text-sm text-gray-400",children:"Possibilits"})]})]})]})}),u.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:u.jsxs("div",{className:"w-full max-w-md bg-white/10 backdrop-blur-xl rounded-3xl p-8 shadow-2xl border border-white/20",children:[u.jsxs(Fe,{to:"/",className:"flex items-center gap-2 mb-6",children:[u.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-cyan-500 to-purple-500 rounded-xl flex items-center justify-center",children:u.jsx(Ar,{className:"w-6 h-6 text-white"})}),u.jsx("span",{className:"text-2xl font-bold text-white",children:"StartUpLab"})]}),u.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Crer un compte"}),u.jsx("p",{className:"text-gray-300 mb-6",children:"Commencez gratuitement, sans carte bancaire."}),u.jsxs("form",{onSubmit:h,className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Prnom"}),u.jsxs("div",{className:"relative",children:[u.jsx(ta,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx("input",{type:"text",name:"firstName",value:l.firstName,onChange:d,className:"w-full bg-white/10 border border-white/20 rounded-xl py-2.5 pl-9 pr-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 text-sm",placeholder:"Ahmed",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Nom"}),u.jsx("input",{type:"text",name:"lastName",value:l.lastName,onChange:d,className:"w-full bg-white/10 border border-white/20 rounded-xl py-2.5 px-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 text-sm",placeholder:"Ben Ali",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Email"}),u.jsxs("div",{className:"relative",children:[u.jsx(ea,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx("input",{type:"email",name:"email",value:l.email,onChange:d,className:"w-full bg-white/10 border border-white/20 rounded-xl py-2.5 pl-9 pr-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 text-sm",placeholder:"vous@exemple.com",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Mot de passe"}),u.jsxs("div",{className:"relative",children:[u.jsx(_o,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx("input",{type:a?"text":"password",name:"password",value:l.password,onChange:d,className:"w-full bg-white/10 border border-white/20 rounded-xl py-2.5 pl-9 pr-10 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 text-sm",placeholder:"Min. 6 caractres",required:!0,autoComplete:"new-password"}),u.jsx("button",{type:"button",onClick:()=>o(!a),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white",children:a?u.jsx(rm,{className:"w-4 h-4"}):u.jsx(Eo,{className:"w-4 h-4"})})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Tlphone"}),u.jsxs("div",{className:"relative",children:[u.jsx(am,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx("input",{type:"tel",name:"phone",value:l.phone,onChange:d,className:"w-full bg-white/10 border border-white/20 rounded-xl py-2.5 pl-9 pr-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 text-sm",placeholder:"+216 XX XXX"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Entreprise"}),u.jsxs("div",{className:"relative",children:[u.jsx(em,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx("input",{type:"text",name:"company",value:l.company,onChange:d,className:"w-full bg-white/10 border border-white/20 rounded-xl py-2.5 pl-9 pr-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 text-sm",placeholder:"Startup"})]})]})]}),u.jsxs("label",{className:"flex items-start gap-2",children:[u.jsx("input",{type:"checkbox",checked:i,onChange:f=>s(f.target.checked),className:"rounded bg-white/10 border-white/20 text-cyan-500 mt-0.5"}),u.jsxs("span",{className:"text-xs text-gray-300",children:["J'accepte les ",u.jsx("a",{href:"#",className:"text-cyan-400 hover:underline",children:"conditions d'utilisation"})," et la ",u.jsx("a",{href:"#",className:"text-cyan-400 hover:underline",children:"politique de confidentialit"})]})]}),u.jsx("button",{type:"submit",disabled:r,className:"w-full py-3 bg-gradient-to-r from-cyan-500 to-purple-500 text-white font-semibold rounded-xl hover:opacity-90 transition-opacity disabled:opacity-50",children:r?"Cration...":"Crer mon compte"})]}),u.jsxs("div",{className:"flex items-center gap-4 my-5",children:[u.jsx("div",{className:"flex-1 h-px bg-white/20"}),u.jsx("span",{className:"text-xs text-gray-400",children:"ou"}),u.jsx("div",{className:"flex-1 h-px bg-white/20"})]}),u.jsx("div",{className:"flex justify-center",children:u.jsxs("button",{onClick:()=>{const f=`https://accounts.google.com/o/oauth2/v2/auth?client_id=${c1}&redirect_uri=${encodeURIComponent(window.location.origin+"/auth/google/callback")}&response_type=code&scope=openid%20email%20profile&access_type=offline`;window.location.href=f},className:"flex items-center gap-3 px-6 py-3 bg-white text-gray-700 font-medium rounded-full hover:bg-gray-100 transition-colors shadow-lg",children:[u.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[u.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),u.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),u.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),u.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"S'inscrire avec Google"]})}),u.jsxs("p",{className:"text-center text-gray-300 mt-6 text-sm",children:["Dj un compte ?"," ",u.jsx(Fe,{to:"/login",className:"text-cyan-400 hover:text-cyan-300 font-medium",children:"Se connecter"})]})]})})]})})},m6=()=>{const{user:e}=ur(),[t,n]=I.useState({projects:0,ideas:0,tasks:0,completedTasks:0}),[r,a]=I.useState([]),[o,i]=I.useState(!0);I.useEffect(()=>{s()},[]);const s=async()=>{try{const[d,h]=await Promise.all([ie.get("/projects"),ie.get("/ideas")]),f=d.data.projects||[],p=h.data.ideas||[];let v=0,g=0;f.forEach(y=>{v+=y.taskCount||0,g+=y.completedTasks||0}),n({projects:f.length,ideas:p.length,tasks:v,completedTasks:g}),a(f.slice(0,3))}catch(d){console.error("Error fetching dashboard data:",d)}finally{i(!1)}},l=[{title:"Projets",value:t.projects,icon:fi,color:"bg-blue-500",link:"/projects"},{title:"Ides sauvegardes",value:t.ideas,icon:Kr,color:"bg-yellow-500",link:"/ideas"},{title:"Tches compltes",value:`${t.completedTasks}/${t.tasks}`,icon:Tn,color:"bg-green-500",link:"/projects"},{title:"Progression",value:t.tasks>0?`${Math.round(t.completedTasks/t.tasks*100)}%`:"0%",icon:Oi,color:"bg-purple-500",link:"/projects"}],c=[{title:"Gnrer une ide",icon:Kr,href:"/ideas",color:"text-yellow-600 bg-yellow-100"},{title:"Nouveau projet",icon:Ua,href:"/projects",color:"text-blue-600 bg-blue-100"}];return o?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):u.jsxs("div",{className:"space-y-8",children:[u.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[u.jsxs("div",{children:[u.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:["Bonjour, ",e==null?void 0:e.firstName," ! "]}),u.jsx("p",{className:"text-gray-600 mt-1",children:"Voici un aperu de vos projets et activits."})]}),u.jsx("div",{className:"flex gap-3 mt-4 md:mt-0",children:c.map((d,h)=>u.jsxs(Fe,{to:d.href,className:`flex items-center gap-2 px-4 py-2 rounded-lg ${d.color} font-medium`,children:[u.jsx(d.icon,{className:"w-5 h-5"}),u.jsx("span",{children:d.title})]},h))})]}),u.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6",children:l.map((d,h)=>u.jsxs(Fe,{to:d.link,className:"card-hover",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("div",{className:`w-12 h-12 ${d.color} rounded-lg flex items-center justify-center`,children:u.jsx(d.icon,{className:"w-6 h-6 text-white"})}),u.jsx(jo,{className:"w-5 h-5 text-gray-400"})]}),u.jsx("h3",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:d.value}),u.jsx("p",{className:"text-gray-600 text-sm",children:d.title})]},h))}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Projets rcents"}),u.jsxs(Fe,{to:"/projects",className:"text-primary-600 hover:text-primary-700 text-sm font-medium flex items-center gap-1",children:["Voir tous",u.jsx(jo,{className:"w-4 h-4"})]})]}),r.length>0?u.jsx("div",{className:"grid md:grid-cols-3 gap-4",children:r.map(d=>u.jsxs(Fe,{to:`/projects/${d.id}`,className:"card-hover",children:[u.jsxs("div",{className:"flex items-start justify-between mb-3",children:[u.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center",children:u.jsx(fi,{className:"w-5 h-5 text-primary-600"})}),u.jsx("span",{className:`badge ${d.stage==="idea"?"badge-info":d.stage==="development"?"badge-warning":"badge-success"}`,children:d.stage==="idea"?"Ide":d.stage==="development"?"Dveloppement":"Lanc"})]}),u.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:d.name}),u.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:d.description||"Aucune description"}),u.jsxs("div",{className:"flex items-center gap-2 mt-4 text-xs text-gray-500",children:[u.jsx(Pi,{className:"w-4 h-4"}),u.jsxs("span",{children:["Modifi ",new Date(d.updatedAt).toLocaleDateString("fr-FR")]})]})]},d.id))}):u.jsxs("div",{className:"card text-center py-12",children:[u.jsx(fi,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),u.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun projet"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"Crez votre premier projet pour commencer."}),u.jsxs(Fe,{to:"/projects",className:"btn-primary inline-flex items-center gap-2",children:[u.jsx(Ua,{className:"w-5 h-5"}),"Crer un projet"]})]})]}),t.projects===0&&u.jsxs("div",{className:"card bg-gradient-to-r from-primary-50 to-accent-50 border-0",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Guide de dmarrage"}),u.jsx("div",{className:"grid md:grid-cols-4 gap-4",children:[{step:1,title:"Gnrez une ide",desc:"Utilisez notre gnrateur d'ides"},{step:2,title:"Crez un projet",desc:"Transformez votre ide en projet"},{step:3,title:"Business Model",desc:"Dfinissez votre modle conomique"},{step:4,title:"Business Plan",desc:"Crez votre plan d'affaires"}].map(d=>u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("div",{className:"w-8 h-8 rounded-full bg-primary-600 text-white flex items-center justify-center font-bold text-sm shrink-0",children:d.step}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-gray-900",children:d.title}),u.jsx("p",{className:"text-sm text-gray-600",children:d.desc})]})]},d.step))})]})]})},d1={free:{id:"free",name:"Gratuit",price:0,limits:{projects:1,ideas:10,teamMembers:1},features:{ideaGenerator:"basic",businessModelCanvas:!0,businessPlanPdf:!1,pitchDeck:!1,branding:!1,teamManagement:!1,exports:"limited",apiAccess:!1,whiteLabel:!1,prioritySupport:!1}},starter:{id:"starter",name:"Starter",price:29,limits:{projects:5,ideas:50,teamMembers:3},features:{ideaGenerator:"advanced",businessModelCanvas:!0,businessPlanPdf:!0,pitchDeck:!0,branding:!1,teamManagement:!1,exports:"limited",apiAccess:!1,whiteLabel:!1,prioritySupport:!1}},pro:{id:"pro",name:"Professionnel",price:79,limits:{projects:-1,ideas:-1,teamMembers:10},features:{ideaGenerator:"advanced",businessModelCanvas:!0,businessPlanPdf:!0,pitchDeck:!0,branding:!0,teamManagement:!0,exports:"unlimited",apiAccess:!1,whiteLabel:!1,prioritySupport:!0}},enterprise:{id:"enterprise",name:"Entreprise",price:199,limits:{projects:-1,ideas:-1,teamMembers:-1},features:{ideaGenerator:"advanced",businessModelCanvas:!0,businessPlanPdf:!0,pitchDeck:!0,branding:!0,teamManagement:!0,exports:"unlimited",apiAccess:!0,whiteLabel:!0,prioritySupport:!0}}},YC=e=>(d1[e]||d1.free).limits,v6=(e,t)=>{const n=YC(e);return n.projects===-1?!0:t<n.projects},g6=()=>{const{user:e}=ur(),[t,n]=I.useState([]),[r,a]=I.useState(!0),[o,i]=I.useState(""),[s,l]=I.useState(!1),[c,d]=I.useState(null),[h,f]=I.useState({name:"",description:"",industry:"",stage:"idea"}),p=(e==null?void 0:e.subscription)||"free",v=YC(p),g=v6(p,t.length);I.useEffect(()=>{y()},[]);const y=async()=>{try{const k=await ie.get("/projects");n(k.data.projects||[])}catch{V.error("Erreur lors du chargement des projets")}finally{a(!1)}},m=async k=>{var _,E;k.preventDefault();try{c?(await ie.put(`/projects/${c.id}`,h),V.success("Projet mis  jour")):(await ie.post("/projects",h),V.success("Projet cr avec succs")),y(),w()}catch(j){V.error(((E=(_=j.response)==null?void 0:_.data)==null?void 0:E.message)||"Erreur")}},x=async k=>{if(confirm("tes-vous sr de vouloir supprimer ce projet ?"))try{await ie.delete(`/projects/${k}`),V.success("Projet supprim"),y()}catch{V.error("Erreur lors de la suppression")}},b=(k=null)=>{k?(d(k),f({name:k.name,description:k.description||"",industry:k.industry||"",stage:k.stage||"idea"})):(d(null),f({name:"",description:"",industry:"",stage:"idea"})),l(!0)},w=()=>{l(!1),d(null),f({name:"",description:"",industry:"",stage:"idea"})},N=t.filter(k=>{var _;return k.name.toLowerCase().includes(o.toLowerCase())||((_=k.description)==null?void 0:_.toLowerCase().includes(o.toLowerCase()))}),C=[{value:"tech",label:"Technologie"},{value:"ecommerce",label:"E-commerce"},{value:"fintech",label:"Fintech"},{value:"health",label:"Sant"},{value:"food",label:"Agroalimentaire"},{value:"services",label:"Services"},{value:"education",label:"ducation"},{value:"other",label:"Autre"}],S=[{value:"idea",label:"Ide",color:"badge-info"},{value:"validation",label:"Validation",color:"badge-warning"},{value:"development",label:"Dveloppement",color:"badge-info"},{value:"launch",label:"Lancement",color:"badge-success"},{value:"growth",label:"Croissance",color:"badge-success"}];return r?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Mes Projets"}),u.jsxs("p",{className:"text-gray-600",children:["Grez tous vos projets de startup en un seul endroit.",v.projects!==-1&&u.jsxs("span",{className:"ml-2 text-sm",children:["(",t.length,"/",v.projects," projets)"]})]})]}),g?u.jsxs("button",{onClick:()=>b(),className:"btn-primary flex items-center gap-2",children:[u.jsx(Ua,{className:"w-5 h-5"}),"Nouveau projet"]}):u.jsxs(Fe,{to:"/pricing",className:"btn-secondary flex items-center gap-2",children:[u.jsx(_o,{className:"w-5 h-5"}),"Limite atteinte - Upgrader"]})]}),u.jsxs("div",{className:"relative max-w-md",children:[u.jsx(om,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"Rechercher un projet...",value:o,onChange:k=>i(k.target.value),className:"input-field pl-10"})]}),N.length>0?u.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:N.map(k=>{var _,E;return u.jsxs("div",{className:"card group relative",children:[k.role==="owner"&&u.jsx("div",{className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity",children:u.jsxs("div",{className:"flex gap-1",children:[u.jsx("button",{onClick:()=>b(k),className:"p-2 text-gray-500 hover:text-primary-600 hover:bg-gray-100 rounded-lg",children:u.jsx(im,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>x(k.id),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-gray-100 rounded-lg",children:u.jsx(Qa,{className:"w-4 h-4"})})]})}),u.jsxs(Fe,{to:`/projects/${k.id}`,children:[u.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[u.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center ${k.role!=="owner"?"bg-indigo-100":"bg-primary-100"}`,children:k.role!=="owner"?u.jsx(un,{className:"w-6 h-6 text-indigo-600"}):u.jsx(fi,{className:"w-6 h-6 text-primary-600"})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:k.name}),u.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[u.jsx("span",{className:`badge ${((_=S.find(j=>j.value===k.stage))==null?void 0:_.color)||"badge-info"}`,children:((E=S.find(j=>j.value===k.stage))==null?void 0:E.label)||k.stage}),k.role!=="owner"&&u.jsx("span",{className:"badge bg-indigo-100 text-indigo-700",children:k.role==="admin"?"Admin":k.role==="member"?"Membre":"Lecteur"})]})]})]}),u.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-4",children:k.description||"Aucune description"}),u.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 pt-4 border-t border-gray-100",children:[u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx(Tn,{className:"w-4 h-4"}),u.jsxs("span",{children:[k.completedTasks||0,"/",k.taskCount||0," tches"]})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx(Pi,{className:"w-4 h-4"}),u.jsx("span",{children:new Date(k.updatedAt).toLocaleDateString("fr-FR")})]})]})]})]},k.id)})}):u.jsxs("div",{className:"card text-center py-16",children:[u.jsx(fi,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),u.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:o?"Aucun projet trouv":"Aucun projet"}),u.jsx("p",{className:"text-gray-600 mb-6",children:o?"Essayez avec d'autres termes.":"Crez votre premier projet pour commencer."}),!o&&u.jsxs("button",{onClick:()=>b(),className:"btn-primary inline-flex items-center gap-2",children:[u.jsx(Ua,{className:"w-5 h-5"}),"Crer un projet"]})]}),s&&u.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg",children:[u.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[u.jsx("h2",{className:"text-xl font-semibold",children:c?"Modifier le projet":"Nouveau projet"}),u.jsx("button",{onClick:w,className:"text-gray-500 hover:text-gray-700",children:u.jsx(Cr,{className:"w-6 h-6"})})]}),u.jsxs("form",{onSubmit:m,className:"p-6 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom du projet *"}),u.jsx("input",{type:"text",value:h.name,onChange:k=>f({...h,name:k.target.value}),className:"input-field",placeholder:"Ma super startup",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),u.jsx("textarea",{value:h.description,onChange:k=>f({...h,description:k.target.value}),className:"input-field resize-none",rows:3,placeholder:"Dcrivez brivement votre projet..."})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Secteur d'activit"}),u.jsxs("select",{value:h.industry,onChange:k=>f({...h,industry:k.target.value}),className:"input-field",children:[u.jsx("option",{value:"",children:"Slectionner..."}),C.map(k=>u.jsx("option",{value:k.value,children:k.label},k.value))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"tape"}),u.jsx("select",{value:h.stage,onChange:k=>f({...h,stage:k.target.value}),className:"input-field",children:S.map(k=>u.jsx("option",{value:k.value,children:k.label},k.value))})]})]}),u.jsxs("div",{className:"flex gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:w,className:"btn-secondary flex-1",children:"Annuler"}),u.jsx("button",{type:"submit",className:"btn-primary flex-1",children:c?"Enregistrer":"Crer le projet"})]})]})]})})]})},x6=()=>{var f,p,v,g,y,m,x;const{id:e}=aa(),[t,n]=I.useState(null),[r,a]=I.useState(null),[o,i]=I.useState(!0);I.useEffect(()=>{s()},[e]);const s=async()=>{try{const[b,w]=await Promise.all([ie.get(`/projects/${e}`),ie.get(`/projects/${e}/stats`)]);n(b.data),a(w.data)}catch{V.error("Erreur lors du chargement du projet")}finally{i(!1)}},l=[{name:"Business Model",description:"Crez votre modle conomique avec le Business Model Canvas",icon:Sw,href:`/business-model/${e}`,color:"bg-blue-500",completed:t==null?void 0:t.businessModel},{name:"Branding",description:"Gnrez le nom, slogan et identit visuelle",icon:Ju,href:`/branding/${e}`,color:"bg-pink-500",completed:t==null?void 0:t.branding},{name:"Business Plan",description:"Crez votre plan d'affaires complet en PDF",icon:ww,href:`/business-plan/${e}`,color:"bg-green-500",completed:t==null?void 0:t.businessPlan},{name:"Pitch Deck",description:"Construisez une prsentation pour vos investisseurs",icon:Zu,href:`/pitch-deck/${e}`,color:"bg-purple-500",completed:t==null?void 0:t.pitchDeck},{name:"Gestion de Tches",description:"Grez vos tches avec un tableau Kanban",icon:wR,href:`/tasks/${e}`,color:"bg-orange-500",completed:!1},{name:"Membres d'quipe",description:"Grez votre quipe et assignez des tches",icon:un,href:`/team/${e}`,color:"bg-indigo-500",completed:!1}];if(o)return u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});if(!t)return u.jsxs("div",{className:"text-center py-16",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Projet non trouv"}),u.jsx(Fe,{to:"/projects",className:"text-primary-600 hover:underline mt-2 inline-block",children:"Retour aux projets"})]});((f=r==null?void 0:r.tasks)==null?void 0:f.total)>0&&Math.round(r.tasks.done/r.tasks.total*100);const c=[{name:"Business Model",done:(p=r==null?void 0:r.completion)==null?void 0:p.businessModel},{name:"Branding",done:(v=r==null?void 0:r.completion)==null?void 0:v.branding},{name:"Business Plan",done:(g=r==null?void 0:r.completion)==null?void 0:g.businessPlan},{name:"Pitch Deck",done:(y=r==null?void 0:r.completion)==null?void 0:y.pitchDeck}],d=c.filter(b=>b.done).length,h=Math.round(d/c.length*100);return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(Fe,{to:"/projects",className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:u.jsx(Ir,{className:"w-5 h-5"})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:t.project.name}),u.jsx("p",{className:"text-gray-600",children:t.project.description||"Aucune description"})]})]}),u.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[u.jsx("div",{className:"card",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:u.jsx(Oi,{className:"w-5 h-5 text-blue-600"})}),u.jsxs("div",{children:[u.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[h,"%"]}),u.jsx("p",{className:"text-sm text-gray-600",children:"Progression globale"})]})]})}),u.jsx("div",{className:"card",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:u.jsx(Tn,{className:"w-5 h-5 text-green-600"})}),u.jsxs("div",{children:[u.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[((m=r==null?void 0:r.tasks)==null?void 0:m.done)||0,"/",((x=r==null?void 0:r.tasks)==null?void 0:x.total)||0]}),u.jsx("p",{className:"text-sm text-gray-600",children:"Tches compltes"})]})]})}),u.jsx("div",{className:"card",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:u.jsx(un,{className:"w-5 h-5 text-purple-600"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(r==null?void 0:r.teamMembers)||0}),u.jsx("p",{className:"text-sm text-gray-600",children:"Membres d'quipe"})]})]})}),u.jsx("div",{className:"card",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:u.jsx(Pi,{className:"w-5 h-5 text-orange-600"})}),u.jsxs("div",{children:[u.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[d,"/4"]}),u.jsx("p",{className:"text-sm text-gray-600",children:"Documents crs"})]})]})})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Progression du projet"}),u.jsx("div",{className:"space-y-3",children:c.map((b,w)=>u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center ${b.done?"bg-green-500":"bg-gray-200"}`,children:b.done&&u.jsx(Tn,{className:"w-4 h-4 text-white"})}),u.jsx("span",{className:b.done?"text-gray-900":"text-gray-500",children:b.name})]},w))}),u.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100",children:[u.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[u.jsx("span",{className:"text-gray-600",children:"Progression globale"}),u.jsxs("span",{className:"font-medium text-gray-900",children:[h,"%"]})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-500",style:{width:`${h}%`}})})]})]}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Outils du projet"}),u.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map((b,w)=>u.jsxs(Fe,{to:b.href,className:"card-hover relative overflow-hidden",children:[b.completed&&u.jsx("div",{className:"absolute top-3 right-3",children:u.jsx("span",{className:"badge-success",children:"Complt"})}),u.jsx("div",{className:`w-12 h-12 ${b.color} rounded-xl flex items-center justify-center mb-4`,children:u.jsx(b.icon,{className:"w-6 h-6 text-white"})}),u.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:b.name}),u.jsx("p",{className:"text-sm text-gray-600",children:b.description})]},w))})]})]})},y6=()=>{const[e,t]=I.useState([]),[n,r]=I.useState([]),[a,o]=I.useState(!1),[i,s]=I.useState("generate"),[l,c]=I.useState({industry:"tech",interests:"",skills:"",budget:"medium"});I.useEffect(()=>{d()},[]);const d=async()=>{try{const x=await ie.get("/ideas");r(x.data.ideas||[])}catch(x){console.error("Error fetching ideas:",x)}},h=async()=>{o(!0);try{const x=await ie.post("/ideas/generate",l);t(x.data.ideas||[]),V.success("Ides gnres avec succs !")}catch{V.error("Erreur lors de la gnration")}finally{o(!1)}},f=async x=>{try{await ie.post("/ideas",x),V.success("Ide sauvegarde"),d()}catch{V.error("Erreur lors de la sauvegarde")}},p=async x=>{try{await ie.delete(`/ideas/${x}`),V.success("Ide supprime"),d()}catch{V.error("Erreur lors de la suppression")}},v=async x=>{try{await ie.put(`/ideas/${x}/favorite`),d()}catch{V.error("Erreur")}},g=async x=>{try{const b=await ie.post(`/ideas/${x}/to-project`);V.success("Projet cr avec succs !"),d()}catch{V.error("Erreur lors de la cration du projet")}},y=[{value:"tech",label:"Technologie"},{value:"ecommerce",label:"E-commerce"},{value:"fintech",label:"Fintech"},{value:"health",label:"Sant"},{value:"food",label:"Agroalimentaire"},{value:"services",label:"Services"},{value:"education",label:"ducation"}],m=[{value:"low",label:"Faible (< 10K TND)"},{value:"medium",label:"Moyen (10K - 50K TND)"},{value:"high",label:"lev (> 50K TND)"}];return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Gnrateur d'Ides"}),u.jsx("p",{className:"text-gray-600",children:"Trouvez l'ide de startup parfaite pour le march tunisien."})]}),u.jsxs("div",{className:"flex gap-2 border-b border-gray-200",children:[u.jsx("button",{onClick:()=>s("generate"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${i==="generate"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Gnrer des ides"}),u.jsxs("button",{onClick:()=>s("saved"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${i==="saved"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Ides sauvegardes (",n.length,")"]})]}),i==="generate"?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"card",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Paramtres de gnration"}),u.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Secteur d'activit"}),u.jsx("select",{value:l.industry,onChange:x=>c({...l,industry:x.target.value}),className:"input-field",children:y.map(x=>u.jsx("option",{value:x.value,children:x.label},x.value))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Budget initial"}),u.jsx("select",{value:l.budget,onChange:x=>c({...l,budget:x.target.value}),className:"input-field",children:m.map(x=>u.jsx("option",{value:x.value,children:x.label},x.value))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vos intrts (optionnel)"}),u.jsx("input",{type:"text",value:l.interests,onChange:x=>c({...l,interests:x.target.value}),className:"input-field",placeholder:"ex: innovation, durabilit, digital"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vos comptences (optionnel)"}),u.jsx("input",{type:"text",value:l.skills,onChange:x=>c({...l,skills:x.target.value}),className:"input-field",placeholder:"ex: dveloppement, marketing, finance"})]})]}),u.jsx("button",{onClick:h,disabled:a,className:"btn-primary mt-6 flex items-center gap-2",children:a?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Gnration en cours..."]}):u.jsxs(u.Fragment,{children:[u.jsx(pi,{className:"w-5 h-5"}),"Gnrer des ides"]})})]}),e.length>0&&u.jsxs("div",{className:"space-y-4",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Ides gnres"}),u.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:e.map((x,b)=>u.jsxs("div",{className:"card",children:[u.jsxs("div",{className:"flex items-start justify-between mb-3",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Kr,{className:"w-5 h-5 text-yellow-500"}),u.jsxs("span",{className:"font-medium text-gray-500 text-sm",children:["Score: ",x.score,"/100"]})]}),u.jsx("button",{onClick:()=>f(x),className:"p-2 text-gray-500 hover:text-primary-600 hover:bg-primary-50 rounded-lg",children:u.jsx(Ki,{className:"w-5 h-5"})})]}),u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:x.title}),u.jsx("p",{className:"text-gray-600 text-sm mb-4",children:x.description}),u.jsxs("div",{className:"space-y-2 text-sm",children:[u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsx(sm,{className:"w-4 h-4 text-red-500 mt-0.5"}),u.jsxs("div",{children:[u.jsx("span",{className:"font-medium text-gray-700",children:"Problme:"}),u.jsx("p",{className:"text-gray-600",children:x.problem})]})]}),u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsx(Oi,{className:"w-4 h-4 text-green-500 mt-0.5"}),u.jsxs("div",{children:[u.jsx("span",{className:"font-medium text-gray-700",children:"Solution:"}),u.jsx("p",{className:"text-gray-600",children:x.solution})]})]}),u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsx(un,{className:"w-4 h-4 text-blue-500 mt-0.5"}),u.jsxs("div",{children:[u.jsx("span",{className:"font-medium text-gray-700",children:"Cible:"}),u.jsx("p",{className:"text-gray-600",children:x.targetMarket})]})]})]}),x.viability&&u.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100",children:[u.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Viabilit"}),u.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:"text-lg font-bold text-green-600",children:[x.viability.market,"%"]}),u.jsx("div",{className:"text-xs text-gray-500",children:"March"})]}),u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:"text-lg font-bold text-yellow-600",children:[x.viability.competition,"%"]}),u.jsx("div",{className:"text-xs text-gray-500",children:"Concurrence"})]}),u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[x.viability.implementation,"%"]}),u.jsx("div",{className:"text-xs text-gray-500",children:"Faisabilit"})]})]})]})]},b))})]})]}):u.jsx("div",{className:"space-y-4",children:n.length>0?u.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:n.map(x=>u.jsxs("div",{className:"card",children:[u.jsxs("div",{className:"flex items-start justify-between mb-3",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Kr,{className:"w-5 h-5 text-yellow-500"}),x.projectName&&u.jsxs("span",{className:"badge-success",children:["Projet: ",x.projectName]})]}),u.jsxs("div",{className:"flex gap-1",children:[u.jsx("button",{onClick:()=>v(x.id),className:`p-2 rounded-lg ${x.isFavorite?"text-yellow-500":"text-gray-400 hover:text-yellow-500"}`,children:x.isFavorite?u.jsx(ka,{className:"w-5 h-5 fill-current"}):u.jsx(PR,{className:"w-5 h-5"})}),u.jsx("button",{onClick:()=>p(x.id),className:"p-2 text-gray-400 hover:text-red-500 rounded-lg",children:u.jsx(Qa,{className:"w-5 h-5"})})]})]}),u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:x.title}),u.jsx("p",{className:"text-gray-600 text-sm mb-4",children:x.description}),x.problem&&u.jsxs("div",{className:"text-sm mb-2",children:[u.jsx("span",{className:"font-medium text-gray-700",children:"Problme:"}),u.jsx("p",{className:"text-gray-600",children:x.problem})]}),!x.projectId&&u.jsxs("button",{onClick:()=>g(x.id),className:"btn-primary w-full mt-4 flex items-center justify-center gap-2",children:["Crer un projet",u.jsx(jo,{className:"w-4 h-4"})]})]},x.id))}):u.jsxs("div",{className:"card text-center py-12",children:[u.jsx(Kr,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),u.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune ide sauvegarde"}),u.jsx("p",{className:"text-gray-600",children:"Gnrez des ides et sauvegardez vos prfres."})]})})]})},b6=()=>{const{projectId:e}=aa(),[t,n]=I.useState(!0),[r,a]=I.useState(!1),[o,i]=I.useState(null),[s,l]=I.useState([]),[c,d]=I.useState("saas"),[h,f]=I.useState({keyPartners:"",keyActivities:"",keyResources:"",valuePropositions:"",customerRelationships:"",channels:"",customerSegments:"",costStructure:"",revenueStreams:""});I.useEffect(()=>{p()},[e]);const p=async()=>{try{const[x,b,w]=await Promise.all([ie.get(`/projects/${e}`),ie.get(`/business-model/project/${e}`),ie.get("/business-model/templates")]);i(x.data.project),l(w.data.templates||[]),b.data.businessModel&&f(b.data.businessModel)}catch{V.error("Erreur lors du chargement")}finally{n(!1)}},v=async()=>{try{const x=await ie.post("/business-model/generate",{projectId:e,template:c});f(x.data.businessModel),V.success("Template appliqu !")}catch{V.error("Erreur")}},g=async()=>{a(!0);try{await ie.post(`/business-model/project/${e}`,h),V.success("Business Model sauvegard")}catch{V.error("Erreur lors de la sauvegarde")}finally{a(!1)}},y=(x,b)=>{f({...h,[x]:b})},m=[{key:"keyPartners",label:"Partenaires Cls",description:"Qui sont vos partenaires et fournisseurs cls ?",color:"bg-blue-50 border-blue-200"},{key:"keyActivities",label:"Activits Cls",description:"Quelles activits cls votre proposition de valeur requiert-elle ?",color:"bg-green-50 border-green-200"},{key:"keyResources",label:"Ressources Cls",description:"Quelles ressources cls votre proposition de valeur requiert-elle ?",color:"bg-yellow-50 border-yellow-200"},{key:"valuePropositions",label:"Proposition de Valeur",description:"Quelle valeur apportez-vous au client ?",color:"bg-red-50 border-red-200"},{key:"customerRelationships",label:"Relations Clients",description:"Quel type de relation chaque segment client attend-il ?",color:"bg-purple-50 border-purple-200"},{key:"channels",label:"Canaux",description:"Par quels canaux vos segments clients veulent-ils tre atteints ?",color:"bg-indigo-50 border-indigo-200"},{key:"customerSegments",label:"Segments Clients",description:"Pour qui crez-vous de la valeur ?",color:"bg-pink-50 border-pink-200"},{key:"costStructure",label:"Structure de Cots",description:"Quels sont les cots les plus importants de votre modle ?",color:"bg-orange-50 border-orange-200"},{key:"revenueStreams",label:"Flux de Revenus",description:"Pour quelle valeur vos clients sont-ils prts  payer ?",color:"bg-teal-50 border-teal-200"}];return t?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(Fe,{to:`/projects/${e}`,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:u.jsx(Ir,{className:"w-5 h-5"})}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Business Model Canvas"}),u.jsx("p",{className:"text-gray-600",children:o==null?void 0:o.name})]})]}),u.jsx("div",{className:"flex gap-3",children:u.jsxs("button",{onClick:g,disabled:r,className:"btn-primary flex items-center gap-2",children:[u.jsx(Ki,{className:"w-5 h-5"}),r?"Sauvegarde...":"Sauvegarder"]})})]}),u.jsx("div",{className:"card",children:u.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Appliquer un template"}),u.jsx("select",{value:c,onChange:x=>d(x.target.value),className:"input-field",children:s.map(x=>u.jsxs("option",{value:x.id,children:[x.name," - ",x.description]},x.id))})]}),u.jsxs("button",{onClick:v,className:"btn-secondary flex items-center gap-2 md:mt-7",children:[u.jsx(RR,{className:"w-5 h-5"}),"Appliquer"]})]})}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[u.jsxs("div",{className:`card border-2 ${m[0].color}`,children:[u.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:m[0].label}),u.jsx("p",{className:"text-xs text-gray-500 mb-3",children:m[0].description}),u.jsx("textarea",{value:h.keyPartners,onChange:x=>y("keyPartners",x.target.value),className:"w-full h-32 p-2 text-sm border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Listez vos partenaires cls..."})]}),u.jsxs("div",{className:"md:col-span-1 space-y-4",children:[u.jsxs("div",{className:`card border-2 ${m[1].color}`,children:[u.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:m[1].label}),u.jsx("p",{className:"text-xs text-gray-500 mb-3",children:m[1].description}),u.jsx("textarea",{value:h.keyActivities,onChange:x=>y("keyActivities",x.target.value),className:"w-full h-20 p-2 text-sm border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500",placeholder:"Vos activits principales..."})]}),u.jsxs("div",{className:`card border-2 ${m[2].color}`,children:[u.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:m[2].label}),u.jsx("p",{className:"text-xs text-gray-500 mb-3",children:m[2].description}),u.jsx("textarea",{value:h.keyResources,onChange:x=>y("keyResources",x.target.value),className:"w-full h-20 p-2 text-sm border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500",placeholder:"Vos ressources principales..."})]})]}),u.jsxs("div",{className:`card border-2 ${m[3].color}`,children:[u.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:m[3].label}),u.jsx("p",{className:"text-xs text-gray-500 mb-3",children:m[3].description}),u.jsx("textarea",{value:h.valuePropositions,onChange:x=>y("valuePropositions",x.target.value),className:"w-full h-32 p-2 text-sm border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500",placeholder:"Votre proposition de valeur..."})]}),u.jsxs("div",{className:"md:col-span-1 space-y-4",children:[u.jsxs("div",{className:`card border-2 ${m[4].color}`,children:[u.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:m[4].label}),u.jsx("p",{className:"text-xs text-gray-500 mb-3",children:m[4].description}),u.jsx("textarea",{value:h.customerRelationships,onChange:x=>y("customerRelationships",x.target.value),className:"w-full h-20 p-2 text-sm border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500",placeholder:"Type de relations..."})]}),u.jsxs("div",{className:`card border-2 ${m[5].color}`,children:[u.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:m[5].label}),u.jsx("p",{className:"text-xs text-gray-500 mb-3",children:m[5].description}),u.jsx("textarea",{value:h.channels,onChange:x=>y("channels",x.target.value),className:"w-full h-20 p-2 text-sm border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500",placeholder:"Vos canaux de distribution..."})]})]}),u.jsxs("div",{className:`card border-2 ${m[6].color}`,children:[u.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:m[6].label}),u.jsx("p",{className:"text-xs text-gray-500 mb-3",children:m[6].description}),u.jsx("textarea",{value:h.customerSegments,onChange:x=>y("customerSegments",x.target.value),className:"w-full h-32 p-2 text-sm border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500",placeholder:"Vos segments de clients..."})]}),u.jsxs("div",{className:`md:col-span-2 card border-2 ${m[7].color}`,children:[u.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:m[7].label}),u.jsx("p",{className:"text-xs text-gray-500 mb-3",children:m[7].description}),u.jsx("textarea",{value:h.costStructure,onChange:x=>y("costStructure",x.target.value),className:"w-full h-24 p-2 text-sm border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500",placeholder:"Vos principaux cots..."})]}),u.jsxs("div",{className:`md:col-span-3 card border-2 ${m[8].color}`,children:[u.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:m[8].label}),u.jsx("p",{className:"text-xs text-gray-500 mb-3",children:m[8].description}),u.jsx("textarea",{value:h.revenueStreams,onChange:x=>y("revenueStreams",x.target.value),className:"w-full h-24 p-2 text-sm border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500",placeholder:"Vos sources de revenus..."})]})]})]})},w6=()=>{var E;const{projectId:e}=aa(),[t,n]=I.useState(!0),[r,a]=I.useState(!1),[o,i]=I.useState(null),[s,l]=I.useState([]),[c,d]=I.useState([]),[h,f]=I.useState([]),[p,v]=I.useState([]),[g,y]=I.useState({companyName:"",slogan:"",logoUrl:"",logoStyle:null,primaryColor:"#0ea5e9",secondaryColor:"#d946ef",fontFamily:"Inter",brandVoice:""}),[m,x]=I.useState(null);I.useEffect(()=>{b()},[e]);const b=async()=>{try{const[j,T,L]=await Promise.all([ie.get(`/projects/${e}`),ie.get(`/branding/project/${e}`),ie.get("/branding/colors")]);i(j.data.project),v(L.data.colorPalettes||[]),T.data.branding&&y(T.data.branding)}catch{V.error("Erreur lors du chargement")}finally{n(!1)}},w=async()=>{try{const j=await ie.post("/branding/generate-names",{industry:o==null?void 0:o.industry,keywords:g.companyName});l(j.data.names||[]),V.success("Noms gnrs !")}catch{V.error("Erreur")}},N=async()=>{if(!g.companyName){V.error("Entrez d'abord un nom d'entreprise");return}try{const j=await ie.post("/branding/generate-slogans",{companyName:g.companyName,industry:o==null?void 0:o.industry});d(j.data.slogans||[]),V.success("Slogans gnrs !")}catch{V.error("Erreur")}},C=async()=>{if(!g.companyName){V.error("Entrez d'abord un nom d'entreprise");return}try{const j=await ie.post("/branding/generate-logo",{companyName:g.companyName,industry:o==null?void 0:o.industry});f(j.data.logoSuggestions||[]),V.success("Suggestions de logo gnres !")}catch{V.error("Erreur")}},S=async()=>{a(!0);try{await ie.post(`/branding/project/${e}`,g),V.success("Branding sauvegard")}catch{V.error("Erreur lors de la sauvegarde")}finally{a(!1)}},k=["Inter","Roboto","Open Sans","Lato","Montserrat","Poppins","Raleway","Playfair Display","Merriweather"],_=(j,T)=>{const L=(T==null?void 0:T.substring(0,2).toUpperCase())||"SU",P=(T==null?void 0:T.charAt(0).toUpperCase())||"S";switch(j.logoType){case"monogram":return u.jsx("div",{className:"w-16 h-16 mx-auto mb-3 rounded-xl flex items-center justify-center text-white font-bold text-2xl",style:{backgroundColor:j.colors.primary},children:L});case"abstract":return u.jsxs("div",{className:"w-16 h-16 mx-auto mb-3 relative",children:[u.jsx("div",{className:"absolute inset-0 rounded-full opacity-80",style:{backgroundColor:j.colors.primary}}),u.jsx("div",{className:"absolute inset-2 rounded-full",style:{backgroundColor:j.colors.secondary}}),u.jsx("div",{className:"absolute inset-4 rounded-full bg-white flex items-center justify-center font-bold",style:{color:j.colors.primary},children:P})]});case"geometric":return u.jsxs("div",{className:"w-16 h-16 mx-auto mb-3 relative flex items-center justify-center",children:[u.jsx("div",{className:"absolute w-12 h-12 rotate-45",style:{backgroundColor:j.colors.primary}}),u.jsx("span",{className:"relative z-10 text-white font-bold text-xl",children:P})]});case"gradient":return u.jsx("div",{className:"w-16 h-16 mx-auto mb-3 rounded-2xl flex items-center justify-center text-white font-bold text-2xl",style:{background:`linear-gradient(135deg, ${j.colors.primary}, ${j.colors.secondary})`},children:L});case"outline":return u.jsx("div",{className:"w-16 h-16 mx-auto mb-3 rounded-xl flex items-center justify-center font-bold text-2xl border-4",style:{borderColor:j.colors.primary,color:j.colors.primary},children:L});case"circle":return u.jsx("div",{className:"w-16 h-16 mx-auto mb-3 rounded-full flex items-center justify-center text-white font-bold text-2xl",style:{backgroundColor:j.colors.primary},children:L});case"hexagon":return u.jsx("div",{className:"w-16 h-16 mx-auto mb-3 flex items-center justify-center",children:u.jsxs("svg",{viewBox:"0 0 100 100",className:"w-full h-full",children:[u.jsx("polygon",{points:"50,5 95,27.5 95,72.5 50,95 5,72.5 5,27.5",fill:j.colors.primary}),u.jsx("text",{x:"50",y:"58",textAnchor:"middle",fill:"white",fontSize:"28",fontWeight:"bold",children:L})]})});case"shield":return u.jsx("div",{className:"w-16 h-16 mx-auto mb-3 flex items-center justify-center",children:u.jsxs("svg",{viewBox:"0 0 100 120",className:"w-full h-full",children:[u.jsx("path",{d:"M50,5 L95,20 L95,60 Q95,100 50,115 Q5,100 5,60 L5,20 Z",fill:j.colors.primary}),u.jsx("text",{x:"50",y:"70",textAnchor:"middle",fill:"white",fontSize:"28",fontWeight:"bold",children:L})]})});case"wave":return u.jsxs("div",{className:"w-16 h-16 mx-auto mb-3 rounded-xl flex items-center justify-center text-white font-bold text-2xl overflow-hidden relative",style:{backgroundColor:j.colors.primary},children:[u.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-6 opacity-50",style:{backgroundColor:j.colors.secondary,borderRadius:"100% 100% 0 0"}}),u.jsx("span",{className:"relative z-10",children:L})]});case"minimal":return u.jsxs("div",{className:"w-16 h-16 mx-auto mb-3 flex items-center justify-center",children:[u.jsx("span",{className:"text-4xl font-light",style:{color:j.colors.primary},children:P}),u.jsx("div",{className:"w-2 h-2 rounded-full ml-1",style:{backgroundColor:j.colors.secondary}})]});default:return u.jsx("div",{className:"w-16 h-16 mx-auto mb-3 rounded-xl flex items-center justify-center text-white font-bold text-2xl",style:{backgroundColor:j.colors.primary},children:L})}};return t?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(Fe,{to:`/projects/${e}`,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:u.jsx(Ir,{className:"w-5 h-5"})}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Branding"}),u.jsx("p",{className:"text-gray-600",children:o==null?void 0:o.name})]})]}),u.jsxs("button",{onClick:S,disabled:r,className:"btn-primary flex items-center gap-2",children:[u.jsx(Ki,{className:"w-5 h-5"}),r?"Sauvegarde...":"Sauvegarder"]})]}),u.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"card",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx(_w,{className:"w-5 h-5 text-primary-600"}),u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Nom de l'entreprise"})]}),u.jsx("input",{type:"text",value:g.companyName,onChange:j=>y({...g,companyName:j.target.value}),className:"input-field mb-4",placeholder:"Nom de votre startup"}),u.jsxs("button",{onClick:w,className:"btn-secondary flex items-center gap-2 mb-4",children:[u.jsx(pi,{className:"w-4 h-4"}),"Gnrer des suggestions"]}),s.length>0&&u.jsx("div",{className:"flex flex-wrap gap-2",children:s.map((j,T)=>u.jsx("button",{onClick:()=>y({...g,companyName:j}),className:"px-3 py-1.5 bg-gray-100 hover:bg-primary-100 hover:text-primary-700 rounded-full text-sm transition-colors",children:j},T))})]}),u.jsxs("div",{className:"card",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx(CR,{className:"w-5 h-5 text-primary-600"}),u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Slogan"})]}),u.jsx("input",{type:"text",value:g.slogan,onChange:j=>y({...g,slogan:j.target.value}),className:"input-field mb-4",placeholder:"Votre slogan accrocheur"}),u.jsxs("button",{onClick:N,className:"btn-secondary flex items-center gap-2 mb-4",children:[u.jsx(pi,{className:"w-4 h-4"}),"Gnrer des slogans"]}),c.length>0&&u.jsx("div",{className:"space-y-2",children:c.map((j,T)=>u.jsx("button",{onClick:()=>y({...g,slogan:j}),className:"block w-full text-left px-3 py-2 bg-gray-100 hover:bg-primary-100 hover:text-primary-700 rounded-lg text-sm transition-colors",children:j},T))})]}),u.jsxs("div",{className:"card",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx(Ju,{className:"w-5 h-5 text-primary-600"}),u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Couleurs"})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Couleur principale"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"color",value:g.primaryColor,onChange:j=>y({...g,primaryColor:j.target.value}),className:"w-12 h-10 rounded cursor-pointer"}),u.jsx("input",{type:"text",value:g.primaryColor,onChange:j=>y({...g,primaryColor:j.target.value}),className:"input-field flex-1"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Couleur secondaire"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"color",value:g.secondaryColor,onChange:j=>y({...g,secondaryColor:j.target.value}),className:"w-12 h-10 rounded cursor-pointer"}),u.jsx("input",{type:"text",value:g.secondaryColor,onChange:j=>y({...g,secondaryColor:j.target.value}),className:"input-field flex-1"})]})]})]}),u.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Palettes suggres:"}),u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:p.map((j,T)=>u.jsxs("button",{onClick:()=>y({...g,primaryColor:j.primary,secondaryColor:j.secondary}),className:"p-2 border border-gray-200 rounded-lg hover:border-primary-500 transition-colors",children:[u.jsxs("div",{className:"flex gap-1 mb-1",children:[u.jsx("div",{className:"w-6 h-6 rounded",style:{backgroundColor:j.primary}}),u.jsx("div",{className:"w-6 h-6 rounded",style:{backgroundColor:j.secondary}}),u.jsx("div",{className:"w-6 h-6 rounded",style:{backgroundColor:j.accent}})]}),u.jsx("p",{className:"text-xs text-gray-600",children:j.name})]},T))})]}),u.jsxs("div",{className:"card",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Typographie"}),u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Police principale"}),u.jsx("select",{value:g.fontFamily,onChange:j=>y({...g,fontFamily:j.target.value}),className:"input-field mb-4",children:k.map(j=>u.jsx("option",{value:j,children:j},j))}),u.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",style:{fontFamily:g.fontFamily},children:[u.jsx("p",{className:"text-2xl font-bold mb-2",style:{color:g.primaryColor},children:g.companyName||"Votre Startup"}),u.jsx("p",{className:"text-gray-600",children:g.slogan||"Votre slogan ici"})]})]}),u.jsxs("div",{className:"card lg:col-span-2",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Suggestions de Logo"}),u.jsxs("button",{onClick:C,className:"btn-secondary flex items-center gap-2",children:[u.jsx(pi,{className:"w-4 h-4"}),"Gnrer des ides"]})]}),h.length>0?u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:h.map((j,T)=>u.jsxs("button",{onClick:()=>{x(T),y({...g,logoStyle:j,primaryColor:j.colors.primary,secondaryColor:j.colors.secondary}),V.success(`Style "${j.type}" slectionn !`)},className:`p-4 rounded-xl text-center transition-all cursor-pointer hover:scale-105 h-40 flex flex-col items-center justify-center ${m===T?"ring-2 ring-primary-500 bg-primary-50 shadow-lg":"bg-gray-50 hover:bg-gray-100 border border-gray-200"}`,children:[u.jsx("div",{className:"flex-1 flex items-center justify-center w-full",children:_(j,g.companyName)}),u.jsxs("div",{className:"mt-auto pt-2",children:[u.jsx("p",{className:"font-medium text-gray-900 text-sm",children:j.type}),u.jsx("p",{className:"text-xs text-gray-500",children:j.style})]})]},T))}):u.jsxs("div",{className:"text-center py-8 text-gray-500",children:[u.jsx(Ju,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),u.jsx("p",{children:'Cliquez sur "Gnrer des ides" pour obtenir des suggestions de logo'})]})]}),u.jsxs("div",{className:"card lg:col-span-2",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Voix de la Marque"}),u.jsx("textarea",{value:g.brandVoice,onChange:j=>y({...g,brandVoice:j.target.value}),className:"input-field resize-none",rows:4,placeholder:"Dcrivez le ton et la personnalit de votre marque. Ex: Professionnel mais accessible, innovant, proche des clients..."})]})]}),u.jsxs("div",{className:"card",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Aperu"}),u.jsxs("div",{className:"p-8 rounded-xl text-center",style:{background:`linear-gradient(135deg, ${g.primaryColor}15, ${g.secondaryColor}15)`,fontFamily:g.fontFamily},children:[u.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-2xl flex items-center justify-center text-white font-bold text-3xl",style:{backgroundColor:g.primaryColor},children:((E=g.companyName)==null?void 0:E.substring(0,2).toUpperCase())||"SU"}),u.jsx("h3",{className:"text-3xl font-bold mb-2",style:{color:g.primaryColor},children:g.companyName||"Nom de votre startup"}),u.jsx("p",{className:"text-lg",style:{color:g.secondaryColor},children:g.slogan||"Votre slogan accrocheur"})]})]})]})},N6=()=>{const{projectId:e}=aa(),[t,n]=I.useState(!0),[r,a]=I.useState(!1),[o,i]=I.useState(!1),[s,l]=I.useState(null),[c,d]=I.useState({executiveSummary:"",companyDescription:"",marketAnalysis:"",organization:"",productLine:"",marketing:"",fundingRequest:"",financialProjections:"",appendix:""});I.useEffect(()=>{h()},[e]);const h=async()=>{try{const[m,x,b]=await Promise.all([ie.get(`/projects/${e}`),ie.get(`/business-plan/project/${e}`),ie.get("/business-plan/template")]);l(m.data.project),x.data.businessPlan?d(x.data.businessPlan):b.data.template&&d(b.data.template)}catch{V.error("Erreur lors du chargement")}finally{n(!1)}},f=async()=>{a(!0);try{await ie.post(`/business-plan/project/${e}`,c),V.success("Business Plan sauvegard")}catch{V.error("Erreur lors de la sauvegarde")}finally{a(!1)}},p=async()=>{i(!0);try{await ie.post(`/business-plan/project/${e}`,c);const m=await ie.post(`/business-plan/project/${e}/pdf`);V.success("PDF gnr avec succs !"),window.open(`http://localhost:5000${m.data.pdfUrl}`,"_blank")}catch{V.error("Erreur lors de la gnration du PDF")}finally{i(!1)}},v=[{key:"executiveSummary",title:"Rsum Excutif",icon:""},{key:"companyDescription",title:"Description de l'Entreprise",icon:""},{key:"marketAnalysis",title:"Analyse de March",icon:""},{key:"organization",title:"Organisation et Gestion",icon:""},{key:"productLine",title:"Produits et Services",icon:""},{key:"marketing",title:"Stratgie Marketing",icon:""},{key:"fundingRequest",title:"Demande de Financement",icon:""},{key:"financialProjections",title:"Projections Financires",icon:""},{key:"appendix",title:"Annexes",icon:""}],[g,y]=I.useState("executiveSummary");return t?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(Fe,{to:`/projects/${e}`,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:u.jsx(Ir,{className:"w-5 h-5"})}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Business Plan"}),u.jsx("p",{className:"text-gray-600",children:s==null?void 0:s.name})]})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsxs("button",{onClick:f,disabled:r,className:"btn-secondary flex items-center gap-2",children:[u.jsx(Ki,{className:"w-5 h-5"}),r?"Sauvegarde...":"Sauvegarder"]}),u.jsxs("button",{onClick:p,disabled:o,className:"btn-primary flex items-center gap-2",children:[u.jsx(iR,{className:"w-5 h-5"}),o?"Gnration...":"Gnrer PDF"]})]})]}),u.jsxs("div",{className:"grid lg:grid-cols-4 gap-6",children:[u.jsx("div",{className:"lg:col-span-1",children:u.jsxs("div",{className:"card sticky top-24",children:[u.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[u.jsx(Q_,{className:"w-5 h-5"}),"Sections"]}),u.jsx("nav",{className:"space-y-1",children:v.map(m=>u.jsxs("button",{onClick:()=>y(m.key),className:`w-full text-left px-3 py-2 rounded-lg text-sm transition-colors flex items-center gap-2 ${g===m.key?"bg-primary-50 text-primary-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[u.jsx("span",{children:m.icon}),u.jsx("span",{children:m.title}),c[m.key]&&c[m.key].length>50&&u.jsx("span",{className:"ml-auto w-2 h-2 bg-green-500 rounded-full"})]},m.key))})]})}),u.jsx("div",{className:"lg:col-span-3",children:v.map(m=>{var x;return u.jsx("div",{className:g===m.key?"block":"hidden",children:u.jsxs("div",{className:"card",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[u.jsx("span",{className:"text-2xl",children:m.icon}),u.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:m.title})]}),u.jsx("textarea",{value:c[m.key],onChange:b=>d({...c,[m.key]:b.target.value}),className:"input-field resize-none min-h-[400px]",placeholder:`Rdigez votre ${m.title.toLowerCase()} ici...`}),u.jsxs("div",{className:"flex justify-between items-center mt-4 pt-4 border-t border-gray-100",children:[u.jsxs("p",{className:"text-sm text-gray-500",children:[((x=c[m.key])==null?void 0:x.length)||0," caractres"]}),u.jsxs("div",{className:"flex gap-2",children:[v.findIndex(b=>b.key===g)>0&&u.jsx("button",{onClick:()=>y(v[v.findIndex(b=>b.key===g)-1].key),className:"btn-secondary text-sm",children:" Prcdent"}),v.findIndex(b=>b.key===g)<v.length-1&&u.jsx("button",{onClick:()=>y(v[v.findIndex(b=>b.key===g)+1].key),className:"btn-primary text-sm",children:"Suivant "})]})]})]})},m.key)})})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Progression"}),u.jsx("div",{className:"grid grid-cols-3 md:grid-cols-9 gap-2",children:v.map(m=>{const x=c[m.key]&&c[m.key].length>50;return u.jsxs("div",{className:`p-2 rounded-lg text-center ${x?"bg-green-100":"bg-gray-100"}`,children:[u.jsx("span",{className:"text-lg",children:m.icon}),u.jsx("p",{className:`text-xs mt-1 ${x?"text-green-700":"text-gray-500"}`,children:x?"":"-"})]},m.key)})}),u.jsxs("p",{className:"text-sm text-gray-600 mt-4",children:[v.filter(m=>c[m.key]&&c[m.key].length>50).length," / ",v.length," sections compltes"]})]})]})},C6=()=>{var he,ye,we,ke,Ie,Ee,Ke,Te,Ae,Q,Ce,_e,Le,Ye,pt,mt,zt,$t;const{projectId:e}=aa(),[t,n]=I.useState(!0),[r,a]=I.useState(!1),[o,i]=I.useState(null),[s,l]=I.useState([]),[c,d]=I.useState(null),[h,f]=I.useState([]),[p,v]=I.useState(0),[g,y]=I.useState(null),[m,x]=I.useState(!1),[b,w]=I.useState(null),[N,C]=I.useState(!1),[S,k]=I.useState("images"),_=I.useRef(null),E=[{id:"minimal",name:"Minimal",colors:{bg:"#FFFFFF",text:"#1F2937",accent:"#6366F1"}},{id:"dark",name:"Sombre",colors:{bg:"#1F2937",text:"#FFFFFF",accent:"#F59E0B"}},{id:"gradient-blue",name:"Dgrad Bleu",colors:{bg:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",text:"#FFFFFF",accent:"#FBBF24"}},{id:"gradient-sunset",name:"Coucher de soleil",colors:{bg:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",text:"#FFFFFF",accent:"#FDE68A"}},{id:"gradient-ocean",name:"Ocan",colors:{bg:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",text:"#FFFFFF",accent:"#1E3A8A"}},{id:"gradient-forest",name:"Fort",colors:{bg:"linear-gradient(135deg, #11998e 0%, #38ef7d 100%)",text:"#FFFFFF",accent:"#064E3B"}},{id:"corporate",name:"Corporate",colors:{bg:"#F3F4F6",text:"#111827",accent:"#2563EB"}},{id:"creative",name:"Cratif",colors:{bg:"#FDF4FF",text:"#701A75",accent:"#D946EF"}}],j=[{id:"rocket",icon:Ar,label:"Fuse"},{id:"star",icon:ka,label:"toile"},{id:"heart",icon:kw,label:"Cur"},{id:"zap",icon:Dw,label:"clair"},{id:"award",icon:yw,label:"Trophe"},{id:"target",icon:sm,label:"Cible"}];I.useEffect(()=>{T()},[e]),I.useEffect(()=>{const te=oe=>{m&&(oe.key==="ArrowRight"||oe.key===" "?v(Ne=>Math.min(h.length-1,Ne+1)):oe.key==="ArrowLeft"?v(Ne=>Math.max(0,Ne-1)):oe.key==="Escape"&&x(!1))};return window.addEventListener("keydown",te),()=>window.removeEventListener("keydown",te)},[m,h.length]);const T=async()=>{try{const[te,oe,Ne]=await Promise.all([ie.get(`/projects/${e}`),ie.get(`/pitch-deck/project/${e}`),ie.get("/pitch-deck/templates")]);i(te.data.project),l(Ne.data.templates||[]),oe.data.pitchDeck&&(d(oe.data.pitchDeck),f(oe.data.pitchDeck.slides||[]))}catch{V.error("Erreur lors du chargement")}finally{n(!1)}},L=async te=>{try{const oe=await ie.post(`/pitch-deck/project/${e}/create`,{template:te});d(oe.data.pitchDeck),f(oe.data.pitchDeck.slides||[]),V.success("Pitch deck cr !")}catch{V.error("Erreur")}},P=async()=>{a(!0);try{await ie.put(`/pitch-deck/project/${e}/slides`,{slides:h}),V.success("Pitch deck sauvegard")}catch{V.error("Erreur lors de la sauvegarde")}finally{a(!1)}},B=(te,oe,Ne)=>{const Oe=[...h];Oe[te]={...Oe[te],[oe]:Ne},f(Oe)},K=te=>{if(h.length<=1){V.error("Vous devez garder au moins une slide");return}const oe=h.filter((Ne,Oe)=>Oe!==te);f(oe),p>=oe.length&&v(oe.length-1)},z=()=>{const te={id:Date.now(),type:"custom",title:"Nouvelle slide",content:"",template:b||"minimal",media:[],stickers:[]};f([...h,te]),v(h.length)},M=te=>{const oe=te.target.files[0];if(oe){const Ne=new FileReader;Ne.onloadend=()=>{var yt;const Oe={id:Date.now(),type:"image",url:Ne.result,name:oe.name};B(p,"media",[...((yt=h[p])==null?void 0:yt.media)||[],Oe]),V.success("Image ajoute !")},Ne.readAsDataURL(oe)}},U=()=>{var oe,Ne,Oe,yt;const te=prompt("Entrez l'URL de la vido YouTube ou Vimeo:");if(te){let Tt=te;te.includes("youtube.com/watch")?Tt=`https://www.youtube.com/embed/${(oe=te.split("v=")[1])==null?void 0:oe.split("&")[0]}`:te.includes("youtu.be/")?Tt=`https://www.youtube.com/embed/${(Ne=te.split("youtu.be/")[1])==null?void 0:Ne.split("?")[0]}`:te.includes("vimeo.com/")&&(Tt=`https://player.vimeo.com/video/${(Oe=te.split("vimeo.com/")[1])==null?void 0:Oe.split("?")[0]}`);const Nt={id:Date.now(),type:"video",url:Tt,originalUrl:te};B(p,"media",[...((yt=h[p])==null?void 0:yt.media)||[],Nt]),V.success("Vido ajoute !")}},H=te=>{var Ne;const oe={id:Date.now(),stickerId:te.id,x:50,y:50};B(p,"stickers",[...((Ne=h[p])==null?void 0:Ne.stickers)||[],oe]),V.success("Autocollant ajout !")},Z=te=>{var Ne,Oe;const oe=((Oe=(Ne=h[p])==null?void 0:Ne.media)==null?void 0:Oe.filter(yt=>yt.id!==te))||[];B(p,"media",oe)},ne=te=>{w(te.id),B(p,"template",te.id),V.success(`Template "${te.name}" appliqu !`)},ue=te=>(E.find(Ne=>Ne.id===te)||E[0]).colors;if(t)return u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});if(!c)return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(Fe,{to:`/projects/${e}`,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:u.jsx(Ir,{className:"w-5 h-5"})}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Pitch Deck"}),u.jsx("p",{className:"text-gray-600",children:o==null?void 0:o.name})]})]}),u.jsxs("div",{className:"card text-center py-12",children:[u.jsx(Zu,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),u.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Crer votre Pitch Deck"}),u.jsx("p",{className:"text-gray-600 mb-8",children:"Choisissez un template pour commencer"}),u.jsx("div",{className:"grid md:grid-cols-3 gap-4 max-w-2xl mx-auto",children:s.map(te=>u.jsxs("button",{onClick:()=>L(te.id),className:"card-hover text-left",children:[u.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:te.name}),u.jsx("p",{className:"text-sm text-gray-600 mb-2",children:te.description}),u.jsxs("span",{className:"badge-info",children:[te.slideCount," slides"]})]},te.id))})]})]});if(m){const te=ue((he=h[p])==null?void 0:he.template);return u.jsxs("div",{className:"fixed inset-0 bg-gray-900 z-50 flex flex-col",children:[u.jsx("div",{className:"flex-1 flex items-center justify-center p-4 md:p-8",children:u.jsxs("div",{className:"w-full max-w-5xl aspect-video rounded-2xl shadow-2xl p-8 md:p-12 relative overflow-hidden",style:{background:te.bg,color:te.text},children:[(we=(ye=h[p])==null?void 0:ye.stickers)==null?void 0:we.map(oe=>{const Ne=j.find(yt=>yt.id===oe.stickerId),Oe=(Ne==null?void 0:Ne.icon)||ka;return u.jsx("div",{className:"absolute animate-pulse",style:{left:`${oe.x}%`,top:`${oe.y}%`,transform:"translate(-50%, -50%)"},children:u.jsx(Oe,{className:"w-16 h-16 md:w-20 md:h-20",style:{color:te.accent}})},oe.id)}),u.jsxs("div",{className:"flex h-full gap-8",children:[u.jsxs("div",{className:"flex-1 flex flex-col justify-center",children:[u.jsx("h1",{className:"text-3xl md:text-5xl font-bold mb-6",style:{color:te.text},children:(ke=h[p])==null?void 0:ke.title}),u.jsx("div",{className:"text-lg md:text-2xl whitespace-pre-wrap opacity-90",children:(Ie=h[p])==null?void 0:Ie.content})]}),((Ke=(Ee=h[p])==null?void 0:Ee.media)==null?void 0:Ke.length)>0&&u.jsx("div",{className:"w-2/5 flex flex-col justify-center gap-4",children:h[p].media.map(oe=>oe.type==="image"?u.jsx("img",{src:oe.url,alt:"",className:"w-full max-h-64 object-contain rounded-xl shadow-lg"},oe.id):u.jsx("div",{className:"w-full aspect-video rounded-xl overflow-hidden shadow-lg",children:u.jsx("iframe",{src:oe.url,className:"w-full h-full",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})},oe.id))})]})]})}),u.jsxs("div",{className:"p-4 flex items-center justify-between bg-gray-800/90 backdrop-blur",children:[u.jsx("button",{onClick:()=>x(!1),className:"px-4 py-2 text-white hover:bg-white/10 rounded-lg transition-colors",children:"Quitter"}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("button",{onClick:()=>v(Math.max(0,p-1)),disabled:p===0,className:"p-2 text-white hover:bg-white/10 rounded-lg disabled:opacity-50 transition-colors",children:u.jsx(Di,{className:"w-6 h-6"})}),u.jsxs("span",{className:"text-white font-medium",children:[p+1," / ",h.length]}),u.jsx("button",{onClick:()=>v(Math.min(h.length-1,p+1)),disabled:p===h.length-1,className:"p-2 text-white hover:bg-white/10 rounded-lg disabled:opacity-50 transition-colors",children:u.jsx(Ti,{className:"w-6 h-6"})})]}),u.jsx("div",{className:"text-white/50 text-sm",children:"Utilisez   pour naviguer"})]})]})}return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(Fe,{to:`/projects/${e}`,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:u.jsx(Ir,{className:"w-5 h-5"})}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Pitch Deck"}),u.jsx("p",{className:"text-gray-600",children:o==null?void 0:o.name})]})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsxs("button",{onClick:()=>x(!0),className:"btn-secondary flex items-center gap-2",children:[u.jsx(Zu,{className:"w-5 h-5"}),"Prsenter"]}),u.jsxs("button",{onClick:P,disabled:r,className:"btn-primary flex items-center gap-2",children:[u.jsx(Ki,{className:"w-5 h-5"}),r?"Sauvegarde...":"Sauvegarder"]})]})]}),u.jsxs("div",{className:"grid lg:grid-cols-4 gap-6",children:[u.jsx("div",{className:"lg:col-span-1",children:u.jsxs("div",{className:"card sticky top-24",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h3",{className:"font-semibold text-gray-900",children:"Slides"}),u.jsx("button",{onClick:z,className:"p-1.5 text-primary-600 hover:bg-primary-50 rounded-lg",children:u.jsx(Ua,{className:"w-5 h-5"})})]}),u.jsx("div",{className:"space-y-2 max-h-[60vh] overflow-y-auto",children:h.map((te,oe)=>u.jsx("button",{onClick:()=>v(oe),className:`w-full text-left p-3 rounded-lg border-2 transition-all ${p===oe?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}`,children:u.jsx("div",{className:"flex items-start justify-between",children:u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("p",{className:"text-xs text-gray-500 mb-1",children:["Slide ",oe+1]}),u.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:te.title})]})})},te.id||oe))})]})}),u.jsxs("div",{className:"lg:col-span-3 space-y-4",children:[u.jsx("div",{className:"card !p-3",children:u.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[u.jsx("span",{className:"text-sm font-medium text-gray-700 mr-2",children:"Ajouter:"}),u.jsx("input",{type:"file",ref:_,onChange:M,accept:"image/*",className:"hidden"}),u.jsxs("button",{onClick:()=>{var te;return(te=_.current)==null?void 0:te.click()},className:"flex items-center gap-1.5 px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[u.jsx(jw,{className:"w-4 h-4"}),"Photo"]}),u.jsxs("button",{onClick:U,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[u.jsx(Nu,{className:"w-4 h-4"}),"Vido"]}),u.jsxs("div",{className:"relative group",children:[u.jsxs("button",{className:"flex items-center gap-1.5 px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[u.jsx(TR,{className:"w-4 h-4"}),"Autocollants"]}),u.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white rounded-lg shadow-lg border border-gray-200 p-2 hidden group-hover:grid grid-cols-3 gap-1 z-10 min-w-[150px]",children:j.map(te=>{const oe=te.icon;return u.jsxs("button",{onClick:()=>H(te),className:"p-2 hover:bg-gray-100 rounded-lg flex flex-col items-center gap-1",title:te.label,children:[u.jsx(oe,{className:"w-5 h-5 text-primary-600"}),u.jsx("span",{className:"text-xs text-gray-500",children:te.label})]},te.id)})})]}),u.jsx("div",{className:"h-6 w-px bg-gray-300 mx-2"}),u.jsx("span",{className:"text-sm font-medium text-gray-700 mr-2",children:"Template:"}),u.jsxs("div",{className:"flex gap-1",children:[E.slice(0,4).map(te=>{var oe;return u.jsx("button",{onClick:()=>ne(te),className:`w-6 h-6 rounded border-2 transition-all ${((oe=h[p])==null?void 0:oe.template)===te.id?"border-primary-500 scale-110":"border-gray-300 hover:border-gray-400"}`,style:{background:te.colors.bg},title:te.name},te.id)}),u.jsxs("div",{className:"relative group",children:[u.jsx("button",{className:"w-6 h-6 rounded border-2 border-gray-300 hover:border-gray-400 flex items-center justify-center text-xs text-gray-500",children:"+"}),u.jsx("div",{className:"absolute top-full right-0 mt-1 bg-white rounded-lg shadow-lg border border-gray-200 p-2 hidden group-hover:grid grid-cols-4 gap-1 z-10",children:E.map(te=>{var oe;return u.jsx("button",{onClick:()=>ne(te),className:`w-8 h-8 rounded border-2 transition-all ${((oe=h[p])==null?void 0:oe.template)===te.id?"border-primary-500":"border-gray-200 hover:border-gray-300"}`,style:{background:te.colors.bg},title:te.name},te.id)})})]})]})]})}),u.jsxs("div",{className:"card",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("h3",{className:"font-semibold text-gray-900",children:["Slide ",p+1," - ",((Te=h[p])==null?void 0:Te.type)||"custom"]}),u.jsx("button",{onClick:()=>K(p),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg",children:u.jsx(Qa,{className:"w-5 h-5"})})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Titre"}),u.jsx("input",{type:"text",value:((Ae=h[p])==null?void 0:Ae.title)||"",onChange:te=>B(p,"title",te.target.value),className:"input-field",placeholder:"Titre de la slide"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contenu"}),u.jsx("textarea",{value:((Q=h[p])==null?void 0:Q.content)||"",onChange:te=>B(p,"content",te.target.value),className:"input-field resize-none min-h-[150px]",placeholder:"Contenu de la slide..."})]}),(((_e=(Ce=h[p])==null?void 0:Ce.media)==null?void 0:_e.length)>0||((Ye=(Le=h[p])==null?void 0:Le.stickers)==null?void 0:Ye.length)>0)&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mdias ajouts"}),u.jsxs("div",{className:"flex flex-wrap gap-2",children:[(mt=(pt=h[p])==null?void 0:pt.media)==null?void 0:mt.map(te=>u.jsxs("div",{className:"relative group",children:[te.type==="image"?u.jsx("img",{src:te.url,alt:"",className:"w-20 h-20 object-cover rounded-lg border border-gray-200"}):u.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:u.jsx(Nu,{className:"w-8 h-8 text-gray-400"})}),u.jsx("button",{onClick:()=>Z(te.id),className:"absolute -top-2 -right-2 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:u.jsx(Cr,{className:"w-3 h-3"})})]},te.id)),($t=(zt=h[p])==null?void 0:zt.stickers)==null?void 0:$t.map(te=>{const oe=j.find(Oe=>Oe.id===te.stickerId),Ne=(oe==null?void 0:oe.icon)||ka;return u.jsx("div",{className:"w-12 h-12 bg-primary-50 rounded-lg flex items-center justify-center",children:u.jsx(Ne,{className:"w-6 h-6 text-primary-600"})},te.id)})]})]})]}),u.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[u.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Aperu"}),(()=>{var oe,Ne,Oe,yt,Tt,Nt,Ln;const te=ue((oe=h[p])==null?void 0:oe.template);return u.jsxs("div",{className:"aspect-video rounded-xl p-8 flex flex-col justify-center relative overflow-hidden",style:{background:te.bg,color:te.text},children:[(Oe=(Ne=h[p])==null?void 0:Ne.stickers)==null?void 0:Oe.map(on=>{const da=j.find(ha=>ha.id===on.stickerId),Qi=(da==null?void 0:da.icon)||ka;return u.jsx("div",{className:"absolute",style:{left:`${on.x}%`,top:`${on.y}%`,transform:"translate(-50%, -50%)"},children:u.jsx(Qi,{className:"w-12 h-12",style:{color:te.accent}})},on.id)}),u.jsxs("div",{className:"flex gap-6",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("h2",{className:"text-2xl font-bold mb-4",style:{color:te.text},children:((yt=h[p])==null?void 0:yt.title)||"Titre"}),u.jsx("p",{className:"whitespace-pre-wrap opacity-90",children:((Tt=h[p])==null?void 0:Tt.content)||"Contenu de la slide"})]}),((Ln=(Nt=h[p])==null?void 0:Nt.media)==null?void 0:Ln.length)>0&&u.jsx("div",{className:"w-1/3 flex flex-col gap-2",children:h[p].media.slice(0,2).map(on=>on.type==="image"?u.jsx("img",{src:on.url,alt:"",className:"w-full h-24 object-cover rounded-lg"},on.id):u.jsx("div",{className:"w-full h-24 bg-black/20 rounded-lg flex items-center justify-center",children:u.jsx(Nu,{className:"w-8 h-8 opacity-50"})},on.id))})]})]})})()]}),u.jsxs("div",{className:"flex justify-between items-center mt-6 pt-6 border-t border-gray-200",children:[u.jsxs("button",{onClick:()=>v(Math.max(0,p-1)),disabled:p===0,className:"btn-secondary flex items-center gap-2 disabled:opacity-50",children:[u.jsx(Di,{className:"w-5 h-5"}),"Prcdent"]}),u.jsxs("span",{className:"text-gray-500",children:[p+1," / ",h.length]}),u.jsxs("button",{onClick:()=>v(Math.min(h.length-1,p+1)),disabled:p===h.length-1,className:"btn-primary flex items-center gap-2 disabled:opacity-50",children:["Suivant",u.jsx(Ti,{className:"w-5 h-5"})]})]})]})]})]})]})},k6=()=>{var vv,gv,xv,yv,bv,wv,Nv,Cv,kv,jv,Sv,Ev,_v,Rv,Iv,Av,Dv,Tv,Pv,Fv,Mv,Ov,Lv,Bv,zv,$v,Uv,Wv,Vv,Hv,Gv,qv,Kv,Xv,Yv,Qv,Jv,Zv,eg,tg,ng,rg,ag,og,ig,sg,lg,ug,cg,dg,hg,fg,pg,mg,vg,gg,xg,yg,bg,wg,Ng,Cg,kg,jg,Sg,Eg,_g,Rg,Ig,Ag,Dg,Tg,Pg,Fg,Mg,Og,Lg,Bg,zg,$g,Ug,Wg,Vg,Hg,Gg,qg,Kg,Xg,Yg,Qg,Jg,Zg,e0,t0,n0,r0,a0;const{projectId:e}=aa(),[t,n]=I.useState(!0),[r,a]=I.useState(!1),[o,i]=I.useState(null),[s,l]=I.useState(null),[c,d]=I.useState([]),[h,f]=I.useState(0),[p,v]=I.useState(!1),[g,y]=I.useState("design"),[m,x]=I.useState(!1),[b,w]=I.useState(""),[N,C]=I.useState(!1),[S,k]=I.useState(null),[_,E]=I.useState(100),[j,T]=I.useState(null),[L,P]=I.useState(!1),[B,K]=I.useState(""),[z,M]=I.useState(null),[U,H]=I.useState({fontSize:16,fontFamily:"Inter",color:"#000000",fontWeight:"normal"}),Z=I.useRef(null),ne=I.useRef(null),ue=I.useRef(null),[he,ye]=I.useState(!1),[we,ke]=I.useState(!1),[Ie,Ee]=I.useState({x:0,y:0}),[Ke,Te]=I.useState(""),[Ae,Q]=I.useState(null),[Ce,_e]=I.useState(null),[Le,Ye]=I.useState(null),[pt,mt]=I.useState("templates"),[zt,$t]=I.useState("style"),[te,oe]=I.useState(!1),[Ne,Oe]=I.useState(null),yt=[{id:"Inter",name:"Inter",category:"Sans-serif"},{id:"Arial",name:"Arial",category:"Sans-serif"},{id:"Helvetica",name:"Helvetica",category:"Sans-serif"},{id:"Roboto",name:"Roboto",category:"Sans-serif"},{id:"Open Sans",name:"Open Sans",category:"Sans-serif"},{id:"Montserrat",name:"Montserrat",category:"Sans-serif"},{id:"Georgia",name:"Georgia",category:"Serif"},{id:"Times New Roman",name:"Times New Roman",category:"Serif"},{id:"Playfair Display",name:"Playfair Display",category:"Serif"},{id:"Merriweather",name:"Merriweather",category:"Serif"},{id:"Courier New",name:"Courier New",category:"Mono"},{id:"Verdana",name:"Verdana",category:"Sans-serif"},{id:"Trebuchet MS",name:"Trebuchet MS",category:"Sans-serif"},{id:"Comic Sans MS",name:"Comic Sans MS",category:"Display"},{id:"Impact",name:"Impact",category:"Display"}],Tt=[{id:"none",name:"Aucun",style:{}},{id:"shadow",name:"Ombre",style:{textShadow:"2px 2px 4px rgba(0,0,0,0.3)"}},{id:"shadow-hard",name:"Ombre dure",style:{textShadow:"3px 3px 0px rgba(0,0,0,0.5)"}},{id:"glow",name:"Lueur",style:{textShadow:"0 0 10px currentColor, 0 0 20px currentColor"}},{id:"neon",name:"Non",style:{textShadow:"0 0 5px #fff, 0 0 10px #fff, 0 0 15px currentColor, 0 0 20px currentColor"}},{id:"outline",name:"Contour",style:{WebkitTextStroke:"1px currentColor",WebkitTextFillColor:"transparent"}},{id:"emboss",name:"Relief",style:{textShadow:"-1px -1px 0 rgba(255,255,255,0.5), 1px 1px 0 rgba(0,0,0,0.3)"}},{id:"retro",name:"Rtro",style:{textShadow:"3px 3px 0 #ff6b6b, 6px 6px 0 #ffd93d"}}],Nt=[{id:"none",name:"Aucune",class:""},{id:"fade-in",name:"Fondu",class:"animate-fadeIn"},{id:"slide-up",name:"Glisser haut",class:"animate-slideUp"},{id:"slide-down",name:"Glisser bas",class:"animate-slideDown"},{id:"zoom",name:"Zoom",class:"animate-zoom"},{id:"bounce",name:"Rebond",class:"animate-bounce"},{id:"pulse",name:"Pulsation",class:"animate-pulse"},{id:"shake",name:"Secouer",class:"animate-shake"}],Ln=["#000000","#434343","#666666","#999999","#cccccc","#ffffff","#ff0000","#ff6b6b","#ff9500","#ffd93d","#00ff00","#00d084","#0693e3","#00d4ff","#6b5bff","#9b59b6","#ff69b4","#eb144c"],on=[{id:"modern-beige",name:"lgant Beige",category:"Business",colors:{bg:"linear-gradient(180deg, #f5f0e8 0%, #e8dfd3 100%)",text:"#3d3d3d",accent:"#8b7355"},previewBg:"linear-gradient(180deg, #f5f0e8 0%, #e8dfd3 100%)",previewElements:["title-center","subtitle-elegant"]},{id:"startup-purple",name:"Startup Moderne",category:"Tech",colors:{bg:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",text:"#ffffff",accent:"#fbbf24"},previewBg:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",previewElements:["title-bold","icons"]},{id:"minimal-clean",name:"Minimal Clean",category:"Prsentation",colors:{bg:"#ffffff",text:"#1a1a1a",accent:"#0066ff"},previewBg:"#ffffff",previewElements:["title-left","line-accent"]},{id:"dark-premium",name:"Dark Premium",category:"Luxe",colors:{bg:"linear-gradient(180deg, #1a1a2e 0%, #0d0d1a 100%)",text:"#ffffff",accent:"#c9a962"},previewBg:"linear-gradient(180deg, #1a1a2e 0%, #0d0d1a 100%)",previewElements:["title-gold","border-gold"]},{id:"nature-green",name:"Nature Fresh",category:"Nature",colors:{bg:"linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%)",text:"#2e7d32",accent:"#1b5e20"},previewBg:"linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%)",previewElements:["title-nature","leaf-icon"]},{id:"ocean-blue",name:"Ocan Calme",category:"Cratif",colors:{bg:"linear-gradient(180deg, #e3f2fd 0%, #90caf9 100%)",text:"#0d47a1",accent:"#1565c0"},previewBg:"linear-gradient(180deg, #e3f2fd 0%, #90caf9 100%)",previewElements:["title-wave","wave-decoration"]},{id:"sunset-warm",name:"Coucher Soleil",category:"Cratif",colors:{bg:"linear-gradient(135deg, #fff3e0 0%, #ffccbc 100%)",text:"#bf360c",accent:"#e65100"},previewBg:"linear-gradient(135deg, #fff3e0 0%, #ffccbc 100%)",previewElements:["title-warm","sun-icon"]},{id:"corporate-navy",name:"Corporate Pro",category:"Business",colors:{bg:"#f8fafc",text:"#1e3a5f",accent:"#2563eb"},previewBg:"#f8fafc",previewElements:["title-corporate","chart-icon"]},{id:"creative-gradient",name:"Cratif Vibrant",category:"Cratif",colors:{bg:"linear-gradient(135deg, #ff6b6b 0%, #feca57 50%, #48dbfb 100%)",text:"#ffffff",accent:"#ffffff"},previewBg:"linear-gradient(135deg, #ff6b6b 0%, #feca57 50%, #48dbfb 100%)",previewElements:["title-vibrant","shapes"]},{id:"photo-overlay",name:"Photo Moderne",category:"Photo",colors:{bg:"linear-gradient(135deg, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.4) 100%)",text:"#ffffff",accent:"#ffffff"},previewBg:"linear-gradient(135deg, #2c3e50 0%, #4a6741 100%)",previewElements:["title-photo","overlay"]},{id:"pastel-pink",name:"Pastel Doux",category:"Cratif",colors:{bg:"linear-gradient(180deg, #fce4ec 0%, #f8bbd9 100%)",text:"#880e4f",accent:"#ad1457"},previewBg:"linear-gradient(180deg, #fce4ec 0%, #f8bbd9 100%)",previewElements:["title-soft","hearts"]},{id:"tech-cyber",name:"Tech Cyber",category:"Tech",colors:{bg:"#0a0a0f",text:"#00ff88",accent:"#00d4ff"},previewBg:"#0a0a0f",previewElements:["title-cyber","grid-lines"]}],da={shapes:[{id:"rect",icon:ry,name:"Rectangle"},{id:"circle",icon:tR,name:"Cercle"},{id:"triangle",icon:OR,name:"Triangle"},{id:"star",icon:ka,name:"toile"},{id:"heart",icon:kw,name:"Cur"},{id:"diamond",icon:oR,name:"Losange"},{id:"hexagon",icon:fR,name:"Hexagone"},{id:"octagon",icon:kR,name:"Octogone"}],arrows:[{id:"arrow-right",icon:jo,name:"Flche droite"},{id:"arrow-up",icon:K_,name:"Flche haut"},{id:"arrow-down",icon:q_,name:"Flche bas"},{id:"trending-up",icon:Oi,name:"Tendance +"},{id:"trending-down",icon:MR,name:"Tendance -"}],business:[{id:"briefcase",icon:Zx,name:"Business"},{id:"building",icon:em,name:"Entreprise"},{id:"chart",icon:X_,name:"Graphique"},{id:"pie",icon:SR,name:"Camembert"},{id:"line-chart",icon:xR,name:"Courbe"},{id:"dollar",icon:nm,name:"Dollar"},{id:"target",icon:sm,name:"Objectif"},{id:"trophy",icon:LR,name:"Trophe"}],tech:[{id:"cpu",icon:ey,name:"CPU"},{id:"database",icon:aR,name:"Database"},{id:"cloud",icon:nR,name:"Cloud"},{id:"server",icon:AR,name:"Serveur"},{id:"globe",icon:cR,name:"Web"},{id:"smartphone",icon:DR,name:"Mobile"},{id:"laptop",icon:vR,name:"Laptop"},{id:"wifi",icon:$R,name:"Wifi"}],people:[{id:"user",icon:ta,name:"Utilisateur"},{id:"users",icon:un,name:"quipe"},{id:"user-plus",icon:Iw,name:"Ajouter"},{id:"brain",icon:Z_,name:"Intelligence"},{id:"graduation",icon:dR,name:"ducation"}],communication:[{id:"mail",icon:ea,name:"Email"},{id:"phone",icon:am,name:"Tlphone"},{id:"message",icon:ny,name:"Message"},{id:"send",icon:IR,name:"Envoyer"},{id:"bell",icon:kf,name:"Notification"}],status:[{id:"check",icon:Tn,name:"Valid"},{id:"x-circle",icon:Aw,name:"Refus"},{id:"alert",icon:G_,name:"Attention"},{id:"info",icon:mR,name:"Info"},{id:"lightbulb",icon:Kr,name:"Ide"}],misc:[{id:"rocket",icon:Ar,name:"Fuse"},{id:"zap",icon:Dw,name:"clair"},{id:"award",icon:yw,name:"Rcompense"},{id:"gem",icon:sR,name:"Premium"},{id:"crown",icon:jf,name:"Couronne"},{id:"gift",icon:lR,name:"Cadeau"},{id:"flag",icon:Cw,name:"Drapeau"},{id:"bookmark",icon:J_,name:"Signet"}],social:[{id:"thumbs-up",icon:ay,name:"Like"},{id:"thumbs-down",icon:FR,name:"Dislike"},{id:"github",icon:uR,name:"GitHub"},{id:"linkedin",icon:bR,name:"LinkedIn"},{id:"twitter",icon:BR,name:"Twitter"}]},Qi=[{id:"shapes",name:"Formes",icon:ry},{id:"arrows",name:"Flches",icon:jo},{id:"business",name:"Business",icon:Zx},{id:"tech",name:"Tech",icon:ey},{id:"people",name:"Personnes",icon:un},{id:"communication",name:"Communication",icon:ny},{id:"status",name:"Statuts",icon:Tn},{id:"misc",name:"Divers",icon:pi},{id:"social",name:"Social",icon:ay}],[ha,Ji]=I.useState("shapes"),Lo=()=>Object.values(da).flat(),JC=[{id:"design",icon:jR,label:"Design"},{id:"elements",icon:hR,label:"lments"},{id:"text",icon:_w,label:"Texte"},{id:"images",icon:jw,label:"Images"},{id:"videos",icon:Nu,label:"Vidos"},{id:"ai",icon:sy,label:"IA"}];I.useEffect(()=>{ek()},[e]),I.useEffect(()=>{const A=$=>{p&&($.key==="ArrowRight"||$.key===" "?f(ae=>Math.min(c.length-1,ae+1)):$.key==="ArrowLeft"?f(ae=>Math.max(0,ae-1)):$.key==="Escape"&&v(!1))};return window.addEventListener("keydown",A),()=>window.removeEventListener("keydown",A)},[p,c.length]);const[Cl,dv]=I.useState(!1),[kl,ZC]=I.useState(!0);I.useEffect(()=>{kl||dv(!0)},[c]),I.useEffect(()=>{if(!Cl||kl||t)return;const A=setTimeout(async()=>{try{if(s)await ie.put(`/pitch-deck/project/${e}/slides`,{slides:c});else{const $=await ie.post(`/pitch-deck/project/${e}/create`,{template:"custom",slides:c});l($.data.pitchDeck)}dv(!1),console.log("Auto-saved")}catch($){console.error("Auto-save failed:",$)}},1500);return()=>clearTimeout(A)},[Cl,c,s,e,kl,t]);const ek=async()=>{try{const[A,$]=await Promise.all([ie.get(`/projects/${e}`),ie.get(`/pitch-deck/project/${e}`)]);i(A.data.project),$.data.pitchDeck?(l($.data.pitchDeck),d($.data.pitchDeck.slides||hv())):d(hv())}catch{V.error("Erreur lors du chargement")}finally{n(!1),setTimeout(()=>ZC(!1),500)}},hv=()=>[{id:1,type:"title",title:"Ma Prsentation",content:"Sous-titre de votre prsentation",template:"modern-beige",media:[],elements:[]}],tk=async()=>{a(!0);try{if(s)await ie.put(`/pitch-deck/project/${e}/slides`,{slides:c});else{const A=await ie.post(`/pitch-deck/project/${e}/create`,{template:"custom",slides:c});l(A.data.pitchDeck)}V.success("Sauvegard !")}catch{V.error("Erreur de sauvegarde")}finally{a(!1)}},at=(A,$,ae)=>{const ee=[...c];ee[A]={...ee[A],[$]:ae},d(ee)},nk=()=>{var ee;const A=((ee=c[h])==null?void 0:ee.template)||"minimal-white",$={id:Date.now(),type:"content",title:"Nouveau slide",content:"",template:A,media:[],elements:[]},ae=[...c];ae.splice(h+1,0,$),d(ae),f(h+1)},rk=()=>{const A={...c[h],id:Date.now()},$=[...c];$.splice(h+1,0,A),d($),f(h+1),V.success("Slide dupliqu")},ak=()=>{if(c.length<=1){V.error("Gardez au moins un slide");return}const A=c.filter(($,ae)=>ae!==h);d(A),f(Math.max(0,h-1))},fv=A=>{at(h,"template",A.id),A.colors&&at(h,"customColors",A.colors),V.success(`Template "${A.name}" appliqu`)},ok=A=>{const $=A.target.files[0];if($){const ae=new FileReader;ae.onloadend=()=>{var se;const ee={id:Date.now(),type:"image",url:ae.result,x:60,y:30,width:35,height:40};at(h,"media",[...((se=c[h])==null?void 0:se.media)||[],ee]),V.success("Image ajoute")},ae.readAsDataURL($)}},ik=()=>{var ae,ee,se,be;if(!B.trim()){V.error("Entrez une URL");return}let A=B;B.includes("youtube.com/watch")?A=`https://www.youtube.com/embed/${(ae=B.split("v=")[1])==null?void 0:ae.split("&")[0]}`:B.includes("youtu.be/")?A=`https://www.youtube.com/embed/${(ee=B.split("youtu.be/")[1])==null?void 0:ee.split("?")[0]}`:B.includes("vimeo.com/")&&(A=`https://player.vimeo.com/video/${(se=B.split("vimeo.com/")[1])==null?void 0:se.split("?")[0]}`);const $={id:Date.now(),type:"video",url:A,isEmbed:!0,x:55,y:25,width:40,height:45};at(h,"media",[...((be=c[h])==null?void 0:be.media)||[],$]),K(""),P(!1),V.success("Vido ajoute")},sk=A=>{const $=A.target.files[0];if($){if($.size>50*1024*1024){V.error("Vido trop lourde (max 50MB)");return}const ae=new FileReader;ae.onloadend=()=>{var se;const ee={id:Date.now(),type:"video",url:ae.result,isLocal:!0,x:55,y:25,width:40,height:45};at(h,"media",[...((se=c[h])==null?void 0:se.media)||[],ee]),V.success("Vido locale ajoute")},ae.readAsDataURL($)}},Zi=(A,$,ae)=>{var be;const se=(((be=c[h])==null?void 0:be.media)||[]).map(Pe=>Pe.id===A?{...Pe,width:Math.max(10,Math.min(90,Pe.width+$)),height:Math.max(10,Math.min(90,Pe.height+ae))}:Pe);at(h,"media",se)},lk=(A,$,ae)=>{var be;const se=(((be=c[h])==null?void 0:be.media)||[]).map(Pe=>Pe.id===A?{...Pe,x:Math.max(0,Math.min(100,$)),y:Math.max(0,Math.min(100,ae))}:Pe);at(h,"media",se)},hd=A=>{var ae,ee;const $=((ee=(ae=c[h])==null?void 0:ae.media)==null?void 0:ee.filter(se=>se.id!==A))||[];at(h,"media",$),T(null),V.success("Mdia supprim")},Ve=(A,$)=>{var se;const ee=(((se=c[h])==null?void 0:se.elements)||[]).map(be=>be.id===A?{...be,...$}:be);at(h,"elements",ee)},fd=A=>{var ae,ee;const $=((ee=(ae=c[h])==null?void 0:ae.elements)==null?void 0:ee.filter(se=>se.id!==A))||[];at(h,"elements",$),M(null),V.success("lment supprim")},Or=(A,$,ae,ee="drag")=>{A.preventDefault(),A.stopPropagation();const se=ue.current;if(!se)return;const be=se.getBoundingClientRect();Ee({x:A.clientX,y:A.clientY,canvasWidth:be.width,canvasHeight:be.height}),_e(ae),ae==="media"?(T($),Q(null)):(Q($),T(null)),ee==="resize"?ke(!0):ye(!0)},uk=A=>{var hr,to,o0,i0,s0,l0,u0,c0;if(!he&&!we)return;const $=ue.current;if(!$)return;const ae=$.getBoundingClientRect(),ee=ae.width,se=ae.height,be=(A.clientX-Ie.x)/ee*100,Pe=(A.clientY-Ie.y)/se*100;if(Ce==="media"&&j){const Xe=(to=(hr=c[h])==null?void 0:hr.media)==null?void 0:to.find(Ct=>Ct.id===j);if(!Xe)return;if(we)Zi(j,be,Pe);else if(he){const Ct=Math.max(0,Math.min(100-Xe.width,Xe.x+be)),Lr=Math.max(0,Math.min(100-Xe.height,Xe.y+Pe));lk(j,Ct,Lr)}}else if(Ce==="element"&&Ae){const Xe=(i0=(o0=c[h])==null?void 0:o0.elements)==null?void 0:i0.find(Ct=>Ct.id===Ae);if(!Xe)return;if(Xe.type==="text"){if(he){const Ct=Math.max(0,Math.min(90,Xe.x+be)),Lr=Math.max(0,Math.min(90,Xe.y+Pe));Ve(Ae,{x:Ct,y:Lr})}}else if(we&&Xe.size!==void 0){const Ct=Math.max(16,Math.min(200,Xe.size+be));mv(Ae,{size:Ct})}else if(he){const Ct=Math.max(0,Math.min(90,Xe.x+be)),Lr=Math.max(0,Math.min(90,Xe.y+Pe));mv(Ae,{x:Ct,y:Lr})}}else if(Ce==="slideTitle"&&he){const Xe=((s0=c[h])==null?void 0:s0.titleStyle)||{},Ct=Math.max(0,Math.min(90,(Xe.x||5)+be)),Lr=Math.max(0,Math.min(90,(Xe.y||10)+Pe));at(h,"titleStyle",{...Xe,x:Ct,y:Lr})}else if(Ce==="slideContent"&&he){const Xe=((l0=c[h])==null?void 0:l0.contentStyle)||{},Ct=Math.max(0,Math.min(90,(Xe.x||5)+be)),Lr=Math.max(0,Math.min(90,(Xe.y||30)+Pe));at(h,"contentStyle",{...Xe,x:Ct,y:Lr})}else if(Ce==="textResize"&&we&&Ae){const Xe=(c0=(u0=c[h])==null?void 0:u0.elements)==null?void 0:c0.find(Ct=>Ct.id===Ae);if(Xe){const Ct=Math.max(8,Math.min(200,(Xe.fontSize||16)+be*.5));Ve(Ae,{fontSize:Math.round(Ct)})}}Ee(Xe=>({...Xe,x:A.clientX,y:A.clientY}))},pv=()=>{ye(!1),ke(!1),_e(null)},mv=(A,$)=>{var se;const ee=(((se=c[h])==null?void 0:se.elements)||[]).map(be=>be.id===A?{...be,...$}:be);at(h,"elements",ee)},ck=(A,$)=>{A.preventDefault(),A.stopPropagation(),Or(A,$,"element","drag"),M($),y("text")},dk=(A,$)=>{A.stopPropagation(),M($.id),Te($.text),y("text")},hk=(A,$)=>{var ee,se;const ae={id:Date.now(),elementId:A.id,type:$,x:50+Math.random()*20,y:50+Math.random()*20,size:48,color:Bo((ee=c[h])==null?void 0:ee.template).accent};at(h,"elements",[...((se=c[h])==null?void 0:se.elements)||[],ae]),V.success(`${A.name} ajout`)},pd=A=>{var ae,ee,se,be;const $={id:Date.now(),type:"text",text:A.text,x:10,y:(ee=(ae=c[h])==null?void 0:ae.elements)!=null&&ee.length?60:40,fontSize:A.fontSize,fontWeight:A.fontWeight,color:Bo((se=c[h])==null?void 0:se.template).text};at(h,"elements",[...((be=c[h])==null?void 0:be.elements)||[],$])},fk=async()=>{if(!b.trim()){V.error("Dcrivez votre prsentation");return}C(!0);try{await new Promise($=>setTimeout($,2e3));const A=[{id:"option-1",name:"Pitch Investisseur",description:"Structure classique pour lever des fonds",template:"startup-purple",slides:[{id:1,type:"title",title:b.split(" ").slice(0,5).join(" "),content:"Rvolutionnez votre industrie",template:"startup-purple",media:[],elements:[]},{id:2,type:"content",title:" Le Problme",content:` Douleur client identifie
 Impact conomique
 Urgence de la solution`,template:"startup-purple",media:[],elements:[]},{id:3,type:"content",title:" Notre Solution",content:` Innovation unique
 Avantage concurrentiel
 Technologie propritaire`,template:"startup-purple",media:[],elements:[]},{id:4,type:"content",title:" Le March",content:` TAM: XX milliards
 SAM: XX millions
 SOM: XX millions`,template:"startup-purple",media:[],elements:[]},{id:5,type:"content",title:" Business Model",content:` Revenue SaaS
 Marge: XX%
 LTV/CAC: X:1`,template:"startup-purple",media:[],elements:[]},{id:6,type:"content",title:" Traction",content:` X utilisateurs actifs
 +XX% MoM
 Clients rfrences`,template:"startup-purple",media:[],elements:[]},{id:7,type:"content",title:" L'quipe",content:` CEO - Vision & Strategy
 CTO - Tech & Product
 CMO - Growth`,template:"startup-purple",media:[],elements:[]},{id:8,type:"content",title:" Ask",content:` Leve: X millions
 Utilisation: Produit, quipe, Marketing
 Contact: hello@startup.com`,template:"startup-purple",media:[],elements:[]}]},{id:"option-2",name:"Prsentation Produit",description:"Focus sur les fonctionnalits et bnfices",template:"modern-beige",slides:[{id:1,type:"title",title:b.split(" ").slice(0,5).join(" "),content:"La solution qui change tout",template:"modern-beige",media:[],elements:[]},{id:2,type:"content",title:"Pourquoi nous?",content:` Simplicit d'utilisation
 Rsultats prouvs
 Support ddi`,template:"modern-beige",media:[],elements:[]},{id:3,type:"content",title:"Fonctionnalits cls",content:` Feature 1 - Gain de temps
 Feature 2 - Automatisation
 Feature 3 - Analytics`,template:"modern-beige",media:[],elements:[]},{id:4,type:"content",title:"Comment a marche",content:`1. Inscrivez-vous
2. Configurez
3. Profitez des rsultats`,template:"modern-beige",media:[],elements:[]},{id:5,type:"content",title:"Tmoignages",content:`"Incroyable!" - Client A
"Indispensable" - Client B`,template:"modern-beige",media:[],elements:[]},{id:6,type:"content",title:"Tarifs",content:` Starter: Gratuit
 Pro: XX/mois
 Enterprise: Sur devis`,template:"modern-beige",media:[],elements:[]}]},{id:"option-3",name:"Story Telling",description:"Narrative immersive et motionnelle",template:"dark-premium",slides:[{id:1,type:"title",title:b.split(" ").slice(0,5).join(" "),content:"Une histoire qui inspire",template:"dark-premium",media:[],elements:[]},{id:2,type:"content",title:"Il tait une fois...",content:"Un problme que tout le monde connat mais que personne n'osait rsoudre.",template:"dark-premium",media:[],elements:[]},{id:3,type:"content",title:"Le dclic",content:"C'est alors que nous avons eu une ide folle...",template:"dark-premium",media:[],elements:[]},{id:4,type:"content",title:"La transformation",content:"Aujourd'hui, des milliers de personnes vivent mieux grce  nous.",template:"dark-premium",media:[],elements:[]},{id:5,type:"content",title:"Rejoignez l'aventure",content:"Ensemble, crivons la suite de cette histoire.",template:"dark-premium",media:[],elements:[]}]}];Ye(A),V.success("3 options gnres ! Choisissez celle qui vous convient.")}catch{V.error("Erreur de gnration")}finally{C(!1)}},pk=A=>{d(A.slides),f(0),Ye(null),x(!1),V.success(`"${A.name}" appliqu !`)},Bo=(A,$=h)=>{const ae=c[$];return ae!=null&&ae.customColors?ae.customColors:(on.find(se=>se.id===A)||on[0]).colors};if(t)return u.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-900",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-400",children:"Chargement de l'diteur..."})]})});if(p){const A=Bo((vv=c[h])==null?void 0:vv.template);return u.jsxs("div",{className:"fixed inset-0 bg-gray-900 z-50 flex flex-col",children:[u.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:u.jsxs("div",{className:"w-full max-w-6xl aspect-video rounded-lg shadow-2xl p-12 relative overflow-hidden",style:{background:A.bg,color:A.text},children:[(xv=(gv=c[h])==null?void 0:gv.elements)==null?void 0:xv.map($=>{if($.type==="text")return u.jsx("div",{style:{position:"absolute",left:`${$.x}%`,top:`${$.y}%`,fontSize:$.fontSize,fontWeight:$.fontWeight,color:$.color},children:$.text},$.id);const ae=Lo().find(ee=>ee.id===$.elementId);if(ae){const ee=ae.icon;return u.jsx("div",{style:{position:"absolute",left:`${$.x}%`,top:`${$.y}%`,transform:"translate(-50%, -50%)"},children:u.jsx(ee,{size:$.size*1.5,style:{color:$.color}})},$.id)}return null}),u.jsxs("div",{className:"flex h-full gap-8",children:[u.jsxs("div",{className:"flex-1 flex flex-col justify-center",children:[u.jsx("h1",{className:"mb-6",style:{fontSize:`${((bv=(yv=c[h])==null?void 0:yv.titleStyle)==null?void 0:bv.fontSize)||48}px`,fontWeight:((Nv=(wv=c[h])==null?void 0:wv.titleStyle)==null?void 0:Nv.fontWeight)||"bold",fontFamily:((kv=(Cv=c[h])==null?void 0:Cv.titleStyle)==null?void 0:kv.fontFamily)||"Inter",color:((Sv=(jv=c[h])==null?void 0:jv.titleStyle)==null?void 0:Sv.color)||A.text,fontStyle:(_v=(Ev=c[h])==null?void 0:Ev.titleStyle)!=null&&_v.italic?"italic":"normal",textDecoration:`${(Iv=(Rv=c[h])==null?void 0:Rv.titleStyle)!=null&&Iv.underline?"underline":""} ${(Dv=(Av=c[h])==null?void 0:Av.titleStyle)!=null&&Dv.strikethrough?"line-through":""}`.trim()||"none",textAlign:((Pv=(Tv=c[h])==null?void 0:Tv.titleStyle)==null?void 0:Pv.align)||"left"},children:(Fv=c[h])==null?void 0:Fv.title}),u.jsx("div",{className:"whitespace-pre-wrap",style:{fontSize:`${((Ov=(Mv=c[h])==null?void 0:Mv.contentStyle)==null?void 0:Ov.fontSize)||24}px`,fontWeight:((Bv=(Lv=c[h])==null?void 0:Lv.contentStyle)==null?void 0:Bv.fontWeight)||"normal",fontFamily:(($v=(zv=c[h])==null?void 0:zv.contentStyle)==null?void 0:$v.fontFamily)||"Inter",color:((Wv=(Uv=c[h])==null?void 0:Uv.contentStyle)==null?void 0:Wv.color)||A.text,fontStyle:(Hv=(Vv=c[h])==null?void 0:Vv.contentStyle)!=null&&Hv.italic?"italic":"normal",textDecoration:`${(qv=(Gv=c[h])==null?void 0:Gv.contentStyle)!=null&&qv.underline?"underline":""} ${(Xv=(Kv=c[h])==null?void 0:Kv.contentStyle)!=null&&Xv.strikethrough?"line-through":""}`.trim()||"none",textAlign:((Qv=(Yv=c[h])==null?void 0:Yv.contentStyle)==null?void 0:Qv.align)||"left",opacity:.9},children:(Jv=c[h])==null?void 0:Jv.content})]}),((eg=(Zv=c[h])==null?void 0:Zv.media)==null?void 0:eg.length)>0&&u.jsx("div",{className:"w-2/5 flex flex-col justify-center gap-4",children:c[h].media.map($=>$.type==="image"?u.jsx("img",{src:$.url,alt:"",className:"max-h-80 object-contain rounded-xl"},$.id):u.jsx("iframe",{src:$.url,className:"w-full aspect-video rounded-xl",frameBorder:"0",allowFullScreen:!0},$.id))})]})]})}),u.jsxs("div",{className:"p-4 flex items-center justify-between bg-gray-800/90",children:[u.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 text-white hover:bg-white/10 rounded-lg",children:"Quitter"}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("button",{onClick:()=>f(Math.max(0,h-1)),disabled:h===0,className:"p-2 text-white hover:bg-white/10 rounded-lg disabled:opacity-50",children:u.jsx(Di,{className:"w-6 h-6"})}),u.jsxs("span",{className:"text-white",children:[h+1," / ",c.length]}),u.jsx("button",{onClick:()=>f(Math.min(c.length-1,h+1)),disabled:h===c.length-1,className:"p-2 text-white hover:bg-white/10 rounded-lg disabled:opacity-50",children:u.jsx(Ti,{className:"w-6 h-6"})})]}),u.jsx("div",{className:"text-white/50 text-sm",children:"  pour naviguer  Esc pour quitter"})]})]})}const jl=Bo((tg=c[h])==null?void 0:tg.template);return u.jsxs("div",{className:"h-screen flex flex-col bg-gray-100",children:[u.jsxs("div",{className:"h-14 bg-white border-b flex items-center justify-between px-4 shadow-sm",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(Fe,{to:`/projects/${e}`,className:"p-2 hover:bg-gray-100 rounded-lg",children:u.jsx(Ir,{className:"w-5 h-5 text-gray-600"})}),u.jsxs("div",{children:[u.jsx("h1",{className:"font-semibold text-gray-900",children:(o==null?void 0:o.name)||"Pitch Deck"}),u.jsx("p",{className:"text-xs text-gray-500",children:"diteur de prsentation"})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg text-gray-600",children:u.jsx(zR,{className:"w-5 h-5"})}),u.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg text-gray-600",children:u.jsx(_R,{className:"w-5 h-5"})}),u.jsx("div",{className:"h-6 w-px bg-gray-300 mx-2"}),u.jsxs("select",{value:_,onChange:A=>E(Number(A.target.value)),className:"text-sm border rounded-lg px-2 py-1",children:[u.jsx("option",{value:50,children:"50%"}),u.jsx("option",{value:75,children:"75%"}),u.jsx("option",{value:100,children:"100%"}),u.jsx("option",{value:125,children:"125%"})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("button",{onClick:()=>v(!0),className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-gray-700",children:[u.jsx(ER,{className:"w-4 h-4"}),"Prsenter"]}),Cl&&u.jsxs("span",{className:"text-xs text-gray-400 flex items-center gap-1",children:[u.jsx("div",{className:"w-2 h-2 bg-yellow-400 rounded-full animate-pulse"}),"Sauvegarde auto..."]}),!Cl&&!kl&&u.jsxs("span",{className:"text-xs text-green-500 flex items-center gap-1",children:[u.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Sauvegard"]}),u.jsxs("button",{onClick:tk,disabled:r,className:"flex items-center gap-2 px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg",children:[u.jsx(Ki,{className:"w-4 h-4"}),r?"Sauvegarde...":"Sauvegarder"]})]})]}),u.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[u.jsx("div",{className:"w-16 bg-gray-900 flex flex-col items-center py-4 gap-1",children:JC.map(A=>{const $=A.icon;return u.jsxs("button",{onClick:()=>y(A.id),className:`w-12 h-12 flex flex-col items-center justify-center rounded-lg transition-colors ${g===A.id?"bg-primary-600 text-white":"text-gray-400 hover:bg-gray-800 hover:text-white"}`,children:[u.jsx($,{className:"w-5 h-5"}),u.jsx("span",{className:"text-[10px] mt-1",children:A.label})]},A.id)})}),u.jsx("div",{className:"w-72 bg-white border-r overflow-y-auto",children:u.jsxs("div",{className:"p-4",children:[g==="ai"&&u.jsxs("div",{children:[u.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[u.jsx(sy,{className:"w-5 h-5 text-primary-600"}),"Assistant IA"]}),Le?u.jsxs(u.Fragment,{children:[u.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Choisissez la prsentation qui vous convient :"}),u.jsx("div",{className:"space-y-3",children:Le.map(A=>{var ae,ee;const $=Bo(A.template);return u.jsxs("div",{className:"border rounded-lg overflow-hidden hover:shadow-lg transition-all cursor-pointer group",onClick:()=>pk(A),children:[u.jsxs("div",{className:"h-20 p-3 flex flex-col justify-center",style:{background:$.bg,color:$.text},children:[u.jsx("div",{className:"text-xs font-bold truncate",children:(ae=A.slides[0])==null?void 0:ae.title}),u.jsx("div",{className:"text-[10px] opacity-70 truncate",children:(ee=A.slides[0])==null?void 0:ee.content})]}),u.jsxs("div",{className:"p-3 bg-white",children:[u.jsx("h4",{className:"font-semibold text-sm text-gray-900",children:A.name}),u.jsx("p",{className:"text-xs text-gray-500",children:A.description}),u.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[A.slides.length," slides"]})]}),u.jsx("div",{className:"px-3 pb-3",children:u.jsx("button",{className:"w-full py-2 bg-primary-100 text-primary-700 rounded-lg text-sm font-medium group-hover:bg-primary-600 group-hover:text-white transition-colors",children:"Utiliser ce modle"})})]},A.id)})}),u.jsx("button",{onClick:()=>Ye(null),className:"w-full mt-4 py-2 text-gray-600 hover:text-gray-900 text-sm",children:" Gnrer de nouvelles options"})]}):u.jsxs(u.Fragment,{children:[u.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Dcrivez votre prsentation et l'IA gnrera plusieurs options  choisir."}),u.jsx("textarea",{value:b,onChange:A=>w(A.target.value),placeholder:"Ex: Une prsentation pour lever des fonds pour une app de livraison cologique...",className:"w-full h-32 p-3 border rounded-lg resize-none text-sm"}),u.jsxs("button",{onClick:fk,disabled:N,className:"w-full mt-3 py-3 bg-gradient-to-r from-primary-600 to-purple-600 text-white rounded-lg flex items-center justify-center gap-2 hover:opacity-90 disabled:opacity-50",children:[u.jsx(pi,{className:"w-4 h-4"}),N?"Gnration en cours...":"Gnrer des options"]}),u.jsx("div",{className:"mt-4 p-3 bg-purple-50 rounded-lg",children:u.jsxs("p",{className:"text-xs text-purple-700",children:[u.jsx("strong",{children:" Style Gamma :"})," L'IA gnre 3 versions diffrentes. Vous choisissez celle qui vous convient !"]})})]})]}),g==="design"&&u.jsxs("div",{children:[u.jsxs("div",{className:"flex gap-1 mb-4 p-1 bg-gray-100 rounded-lg",children:[u.jsx("button",{onClick:()=>mt("templates"),className:`flex-1 py-2 px-3 rounded-md text-sm font-medium transition-all ${pt==="templates"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Modles"}),u.jsx("button",{onClick:()=>mt("styles"),className:`flex-1 py-2 px-3 rounded-md text-sm font-medium transition-all ${pt==="styles"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Styles"})]}),pt==="templates"&&u.jsxs(u.Fragment,{children:[u.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Cliquez pour appliquer au slide actuel"}),u.jsx("div",{className:"grid grid-cols-2 gap-3",children:on.map(A=>{var $;return u.jsxs("button",{onClick:()=>fv(A),className:`rounded-lg overflow-hidden transition-all hover:scale-105 ${(($=c[h])==null?void 0:$.template)===A.id?"ring-2 ring-primary-500 ring-offset-2":"hover:shadow-lg"}`,children:[u.jsxs("div",{className:"w-full aspect-video p-2 flex flex-col justify-center",style:{background:A.previewBg||A.colors.bg},children:[u.jsx("div",{className:"h-2 w-3/4 rounded mb-1",style:{backgroundColor:A.colors.text,opacity:.9}}),u.jsx("div",{className:"h-1.5 w-1/2 rounded mb-2",style:{backgroundColor:A.colors.text,opacity:.5}}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("div",{className:"h-1 w-full rounded",style:{backgroundColor:A.colors.text,opacity:.3}}),u.jsx("div",{className:"h-1 w-4/5 rounded",style:{backgroundColor:A.colors.text,opacity:.3}})]})]}),u.jsxs("div",{className:"bg-white px-2 py-1.5 border-t",children:[u.jsx("p",{className:"text-xs font-medium text-gray-800 truncate",children:A.name}),u.jsx("p",{className:"text-[10px] text-gray-400",children:A.category})]})]},A.id)})})]}),pt==="styles"&&u.jsxs(u.Fragment,{children:[u.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Palettes de couleurs et polices"}),u.jsx("h4",{className:"font-medium text-gray-900 text-sm mb-2",children:"Palettes de couleurs"}),u.jsx("div",{className:"grid grid-cols-3 gap-2 mb-4",children:[{id:"warm",colors:["#FF6B6B","#FFA500","#FFD93D"],name:"Chaud",bg:"#FFF5F5",text:"#C41E3A"},{id:"cool",colors:["#6B5BFF","#00D4FF","#00FF88"],name:"Froid",bg:"#F0F4FF",text:"#1E3A8A"},{id:"earth",colors:["#8B4513","#DAA520","#228B22"],name:"Terre",bg:"#FAF5EF",text:"#5D4037"},{id:"ocean",colors:["#1E90FF","#00CED1","#20B2AA"],name:"Ocan",bg:"#E0F7FA",text:"#006064"},{id:"sunset",colors:["#FF4500","#FF6347","#FFB6C1"],name:"Coucher",bg:"#FFF3E0",text:"#E65100"},{id:"mono",colors:["#2C3E50","#7F8C8D","#ECF0F1"],name:"Mono",bg:"#FFFFFF",text:"#2C3E50"},{id:"purple",colors:["#9B59B6","#8E44AD","#E8DAEF"],name:"Violet",bg:"#F5EEF8",text:"#6C3483"},{id:"green",colors:["#27AE60","#2ECC71","#D5F5E3"],name:"Vert",bg:"#E8F8F5",text:"#1E8449"},{id:"dark",colors:["#1A1A2E","#16213E","#E94560"],name:"Sombre",bg:"#1A1A2E",text:"#FFFFFF"}].map(A=>u.jsxs("button",{onClick:()=>{const $={id:`custom-${A.id}`,name:A.name,colors:{bg:A.bg,text:A.text,accent:A.colors[0]}};fv($),V.success(`Palette "${A.name}" applique !`)},className:"p-2 rounded-lg border hover:border-primary-500 hover:shadow transition-all hover:scale-105",children:[u.jsx("div",{className:"flex gap-0.5 mb-1",children:A.colors.map(($,ae)=>u.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:$}},ae))}),u.jsx("p",{className:"text-[10px] text-gray-600",children:A.name})]},A.id))}),u.jsx("h4",{className:"font-medium text-gray-900 text-sm mb-2",children:"Combinaisons de polices"}),u.jsx("div",{className:"space-y-2",children:[{id:"modern",title:"Inter",body:"Inter",label:"Moderne"},{id:"classic",title:"Georgia",body:"Arial",label:"Classique"},{id:"elegant",title:"Playfair Display",body:"Georgia",label:"lgant"},{id:"tech",title:"Courier New",body:"Verdana",label:"Tech"},{id:"bold",title:"Impact",body:"Arial",label:"Audacieux"},{id:"friendly",title:"Comic Sans MS",body:"Verdana",label:"Amical"}].map(A=>u.jsxs("button",{onClick:()=>{var be,Pe,hr;const $=((be=c[h])==null?void 0:be.titleStyle)||{};at(h,"titleStyle",{...$,fontFamily:A.title});const ae=((Pe=c[h])==null?void 0:Pe.contentStyle)||{};at(h,"contentStyle",{...ae,fontFamily:A.body});const se=(((hr=c[h])==null?void 0:hr.elements)||[]).map(to=>to.type==="text"?{...to,fontFamily:to.fontSize>20?A.title:A.body}:to);at(h,"elements",se),V.success(`Police "${A.label}" applique !`)},className:"w-full p-3 border rounded-lg hover:border-primary-500 hover:shadow text-left transition-all hover:scale-[1.02]",children:[u.jsx("p",{className:"font-bold text-sm",style:{fontFamily:A.title},children:A.label}),u.jsx("p",{className:"text-xs text-gray-500",style:{fontFamily:A.body},children:"Texte de paragraphe"})]},A.id))})]})]}),g==="elements"&&u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"lments"}),u.jsx("div",{className:"flex flex-wrap gap-1 mb-4",children:Qi.map(A=>{const $=A.icon;return u.jsxs("button",{onClick:()=>Ji(A.id),className:`px-2 py-1.5 rounded-lg text-xs flex items-center gap-1 transition-all ${ha===A.id?"bg-primary-100 text-primary-700 font-medium":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[u.jsx($,{className:"w-3 h-3"}),A.name]},A.id)})}),u.jsx("div",{className:"grid grid-cols-4 gap-2",children:(ng=da[ha])==null?void 0:ng.map(A=>{const $=A.icon;return u.jsxs("button",{onClick:()=>hk(A,"icon"),className:"p-3 bg-gray-100 hover:bg-gray-200 rounded-lg group relative",title:A.name,children:[u.jsx($,{className:"w-6 h-6 mx-auto text-gray-700 group-hover:text-primary-600 transition-colors"}),u.jsx("span",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 text-[9px] text-gray-500 opacity-0 group-hover:opacity-100 whitespace-nowrap",children:A.name})]},A.id)})}),u.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg text-xs text-blue-700",children:u.jsxs("p",{children:[u.jsx("strong",{children:"Astuce :"})," Cliquez sur un lment pour l'ajouter au slide. Glissez pour le dplacer, utilisez les poignes pour redimensionner."]})})]}),g==="text"&&u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Ajouter du texte"}),u.jsxs("div",{className:"space-y-2 mb-4",children:[u.jsx("button",{onClick:()=>pd({text:"Titre",fontSize:32,fontWeight:"bold"}),className:"w-full p-3 bg-gray-100 hover:bg-gray-200 rounded-lg text-left",children:u.jsx("span",{className:"text-xl font-bold",children:"Ajouter un titre"})}),u.jsx("button",{onClick:()=>pd({text:"Sous-titre",fontSize:24,fontWeight:"600"}),className:"w-full p-3 bg-gray-100 hover:bg-gray-200 rounded-lg text-left",children:u.jsx("span",{className:"text-lg font-semibold",children:"Ajouter un sous-titre"})}),u.jsx("button",{onClick:()=>pd({text:"Corps de texte",fontSize:16,fontWeight:"normal"}),className:"w-full p-3 bg-gray-100 hover:bg-gray-200 rounded-lg text-left",children:u.jsx("span",{className:"text-sm",children:"Ajouter du texte"})})]}),Ne&&!z&&(()=>{var be;const A=Ne==="title"?"titleStyle":"contentStyle",$=((be=c[h])==null?void 0:be[A])||{},ae=Ne==="title"?32:18,ee=Ne==="title"?"bold":"normal",se=Pe=>{const hr={...$,...Pe};at(h,A,hr)};return u.jsxs("div",{className:"border-t pt-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsx("h4",{className:"font-medium text-gray-900",children:Ne==="title"?" Modifier le titre":" Modifier le contenu"}),u.jsx("button",{onClick:()=>Oe(null),className:"text-gray-400 hover:text-gray-600",children:u.jsx(Cr,{className:"w-4 h-4"})})]}),u.jsxs("div",{className:"mb-3",children:[u.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Police"}),u.jsx("select",{value:$.fontFamily||"Inter",onChange:Pe=>se({fontFamily:Pe.target.value}),className:"w-full border rounded-lg px-2 py-2 text-sm",style:{fontFamily:$.fontFamily||"Inter"},children:yt.map(Pe=>u.jsx("option",{value:Pe.id,style:{fontFamily:Pe.id},children:Pe.name},Pe.id))})]}),u.jsxs("div",{className:"mb-3",children:[u.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Taille"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>se({fontSize:Math.max(8,($.fontSize||ae)-2)}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded-lg",children:""}),u.jsx("input",{type:"number",min:"8",max:"200",value:$.fontSize||ae,onChange:Pe=>se({fontSize:parseInt(Pe.target.value)||ae}),className:"flex-1 border rounded-lg px-2 py-2 text-sm text-center"}),u.jsx("button",{onClick:()=>se({fontSize:Math.min(200,($.fontSize||ae)+2)}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded-lg",children:"+"})]})]}),u.jsxs("div",{className:"mb-3",children:[u.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Couleur"}),u.jsx("div",{className:"grid grid-cols-6 gap-1 mb-2",children:Ln.map(Pe=>u.jsx("button",{onClick:()=>se({color:Pe}),className:`w-7 h-7 rounded-md border-2 transition-all ${$.color===Pe?"border-primary-500 scale-110":"border-transparent hover:scale-105"}`,style:{backgroundColor:Pe}},Pe))}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"color",value:$.color||"#000000",onChange:Pe=>se({color:Pe.target.value}),className:"w-10 h-10 border rounded-lg cursor-pointer"}),u.jsx("input",{type:"text",value:$.color||"#000000",onChange:Pe=>se({color:Pe.target.value}),className:"flex-1 border rounded-lg px-2 text-sm font-mono"})]})]}),u.jsxs("div",{className:"mb-3",children:[u.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Style"}),u.jsxs("div",{className:"flex gap-1",children:[u.jsx("button",{onClick:()=>se({fontWeight:$.fontWeight==="bold"?"normal":"bold"}),className:`p-2.5 rounded-lg flex-1 ${($.fontWeight||ee)==="bold"?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,children:u.jsx(Jx,{className:"w-4 h-4 mx-auto"})}),u.jsx("button",{onClick:()=>se({italic:!$.italic}),className:`p-2.5 rounded-lg flex-1 ${$.italic?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,children:u.jsx(ty,{className:"w-4 h-4 mx-auto"})}),u.jsx("button",{onClick:()=>se({underline:!$.underline}),className:`p-2.5 rounded-lg flex-1 ${$.underline?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,children:u.jsx(oy,{className:"w-4 h-4 mx-auto"})}),u.jsx("button",{onClick:()=>se({strikethrough:!$.strikethrough}),className:`p-2.5 rounded-lg flex-1 ${$.strikethrough?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,children:u.jsx("span",{className:"text-sm font-medium line-through",children:"S"})})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Alignement"}),u.jsxs("div",{className:"flex gap-1",children:[u.jsx("button",{onClick:()=>se({align:"left"}),className:`p-2.5 rounded-lg flex-1 ${($.align||"left")==="left"?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,children:u.jsx(Yx,{className:"w-4 h-4 mx-auto"})}),u.jsx("button",{onClick:()=>se({align:"center"}),className:`p-2.5 rounded-lg flex-1 ${$.align==="center"?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,children:u.jsx(Xx,{className:"w-4 h-4 mx-auto"})}),u.jsx("button",{onClick:()=>se({align:"right"}),className:`p-2.5 rounded-lg flex-1 ${$.align==="right"?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,children:u.jsx(Qx,{className:"w-4 h-4 mx-auto"})})]})]})]})})(),z&&(()=>{var $,ae;const A=(ae=($=c[h])==null?void 0:$.elements)==null?void 0:ae.find(ee=>ee.id===z);return A?u.jsxs("div",{className:"border-t pt-4",children:[u.jsx("div",{className:"flex gap-1 mb-4 text-xs",children:[{id:"style",label:"Style"},{id:"effects",label:"Effets"},{id:"animate",label:"Animer"},{id:"position",label:"Position"}].map(ee=>u.jsx("button",{onClick:()=>$t(ee.id),className:`flex-1 py-2 px-2 rounded-lg font-medium transition-all ${zt===ee.id?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:ee.label},ee.id))}),zt==="style"&&u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Police"}),u.jsx("select",{value:A.fontFamily||"Inter",onChange:ee=>Ve(z,{fontFamily:ee.target.value}),className:"w-full border rounded-lg px-2 py-2 text-sm",style:{fontFamily:A.fontFamily},children:yt.map(ee=>u.jsx("option",{value:ee.id,style:{fontFamily:ee.id},children:ee.name},ee.id))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Taille"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>Ve(z,{fontSize:Math.max(8,(A.fontSize||16)-2)}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded-lg",children:""}),u.jsx("input",{type:"number",min:"8",max:"200",value:A.fontSize||16,onChange:ee=>Ve(z,{fontSize:parseInt(ee.target.value)||16}),className:"flex-1 border rounded-lg px-2 py-2 text-sm text-center"}),u.jsx("button",{onClick:()=>Ve(z,{fontSize:Math.min(200,(A.fontSize||16)+2)}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded-lg",children:"+"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Couleur du texte"}),u.jsx("div",{className:"grid grid-cols-6 gap-1 mb-2",children:Ln.map(ee=>u.jsx("button",{onClick:()=>Ve(z,{color:ee}),className:`w-7 h-7 rounded-md border-2 transition-all ${A.color===ee?"border-primary-500 scale-110":"border-transparent hover:scale-105"}`,style:{backgroundColor:ee}},ee))}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"color",value:A.color||"#000000",onChange:ee=>Ve(z,{color:ee.target.value}),className:"w-10 h-10 border rounded-lg cursor-pointer"}),u.jsx("input",{type:"text",value:A.color||"#000000",onChange:ee=>Ve(z,{color:ee.target.value}),className:"flex-1 border rounded-lg px-2 text-sm font-mono",placeholder:"#000000"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Style"}),u.jsxs("div",{className:"flex gap-1",children:[u.jsx("button",{onClick:()=>Ve(z,{fontWeight:A.fontWeight==="bold"?"normal":"bold"}),className:`p-2.5 rounded-lg flex-1 ${A.fontWeight==="bold"?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,title:"Gras",children:u.jsx(Jx,{className:"w-4 h-4 mx-auto"})}),u.jsx("button",{onClick:()=>Ve(z,{italic:!A.italic}),className:`p-2.5 rounded-lg flex-1 ${A.italic?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,title:"Italique",children:u.jsx(ty,{className:"w-4 h-4 mx-auto"})}),u.jsx("button",{onClick:()=>Ve(z,{underline:!A.underline}),className:`p-2.5 rounded-lg flex-1 ${A.underline?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,title:"Soulign",children:u.jsx(oy,{className:"w-4 h-4 mx-auto"})}),u.jsx("button",{onClick:()=>Ve(z,{strikethrough:!A.strikethrough}),className:`p-2.5 rounded-lg flex-1 ${A.strikethrough?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,title:"Barr",children:u.jsx("span",{className:"text-sm font-medium line-through",children:"S"})})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Alignement"}),u.jsxs("div",{className:"flex gap-1",children:[u.jsx("button",{onClick:()=>Ve(z,{align:"left"}),className:`p-2.5 rounded-lg flex-1 ${A.align==="left"||!A.align?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,children:u.jsx(Yx,{className:"w-4 h-4 mx-auto"})}),u.jsx("button",{onClick:()=>Ve(z,{align:"center"}),className:`p-2.5 rounded-lg flex-1 ${A.align==="center"?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,children:u.jsx(Xx,{className:"w-4 h-4 mx-auto"})}),u.jsx("button",{onClick:()=>Ve(z,{align:"right"}),className:`p-2.5 rounded-lg flex-1 ${A.align==="right"?"bg-primary-100 text-primary-700":"bg-gray-100 hover:bg-gray-200"}`,children:u.jsx(Qx,{className:"w-4 h-4 mx-auto"})})]})]})]}),zt==="effects"&&u.jsxs("div",{className:"space-y-3",children:[u.jsx("p",{className:"text-xs text-gray-500",children:"Choisissez un effet pour votre texte"}),u.jsx("div",{className:"grid grid-cols-2 gap-2",children:Tt.map(ee=>u.jsxs("button",{onClick:()=>Ve(z,{effect:ee.id}),className:`p-3 rounded-lg border-2 text-left transition-all ${A.effect===ee.id?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}`,children:[u.jsx("span",{className:"text-lg font-bold block",style:{...ee.style,color:A.color||"#000"},children:"Ag"}),u.jsx("span",{className:"text-xs text-gray-500",children:ee.name})]},ee.id))})]}),zt==="animate"&&u.jsxs("div",{className:"space-y-3",children:[u.jsx("p",{className:"text-xs text-gray-500",children:"Ajoutez une animation  votre texte"}),u.jsx("div",{className:"grid grid-cols-2 gap-2",children:Nt.map(ee=>u.jsxs("button",{onClick:()=>Ve(z,{animation:ee.id}),className:`p-3 rounded-lg border-2 text-center transition-all ${A.animation===ee.id?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}`,children:[u.jsx("div",{className:`text-2xl mb-1 ${ee.class}`,children:""}),u.jsx("span",{className:"text-xs text-gray-600",children:ee.name})]},ee.id))})]}),zt==="position"&&u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-xs text-gray-500 mb-2 block",children:"Aligner sur la page"}),u.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[u.jsx("button",{onClick:()=>Ve(z,{x:5,y:5}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded text-xs",children:" Haut-G"}),u.jsx("button",{onClick:()=>Ve(z,{x:50,y:5}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded text-xs",children:" Haut"}),u.jsx("button",{onClick:()=>Ve(z,{x:85,y:5}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded text-xs",children:" Haut-D"}),u.jsx("button",{onClick:()=>Ve(z,{x:5,y:45}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded text-xs",children:" Gauche"}),u.jsx("button",{onClick:()=>Ve(z,{x:50,y:45}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded text-xs",children:" Centre"}),u.jsx("button",{onClick:()=>Ve(z,{x:85,y:45}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded text-xs",children:" Droite"}),u.jsx("button",{onClick:()=>Ve(z,{x:5,y:85}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded text-xs",children:" Bas-G"}),u.jsx("button",{onClick:()=>Ve(z,{x:50,y:85}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded text-xs",children:" Bas"}),u.jsx("button",{onClick:()=>Ve(z,{x:85,y:85}),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded text-xs",children:" Bas-D"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs text-gray-500 mb-2 block",children:"Position prcise"}),u.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-[10px] text-gray-400",children:"X (%)"}),u.jsx("input",{type:"number",min:"0",max:"100",value:Math.round(A.x||0),onChange:ee=>Ve(z,{x:parseFloat(ee.target.value)||0}),className:"w-full border rounded px-2 py-1.5 text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-[10px] text-gray-400",children:"Y (%)"}),u.jsx("input",{type:"number",min:"0",max:"100",value:Math.round(A.y||0),onChange:ee=>Ve(z,{y:parseFloat(ee.target.value)||0}),className:"w-full border rounded px-2 py-1.5 text-sm"})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs text-gray-500 mb-2 block",children:"Rotation"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"range",min:"-180",max:"180",value:A.rotation||0,onChange:ee=>Ve(z,{rotation:parseInt(ee.target.value)}),className:"flex-1"}),u.jsxs("span",{className:"text-xs text-gray-600 w-12 text-right",children:[A.rotation||0,""]})]})]})]}),u.jsx("button",{type:"button",onClick:ee=>{ee.preventDefault(),ee.stopPropagation(),fd(z)},className:"w-full mt-4 py-2 text-red-600 bg-red-50 hover:bg-red-100 rounded-lg text-sm",children:"Supprimer le texte"})]}):null})()]}),g==="images"&&u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Images"}),u.jsx("input",{type:"file",ref:Z,onChange:ok,accept:"image/*",className:"hidden"}),u.jsxs("button",{onClick:()=>{var A;return(A=Z.current)==null?void 0:A.click()},className:"w-full p-8 border-2 border-dashed border-gray-300 rounded-lg hover:border-primary-500 hover:bg-primary-50 transition-colors",children:[u.jsx(iy,{className:"w-8 h-8 mx-auto text-gray-400 mb-2"}),u.jsx("p",{className:"text-sm text-gray-600",children:"Importer une image"})]}),j&&((ag=(rg=c[h])==null?void 0:rg.media)==null?void 0:ag.find(A=>A.id===j&&A.type==="image"))&&u.jsxs("div",{className:"mt-4 pt-4 border-t",children:[u.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Modifier l'image"}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Taille"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>Zi(j,-5,-5),className:"flex-1 py-2 bg-gray-100 hover:bg-gray-200 rounded text-sm",children:"- Petit"}),u.jsx("button",{onClick:()=>Zi(j,5,5),className:"flex-1 py-2 bg-gray-100 hover:bg-gray-200 rounded text-sm",children:"+ Grand"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Taille prcise"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"number",value:((sg=(ig=(og=c[h])==null?void 0:og.media)==null?void 0:ig.find(A=>A.id===j))==null?void 0:sg.width)||35,onChange:A=>{var ee;const ae=(((ee=c[h])==null?void 0:ee.media)||[]).map(se=>se.id===j?{...se,width:parseInt(A.target.value)}:se);at(h,"media",ae)},className:"w-full border rounded px-2 py-1 text-sm",placeholder:"Largeur %"}),u.jsx("input",{type:"number",value:((cg=(ug=(lg=c[h])==null?void 0:lg.media)==null?void 0:ug.find(A=>A.id===j))==null?void 0:cg.height)||40,onChange:A=>{var ee;const ae=(((ee=c[h])==null?void 0:ee.media)||[]).map(se=>se.id===j?{...se,height:parseInt(A.target.value)}:se);at(h,"media",ae)},className:"w-full border rounded px-2 py-1 text-sm",placeholder:"Hauteur %"})]})]}),u.jsx("button",{type:"button",onClick:A=>{A.preventDefault(),A.stopPropagation(),hd(j)},className:"w-full py-2 text-red-600 bg-red-50 hover:bg-red-100 rounded-lg text-sm",children:"Supprimer l'image"})]})]})]}),g==="videos"&&u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Vidos"}),u.jsx("input",{type:"file",ref:ne,onChange:sk,accept:"video/*",className:"hidden"}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("button",{onClick:()=>{var A;return(A=ne.current)==null?void 0:A.click()},className:"w-full p-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-primary-500 hover:bg-primary-50 transition-colors",children:[u.jsx(iy,{className:"w-6 h-6 mx-auto text-gray-400 mb-2"}),u.jsx("p",{className:"text-sm text-gray-600",children:"Importer vido locale"}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Max 50MB"})]}),u.jsx("div",{className:"text-center text-gray-400 text-sm",children:"ou"}),u.jsxs("button",{onClick:()=>P(!0),className:"w-full p-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-primary-500 hover:bg-primary-50 transition-colors",children:[u.jsx(yR,{className:"w-6 h-6 mx-auto text-gray-400 mb-2"}),u.jsx("p",{className:"text-sm text-gray-600",children:"Lien YouTube/Vimeo"})]})]}),j&&((hg=(dg=c[h])==null?void 0:dg.media)==null?void 0:hg.find(A=>A.id===j))&&u.jsxs("div",{className:"mt-4 pt-4 border-t",children:[u.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Modifier le mdia"}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Taille"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>Zi(j,-5,-5),className:"flex-1 py-2 bg-gray-100 hover:bg-gray-200 rounded text-sm",children:"- Petit"}),u.jsx("button",{onClick:()=>Zi(j,5,5),className:"flex-1 py-2 bg-gray-100 hover:bg-gray-200 rounded text-sm",children:"+ Grand"})]})]}),u.jsx("button",{type:"button",onClick:A=>{A.preventDefault(),A.stopPropagation(),hd(j)},className:"w-full py-2 text-red-600 bg-red-50 hover:bg-red-100 rounded-lg text-sm",children:"Supprimer"})]})]})]})]})}),u.jsx("div",{className:"flex-1 bg-gray-200 p-8 overflow-auto flex items-center justify-center",onMouseMove:uk,onMouseUp:pv,onMouseLeave:pv,children:u.jsx("div",{ref:ue,className:"bg-white rounded-lg shadow-xl overflow-hidden",style:{width:`${16*_/100*40}px`,aspectRatio:"16/9"},children:u.jsxs("div",{className:"w-full h-full p-8 relative select-none",style:{background:jl.bg,color:jl.text},onClick:()=>{T(null),M(null),Q(null),Oe(null)},children:[(pg=(fg=c[h])==null?void 0:fg.elements)==null?void 0:pg.map(A=>{if(A.type==="text"){const ae=z===A.id,ee=Tt.find(be=>be.id===A.effect)||Tt[0],se=Nt.find(be=>be.id===A.animation)||Nt[0];return u.jsxs("div",{onMouseDown:be=>ck(be,A.id),onDoubleClick:be=>dk(be,A),className:`absolute cursor-move hover:outline hover:outline-2 hover:outline-primary-300 ${ae?"outline outline-2 outline-primary-500":""} ${se.class}`,style:{left:`${A.x}%`,top:`${A.y}%`,fontSize:A.fontSize*_/100,fontWeight:A.fontWeight,fontFamily:A.fontFamily||"Inter",color:A.color,fontStyle:A.italic?"italic":"normal",textDecoration:`${A.underline?"underline":""} ${A.strikethrough?"line-through":""}`.trim()||"none",textAlign:A.align||"left",transform:A.rotation?`rotate(${A.rotation}deg)`:"none",minWidth:"50px",...ee.style},children:[ae?u.jsx("input",{type:"text",value:A.text,onChange:be=>Ve(A.id,{text:be.target.value}),className:"bg-transparent border-none outline-none w-full",style:{fontSize:"inherit",fontWeight:"inherit",fontFamily:"inherit",fontStyle:"inherit",textDecoration:"inherit",textAlign:"inherit",color:"inherit"},autoFocus:!0,onClick:be=>be.stopPropagation()}):A.text,ae&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"absolute -right-2 -bottom-2 w-4 h-4 bg-primary-500 rounded-full cursor-se-resize hover:bg-primary-600 hover:scale-110 transition-transform z-10",onMouseDown:be=>{be.preventDefault(),be.stopPropagation();const Pe=ue.current;if(!Pe)return;const hr=Pe.getBoundingClientRect();Ee({x:be.clientX,y:be.clientY,canvasWidth:hr.width,canvasHeight:hr.height}),ke(!0),_e("textResize"),Q(A.id)}}),u.jsx("button",{type:"button",onClick:be=>{be.preventDefault(),be.stopPropagation(),fd(A.id)},className:"absolute -top-3 -right-3 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-xs hover:bg-red-600",children:u.jsx(Cr,{className:"w-3 h-3"})}),u.jsxs("div",{className:"absolute -bottom-5 left-0 bg-black/60 text-white text-[10px] px-1.5 py-0.5 rounded whitespace-nowrap",children:[A.fontSize,"px"]})]})]},A.id)}const $=Lo().find(ae=>ae.id===A.elementId);if($){const ae=$.icon,ee=Ae===A.id;return u.jsxs("div",{onMouseDown:se=>Or(se,A.id,"element","drag"),onClick:se=>{se.stopPropagation(),Q(A.id)},className:`absolute cursor-move ${ee?"outline outline-2 outline-primary-500":"hover:outline hover:outline-2 hover:outline-primary-300"}`,style:{left:`${A.x}%`,top:`${A.y}%`,transform:"translate(-50%, -50%)"},children:[u.jsx(ae,{size:A.size*_/100,style:{color:A.color}}),ee&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"absolute -right-2 -bottom-2 w-4 h-4 bg-primary-500 rounded-full cursor-se-resize hover:bg-primary-600 hover:scale-110 transition-transform z-10",onMouseDown:se=>Or(se,A.id,"element","resize")}),u.jsx("div",{className:"absolute -left-2 -top-2 w-4 h-4 bg-primary-500 rounded-full cursor-nw-resize hover:bg-primary-600 hover:scale-110 transition-transform z-10",onMouseDown:se=>Or(se,A.id,"element","resize")}),u.jsx("button",{type:"button",onClick:se=>{se.preventDefault(),se.stopPropagation(),fd(A.id)},className:"absolute -top-4 left-1/2 -translate-x-1/2 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 z-10",children:u.jsx(Cr,{className:"w-3 h-3"})}),u.jsxs("div",{className:"absolute -bottom-5 left-1/2 -translate-x-1/2 bg-black/60 text-white text-[10px] px-1.5 py-0.5 rounded whitespace-nowrap",children:[Math.round(A.size),"px"]})]})]},A.id)}return null}),(vg=(mg=c[h])==null?void 0:mg.media)==null?void 0:vg.map(A=>u.jsxs("div",{onMouseDown:$=>Or($,A.id,"media","drag"),onClick:$=>{$.stopPropagation(),T(A.id),Q(null),y(A.type==="image"?"images":"videos")},className:`absolute cursor-move group ${j===A.id?"outline outline-2 outline-primary-500":"hover:outline hover:outline-2 hover:outline-primary-300"}`,style:{left:`${A.x}%`,top:`${A.y}%`,width:`${A.width}%`,height:`${A.height}%`},children:[A.type==="image"?u.jsx("img",{src:A.url,alt:"",className:"w-full h-full object-contain rounded-lg pointer-events-none",draggable:!1}):A.isLocal?u.jsx("video",{src:A.url,className:"w-full h-full object-contain rounded-lg",controls:!0}):u.jsx("iframe",{src:A.url,className:"w-full h-full rounded-lg pointer-events-none",frameBorder:"0"}),j===A.id&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"absolute -right-2 -bottom-2 w-4 h-4 bg-primary-500 rounded-full cursor-se-resize hover:bg-primary-600 hover:scale-110 transition-transform z-10",onMouseDown:$=>Or($,A.id,"media","resize")}),u.jsx("div",{className:"absolute -left-2 -top-2 w-4 h-4 bg-primary-500 rounded-full cursor-nw-resize hover:bg-primary-600 hover:scale-110 transition-transform z-10",onMouseDown:$=>Or($,A.id,"media","resize")}),u.jsx("div",{className:"absolute -right-2 -top-2 w-4 h-4 bg-primary-500 rounded-full cursor-ne-resize hover:bg-primary-600 hover:scale-110 transition-transform z-10",onMouseDown:$=>Or($,A.id,"media","resize")}),u.jsx("div",{className:"absolute -left-2 -bottom-2 w-4 h-4 bg-primary-500 rounded-full cursor-sw-resize hover:bg-primary-600 hover:scale-110 transition-transform z-10",onMouseDown:$=>Or($,A.id,"media","resize")}),u.jsx("button",{type:"button",onClick:$=>{$.preventDefault(),$.stopPropagation(),hd(A.id)},className:"absolute -top-4 right-1/2 translate-x-1/2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center text-xs hover:bg-red-600 shadow-lg z-10",children:u.jsx(Cr,{className:"w-3 h-3"})}),u.jsxs("div",{className:"absolute bottom-1 left-1 bg-black/50 text-white text-xs px-1.5 py-0.5 rounded z-10",children:[Math.round(A.width),"%  ",Math.round(A.height),"%"]})]})]},A.id)),u.jsx("div",{onMouseDown:A=>{if(A.target.tagName==="INPUT")return;A.preventDefault(),A.stopPropagation();const $=ue.current;if(!$)return;const ae=$.getBoundingClientRect();Ee({x:A.clientX,y:A.clientY,canvasWidth:ae.width,canvasHeight:ae.height}),Oe("title"),ye(!0),_e("slideTitle")},onClick:A=>{A.stopPropagation(),Oe("title"),M(null),y("text")},className:`absolute cursor-move rounded-lg transition-all ${Ne==="title"?"ring-2 ring-primary-500 bg-white/10":"hover:bg-white/5"}`,style:{left:`${((xg=(gg=c[h])==null?void 0:gg.titleStyle)==null?void 0:xg.x)||5}%`,top:`${((bg=(yg=c[h])==null?void 0:yg.titleStyle)==null?void 0:bg.y)||10}%`,maxWidth:"90%"},children:u.jsx("input",{type:"text",value:((wg=c[h])==null?void 0:wg.title)||"",onChange:A=>at(h,"title",A.target.value),className:"bg-transparent border-none outline-none px-2 py-1 cursor-text",style:{color:((Cg=(Ng=c[h])==null?void 0:Ng.titleStyle)==null?void 0:Cg.color)||jl.text,fontSize:`${(((jg=(kg=c[h])==null?void 0:kg.titleStyle)==null?void 0:jg.fontSize)||32)*_/100}px`,fontWeight:((Eg=(Sg=c[h])==null?void 0:Sg.titleStyle)==null?void 0:Eg.fontWeight)||"bold",fontFamily:((Rg=(_g=c[h])==null?void 0:_g.titleStyle)==null?void 0:Rg.fontFamily)||"Inter",fontStyle:(Ag=(Ig=c[h])==null?void 0:Ig.titleStyle)!=null&&Ag.italic?"italic":"normal",textDecoration:`${(Tg=(Dg=c[h])==null?void 0:Dg.titleStyle)!=null&&Tg.underline?"underline":""} ${(Fg=(Pg=c[h])==null?void 0:Pg.titleStyle)!=null&&Fg.strikethrough?"line-through":""}`.trim()||"none",textAlign:((Og=(Mg=c[h])==null?void 0:Mg.titleStyle)==null?void 0:Og.align)||"left",minWidth:"100px"},placeholder:"Titre"})}),u.jsx("div",{onMouseDown:A=>{if(A.target.tagName==="TEXTAREA")return;A.preventDefault(),A.stopPropagation();const $=ue.current;if(!$)return;const ae=$.getBoundingClientRect();Ee({x:A.clientX,y:A.clientY,canvasWidth:ae.width,canvasHeight:ae.height}),Oe("content"),ye(!0),_e("slideContent")},onClick:A=>{A.stopPropagation(),Oe("content"),M(null),y("text")},className:`absolute cursor-move rounded-lg transition-all ${Ne==="content"?"ring-2 ring-primary-500 bg-white/10":"hover:bg-white/5"}`,style:{left:`${((Bg=(Lg=c[h])==null?void 0:Lg.contentStyle)==null?void 0:Bg.x)||5}%`,top:`${(($g=(zg=c[h])==null?void 0:zg.contentStyle)==null?void 0:$g.y)||30}%`,maxWidth:"90%"},children:u.jsx("textarea",{value:((Ug=c[h])==null?void 0:Ug.content)||"",onChange:A=>at(h,"content",A.target.value),className:"bg-transparent border-none outline-none resize-none min-h-[60px] px-2 py-1 cursor-text",style:{color:((Vg=(Wg=c[h])==null?void 0:Wg.contentStyle)==null?void 0:Vg.color)||jl.text,fontSize:`${(((Gg=(Hg=c[h])==null?void 0:Hg.contentStyle)==null?void 0:Gg.fontSize)||18)*_/100}px`,fontWeight:((Kg=(qg=c[h])==null?void 0:qg.contentStyle)==null?void 0:Kg.fontWeight)||"normal",fontFamily:((Yg=(Xg=c[h])==null?void 0:Xg.contentStyle)==null?void 0:Yg.fontFamily)||"Inter",fontStyle:(Jg=(Qg=c[h])==null?void 0:Qg.contentStyle)!=null&&Jg.italic?"italic":"normal",textDecoration:`${(e0=(Zg=c[h])==null?void 0:Zg.contentStyle)!=null&&e0.underline?"underline":""} ${(n0=(t0=c[h])==null?void 0:t0.contentStyle)!=null&&n0.strikethrough?"line-through":""}`.trim()||"none",textAlign:((a0=(r0=c[h])==null?void 0:r0.contentStyle)==null?void 0:a0.align)||"left"},placeholder:"Contenu..."})})]})})}),u.jsxs("div",{className:"w-48 bg-gray-900 p-4 overflow-y-auto",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("span",{className:"text-white text-sm font-medium",children:"Slides"}),u.jsx("button",{onClick:nk,className:"p-1 hover:bg-gray-700 rounded text-gray-400 hover:text-white",children:u.jsx(Ua,{className:"w-4 h-4"})})]}),u.jsx("div",{className:"space-y-2",children:c.map((A,$)=>{var ee;const ae=Bo(A.template);return u.jsxs("button",{onClick:()=>f($),className:`w-full rounded-lg overflow-hidden border-2 transition-all ${h===$?"border-primary-500":"border-transparent hover:border-gray-600"}`,children:[u.jsxs("div",{className:"aspect-video p-2 text-left",style:{background:ae.bg,color:ae.text},children:[u.jsx("p",{className:"text-[8px] font-bold truncate",children:A.title}),u.jsx("p",{className:"text-[6px] opacity-70 truncate",children:(ee=A.content)==null?void 0:ee.substring(0,30)})]}),u.jsxs("div",{className:"bg-gray-800 px-2 py-1 flex items-center justify-between",children:[u.jsx("span",{className:"text-[10px] text-gray-400",children:$+1}),u.jsxs("div",{className:"flex gap-1",children:[u.jsx("button",{onClick:se=>{se.stopPropagation(),rk()},className:"p-0.5 hover:bg-gray-700 rounded",children:u.jsx(rR,{className:"w-3 h-3 text-gray-400"})}),u.jsx("button",{onClick:se=>{se.stopPropagation(),ak()},className:"p-0.5 hover:bg-gray-700 rounded",children:u.jsx(Qa,{className:"w-3 h-3 text-gray-400"})})]})]})]},A.id||$)})})]})]}),L&&u.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:u.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Ajouter une vido"}),u.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Collez l'URL YouTube ou Vimeo"}),u.jsx("input",{type:"text",value:B,onChange:A=>K(A.target.value),placeholder:"https://www.youtube.com/watch?v=...",className:"w-full border rounded-lg px-3 py-2 mb-4",autoFocus:!0}),u.jsxs("div",{className:"flex gap-2 justify-end",children:[u.jsx("button",{onClick:()=>{P(!1),K("")},className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:"Annuler"}),u.jsx("button",{onClick:ik,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"Ajouter"})]})]})})]})},j6=()=>{const{projectId:e}=aa(),[t,n]=I.useState(!0),[r,a]=I.useState(null),[o,i]=I.useState({todo:{title:" faire",tasks:[]},in_progress:{title:"En cours",tasks:[]},done:{title:"Termin",tasks:[]}}),[s,l]=I.useState(!1),[c,d]=I.useState(null),[h,f]=I.useState({title:"",description:"",priority:"medium",dueDate:"",status:"todo",assignedTo:""}),[p,v]=I.useState([]);I.useEffect(()=>{g()},[e]);const g=async()=>{try{const[j,T,L]=await Promise.all([ie.get(`/projects/${e}`),ie.get(`/tasks/project/${e}/kanban`),ie.get(`/team-members/${e}`)]);a(j.data.project),i(T.data.columns),v(L.data.members||[])}catch{V.error("Erreur lors du chargement")}finally{n(!1)}},y=async j=>{var T,L;j.preventDefault();try{c?(await ie.put(`/tasks/${c.id}`,h),V.success("Tche mise  jour")):(await ie.post(`/tasks/project/${e}`,h),V.success("Tche cre")),g(),w()}catch(P){V.error(((L=(T=P.response)==null?void 0:T.data)==null?void 0:L.message)||"Erreur")}},m=async(j,T)=>{try{await ie.patch(`/tasks/${j}/status`,{status:T}),g()}catch{V.error("Erreur")}},x=async j=>{if(confirm("Supprimer cette tche ?"))try{await ie.delete(`/tasks/${j}`),V.success("Tche supprime"),g()}catch{V.error("Erreur")}},b=(j=null,T="todo")=>{j?(d(j),f({title:j.title,description:j.description||"",priority:j.priority||"medium",dueDate:j.dueDate?j.dueDate.split("T")[0]:"",status:j.status,assignedTo:j.assignedTo||""})):(d(null),f({title:"",description:"",priority:"medium",dueDate:"",status:T,assignedTo:""})),l(!0)},w=()=>{l(!1),d(null),f({title:"",description:"",priority:"medium",dueDate:"",status:"todo",assignedTo:""})},N=j=>{var L;if(!j)return null;const T=p.find(P=>P.userId===j||P.id===j);return T?T.firstName?`${T.firstName} ${((L=T.lastName)==null?void 0:L[0])||""}`:T.email.split("@")[0]:null},C={low:"bg-green-100 text-green-700",medium:"bg-yellow-100 text-yellow-700",high:"bg-red-100 text-red-700"},S={low:"Basse",medium:"Moyenne",high:"Haute"},k={todo:"border-gray-300",in_progress:"border-blue-400",done:"border-green-400"};if(t)return u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});const _=Object.values(o).reduce((j,T)=>j+T.tasks.length,0),E=o.done.tasks.length;return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(Fe,{to:`/projects/${e}`,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:u.jsx(Ir,{className:"w-5 h-5"})}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Gestion des Tches"}),u.jsx("p",{className:"text-gray-600",children:r==null?void 0:r.name})]})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsxs("div",{className:"text-sm text-gray-600",children:[u.jsx(Tn,{className:"w-4 h-4 inline mr-1 text-green-500"}),E,"/",_," tches compltes"]}),u.jsxs("button",{onClick:()=>b(),className:"btn-primary flex items-center gap-2",children:[u.jsx(Ua,{className:"w-5 h-5"}),"Nouvelle tche"]})]})]}),u.jsx("div",{className:"grid md:grid-cols-3 gap-4",children:Object.entries(o).map(([j,T])=>u.jsxs("div",{className:`bg-gray-50 rounded-xl p-4 border-t-4 ${k[j]}`,children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("h3",{className:"font-semibold text-gray-900",children:[T.title,u.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",T.tasks.length,")"]})]}),u.jsx("button",{onClick:()=>b(null,j),className:"p-1.5 text-gray-500 hover:text-primary-600 hover:bg-white rounded-lg",children:u.jsx(Ua,{className:"w-5 h-5"})})]}),u.jsxs("div",{className:"space-y-3 min-h-[200px]",children:[T.tasks.map(L=>u.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:[u.jsxs("div",{className:"flex items-start justify-between mb-2",children:[u.jsx("h4",{className:"font-medium text-gray-900",children:L.title}),u.jsxs("div",{className:"flex gap-1",children:[u.jsx("button",{onClick:()=>b(L),className:"p-1 text-gray-400 hover:text-primary-600 rounded",children:u.jsx(im,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>x(L.id),className:"p-1 text-gray-400 hover:text-red-600 rounded",children:u.jsx(Qa,{className:"w-4 h-4"})})]})]}),L.description&&u.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:L.description}),u.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[u.jsxs("span",{className:`badge ${C[L.priority]}`,children:[u.jsx(Cw,{className:"w-3 h-3 mr-1"}),S[L.priority]]}),L.dueDate&&u.jsxs("span",{className:"badge bg-gray-100 text-gray-700",children:[u.jsx(bw,{className:"w-3 h-3 mr-1"}),new Date(L.dueDate).toLocaleDateString("fr-FR")]}),L.assignedTo&&N(L.assignedTo)&&u.jsxs("span",{className:"badge bg-indigo-100 text-indigo-700",children:[u.jsx(ta,{className:"w-3 h-3 mr-1"}),N(L.assignedTo)]})]}),j!=="done"&&u.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100 flex gap-2",children:[j==="todo"&&u.jsx("button",{onClick:()=>m(L.id,"in_progress"),className:"text-xs text-blue-600 hover:underline",children:"Dmarrer "}),j==="in_progress"&&u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>m(L.id,"todo"),className:"text-xs text-gray-600 hover:underline",children:"  faire"}),u.jsx("button",{onClick:()=>m(L.id,"done"),className:"text-xs text-green-600 hover:underline",children:"Terminer "})]})]})]},L.id)),T.tasks.length===0&&u.jsx("div",{className:"text-center py-8 text-gray-400",children:u.jsx("p",{className:"text-sm",children:"Aucune tche"})})]})]},j))}),s&&u.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg",children:[u.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[u.jsx("h2",{className:"text-xl font-semibold",children:c?"Modifier la tche":"Nouvelle tche"}),u.jsx("button",{onClick:w,className:"text-gray-500 hover:text-gray-700",children:u.jsx(Cr,{className:"w-6 h-6"})})]}),u.jsxs("form",{onSubmit:y,className:"p-6 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Titre *"}),u.jsx("input",{type:"text",value:h.title,onChange:j=>f({...h,title:j.target.value}),className:"input-field",placeholder:"Titre de la tche",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),u.jsx("textarea",{value:h.description,onChange:j=>f({...h,description:j.target.value}),className:"input-field resize-none",rows:3,placeholder:"Description de la tche..."})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priorit"}),u.jsxs("select",{value:h.priority,onChange:j=>f({...h,priority:j.target.value}),className:"input-field",children:[u.jsx("option",{value:"low",children:"Basse"}),u.jsx("option",{value:"medium",children:"Moyenne"}),u.jsx("option",{value:"high",children:"Haute"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date limite"}),u.jsx("input",{type:"date",value:h.dueDate,onChange:j=>f({...h,dueDate:j.target.value}),className:"input-field"})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut"}),u.jsxs("select",{value:h.status,onChange:j=>f({...h,status:j.target.value}),className:"input-field",children:[u.jsx("option",{value:"todo",children:" faire"}),u.jsx("option",{value:"in_progress",children:"En cours"}),u.jsx("option",{value:"done",children:"Termin"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assign "}),u.jsxs("select",{value:h.assignedTo,onChange:j=>f({...h,assignedTo:j.target.value}),className:"input-field",children:[u.jsx("option",{value:"",children:"Non assign"}),p.filter(j=>j.status==="active").map(j=>u.jsx("option",{value:j.userId||j.id,children:j.firstName?`${j.firstName} ${j.lastName||""}`:j.email},j.id))]})]})]}),u.jsxs("div",{className:"flex gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:w,className:"btn-secondary flex-1",children:"Annuler"}),u.jsx("button",{type:"submit",className:"btn-primary flex-1",children:c?"Enregistrer":"Crer la tche"})]})]})]})})]})},S6=()=>{const{id:e}=aa(),[t,n]=I.useState(null),[r,a]=I.useState([]),[o,i]=I.useState(!0),[s,l]=I.useState(!1),[c,d]=I.useState(""),[h,f]=I.useState("member"),[p,v]=I.useState(!1);I.useEffect(()=>{g()},[e]);const g=async()=>{try{const[C,S]=await Promise.all([ie.get(`/projects/${e}`),ie.get(`/team-members/${e}`)]);n(C.data.project),a(S.data.members)}catch{V.error("Erreur lors du chargement")}finally{i(!1)}},y=async C=>{var S,k;if(C.preventDefault(),!!c.trim()){v(!0);try{const _=await ie.post(`/team-members/${e}`,{email:c,role:h});a([_.data.member,...r]),d(""),f("member"),l(!1),V.success(_.data.message)}catch(_){V.error(((k=(S=_.response)==null?void 0:S.data)==null?void 0:k.message)||"Erreur lors de l'ajout")}finally{v(!1)}}},m=async(C,S)=>{try{await ie.put(`/team-members/${e}/${C}`,{role:S}),a(r.map(k=>k.id===C?{...k,role:S}:k)),V.success("Rle mis  jour")}catch{V.error("Erreur lors de la mise  jour")}},x=async C=>{if(confirm("tes-vous sr de vouloir retirer ce membre ?"))try{await ie.delete(`/team-members/${e}/${C}`),a(r.filter(S=>S.id!==C)),V.success("Membre retir")}catch{V.error("Erreur lors de la suppression")}},b=C=>{switch(C){case"admin":return u.jsx(jf,{className:"w-4 h-4 text-yellow-500"});case"member":return u.jsx(Mi,{className:"w-4 h-4 text-blue-500"});case"viewer":return u.jsx(Eo,{className:"w-4 h-4 text-gray-500"});default:return u.jsx(un,{className:"w-4 h-4 text-gray-500"})}},w=C=>{switch(C){case"admin":return"bg-yellow-100 text-yellow-800";case"member":return"bg-blue-100 text-blue-800";case"viewer":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},N=C=>{switch(C){case"active":return"bg-green-100 text-green-800";case"pending":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}};return o?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(Fe,{to:`/projects/${e}`,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:u.jsx(Ir,{className:"w-5 h-5"})}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Membres d'quipe"}),u.jsx("p",{className:"text-gray-600",children:t==null?void 0:t.name})]})]}),u.jsxs("button",{onClick:()=>l(!0),className:"btn-primary flex items-center gap-2",children:[u.jsx(Iw,{className:"w-5 h-5"}),"Ajouter un membre"]})]}),u.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[u.jsx("div",{className:"card",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:u.jsx(un,{className:"w-5 h-5 text-blue-600"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.length}),u.jsx("p",{className:"text-sm text-gray-600",children:"Total membres"})]})]})}),u.jsx("div",{className:"card",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:u.jsx(tm,{className:"w-5 h-5 text-green-600"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.filter(C=>C.status==="active").length}),u.jsx("p",{className:"text-sm text-gray-600",children:"Membres actifs"})]})]})}),u.jsx("div",{className:"card",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:u.jsx(Pi,{className:"w-5 h-5 text-orange-600"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.filter(C=>C.status==="pending").length}),u.jsx("p",{className:"text-sm text-gray-600",children:"En attente"})]})]})})]}),u.jsxs("div",{className:"card",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Liste des membres"}),r.length===0?u.jsxs("div",{className:"text-center py-12",children:[u.jsx(un,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-500",children:"Aucun membre dans l'quipe"}),u.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Ajoutez des membres pour collaborer sur ce projet"})]}):u.jsx("div",{className:"space-y-3",children:r.map(C=>u.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl hover:bg-gray-100 transition-colors",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-primary-400 to-primary-600 rounded-full flex items-center justify-center text-white font-semibold",children:C.firstName?C.firstName[0]:C.email[0].toUpperCase()}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("p",{className:"font-medium text-gray-900",children:C.firstName&&C.lastName?`${C.firstName} ${C.lastName}`:C.email}),b(C.role)]}),u.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[u.jsx(ea,{className:"w-3 h-3 text-gray-400"}),u.jsx("span",{className:"text-sm text-gray-500",children:C.email})]})]})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${N(C.status)}`,children:C.status==="active"?"Actif":"En attente"}),u.jsxs("select",{value:C.role,onChange:S=>m(C.id,S.target.value),className:`px-3 py-1.5 rounded-lg text-sm font-medium border-0 cursor-pointer ${w(C.role)}`,children:[u.jsx("option",{value:"admin",children:"Admin"}),u.jsx("option",{value:"member",children:"Membre"}),u.jsx("option",{value:"viewer",children:"Lecteur"})]}),u.jsx("button",{onClick:()=>x(C.id),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"Retirer le membre",children:u.jsx(Qa,{className:"w-4 h-4"})})]})]},C.id))})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Niveaux d'accs"}),u.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[u.jsxs("div",{className:"p-4 bg-yellow-50 rounded-xl border border-yellow-100",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx(jf,{className:"w-5 h-5 text-yellow-600"}),u.jsx("span",{className:"font-medium text-yellow-800",children:"Admin"})]}),u.jsx("p",{className:"text-sm text-yellow-700",children:"Peut grer les membres, crer et modifier toutes les tches"})]}),u.jsxs("div",{className:"p-4 bg-blue-50 rounded-xl border border-blue-100",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx(Mi,{className:"w-5 h-5 text-blue-600"}),u.jsx("span",{className:"font-medium text-blue-800",children:"Membre"})]}),u.jsx("p",{className:"text-sm text-blue-700",children:"Peut crer des tches et modifier celles qui lui sont assignes"})]}),u.jsxs("div",{className:"p-4 bg-gray-50 rounded-xl border border-gray-200",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx(Eo,{className:"w-5 h-5 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-800",children:"Lecteur"})]}),u.jsx("p",{className:"text-sm text-gray-600",children:"Peut voir le projet et les tches sans pouvoir les modifier"})]})]})]}),s&&u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Ajouter un membre"}),u.jsx("button",{onClick:()=>l(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:u.jsx(Cr,{className:"w-5 h-5"})})]}),u.jsxs("form",{onSubmit:y,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Adresse email"}),u.jsxs("div",{className:"relative",children:[u.jsx(ea,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"email",value:c,onChange:C=>d(C.target.value),placeholder:"membre@exemple.com",className:"input pl-10",required:!0})]}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Si l'utilisateur existe, il recevra une notification. Sinon, une invitation sera cre."})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rle"}),u.jsxs("select",{value:h,onChange:C=>f(C.target.value),className:"input",children:[u.jsx("option",{value:"admin",children:"Admin - Accs complet"}),u.jsx("option",{value:"member",children:"Membre - Peut crer et modifier ses tches"}),u.jsx("option",{value:"viewer",children:"Lecteur - Lecture seule"})]})]}),u.jsxs("div",{className:"flex gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:()=>l(!1),className:"flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 font-medium",children:"Annuler"}),u.jsx("button",{type:"submit",disabled:p||!c.trim(),className:"flex-1 btn-primary disabled:opacity-50",children:p?"Ajout...":"Ajouter"})]})]})]})})]})},E6=()=>{const{token:e}=aa(),t=sr(),{setAuth:n}=ur(),[r,a]=I.useState(!0),[o,i]=I.useState(!1),[s,l]=I.useState(null),[c,d]=I.useState(null),[h,f]=I.useState({firstName:"",lastName:"",password:"",confirmPassword:""});I.useEffect(()=>{p()},[e]);const p=async()=>{var y,m;try{const x=await ie.get(`/auth/invite/${e}`);l(x.data)}catch(x){d(((m=(y=x.response)==null?void 0:y.data)==null?void 0:m.message)||"Invitation invalide ou expire")}finally{a(!1)}},v=async y=>{var m,x;if(y.preventDefault(),h.password!==h.confirmPassword){V.error("Les mots de passe ne correspondent pas");return}i(!0);try{const b=await ie.post(`/auth/invite/${e}/register`,{firstName:h.firstName,lastName:h.lastName,password:h.password});n(b.data.token,b.data.user),V.success("Compte cr avec succs ! Bienvenue dans l'quipe !"),t(`/projects/${b.data.projectId}`)}catch(b){V.error(((x=(m=b.response)==null?void 0:m.data)==null?void 0:x.message)||"Erreur lors de la cration du compte")}finally{i(!1)}},g={admin:"Administrateur",member:"Membre",viewer:"Lecteur"};return r?u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:u.jsxs("div",{className:"text-center text-white",children:[u.jsx(Ma,{className:"w-12 h-12 animate-spin mx-auto mb-4 text-cyan-400"}),u.jsx("p",{className:"text-xl",children:"Vrification de l'invitation..."})]})}):c?u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-4",children:u.jsxs("div",{className:"bg-white/10 backdrop-blur-xl rounded-2xl p-8 max-w-md w-full text-center",children:[u.jsx("div",{className:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:u.jsx("span",{className:"text-3xl",children:""})}),u.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Invitation invalide"}),u.jsx("p",{className:"text-gray-300 mb-6",children:c}),u.jsx(Fe,{to:"/login",className:"inline-block bg-primary-600 text-white px-6 py-3 rounded-xl hover:bg-primary-700 transition-colors",children:"Aller  la connexion"})]})}):u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-4",children:u.jsxs("div",{className:"bg-white/10 backdrop-blur-xl rounded-2xl p-8 max-w-md w-full",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-cyan-400 to-purple-500 rounded-2xl flex items-center justify-center mx-auto mb-4",children:u.jsx(un,{className:"w-8 h-8 text-white"})}),u.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Rejoindre l'quipe"}),u.jsx("p",{className:"text-gray-300",children:"Vous avez t invit(e) au projet"}),u.jsxs("p",{className:"text-cyan-400 font-semibold text-lg mt-1",children:['"',s==null?void 0:s.projectName,'"']})]}),u.jsxs("div",{className:"bg-white/5 rounded-xl p-4 mb-6 space-y-2",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(ea,{className:"w-5 h-5 text-gray-400"}),u.jsx("span",{className:"text-white",children:s==null?void 0:s.email})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(Tn,{className:"w-5 h-5 text-green-400"}),u.jsxs("span",{className:"text-gray-300",children:["Rle : ",u.jsx("span",{className:"text-white font-medium",children:g[s==null?void 0:s.role]})]})]})]}),u.jsxs("form",{onSubmit:v,className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Prnom"}),u.jsxs("div",{className:"relative",children:[u.jsx(ta,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"text",value:h.firstName,onChange:y=>f({...h,firstName:y.target.value}),className:"w-full bg-white/10 border border-white/20 rounded-xl py-3 pl-10 pr-4 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-400",placeholder:"Prnom",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Nom"}),u.jsxs("div",{className:"relative",children:[u.jsx(ta,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"text",value:h.lastName,onChange:y=>f({...h,lastName:y.target.value}),className:"w-full bg-white/10 border border-white/20 rounded-xl py-3 pl-10 pr-4 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-400",placeholder:"Nom",required:!0})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Mot de passe"}),u.jsxs("div",{className:"relative",children:[u.jsx(_o,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"password",value:h.password,onChange:y=>f({...h,password:y.target.value}),className:"w-full bg-white/10 border border-white/20 rounded-xl py-3 pl-10 pr-4 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-400",placeholder:"",minLength:6,required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Confirmer le mot de passe"}),u.jsxs("div",{className:"relative",children:[u.jsx(_o,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"password",value:h.confirmPassword,onChange:y=>f({...h,confirmPassword:y.target.value}),className:"w-full bg-white/10 border border-white/20 rounded-xl py-3 pl-10 pr-4 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-400",placeholder:"",minLength:6,required:!0})]})]}),u.jsx("button",{type:"submit",disabled:o,className:"w-full bg-gradient-to-r from-cyan-500 to-purple-600 text-white py-3 rounded-xl font-semibold hover:opacity-90 transition-opacity disabled:opacity-50 flex items-center justify-center gap-2",children:o?u.jsxs(u.Fragment,{children:[u.jsx(Ma,{className:"w-5 h-5 animate-spin"}),"Cration en cours..."]}):"Crer mon compte et rejoindre"})]}),u.jsxs("p",{className:"text-center text-gray-400 text-sm mt-6",children:["Vous avez dj un compte ?"," ",u.jsx(Fe,{to:"/login",className:"text-cyan-400 hover:underline",children:"Se connecter"})]})]})})},_6=()=>{const e=sr(),{isAuthenticated:t,user:n}=ur(),[r,a]=I.useState([]),[o,i]=I.useState(!0),[s,l]=I.useState(null),[c,d]=I.useState([]),[h,f]=I.useState(null),[p,v]=I.useState(!1);I.useEffect(()=>{g()},[]);const g=async()=>{try{const[x,b]=await Promise.all([ie.get("/payments/plans"),ie.get("/payments/methods")]);a(x.data.plans||[]),d(b.data.methods||[])}catch(x){console.error("Error fetching plans:",x)}finally{i(!1)}},y=x=>{if(!t){V.error("Connectez-vous pour choisir un plan"),e("/login");return}if(x.id==="free"){V.info("Vous tes dj sur le plan gratuit");return}l(x)},m=async()=>{var x,b;if(!h){V.error("Choisissez une mthode de paiement");return}v(!0);try{const w=await ie.post("/payments/initiate",{planId:s.id,paymentMethod:h});V.success("Paiement initi !"),await ie.post(`/payments/confirm/${w.data.transactionId}`),V.success("Abonnement activ avec succs !"),l(null),e("/dashboard")}catch(w){V.error(((b=(x=w.response)==null?void 0:x.data)==null?void 0:b.message)||"Erreur de paiement")}finally{v(!1)}};return o?u.jsx("div",{className:"min-h-screen flex items-center justify-center",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):u.jsxs("div",{className:"min-h-screen bg-gray-50",children:[u.jsx("nav",{className:"bg-white border-b border-gray-200",children:u.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs(Fe,{to:"/",className:"flex items-center gap-2",children:[u.jsx(Ar,{className:"w-8 h-8 text-primary-600"}),u.jsx("span",{className:"text-xl font-bold gradient-text",children:"StartUpLab"})]}),t?u.jsxs(Fe,{to:"/dashboard",className:"btn-secondary flex items-center gap-2",children:[u.jsx(Ir,{className:"w-4 h-4"}),"Retour au tableau de bord"]}):u.jsx(Fe,{to:"/login",className:"btn-primary",children:"Se connecter"})]})})}),u.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-12",children:[u.jsxs("div",{className:"text-center mb-12",children:[u.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"Choisissez votre plan"}),u.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Des tarifs adapts  chaque tape de votre startup. Commencez gratuitement et voluez selon vos besoins."})]}),u.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12",children:r.map(x=>{const b=(n==null?void 0:n.subscription)===x.id,w=x.id==="pro";return u.jsxs("div",{className:`card relative ${w?"border-2 border-primary-500 shadow-lg":""}`,children:[w&&u.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:u.jsx("span",{className:"bg-primary-600 text-white text-xs font-medium px-3 py-1 rounded-full",children:"Populaire"})}),u.jsxs("div",{className:"text-center mb-6",children:[u.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:x.name}),u.jsxs("div",{className:"flex items-baseline justify-center gap-1",children:[u.jsx("span",{className:"text-4xl font-bold text-gray-900",children:x.price}),u.jsxs("span",{className:"text-gray-600",children:[x.currency,"/",x.period||"gratuit"]})]})]}),u.jsx("ul",{className:"space-y-3 mb-6",children:x.features.map((N,C)=>u.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[u.jsx(tm,{className:"w-5 h-5 text-green-500 shrink-0"}),u.jsx("span",{className:"text-gray-600",children:N})]},C))}),u.jsx("button",{onClick:()=>y(x),disabled:b,className:`w-full py-3 rounded-lg font-medium transition-colors ${b?"bg-gray-100 text-gray-500 cursor-not-allowed":w?"btn-primary":"btn-secondary"}`,children:b?"Plan actuel":x.price===0?"Commencer":"Choisir ce plan"})]},x.id)})}),s&&u.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md",children:[u.jsxs("div",{className:"p-6 border-b border-gray-200",children:[u.jsxs("h2",{className:"text-xl font-semibold",children:["Paiement - ",s.name]}),u.jsxs("p",{className:"text-gray-600",children:[s.price," ",s.currency,"/",s.period]})]}),u.jsxs("div",{className:"p-6 space-y-4",children:[u.jsx("h3",{className:"font-medium text-gray-900",children:"Mthode de paiement"}),u.jsx("div",{className:"space-y-2",children:c.map(x=>u.jsxs("label",{className:`flex items-center gap-3 p-4 border-2 rounded-lg cursor-pointer transition-colors ${h===x.id?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}`,children:[u.jsx("input",{type:"radio",name:"paymentMethod",value:x.id,checked:h===x.id,onChange:b=>f(b.target.value),className:"text-primary-600"}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900",children:x.name}),u.jsx("p",{className:"text-sm text-gray-500",children:x.description})]})]},x.id))}),u.jsxs("div",{className:"flex gap-3 pt-4",children:[u.jsx("button",{onClick:()=>l(null),className:"btn-secondary flex-1",children:"Annuler"}),u.jsx("button",{onClick:m,disabled:p||!h,className:"btn-primary flex-1 disabled:opacity-50",children:p?"Traitement...":"Payer"})]})]})]})}),u.jsxs("div",{className:"max-w-3xl mx-auto",children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900 text-center mb-8",children:"Questions frquentes"}),u.jsx("div",{className:"space-y-4",children:[{q:"Puis-je changer de plan  tout moment ?",a:"Oui, vous pouvez upgrader ou downgrader votre plan  tout moment. Le changement prend effet immdiatement."},{q:"Quels moyens de paiement acceptez-vous ?",a:"Nous acceptons D17, Flouci, les cartes bancaires tunisiennes (Visa/Mastercard) et les virements bancaires."},{q:"Y a-t-il un engagement ?",a:"Non, tous nos plans sont sans engagement. Vous pouvez annuler  tout moment."},{q:"Mes donnes sont-elles scurises ?",a:"Oui, nous utilisons le chiffrement SSL et respectons les normes de scurit les plus strictes pour protger vos donnes."}].map((x,b)=>u.jsxs("div",{className:"card",children:[u.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:x.q}),u.jsx("p",{className:"text-gray-600",children:x.a})]},b))})]})]})]})},R6=()=>{var ue,he,ye,we,ke,Ie,Ee,Ke,Te,Ae;const{user:e,updateUser:t,fetchUser:n}=ur(),[r,a]=I.useState("profile"),[o,i]=I.useState(!1),[s,l]=I.useState(null),[c,d]=I.useState([]),h=I.useRef(null),[f,p]=I.useState(!1),[v,g]=I.useState(!1),[y,m]=I.useState(!1),[x,b]=I.useState(!1),w=I.useRef(null),N=I.useRef(null),[C,S]=I.useState({firstName:(e==null?void 0:e.firstName)||"",lastName:(e==null?void 0:e.lastName)||"",phone:(e==null?void 0:e.phone)||"",company:(e==null?void 0:e.company)||""});I.useEffect(()=>(n(),k(),_(),()=>j()),[]);const k=async()=>{try{await Promise.all([Mt.tinyFaceDetector.loadFromUri("/models"),Mt.faceLandmark68Net.loadFromUri("/models"),Mt.faceRecognitionNet.loadFromUri("/models")]),p(!0)}catch{console.log("Face models not loaded")}},_=async()=>{try{const Q=await ie.get("/auth/face/status");g(Q.data.hasFaceRegistered)}catch{console.log("Face status check failed")}},E=async()=>{try{const Q=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}});N.current=Q,b(!0),setTimeout(()=>{w.current&&(w.current.srcObject=Q)},100)}catch(Q){console.error("Camera error:",Q),V.error("Impossible d'accder  la camra")}},j=()=>{N.current&&(N.current.getTracks().forEach(Q=>Q.stop()),N.current=null),b(!1)},T=async()=>{if(!f){V.error("Modles non chargs");return}m(!0);try{await new Promise(_e=>setTimeout(_e,500));const Q=new Nc({inputSize:320,scoreThreshold:.3});let Ce=null;for(let _e=0;_e<3&&(Ce=await Xf(w.current,Q).withFaceLandmarks().withFaceDescriptor(),!Ce);_e++)await new Promise(Le=>setTimeout(Le,300));if(!Ce){V.error("Aucun visage dtect. Regardez bien la camra."),m(!1);return}await ie.post("/auth/face/register",{faceDescriptor:Array.from(Ce.descriptor)}),g(!0),j(),V.success("Reconnaissance faciale configure !")}catch{V.error("Erreur lors de l'enregistrement")}finally{m(!1)}},L=async()=>{if(!(e!=null&&e.avatarUrl)||!f){V.error("Photo Google non disponible");return}m(!0);try{const Q=new Image;Q.crossOrigin="anonymous";const Ce=await new Promise(_e=>{Q.onload=async()=>{try{const Le=new Nc({inputSize:416,scoreThreshold:.2}),Ye=await Xf(Q,Le).withFaceLandmarks().withFaceDescriptor();_e(Ye?Array.from(Ye.descriptor):null)}catch{_e(null)}},Q.onerror=()=>_e(null),Q.src=e.avatarUrl});if(!Ce){V.error("Impossible de dtecter le visage sur la photo Google. Utilisez la camra."),m(!1);return}await ie.post("/auth/face/register",{faceDescriptor:Ce}),g(!0),V.success("Reconnaissance faciale configure depuis votre photo Google !")}catch{V.error("Erreur lors de l'enregistrement")}finally{m(!1)}};I.useEffect(()=>{e&&S({firstName:e.firstName||"",lastName:e.lastName||"",phone:e.phone||"",company:e.company||""})},[e]);const[P,B]=I.useState({currentPassword:"",newPassword:"",confirmPassword:""});I.useEffect(()=>{r==="subscription"?K():r==="history"&&z()},[r]);const K=async()=>{try{const Q=await ie.get("/payments/subscription");l(Q.data)}catch(Q){console.error("Error fetching subscription:",Q)}},z=async()=>{try{const Q=await ie.get("/payments/history");d(Q.data.payments||[])}catch(Q){console.error("Error fetching history:",Q)}},M=async Q=>{Q.preventDefault(),i(!0);try{const Ce=await ie.put("/auth/profile",C);t(Ce.data.user),V.success("Profil mis  jour")}catch{V.error("Erreur lors de la mise  jour")}finally{i(!1)}},U=async Q=>{var Le;const Ce=(Le=Q.target.files)==null?void 0:Le[0];if(!Ce)return;if(!Ce.type.startsWith("image/")){V.error("Veuillez slectionner une image");return}const _e=(Ye,pt=200,mt=.8)=>new Promise(zt=>{const $t=new FileReader;$t.onload=te=>{const oe=new Image;oe.onload=()=>{const Ne=document.createElement("canvas"),Oe=Math.min(pt/oe.width,pt/oe.height);Ne.width=oe.width*Oe,Ne.height=oe.height*Oe,Ne.getContext("2d").drawImage(oe,0,0,Ne.width,Ne.height),zt(Ne.toDataURL("image/jpeg",mt))},oe.src=te.target.result},$t.readAsDataURL(Ye)});try{const Ye=await _e(Ce);await ie.post("/auth/avatar",{avatarUrl:Ye}),t({avatarUrl:Ye}),V.success("Avatar mis  jour")}catch{V.error("Erreur lors de la mise  jour de l'avatar")}},H=async Q=>{var Ce,_e;if(Q.preventDefault(),P.newPassword!==P.confirmPassword){V.error("Les mots de passe ne correspondent pas");return}if(P.newPassword.length<6){V.error("Le mot de passe doit contenir au moins 6 caractres");return}i(!0);try{await ie.put("/auth/password",{currentPassword:P.currentPassword,newPassword:P.newPassword}),V.success("Mot de passe modifi"),B({currentPassword:"",newPassword:"",confirmPassword:""})}catch(Le){V.error(((_e=(Ce=Le.response)==null?void 0:Ce.data)==null?void 0:_e.message)||"Erreur")}finally{i(!1)}},Z=async()=>{if(confirm("tes-vous sr de vouloir annuler votre abonnement ?"))try{await ie.post("/payments/cancel"),V.success("Abonnement annul"),K()}catch{V.error("Erreur")}},ne=[{id:"profile",label:"Profil",icon:ta},{id:"security",label:"Scurit",icon:_o},{id:"face",label:"Reconnaissance",icon:Gd},{id:"subscription",label:"Abonnement",icon:So},{id:"history",label:"Historique",icon:pR}];return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Mon Profil"}),u.jsx("p",{className:"text-gray-600",children:"Grez vos informations personnelles et votre abonnement."})]}),u.jsxs("div",{className:"grid lg:grid-cols-4 gap-6",children:[u.jsx("div",{className:"lg:col-span-1",children:u.jsxs("div",{className:"card",children:[u.jsxs("div",{className:"text-center mb-6",children:[u.jsxs("div",{className:"relative inline-block",children:[e!=null&&e.avatarUrl?u.jsx("img",{src:e.avatarUrl,alt:"Avatar",className:"w-20 h-20 rounded-full mx-auto object-cover border-4 border-cyan-500"}):u.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-cyan-500 to-purple-500 rounded-full flex items-center justify-center mx-auto",children:u.jsxs("span",{className:"text-2xl font-bold text-white",children:[(ue=e==null?void 0:e.firstName)==null?void 0:ue[0],(he=e==null?void 0:e.lastName)==null?void 0:he[0]]})}),u.jsx("button",{onClick:()=>{var Q;return(Q=h.current)==null?void 0:Q.click()},className:"absolute bottom-0 right-0 w-8 h-8 bg-cyan-500 rounded-full flex items-center justify-center text-white hover:bg-cyan-600 transition-colors shadow-lg",children:u.jsx(Qu,{className:"w-4 h-4"})}),u.jsx("input",{ref:h,type:"file",accept:"image/*",onChange:U,className:"hidden"})]}),u.jsxs("h3",{className:"font-semibold text-gray-900",children:[e==null?void 0:e.firstName," ",e==null?void 0:e.lastName]}),u.jsx("p",{className:"text-sm text-gray-500",children:e==null?void 0:e.email}),u.jsxs("span",{className:`badge mt-2 ${(e==null?void 0:e.subscription)==="free"?"badge-info":"badge-success"}`,children:["Plan ",(e==null?void 0:e.subscription)||"Gratuit"]})]}),u.jsx("nav",{className:"space-y-1",children:ne.map(Q=>u.jsxs("button",{onClick:()=>a(Q.id),className:`w-full flex items-center gap-3 px-4 py-2.5 rounded-lg text-left transition-colors ${r===Q.id?"bg-primary-50 text-primary-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[u.jsx(Q.icon,{className:"w-5 h-5"}),Q.label]},Q.id))})]})}),u.jsxs("div",{className:"lg:col-span-3",children:[r==="profile"&&u.jsxs("div",{className:"card",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Informations personnelles"}),u.jsxs("form",{onSubmit:M,className:"space-y-4",children:[u.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prnom"}),u.jsxs("div",{className:"relative",children:[u.jsx(ta,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"text",value:C.firstName,onChange:Q=>S({...C,firstName:Q.target.value}),className:"input-field pl-10"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom"}),u.jsx("input",{type:"text",value:C.lastName,onChange:Q=>S({...C,lastName:Q.target.value}),className:"input-field"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),u.jsxs("div",{className:"relative",children:[u.jsx(ea,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"email",value:e==null?void 0:e.email,className:"input-field pl-10 bg-gray-50",disabled:!0})]}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"L'email ne peut pas tre modifi"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tlphone"}),u.jsxs("div",{className:"relative",children:[u.jsx(am,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"tel",value:C.phone,onChange:Q=>S({...C,phone:Q.target.value}),className:"input-field pl-10",placeholder:"+216 XX XXX XXX"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Entreprise"}),u.jsxs("div",{className:"relative",children:[u.jsx(em,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"text",value:C.company,onChange:Q=>S({...C,company:Q.target.value}),className:"input-field pl-10",placeholder:"Nom de votre entreprise"})]})]}),u.jsx("button",{type:"submit",disabled:o,className:"btn-primary",children:o?"Enregistrement...":"Enregistrer les modifications"})]})]}),r==="security"&&u.jsxs("div",{className:"card",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Changer le mot de passe"}),u.jsxs("form",{onSubmit:H,className:"space-y-4 max-w-md",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mot de passe actuel"}),u.jsx("input",{type:"password",value:P.currentPassword,onChange:Q=>B({...P,currentPassword:Q.target.value}),className:"input-field",autoComplete:"current-password",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nouveau mot de passe"}),u.jsx("input",{type:"password",value:P.newPassword,onChange:Q=>B({...P,newPassword:Q.target.value}),className:"input-field",placeholder:"Min. 6 caractres",autoComplete:"new-password",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirmer le nouveau mot de passe"}),u.jsx("input",{type:"password",value:P.confirmPassword,onChange:Q=>B({...P,confirmPassword:Q.target.value}),className:"input-field",autoComplete:"new-password",required:!0})]}),u.jsx("button",{type:"submit",disabled:o,className:"btn-primary",children:o?"Modification...":"Modifier le mot de passe"})]})]}),r==="face"&&u.jsxs("div",{className:"card",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Reconnaissance faciale"}),u.jsx("p",{className:"text-gray-600 mb-6",children:"Configurez la reconnaissance faciale pour vous connecter plus rapidement et de manire scurise."}),v?u.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center",children:u.jsx(Gd,{className:"w-5 h-5 text-white"})}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-green-800",children:"Reconnaissance faciale active"}),u.jsx("p",{className:"text-sm text-green-600",children:"Vous pouvez vous connecter avec votre visage"})]})]})}):u.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:u.jsx("p",{className:"text-yellow-800",children:"La reconnaissance faciale n'est pas encore configure."})}),x?u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"relative rounded-xl overflow-hidden bg-black aspect-video max-w-md",children:u.jsx("video",{ref:w,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"})}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx("button",{onClick:T,disabled:y,className:"btn-primary flex items-center gap-2",children:y?u.jsxs(u.Fragment,{children:[u.jsx(Ma,{className:"w-5 h-5 animate-spin"}),"Analyse en cours..."]}):u.jsxs(u.Fragment,{children:[u.jsx(Gd,{className:"w-5 h-5"}),"Enregistrer mon visage"]})}),u.jsx("button",{onClick:j,className:"btn-secondary",children:"Annuler"})]})]}):u.jsxs("div",{className:"flex flex-col gap-3",children:[(e==null?void 0:e.avatarUrl)&&!v&&u.jsx("button",{onClick:L,disabled:!f||y,className:"btn-primary flex items-center gap-2",children:y?u.jsxs(u.Fragment,{children:[u.jsx(Ma,{className:"w-5 h-5 animate-spin"})," Analyse en cours..."]}):u.jsxs(u.Fragment,{children:[u.jsx("img",{src:e.avatarUrl,alt:"",className:"w-5 h-5 rounded-full"})," Utiliser ma photo Google"]})}),u.jsxs("button",{onClick:E,disabled:!f||y,className:"btn-secondary flex items-center gap-2",children:[u.jsx(Qu,{className:"w-5 h-5"}),v?"Reconfigurer avec la camra":"Configurer avec la camra"]})]}),!f&&u.jsxs("p",{className:"text-sm text-gray-500 mt-4",children:[u.jsx(Ma,{className:"w-4 h-4 inline animate-spin mr-2"}),"Chargement des modles de reconnaissance..."]})]}),r==="subscription"&&u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"card",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Mon abonnement"}),(s==null?void 0:s.paymentStatus)==="pending"&&u.jsxs("div",{className:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[u.jsx("p",{className:"text-yellow-800 font-medium",children:" Paiement en attente de validation"}),u.jsx("p",{className:"text-sm text-yellow-600",children:"Votre paiement est en cours de vrification par l'administrateur. Vous serez notifi une fois approuv."})]}),(s==null?void 0:s.paymentStatus)==="rejected"&&u.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:[u.jsx("p",{className:"text-red-800 font-medium",children:" Paiement rejet"}),u.jsx("p",{className:"text-sm text-red-600",children:"Votre paiement a t rejet. Veuillez contacter le support ou ressayer."})]}),(s==null?void 0:s.paymentStatus)==="approved"&&((ye=s==null?void 0:s.subscription)==null?void 0:ye.plan)!=="free"&&u.jsxs("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg",children:[u.jsx("p",{className:"text-green-800 font-medium",children:" Abonnement actif"}),u.jsx("p",{className:"text-sm text-green-600",children:"Votre abonnement est actif et toutes les fonctionnalits sont disponibles."})]}),s&&u.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[u.jsxs("div",{children:[u.jsxs("p",{className:"font-medium text-gray-900",children:["Plan ",((we=s.planDetails)==null?void 0:we.name)||"Gratuit"]}),u.jsx("p",{className:"text-sm text-gray-500",children:((ke=s.planDetails)==null?void 0:ke.price)===0?"Gratuit":`${(Ie=s.planDetails)==null?void 0:Ie.price} ${(Ee=s.planDetails)==null?void 0:Ee.currency}/${(Ke=s.planDetails)==null?void 0:Ke.period}`})]}),((Te=s.subscription)==null?void 0:Te.plan)!=="free"&&s.canAccessFeatures&&u.jsx("button",{onClick:Z,className:"text-red-600 hover:underline text-sm",children:"Annuler l'abonnement"})]}),((Ae=s==null?void 0:s.planDetails)==null?void 0:Ae.features)&&u.jsxs("div",{className:"mt-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Fonctionnalits incluses:"}),u.jsx("ul",{className:"space-y-1",children:s.planDetails.features.map((Q,Ce)=>u.jsxs("li",{className:"text-sm text-gray-600 flex items-center gap-2",children:[u.jsx("span",{className:"text-green-500",children:""}),Q]},Ce))})]})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Changer de plan"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"Vous souhaitez accder  plus de fonctionnalits ?"}),u.jsx("a",{href:"/pricing",className:"btn-primary inline-block",children:"Voir les plans disponibles"})]})]}),r==="history"&&u.jsxs("div",{className:"card",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Historique des paiements"}),c.length>0?u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"text-left text-sm text-gray-500 border-b",children:[u.jsx("th",{className:"pb-3 font-medium",children:"Date"}),u.jsx("th",{className:"pb-3 font-medium",children:"Plan"}),u.jsx("th",{className:"pb-3 font-medium",children:"Montant"}),u.jsx("th",{className:"pb-3 font-medium",children:"Mthode"}),u.jsx("th",{className:"pb-3 font-medium",children:"Statut"})]})}),u.jsx("tbody",{children:c.map(Q=>u.jsxs("tr",{className:"border-b last:border-0",children:[u.jsx("td",{className:"py-3 text-sm",children:new Date(Q.createdAt).toLocaleDateString("fr-FR")}),u.jsx("td",{className:"py-3 text-sm capitalize",children:Q.subscriptionType}),u.jsxs("td",{className:"py-3 text-sm",children:[Q.amount," ",Q.currency]}),u.jsx("td",{className:"py-3 text-sm capitalize",children:Q.method}),u.jsx("td",{className:"py-3",children:u.jsx("span",{className:`badge ${Q.status==="completed"||Q.status==="approved"?"badge-success":Q.status==="pending"?"badge-warning":(Q.status==="rejected","badge-danger")}`,children:Q.status==="completed"?"Pay":Q.status==="approved"?"Approuv":Q.status==="pending"?"En attente":Q.status==="rejected"?"Rejet":"chou"})})]},Q.id))})]})}):u.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucun paiement"})]})]})]})]})},I6=()=>{const e=sr(),[t]=qE(),{setAuth:n}=ur(),r=I.useRef(!1);I.useEffect(()=>{if(r.current)return;const o=t.get("code");o?(r.current=!0,a(o)):(V.error("Erreur de connexion Google"),e("/login"))},[t]);const a=async o=>{try{const i=await ie.post("/auth/google/callback",{code:o,redirectUri:window.location.origin+"/auth/google/callback"});n(i.data.token,i.data.user),V.success("Connexion Google russie !"),e("/dashboard")}catch(i){console.error("Google callback error:",i),V.error("Erreur de connexion Google"),e("/login")}};return u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:u.jsxs("div",{className:"text-center text-white",children:[u.jsx(Ma,{className:"w-12 h-12 animate-spin mx-auto mb-4 text-cyan-400"}),u.jsx("p",{className:"text-xl",children:"Connexion en cours..."})]})})},A6=()=>{const[e,t]=I.useState([]),[n,r]=I.useState(0),[a,o]=I.useState(!1),i=I.useRef(null);I.useEffect(()=>{s();const f=setInterval(s,3e4);return()=>clearInterval(f)},[]),I.useEffect(()=>{const f=p=>{i.current&&!i.current.contains(p.target)&&o(!1)};return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[]);const s=async()=>{try{const f=await ie.get("/notifications");t(f.data.notifications||[]),r(f.data.unreadCount||0)}catch(f){console.error("Error fetching notifications:",f)}},l=async f=>{try{await ie.put(`/notifications/${f}/read`),t(p=>p.map(v=>v.id===f?{...v,isRead:1}:v)),r(p=>Math.max(0,p-1))}catch(p){console.error("Error marking notification as read:",p)}},c=async()=>{try{await ie.put("/notifications/read-all"),t(f=>f.map(p=>({...p,isRead:1}))),r(0)}catch(f){console.error("Error marking all as read:",f)}},d=f=>{switch(f){case"subscription_approved":return"";case"subscription_rejected":return"";default:return""}},h=f=>{const p=new Date(f),g=new Date-p,y=Math.floor(g/6e4),m=Math.floor(g/36e5),x=Math.floor(g/864e5);return y<1?" l'instant":y<60?`Il y a ${y}min`:m<24?`Il y a ${m}h`:x<7?`Il y a ${x}j`:p.toLocaleDateString("fr-FR")};return u.jsxs("div",{className:"relative",ref:i,children:[u.jsxs("button",{onClick:()=>o(!a),className:"relative p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:[u.jsx(kf,{className:"w-5 h-5"}),n>0&&u.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center font-medium",children:n>9?"9+":n})]}),a&&u.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-xl shadow-xl border border-gray-200 z-50 overflow-hidden",children:[u.jsxs("div",{className:"p-3 border-b border-gray-100 flex items-center justify-between bg-gray-50",children:[u.jsx("h3",{className:"font-semibold text-gray-900",children:"Notifications"}),n>0&&u.jsxs("button",{onClick:c,className:"text-xs text-cyan-600 hover:text-cyan-700 flex items-center gap-1",children:[u.jsx(eR,{className:"w-3 h-3"}),"Tout marquer lu"]})]}),u.jsx("div",{className:"max-h-80 overflow-y-auto",children:e.length===0?u.jsxs("div",{className:"p-6 text-center text-gray-500",children:[u.jsx(kf,{className:"w-8 h-8 mx-auto mb-2 text-gray-300"}),u.jsx("p",{className:"text-sm",children:"Aucune notification"})]}):e.map(f=>u.jsx("div",{className:`p-3 border-b border-gray-50 hover:bg-gray-50 cursor-pointer transition-colors ${f.isRead?"":"bg-cyan-50/50"}`,onClick:()=>!f.isRead&&l(f.id),children:u.jsxs("div",{className:"flex gap-3",children:[u.jsx("span",{className:"text-xl",children:d(f.type)}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:`text-sm ${f.isRead?"text-gray-700":"font-semibold text-gray-900"}`,children:f.title}),u.jsx("p",{className:"text-xs text-gray-500 mt-0.5 line-clamp-2",children:f.message}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:h(f.createdAt)})]}),!f.isRead&&u.jsx("div",{className:"w-2 h-2 bg-cyan-500 rounded-full mt-1.5 flex-shrink-0"})]})},f.id))})]})]})},Qn=({children:e})=>{var c,d,h;const[t,n]=I.useState(!1),r=Xa(),a=sr(),{user:o,logout:i}=ur(),s=[{name:"Tableau de bord",href:"/dashboard",icon:gR},{name:"Mes Projets",href:"/projects",icon:fi},{name:"Gnrateur d'ides",href:"/ideas",icon:Kr},{name:"Abonnement",href:"/pricing",icon:So},{name:"Mon Profil",href:"/profile",icon:ta}],l=()=>{i(),a("/")};return u.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t&&u.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>n(!1)}),u.jsx("aside",{className:`
        fixed top-0 left-0 z-50 h-full w-64 bg-white border-r border-gray-200 
        transform transition-transform duration-300 ease-in-out
        ${t?"translate-x-0":"-translate-x-full"}
        lg:translate-x-0
      `,children:u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsxs("div",{className:"flex items-center justify-between h-16 px-6 border-b border-gray-200",children:[u.jsxs(Fe,{to:"/dashboard",className:"flex items-center gap-2",children:[u.jsx(Ar,{className:"w-8 h-8 text-primary-600"}),u.jsx("span",{className:"text-xl font-bold gradient-text",children:"StartUpLab"})]}),u.jsx("button",{onClick:()=>n(!1),className:"lg:hidden text-gray-500 hover:text-gray-700",children:u.jsx(Cr,{className:"w-6 h-6"})})]}),u.jsx("nav",{className:"flex-1 px-4 py-6 space-y-1 overflow-y-auto",children:s.map(f=>{const p=r.pathname===f.href;return u.jsxs(Fe,{to:f.href,className:`sidebar-link ${p?"active":""}`,onClick:()=>n(!1),children:[u.jsx(f.icon,{className:"w-5 h-5"}),u.jsx("span",{children:f.name})]},f.name)})}),u.jsxs("div",{className:"p-4 border-t border-gray-200",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-4 px-2",children:[o!=null&&o.avatarUrl?u.jsx("img",{src:o.avatarUrl,alt:"Avatar",className:"w-10 h-10 rounded-full object-cover",referrerPolicy:"no-referrer"}):u.jsx("div",{className:"w-10 h-10 rounded-full bg-primary-100 flex items-center justify-center",children:u.jsxs("span",{className:"text-primary-700 font-semibold",children:[(c=o==null?void 0:o.firstName)==null?void 0:c[0],(d=o==null?void 0:o.lastName)==null?void 0:d[0]]})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("p",{className:"text-sm font-medium text-gray-900 truncate",children:[o==null?void 0:o.firstName," ",o==null?void 0:o.lastName]}),u.jsx("p",{className:"text-xs text-gray-500 truncate",children:o==null?void 0:o.email})]})]}),u.jsxs("button",{onClick:l,className:"sidebar-link w-full text-red-600 hover:bg-red-50 hover:text-red-700",children:[u.jsx(Ew,{className:"w-5 h-5"}),u.jsx("span",{children:"Dconnexion"})]})]})]})}),u.jsxs("div",{className:"lg:pl-64",children:[u.jsxs("header",{className:"sticky top-0 z-30 h-16 bg-white border-b border-gray-200 flex items-center px-4 lg:px-8",children:[u.jsx("button",{onClick:()=>n(!0),className:"lg:hidden p-2 text-gray-500 hover:text-gray-700",children:u.jsx(NR,{className:"w-6 h-6"})}),u.jsx("div",{className:"flex-1"}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(A6,{}),u.jsx("span",{className:`badge ${(o==null?void 0:o.subscription)==="free"?"badge-info":"badge-success"}`,children:(o==null?void 0:o.subscription)==="free"?"Plan Gratuit":(h=o==null?void 0:o.subscription)==null?void 0:h.toUpperCase()})]})]}),u.jsx("main",{className:"p-4 lg:p-8",children:e})]})]})},ou=({children:e})=>{var c,d;const t=Xa(),n=sr(),[r,a]=I.useState(null);I.useEffect(()=>{const h=sessionStorage.getItem("admin-token"),f=sessionStorage.getItem("admin-user");if(h&&f)try{const p=JSON.parse(f);if(p.role==="admin"||p.email==="admin@startuplab.com"){a(p);return}}catch{}window.location.href="/admin/login"},[]);const o=()=>{sessionStorage.removeItem("admin-token"),sessionStorage.removeItem("admin-user"),window.location.href="/admin/login"};if(!r)return u.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500"})});const i=r,s=[{path:"/admin",icon:Y_,label:"Tableau de bord"},{path:"/admin/users",icon:un,label:"Utilisateurs"},{path:"/admin/projects",icon:Fi,label:"Projets"},{path:"/admin/payments",icon:So,label:"Paiements"}],l=()=>{o(),n("/login")};return u.jsxs("div",{className:"min-h-screen bg-gray-100 flex",children:[u.jsxs("aside",{className:"w-64 bg-slate-900 text-white flex flex-col",children:[u.jsx("div",{className:"p-6 border-b border-slate-700",children:u.jsxs(Fe,{to:"/admin",className:"flex items-center gap-3",children:[u.jsx("div",{className:"bg-gradient-to-br from-cyan-400 to-purple-500 p-2 rounded-xl",children:u.jsx(Mi,{className:"w-6 h-6 text-white"})}),u.jsxs("div",{children:[u.jsx("h1",{className:"font-bold text-lg",children:"StartUpLab"}),u.jsx("p",{className:"text-xs text-slate-400",children:"Administration"})]})]})}),u.jsx("nav",{className:"flex-1 p-4 space-y-1",children:s.map(h=>{const f=t.pathname===h.path;return u.jsxs(Fe,{to:h.path,className:`flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${f?"bg-gradient-to-r from-cyan-500 to-purple-500 text-white shadow-lg":"text-slate-300 hover:bg-slate-800 hover:text-white"}`,children:[u.jsx(h.icon,{className:"w-5 h-5"}),u.jsx("span",{className:"font-medium",children:h.label})]},h.path)})}),u.jsxs("div",{className:"p-4 border-t border-slate-700",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i!=null&&i.avatarUrl?u.jsx("img",{src:i.avatarUrl,alt:"",className:"w-10 h-10 rounded-full object-cover"}):u.jsxs("div",{className:"w-10 h-10 bg-gradient-to-br from-cyan-400 to-purple-500 rounded-full flex items-center justify-center text-white font-bold",children:[(c=i==null?void 0:i.firstName)==null?void 0:c[0],(d=i==null?void 0:i.lastName)==null?void 0:d[0]]}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("p",{className:"font-medium truncate",children:[i==null?void 0:i.firstName," ",i==null?void 0:i.lastName]}),u.jsx("p",{className:"text-xs text-slate-400 truncate",children:i==null?void 0:i.email})]})]}),u.jsxs("button",{onClick:l,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-red-500/10 text-red-400 rounded-lg hover:bg-red-500/20 transition-colors",children:[u.jsx(Ew,{className:"w-4 h-4"}),"Dconnexion"]})]})]}),u.jsx("main",{className:"flex-1 overflow-auto",children:u.jsx("div",{className:"p-8",children:e})})]})},D6=()=>{sr(),I.useEffect(()=>{sessionStorage.getItem("admin-token")&&(window.location.href="/admin")},[]);const[e,t]=I.useState(!1),[n,r]=I.useState(!1),[a,o]=I.useState({email:"",password:""}),i=async s=>{var l,c;s.preventDefault(),r(!0);try{console.log("Sending admin login:",a);const d=await ct.post("/api/admin/login",a,{headers:{"Content-Type":"application/json"}});console.log("Admin login response:",d.data),sessionStorage.setItem("admin-token",d.data.token),sessionStorage.setItem("admin-user",JSON.stringify(d.data.user)),V.success("Connexion admin russie"),window.location.href="/admin"}catch(d){V.error(((c=(l=d.response)==null?void 0:l.data)==null?void 0:c.message)||"Identifiants incorrects")}finally{r(!1)}};return u.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center p-4",children:u.jsxs("div",{className:"w-full max-w-md",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-cyan-500 to-purple-600 rounded-2xl mb-4",children:u.jsx(Mi,{className:"w-8 h-8 text-white"})}),u.jsx("h1",{className:"text-2xl font-bold text-white",children:"Administration"}),u.jsx("p",{className:"text-slate-400 mt-2",children:"StartUpLab - Espace rserv"})]}),u.jsx("div",{className:"bg-slate-800 rounded-2xl p-8 shadow-xl border border-slate-700",children:u.jsxs("form",{onSubmit:i,className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Email administrateur"}),u.jsxs("div",{className:"relative",children:[u.jsx(ea,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-500"}),u.jsx("input",{type:"email",value:a.email,onChange:s=>o({...a,email:s.target.value}),className:"w-full pl-10 pr-4 py-3 bg-slate-700 border border-slate-600 rounded-xl text-white placeholder-slate-400 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"admin@startuplab.com",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Mot de passe"}),u.jsxs("div",{className:"relative",children:[u.jsx(_o,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-500"}),u.jsx("input",{type:e?"text":"password",value:a.password,onChange:s=>o({...a,password:s.target.value}),className:"w-full pl-10 pr-12 py-3 bg-slate-700 border border-slate-600 rounded-xl text-white placeholder-slate-400 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"",required:!0}),u.jsx("button",{type:"button",onClick:()=>t(!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 hover:text-slate-300",children:e?u.jsx(rm,{className:"w-5 h-5"}):u.jsx(Eo,{className:"w-5 h-5"})})]})]}),u.jsx("button",{type:"submit",disabled:n,className:"w-full py-3 bg-gradient-to-r from-cyan-500 to-purple-600 text-white font-semibold rounded-xl hover:opacity-90 transition-opacity disabled:opacity-50 flex items-center justify-center gap-2",children:n?u.jsxs(u.Fragment,{children:[u.jsx(Ma,{className:"w-5 h-5 animate-spin"}),"Connexion..."]}):u.jsxs(u.Fragment,{children:[u.jsx(Mi,{className:"w-5 h-5"}),"Se connecter"]})})]})}),u.jsx("p",{className:"text-center text-slate-500 text-sm mt-6",children:"Accs rserv aux administrateurs"})]})})},mn=ct.create({baseURL:"http://localhost:5000/api"});mn.interceptors.request.use(e=>{const t=sessionStorage.getItem("admin-token");return t&&(e.headers.Authorization=`Bearer ${t}`),e});mn.interceptors.response.use(e=>e,e=>{var t,n;return(((t=e.response)==null?void 0:t.status)===401||((n=e.response)==null?void 0:n.status)===403)&&(sessionStorage.removeItem("admin-token"),sessionStorage.removeItem("admin-user"),window.location.href="/admin/login"),Promise.reject(e)});const T6=()=>{var l;const[e,t]=I.useState(null),[n,r]=I.useState([]),[a,o]=I.useState(!0);I.useEffect(()=>{i()},[]);const i=async()=>{try{const[c,d]=await Promise.all([mn.get("/admin/stats"),mn.get("/admin/activity")]);t(c.data),r(d.data.activities)}catch{V.error("Erreur lors du chargement des donnes")}finally{o(!1)}};if(a)return u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500"})});const s=[{title:"Utilisateurs",value:(e==null?void 0:e.totalUsers)||0,icon:un,color:"bg-blue-500",link:"/admin/users"},{title:"Projets",value:(e==null?void 0:e.totalProjects)||0,icon:Fi,color:"bg-purple-500",link:"/admin/projects"},{title:"Ides",value:(e==null?void 0:e.totalIdeas)||0,icon:Kr,color:"bg-yellow-500"},{title:"Abonnements actifs",value:(e==null?void 0:e.activeSubscriptions)||0,icon:Rw,color:"bg-green-500"},{title:"Nouveaux (7j)",value:(e==null?void 0:e.recentUsers)||0,icon:Oi,color:"bg-cyan-500"},{title:"Revenus total",value:`${(e==null?void 0:e.totalRevenue)||0} TND`,icon:nm,color:"bg-emerald-500",link:"/admin/payments"}];return u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"flex items-center justify-between",children:u.jsxs("div",{children:[u.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[u.jsx(Mi,{className:"w-8 h-8 text-cyan-600"}),"Administration"]}),u.jsx("p",{className:"text-gray-600 mt-1",children:"Grez votre plateforme StartUpLab"})]})}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map((c,d)=>u.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-shadow",children:c.link?u.jsx(Fe,{to:c.link,className:"block",children:u.jsx(h1,{...c})}):u.jsx(h1,{...c})},d))}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[u.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[u.jsx(So,{className:"w-5 h-5 text-purple-500"}),"Rpartition des abonnements"]}),u.jsx("div",{className:"space-y-3",children:(l=e==null?void 0:e.usersByPlan)==null?void 0:l.map((c,d)=>u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("span",{className:"capitalize font-medium",children:c.plan}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:`h-2 rounded-full ${c.plan==="premium"?"bg-purple-500":c.plan==="pro"?"bg-cyan-500":"bg-gray-400"}`,style:{width:`${c.count/e.totalUsers*100}%`}})}),u.jsx("span",{className:"text-gray-600 w-10 text-right",children:c.count})]})]},d))})]}),u.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[u.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[u.jsx(Oi,{className:"w-5 h-5 text-green-500"}),"Revenus ce mois"]}),u.jsxs("div",{className:"text-center py-8",children:[u.jsxs("p",{className:"text-4xl font-bold text-green-600",children:[(e==null?void 0:e.monthlyRevenue)||0," TND"]}),u.jsx("p",{className:"text-gray-500 mt-2",children:"Revenus des 30 derniers jours"})]})]})]}),u.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[u.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[u.jsx(xw,{className:"w-5 h-5 text-cyan-500"}),"Activit rcente"]}),u.jsxs("div",{className:"space-y-4",children:[n.map((c,d)=>u.jsx(P6,{item:c},d)),n.length===0&&u.jsx("p",{className:"text-gray-500 text-center py-4",children:"Aucune activit rcente"})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs(Fe,{to:"/admin/users",className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl p-4 flex items-center gap-3 hover:shadow-lg transition-shadow",children:[u.jsx(un,{className:"w-6 h-6"}),u.jsx("span",{className:"font-medium",children:"Grer les utilisateurs"})]}),u.jsxs(Fe,{to:"/admin/projects",className:"bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-xl p-4 flex items-center gap-3 hover:shadow-lg transition-shadow",children:[u.jsx(Fi,{className:"w-6 h-6"}),u.jsx("span",{className:"font-medium",children:"Voir les projets"})]}),u.jsxs(Fe,{to:"/admin/payments",className:"bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl p-4 flex items-center gap-3 hover:shadow-lg transition-shadow",children:[u.jsx(So,{className:"w-6 h-6"}),u.jsx("span",{className:"font-medium",children:"Grer les paiements"})]})]})]})},h1=({title:e,value:t,icon:n,color:r})=>u.jsx(u.Fragment,{children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-500 text-sm",children:e}),u.jsx("p",{className:"text-2xl font-bold mt-1",children:t})]}),u.jsx("div",{className:`${r} p-3 rounded-xl`,children:u.jsx(n,{className:"w-6 h-6 text-white"})})]})}),P6=({item:e})=>{const t=()=>{switch(e.type){case"registration":return u.jsx(Rw,{className:"w-4 h-4 text-green-500"});case"project":return u.jsx(Fi,{className:"w-4 h-4 text-purple-500"});case"payment":return u.jsx(So,{className:"w-4 h-4 text-blue-500"});default:return u.jsx(xw,{className:"w-4 h-4 text-gray-500"})}},n=()=>{switch(e.type){case"registration":return`${e.firstName} ${e.lastName} s'est inscrit`;case"project":return`Nouveau projet "${e.name}" par ${e.userEmail}`;case"payment":return`Paiement de ${e.amount} TND par ${e.userEmail}`;default:return"Activit"}};return u.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[t(),u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm",children:n()}),u.jsx("p",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleDateString("fr-FR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]})]})},F6=()=>{var k,_,E,j,T,L;const[e,t]=I.useState([]),[n,r]=I.useState({page:1,pages:1,total:0}),[a,o]=I.useState(!0),[i,s]=I.useState(""),[l,c]=I.useState(""),[d,h]=I.useState(""),[f,p]=I.useState(null),[v,g]=I.useState(!1),[y,m]=I.useState(!1);I.useEffect(()=>{x()},[n.page,l,d]);const x=async()=>{try{o(!0);const P=new URLSearchParams({page:n.page,limit:20,search:i,role:l,status:d}),B=await mn.get(`/admin/users?${P}`);t(B.data.users),r(B.data.pagination)}catch{V.error("Erreur lors du chargement des utilisateurs")}finally{o(!1)}},b=P=>{P.preventDefault(),r(B=>({...B,page:1})),x()},w=async P=>{try{const B=await mn.get(`/admin/users/${P}`);p(B.data),m(!1),g(!0)}catch{V.error("Erreur lors du chargement de l'utilisateur")}},N=async()=>{try{await mn.put(`/admin/users/${f.user.id}`,{firstName:f.user.firstName,lastName:f.user.lastName,email:f.user.email,role:f.user.role,isActive:f.user.isActive,subscription:f.user.subscriptionPlan}),V.success("Utilisateur mis  jour"),g(!1),x()}catch{V.error("Erreur lors de la mise  jour")}},C=async P=>{var B,K;if(confirm("tes-vous sr de vouloir supprimer cet utilisateur ?"))try{await mn.delete(`/admin/users/${P}`),V.success("Utilisateur supprim"),x()}catch(z){V.error(((K=(B=z.response)==null?void 0:B.data)==null?void 0:K.message)||"Erreur lors de la suppression")}},S=async P=>{try{await mn.put(`/admin/users/${P.id}`,{...P,isActive:!P.isActive}),V.success(`Utilisateur ${P.isActive?"dsactiv":"activ"}`),x()}catch{V.error("Erreur lors de la modification")}};return u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"flex items-center justify-between",children:u.jsxs("div",{children:[u.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[u.jsx(un,{className:"w-8 h-8 text-blue-600"}),"Gestion des utilisateurs"]}),u.jsxs("p",{className:"text-gray-600 mt-1",children:[n.total," utilisateurs au total"]})]})}),u.jsx("div",{className:"bg-white rounded-xl shadow p-4",children:u.jsxs("form",{onSubmit:b,className:"flex flex-wrap gap-4",children:[u.jsx("div",{className:"flex-1 min-w-[200px]",children:u.jsxs("div",{className:"relative",children:[u.jsx(om,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"Rechercher par nom ou email...",value:i,onChange:P=>s(P.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]})}),u.jsxs("select",{value:l,onChange:P=>c(P.target.value),className:"px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500",children:[u.jsx("option",{value:"",children:"Tous les rles"}),u.jsx("option",{value:"user",children:"Utilisateur"}),u.jsx("option",{value:"admin",children:"Admin"})]}),u.jsxs("select",{value:d,onChange:P=>h(P.target.value),className:"px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500",children:[u.jsx("option",{value:"",children:"Tous les statuts"}),u.jsx("option",{value:"active",children:"Actif"}),u.jsx("option",{value:"inactive",children:"Inactif"})]}),u.jsxs("button",{type:"submit",className:"btn-primary",children:[u.jsx(Nw,{className:"w-4 h-4 mr-2"}),"Filtrer"]})]})}),u.jsxs("div",{className:"bg-white rounded-xl shadow overflow-hidden",children:[u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"bg-gray-50 border-b",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Utilisateur"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Email"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Rle"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Abonnement"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Statut"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Inscription"}),u.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-200",children:a?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"px-6 py-8 text-center",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"})})}):e.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-gray-500",children:"Aucun utilisateur trouv"})}):e.map(P=>{var B,K;return u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex items-center gap-3",children:[P.avatarUrl?u.jsx("img",{src:P.avatarUrl,alt:"",className:"w-10 h-10 rounded-full object-cover"}):u.jsxs("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white font-medium",children:[(B=P.firstName)==null?void 0:B[0],(K=P.lastName)==null?void 0:K[0]]}),u.jsxs("div",{children:[u.jsxs("p",{className:"font-medium",children:[P.firstName," ",P.lastName]}),u.jsx("p",{className:"text-sm text-gray-500",children:P.company||"-"})]})]})}),u.jsx("td",{className:"px-6 py-4 text-sm",children:P.email}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${P.role==="admin"?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-700"}`,children:P.role==="admin"?" Admin":"Utilisateur"})}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${P.subscriptionPlan==="premium"?"bg-yellow-100 text-yellow-700":P.subscriptionPlan==="pro"?"bg-cyan-100 text-cyan-700":"bg-gray-100 text-gray-700"}`,children:P.subscriptionPlan||"free"})}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("button",{onClick:()=>S(P),className:`px-2 py-1 rounded-full text-xs font-medium ${P.isActive?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:P.isActive?" Actif":" Inactif"})}),u.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:new Date(P.createdAt).toLocaleDateString("fr-FR")}),u.jsx("td",{className:"px-6 py-4 text-right",children:u.jsxs("div",{className:"flex items-center justify-end gap-2",children:[u.jsx("button",{onClick:()=>w(P.id),className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg",title:"Voir",children:u.jsx(Eo,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>C(P.id),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg",title:"Supprimer",children:u.jsx(Qa,{className:"w-4 h-4"})})]})})]},P.id)})})]})}),n.pages>1&&u.jsxs("div",{className:"px-6 py-4 border-t flex items-center justify-between",children:[u.jsxs("p",{className:"text-sm text-gray-500",children:["Page ",n.page," sur ",n.pages]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>r(P=>({...P,page:P.page-1})),disabled:n.page===1,className:"p-2 rounded-lg border hover:bg-gray-50 disabled:opacity-50",children:u.jsx(Di,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>r(P=>({...P,page:P.page+1})),disabled:n.page===n.pages,className:"p-2 rounded-lg border hover:bg-gray-50 disabled:opacity-50",children:u.jsx(Ti,{className:"w-4 h-4"})})]})]})]}),v&&f&&u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[u.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Dtails de l'utilisateur"}),u.jsx("button",{onClick:()=>g(!1),className:"text-gray-500 hover:text-gray-700",children:""})]}),u.jsxs("div",{className:"p-6 space-y-6",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[f.user.avatarUrl?u.jsx("img",{src:f.user.avatarUrl,alt:"",className:"w-20 h-20 rounded-full object-cover"}):u.jsxs("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white text-2xl font-bold",children:[(k=f.user.firstName)==null?void 0:k[0],(_=f.user.lastName)==null?void 0:_[0]]}),u.jsxs("div",{children:[y?u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{value:f.user.firstName,onChange:P=>p({...f,user:{...f.user,firstName:P.target.value}}),className:"border rounded px-2 py-1"}),u.jsx("input",{value:f.user.lastName,onChange:P=>p({...f,user:{...f.user,lastName:P.target.value}}),className:"border rounded px-2 py-1"})]}):u.jsxs("h3",{className:"text-xl font-bold",children:[f.user.firstName," ",f.user.lastName]}),u.jsx("p",{className:"text-gray-500",children:f.user.email})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rle"}),y?u.jsxs("select",{value:f.user.role,onChange:P=>p({...f,user:{...f.user,role:P.target.value}}),className:"w-full border rounded-lg px-3 py-2",children:[u.jsx("option",{value:"user",children:"Utilisateur"}),u.jsx("option",{value:"admin",children:"Admin"})]}):u.jsx("p",{className:"py-2",children:f.user.role==="admin"?" Admin":"Utilisateur"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Abonnement"}),y?u.jsxs("select",{value:f.user.subscriptionPlan||"free",onChange:P=>p({...f,user:{...f.user,subscriptionPlan:P.target.value}}),className:"w-full border rounded-lg px-3 py-2",children:[u.jsx("option",{value:"free",children:"Free"}),u.jsx("option",{value:"pro",children:"Pro"}),u.jsx("option",{value:"premium",children:"Premium"})]}):u.jsx("p",{className:"py-2 capitalize",children:f.user.subscriptionPlan||"free"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Statut"}),y?u.jsxs("select",{value:f.user.isActive?"1":"0",onChange:P=>p({...f,user:{...f.user,isActive:P.target.value==="1"}}),className:"w-full border rounded-lg px-3 py-2",children:[u.jsx("option",{value:"1",children:"Actif"}),u.jsx("option",{value:"0",children:"Inactif"})]}):u.jsx("p",{className:"py-2",children:f.user.isActive?" Actif":" Inactif"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Inscription"}),u.jsx("p",{className:"py-2",children:new Date(f.user.createdAt).toLocaleDateString("fr-FR")})]})]}),u.jsxs("div",{children:[u.jsxs("h4",{className:"font-semibold mb-2",children:["Projets (",((E=f.projects)==null?void 0:E.length)||0,")"]}),u.jsxs("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:[(j=f.projects)==null?void 0:j.map(P=>u.jsx("div",{className:"p-2 bg-gray-50 rounded-lg text-sm",children:P.name},P.id)),(!f.projects||f.projects.length===0)&&u.jsx("p",{className:"text-gray-500 text-sm",children:"Aucun projet"})]})]}),u.jsxs("div",{children:[u.jsxs("h4",{className:"font-semibold mb-2",children:["Paiements (",((T=f.payments)==null?void 0:T.length)||0,")"]}),u.jsxs("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:[(L=f.payments)==null?void 0:L.map(P=>u.jsxs("div",{className:"p-2 bg-gray-50 rounded-lg text-sm flex justify-between",children:[u.jsxs("span",{children:[P.amount," ",P.currency]}),u.jsx("span",{className:P.status==="completed"?"text-green-600":"text-yellow-600",children:P.status})]},P.id)),(!f.payments||f.payments.length===0)&&u.jsx("p",{className:"text-gray-500 text-sm",children:"Aucun paiement"})]})]})]}),u.jsx("div",{className:"p-6 border-t flex justify-end gap-3",children:y?u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>m(!1),className:"btn-secondary",children:"Annuler"}),u.jsx("button",{onClick:N,className:"btn-primary",children:"Enregistrer"})]}):u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>g(!1),className:"btn-secondary",children:"Fermer"}),u.jsxs("button",{onClick:()=>m(!0),className:"btn-primary flex items-center gap-2",children:[u.jsx(im,{className:"w-4 h-4"}),"Modifier"]})]})})]})})]})},M6=()=>{const[e,t]=I.useState([]),[n,r]=I.useState({page:1,pages:1,total:0}),[a,o]=I.useState(!0),[i,s]=I.useState(""),[l,c]=I.useState({total:0,completed:0,pending:0});I.useEffect(()=>{d()},[n.page,i]);const d=async()=>{try{o(!0);const g=new URLSearchParams({page:n.page,limit:20,status:i}),y=await mn.get(`/admin/payments?${g}`);t(y.data.payments),r(y.data.pagination);const m=y.data.payments;c({total:m.reduce((x,b)=>x+(b.status==="completed"?b.amount:0),0),completed:m.filter(x=>x.status==="completed").length,pending:m.filter(x=>x.status==="pending").length})}catch{V.error("Erreur lors du chargement des paiements")}finally{o(!1)}},h=g=>{switch(g){case"completed":return u.jsx(Tn,{className:"w-4 h-4 text-green-500"});case"pending":return u.jsx(Pi,{className:"w-4 h-4 text-yellow-500"});case"failed":return u.jsx(Aw,{className:"w-4 h-4 text-red-500"});default:return null}},f=g=>{switch(g){case"completed":case"approved":return"bg-green-100 text-green-700";case"pending":return"bg-yellow-100 text-yellow-700";case"failed":case"rejected":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},p=async g=>{try{await mn.put(`/admin/payments/${g}/status`,{status:"approved"}),V.success("Paiement approuv - Abonnement activ"),d()}catch{V.error("Erreur lors de l'approbation")}},v=async g=>{if(confirm("tes-vous sr de vouloir rejeter ce paiement ?"))try{await mn.put(`/admin/payments/${g}/status`,{status:"rejected"}),V.success("Paiement rejet"),d()}catch{V.error("Erreur lors du rejet")}};return u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"flex items-center justify-between",children:u.jsxs("div",{children:[u.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[u.jsx(So,{className:"w-8 h-8 text-green-600"}),"Gestion des paiements"]}),u.jsxs("p",{className:"text-gray-600 mt-1",children:[n.total," paiements au total"]})]})}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow p-4 flex items-center gap-4",children:[u.jsx("div",{className:"bg-green-100 p-3 rounded-lg",children:u.jsx(nm,{className:"w-6 h-6 text-green-600"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-500",children:"Total revenus"}),u.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[l.total," TND"]})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-4 flex items-center gap-4",children:[u.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:u.jsx(Tn,{className:"w-6 h-6 text-blue-600"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-500",children:"Complts"}),u.jsx("p",{className:"text-2xl font-bold",children:l.completed})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-4 flex items-center gap-4",children:[u.jsx("div",{className:"bg-yellow-100 p-3 rounded-lg",children:u.jsx(Pi,{className:"w-6 h-6 text-yellow-600"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-500",children:"En attente"}),u.jsx("p",{className:"text-2xl font-bold",children:l.pending})]})]})]}),u.jsx("div",{className:"bg-white rounded-xl shadow p-4",children:u.jsx("div",{className:"flex gap-4",children:u.jsxs("select",{value:i,onChange:g=>{s(g.target.value),r(y=>({...y,page:1}))},className:"px-4 py-2 border rounded-lg focus:ring-2 focus:ring-green-500",children:[u.jsx("option",{value:"",children:"Tous les statuts"}),u.jsx("option",{value:"completed",children:"Complt"}),u.jsx("option",{value:"pending",children:"En attente"}),u.jsx("option",{value:"failed",children:"chou"})]})})}),u.jsxs("div",{className:"bg-white rounded-xl shadow overflow-hidden",children:[u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"bg-gray-50 border-b",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ID"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Utilisateur"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Montant"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Mthode"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Statut"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-200",children:a?u.jsx("tr",{children:u.jsx("td",{colSpan:8,className:"px-6 py-8 text-center",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-500 mx-auto"})})}):e.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:8,className:"px-6 py-8 text-center text-gray-500",children:"Aucun paiement trouv"})}):e.map(g=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsxs("td",{className:"px-6 py-4 text-sm font-mono",children:["#",g.id]}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{children:[u.jsxs("p",{className:"font-medium",children:[g.firstName," ",g.lastName]}),u.jsx("p",{className:"text-sm text-gray-500",children:g.userEmail})]})}),u.jsxs("td",{className:"px-6 py-4",children:[u.jsx("span",{className:"font-bold text-lg",children:g.amount}),u.jsx("span",{className:"text-gray-500 ml-1",children:g.currency})]}),u.jsx("td",{className:"px-6 py-4 text-sm capitalize",children:g.method||"-"}),u.jsx("td",{className:"px-6 py-4 text-sm capitalize",children:g.subscriptionType||"-"}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${f(g.status)}`,children:[h(g.status),g.status]})}),u.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:new Date(g.createdAt).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}),u.jsx("td",{className:"px-6 py-4",children:g.status==="pending"?u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>p(g.id),className:"p-2 bg-green-100 text-green-600 rounded-lg hover:bg-green-200 transition-colors",title:"Approuver",children:u.jsx(tm,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>v(g.id),className:"p-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors",title:"Rejeter",children:u.jsx(Cr,{className:"w-4 h-4"})})]}):u.jsx("span",{className:"text-gray-400 text-sm",children:"-"})})]},g.id))})]})}),n.pages>1&&u.jsxs("div",{className:"px-6 py-4 border-t flex items-center justify-between",children:[u.jsxs("p",{className:"text-sm text-gray-500",children:["Page ",n.page," sur ",n.pages]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>r(g=>({...g,page:g.page-1})),disabled:n.page===1,className:"p-2 rounded-lg border hover:bg-gray-50 disabled:opacity-50",children:u.jsx(Di,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>r(g=>({...g,page:g.page+1})),disabled:n.page===n.pages,className:"p-2 rounded-lg border hover:bg-gray-50 disabled:opacity-50",children:u.jsx(Ti,{className:"w-4 h-4"})})]})]})]})]})},O6=()=>{const[e,t]=I.useState([]),[n,r]=I.useState({page:1,pages:1,total:0}),[a,o]=I.useState(!0),[i,s]=I.useState(""),[l,c]=I.useState(null),[d,h]=I.useState(!1);I.useEffect(()=>{f()},[n.page]);const f=async()=>{try{o(!0);const m=new URLSearchParams({page:n.page,limit:20,search:i}),x=await mn.get(`/admin/projects?${m}`);t(x.data.projects||[]),r(x.data.pagination||{page:1,pages:1,total:0})}catch{V.error("Erreur lors du chargement des projets")}finally{o(!1)}},p=m=>{m.preventDefault(),r(x=>({...x,page:1})),f()},v=m=>{c(m),h(!0)},g=async m=>{if(confirm("tes-vous sr de vouloir supprimer ce projet ?"))try{await mn.delete(`/admin/projects/${m}`),V.success("Projet supprim"),f()}catch{V.error("Erreur lors de la suppression")}},y=m=>m?new Date(m).toLocaleDateString("fr-FR"):"-";return a?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500"})}):u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"flex items-center justify-between",children:u.jsxs("div",{children:[u.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[u.jsx(Fi,{className:"w-8 h-8 text-cyan-600"}),"Gestion des projets"]}),u.jsxs("p",{className:"text-gray-600 mt-1",children:[n.total," projets au total"]})]})}),u.jsx("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:u.jsxs("form",{onSubmit:p,className:"flex gap-4",children:[u.jsxs("div",{className:"flex-1 relative",children:[u.jsx(om,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"text",value:i,onChange:m=>s(m.target.value),placeholder:"Rechercher par nom de projet...",className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]}),u.jsxs("button",{type:"submit",className:"px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 flex items-center gap-2",children:[u.jsx(Nw,{className:"w-4 h-4"}),"Filtrer"]})]})}),u.jsx("div",{className:"bg-white rounded-xl shadow-sm border overflow-hidden",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"bg-gray-50 border-b",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Projet"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Propritaire"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Statut"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Cr le"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),u.jsx("tbody",{className:"divide-y",children:e.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:"5",className:"px-6 py-8 text-center text-gray-500",children:"Aucun projet trouv"})}):e.map(m=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-cyan-500 to-purple-600 rounded-lg flex items-center justify-center",children:u.jsx(Fi,{className:"w-5 h-5 text-white"})}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900",children:m.name}),u.jsx("p",{className:"text-sm text-gray-500 truncate max-w-xs",children:m.description||"Pas de description"})]})]})}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(ta,{className:"w-4 h-4 text-gray-400"}),u.jsx("span",{className:"text-gray-700",children:m.ownerName||m.ownerEmail||"Inconnu"})]})}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${m.status==="active"?"bg-green-100 text-green-700":m.status==="completed"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:m.status||"En cours"})}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[u.jsx(bw,{className:"w-4 h-4"}),y(m.createdAt)]})}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>v(m),className:"p-2 text-gray-500 hover:text-cyan-600 hover:bg-cyan-50 rounded-lg",title:"Voir",children:u.jsx(Eo,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>g(m.id),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg",title:"Supprimer",children:u.jsx(Qa,{className:"w-4 h-4"})})]})})]},m.id))})]})}),n.pages>1&&u.jsxs("div",{className:"flex items-center justify-between bg-white rounded-xl shadow-sm border p-4",children:[u.jsxs("p",{className:"text-sm text-gray-600",children:["Page ",n.page," sur ",n.pages]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>r(m=>({...m,page:m.page-1})),disabled:n.page===1,className:"p-2 border rounded-lg hover:bg-gray-50 disabled:opacity-50",children:u.jsx(Di,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>r(m=>({...m,page:m.page+1})),disabled:n.page===n.pages,className:"p-2 border rounded-lg hover:bg-gray-50 disabled:opacity-50",children:u.jsx(Ti,{className:"w-4 h-4"})})]})]}),d&&l&&u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg mx-4 max-h-[80vh] overflow-y-auto",children:[u.jsx("div",{className:"p-6 border-b",children:u.jsx("h2",{className:"text-xl font-bold",children:"Dtails du projet"})}),u.jsxs("div",{className:"p-6 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom"}),u.jsx("p",{className:"py-2 font-medium",children:l.name})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),u.jsx("p",{className:"py-2 text-gray-600",children:l.description||"Aucune description"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Propritaire"}),u.jsx("p",{className:"py-2",children:l.ownerName||l.ownerEmail||"Inconnu"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de cration"}),u.jsx("p",{className:"py-2",children:y(l.createdAt)})]})]}),u.jsx("div",{className:"p-6 border-t flex justify-end",children:u.jsx("button",{onClick:()=>h(!1),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Fermer"})})]})})]})},Bn=({children:e})=>{const{isAuthenticated:t}=ur();return t?e:u.jsx(M2,{to:"/login",replace:!0})},f1=({children:e})=>{const{isAuthenticated:t}=ur();return t?u.jsx(M2,{to:"/dashboard",replace:!0}):e};function L6(){return u.jsxs(WE,{children:[u.jsx(F4,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"},success:{style:{background:"#10b981"}},error:{style:{background:"#ef4444"}}}}),u.jsxs(FE,{children:[u.jsx(nt,{path:"/",element:u.jsx(UR,{})}),u.jsx(nt,{path:"/login",element:u.jsx(f1,{children:u.jsx(f6,{})})}),u.jsx(nt,{path:"/register",element:u.jsx(f1,{children:u.jsx(p6,{})})}),u.jsx(nt,{path:"/pricing",element:u.jsx(_6,{})}),u.jsx(nt,{path:"/auth/google/callback",element:u.jsx(I6,{})}),u.jsx(nt,{path:"/invite/:token",element:u.jsx(E6,{})}),u.jsx(nt,{path:"/dashboard",element:u.jsx(Bn,{children:u.jsx(Qn,{children:u.jsx(m6,{})})})}),u.jsx(nt,{path:"/projects",element:u.jsx(Bn,{children:u.jsx(Qn,{children:u.jsx(g6,{})})})}),u.jsx(nt,{path:"/projects/:id",element:u.jsx(Bn,{children:u.jsx(Qn,{children:u.jsx(x6,{})})})}),u.jsx(nt,{path:"/ideas",element:u.jsx(Bn,{children:u.jsx(Qn,{children:u.jsx(y6,{})})})}),u.jsx(nt,{path:"/business-model/:projectId",element:u.jsx(Bn,{children:u.jsx(Qn,{children:u.jsx(b6,{})})})}),u.jsx(nt,{path:"/branding/:projectId",element:u.jsx(Bn,{children:u.jsx(Qn,{children:u.jsx(w6,{})})})}),u.jsx(nt,{path:"/business-plan/:projectId",element:u.jsx(Bn,{children:u.jsx(Qn,{children:u.jsx(N6,{})})})}),u.jsx(nt,{path:"/pitch-deck/:projectId",element:u.jsx(Bn,{children:u.jsx(k6,{})})}),u.jsx(nt,{path:"/pitch-deck-old/:projectId",element:u.jsx(Bn,{children:u.jsx(Qn,{children:u.jsx(C6,{})})})}),u.jsx(nt,{path:"/tasks/:projectId",element:u.jsx(Bn,{children:u.jsx(Qn,{children:u.jsx(j6,{})})})}),u.jsx(nt,{path:"/team/:id",element:u.jsx(Bn,{children:u.jsx(Qn,{children:u.jsx(S6,{})})})}),u.jsx(nt,{path:"/profile",element:u.jsx(Bn,{children:u.jsx(Qn,{children:u.jsx(R6,{})})})}),u.jsx(nt,{path:"/admin/login",element:u.jsx(D6,{})}),u.jsx(nt,{path:"/admin",element:u.jsx(ou,{children:u.jsx(T6,{})})}),u.jsx(nt,{path:"/admin/users",element:u.jsx(ou,{children:u.jsx(F6,{})})}),u.jsx(nt,{path:"/admin/payments",element:u.jsx(ou,{children:u.jsx(M6,{})})}),u.jsx(nt,{path:"/admin/projects",element:u.jsx(ou,{children:u.jsx(O6,{})})})]})]})}bh.createRoot(document.getElementById("root")).render(u.jsx(jc.StrictMode,{children:u.jsx(L6,{})}))});export default B6();
